// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_unified_memory(struct futhark_context_config *cfg, int flag);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s);
const char *futhark_context_config_get_program(struct futhark_context_config *cfg);
void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);

// Entry points
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>


#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
};
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    struct memblock_device counters_mem_78703;
    struct memblock_device global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251;
};
struct tuning_params {
    int dummy;
    int64_t *builtinzhiota_i64zitblock_sizze_78710;
    int64_t *builtinzhreplicate_f32zitblock_sizze_78739;
    int64_t *builtinzhreplicate_f64zitblock_sizze_78739;
    int64_t *builtinzhreplicate_i16zitblock_sizze_78739;
    int64_t *builtinzhreplicate_i32zitblock_sizze_79121;
    int64_t *builtinzhreplicate_i64zitblock_sizze_78713;
    int64_t *builtinzhreplicate_i8zitblock_sizze_79095;
    int64_t *gather_payloads_doublezisegmap_tblock_sizze_69159;
    int64_t *gather_payloads_doublezisegmap_tblock_sizze_69177;
    int64_t *gather_payloads_double_GFURzisegmap_tblock_sizze_69439;
    int64_t *gather_payloads_double_GFURzisegmap_tblock_sizze_69457;
    int64_t *gather_payloads_floatzisegmap_tblock_sizze_69103;
    int64_t *gather_payloads_floatzisegmap_tblock_sizze_69121;
    int64_t *gather_payloads_float_GFURzisegmap_tblock_sizze_69383;
    int64_t *gather_payloads_float_GFURzisegmap_tblock_sizze_69401;
    int64_t *gather_payloads_intzisegmap_tblock_sizze_68991;
    int64_t *gather_payloads_intzisegmap_tblock_sizze_69009;
    int64_t *gather_payloads_int_GFURzisegmap_tblock_sizze_69271;
    int64_t *gather_payloads_int_GFURzisegmap_tblock_sizze_69289;
    int64_t *gather_payloads_longzisegmap_tblock_sizze_69047;
    int64_t *gather_payloads_longzisegmap_tblock_sizze_69065;
    int64_t *gather_payloads_long_GFURzisegmap_tblock_sizze_69327;
    int64_t *gather_payloads_long_GFURzisegmap_tblock_sizze_69345;
    int64_t *gather_payloads_shortzisegmap_tblock_sizze_68935;
    int64_t *gather_payloads_shortzisegmap_tblock_sizze_68953;
    int64_t *gather_payloads_short_GFURzisegmap_tblock_sizze_69215;
    int64_t *gather_payloads_short_GFURzisegmap_tblock_sizze_69233;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_75971;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_76013;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_76021;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_74911;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75328;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75835;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75857;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75877;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75899;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75919;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75941;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75969;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_75985;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_76011;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_76019;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_76027;
    int64_t *inner_SMJ_doublezisegscan_num_tblocks_75961;
    int64_t *inner_SMJ_doublezisegscan_num_tblocks_75977;
    int64_t *inner_SMJ_doublezisegscan_tblock_sizze_75959;
    int64_t *inner_SMJ_doublezisegscan_tblock_sizze_75975;
    int64_t *inner_SMJ_doublezisuff_outer_par_0;
    int64_t *inner_SMJ_doublezisuff_outer_par_1;
    int64_t *inner_SMJ_doublezitblock_sizze_79465;
    int64_t *inner_SMJ_doublezitblock_sizze_79485;
    int64_t *inner_SMJ_doublezitile_sizze_76058;
    int64_t *inner_SMJ_doublezitile_sizze_76413;
    int64_t *inner_SMJ_doublezitile_sizze_76768;
    int64_t *inner_SMJ_doublezitile_sizze_77123;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_74661;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_74703;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_74711;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_73601;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74018;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74525;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74547;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74567;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74589;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74609;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74631;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74659;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74675;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74701;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74709;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_74717;
    int64_t *inner_SMJ_floatzisegscan_num_tblocks_74651;
    int64_t *inner_SMJ_floatzisegscan_num_tblocks_74667;
    int64_t *inner_SMJ_floatzisegscan_tblock_sizze_74649;
    int64_t *inner_SMJ_floatzisegscan_tblock_sizze_74665;
    int64_t *inner_SMJ_floatzisuff_outer_par_0;
    int64_t *inner_SMJ_floatzisuff_outer_par_1;
    int64_t *inner_SMJ_floatzitblock_sizze_79465;
    int64_t *inner_SMJ_floatzitblock_sizze_79485;
    int64_t *inner_SMJ_floatzitile_sizze_76058;
    int64_t *inner_SMJ_floatzitile_sizze_76413;
    int64_t *inner_SMJ_floatzitile_sizze_76768;
    int64_t *inner_SMJ_floatzitile_sizze_77123;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_72041;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_72083;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_72091;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_70981;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71398;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71905;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71927;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71947;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71969;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_71989;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72011;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72039;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72055;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72081;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72089;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_72097;
    int64_t *inner_SMJ_intzisegscan_num_tblocks_72031;
    int64_t *inner_SMJ_intzisegscan_num_tblocks_72047;
    int64_t *inner_SMJ_intzisegscan_tblock_sizze_72029;
    int64_t *inner_SMJ_intzisegscan_tblock_sizze_72045;
    int64_t *inner_SMJ_intzisuff_outer_par_0;
    int64_t *inner_SMJ_intzisuff_outer_par_1;
    int64_t *inner_SMJ_intzitblock_sizze_79445;
    int64_t *inner_SMJ_intzitblock_sizze_79465;
    int64_t *inner_SMJ_intzitile_sizze_76058;
    int64_t *inner_SMJ_intzitile_sizze_76413;
    int64_t *inner_SMJ_intzitile_sizze_76768;
    int64_t *inner_SMJ_intzitile_sizze_77123;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_73351;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_73393;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_73401;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_72291;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_72708;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73215;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73237;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73257;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73279;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73299;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73321;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73349;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73365;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73391;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73399;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_73407;
    int64_t *inner_SMJ_longzisegscan_num_tblocks_73341;
    int64_t *inner_SMJ_longzisegscan_num_tblocks_73357;
    int64_t *inner_SMJ_longzisegscan_tblock_sizze_73339;
    int64_t *inner_SMJ_longzisegscan_tblock_sizze_73355;
    int64_t *inner_SMJ_longzisuff_outer_par_0;
    int64_t *inner_SMJ_longzisuff_outer_par_1;
    int64_t *inner_SMJ_longzitblock_sizze_79445;
    int64_t *inner_SMJ_longzitblock_sizze_79465;
    int64_t *inner_SMJ_longzitile_sizze_76058;
    int64_t *inner_SMJ_longzitile_sizze_76413;
    int64_t *inner_SMJ_longzitile_sizze_76768;
    int64_t *inner_SMJ_longzitile_sizze_77123;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_70731;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_70773;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_70781;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_69671;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70088;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70595;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70617;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70637;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70659;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70679;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70701;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70729;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70745;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70771;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70779;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_70787;
    int64_t *inner_SMJ_shortzisegscan_num_tblocks_70721;
    int64_t *inner_SMJ_shortzisegscan_num_tblocks_70737;
    int64_t *inner_SMJ_shortzisegscan_tblock_sizze_70719;
    int64_t *inner_SMJ_shortzisegscan_tblock_sizze_70735;
    int64_t *inner_SMJ_shortzisuff_outer_par_0;
    int64_t *inner_SMJ_shortzisuff_outer_par_1;
    int64_t *inner_SMJ_shortzitblock_sizze_79465;
    int64_t *inner_SMJ_shortzitblock_sizze_79485;
    int64_t *inner_SMJ_shortzitile_sizze_76058;
    int64_t *inner_SMJ_shortzitile_sizze_76413;
    int64_t *inner_SMJ_shortzitile_sizze_76768;
    int64_t *inner_SMJ_shortzitile_sizze_77123;
    int64_t *max_idxzisegred_num_tblocks_68925;
    int64_t *max_idxzisegred_tblock_sizze_68923;
    int64_t *min_idxzisegred_num_tblocks_68915;
    int64_t *min_idxzisegred_tblock_sizze_68913;
};
static const int num_tuning_params = 171;
static const char *tuning_param_names[] = {"builtin#iota_i64.tblock_size_78710", "builtin#replicate_f32.tblock_size_78739", "builtin#replicate_f64.tblock_size_78739", "builtin#replicate_i16.tblock_size_78739", "builtin#replicate_i32.tblock_size_79121", "builtin#replicate_i64.tblock_size_78713", "builtin#replicate_i8.tblock_size_79095", "gather_payloads_double.segmap_tblock_size_69159", "gather_payloads_double.segmap_tblock_size_69177", "gather_payloads_double_GFUR.segmap_tblock_size_69439", "gather_payloads_double_GFUR.segmap_tblock_size_69457", "gather_payloads_float.segmap_tblock_size_69103", "gather_payloads_float.segmap_tblock_size_69121", "gather_payloads_float_GFUR.segmap_tblock_size_69383", "gather_payloads_float_GFUR.segmap_tblock_size_69401", "gather_payloads_int.segmap_tblock_size_68991", "gather_payloads_int.segmap_tblock_size_69009", "gather_payloads_int_GFUR.segmap_tblock_size_69271", "gather_payloads_int_GFUR.segmap_tblock_size_69289", "gather_payloads_long.segmap_tblock_size_69047", "gather_payloads_long.segmap_tblock_size_69065", "gather_payloads_long_GFUR.segmap_tblock_size_69327", "gather_payloads_long_GFUR.segmap_tblock_size_69345", "gather_payloads_short.segmap_tblock_size_68935", "gather_payloads_short.segmap_tblock_size_68953", "gather_payloads_short_GFUR.segmap_tblock_size_69215", "gather_payloads_short_GFUR.segmap_tblock_size_69233", "inner_SMJ_double.segmap_num_tblocks_75971", "inner_SMJ_double.segmap_num_tblocks_76013", "inner_SMJ_double.segmap_num_tblocks_76021", "inner_SMJ_double.segmap_tblock_size_74911", "inner_SMJ_double.segmap_tblock_size_75328", "inner_SMJ_double.segmap_tblock_size_75835", "inner_SMJ_double.segmap_tblock_size_75857", "inner_SMJ_double.segmap_tblock_size_75877", "inner_SMJ_double.segmap_tblock_size_75899", "inner_SMJ_double.segmap_tblock_size_75919", "inner_SMJ_double.segmap_tblock_size_75941", "inner_SMJ_double.segmap_tblock_size_75969", "inner_SMJ_double.segmap_tblock_size_75985", "inner_SMJ_double.segmap_tblock_size_76011", "inner_SMJ_double.segmap_tblock_size_76019", "inner_SMJ_double.segmap_tblock_size_76027", "inner_SMJ_double.segscan_num_tblocks_75961", "inner_SMJ_double.segscan_num_tblocks_75977", "inner_SMJ_double.segscan_tblock_size_75959", "inner_SMJ_double.segscan_tblock_size_75975", "inner_SMJ_double.suff_outer_par_0", "inner_SMJ_double.suff_outer_par_1", "inner_SMJ_double.tblock_size_79465", "inner_SMJ_double.tblock_size_79485", "inner_SMJ_double.tile_size_76058", "inner_SMJ_double.tile_size_76413", "inner_SMJ_double.tile_size_76768", "inner_SMJ_double.tile_size_77123", "inner_SMJ_float.segmap_num_tblocks_74661", "inner_SMJ_float.segmap_num_tblocks_74703", "inner_SMJ_float.segmap_num_tblocks_74711", "inner_SMJ_float.segmap_tblock_size_73601", "inner_SMJ_float.segmap_tblock_size_74018", "inner_SMJ_float.segmap_tblock_size_74525", "inner_SMJ_float.segmap_tblock_size_74547", "inner_SMJ_float.segmap_tblock_size_74567", "inner_SMJ_float.segmap_tblock_size_74589", "inner_SMJ_float.segmap_tblock_size_74609", "inner_SMJ_float.segmap_tblock_size_74631", "inner_SMJ_float.segmap_tblock_size_74659", "inner_SMJ_float.segmap_tblock_size_74675", "inner_SMJ_float.segmap_tblock_size_74701", "inner_SMJ_float.segmap_tblock_size_74709", "inner_SMJ_float.segmap_tblock_size_74717", "inner_SMJ_float.segscan_num_tblocks_74651", "inner_SMJ_float.segscan_num_tblocks_74667", "inner_SMJ_float.segscan_tblock_size_74649", "inner_SMJ_float.segscan_tblock_size_74665", "inner_SMJ_float.suff_outer_par_0", "inner_SMJ_float.suff_outer_par_1", "inner_SMJ_float.tblock_size_79465", "inner_SMJ_float.tblock_size_79485", "inner_SMJ_float.tile_size_76058", "inner_SMJ_float.tile_size_76413", "inner_SMJ_float.tile_size_76768", "inner_SMJ_float.tile_size_77123", "inner_SMJ_int.segmap_num_tblocks_72041", "inner_SMJ_int.segmap_num_tblocks_72083", "inner_SMJ_int.segmap_num_tblocks_72091", "inner_SMJ_int.segmap_tblock_size_70981", "inner_SMJ_int.segmap_tblock_size_71398", "inner_SMJ_int.segmap_tblock_size_71905", "inner_SMJ_int.segmap_tblock_size_71927", "inner_SMJ_int.segmap_tblock_size_71947", "inner_SMJ_int.segmap_tblock_size_71969", "inner_SMJ_int.segmap_tblock_size_71989", "inner_SMJ_int.segmap_tblock_size_72011", "inner_SMJ_int.segmap_tblock_size_72039", "inner_SMJ_int.segmap_tblock_size_72055", "inner_SMJ_int.segmap_tblock_size_72081", "inner_SMJ_int.segmap_tblock_size_72089", "inner_SMJ_int.segmap_tblock_size_72097", "inner_SMJ_int.segscan_num_tblocks_72031", "inner_SMJ_int.segscan_num_tblocks_72047", "inner_SMJ_int.segscan_tblock_size_72029", "inner_SMJ_int.segscan_tblock_size_72045", "inner_SMJ_int.suff_outer_par_0", "inner_SMJ_int.suff_outer_par_1", "inner_SMJ_int.tblock_size_79445", "inner_SMJ_int.tblock_size_79465", "inner_SMJ_int.tile_size_76058", "inner_SMJ_int.tile_size_76413", "inner_SMJ_int.tile_size_76768", "inner_SMJ_int.tile_size_77123", "inner_SMJ_long.segmap_num_tblocks_73351", "inner_SMJ_long.segmap_num_tblocks_73393", "inner_SMJ_long.segmap_num_tblocks_73401", "inner_SMJ_long.segmap_tblock_size_72291", "inner_SMJ_long.segmap_tblock_size_72708", "inner_SMJ_long.segmap_tblock_size_73215", "inner_SMJ_long.segmap_tblock_size_73237", "inner_SMJ_long.segmap_tblock_size_73257", "inner_SMJ_long.segmap_tblock_size_73279", "inner_SMJ_long.segmap_tblock_size_73299", "inner_SMJ_long.segmap_tblock_size_73321", "inner_SMJ_long.segmap_tblock_size_73349", "inner_SMJ_long.segmap_tblock_size_73365", "inner_SMJ_long.segmap_tblock_size_73391", "inner_SMJ_long.segmap_tblock_size_73399", "inner_SMJ_long.segmap_tblock_size_73407", "inner_SMJ_long.segscan_num_tblocks_73341", "inner_SMJ_long.segscan_num_tblocks_73357", "inner_SMJ_long.segscan_tblock_size_73339", "inner_SMJ_long.segscan_tblock_size_73355", "inner_SMJ_long.suff_outer_par_0", "inner_SMJ_long.suff_outer_par_1", "inner_SMJ_long.tblock_size_79445", "inner_SMJ_long.tblock_size_79465", "inner_SMJ_long.tile_size_76058", "inner_SMJ_long.tile_size_76413", "inner_SMJ_long.tile_size_76768", "inner_SMJ_long.tile_size_77123", "inner_SMJ_short.segmap_num_tblocks_70731", "inner_SMJ_short.segmap_num_tblocks_70773", "inner_SMJ_short.segmap_num_tblocks_70781", "inner_SMJ_short.segmap_tblock_size_69671", "inner_SMJ_short.segmap_tblock_size_70088", "inner_SMJ_short.segmap_tblock_size_70595", "inner_SMJ_short.segmap_tblock_size_70617", "inner_SMJ_short.segmap_tblock_size_70637", "inner_SMJ_short.segmap_tblock_size_70659", "inner_SMJ_short.segmap_tblock_size_70679", "inner_SMJ_short.segmap_tblock_size_70701", "inner_SMJ_short.segmap_tblock_size_70729", "inner_SMJ_short.segmap_tblock_size_70745", "inner_SMJ_short.segmap_tblock_size_70771", "inner_SMJ_short.segmap_tblock_size_70779", "inner_SMJ_short.segmap_tblock_size_70787", "inner_SMJ_short.segscan_num_tblocks_70721", "inner_SMJ_short.segscan_num_tblocks_70737", "inner_SMJ_short.segscan_tblock_size_70719", "inner_SMJ_short.segscan_tblock_size_70735", "inner_SMJ_short.suff_outer_par_0", "inner_SMJ_short.suff_outer_par_1", "inner_SMJ_short.tblock_size_79465", "inner_SMJ_short.tblock_size_79485", "inner_SMJ_short.tile_size_76058", "inner_SMJ_short.tile_size_76413", "inner_SMJ_short.tile_size_76768", "inner_SMJ_short.tile_size_77123", "max_idx.segred_num_tblocks_68925", "max_idx.segred_tblock_size_68923", "min_idx.segred_num_tblocks_68915", "min_idx.segred_tblock_size_68913", NULL};
static const char *tuning_param_vars[] = {"builtinzhiota_i64zitblock_sizze_78710", "builtinzhreplicate_f32zitblock_sizze_78739", "builtinzhreplicate_f64zitblock_sizze_78739", "builtinzhreplicate_i16zitblock_sizze_78739", "builtinzhreplicate_i32zitblock_sizze_79121", "builtinzhreplicate_i64zitblock_sizze_78713", "builtinzhreplicate_i8zitblock_sizze_79095", "gather_payloads_doublezisegmap_tblock_sizze_69159", "gather_payloads_doublezisegmap_tblock_sizze_69177", "gather_payloads_double_GFURzisegmap_tblock_sizze_69439", "gather_payloads_double_GFURzisegmap_tblock_sizze_69457", "gather_payloads_floatzisegmap_tblock_sizze_69103", "gather_payloads_floatzisegmap_tblock_sizze_69121", "gather_payloads_float_GFURzisegmap_tblock_sizze_69383", "gather_payloads_float_GFURzisegmap_tblock_sizze_69401", "gather_payloads_intzisegmap_tblock_sizze_68991", "gather_payloads_intzisegmap_tblock_sizze_69009", "gather_payloads_int_GFURzisegmap_tblock_sizze_69271", "gather_payloads_int_GFURzisegmap_tblock_sizze_69289", "gather_payloads_longzisegmap_tblock_sizze_69047", "gather_payloads_longzisegmap_tblock_sizze_69065", "gather_payloads_long_GFURzisegmap_tblock_sizze_69327", "gather_payloads_long_GFURzisegmap_tblock_sizze_69345", "gather_payloads_shortzisegmap_tblock_sizze_68935", "gather_payloads_shortzisegmap_tblock_sizze_68953", "gather_payloads_short_GFURzisegmap_tblock_sizze_69215", "gather_payloads_short_GFURzisegmap_tblock_sizze_69233", "inner_SMJ_doublezisegmap_num_tblocks_75971", "inner_SMJ_doublezisegmap_num_tblocks_76013", "inner_SMJ_doublezisegmap_num_tblocks_76021", "inner_SMJ_doublezisegmap_tblock_sizze_74911", "inner_SMJ_doublezisegmap_tblock_sizze_75328", "inner_SMJ_doublezisegmap_tblock_sizze_75835", "inner_SMJ_doublezisegmap_tblock_sizze_75857", "inner_SMJ_doublezisegmap_tblock_sizze_75877", "inner_SMJ_doublezisegmap_tblock_sizze_75899", "inner_SMJ_doublezisegmap_tblock_sizze_75919", "inner_SMJ_doublezisegmap_tblock_sizze_75941", "inner_SMJ_doublezisegmap_tblock_sizze_75969", "inner_SMJ_doublezisegmap_tblock_sizze_75985", "inner_SMJ_doublezisegmap_tblock_sizze_76011", "inner_SMJ_doublezisegmap_tblock_sizze_76019", "inner_SMJ_doublezisegmap_tblock_sizze_76027", "inner_SMJ_doublezisegscan_num_tblocks_75961", "inner_SMJ_doublezisegscan_num_tblocks_75977", "inner_SMJ_doublezisegscan_tblock_sizze_75959", "inner_SMJ_doublezisegscan_tblock_sizze_75975", "inner_SMJ_doublezisuff_outer_par_0", "inner_SMJ_doublezisuff_outer_par_1", "inner_SMJ_doublezitblock_sizze_79465", "inner_SMJ_doublezitblock_sizze_79485", "inner_SMJ_doublezitile_sizze_76058", "inner_SMJ_doublezitile_sizze_76413", "inner_SMJ_doublezitile_sizze_76768", "inner_SMJ_doublezitile_sizze_77123", "inner_SMJ_floatzisegmap_num_tblocks_74661", "inner_SMJ_floatzisegmap_num_tblocks_74703", "inner_SMJ_floatzisegmap_num_tblocks_74711", "inner_SMJ_floatzisegmap_tblock_sizze_73601", "inner_SMJ_floatzisegmap_tblock_sizze_74018", "inner_SMJ_floatzisegmap_tblock_sizze_74525", "inner_SMJ_floatzisegmap_tblock_sizze_74547", "inner_SMJ_floatzisegmap_tblock_sizze_74567", "inner_SMJ_floatzisegmap_tblock_sizze_74589", "inner_SMJ_floatzisegmap_tblock_sizze_74609", "inner_SMJ_floatzisegmap_tblock_sizze_74631", "inner_SMJ_floatzisegmap_tblock_sizze_74659", "inner_SMJ_floatzisegmap_tblock_sizze_74675", "inner_SMJ_floatzisegmap_tblock_sizze_74701", "inner_SMJ_floatzisegmap_tblock_sizze_74709", "inner_SMJ_floatzisegmap_tblock_sizze_74717", "inner_SMJ_floatzisegscan_num_tblocks_74651", "inner_SMJ_floatzisegscan_num_tblocks_74667", "inner_SMJ_floatzisegscan_tblock_sizze_74649", "inner_SMJ_floatzisegscan_tblock_sizze_74665", "inner_SMJ_floatzisuff_outer_par_0", "inner_SMJ_floatzisuff_outer_par_1", "inner_SMJ_floatzitblock_sizze_79465", "inner_SMJ_floatzitblock_sizze_79485", "inner_SMJ_floatzitile_sizze_76058", "inner_SMJ_floatzitile_sizze_76413", "inner_SMJ_floatzitile_sizze_76768", "inner_SMJ_floatzitile_sizze_77123", "inner_SMJ_intzisegmap_num_tblocks_72041", "inner_SMJ_intzisegmap_num_tblocks_72083", "inner_SMJ_intzisegmap_num_tblocks_72091", "inner_SMJ_intzisegmap_tblock_sizze_70981", "inner_SMJ_intzisegmap_tblock_sizze_71398", "inner_SMJ_intzisegmap_tblock_sizze_71905", "inner_SMJ_intzisegmap_tblock_sizze_71927", "inner_SMJ_intzisegmap_tblock_sizze_71947", "inner_SMJ_intzisegmap_tblock_sizze_71969", "inner_SMJ_intzisegmap_tblock_sizze_71989", "inner_SMJ_intzisegmap_tblock_sizze_72011", "inner_SMJ_intzisegmap_tblock_sizze_72039", "inner_SMJ_intzisegmap_tblock_sizze_72055", "inner_SMJ_intzisegmap_tblock_sizze_72081", "inner_SMJ_intzisegmap_tblock_sizze_72089", "inner_SMJ_intzisegmap_tblock_sizze_72097", "inner_SMJ_intzisegscan_num_tblocks_72031", "inner_SMJ_intzisegscan_num_tblocks_72047", "inner_SMJ_intzisegscan_tblock_sizze_72029", "inner_SMJ_intzisegscan_tblock_sizze_72045", "inner_SMJ_intzisuff_outer_par_0", "inner_SMJ_intzisuff_outer_par_1", "inner_SMJ_intzitblock_sizze_79445", "inner_SMJ_intzitblock_sizze_79465", "inner_SMJ_intzitile_sizze_76058", "inner_SMJ_intzitile_sizze_76413", "inner_SMJ_intzitile_sizze_76768", "inner_SMJ_intzitile_sizze_77123", "inner_SMJ_longzisegmap_num_tblocks_73351", "inner_SMJ_longzisegmap_num_tblocks_73393", "inner_SMJ_longzisegmap_num_tblocks_73401", "inner_SMJ_longzisegmap_tblock_sizze_72291", "inner_SMJ_longzisegmap_tblock_sizze_72708", "inner_SMJ_longzisegmap_tblock_sizze_73215", "inner_SMJ_longzisegmap_tblock_sizze_73237", "inner_SMJ_longzisegmap_tblock_sizze_73257", "inner_SMJ_longzisegmap_tblock_sizze_73279", "inner_SMJ_longzisegmap_tblock_sizze_73299", "inner_SMJ_longzisegmap_tblock_sizze_73321", "inner_SMJ_longzisegmap_tblock_sizze_73349", "inner_SMJ_longzisegmap_tblock_sizze_73365", "inner_SMJ_longzisegmap_tblock_sizze_73391", "inner_SMJ_longzisegmap_tblock_sizze_73399", "inner_SMJ_longzisegmap_tblock_sizze_73407", "inner_SMJ_longzisegscan_num_tblocks_73341", "inner_SMJ_longzisegscan_num_tblocks_73357", "inner_SMJ_longzisegscan_tblock_sizze_73339", "inner_SMJ_longzisegscan_tblock_sizze_73355", "inner_SMJ_longzisuff_outer_par_0", "inner_SMJ_longzisuff_outer_par_1", "inner_SMJ_longzitblock_sizze_79445", "inner_SMJ_longzitblock_sizze_79465", "inner_SMJ_longzitile_sizze_76058", "inner_SMJ_longzitile_sizze_76413", "inner_SMJ_longzitile_sizze_76768", "inner_SMJ_longzitile_sizze_77123", "inner_SMJ_shortzisegmap_num_tblocks_70731", "inner_SMJ_shortzisegmap_num_tblocks_70773", "inner_SMJ_shortzisegmap_num_tblocks_70781", "inner_SMJ_shortzisegmap_tblock_sizze_69671", "inner_SMJ_shortzisegmap_tblock_sizze_70088", "inner_SMJ_shortzisegmap_tblock_sizze_70595", "inner_SMJ_shortzisegmap_tblock_sizze_70617", "inner_SMJ_shortzisegmap_tblock_sizze_70637", "inner_SMJ_shortzisegmap_tblock_sizze_70659", "inner_SMJ_shortzisegmap_tblock_sizze_70679", "inner_SMJ_shortzisegmap_tblock_sizze_70701", "inner_SMJ_shortzisegmap_tblock_sizze_70729", "inner_SMJ_shortzisegmap_tblock_sizze_70745", "inner_SMJ_shortzisegmap_tblock_sizze_70771", "inner_SMJ_shortzisegmap_tblock_sizze_70779", "inner_SMJ_shortzisegmap_tblock_sizze_70787", "inner_SMJ_shortzisegscan_num_tblocks_70721", "inner_SMJ_shortzisegscan_num_tblocks_70737", "inner_SMJ_shortzisegscan_tblock_sizze_70719", "inner_SMJ_shortzisegscan_tblock_sizze_70735", "inner_SMJ_shortzisuff_outer_par_0", "inner_SMJ_shortzisuff_outer_par_1", "inner_SMJ_shortzitblock_sizze_79465", "inner_SMJ_shortzitblock_sizze_79485", "inner_SMJ_shortzitile_sizze_76058", "inner_SMJ_shortzitile_sizze_76413", "inner_SMJ_shortzitile_sizze_76768", "inner_SMJ_shortzitile_sizze_77123", "max_idxzisegred_num_tblocks_68925", "max_idxzisegred_tblock_sizze_68923", "min_idxzisegred_num_tblocks_68915", "min_idxzisegred_tblock_sizze_68913", NULL};
static const char *tuning_param_classes[] = {"thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", NULL};
static int64_t tuning_param_defaults[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
static const int max_failure_args = 2;
static const int f64_required = 1;
static const char *gpu_program[] = {"#define FUTHARK_CUDA\n// start of prelude.cu\n\n#define SCALAR_FUN_ATTR __device__ static inline\n#define FUTHARK_FUN_ATTR __device__ static\n#define FUTHARK_F64_ENABLED\n\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\n\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\n\nstatic inline __device__ int get_tblock_id(int d) {\n  switch (d) {\n  case 0: return blockIdx.x;\n  case 1: return blockIdx.y;\n  case 2: return blockIdx.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_num_tblocks(int d) {\n  switch(d) {\n  case 0: return gridDim.x;\n  case 1: return gridDim.y;\n  case 2: return gridDim.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x + blockIdx.x * blockDim.x;\n    case 1: return threadIdx.y + blockIdx.y * blockDim.y;\n    case 2: return threadIdx.z + blockIdx.z * blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x;\n    case 1: return threadIdx.y;\n    case 2: return threadIdx.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_size(int d) {\n  switch (d) {\n    case 0: return blockDim.x;\n    case 1: return blockDim.y;\n    case 2: return blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_size(int d) {\n  switch (d) {\n    case 0: return gridDim.x * blockDim.x;\n    case 1: return gridDim.y * blockDim.y;\n    case 2: return gridDim.z * blockDim.z;\n    default: return 0;\n  }\n}\n\n\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline __device__ void barrier(int x) {\n  __syncthreads();\n}\nstatic inline __device__ void mem_fence_local() {\n  __threadfence_block();\n}\nstatic inline __device__ void mem_fence_global", "() {\n  __threadfence();\n}\n\nstatic inline __device__ void barrier_local() {\n  __syncthreads();\n}\n\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ unsigned char shared_mem[];\n\n#define SHARED_MEM_PARAM\n#define FUTHARK_KERNEL extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define FUTHARK_KERNEL_SIZED(a,b,c) extern \"C\" __global__ __launch_bounds__(a*b*c)\n\n// End of prelude.cu\n// Start of half.h.\n\n// Conversion functions are from http://half.sourceforge.net/, but\n// translated to C.\n//\n// Copyright (c) 2012-2021 Christian Rau\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n#ifndef __OPENCL_VERSION__\n#define __constant\n#endif\n\n__constant static const uint16_t base_table[512] = {\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0", "000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,\n  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,\n  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8",
                                    "000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,\n  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,\n  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };\n\n__constant static const unsigned char shift_table[512] = {\n  24, 24, 24, 24, 24, 24,", " 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2", "4, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };\n\n__constant static const uint32_t mantissa_table[2048] = {\n  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,\n  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,\n  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,\n  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,\n  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,\n  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,\n  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,\n  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,\n  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,\n  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x37",
                                    "1B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,\n  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,\n  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,\n  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,\n  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,\n  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,\n  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,\n  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,\n  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,\n  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,\n  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,\n  0x", "37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,\n  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,\n  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,\n  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,\n  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,\n  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,\n  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,\n  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,\n  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,\n  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,\n  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x", "37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,\n  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,\n  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,\n  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,\n  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,\n  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,\n  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,\n  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,\n  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,\n  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,\n  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x",
                                    "38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,\n  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,\n  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,\n  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,\n  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,\n  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,\n  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,\n  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,\n  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,\n  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,\n  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x", "384BC000,\n  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,\n  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,\n  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,\n  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,\n  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,\n  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,\n  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,\n  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,\n  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,\n  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,\n  0x38740000, 0x38744000, 0x38748000, 0x3874C000, ", "0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,\n  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,\n  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,\n  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,\n  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,\n  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,\n  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,\n  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,\n  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,\n  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,\n  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, ",
                                    "0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,\n  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,\n  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,\n  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,\n  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,\n  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,\n  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,\n  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,\n  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,\n  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,\n  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, ", "0x3823C000, 0x3823E000,\n  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,\n  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,\n  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,\n  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,\n  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,\n  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,\n  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,\n  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,\n  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,\n  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,\n  0x38380000, 0x38382000, 0x38384000", ", 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,\n  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,\n  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,\n  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,\n  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,\n  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,\n  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,\n  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,\n  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,\n  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,\n  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000",
                                    ", 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,\n  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,\n  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,\n  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,\n  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,\n  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,\n  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,\n  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,\n  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,\n  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,\n  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000", ", 0x3861A000, 0x3861C000, 0x3861E000,\n  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,\n  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,\n  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,\n  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,\n  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,\n  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,\n  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,\n  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,\n  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,\n  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,\n  0x38760000, 0x387620", "00, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,\n  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,\n  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,\n  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,\n  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };\n__constant static const uint32_t exponent_table[64] = {\n  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,\n  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,\n  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,\n  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };\n__constant static const unsigned short offset_table[64] = {\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1",
                                    "024, 1024, 1024, 1024, 1024, 1024,\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };\n\nSCALAR_FUN_ATTR uint16_t float2halfbits(float value) {\n  union { float x; uint32_t y; } u;\n  u.x = value;\n  uint32_t bits = u.y;\n\n  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;\n\n  return hbits;\n}\n\nSCALAR_FUN_ATTR float halfbits2float(uint16_t value) {\n  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];\n\n  union { uint32_t x; float y; } u;\n  u.x = bits;\n  return u.y;\n}\n\nSCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {\n  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;\n  if(fabs > 0x7C00 || tabs > 0x7C00) {\n    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);\n  }\n  if(from == to || !(fabs|tabs)) {\n    return to;\n  }\n  if(!fabs) {\n    return (to&0x8000)+1;\n  }\n  unsigned int out =\n    from +\n    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)\n    - 1;\n  return out;\n}\n\n// End of half.h.\n// Start of scalar.h.\n\n// Implementation of the primitive scalar operations.  Very\n// repetitive.  This code is inserted directly into both CUDA and\n// OpenCL programs, as well as the CPU code, so it has some #ifdefs to\n// work everywhere.  Some operations are defined as macros because\n// this allows us to use them as constant expressions in things like\n// array sizes and static initialisers.\n\n// Some of the #ifdefs are because OpenCL uses type-generic functions\n// for some operations (e.g. sqrt), while C and CUDA sensibly use\n// distinct functions for different precisions (e.g. sqrtf() and\n// sqrt()).  This is quite annoying.  Due to C's unfortunate casting\n// rules, it is also really easy to accidentally implement\n// floating-point functions in the wrong precision, so be careful.\n\n/", "/ Double-precision definitions are only included if the preprocessor\n// macro FUTHARK_F64_ENABLED is set.\n\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);\n\nSCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {\n  return x * y;\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  // This strange pattern is used to prevent the ISPC compiler from\n  // causing SIGFPEs and bogus results on divisions where inactive lanes\n  // have 0-valued divisors. It ensures that any inactive lane instead\n  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  uint", "8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALA",
                                    "R_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t q = x / ys;\n  int8_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t q = x / ys;\n  int16_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n  int32_t q = x / ys;\n  int32_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t q = x / ys;\n  int64_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y)", " {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int32_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) ", "{\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  ",
                                    "foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\n#else\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  return", " y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t q = x / y;\n  int8_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t q = x / y;\n  int16_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t q = x / y;\n  int32_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t q = x / y;\n  int64_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t r = ", "x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t ",
                                    "y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {\n  return (uint8_t)(x << y);\n}\n\nS", "CALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {\n  return (uint16_t)(x << y);\n}\n\nSCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult64(uint64_t x, uint64", "_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {\n  uint8_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {\n  uint16_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {\n  uint32_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {\n  uint64_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x",
                                    ") {\n  return x;\n}\n\nSCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {\n  return x;\n}\n\n#define sext_i8_i8(x) ((int8_t) (int8_t) (x))\n#define sext_i8_i16(x) ((int16_t) (int8_t) (x))\n#define sext_i8_i32(x) ((int32_t) (int8_t) (x))\n#define sext_i8_i64(x) ((int64_t) (int8_t) (x))\n#define sext_i16_i8(x) ((int8_t) (int16_t) (x))\n#define sext_i16_i16(x) ((int16_t) (int16_t) (x))\n#define sext_i16_i32(x) ((int32_t) (int16_t) (x))\n#define sext_i16_i64(x) ((int64_t) (int16_t) (x))\n#define sext_i32_i8(x) ((int8_t) (int32_t) (x))\n#define sext_i32_i16(x) ((int16_t) (int32_t) (x))\n#define sext_i32_i32(x) ((int32_t) (int32_t) (x))\n#define sext_i32_i64(x) ((int64_t) (int32_t) (x))\n#define sext_i64_i8(x) ((int8_t) (int64_t) (x))\n#define sext_i64_i16(x) ((int16_t) (int64_t) (x))\n#define sext_i64_i32(x) ((int32_t) (int64_t) (x))\n#define sext_i64_i64(x) ((int64_t) (int64_t) (x))\n#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))\n#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))\n#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))\n#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))\n#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))\n#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))\n#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))\n#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))\n#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))\n#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))\n#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))\n#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))\n#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))\n#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))\n#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))\n#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))\n\nSCALAR_FUN_ATTR int8_t abs8(int8_t x) {\n  return (int8_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int16_t abs16(int16_t x) {\n  return (int16_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int32_t abs32(int32_t x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR int64_t abs64(int64_t x) {\n#if defined(__OPENCL_VER", "SION__) || defined(ISPC)\n  return abs(x);\n#else\n  return llabs(x);\n#endif\n}\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return __popc(zext_i8_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return __popc(zext_i16_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return __popc(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return __popcll(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return m", "ul_hi(a, b); }\n#elif defined(__CUDA_ARCH__)\nSCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }\nSCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }\n#elif ISPC\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 = al * bl;\n  uint64_t p2 = al * bh;\n  uint64_t p3 = ah * bl;\n  uint64_t p4 = ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\nSCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR int",
                                    "32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 =  al * bl;\n  int64_t  p2 = al * bh;\n  int64_t  p3 = ah * bl;\n  uint64_t p4 =  ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\n\n#else // Not OpenCL, ISPC, or CUDA, but plain C.\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }\nSCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t ", "a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }\n#else // Not OpenCL\n\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return clz(x);\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return __clz(zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return __clz(zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  retur", "n __clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return __clzll(x);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return count_leading_zeros((int32_t)(uint8_t)x)-24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return count_leading_zeros((int32_t)(uint16_t)x)-16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return count_leading_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return count_leading_zeros(x);\n}\n\n#else // Not OpenCL, ISPC or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_clz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int i = 0;\n  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int i = 0;\n  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int i = 0;\n  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int i = 0;\n  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 8 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 16 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 32 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int y = __ffsll(x);\n  return y == 0 ? 64 : y - 1",
                                    ";\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return count_trailing_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return count_trailing_zeros(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);\n}\n#endif\n\nSCALAR_FUN_ATTR float fdiv32(float x, float y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR float fadd32(float x, float y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR float fsub32(float x, float y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR float fmul32(float x, float y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt32(float x, float y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple32(float x, float y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {\n  return (float) x;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, f", "loat y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return pow(x, y);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float a, float b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\n#else // Not OpenCL, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return powf(x, y);\n}\n#endif\n\nSCALAR_FUN_ATTR bool futrts_isnan32(float x) {\n  return isnan(x);\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite32(float x) {\n  return !isnan(x) && !futrts_isinf32(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return isinf(x);\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  };\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {", "\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f32_bool(float x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR float btof_bool_f32(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinh(x);\n}\n\nSC",
                                    "ALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fma(a, b, c);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return futrts_log32(x) / log(2.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return futrts_log32(x) / log(10.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;\n  float y = 1.0f + x;\n  float z = y - 1.0f;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform float cbrtf(uniform float);\nSCALAR_FUN_ATTR float futrts_cbrt32(float", " x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return (exp(x)+exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return (exp(x)-exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return futrts_sinh32(x)/futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  float f = x+sqrt(x*x-1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  float f = x+sqrt(x*x+1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  float f = (1+x)/(1-x);\n  if(futrts_isfinite32(f)) return log(f)/2.0f;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {\n    x = abs(x);\n    y = abs(y);\n    float a;\n    float b;\n    if (x >= y){\n        a = x;\n        b = y;\n    } else {\n        a = y;\n        b = x;\n    }\n    if(b == 0){\n      return a;\n    }\n\n    int e;\n    float an;\n    float bn;\n    an = frexp (a, &e);\n    bn = ldexp (b, - e);\n    float cn;\n    cn = sqrt (an * an + bn * bn);\n    return ldexp (cn, e);\n  } else {\n    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;\n    else return x + y;\n  }\n\n}\n\nextern \"C\" unmasked uniform float tgammaf(", "uniform float x);\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = tgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = lgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erff(uniform float x);\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erff(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erfcf(uniform float x);\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erfcf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform float nextafterf(uniform float x, uniform float y);\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  float res;\n  foreach_active (i) {\n    uniform float r = nextafterf(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  int32_t xb = futrts_to_bits32(x);\n  int32_t yb = futrts_to_bits32(y);\n  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futr",
                                    "ts_fma32(float a, float b, float c) {\n  return a * b + c;\n}\n\n#else // Not OpenCL or ISPC, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return logf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1pf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return expf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  re", "turn rintf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floorf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceilf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafterf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexpf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysignf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fmaf(a, b, c);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  return intbits(x);\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  return floatbits(x);\n}\n#else\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  union {\n    float f;\n    int32_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  union {\n    int32_t f;\n    float t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\nSCALAR_FUN_ATTR float fsignum32(float x) {\n  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf64(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite64(float x) {\n  return !isnan(x) && !futrts_isinf64(x);\n}\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}", "\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double a, double b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return futrts_log64(x)/log(2.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return futrts_log64(x)/log(10.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;\n  double y = 1.0d + x;\n  double z = y - 1.0d;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform double cbrt(uniform double);\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(dou",
                                    "ble x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return (exp(x)+exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return (exp(x)-exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return futrts_sinh64(x)/futrts_cosh64(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  double f = x+sqrt(x*x-1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  double f = x+sqrt(x*x+1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  double f = (1.0d+x)/(1.0d-x);\n  if(futrts_isfinite64(f)) return log(f)/2.0d;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nextern \"C\" unmasked uniform double hypot(uniform double x, uniform double y);\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = hypot(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double tgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = tgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double lgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = lgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erf(uniform double x);\nSCALAR_FUN_ATTR do", "uble futrts_erf64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erfc(uniform double x);\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erfc(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform double nextafter(uniform float x, uniform double y);\nSCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = nextafter(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int", "16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0.0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1.0 : 0.0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  int64_t res;\n  foreach_active (i) {\n    uniform double tmp = extract(x, i);\n    uniform int64_t r = *((uniform int64_t* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  double res;\n  foreach_active (i) {\n    uniform int64_t tmp = extract(x, i);\n    uniform double r = *((uniform double* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {\n  int64_t xb = futrts_to_bits64(x);\n  int64_t yb = futrts_to_bits64(y);\n  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#e",
                                    "lse\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double x, double y) {\n  return pow(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(double x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  r", "eturn tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erf64(double x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return fma(a, b, c);\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf64(double x) {\n  return isinf(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x", ") {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1 : 0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  union {\n    double f;\n    int64_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  union {\n    int64_t f;\n    double t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n#ifdef __OPENCL_VERSION__\n  return mix(v0, v1, t);\n#else\n  return v0 + (v1 - v0) * t;\n#endif\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n#ifdef __OPENCL_VERSION__\n  return mad(a, b, c);\n#else\n  return a * b + c;\n#endif\n}\n\nSCALAR",
                                    "_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#endif\n\n#endif\n\n// End of scalar.h.\n// Start of scalar_f16.h.\n\n// Half-precision is emulated if needed (e.g. in straight C) with the\n// native type used if possible.  The emulation works by typedef'ing\n// 'float' to 'f16', and then implementing all operations on single\n// precision.  To cut down on duplication, we use the same code for\n// those Futhark functions that require just operators or casts.  The\n// in-memory representation for arrays will still be 16 bits even\n// under emulation, so the compiler will have to be careful when\n// generating reads or writes.\n\n#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))\n#define EMULATE_F16\n#endif\n\n#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)\n#pragma OPENCL EXTENSION cl_khr_fp16 : enable\n#endif\n\n#ifdef EMULATE_F16\n\n// Note that the half-precision storage format is still 16 bits - the\n// compiler will have to be real careful!\ntypedef float f16;\n\n#elif ISPC\ntypedef float16 f16;\n\n#else\n\n#ifdef __CUDA_ARCH__\n#include <cuda_fp16.h>\n#endif\n\ntypedef half f16;\n\n#endif\n\n// Some of these functions convert to single precision because half\n// precision versions are not available.\n\nSCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {\n  return (f16) x;\n}\n\nSCALAR", "_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {\n  return (int8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {\n  return (int16_t) x;\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {\n  return (int32_t) x;\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {\n  return (int64_t) x;\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {\n  return (uint8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {\n  return (uint16_t) x;\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {\n  return (uint32_t) x;\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {\n  return (uint64_t) x;\n}\n\nSCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {\n  return x != (f16)0;\n}\n\nSCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifndef EMULATE_F16\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return isnan((float)x);\n}\n\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#elif ISPC\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#else // Assuming CUDA.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 ", "x, f16 y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return powf(x, y);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf16(float x) {\n  return !futrts_isnan16(x) && futrts_isnan16(x - x);\n}\nSCALAR_FUN_ATTR bool futrts_isfinite16(float x) {\n  return !futrts_isnan16(x) && !futrts_isinf16(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return isinf((float)x);\n}\n#endif\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return e",
                                    "rf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fma(a, b, c);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log16(x) / log(2.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log16(x) / log(10.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;\n  f16 y = 1.0f16 + x;\n  f16 z = y - 1.0f16;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return (float16)sqrt((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return (float16)cos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return (float16)sin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return (float16)tan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return (float16)acos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return (float16)asin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return (float16)atan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  retu", "rn (exp(x)+exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return (exp(x)-exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_sinh16(x)/futrts_cosh16(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x-1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x+1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  float16 f = (1+x)/(1-x);\n  if(futrts_isfinite16(f)) return log(f)/2.0f16;\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return (float16)atan2((float)x, (float)y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return (float16)futrts_hypot32((float)x, (float)y);\n}\n\nextern \"C\" unmasked uniform float tgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)tgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)lgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  f16 res = (f16)futrts_cbrt32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  f16 res = (f16)futrts_erf32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  f16 res = (f16)futrts_erfc32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return x - y * (float16)trunc((float) (x/y));\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return (float16)round((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return (float16)floor((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return (float16)ceil((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrt", "s_nextafter16(f16 x, f16 y) {\n  return (float16)futrts_nextafter32((float)x, (float) y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\n#else // Assume CUDA.\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return hlog(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return hlog2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return hlog10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return (f16)log1pf((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return hsqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return hexp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return hcos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return hsin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f1",
                                    "6 x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rintf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return hfloor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return hceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fmaf(a, b, c);\n}\n\n#endif\n\n// The CUDA __half type cannot be put in unions for some reason, so we\n// use bespoke conversion functions instead.\n#ifdef __CUDA_ARCH__\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return __half_as_ushort(x);\n}\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return __ushort_as_half(x);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  varying int16_t y = *((varying int16_t * uniform)&x);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  varying f16 y = *((varying f16 * uniform)&x);\n  return y;\n}\n#else\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  union {\n    f16 f;\n    int16_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  union {\n    int16_t f;\n    f16 t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\n#else // No native f16 - emulate.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs32(x);\n}\n\nSC", "ALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return fpow32(x, y);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return futrts_isnan32(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return futrts_isinf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_log32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log2_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log10_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return futrts_log1p_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return futrts_sqrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return futrts_cbrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return futrts_exp32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return futrts_cos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return futrts_sin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return futrts_tan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return futrts_acos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return futrts_asin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return futrts_atan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return futrts_sinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_tanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return futrts_acosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return futrts_asinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return futrts_atanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return futrts_atan2_32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return futrts_hypot32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return futrts_gamma32(x);\n}\n\nSCA", "LAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return futrts_lgamma32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return futrts_erf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return futrts_erfc32(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return futrts_round32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return futrts_floor32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return futrts_ceil32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return futrts_lerp32(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return futrts_mad32(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return futrts_fma32(a, b, c);\n}\n\n// Even when we are using an OpenCL that does not support cl_khr_fp16,\n// it must still support vload_half for actually creating a\n// half-precision number, which can then be efficiently converted to a\n// float.  Similarly for vstore_half.\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  int16_t y;\n  // Violating strict aliasing here.\n  vstore_half((float)x, 0, (half*)&y);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return (f16)vload_half(0, (half*)&x);\n}\n\n#else\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return (int16_t)float2halfbits(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return halfbits2float((uint16_t)x);\n}\n\nSCALAR_FUN_ATTR f16 fsignum16(f16 x) {\n  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#endif\n\n#endif\n\nSCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {\n  retu",
                                    "rn x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {\n  return (f16) x;\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {\n  return (double) x;\n}\n\n#if ISPC\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) ((float)x);\n}\n#else\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) x;\n}\n#endif\n#endif\n\n\n// End of scalar_f16.h.\n// Start of atomics.h\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32", "_t *p, uint32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x);\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#el", "se\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  float ret;\n  asm volatile(\"atom.global.add.f32 %0,[%1],%2;\":\"=f\"(ret):\"l\"(p),\"f\"(x):\"memory\");\n  return ret;\n#elif defined(__opencl_c_ext_fp32_global_atomic_add)\n  // use hardware-supported atomic addition on some Intel GPUs\n  return atomic_fetch_add_explicit((volatile __global atomic_float*)p,\n                                   x,\n                                   memory_order_relaxed);\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f32)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f32(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  float old = x;\n  float ret;\n  while ((old=atomic_xchg(p, ret=atomic_xchg(p, 0.0f)+old))!=0.0f);\n  return ret;\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_shared((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile",
                                    " __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, ", "int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR uint", "64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x);\n\n#ifdef FUTHARK_F64_ENABLED\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x);\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x);\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val) {\n#if defined(F",
                                    "UTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  double ret;\n  asm volatile(\"atom.global.add.f64 %0,[%1],%2;\":\"=d\"(ret):\"l\"(p),\"d\"(x):\"memory\");\n  return ret;\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f64)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f64(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  union {int64_t i; double f;} old;\n  union {int64_t i; double f;} ret;\n  old.f = x;\n  while (1) {\n    ret.i = atom_xchg((volatile __global int64_t*)p, (int64_t)0);\n    ret.f += old.f;\n    old.i = atom_xchg((volatile __global int64_t*)p, ret.i);\n    if (old.i == 0) {\n      break;\n    }\n  }\n  return ret.f;\n#endif\n}\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  u", "nion { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do ", "{\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(v",
                                    "olatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n#endif // defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\n// End of atomics.h\n// Start of transpose.cl\n\n#define GEN_TRANSPOSE_KERNELS(NAME, ELEM_TYPE)                          \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_PER_THREAD, 1)\\\nvoid map_transpose_##NAME(SHARED_MEM_PARAM                              \\\n                          __global ELEM_TYPE *dst_mem,                  \\\n                          int64_t dst_offset,                           \\\n                          __global ELEM_TYPE *src_mem,                  \\\n                          int64_t src_offset,                           \\\n                          int32_t num_arrays,                           \\\n                          int32_t x_elems,                              \\\n                          int32_t y_elems,                              \\\n                          int32_t mulx,                                 \\\n                          int32_t muly,                                 \\\n                          int32_t repeat_1,                             \\\n                          int32_t repeat_2) {                           \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_g", "lobal_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = global_id_0;                                    \\\n      int32_t y_index = tblock_id_1 * TR_TILE_DIM + get_local_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_in", "dex + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_height(SHARED_MEM_PARAM                 \\\n                                                __global ELEM_TYPE *dst_mem, \\\n                                                int64_t dst_offset,     \\\n                                                __global ELEM_TYPE *src_mem, \\\n                                                int64_t src_offset,     \\\n                                                int32_t num_arrays,     \\\n                                                int32_t x_elems,        \\\n                                                int32_t y_elems,        \\\n                                                int32_t mulx,           \\\n                                                int32_t muly,           \\\n                                                int32_t repeat_1,       \\\n ",
                                    "                                               int32_t repeat_2) {     \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index =                                                 \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n        get_local_id(0) +                                               \\\n        get_local_id(1)%mulx * TR_BLOCK_DIM;                            \\\n      int32_t y_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(1)/mulx; \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(0)/mulx;      \\\n      y_index =                                                         \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n", "        get_local_id(1) +                                               \\\n        (get_local_id(0)%mulx) * TR_BLOCK_DIM;                          \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n      if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_width(SHARED_MEM_PARAM                  \\\n                                      __global ELEM_TYPE *dst_mem,      \\\n                                      int64_t dst_offset,               \\\n                                      __global ELEM_TYPE *src_mem,      \\\n                                      int64_t src_offset,               \\\n                                      int32_t num_arrays,               \\\n                                      int32_t x_elems,                  \\\n                                      int32_t y_elems,                  \\\n                                      int32_t mulx,                     \\\n                                      int32_t muly,                     \\\n                                      int32_t repeat_1,                 \\\n  ", "                                    int32_t repeat_2) {               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(0)/muly; \\\n      int32_t y_index =                                                 \\\n        tblock_id_1 * TR_BLOCK_DIM * muly +                             \\\n        get_local_id(1) + (get_local_id(0)%muly) * TR_BLOCK_DIM;        \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM * muly +                     \\\n        get_local_id(0) + (get_local_id(1)%muly) * TR_BLOCK_DIM;        \\\n      y_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(1)/muly;      \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n ",
                                    "     if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_num_tblocks(2) * get_local_size(2);            \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_num_tblocks(1) * get_local_size(1);              \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*TR_BLOCK_DIM, 1, 1)                   \\\nvoid map_transpose_##NAME##_small(SHARED_MEM_PARAM                       \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int32_t num_arrays,                   \\\n                                  int32_t x_elems,                      \\\n                                  int32_t y_elems,                      \\\n                                  int32_t mulx,                         \\\n                                  int32_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  ", "int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = global_id_0/(y_elems * x_elems) * y_elems * x_elems; \\\n      int32_t x_index = (global_id_0 % (y_elems * x_elems))/y_elems;    \\\n      int32_t y_index = global_id_0%y_elems;                            \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      int32_t index_out = x_index * y_elems + y_index;                  \\\n      if (global_id_0 < x_elems * y_elems * num_arrays) {               \\\n        dst_mem[odata_offset + index_out] = src_mem[idata_offset + index_in]; \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_", "PER_THREAD, 1)\\\nvoid map_transpose_##NAME##_large(SHARED_MEM_PARAM                      \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int64_t num_arrays,                   \\\n                                  int64_t x_elems,                      \\\n                                  int64_t y_elems,                      \\\n                                  int64_t mulx,                         \\\n                                  int64_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;             \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int64_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int64_t odata_offset = dst_offset + our_array_offset;             \\\n      int64_t idata_offset = src_offset + our_array_offset;             \\\n      int64_t x_index = global_id_0;                                    \\\n      int64_t y_index = tblock_id_1 * TR_TILE_DIM + get_loc",
                                    "al_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                      ", "                             \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n\nGEN_TRANSPOSE_KERNELS(1b, uint8_t)\nGEN_TRANSPOSE_KERNELS(2b, uint16_t)\nGEN_TRANSPOSE_KERNELS(4b, uint32_t)\nGEN_TRANSPOSE_KERNELS(8b, uint64_t)\n\n// End of transpose.cl\n// Start of copy.cl\n\n#define GEN_COPY_KERNEL(NAME, ELEM_TYPE) \\\nFUTHARK_KERNEL void lmad_copy_##NAME(SHARED_MEM_PARAM                   \\\n                               __global ELEM_TYPE *dst_mem,             \\\n                               int64_t dst_offset,                      \\\n                               __global ELEM_TYPE *src_mem,             \\\n                               int64_t src_offset,                      \\\n                               int64_t n,                               \\\n                               int r,                                   \\\n                               int64_t shape0, int64_t dst_stride0, int64_t src_stride0, \\\n                               int64_t shape1, int64_t dst_stride1, int64_t src_stride1, \\\n                               int64_t shape2, int64_t dst_stride2, int64_t src_stride2, \\\n                               int64_t shape3, int64_t dst_stride3, int64_t src_stride3, \\\n                               int64_t shape4, int64_t dst_stride4, int64_t src_stride4, \\\n                               int64_t shape5, int64_t dst_stride5, int64_t src_stride5, \\\n                               int64_t shape6, int64_t dst_stride6, int64_t src_stride6, \\\n                               int64_t shape7, int64_t dst_stride7, int64_t src_stride7) { \\\n  int64_t gtid = get_global_id(0);                                      \\\n  int64_t remainder = gtid;                                             \\\n                                             ", "                           \\\n  if (gtid >= n) {                                                      \\\n    return;                                                             \\\n  }                                                                     \\\n                                                                        \\\n  if (r > 0) {                                                          \\\n    int64_t i = remainder % shape0;                                     \\\n    dst_offset += i * dst_stride0;                                      \\\n    src_offset += i * src_stride0;                                      \\\n    remainder /= shape0;                                                \\\n  }                                                                     \\\n  if (r > 1) {                                                          \\\n    int64_t i = remainder % shape1;                                     \\\n    dst_offset += i * dst_stride1;                                      \\\n    src_offset += i * src_stride1;                                      \\\n    remainder /= shape1;                                                \\\n  }                                                                     \\\n  if (r > 2) {                                                          \\\n    int64_t i = remainder % shape2;                                     \\\n    dst_offset += i * dst_stride2;                                      \\\n    src_offset += i * src_stride2;                                      \\\n    remainder /= shape2;                                                \\\n  }                                                                     \\\n  if (r > 3) {                                                          \\\n    int64_t i = remainder % shape3;                                     \\\n    dst_offset += i * dst_stride3;                                      \\\n    src_offset += i * src_stride3;                                      \\\n    remainder /= shape3;                       ",
                                    "                         \\\n  }                                                                     \\\n  if (r > 4) {                                                          \\\n    int64_t i = remainder % shape4;                                     \\\n    dst_offset += i * dst_stride4;                                      \\\n    src_offset += i * src_stride4;                                      \\\n    remainder /= shape4;                                                \\\n  }                                                                     \\\n  if (r > 5) {                                                          \\\n    int64_t i = remainder % shape5;                                     \\\n    dst_offset += i * dst_stride5;                                      \\\n    src_offset += i * src_stride5;                                      \\\n    remainder /= shape5;                                                \\\n  }                                                                     \\\n  if (r > 6) {                                                          \\\n    int64_t i = remainder % shape6;                                     \\\n    dst_offset += i * dst_stride6;                                      \\\n    src_offset += i * src_stride6;                                      \\\n    remainder /= shape6;                                                \\\n  }                                                                     \\\n  if (r > 7) {                                                          \\\n    int64_t i = remainder % shape7;                                     \\\n    dst_offset += i * dst_stride7;                                      \\\n    src_offset += i * src_stride7;                                      \\\n    remainder /= shape7;                                                \\\n  }                                                                     \\\n                                                                        \\\n  dst_mem[dst_offset] = src_mem[src_offset];     ", "                       \\\n}\n\nGEN_COPY_KERNEL(1b, uint8_t)\nGEN_COPY_KERNEL(2b, uint16_t)\nGEN_COPY_KERNEL(4b, uint32_t)\nGEN_COPY_KERNEL(8b, uint64_t)\n\n// End of copy.cl\n\n\n\nFUTHARK_KERNEL\nvoid builtinzhiota_i64ziiota_i64_78706(int64_t n_78702, int64_t x_78703, int64_t s_78704, int64_t virt_num_tblocks_78711, int64_t num_tblocks_78712, __global unsigned char *mem_78701)\n{\n    int32_t iota_ltid_78707;\n    int32_t tblock_sizze_78709;\n    int32_t iota_gid_78708;\n    int32_t iota_gtid_78706;\n    int32_t phys_tblock_id_78713;\n    int32_t iterations_78714;\n    \n    iota_ltid_78707 = get_local_id(0);\n    tblock_sizze_78709 = get_local_size(0);\n    iota_gid_78708 = get_tblock_id(0);\n    iota_gtid_78706 = iota_gid_78708 * tblock_sizze_78709 + iota_ltid_78707;\n    phys_tblock_id_78713 = get_tblock_id(0);\n    iterations_78714 = sdiv_up32(sext_i64_i32(virt_num_tblocks_78711) - phys_tblock_id_78713, sext_i64_i32(num_tblocks_78712));\n    for (int32_t i_78715 = 0; i_78715 < iterations_78714; i_78715++) {\n        int32_t virt_tblock_id_78716;\n        int64_t global_tid_78717;\n        \n        virt_tblock_id_78716 = phys_tblock_id_78713 + i_78715 * sext_i64_i32(num_tblocks_78712);\n        global_tid_78717 = sext_i32_i64(virt_tblock_id_78716) * sext_i32_i64(tblock_sizze_78709) + sext_i32_i64(iota_ltid_78707);\n        if (slt64(global_tid_78717, n_78702)) {\n            ((__global int64_t *) mem_78701)[global_tid_78717] = add64(mul64(global_tid_78717, s_78704), x_78703);\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f32zireplicate_78735(int64_t num_elems_78731, float val_78732, int64_t replicate_n_78734, int64_t virt_num_tblocks_78740, int64_t num_tblocks_78741, __global unsigned char *mem_78730)\n{\n    int32_t replicate_ltid_78736;\n    int32_t tblock_sizze_78738;\n    int32_t replicate_gid_78737;\n    int32_t replicate_gtid_78735;\n    int32_t phys_tblock_id_78742;\n    int32_t iterations_78743;\n", "    \n    replicate_ltid_78736 = get_local_id(0);\n    tblock_sizze_78738 = get_local_size(0);\n    replicate_gid_78737 = get_tblock_id(0);\n    replicate_gtid_78735 = replicate_gid_78737 * tblock_sizze_78738 + replicate_ltid_78736;\n    phys_tblock_id_78742 = get_tblock_id(0);\n    iterations_78743 = sdiv_up32(sext_i64_i32(virt_num_tblocks_78740) - phys_tblock_id_78742, sext_i64_i32(num_tblocks_78741));\n    for (int32_t i_78744 = 0; i_78744 < iterations_78743; i_78744++) {\n        int32_t virt_tblock_id_78745;\n        int64_t global_tid_78746;\n        int64_t slice_78748;\n        int64_t rep_i_78747;\n        int64_t remnant_78749;\n        \n        virt_tblock_id_78745 = phys_tblock_id_78742 + i_78744 * sext_i64_i32(num_tblocks_78741);\n        global_tid_78746 = sext_i32_i64(virt_tblock_id_78745) * sext_i32_i64(tblock_sizze_78738) + sext_i32_i64(replicate_ltid_78736);\n        slice_78748 = num_elems_78731;\n        rep_i_78747 = global_tid_78746;\n        remnant_78749 = global_tid_78746 - rep_i_78747;\n        if (slt64(global_tid_78746, replicate_n_78734)) {\n            ((__global float *) mem_78730)[rep_i_78747] = val_78732;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f64zireplicate_78735(int64_t num_elems_78731, double val_78732, int64_t replicate_n_78734, int64_t virt_num_tblocks_78740, int64_t num_tblocks_78741, __global unsigned char *mem_78730)\n{\n    int32_t replicate_ltid_78736;\n    int32_t tblock_sizze_78738;\n    int32_t replicate_gid_78737;\n    int32_t replicate_gtid_78735;\n    int32_t phys_tblock_id_78742;\n    int32_t iterations_78743;\n    \n    replicate_ltid_78736 = get_local_id(0);\n    tblock_sizze_78738 = get_local_size(0);\n    replicate_gid_78737 = get_tblock_id(0);\n    replicate_gtid_78735 = replicate_gid_78737 * tblock_sizze_78738 + replicate_ltid_78736;\n    phys_tblock_id_78742 = get_tblock_id(0);\n    iterations_78743 = sdiv_up32(sext_i64_i32(virt_num_tblo",
                                    "cks_78740) - phys_tblock_id_78742, sext_i64_i32(num_tblocks_78741));\n    for (int32_t i_78744 = 0; i_78744 < iterations_78743; i_78744++) {\n        int32_t virt_tblock_id_78745;\n        int64_t global_tid_78746;\n        int64_t slice_78748;\n        int64_t rep_i_78747;\n        int64_t remnant_78749;\n        \n        virt_tblock_id_78745 = phys_tblock_id_78742 + i_78744 * sext_i64_i32(num_tblocks_78741);\n        global_tid_78746 = sext_i32_i64(virt_tblock_id_78745) * sext_i32_i64(tblock_sizze_78738) + sext_i32_i64(replicate_ltid_78736);\n        slice_78748 = num_elems_78731;\n        rep_i_78747 = global_tid_78746;\n        remnant_78749 = global_tid_78746 - rep_i_78747;\n        if (slt64(global_tid_78746, replicate_n_78734)) {\n            ((__global double *) mem_78730)[rep_i_78747] = val_78732;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i16zireplicate_78735(int64_t num_elems_78731, int16_t val_78732, int64_t replicate_n_78734, int64_t virt_num_tblocks_78740, int64_t num_tblocks_78741, __global unsigned char *mem_78730)\n{\n    int32_t replicate_ltid_78736;\n    int32_t tblock_sizze_78738;\n    int32_t replicate_gid_78737;\n    int32_t replicate_gtid_78735;\n    int32_t phys_tblock_id_78742;\n    int32_t iterations_78743;\n    \n    replicate_ltid_78736 = get_local_id(0);\n    tblock_sizze_78738 = get_local_size(0);\n    replicate_gid_78737 = get_tblock_id(0);\n    replicate_gtid_78735 = replicate_gid_78737 * tblock_sizze_78738 + replicate_ltid_78736;\n    phys_tblock_id_78742 = get_tblock_id(0);\n    iterations_78743 = sdiv_up32(sext_i64_i32(virt_num_tblocks_78740) - phys_tblock_id_78742, sext_i64_i32(num_tblocks_78741));\n    for (int32_t i_78744 = 0; i_78744 < iterations_78743; i_78744++) {\n        int32_t virt_tblock_id_78745;\n        int64_t global_tid_78746;\n        int64_t slice_78748;\n        int64_t rep_i_78747;\n        int64_t remnant_78749;\n        \n        virt_tblock_i", "d_78745 = phys_tblock_id_78742 + i_78744 * sext_i64_i32(num_tblocks_78741);\n        global_tid_78746 = sext_i32_i64(virt_tblock_id_78745) * sext_i32_i64(tblock_sizze_78738) + sext_i32_i64(replicate_ltid_78736);\n        slice_78748 = num_elems_78731;\n        rep_i_78747 = global_tid_78746;\n        remnant_78749 = global_tid_78746 - rep_i_78747;\n        if (slt64(global_tid_78746, replicate_n_78734)) {\n            ((__global int16_t *) mem_78730)[rep_i_78747] = val_78732;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i32zireplicate_79117(int64_t num_elems_79113, int32_t val_79114, int64_t replicate_n_79116, int64_t virt_num_tblocks_79122, int64_t num_tblocks_79123, __global unsigned char *mem_79112)\n{\n    int32_t replicate_ltid_79118;\n    int32_t tblock_sizze_79120;\n    int32_t replicate_gid_79119;\n    int32_t replicate_gtid_79117;\n    int32_t phys_tblock_id_79124;\n    int32_t iterations_79125;\n    \n    replicate_ltid_79118 = get_local_id(0);\n    tblock_sizze_79120 = get_local_size(0);\n    replicate_gid_79119 = get_tblock_id(0);\n    replicate_gtid_79117 = replicate_gid_79119 * tblock_sizze_79120 + replicate_ltid_79118;\n    phys_tblock_id_79124 = get_tblock_id(0);\n    iterations_79125 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79122) - phys_tblock_id_79124, sext_i64_i32(num_tblocks_79123));\n    for (int32_t i_79126 = 0; i_79126 < iterations_79125; i_79126++) {\n        int32_t virt_tblock_id_79127;\n        int64_t global_tid_79128;\n        int64_t slice_79130;\n        int64_t rep_i_79129;\n        int64_t remnant_79131;\n        \n        virt_tblock_id_79127 = phys_tblock_id_79124 + i_79126 * sext_i64_i32(num_tblocks_79123);\n        global_tid_79128 = sext_i32_i64(virt_tblock_id_79127) * sext_i32_i64(tblock_sizze_79120) + sext_i32_i64(replicate_ltid_79118);\n        slice_79130 = num_elems_79113;\n        rep_i_79129 = global_tid_79128;\n        remnant_79131 = global_tid_79128", " - rep_i_79129;\n        if (slt64(global_tid_79128, replicate_n_79116)) {\n            ((__global int32_t *) mem_79112)[rep_i_79129] = val_79114;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i64zireplicate_78709(int64_t num_elems_78705, int64_t val_78706, int64_t replicate_n_78708, int64_t virt_num_tblocks_78714, int64_t num_tblocks_78715, __global unsigned char *mem_78704)\n{\n    int32_t replicate_ltid_78710;\n    int32_t tblock_sizze_78712;\n    int32_t replicate_gid_78711;\n    int32_t replicate_gtid_78709;\n    int32_t phys_tblock_id_78716;\n    int32_t iterations_78717;\n    \n    replicate_ltid_78710 = get_local_id(0);\n    tblock_sizze_78712 = get_local_size(0);\n    replicate_gid_78711 = get_tblock_id(0);\n    replicate_gtid_78709 = replicate_gid_78711 * tblock_sizze_78712 + replicate_ltid_78710;\n    phys_tblock_id_78716 = get_tblock_id(0);\n    iterations_78717 = sdiv_up32(sext_i64_i32(virt_num_tblocks_78714) - phys_tblock_id_78716, sext_i64_i32(num_tblocks_78715));\n    for (int32_t i_78718 = 0; i_78718 < iterations_78717; i_78718++) {\n        int32_t virt_tblock_id_78719;\n        int64_t global_tid_78720;\n        int64_t slice_78722;\n        int64_t rep_i_78721;\n        int64_t remnant_78723;\n        \n        virt_tblock_id_78719 = phys_tblock_id_78716 + i_78718 * sext_i64_i32(num_tblocks_78715);\n        global_tid_78720 = sext_i32_i64(virt_tblock_id_78719) * sext_i32_i64(tblock_sizze_78712) + sext_i32_i64(replicate_ltid_78710);\n        slice_78722 = num_elems_78705;\n        rep_i_78721 = global_tid_78720;\n        remnant_78723 = global_tid_78720 - rep_i_78721;\n        if (slt64(global_tid_78720, replicate_n_78708)) {\n            ((__global int64_t *) mem_78704)[rep_i_78721] = val_78706;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i8zireplicate_79091(int64_t num_elems_7",
                                    "9087, int8_t val_79088, int64_t replicate_n_79090, int64_t virt_num_tblocks_79096, int64_t num_tblocks_79097, __global unsigned char *mem_79086)\n{\n    int32_t replicate_ltid_79092;\n    int32_t tblock_sizze_79094;\n    int32_t replicate_gid_79093;\n    int32_t replicate_gtid_79091;\n    int32_t phys_tblock_id_79098;\n    int32_t iterations_79099;\n    \n    replicate_ltid_79092 = get_local_id(0);\n    tblock_sizze_79094 = get_local_size(0);\n    replicate_gid_79093 = get_tblock_id(0);\n    replicate_gtid_79091 = replicate_gid_79093 * tblock_sizze_79094 + replicate_ltid_79092;\n    phys_tblock_id_79098 = get_tblock_id(0);\n    iterations_79099 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79096) - phys_tblock_id_79098, sext_i64_i32(num_tblocks_79097));\n    for (int32_t i_79100 = 0; i_79100 < iterations_79099; i_79100++) {\n        int32_t virt_tblock_id_79101;\n        int64_t global_tid_79102;\n        int64_t slice_79104;\n        int64_t rep_i_79103;\n        int64_t remnant_79105;\n        \n        virt_tblock_id_79101 = phys_tblock_id_79098 + i_79100 * sext_i64_i32(num_tblocks_79097);\n        global_tid_79102 = sext_i32_i64(virt_tblock_id_79101) * sext_i32_i64(tblock_sizze_79094) + sext_i32_i64(replicate_ltid_79092);\n        slice_79104 = num_elems_79087;\n        rep_i_79103 = global_tid_79102;\n        remnant_79105 = global_tid_79102 - rep_i_79103;\n        if (slt64(global_tid_79102, replicate_n_79090)) {\n            ((__global int8_t *) mem_79086)[rep_i_79103] = val_79088;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_doublezisegmap_69171_dim1, 1, 1)\nvoid gather_payloads_doublezisegmap_69171(__global int *global_failure, int64_t niz2084U_61033, int64_t incr_61035, __global unsigned char *is_mem_77625, __global unsigned char *mem_77629)\n{\n    #define segmap_tblock_sizze_69167 (gather_payloads_doublezisegmap_69171zisegmap_tblock_sizze_69167)\n    if (*global_failure >= 0)\n        return;\n", "    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69171;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69170;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69171 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69167 + sext_i32_i64(local_tid_78703);\n    slice_78708 = niz2084U_61033;\n    gtid_69170 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69170;\n    if (slt64(gtid_69170, niz2084U_61033)) {\n        int64_t eta_p_69172;\n        int64_t lifted_lambda_res_69173;\n        \n        eta_p_69172 = ((__global int64_t *) is_mem_77625)[gtid_69170];\n        lifted_lambda_res_69173 = sub64(eta_p_69172, incr_61035);\n        ((__global int64_t *) mem_77629)[gtid_69170] = lifted_lambda_res_69173;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69167\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_doublezisegmap_69199_dim1, 1, 1)\nvoid gather_payloads_doublezisegmap_69199(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_61033, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77626, __global unsigned char *mem_param_77634, __global unsigned char *mem_param_77637, __global unsigned char *mem_77642)\n{\n    #define segmap_tblock_sizze_69195 (gather_payloads_doublezisegmap_69199zisegmap_tblock_sizze_69195)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    i", "nt64_t phys_tid_69199;\n    int64_t global_tid_78742;\n    int64_t slice_78743;\n    int64_t gtid_69198;\n    int64_t remnant_78744;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    phys_tid_69199 = sext_i32_i64(global_tid_78737);\n    global_tid_78742 = sext_i32_i64(block_id_78739) * segmap_tblock_sizze_69195 + sext_i32_i64(local_tid_78738);\n    slice_78743 = niz2084U_61033;\n    gtid_69198 = global_tid_78742;\n    remnant_78744 = global_tid_78742 - gtid_69198;\n    if (slt64(gtid_69198, niz2084U_61033)) {\n        int64_t eta_p_69200;\n        bool cond_69202;\n        bool cond_t_res_69203;\n        bool x_69204;\n        double lifted_lambda_res_69205;\n        \n        eta_p_69200 = ((__global int64_t *) mem_param_77634)[gtid_69198];\n        cond_69202 = sle64(lower_bound_63774, eta_p_69200);\n        cond_t_res_69203 = slt64(eta_p_69200, min_res_63776);\n        x_69204 = cond_69202 && cond_t_res_69203;\n        if (x_69204) {\n            int64_t tmp_69206;\n            bool x_69207;\n            bool y_69208;\n            bool bounds_check_69209;\n            bool index_certs_69210;\n            double tmp_69211;\n            \n            tmp_69206 = sub64(eta_p_69200, lower_bound_63774);\n            x_69207 = sle64((int64_t) 0, tmp_69206);\n            y_69208 = slt64(tmp_69206, j_m_i_63777);\n            bounds_check_69209 = x_69207 && y_69208;\n            if (!bounds_check_69209) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69206;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69211 = ((__global double *) ys_mem_77626)[et",
                                    "a_p_69200];\n            lifted_lambda_res_69205 = tmp_69211;\n        } else {\n            double eta_p_69201 = ((__global double *) mem_param_77637)[gtid_69198];\n            \n            lifted_lambda_res_69205 = eta_p_69201;\n        }\n        ((__global double *) mem_77642)[gtid_69198] = lifted_lambda_res_69205;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69195\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_double_GFURzisegmap_69451_dim1, 1, 1)\nvoid gather_payloads_double_GFURzisegmap_69451(__global int *global_failure, int64_t ni_62540, int64_t incr_62542, __global unsigned char *is_mem_77626, __global unsigned char *mem_77630)\n{\n    #define segmap_tblock_sizze_69447 (gather_payloads_double_GFURzisegmap_69451zisegmap_tblock_sizze_69447)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69451;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69450;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69451 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69447 + sext_i32_i64(local_tid_78703);\n    slice_78708 = ni_62540;\n    gtid_69450 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69450;\n    if (slt64(gtid_69450, ni_62540)) {\n        int64_t eta_p_69452;\n        int64_t lifted_lambda_res_69453;\n        \n        eta_p_69452 = ((__global int64_t *) is_mem_77626)[gtid_69450];\n        lifted_lambda_res_69453 = sub64(eta_p_69452, incr_62542);\n        ((__global int64_t *) mem_77630)[gtid_69450] = lifted_lambda_res_69453;\n    }\n    \n  error_0:\n    return;\n    #undef ", "segmap_tblock_sizze_69447\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_double_GFURzisegmap_69479_dim1, 1, 1)\nvoid gather_payloads_double_GFURzisegmap_69479(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_62540, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77627, __global unsigned char *mem_param_77633, __global unsigned char *mem_param_77636, __global unsigned char *mem_77641)\n{\n    #define segmap_tblock_sizze_69475 (gather_payloads_double_GFURzisegmap_69479zisegmap_tblock_sizze_69475)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78718;\n    int32_t tblock_sizze_78721;\n    int32_t wave_sizze_78720;\n    int32_t block_id_78719;\n    int32_t global_tid_78717;\n    int64_t phys_tid_69479;\n    int64_t global_tid_78722;\n    int64_t slice_78723;\n    int64_t gtid_69478;\n    int64_t remnant_78724;\n    \n    local_tid_78718 = get_local_id(0);\n    tblock_sizze_78721 = get_local_size(0);\n    wave_sizze_78720 = LOCKSTEP_WIDTH;\n    block_id_78719 = get_tblock_id(0);\n    global_tid_78717 = block_id_78719 * tblock_sizze_78721 + local_tid_78718;\n    phys_tid_69479 = sext_i32_i64(global_tid_78717);\n    global_tid_78722 = sext_i32_i64(block_id_78719) * segmap_tblock_sizze_69475 + sext_i32_i64(local_tid_78718);\n    slice_78723 = ni_62540;\n    gtid_69478 = global_tid_78722;\n    remnant_78724 = global_tid_78722 - gtid_69478;\n    if (slt64(gtid_69478, ni_62540)) {\n        int64_t eta_p_69480;\n        bool cond_69482;\n        bool cond_t_res_69483;\n        bool x_69484;\n        double lifted_lambda_res_69485;\n        \n        eta_p_69480 = ((__global int64_t *) mem_param_77633)[gtid_69478];\n        cond_69482 = sle64(lower_bound_63774, eta_p_69480);\n        cond_t_res_69483 = slt64(eta_p_69480, min_res_63776);\n        x_69484 = cond_69482 && cond_t_res_69483;\n        if (x_69484) {\n            int64_t tmp_69486;\n            bool x_69487;\n            bool y_69", "488;\n            bool bounds_check_69489;\n            bool index_certs_69490;\n            double tmp_69491;\n            \n            tmp_69486 = sub64(eta_p_69480, lower_bound_63774);\n            x_69487 = sle64((int64_t) 0, tmp_69486);\n            y_69488 = slt64(tmp_69486, j_m_i_63777);\n            bounds_check_69489 = x_69487 && y_69488;\n            if (!bounds_check_69489) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69486;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69491 = ((__global double *) ys_mem_77627)[eta_p_69480];\n            lifted_lambda_res_69485 = tmp_69491;\n        } else {\n            double eta_p_69481 = ((__global double *) mem_param_77636)[gtid_69478];\n            \n            lifted_lambda_res_69485 = eta_p_69481;\n        }\n        ((__global double *) mem_77641)[gtid_69478] = lifted_lambda_res_69485;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69475\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_floatzisegmap_69115_dim1, 1, 1)\nvoid gather_payloads_floatzisegmap_69115(__global int *global_failure, int64_t niz2084U_60693, int64_t incr_60695, __global unsigned char *is_mem_77625, __global unsigned char *mem_77629)\n{\n    #define segmap_tblock_sizze_69111 (gather_payloads_floatzisegmap_69115zisegmap_tblock_sizze_69111)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69115;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69114;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WID",
                                    "TH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69115 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69111 + sext_i32_i64(local_tid_78703);\n    slice_78708 = niz2084U_60693;\n    gtid_69114 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69114;\n    if (slt64(gtid_69114, niz2084U_60693)) {\n        int64_t eta_p_69116;\n        int64_t lifted_lambda_res_69117;\n        \n        eta_p_69116 = ((__global int64_t *) is_mem_77625)[gtid_69114];\n        lifted_lambda_res_69117 = sub64(eta_p_69116, incr_60695);\n        ((__global int64_t *) mem_77629)[gtid_69114] = lifted_lambda_res_69117;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69111\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_floatzisegmap_69143_dim1, 1, 1)\nvoid gather_payloads_floatzisegmap_69143(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_60693, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77626, __global unsigned char *mem_param_77634, __global unsigned char *mem_param_77637, __global unsigned char *mem_77642)\n{\n    #define segmap_tblock_sizze_69139 (gather_payloads_floatzisegmap_69143zisegmap_tblock_sizze_69139)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    int64_t phys_tid_69143;\n    int64_t global_tid_78742;\n    int64_t slice_78743;\n    int64_t gtid_69142;\n    int64_t remnant_78744;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    phys_tid_69143 = sext_i32_i64(global_", "tid_78737);\n    global_tid_78742 = sext_i32_i64(block_id_78739) * segmap_tblock_sizze_69139 + sext_i32_i64(local_tid_78738);\n    slice_78743 = niz2084U_60693;\n    gtid_69142 = global_tid_78742;\n    remnant_78744 = global_tid_78742 - gtid_69142;\n    if (slt64(gtid_69142, niz2084U_60693)) {\n        int64_t eta_p_69144;\n        bool cond_69146;\n        bool cond_t_res_69147;\n        bool x_69148;\n        float lifted_lambda_res_69149;\n        \n        eta_p_69144 = ((__global int64_t *) mem_param_77634)[gtid_69142];\n        cond_69146 = sle64(lower_bound_63774, eta_p_69144);\n        cond_t_res_69147 = slt64(eta_p_69144, min_res_63776);\n        x_69148 = cond_69146 && cond_t_res_69147;\n        if (x_69148) {\n            int64_t tmp_69150;\n            bool x_69151;\n            bool y_69152;\n            bool bounds_check_69153;\n            bool index_certs_69154;\n            float tmp_69155;\n            \n            tmp_69150 = sub64(eta_p_69144, lower_bound_63774);\n            x_69151 = sle64((int64_t) 0, tmp_69150);\n            y_69152 = slt64(tmp_69150, j_m_i_63777);\n            bounds_check_69153 = x_69151 && y_69152;\n            if (!bounds_check_69153) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69150;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69155 = ((__global float *) ys_mem_77626)[eta_p_69144];\n            lifted_lambda_res_69149 = tmp_69155;\n        } else {\n            float eta_p_69145 = ((__global float *) mem_param_77637)[gtid_69142];\n            \n            lifted_lambda_res_69149 = eta_p_69145;\n        }\n        ((__global float *) mem_77642)[gtid_69142] = lifted_lambda_res_69149;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69139\n}\nFUTHARK_KERNEL_SIZED(gather_payl", "oads_float_GFURzisegmap_69395_dim1, 1, 1)\nvoid gather_payloads_float_GFURzisegmap_69395(__global int *global_failure, int64_t ni_62239, int64_t incr_62241, __global unsigned char *is_mem_77626, __global unsigned char *mem_77630)\n{\n    #define segmap_tblock_sizze_69391 (gather_payloads_float_GFURzisegmap_69395zisegmap_tblock_sizze_69391)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69395;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69394;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69395 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69391 + sext_i32_i64(local_tid_78703);\n    slice_78708 = ni_62239;\n    gtid_69394 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69394;\n    if (slt64(gtid_69394, ni_62239)) {\n        int64_t eta_p_69396;\n        int64_t lifted_lambda_res_69397;\n        \n        eta_p_69396 = ((__global int64_t *) is_mem_77626)[gtid_69394];\n        lifted_lambda_res_69397 = sub64(eta_p_69396, incr_62241);\n        ((__global int64_t *) mem_77630)[gtid_69394] = lifted_lambda_res_69397;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69391\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_float_GFURzisegmap_69423_dim1, 1, 1)\nvoid gather_payloads_float_GFURzisegmap_69423(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_62239, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77627, __global unsigned char *mem_param_77633, __global uns",
                                    "igned char *mem_param_77636, __global unsigned char *mem_77641)\n{\n    #define segmap_tblock_sizze_69419 (gather_payloads_float_GFURzisegmap_69423zisegmap_tblock_sizze_69419)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78718;\n    int32_t tblock_sizze_78721;\n    int32_t wave_sizze_78720;\n    int32_t block_id_78719;\n    int32_t global_tid_78717;\n    int64_t phys_tid_69423;\n    int64_t global_tid_78722;\n    int64_t slice_78723;\n    int64_t gtid_69422;\n    int64_t remnant_78724;\n    \n    local_tid_78718 = get_local_id(0);\n    tblock_sizze_78721 = get_local_size(0);\n    wave_sizze_78720 = LOCKSTEP_WIDTH;\n    block_id_78719 = get_tblock_id(0);\n    global_tid_78717 = block_id_78719 * tblock_sizze_78721 + local_tid_78718;\n    phys_tid_69423 = sext_i32_i64(global_tid_78717);\n    global_tid_78722 = sext_i32_i64(block_id_78719) * segmap_tblock_sizze_69419 + sext_i32_i64(local_tid_78718);\n    slice_78723 = ni_62239;\n    gtid_69422 = global_tid_78722;\n    remnant_78724 = global_tid_78722 - gtid_69422;\n    if (slt64(gtid_69422, ni_62239)) {\n        int64_t eta_p_69424;\n        bool cond_69426;\n        bool cond_t_res_69427;\n        bool x_69428;\n        float lifted_lambda_res_69429;\n        \n        eta_p_69424 = ((__global int64_t *) mem_param_77633)[gtid_69422];\n        cond_69426 = sle64(lower_bound_63774, eta_p_69424);\n        cond_t_res_69427 = slt64(eta_p_69424, min_res_63776);\n        x_69428 = cond_69426 && cond_t_res_69427;\n        if (x_69428) {\n            int64_t tmp_69430;\n            bool x_69431;\n            bool y_69432;\n            bool bounds_check_69433;\n            bool index_certs_69434;\n            float tmp_69435;\n            \n            tmp_69430 = sub64(eta_p_69424, lower_bound_63774);\n            x_69431 = sle64((int64_t) 0, tmp_69430);\n            y_69432 = slt64(tmp_69430, j_m_i_63777);\n            bounds_check_69433 = x_69431 && y_69432;\n            if (!bounds_check_69433) {\n                {\n                    if (atom", "ic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69430;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69435 = ((__global float *) ys_mem_77627)[eta_p_69424];\n            lifted_lambda_res_69429 = tmp_69435;\n        } else {\n            float eta_p_69425 = ((__global float *) mem_param_77636)[gtid_69422];\n            \n            lifted_lambda_res_69429 = eta_p_69425;\n        }\n        ((__global float *) mem_77641)[gtid_69422] = lifted_lambda_res_69429;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69419\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_intzisegmap_69003_dim1, 1, 1)\nvoid gather_payloads_intzisegmap_69003(__global int *global_failure, int64_t niz2084U_60044, int64_t incr_60046, __global unsigned char *is_mem_77625, __global unsigned char *mem_77629)\n{\n    #define segmap_tblock_sizze_68999 (gather_payloads_intzisegmap_69003zisegmap_tblock_sizze_68999)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69003;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69002;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69003 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_68999 + sext_i32_i64(local_tid_78703);\n    slice_78708 = niz2084U_60044;\n    gtid_69002 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69002;\n    if (slt64(gtid_69002, niz20", "84U_60044)) {\n        int64_t eta_p_69004;\n        int64_t lifted_lambda_res_69005;\n        \n        eta_p_69004 = ((__global int64_t *) is_mem_77625)[gtid_69002];\n        lifted_lambda_res_69005 = sub64(eta_p_69004, incr_60046);\n        ((__global int64_t *) mem_77629)[gtid_69002] = lifted_lambda_res_69005;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68999\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_intzisegmap_69031_dim1, 1, 1)\nvoid gather_payloads_intzisegmap_69031(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_60044, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77626, __global unsigned char *mem_param_77634, __global unsigned char *mem_param_77637, __global unsigned char *mem_77642)\n{\n    #define segmap_tblock_sizze_69027 (gather_payloads_intzisegmap_69031zisegmap_tblock_sizze_69027)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    int64_t phys_tid_69031;\n    int64_t global_tid_78742;\n    int64_t slice_78743;\n    int64_t gtid_69030;\n    int64_t remnant_78744;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    phys_tid_69031 = sext_i32_i64(global_tid_78737);\n    global_tid_78742 = sext_i32_i64(block_id_78739) * segmap_tblock_sizze_69027 + sext_i32_i64(local_tid_78738);\n    slice_78743 = niz2084U_60044;\n    gtid_69030 = global_tid_78742;\n    remnant_78744 = global_tid_78742 - gtid_69030;\n    if (slt64(gtid_69030, niz2084U_60044)) {\n        int64_t eta_p_69032;\n        bool cond_69034;\n        bool cond_t_res_69035;\n        bool x_69036;\n        int32_t lifted_lambda_res_69037;\n      ",
                                    "  \n        eta_p_69032 = ((__global int64_t *) mem_param_77634)[gtid_69030];\n        cond_69034 = sle64(lower_bound_63774, eta_p_69032);\n        cond_t_res_69035 = slt64(eta_p_69032, min_res_63776);\n        x_69036 = cond_69034 && cond_t_res_69035;\n        if (x_69036) {\n            int64_t tmp_69038;\n            bool x_69039;\n            bool y_69040;\n            bool bounds_check_69041;\n            bool index_certs_69042;\n            int32_t tmp_69043;\n            \n            tmp_69038 = sub64(eta_p_69032, lower_bound_63774);\n            x_69039 = sle64((int64_t) 0, tmp_69038);\n            y_69040 = slt64(tmp_69038, j_m_i_63777);\n            bounds_check_69041 = x_69039 && y_69040;\n            if (!bounds_check_69041) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69038;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69043 = ((__global int32_t *) ys_mem_77626)[eta_p_69032];\n            lifted_lambda_res_69037 = tmp_69043;\n        } else {\n            int32_t eta_p_69033 = ((__global int32_t *) mem_param_77637)[gtid_69030];\n            \n            lifted_lambda_res_69037 = eta_p_69033;\n        }\n        ((__global int32_t *) mem_77642)[gtid_69030] = lifted_lambda_res_69037;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69027\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_int_GFURzisegmap_69283_dim1, 1, 1)\nvoid gather_payloads_int_GFURzisegmap_69283(__global int *global_failure, int64_t ni_61637, int64_t incr_61639, __global unsigned char *is_mem_77626, __global unsigned char *mem_77630)\n{\n    #define segmap_tblock_sizze_69279 (gather_payloads_int_GFURzisegmap_69283zisegmap_tblock_sizze_69279)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_", "sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69283;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69282;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69283 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69279 + sext_i32_i64(local_tid_78703);\n    slice_78708 = ni_61637;\n    gtid_69282 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69282;\n    if (slt64(gtid_69282, ni_61637)) {\n        int64_t eta_p_69284;\n        int64_t lifted_lambda_res_69285;\n        \n        eta_p_69284 = ((__global int64_t *) is_mem_77626)[gtid_69282];\n        lifted_lambda_res_69285 = sub64(eta_p_69284, incr_61639);\n        ((__global int64_t *) mem_77630)[gtid_69282] = lifted_lambda_res_69285;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69279\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_int_GFURzisegmap_69311_dim1, 1, 1)\nvoid gather_payloads_int_GFURzisegmap_69311(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_61637, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77627, __global unsigned char *mem_param_77633, __global unsigned char *mem_param_77636, __global unsigned char *mem_77641)\n{\n    #define segmap_tblock_sizze_69307 (gather_payloads_int_GFURzisegmap_69311zisegmap_tblock_sizze_69307)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78718;\n    int32_t tblock_sizze_78721;\n    int32_t wave_sizze_78720;\n    int32_t block_id_78719;\n    int32_t global_tid_78717;\n    int64_t phys_tid_69311;\n    int64_t global_tid_78722;\n    int64_t ", "slice_78723;\n    int64_t gtid_69310;\n    int64_t remnant_78724;\n    \n    local_tid_78718 = get_local_id(0);\n    tblock_sizze_78721 = get_local_size(0);\n    wave_sizze_78720 = LOCKSTEP_WIDTH;\n    block_id_78719 = get_tblock_id(0);\n    global_tid_78717 = block_id_78719 * tblock_sizze_78721 + local_tid_78718;\n    phys_tid_69311 = sext_i32_i64(global_tid_78717);\n    global_tid_78722 = sext_i32_i64(block_id_78719) * segmap_tblock_sizze_69307 + sext_i32_i64(local_tid_78718);\n    slice_78723 = ni_61637;\n    gtid_69310 = global_tid_78722;\n    remnant_78724 = global_tid_78722 - gtid_69310;\n    if (slt64(gtid_69310, ni_61637)) {\n        int64_t eta_p_69312;\n        bool cond_69314;\n        bool cond_t_res_69315;\n        bool x_69316;\n        int32_t lifted_lambda_res_69317;\n        \n        eta_p_69312 = ((__global int64_t *) mem_param_77633)[gtid_69310];\n        cond_69314 = sle64(lower_bound_63774, eta_p_69312);\n        cond_t_res_69315 = slt64(eta_p_69312, min_res_63776);\n        x_69316 = cond_69314 && cond_t_res_69315;\n        if (x_69316) {\n            int64_t tmp_69318;\n            bool x_69319;\n            bool y_69320;\n            bool bounds_check_69321;\n            bool index_certs_69322;\n            int32_t tmp_69323;\n            \n            tmp_69318 = sub64(eta_p_69312, lower_bound_63774);\n            x_69319 = sle64((int64_t) 0, tmp_69318);\n            y_69320 = slt64(tmp_69318, j_m_i_63777);\n            bounds_check_69321 = x_69319 && y_69320;\n            if (!bounds_check_69321) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69318;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69323 = ((__global int32_t *) ys_mem_77627)[eta_p_69312];\n            lifted_lambda_res_69317 = tmp_69323;\n        } els",
                                    "e {\n            int32_t eta_p_69313 = ((__global int32_t *) mem_param_77636)[gtid_69310];\n            \n            lifted_lambda_res_69317 = eta_p_69313;\n        }\n        ((__global int32_t *) mem_77641)[gtid_69310] = lifted_lambda_res_69317;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69307\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_longzisegmap_69059_dim1, 1, 1)\nvoid gather_payloads_longzisegmap_69059(__global int *global_failure, int64_t niz2084U_60353, int64_t incr_60355, __global unsigned char *is_mem_77625, __global unsigned char *mem_77629)\n{\n    #define segmap_tblock_sizze_69055 (gather_payloads_longzisegmap_69059zisegmap_tblock_sizze_69055)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69059;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69058;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69059 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69055 + sext_i32_i64(local_tid_78703);\n    slice_78708 = niz2084U_60353;\n    gtid_69058 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69058;\n    if (slt64(gtid_69058, niz2084U_60353)) {\n        int64_t eta_p_69060;\n        int64_t lifted_lambda_res_69061;\n        \n        eta_p_69060 = ((__global int64_t *) is_mem_77625)[gtid_69058];\n        lifted_lambda_res_69061 = sub64(eta_p_69060, incr_60355);\n        ((__global int64_t *) mem_77629)[gtid_69058] = lifted_lambda_res_69061;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69055\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_longziseg", "map_69087_dim1, 1, 1)\nvoid gather_payloads_longzisegmap_69087(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_60353, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77626, __global unsigned char *mem_param_77634, __global unsigned char *mem_param_77637, __global unsigned char *mem_77642)\n{\n    #define segmap_tblock_sizze_69083 (gather_payloads_longzisegmap_69087zisegmap_tblock_sizze_69083)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    int64_t phys_tid_69087;\n    int64_t global_tid_78742;\n    int64_t slice_78743;\n    int64_t gtid_69086;\n    int64_t remnant_78744;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    phys_tid_69087 = sext_i32_i64(global_tid_78737);\n    global_tid_78742 = sext_i32_i64(block_id_78739) * segmap_tblock_sizze_69083 + sext_i32_i64(local_tid_78738);\n    slice_78743 = niz2084U_60353;\n    gtid_69086 = global_tid_78742;\n    remnant_78744 = global_tid_78742 - gtid_69086;\n    if (slt64(gtid_69086, niz2084U_60353)) {\n        int64_t eta_p_69088;\n        bool cond_69090;\n        bool cond_t_res_69091;\n        bool x_69092;\n        int64_t lifted_lambda_res_69093;\n        \n        eta_p_69088 = ((__global int64_t *) mem_param_77634)[gtid_69086];\n        cond_69090 = sle64(lower_bound_63774, eta_p_69088);\n        cond_t_res_69091 = slt64(eta_p_69088, min_res_63776);\n        x_69092 = cond_69090 && cond_t_res_69091;\n        if (x_69092) {\n            int64_t tmp_69094;\n            bool x_69095;\n            bool y_69096;\n            bool bounds_check_69097;\n            bool index_certs_69098", ";\n            int64_t tmp_69099;\n            \n            tmp_69094 = sub64(eta_p_69088, lower_bound_63774);\n            x_69095 = sle64((int64_t) 0, tmp_69094);\n            y_69096 = slt64(tmp_69094, j_m_i_63777);\n            bounds_check_69097 = x_69095 && y_69096;\n            if (!bounds_check_69097) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69094;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69099 = ((__global int64_t *) ys_mem_77626)[eta_p_69088];\n            lifted_lambda_res_69093 = tmp_69099;\n        } else {\n            int64_t eta_p_69089 = ((__global int64_t *) mem_param_77637)[gtid_69086];\n            \n            lifted_lambda_res_69093 = eta_p_69089;\n        }\n        ((__global int64_t *) mem_77642)[gtid_69086] = lifted_lambda_res_69093;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69083\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_long_GFURzisegmap_69339_dim1, 1, 1)\nvoid gather_payloads_long_GFURzisegmap_69339(__global int *global_failure, int64_t ni_61938, int64_t incr_61940, __global unsigned char *is_mem_77626, __global unsigned char *mem_77630)\n{\n    #define segmap_tblock_sizze_69335 (gather_payloads_long_GFURzisegmap_69339zisegmap_tblock_sizze_69335)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69339;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69338;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 =",
                                    " block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69339 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69335 + sext_i32_i64(local_tid_78703);\n    slice_78708 = ni_61938;\n    gtid_69338 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69338;\n    if (slt64(gtid_69338, ni_61938)) {\n        int64_t eta_p_69340;\n        int64_t lifted_lambda_res_69341;\n        \n        eta_p_69340 = ((__global int64_t *) is_mem_77626)[gtid_69338];\n        lifted_lambda_res_69341 = sub64(eta_p_69340, incr_61940);\n        ((__global int64_t *) mem_77630)[gtid_69338] = lifted_lambda_res_69341;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69335\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_long_GFURzisegmap_69367_dim1, 1, 1)\nvoid gather_payloads_long_GFURzisegmap_69367(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_61938, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77627, __global unsigned char *mem_param_77633, __global unsigned char *mem_param_77636, __global unsigned char *mem_77641)\n{\n    #define segmap_tblock_sizze_69363 (gather_payloads_long_GFURzisegmap_69367zisegmap_tblock_sizze_69363)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78718;\n    int32_t tblock_sizze_78721;\n    int32_t wave_sizze_78720;\n    int32_t block_id_78719;\n    int32_t global_tid_78717;\n    int64_t phys_tid_69367;\n    int64_t global_tid_78722;\n    int64_t slice_78723;\n    int64_t gtid_69366;\n    int64_t remnant_78724;\n    \n    local_tid_78718 = get_local_id(0);\n    tblock_sizze_78721 = get_local_size(0);\n    wave_sizze_78720 = LOCKSTEP_WIDTH;\n    block_id_78719 = get_tblock_id(0);\n    global_tid_78717 = block_id_78719 * tblock_sizze_78721 + local_tid_78718;\n    phys_tid_69367 = sext_i32_i64(global_tid_78717);\n    global_tid_78722 = sext_i32_i64(block_id_78719) * segma", "p_tblock_sizze_69363 + sext_i32_i64(local_tid_78718);\n    slice_78723 = ni_61938;\n    gtid_69366 = global_tid_78722;\n    remnant_78724 = global_tid_78722 - gtid_69366;\n    if (slt64(gtid_69366, ni_61938)) {\n        int64_t eta_p_69368;\n        bool cond_69370;\n        bool cond_t_res_69371;\n        bool x_69372;\n        int64_t lifted_lambda_res_69373;\n        \n        eta_p_69368 = ((__global int64_t *) mem_param_77633)[gtid_69366];\n        cond_69370 = sle64(lower_bound_63774, eta_p_69368);\n        cond_t_res_69371 = slt64(eta_p_69368, min_res_63776);\n        x_69372 = cond_69370 && cond_t_res_69371;\n        if (x_69372) {\n            int64_t tmp_69374;\n            bool x_69375;\n            bool y_69376;\n            bool bounds_check_69377;\n            bool index_certs_69378;\n            int64_t tmp_69379;\n            \n            tmp_69374 = sub64(eta_p_69368, lower_bound_63774);\n            x_69375 = sle64((int64_t) 0, tmp_69374);\n            y_69376 = slt64(tmp_69374, j_m_i_63777);\n            bounds_check_69377 = x_69375 && y_69376;\n            if (!bounds_check_69377) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69374;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69379 = ((__global int64_t *) ys_mem_77627)[eta_p_69368];\n            lifted_lambda_res_69373 = tmp_69379;\n        } else {\n            int64_t eta_p_69369 = ((__global int64_t *) mem_param_77636)[gtid_69366];\n            \n            lifted_lambda_res_69373 = eta_p_69369;\n        }\n        ((__global int64_t *) mem_77641)[gtid_69366] = lifted_lambda_res_69373;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69363\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_shortzisegmap_68947_dim1, 1, 1)\nvoid gather_payloads_shortzisegmap", "_68947(__global int *global_failure, int64_t niz2084U_59732, int64_t incr_59734, __global unsigned char *is_mem_77625, __global unsigned char *mem_77629)\n{\n    #define segmap_tblock_sizze_68943 (gather_payloads_shortzisegmap_68947zisegmap_tblock_sizze_68943)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_68947;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_68946;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_68947 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_68943 + sext_i32_i64(local_tid_78703);\n    slice_78708 = niz2084U_59732;\n    gtid_68946 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_68946;\n    if (slt64(gtid_68946, niz2084U_59732)) {\n        int64_t eta_p_68948;\n        int64_t lifted_lambda_res_68949;\n        \n        eta_p_68948 = ((__global int64_t *) is_mem_77625)[gtid_68946];\n        lifted_lambda_res_68949 = sub64(eta_p_68948, incr_59734);\n        ((__global int64_t *) mem_77629)[gtid_68946] = lifted_lambda_res_68949;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68943\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_shortzisegmap_68975_dim1, 1, 1)\nvoid gather_payloads_shortzisegmap_68975(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_59732, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77626, __global unsigned char *mem_param_77634, __global unsigned char *mem_param_77637, __global unsigned char *mem_77642)\n{\n    #d",
                                    "efine segmap_tblock_sizze_68971 (gather_payloads_shortzisegmap_68975zisegmap_tblock_sizze_68971)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    int64_t phys_tid_68975;\n    int64_t global_tid_78742;\n    int64_t slice_78743;\n    int64_t gtid_68974;\n    int64_t remnant_78744;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    phys_tid_68975 = sext_i32_i64(global_tid_78737);\n    global_tid_78742 = sext_i32_i64(block_id_78739) * segmap_tblock_sizze_68971 + sext_i32_i64(local_tid_78738);\n    slice_78743 = niz2084U_59732;\n    gtid_68974 = global_tid_78742;\n    remnant_78744 = global_tid_78742 - gtid_68974;\n    if (slt64(gtid_68974, niz2084U_59732)) {\n        int64_t eta_p_68976;\n        bool cond_68978;\n        bool cond_t_res_68979;\n        bool x_68980;\n        int16_t lifted_lambda_res_68981;\n        \n        eta_p_68976 = ((__global int64_t *) mem_param_77634)[gtid_68974];\n        cond_68978 = sle64(lower_bound_63774, eta_p_68976);\n        cond_t_res_68979 = slt64(eta_p_68976, min_res_63776);\n        x_68980 = cond_68978 && cond_t_res_68979;\n        if (x_68980) {\n            int64_t tmp_68982;\n            bool x_68983;\n            bool y_68984;\n            bool bounds_check_68985;\n            bool index_certs_68986;\n            int16_t tmp_68987;\n            \n            tmp_68982 = sub64(eta_p_68976, lower_bound_63774);\n            x_68983 = sle64((int64_t) 0, tmp_68982);\n            y_68984 = slt64(tmp_68982, j_m_i_63777);\n            bounds_check_68985 = x_68983 && y_68984;\n            if (!bounds_check_68985) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 8) == -1) {\n       ", "                 global_failure_args[0] = (int64_t) tmp_68982;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_68987 = ((__global int16_t *) ys_mem_77626)[eta_p_68976];\n            lifted_lambda_res_68981 = tmp_68987;\n        } else {\n            int16_t eta_p_68977 = ((__global int16_t *) mem_param_77637)[gtid_68974];\n            \n            lifted_lambda_res_68981 = eta_p_68977;\n        }\n        ((__global int16_t *) mem_77642)[gtid_68974] = lifted_lambda_res_68981;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68971\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_short_GFURzisegmap_69227_dim1, 1, 1)\nvoid gather_payloads_short_GFURzisegmap_69227(__global int *global_failure, int64_t ni_61336, int64_t incr_61338, __global unsigned char *is_mem_77626, __global unsigned char *mem_77630)\n{\n    #define segmap_tblock_sizze_69223 (gather_payloads_short_GFURzisegmap_69227zisegmap_tblock_sizze_69223)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78703;\n    int32_t tblock_sizze_78706;\n    int32_t wave_sizze_78705;\n    int32_t block_id_78704;\n    int32_t global_tid_78702;\n    int64_t phys_tid_69227;\n    int64_t global_tid_78707;\n    int64_t slice_78708;\n    int64_t gtid_69226;\n    int64_t remnant_78709;\n    \n    local_tid_78703 = get_local_id(0);\n    tblock_sizze_78706 = get_local_size(0);\n    wave_sizze_78705 = LOCKSTEP_WIDTH;\n    block_id_78704 = get_tblock_id(0);\n    global_tid_78702 = block_id_78704 * tblock_sizze_78706 + local_tid_78703;\n    phys_tid_69227 = sext_i32_i64(global_tid_78702);\n    global_tid_78707 = sext_i32_i64(block_id_78704) * segmap_tblock_sizze_69223 + sext_i32_i64(local_tid_78703);\n    slice_78708 = ni_61336;\n    gtid_69226 = global_tid_78707;\n    remnant_78709 = global_tid_78707 - gtid_69226;\n    if (slt64(gtid_69226, ni_61336)) {\n        int64_t eta_p_69228;\n       ", " int64_t lifted_lambda_res_69229;\n        \n        eta_p_69228 = ((__global int64_t *) is_mem_77626)[gtid_69226];\n        lifted_lambda_res_69229 = sub64(eta_p_69228, incr_61338);\n        ((__global int64_t *) mem_77630)[gtid_69226] = lifted_lambda_res_69229;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69223\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_short_GFURzisegmap_69255_dim1, 1, 1)\nvoid gather_payloads_short_GFURzisegmap_69255(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_61336, int64_t lower_bound_63774, int64_t min_res_63776, int64_t j_m_i_63777, __global unsigned char *ys_mem_77627, __global unsigned char *mem_param_77633, __global unsigned char *mem_param_77636, __global unsigned char *mem_77641)\n{\n    #define segmap_tblock_sizze_69251 (gather_payloads_short_GFURzisegmap_69255zisegmap_tblock_sizze_69251)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78718;\n    int32_t tblock_sizze_78721;\n    int32_t wave_sizze_78720;\n    int32_t block_id_78719;\n    int32_t global_tid_78717;\n    int64_t phys_tid_69255;\n    int64_t global_tid_78722;\n    int64_t slice_78723;\n    int64_t gtid_69254;\n    int64_t remnant_78724;\n    \n    local_tid_78718 = get_local_id(0);\n    tblock_sizze_78721 = get_local_size(0);\n    wave_sizze_78720 = LOCKSTEP_WIDTH;\n    block_id_78719 = get_tblock_id(0);\n    global_tid_78717 = block_id_78719 * tblock_sizze_78721 + local_tid_78718;\n    phys_tid_69255 = sext_i32_i64(global_tid_78717);\n    global_tid_78722 = sext_i32_i64(block_id_78719) * segmap_tblock_sizze_69251 + sext_i32_i64(local_tid_78718);\n    slice_78723 = ni_61336;\n    gtid_69254 = global_tid_78722;\n    remnant_78724 = global_tid_78722 - gtid_69254;\n    if (slt64(gtid_69254, ni_61336)) {\n        int64_t eta_p_69256;\n        bool cond_69258;\n        bool cond_t_res_69259;\n        bool x_69260;\n        int16_t lifted_lambda_res_69261;\n        \n        eta_p_69256 = ((__global int64_t *) ",
                                    "mem_param_77633)[gtid_69254];\n        cond_69258 = sle64(lower_bound_63774, eta_p_69256);\n        cond_t_res_69259 = slt64(eta_p_69256, min_res_63776);\n        x_69260 = cond_69258 && cond_t_res_69259;\n        if (x_69260) {\n            int64_t tmp_69262;\n            bool x_69263;\n            bool y_69264;\n            bool bounds_check_69265;\n            bool index_certs_69266;\n            int16_t tmp_69267;\n            \n            tmp_69262 = sub64(eta_p_69256, lower_bound_63774);\n            x_69263 = sle64((int64_t) 0, tmp_69262);\n            y_69264 = slt64(tmp_69262, j_m_i_63777);\n            bounds_check_69265 = x_69263 && y_69264;\n            if (!bounds_check_69265) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69262;\n                        global_failure_args[1] = (int64_t) j_m_i_63777;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_69267 = ((__global int16_t *) ys_mem_77627)[eta_p_69256];\n            lifted_lambda_res_69261 = tmp_69267;\n        } else {\n            int16_t eta_p_69257 = ((__global int16_t *) mem_param_77636)[gtid_69254];\n            \n            lifted_lambda_res_69261 = eta_p_69257;\n        }\n        ((__global int16_t *) mem_77641)[gtid_69254] = lifted_lambda_res_69261;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69251\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78724_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78724(__global int *global_failure, int64_t gt_rhs_66981, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77633)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78726;\n    int32_t tblock_sizze_78729;\n    int32_t wave_sizze_78728;\n    int32_t block_id_78727;\n    int32_t global_tid_78725;\n    int64_t tid_78724;\n    double x_77524;\n    \n    local_tid_78726 = get_local_id(0", ");\n    tblock_sizze_78729 = get_local_size(0);\n    wave_sizze_78728 = LOCKSTEP_WIDTH;\n    block_id_78727 = get_tblock_id(0);\n    global_tid_78725 = block_id_78727 * tblock_sizze_78729 + local_tid_78726;\n    tid_78724 = sext_i32_i64(global_tid_78725);\n    x_77524 = ((__global double *) tR_mem_77625)[gt_rhs_66981];\n    ((__global double *) mem_77633)[(int64_t) 0] = x_77524;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78756_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78756(__global int *global_failure, int64_t tS_start_66998, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77634, __global unsigned char *mem_77641, __global unsigned char *mem_77642)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78758;\n    int32_t tblock_sizze_78761;\n    int32_t wave_sizze_78760;\n    int32_t block_id_78759;\n    int32_t global_tid_78757;\n    int64_t tid_78756;\n    double gt_lhs_77528;\n    double gt_rhs_77530;\n    bool defunc_0_gt_res_77532;\n    \n    local_tid_78758 = get_local_id(0);\n    tblock_sizze_78761 = get_local_size(0);\n    wave_sizze_78760 = LOCKSTEP_WIDTH;\n    block_id_78759 = get_tblock_id(0);\n    global_tid_78757 = block_id_78759 * tblock_sizze_78761 + local_tid_78758;\n    tid_78756 = sext_i32_i64(global_tid_78757);\n    gt_lhs_77528 = ((__global double *) tS_mem_77626)[tS_start_66998];\n    gt_rhs_77530 = ((__global double *) ext_mem_77634)[(int64_t) 0];\n    defunc_0_gt_res_77532 = gt_rhs_77530 < gt_lhs_77528;\n    ((__global double *) mem_77641)[(int64_t) 0] = gt_lhs_77528;\n    ((__global bool *) mem_77642)[(int64_t) 0] = defunc_0_gt_res_77532;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78762_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78762(__global int *global_failure, int64_t i_p_m_t_s_67004, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77908)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78764;\n    int32_t tblock_si", "zze_78767;\n    int32_t wave_sizze_78766;\n    int32_t block_id_78765;\n    int32_t global_tid_78763;\n    int64_t tid_78762;\n    double x_77534;\n    \n    local_tid_78764 = get_local_id(0);\n    tblock_sizze_78767 = get_local_size(0);\n    wave_sizze_78766 = LOCKSTEP_WIDTH;\n    block_id_78765 = get_tblock_id(0);\n    global_tid_78763 = block_id_78765 * tblock_sizze_78767 + local_tid_78764;\n    tid_78762 = sext_i32_i64(global_tid_78763);\n    x_77534 = ((__global double *) tS_mem_77626)[i_p_m_t_s_67004];\n    ((__global double *) mem_77908)[(int64_t) 0] = x_77534;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78778_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78778(__global int *global_failure, int64_t start_68558, int64_t i_p_m_t_s_68564, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77916, __global unsigned char *mem_77917)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78780;\n    int32_t tblock_sizze_78783;\n    int32_t wave_sizze_78782;\n    int32_t block_id_78781;\n    int32_t global_tid_78779;\n    int64_t tid_78778;\n    double r_max_77538;\n    double r_min_77541;\n    \n    local_tid_78780 = get_local_id(0);\n    tblock_sizze_78783 = get_local_size(0);\n    wave_sizze_78782 = LOCKSTEP_WIDTH;\n    block_id_78781 = get_tblock_id(0);\n    global_tid_78779 = block_id_78781 * tblock_sizze_78783 + local_tid_78780;\n    tid_78778 = sext_i32_i64(global_tid_78779);\n    r_max_77538 = ((__global double *) tR_mem_77625)[i_p_m_t_s_68564];\n    r_min_77541 = ((__global double *) tR_mem_77625)[start_68558];\n    ((__global double *) mem_77916)[(int64_t) 0] = r_max_77538;\n    ((__global double *) mem_77917)[(int64_t) 0] = r_min_77541;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78784_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78784(__global int *global_failure, __global unsigned char *mem_77917, __global unsigned char *ext_mem_77918, __global unsigned char *mem_77920)\n{\n    if (*global_failure",
                                    " >= 0)\n        return;\n    \n    int32_t local_tid_78786;\n    int32_t tblock_sizze_78789;\n    int32_t wave_sizze_78788;\n    int32_t block_id_78787;\n    int32_t global_tid_78785;\n    int64_t tid_78784;\n    double s_max_77543;\n    double r_min_77544;\n    bool defunc_0_gt_res_77545;\n    \n    local_tid_78786 = get_local_id(0);\n    tblock_sizze_78789 = get_local_size(0);\n    wave_sizze_78788 = LOCKSTEP_WIDTH;\n    block_id_78787 = get_tblock_id(0);\n    global_tid_78785 = block_id_78787 * tblock_sizze_78789 + local_tid_78786;\n    tid_78784 = sext_i32_i64(global_tid_78785);\n    s_max_77543 = ((__global double *) ext_mem_77918)[(int64_t) 0];\n    r_min_77544 = ((__global double *) mem_77917)[(int64_t) 0];\n    defunc_0_gt_res_77545 = s_max_77543 < r_min_77544;\n    ((__global bool *) mem_77920)[(int64_t) 0] = defunc_0_gt_res_77545;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78790_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78790(__global int *global_failure, __global unsigned char *mem_77916, __global unsigned char *ext_mem_77919, __global unsigned char *mem_77921)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78792;\n    int32_t tblock_sizze_78795;\n    int32_t wave_sizze_78794;\n    int32_t block_id_78793;\n    int32_t global_tid_78791;\n    int64_t tid_78790;\n    double r_max_77548;\n    double s_min_77549;\n    bool defunc_0_gt_res_77550;\n    \n    local_tid_78792 = get_local_id(0);\n    tblock_sizze_78795 = get_local_size(0);\n    wave_sizze_78794 = LOCKSTEP_WIDTH;\n    block_id_78793 = get_tblock_id(0);\n    global_tid_78791 = block_id_78793 * tblock_sizze_78795 + local_tid_78792;\n    tid_78790 = sext_i32_i64(global_tid_78791);\n    r_max_77548 = ((__global double *) mem_77916)[(int64_t) 0];\n    s_min_77549 = ((__global double *) ext_mem_77919)[(int64_t) 0];\n    defunc_0_gt_res_77550 = r_max_77548 < s_min_77549;\n    ((__global bool *) mem_77921)[(int64_t) 0] = defunc_0_gt_res_77550;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL", "_SIZED(inner_SMJ_doublezigpuseq_78849_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78849(__global int *global_failure, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77648)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78851;\n    int32_t tblock_sizze_78854;\n    int32_t wave_sizze_78853;\n    int32_t block_id_78852;\n    int32_t global_tid_78850;\n    int64_t tid_78849;\n    double x_77552;\n    \n    local_tid_78851 = get_local_id(0);\n    tblock_sizze_78854 = get_local_size(0);\n    wave_sizze_78853 = LOCKSTEP_WIDTH;\n    block_id_78852 = get_tblock_id(0);\n    global_tid_78850 = block_id_78852 * tblock_sizze_78854 + local_tid_78851;\n    tid_78849 = sext_i32_i64(global_tid_78850);\n    x_77552 = ((__global double *) tR_mem_77625)[(int64_t) 0];\n    ((__global double *) mem_77648)[(int64_t) 0] = x_77552;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78855_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78855(__global int *global_failure, __global unsigned char *mem_77641, __global unsigned char *ext_mem_77649, __global unsigned char *mem_77650)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78857;\n    int32_t tblock_sizze_78860;\n    int32_t wave_sizze_78859;\n    int32_t block_id_78858;\n    int32_t global_tid_78856;\n    int64_t tid_78855;\n    double leq_lhs_77556;\n    double gt_lhs_77557;\n    bool defunc_0_leq_res_77558;\n    \n    local_tid_78857 = get_local_id(0);\n    tblock_sizze_78860 = get_local_size(0);\n    wave_sizze_78859 = LOCKSTEP_WIDTH;\n    block_id_78858 = get_tblock_id(0);\n    global_tid_78856 = block_id_78858 * tblock_sizze_78860 + local_tid_78857;\n    tid_78855 = sext_i32_i64(global_tid_78856);\n    leq_lhs_77556 = ((__global double *) ext_mem_77649)[(int64_t) 0];\n    gt_lhs_77557 = ((__global double *) mem_77641)[(int64_t) 0];\n    defunc_0_leq_res_77558 = leq_lhs_77556 <= gt_lhs_77557;\n    ((__global bool *) mem_77650)[(int64_t) 0] = defunc_0_leq_res_77558;\n    \n  error_", "0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78861_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78861(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_59382, unsigned char y_67146_bits, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77641, __global unsigned char *mem_77650, __global unsigned char *mem_77652)\n{\n    bool y_67146 = y_67146_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78863;\n    int32_t tblock_sizze_78866;\n    int32_t wave_sizze_78865;\n    int32_t block_id_78864;\n    int32_t global_tid_78862;\n    int64_t tid_78861;\n    bool defunc_0_leq_res_77560;\n    double x_77565;\n    \n    local_tid_78863 = get_local_id(0);\n    tblock_sizze_78866 = get_local_size(0);\n    wave_sizze_78865 = LOCKSTEP_WIDTH;\n    block_id_78864 = get_tblock_id(0);\n    global_tid_78862 = block_id_78864 * tblock_sizze_78866 + local_tid_78863;\n    tid_78861 = sext_i32_i64(global_tid_78862);\n    defunc_0_leq_res_77560 = ((__global bool *) mem_77650)[(int64_t) 0];\n    if (defunc_0_leq_res_77560) {\n        bool index_certs_77561;\n        double lowest_t_res_77562;\n        \n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_59382;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_77562 = ((__global double *) tR_mem_77625)[(int64_t) 0];\n        x_77565 = lowest_t_res_77562;\n    } else {\n        double gt_lhs_77564;\n        bool index_certs_77563;\n        \n        gt_lhs_77564 = ((__global double *) mem_77641)[(int64_t) 0];\n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                 ",
                                    "   global_failure_args[1] = (int64_t) nR_59382;\n                    ;\n                }\n                return;\n            }\n        }\n        x_77565 = gt_lhs_77564;\n    }\n    ((__global double *) mem_77652)[(int64_t) 0] = x_77565;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78923_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78923(__global int *global_failure, int64_t slice_68069, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77700)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78925;\n    int32_t tblock_sizze_78928;\n    int32_t wave_sizze_78927;\n    int32_t block_id_78926;\n    int32_t global_tid_78924;\n    int64_t tid_78923;\n    double x_77570;\n    \n    local_tid_78925 = get_local_id(0);\n    tblock_sizze_78928 = get_local_size(0);\n    wave_sizze_78927 = LOCKSTEP_WIDTH;\n    block_id_78926 = get_tblock_id(0);\n    global_tid_78924 = block_id_78926 * tblock_sizze_78928 + local_tid_78925;\n    tid_78923 = sext_i32_i64(global_tid_78924);\n    x_77570 = ((__global double *) tS_mem_77626)[slice_68069];\n    ((__global double *) mem_77700)[(int64_t) 0] = x_77570;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78929_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78929(__global int *global_failure, int64_t slice_68867, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77703)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78931;\n    int32_t tblock_sizze_78934;\n    int32_t wave_sizze_78933;\n    int32_t block_id_78932;\n    int32_t global_tid_78930;\n    int64_t tid_78929;\n    double x_77574;\n    \n    local_tid_78931 = get_local_id(0);\n    tblock_sizze_78934 = get_local_size(0);\n    wave_sizze_78933 = LOCKSTEP_WIDTH;\n    block_id_78932 = get_tblock_id(0);\n    global_tid_78930 = block_id_78932 * tblock_sizze_78934 + local_tid_78931;\n    tid_78929 = sext_i32_i64(global_tid_78930);\n    x_77574 = ((__global double *) tS_mem_77626)[slice_68867]", ";\n    ((__global double *) mem_77703)[(int64_t) 0] = x_77574;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78945_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78945(__global int *global_failure, int64_t slice_67712, int64_t slice_67721, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77711, __global unsigned char *mem_77712)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78947;\n    int32_t tblock_sizze_78950;\n    int32_t wave_sizze_78949;\n    int32_t block_id_78948;\n    int32_t global_tid_78946;\n    int64_t tid_78945;\n    double r_max_77578;\n    double r_min_77581;\n    \n    local_tid_78947 = get_local_id(0);\n    tblock_sizze_78950 = get_local_size(0);\n    wave_sizze_78949 = LOCKSTEP_WIDTH;\n    block_id_78948 = get_tblock_id(0);\n    global_tid_78946 = block_id_78948 * tblock_sizze_78950 + local_tid_78947;\n    tid_78945 = sext_i32_i64(global_tid_78946);\n    r_max_77578 = ((__global double *) tR_mem_77625)[slice_67721];\n    r_min_77581 = ((__global double *) tR_mem_77625)[slice_67712];\n    ((__global double *) mem_77711)[(int64_t) 0] = r_max_77578;\n    ((__global double *) mem_77712)[(int64_t) 0] = r_min_77581;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78951_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78951(__global int *global_failure, __global unsigned char *mem_77712, __global unsigned char *ext_mem_77713, __global unsigned char *mem_77715)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78953;\n    int32_t tblock_sizze_78956;\n    int32_t wave_sizze_78955;\n    int32_t block_id_78954;\n    int32_t global_tid_78952;\n    int64_t tid_78951;\n    double s_max_77583;\n    double r_min_77584;\n    bool defunc_0_gt_res_77585;\n    \n    local_tid_78953 = get_local_id(0);\n    tblock_sizze_78956 = get_local_size(0);\n    wave_sizze_78955 = LOCKSTEP_WIDTH;\n    block_id_78954 = get_tblock_id(0);\n    global_tid_78952 = block_id_78954 * tblock_sizze_78956 + ", "local_tid_78953;\n    tid_78951 = sext_i32_i64(global_tid_78952);\n    s_max_77583 = ((__global double *) ext_mem_77713)[(int64_t) 0];\n    r_min_77584 = ((__global double *) mem_77712)[(int64_t) 0];\n    defunc_0_gt_res_77585 = s_max_77583 < r_min_77584;\n    ((__global bool *) mem_77715)[(int64_t) 0] = defunc_0_gt_res_77585;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_78957_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_78957(__global int *global_failure, __global unsigned char *mem_77711, __global unsigned char *ext_mem_77714, __global unsigned char *mem_77716)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78959;\n    int32_t tblock_sizze_78962;\n    int32_t wave_sizze_78961;\n    int32_t block_id_78960;\n    int32_t global_tid_78958;\n    int64_t tid_78957;\n    double r_max_77588;\n    double s_min_77589;\n    bool defunc_0_gt_res_77590;\n    \n    local_tid_78959 = get_local_id(0);\n    tblock_sizze_78962 = get_local_size(0);\n    wave_sizze_78961 = LOCKSTEP_WIDTH;\n    block_id_78960 = get_tblock_id(0);\n    global_tid_78958 = block_id_78960 * tblock_sizze_78962 + local_tid_78959;\n    tid_78957 = sext_i32_i64(global_tid_78958);\n    r_max_77588 = ((__global double *) mem_77711)[(int64_t) 0];\n    s_min_77589 = ((__global double *) ext_mem_77714)[(int64_t) 0];\n    defunc_0_gt_res_77590 = r_max_77588 < s_min_77589;\n    ((__global bool *) mem_77716)[(int64_t) 0] = defunc_0_gt_res_77590;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_79070_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_79070(__global int *global_failure, int64_t gt_rhs_66981, int64_t i_p_m_t_s_67004, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_78084)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79072;\n    int32_t tblock_sizze_79075;\n    int32_t wave_sizze_79074;\n    int32_t block_id_79073;\n    int32_t global_tid_79071;\n    int64_t tid_79070;\n    doub",
                                    "le leq_lhs_77592;\n    double leq_rhs_77594;\n    bool defunc_0_leq_res_77598;\n    \n    local_tid_79072 = get_local_id(0);\n    tblock_sizze_79075 = get_local_size(0);\n    wave_sizze_79074 = LOCKSTEP_WIDTH;\n    block_id_79073 = get_tblock_id(0);\n    global_tid_79071 = block_id_79073 * tblock_sizze_79075 + local_tid_79072;\n    tid_79070 = sext_i32_i64(global_tid_79071);\n    leq_lhs_77592 = ((__global double *) tS_mem_77626)[i_p_m_t_s_67004];\n    leq_rhs_77594 = ((__global double *) tR_mem_77625)[gt_rhs_66981];\n    defunc_0_leq_res_77598 = leq_lhs_77592 <= leq_rhs_77594;\n    ((__global bool *) mem_78084)[(int64_t) 0] = defunc_0_leq_res_77598;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_79395_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_79395(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78120, __global unsigned char *mem_78122)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79397;\n    int32_t tblock_sizze_79400;\n    int32_t wave_sizze_79399;\n    int32_t block_id_79398;\n    int32_t global_tid_79396;\n    int64_t tid_79395;\n    int64_t x_77600;\n    \n    local_tid_79397 = get_local_id(0);\n    tblock_sizze_79400 = get_local_size(0);\n    wave_sizze_79399 = LOCKSTEP_WIDTH;\n    block_id_79398 = get_tblock_id(0);\n    global_tid_79396 = block_id_79398 * tblock_sizze_79400 + local_tid_79397;\n    tid_79395 = sext_i32_i64(global_tid_79396);\n    x_77600 = ((__global int64_t *) mem_78120)[m_67854];\n    ((__global int64_t *) mem_78122)[(int64_t) 0] = x_77600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_79401_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_79401(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78103, __global unsigned char *mem_78125)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79403;\n    int32_t tblock_sizze_79406;\n    int32_t wave_sizze_79405;\n    int32_t block_id_79404;\n    int32_t global_tid_79402;\n  ", "  int64_t tid_79401;\n    int64_t x_77604;\n    \n    local_tid_79403 = get_local_id(0);\n    tblock_sizze_79406 = get_local_size(0);\n    wave_sizze_79405 = LOCKSTEP_WIDTH;\n    block_id_79404 = get_tblock_id(0);\n    global_tid_79402 = block_id_79404 * tblock_sizze_79406 + local_tid_79403;\n    tid_79401 = sext_i32_i64(global_tid_79402);\n    x_77604 = ((__global int64_t *) mem_78103)[m_67854];\n    ((__global int64_t *) mem_78125)[(int64_t) 0] = x_77604;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_79407_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_79407(__global int *global_failure, __global unsigned char *ext_mem_78123, __global unsigned char *ext_mem_78126, __global unsigned char *mem_78132)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79409;\n    int32_t tblock_sizze_79412;\n    int32_t wave_sizze_79411;\n    int32_t block_id_79410;\n    int32_t global_tid_79408;\n    int64_t tid_79407;\n    int64_t zp_lhs_77608;\n    int64_t n_pairs_t_res_77609;\n    int64_t n_pairs_t_res_77610;\n    \n    local_tid_79409 = get_local_id(0);\n    tblock_sizze_79412 = get_local_size(0);\n    wave_sizze_79411 = LOCKSTEP_WIDTH;\n    block_id_79410 = get_tblock_id(0);\n    global_tid_79408 = block_id_79410 * tblock_sizze_79412 + local_tid_79409;\n    tid_79407 = sext_i32_i64(global_tid_79408);\n    zp_lhs_77608 = ((__global int64_t *) ext_mem_78123)[(int64_t) 0];\n    n_pairs_t_res_77609 = ((__global int64_t *) ext_mem_78126)[(int64_t) 0];\n    n_pairs_t_res_77610 = add64(zp_lhs_77608, n_pairs_t_res_77609);\n    ((__global int64_t *) mem_78132)[(int64_t) 0] = n_pairs_t_res_77610;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_79454_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_79454(__global int *global_failure, int64_t loopres_68028, __global unsigned char *mem_param_78166, __global unsigned char *mem_param_78169, __global unsigned char *mem_param_78172, __global unsigned char *mem_78179, __global unsigned char *mem_78180, __", "global unsigned char *mem_78181)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79456;\n    int32_t tblock_sizze_79459;\n    int32_t wave_sizze_79458;\n    int32_t block_id_79457;\n    int32_t global_tid_79455;\n    int64_t tid_79454;\n    double loopres_77612;\n    int64_t loopres_77614;\n    int64_t loopres_77616;\n    \n    local_tid_79456 = get_local_id(0);\n    tblock_sizze_79459 = get_local_size(0);\n    wave_sizze_79458 = LOCKSTEP_WIDTH;\n    block_id_79457 = get_tblock_id(0);\n    global_tid_79455 = block_id_79457 * tblock_sizze_79459 + local_tid_79456;\n    tid_79454 = sext_i32_i64(global_tid_79455);\n    loopres_77612 = ((__global double *) mem_param_78166)[loopres_68028];\n    loopres_77614 = ((__global int64_t *) mem_param_78169)[loopres_68028];\n    loopres_77616 = ((__global int64_t *) mem_param_78172)[loopres_68028];\n    ((__global double *) mem_78179)[(int64_t) 0] = loopres_77612;\n    ((__global int64_t *) mem_78180)[(int64_t) 0] = loopres_77614;\n    ((__global int64_t *) mem_78181)[(int64_t) 0] = loopres_77616;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_doublezireplicate_79461(int64_t loopres_68029, int64_t replicate_n_79460, int64_t virt_num_tblocks_79466, int64_t num_tblocks_79467, __global unsigned char *mem_78179, __global unsigned char *mem_78183)\n{\n    int32_t replicate_ltid_79462;\n    int32_t tblock_sizze_79464;\n    int32_t replicate_gid_79463;\n    int32_t replicate_gtid_79461;\n    int32_t phys_tblock_id_79468;\n    int32_t iterations_79469;\n    \n    replicate_ltid_79462 = get_local_id(0);\n    tblock_sizze_79464 = get_local_size(0);\n    replicate_gid_79463 = get_tblock_id(0);\n    replicate_gtid_79461 = replicate_gid_79463 * tblock_sizze_79464 + replicate_ltid_79462;\n    phys_tblock_id_79468 = get_tblock_id(0);\n    iterations_79469 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79466) - phys_tblock_id_79468, sext_i64_i32(num_tblocks_79467));\n    for (int32_t i_79470 = 0; i_79470 < iterations_79469; i_79470++) {\n        int",
                                    "32_t virt_tblock_id_79471;\n        int64_t global_tid_79472;\n        int64_t slice_79475;\n        int64_t slice_79476;\n        int64_t rep_i_79473;\n        int64_t remnant_79477;\n        int64_t rep_i_79474;\n        int64_t remnant_79478;\n        \n        virt_tblock_id_79471 = phys_tblock_id_79468 + i_79470 * sext_i64_i32(num_tblocks_79467);\n        global_tid_79472 = sext_i32_i64(virt_tblock_id_79471) * sext_i32_i64(tblock_sizze_79464) + sext_i32_i64(replicate_ltid_79462);\n        slice_79475 = (int64_t) 1;\n        slice_79476 = loopres_68029 * slice_79475;\n        rep_i_79473 = squot64(global_tid_79472, slice_79475);\n        remnant_79477 = global_tid_79472 - rep_i_79473 * slice_79475;\n        rep_i_79474 = remnant_79477;\n        remnant_79478 = remnant_79477 - rep_i_79474;\n        if (slt64(global_tid_79472, replicate_n_79460)) {\n            double tmp_79479 = ((__global double *) mem_78179)[rep_i_79474];\n            \n            ((__global double *) mem_78183)[rep_i_79473 + rep_i_79474] = tmp_79479;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_doublezireplicate_79481(int64_t loopres_68029, int64_t replicate_n_79480, int64_t virt_num_tblocks_79486, int64_t num_tblocks_79487, __global unsigned char *mem_78180, __global unsigned char *mem_78185)\n{\n    int32_t replicate_ltid_79482;\n    int32_t tblock_sizze_79484;\n    int32_t replicate_gid_79483;\n    int32_t replicate_gtid_79481;\n    int32_t phys_tblock_id_79488;\n    int32_t iterations_79489;\n    \n    replicate_ltid_79482 = get_local_id(0);\n    tblock_sizze_79484 = get_local_size(0);\n    replicate_gid_79483 = get_tblock_id(0);\n    replicate_gtid_79481 = replicate_gid_79483 * tblock_sizze_79484 + replicate_ltid_79482;\n    phys_tblock_id_79488 = get_tblock_id(0);\n    iterations_79489 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79486) - phys_tblock_id_79488, sext_i64_i32(num_tblocks_79487));\n    for (int32_t i_79490 = 0; i_79490 <", " iterations_79489; i_79490++) {\n        int32_t virt_tblock_id_79491;\n        int64_t global_tid_79492;\n        int64_t slice_79495;\n        int64_t slice_79496;\n        int64_t rep_i_79493;\n        int64_t remnant_79497;\n        int64_t rep_i_79494;\n        int64_t remnant_79498;\n        \n        virt_tblock_id_79491 = phys_tblock_id_79488 + i_79490 * sext_i64_i32(num_tblocks_79487);\n        global_tid_79492 = sext_i32_i64(virt_tblock_id_79491) * sext_i32_i64(tblock_sizze_79484) + sext_i32_i64(replicate_ltid_79482);\n        slice_79495 = (int64_t) 1;\n        slice_79496 = loopres_68029 * slice_79495;\n        rep_i_79493 = squot64(global_tid_79492, slice_79495);\n        remnant_79497 = global_tid_79492 - rep_i_79493 * slice_79495;\n        rep_i_79494 = remnant_79497;\n        remnant_79498 = remnant_79497 - rep_i_79494;\n        if (slt64(global_tid_79492, replicate_n_79480)) {\n            int64_t tmp_79499 = ((__global int64_t *) mem_78180)[rep_i_79494];\n            \n            ((__global int64_t *) mem_78185)[rep_i_79493 + rep_i_79494] = tmp_79499;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75123_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75123(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_59382, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t max_res_67171, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, int64_t zt_rhs_67177, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77653, __global unsigned char *mem_77662, __global unsigned char *mem_77664)\n{\n    #define segmap_tblock_sizze_75118 (inner_SMJ_doublezisegmap_75123zisegmap_tblock_sizze_75118)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78873;\n    int32_t tblock_sizze_78876;\n  ", "  int32_t wave_sizze_78875;\n    int32_t block_id_78874;\n    int32_t global_tid_78872;\n    int64_t phys_tid_75123;\n    int64_t global_tid_78877;\n    int64_t slice_78878;\n    int64_t gtid_75122;\n    int64_t remnant_78879;\n    \n    local_tid_78873 = get_local_id(0);\n    tblock_sizze_78876 = get_local_size(0);\n    wave_sizze_78875 = LOCKSTEP_WIDTH;\n    block_id_78874 = get_tblock_id(0);\n    global_tid_78872 = block_id_78874 * tblock_sizze_78876 + local_tid_78873;\n    phys_tid_75123 = sext_i32_i64(global_tid_78872);\n    global_tid_78877 = sext_i32_i64(block_id_78874) * segmap_tblock_sizze_75118 + sext_i32_i64(local_tid_78873);\n    slice_78878 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;\n    gtid_75122 = global_tid_78877;\n    remnant_78879 = global_tid_78877 - gtid_75122;\n    if (slt64(gtid_75122, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172)) {\n        double lowest_77569;\n        int64_t index_primexp_76055;\n        int64_t zs_lhs_75125;\n        int64_t index_75126;\n        bool cond_75127;\n        int64_t loop_over_75128;\n        int64_t loop_over_75129;\n        int64_t loop_over_75131;\n        bool defunc_0_f_res_75134;\n        int64_t defunc_0_f_res_75135;\n        int64_t defunc_0_f_res_75136;\n        int64_t defunc_0_f_res_75137;\n        bool loop_while_75138;\n        int64_t p_75139;\n        int64_t p_75140;\n        int64_t p_75141;\n        \n        lowest_77569 = ((__global double *) ext_mem_77653)[(int64_t) 0];\n        index_primexp_76055 = add64(max_res_67171, gtid_75122);\n        zs_lhs_75125 = mul64(zt_rhs_67177, index_primexp_76055);\n        index_75126 = sdiv64(zs_lhs_75125, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n        cond_75127 = slt64(nR_59382, index_75126);\n        if (cond_75127) {\n            loop_over_75128 = nR_59382;\n        } else {\n            loop_over_75128 = index_75126;\n        }\n        if (cond_75127) {\n            int64_t loop_over_t_res_75130 = sub64(index_75126, nR_59382);\n",
                                    "            \n            loop_over_75129 = loop_over_t_res_75130;\n        } else {\n            loop_over_75129 = (int64_t) 0;\n        }\n        if (cond_75127) {\n            int64_t zm_lhs_75132;\n            int64_t loop_over_t_res_75133;\n            \n            zm_lhs_75132 = sub64(index_75126, nR_59382);\n            loop_over_t_res_75133 = sub64(zm_lhs_75132, (int64_t) 1);\n            loop_over_75131 = loop_over_t_res_75133;\n        } else {\n            loop_over_75131 = (int64_t) 0;\n        }\n        loop_while_75138 = 1;\n        p_75139 = loop_over_75131;\n        p_75140 = loop_over_75128;\n        p_75141 = loop_over_75129;\n        while (loop_while_75138) {\n            int64_t zs_lhs_75142;\n            int64_t offset_75143;\n            int64_t ai_75144;\n            int64_t max_arg1_75145;\n            int64_t max_res_75146;\n            bool cond_75147;\n            double b_prev_75148;\n            bool cond_75156;\n            int64_t loopres_75157;\n            int64_t loopres_75158;\n            int64_t loopres_75159;\n            bool loopres_75160;\n            bool loop_while_tmp_78880;\n            int64_t p_tmp_78881;\n            int64_t p_tmp_78882;\n            int64_t p_tmp_78883;\n            \n            zs_lhs_75142 = sub64(p_75140, p_75139);\n            offset_75143 = sdiv64(zs_lhs_75142, (int64_t) 2);\n            ai_75144 = sub64(p_75140, offset_75143);\n            max_arg1_75145 = add64(p_75141, offset_75143);\n            max_res_75146 = smax64((int64_t) 0, max_arg1_75145);\n            cond_75147 = slt64((int64_t) 0, max_res_75146);\n            if (cond_75147) {\n                int64_t tmp_75149;\n                bool x_75150;\n                bool y_75151;\n                bool bounds_check_75152;\n                bool index_certs_75153;\n                int64_t slice_75154;\n                double b_prev_t_res_75155;\n                \n                tmp_75149 = sub64(max_res_75146, (int64_t) 1);\n                x_75150 = sle64((int64_t) 0, tmp_75149);\n      ", "          y_75151 = slt64(tmp_75149, nR_59382);\n                bounds_check_75152 = x_75150 && y_75151;\n                if (!bounds_check_75152) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_75149;\n                            global_failure_args[1] = (int64_t) nR_59382;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_75154 = tS_start_66998 + tmp_75149;\n                b_prev_t_res_75155 = ((__global double *) tS_mem_77626)[slice_75154];\n                b_prev_75148 = b_prev_t_res_75155;\n            } else {\n                b_prev_75148 = lowest_77569;\n            }\n            cond_75156 = sle64(ai_75144, (int64_t) 0);\n            if (cond_75156) {\n                loopres_75157 = p_75139;\n                loopres_75158 = (int64_t) 0;\n                loopres_75159 = max_res_75146;\n                loopres_75160 = 0;\n            } else {\n                bool cond_75161;\n                int64_t loopres_f_res_75162;\n                int64_t loopres_f_res_75163;\n                int64_t loopres_f_res_75164;\n                bool loopres_f_res_75165;\n                \n                cond_75161 = sle64(nR_59382, max_res_75146);\n                if (cond_75161) {\n                    int64_t min_arg1_75166;\n                    int64_t min_res_75167;\n                    bool x_75168;\n                    bool y_75169;\n                    bool bounds_check_75170;\n                    bool index_certs_75171;\n                    bool x_75174;\n                    bool y_75175;\n                    bool bounds_check_75176;\n                    bool index_certs_75177;\n                    int64_t slice_75172;\n                    double leq_lhs_75173;\n                    double leq_rhs_75178;\n                    bool defunc_0_leq_res_75179;\n                    in", "t64_t loopres_f_res_t_res_75180;\n                    bool x_75181;\n                    int64_t loopres_f_res_t_res_75182;\n                    \n                    min_arg1_75166 = sub64(nR_59382, (int64_t) 1);\n                    min_res_75167 = smin64(ai_75144, min_arg1_75166);\n                    x_75168 = sle64((int64_t) 0, min_arg1_75166);\n                    y_75169 = slt64(min_arg1_75166, nR_59382);\n                    bounds_check_75170 = x_75168 && y_75169;\n                    if (!bounds_check_75170) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_75166;\n                                global_failure_args[1] = (int64_t) nR_59382;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_75174 = sle64((int64_t) 0, min_res_75167);\n                    y_75175 = slt64(min_res_75167, nR_59382);\n                    bounds_check_75176 = x_75174 && y_75175;\n                    if (!bounds_check_75176) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_75167;\n                                global_failure_args[1] = (int64_t) nR_59382;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_75172 = tS_start_66998 + min_arg1_75166;\n                    leq_lhs_75173 = ((__global double *) tS_mem_77626)[slice_75172];\n                    leq_rhs_75178 = ((__global double *) tR_mem_77625)[min_res_75167];\n                    defunc_0_leq_res_75179 = leq_lhs_75173 <= leq_rhs_75178;\n                    if (defunc_0_leq_res_75179) {\n                        loopres_f",
                                    "_res_t_res_75180 = ai_75144;\n                    } else {\n                        loopres_f_res_t_res_75180 = p_75140;\n                    }\n                    x_75181 = !defunc_0_leq_res_75179;\n                    if (defunc_0_leq_res_75179) {\n                        loopres_f_res_t_res_75182 = nR_59382;\n                    } else {\n                        int64_t tmp_75183 = sub64(min_arg1_75166, offset_75143);\n                        \n                        loopres_f_res_t_res_75182 = tmp_75183;\n                    }\n                    loopres_f_res_75162 = p_75139;\n                    loopres_f_res_75163 = loopres_f_res_t_res_75180;\n                    loopres_f_res_75164 = loopres_f_res_t_res_75182;\n                    loopres_f_res_75165 = x_75181;\n                } else {\n                    bool cond_75184;\n                    int64_t loopres_f_res_f_res_75185;\n                    int64_t loopres_f_res_f_res_75186;\n                    int64_t loopres_f_res_f_res_75187;\n                    bool loopres_f_res_f_res_75188;\n                    \n                    cond_75184 = sle64(nR_59382, ai_75144);\n                    if (cond_75184) {\n                        int64_t min_arg1_75189;\n                        int64_t min_res_75190;\n                        bool x_75191;\n                        bool y_75192;\n                        bool bounds_check_75193;\n                        bool index_certs_75194;\n                        bool x_75196;\n                        bool y_75197;\n                        bool bounds_check_75198;\n                        bool index_certs_75199;\n                        double leq_lhs_75195;\n                        int64_t slice_75200;\n                        double leq_rhs_75201;\n                        bool defunc_0_leq_res_75202;\n                        int64_t loopres_f_res_f_res_t_res_75203;\n                        bool x_75204;\n                        int64_t loopres_f_res_f_res_t_res_75205;\n                        \n          ", "              min_arg1_75189 = sub64(nR_59382, (int64_t) 1);\n                        min_res_75190 = smin64(max_res_75146, min_arg1_75189);\n                        x_75191 = sle64((int64_t) 0, min_arg1_75189);\n                        y_75192 = slt64(min_arg1_75189, nR_59382);\n                        bounds_check_75193 = x_75191 && y_75192;\n                        if (!bounds_check_75193) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_75189;\n                                    global_failure_args[1] = (int64_t) nR_59382;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_75196 = sle64((int64_t) 0, min_res_75190);\n                        y_75197 = slt64(min_res_75190, nR_59382);\n                        bounds_check_75198 = x_75196 && y_75197;\n                        if (!bounds_check_75198) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_75190;\n                                    global_failure_args[1] = (int64_t) nR_59382;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_75195 = ((__global double *) tR_mem_77625)[min_arg1_75189];\n                        slice_75200 = tS_start_66998 + min_res_75190;\n                        leq_rhs_75201 = ((__global double *) tS_mem_77626)[slice_75200];\n                        defunc_0_leq_res_75202 = leq_lhs_75195 <= leq_rhs_75201;\n                        if (defunc_0_leq_res_75202) {\n                            loopres_f_res_f_res_t", "_res_75203 = max_res_75146;\n                        } else {\n                            loopres_f_res_f_res_t_res_75203 = p_75141;\n                        }\n                        x_75204 = !defunc_0_leq_res_75202;\n                        if (defunc_0_leq_res_75202) {\n                            loopres_f_res_f_res_t_res_75205 = nR_59382;\n                        } else {\n                            loopres_f_res_f_res_t_res_75205 = min_arg1_75189;\n                        }\n                        loopres_f_res_f_res_75185 = p_75139;\n                        loopres_f_res_f_res_75186 = loopres_f_res_f_res_t_res_75205;\n                        loopres_f_res_f_res_75187 = loopres_f_res_f_res_t_res_75203;\n                        loopres_f_res_f_res_75188 = x_75204;\n                    } else {\n                        bool cond_75206;\n                        int64_t loopres_f_res_f_res_f_res_75207;\n                        int64_t loopres_f_res_f_res_f_res_75208;\n                        int64_t loopres_f_res_f_res_f_res_75209;\n                        bool loopres_f_res_f_res_f_res_75210;\n                        \n                        cond_75206 = sle64(p_75140, p_75139);\n                        if (cond_75206) {\n                            bool cond_75211;\n                            int64_t ai_75212;\n                            bool x_75225;\n                            bool y_75226;\n                            bool bounds_check_75227;\n                            bool index_certs_75228;\n                            double b_prev_75214;\n                            double gt_lhs_75229;\n                            bool defunc_0_gt_res_75230;\n                            int64_t defunc_0_partFunc_sequential_search_res_75231;\n                            int64_t defunc_0_partFunc_sequential_search_res_75232;\n                            \n                            cond_75211 = slt64(ai_75144, nR_59382);\n                            if (cond_75211) {\n                             ",
                                    "   ai_75212 = ai_75144;\n                            } else {\n                                int64_t ai_f_res_75213 = sub64(nR_59382, (int64_t) 1);\n                                \n                                ai_75212 = ai_f_res_75213;\n                            }\n                            x_75225 = sle64((int64_t) 0, ai_75212);\n                            y_75226 = slt64(ai_75212, nR_59382);\n                            bounds_check_75227 = x_75225 && y_75226;\n                            if (!bounds_check_75227) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_75212;\n                                        global_failure_args[1] = (int64_t) nR_59382;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_75147) {\n                                int64_t tmp_75215;\n                                bool x_75216;\n                                bool y_75217;\n                                bool bounds_check_75218;\n                                bool index_certs_75219;\n                                int64_t slice_75220;\n                                double b_prev_t_res_75221;\n                                \n                                tmp_75215 = sub64(max_res_75146, (int64_t) 1);\n                                x_75216 = sle64((int64_t) 0, tmp_75215);\n                                y_75217 = slt64(tmp_75215, nR_59382);\n                                bounds_check_75218 = x_75216 && y_75217;\n                                if (!bounds_check_75218) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                                        ", "    global_failure_args[0] = (int64_t) tmp_75215;\n                                            global_failure_args[1] = (int64_t) nR_59382;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_75220 = tS_start_66998 + tmp_75215;\n                                b_prev_t_res_75221 = ((__global double *) tS_mem_77626)[slice_75220];\n                                b_prev_75214 = b_prev_t_res_75221;\n                            } else {\n                                bool y_75222;\n                                bool index_certs_75223;\n                                double b_prev_f_res_75224;\n                                \n                                y_75222 = slt64((int64_t) 0, nR_59382);\n                                if (!y_75222) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_59382;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_75224 = ((__global double *) tS_mem_77626)[tS_start_66998];\n                                b_prev_75214 = b_prev_f_res_75224;\n                            }\n                            gt_lhs_75229 = ((__global double *) tR_mem_77625)[ai_75212];\n                            defunc_0_gt_res_75230 = b_prev_75214 < gt_lhs_75229;\n                            if (defunc_0_gt_res_75230) {\n                                int64_t zl_rhs_75233;\n                                bool loop_cond", "_75234;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_75235;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_75236;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_75237;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_75238;\n                                bool loop_while_75239;\n                                int64_t p_75240;\n                                int64_t p_75241;\n                                int64_t p_75242;\n                                \n                                zl_rhs_75233 = sub64(nR_59382, max_res_75146);\n                                loop_cond_75234 = slt64((int64_t) 0, zl_rhs_75233);\n                                loop_while_75239 = loop_cond_75234;\n                                p_75240 = ai_75212;\n                                p_75241 = max_res_75146;\n                                p_75242 = (int64_t) 0;\n                                while (loop_while_75239) {\n                                    int64_t i_a_75243;\n                                    int64_t i_b_75244;\n                                    int64_t leq_lhs_75245;\n                                    bool x_75246;\n                                    bool y_75247;\n                                    bool bounds_check_75248;\n                                    bool index_certs_75249;\n                                    bool x_75251;\n                                    bool y_75252;\n                                    bool bounds_check_75253;\n                                    bool index_certs_75254;\n                                    double leq_lhs_75250;\n                                    int64_t slice_75255;\n                                    double leq_rhs_75256;\n                                    bool defunc_0_leq_res_75257;\n                                    int64_t loopres_75258;\n                          ",
                                    "          int64_t loopres_75259;\n                                    int64_t loopres_75260;\n                                    bool loop_cond_75262;\n                                    bool loop_while_tmp_78884;\n                                    int64_t p_tmp_78885;\n                                    int64_t p_tmp_78886;\n                                    int64_t p_tmp_78887;\n                                    \n                                    i_a_75243 = sub64(ai_75212, p_75242);\n                                    i_b_75244 = add64(max_res_75146, p_75242);\n                                    leq_lhs_75245 = sub64(i_a_75243, (int64_t) 1);\n                                    x_75246 = sle64((int64_t) 0, leq_lhs_75245);\n                                    y_75247 = slt64(leq_lhs_75245, nR_59382);\n                                    bounds_check_75248 = x_75246 && y_75247;\n                                    if (!bounds_check_75248) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_75245;\n                                                global_failure_args[1] = (int64_t) nR_59382;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_75251 = sle64((int64_t) 0, i_b_75244);\n                                    y_75252 = slt64(i_b_75244, nR_59382);\n                                    bounds_check_75253 = x_75251 && y_75252;\n                                    if (!bounds_check_75253) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                                    ", "            global_failure_args[0] = (int64_t) i_b_75244;\n                                                global_failure_args[1] = (int64_t) nR_59382;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_75250 = ((__global double *) tR_mem_77625)[leq_lhs_75245];\n                                    slice_75255 = tS_start_66998 + i_b_75244;\n                                    leq_rhs_75256 = ((__global double *) tS_mem_77626)[slice_75255];\n                                    defunc_0_leq_res_75257 = leq_lhs_75250 <= leq_rhs_75256;\n                                    if (defunc_0_leq_res_75257) {\n                                        loopres_75258 = i_a_75243;\n                                    } else {\n                                        loopres_75258 = ai_75212;\n                                    }\n                                    if (defunc_0_leq_res_75257) {\n                                        loopres_75259 = i_b_75244;\n                                    } else {\n                                        loopres_75259 = max_res_75146;\n                                    }\n                                    if (defunc_0_leq_res_75257) {\n                                        loopres_75260 = zl_rhs_75233;\n                                    } else {\n                                        int64_t tmp_75261 = add64((int64_t) 1, p_75242);\n                                        \n                                        loopres_75260 = tmp_75261;\n                                    }\n                                    loop_cond_75262 = slt64(loopres_75260, zl_rhs_75233);\n                                    loop_while_tmp_78884 = loop_cond_75262;\n                                    p_tmp_78885 = loopres_75258;\n                              ", "      p_tmp_78886 = loopres_75259;\n                                    p_tmp_78887 = loopres_75260;\n                                    loop_while_75239 = loop_while_tmp_78884;\n                                    p_75240 = p_tmp_78885;\n                                    p_75241 = p_tmp_78886;\n                                    p_75242 = p_tmp_78887;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_75235 = loop_while_75239;\n                                defunc_0_partFunc_sequential_search_res_t_res_75236 = p_75240;\n                                defunc_0_partFunc_sequential_search_res_t_res_75237 = p_75241;\n                                defunc_0_partFunc_sequential_search_res_t_res_75238 = p_75242;\n                                defunc_0_partFunc_sequential_search_res_75231 = defunc_0_partFunc_sequential_search_res_t_res_75236;\n                                defunc_0_partFunc_sequential_search_res_75232 = defunc_0_partFunc_sequential_search_res_t_res_75237;\n                            } else {\n                                int64_t zl_rhs_75263;\n                                bool loop_cond_75264;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_75265;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_75266;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_75267;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_75268;\n                                bool loop_while_75269;\n                                int64_t p_75270;\n                                int64_t p_75271;\n                                int64_t p_75272;\n                                \n                                zl_rhs_75263 = sub64(max_res_75146, (int64_t) 1);\n                                loop_cond_75264 = slt64((int64_t) 0, zl_rhs_75263);\n                                loop_while",
                                    "_75269 = loop_cond_75264;\n                                p_75270 = ai_75212;\n                                p_75271 = max_res_75146;\n                                p_75272 = (int64_t) 0;\n                                while (loop_while_75269) {\n                                    int64_t zp_lhs_75273;\n                                    int64_t hi_a_75274;\n                                    bool cond_75275;\n                                    int64_t i_a_75276;\n                                    int64_t zm_lhs_75278;\n                                    int64_t i_b_75279;\n                                    bool x_75280;\n                                    bool y_75281;\n                                    bool bounds_check_75282;\n                                    bool index_certs_75283;\n                                    bool x_75285;\n                                    bool y_75286;\n                                    bool bounds_check_75287;\n                                    bool index_certs_75288;\n                                    double gt_lhs_75284;\n                                    int64_t slice_75289;\n                                    double gt_rhs_75290;\n                                    bool defunc_0_gt_res_75291;\n                                    int64_t loopres_75292;\n                                    int64_t loopres_75293;\n                                    int64_t loopres_75294;\n                                    bool loop_cond_75296;\n                                    bool loop_while_tmp_78888;\n                                    int64_t p_tmp_78889;\n                                    int64_t p_tmp_78890;\n                                    int64_t p_tmp_78891;\n                                    \n                                    zp_lhs_75273 = add64(ai_75212, p_75272);\n                                    hi_a_75274 = add64((int64_t) 1, zp_lhs_75273);\n                                    cond_75275 = slt64(hi_a_75274, nR_593", "82);\n                                    if (cond_75275) {\n                                        i_a_75276 = hi_a_75274;\n                                    } else {\n                                        int64_t i_a_f_res_75277 = sub64(nR_59382, (int64_t) 1);\n                                        \n                                        i_a_75276 = i_a_f_res_75277;\n                                    }\n                                    zm_lhs_75278 = sub64(max_res_75146, p_75272);\n                                    i_b_75279 = sub64(zm_lhs_75278, (int64_t) 1);\n                                    x_75280 = sle64((int64_t) 0, i_a_75276);\n                                    y_75281 = slt64(i_a_75276, nR_59382);\n                                    bounds_check_75282 = x_75280 && y_75281;\n                                    if (!bounds_check_75282) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_75276;\n                                                global_failure_args[1] = (int64_t) nR_59382;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_75285 = sle64((int64_t) 0, i_b_75279);\n                                    y_75286 = slt64(i_b_75279, nR_59382);\n                                    bounds_check_75287 = x_75285 && y_75286;\n                                    if (!bounds_check_75287) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 23) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_75279;\n                                   ", "             global_failure_args[1] = (int64_t) nR_59382;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_75284 = ((__global double *) tR_mem_77625)[i_a_75276];\n                                    slice_75289 = tS_start_66998 + i_b_75279;\n                                    gt_rhs_75290 = ((__global double *) tS_mem_77626)[slice_75289];\n                                    defunc_0_gt_res_75291 = gt_rhs_75290 < gt_lhs_75284;\n                                    if (defunc_0_gt_res_75291) {\n                                        loopres_75292 = i_a_75276;\n                                    } else {\n                                        loopres_75292 = ai_75212;\n                                    }\n                                    if (defunc_0_gt_res_75291) {\n                                        loopres_75293 = zm_lhs_75278;\n                                    } else {\n                                        loopres_75293 = max_res_75146;\n                                    }\n                                    if (defunc_0_gt_res_75291) {\n                                        loopres_75294 = zl_rhs_75263;\n                                    } else {\n                                        int64_t tmp_75295 = add64((int64_t) 1, p_75272);\n                                        \n                                        loopres_75294 = tmp_75295;\n                                    }\n                                    loop_cond_75296 = slt64(loopres_75294, zl_rhs_75263);\n                                    loop_while_tmp_78888 = loop_cond_75296;\n                                    p_tmp_78889 = loopres_75292;\n                                    p_tmp_78890 = loopres_75293;\n                                    p_tmp_78891 = loopres_75294;\n   ",
                                    "                                 loop_while_75269 = loop_while_tmp_78888;\n                                    p_75270 = p_tmp_78889;\n                                    p_75271 = p_tmp_78890;\n                                    p_75272 = p_tmp_78891;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_75265 = loop_while_75269;\n                                defunc_0_partFunc_sequential_search_res_f_res_75266 = p_75270;\n                                defunc_0_partFunc_sequential_search_res_f_res_75267 = p_75271;\n                                defunc_0_partFunc_sequential_search_res_f_res_75268 = p_75272;\n                                defunc_0_partFunc_sequential_search_res_75231 = defunc_0_partFunc_sequential_search_res_f_res_75266;\n                                defunc_0_partFunc_sequential_search_res_75232 = defunc_0_partFunc_sequential_search_res_f_res_75267;\n                            }\n                            loopres_f_res_f_res_f_res_75207 = p_75139;\n                            loopres_f_res_f_res_f_res_75208 = defunc_0_partFunc_sequential_search_res_75231;\n                            loopres_f_res_f_res_f_res_75209 = defunc_0_partFunc_sequential_search_res_75232;\n                            loopres_f_res_f_res_f_res_75210 = 0;\n                        } else {\n                            bool x_75297;\n                            bool y_75298;\n                            bool bounds_check_75299;\n                            bool index_certs_75300;\n                            double gt_lhs_75301;\n                            bool defunc_0_gt_res_75302;\n                            int64_t loopres_f_res_f_res_f_res_f_res_75303;\n                            int64_t loopres_f_res_f_res_f_res_f_res_75304;\n                            int64_t loopres_f_res_f_res_f_res_f_res_75305;\n                            bool loopres_f_res_f_res_f_res_f_res_75306;\n                            \n                       ", "     x_75297 = sle64((int64_t) 0, ai_75144);\n                            y_75298 = slt64(ai_75144, nR_59382);\n                            bounds_check_75299 = x_75297 && y_75298;\n                            if (!bounds_check_75299) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 24) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_75144;\n                                        global_failure_args[1] = (int64_t) nR_59382;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_75301 = ((__global double *) tR_mem_77625)[ai_75144];\n                            defunc_0_gt_res_75302 = b_prev_75148 < gt_lhs_75301;\n                            if (defunc_0_gt_res_75302) {\n                                int64_t leq_lhs_75307;\n                                bool x_75308;\n                                bool y_75309;\n                                bool bounds_check_75310;\n                                bool index_certs_75311;\n                                bool x_75313;\n                                bool y_75314;\n                                bool bounds_check_75315;\n                                bool index_certs_75316;\n                                double leq_lhs_75312;\n                                int64_t slice_75317;\n                                double leq_rhs_75318;\n                                bool defunc_0_leq_res_75319;\n                                bool x_75320;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_75321;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_75322;\n                                \n                                leq_lhs_75307 = sub64(ai_75144, (int64_t) 1);\n                                x_", "75308 = sle64((int64_t) 0, leq_lhs_75307);\n                                y_75309 = slt64(leq_lhs_75307, nR_59382);\n                                bounds_check_75310 = x_75308 && y_75309;\n                                if (!bounds_check_75310) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 25) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_75307;\n                                            global_failure_args[1] = (int64_t) nR_59382;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_75313 = sle64((int64_t) 0, max_res_75146);\n                                y_75314 = slt64(max_res_75146, nR_59382);\n                                bounds_check_75315 = x_75313 && y_75314;\n                                if (!bounds_check_75315) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 26) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_75146;\n                                            global_failure_args[1] = (int64_t) nR_59382;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_75312 = ((__global double *) tR_mem_77625)[leq_lhs_75307];\n                                slice_75317 = tS_start_66998 + max_res_75146;\n                                leq_rhs_75318 = ((__global double *) tS_mem_77626)[slice_75317];\n                                defunc_0_leq_res_75319 = leq_lhs_75312 <= leq_rhs_75318;\n                                x_75320 =",
                                    " !defunc_0_leq_res_75319;\n                                if (defunc_0_leq_res_75319) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_75321 = ai_75144;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_75321 = leq_lhs_75307;\n                                }\n                                if (defunc_0_leq_res_75319) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_75322 = max_res_75146;\n                                } else {\n                                    int64_t tmp_75323 = add64((int64_t) 1, max_res_75146);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_75322 = tmp_75323;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_75303 = p_75139;\n                                loopres_f_res_f_res_f_res_f_res_75304 = loopres_f_res_f_res_f_res_f_res_t_res_75321;\n                                loopres_f_res_f_res_f_res_f_res_75305 = loopres_f_res_f_res_f_res_f_res_t_res_75322;\n                                loopres_f_res_f_res_f_res_f_res_75306 = x_75320;\n                            } else {\n                                int64_t tmp_75324 = add64((int64_t) 1, ai_75144);\n                                \n                                loopres_f_res_f_res_f_res_f_res_75303 = tmp_75324;\n                                loopres_f_res_f_res_f_res_f_res_75304 = p_75140;\n                                loopres_f_res_f_res_f_res_f_res_75305 = p_75141;\n                                loopres_f_res_f_res_f_res_f_res_75306 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_75207 = loopres_f_res_f_res_f_res_f_res_75303;\n                            loopres_f_res_f_res_f_res_75208 = loopres_f_res_f_res_f_res_f_res_75304;\n                            loopres_f_res_f_res_f_res_75209 = loopres_f_res_f_res_f_res_f_res", "_75305;\n                            loopres_f_res_f_res_f_res_75210 = loopres_f_res_f_res_f_res_f_res_75306;\n                        }\n                        loopres_f_res_f_res_75185 = loopres_f_res_f_res_f_res_75207;\n                        loopres_f_res_f_res_75186 = loopres_f_res_f_res_f_res_75208;\n                        loopres_f_res_f_res_75187 = loopres_f_res_f_res_f_res_75209;\n                        loopres_f_res_f_res_75188 = loopres_f_res_f_res_f_res_75210;\n                    }\n                    loopres_f_res_75162 = loopres_f_res_f_res_75185;\n                    loopres_f_res_75163 = loopres_f_res_f_res_75186;\n                    loopres_f_res_75164 = loopres_f_res_f_res_75187;\n                    loopres_f_res_75165 = loopres_f_res_f_res_75188;\n                }\n                loopres_75157 = loopres_f_res_75162;\n                loopres_75158 = loopres_f_res_75163;\n                loopres_75159 = loopres_f_res_75164;\n                loopres_75160 = loopres_f_res_75165;\n            }\n            loop_while_tmp_78880 = loopres_75160;\n            p_tmp_78881 = loopres_75157;\n            p_tmp_78882 = loopres_75158;\n            p_tmp_78883 = loopres_75159;\n            loop_while_75138 = loop_while_tmp_78880;\n            p_75139 = p_tmp_78881;\n            p_75140 = p_tmp_78882;\n            p_75141 = p_tmp_78883;\n        }\n        defunc_0_f_res_75134 = loop_while_75138;\n        defunc_0_f_res_75135 = p_75139;\n        defunc_0_f_res_75136 = p_75140;\n        defunc_0_f_res_75137 = p_75141;\n        ((__global int64_t *) mem_77662)[gtid_75122] = defunc_0_f_res_75136;\n        ((__global int64_t *) mem_77664)[gtid_75122] = defunc_0_f_res_75137;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75118\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75497_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75497(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_59382, int64_t gt_rhs_66981, int64_t tS_", "start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t zeze_rhs_67414, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77644, __global unsigned char *mem_77646, __global unsigned char *mem_77680, __global unsigned char *mem_77682)\n{\n    #define segmap_tblock_sizze_75492 (inner_SMJ_doublezisegmap_75497zisegmap_tblock_sizze_75492)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78896;\n    int32_t tblock_sizze_78899;\n    int32_t wave_sizze_78898;\n    int32_t block_id_78897;\n    int32_t global_tid_78895;\n    int64_t phys_tid_75497;\n    int64_t global_tid_78900;\n    int64_t slice_78901;\n    int64_t gtid_75496;\n    int64_t remnant_78902;\n    \n    local_tid_78896 = get_local_id(0);\n    tblock_sizze_78899 = get_local_size(0);\n    wave_sizze_78898 = LOCKSTEP_WIDTH;\n    block_id_78897 = get_tblock_id(0);\n    global_tid_78895 = block_id_78897 * tblock_sizze_78899 + local_tid_78896;\n    phys_tid_75497 = sext_i32_i64(global_tid_78895);\n    global_tid_78900 = sext_i32_i64(block_id_78897) * segmap_tblock_sizze_75492 + sext_i32_i64(local_tid_78896);\n    slice_78901 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n    gtid_75496 = global_tid_78900;\n    remnant_78902 = global_tid_78900 - gtid_75496;\n    if (slt64(gtid_75496, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140)) {\n        int64_t eta_p_75499;\n        int64_t min_res_75500;\n        bool x_75501;\n        bool y_75502;\n        bool bounds_check_75503;\n        bool index_certs_75504;\n        bool cond_75506;\n        int64_t ri_next_75507;\n        int64_t max_arg1_75514;\n        int64_t max_res_75515;\n        bool x_75516;\n        bool y_75517;\n        bool bounds_check_75518;\n        bool index_certs_75519;\n        double r_min_75505;\n        double r_max_75520;\n        bool defunc_0_f_res_75521;\n        int64_t defunc_0_f_res_75522;\n        bool loop_while_75523",
                                    ";\n        int64_t fm_75524;\n        bool defunc_0_f_res_75590;\n        int64_t defunc_0_f_res_75591;\n        bool loop_while_75592;\n        int64_t lm_75593;\n        \n        eta_p_75499 = ((__global int64_t *) mem_77644)[gtid_75496];\n        min_res_75500 = smin64(gt_rhs_66981, eta_p_75499);\n        x_75501 = sle64((int64_t) 0, min_res_75500);\n        y_75502 = slt64(min_res_75500, nR_59382);\n        bounds_check_75503 = x_75501 && y_75502;\n        if (!bounds_check_75503) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 27) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_75500;\n                    global_failure_args[1] = (int64_t) nR_59382;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_75506 = gtid_75496 == zeze_rhs_67414;\n        if (cond_75506) {\n            ri_next_75507 = nR_59382;\n        } else {\n            int64_t tmp_75508;\n            bool x_75509;\n            bool y_75510;\n            bool bounds_check_75511;\n            bool index_certs_75512;\n            int64_t ri_next_f_res_75513;\n            \n            tmp_75508 = add64((int64_t) 1, gtid_75496);\n            x_75509 = sle64((int64_t) 0, tmp_75508);\n            y_75510 = slt64(tmp_75508, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_75511 = x_75509 && y_75510;\n            if (!bounds_check_75511) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 28) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_75508;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_75513 = ((__global int64_t *) mem_77644)[tmp_75508];\n            ri_next_75507 = ri_next_f_res_75513;\n        }\n      ", "  max_arg1_75514 = sub64(ri_next_75507, (int64_t) 1);\n        max_res_75515 = smax64((int64_t) 0, max_arg1_75514);\n        x_75516 = sle64((int64_t) 0, max_res_75515);\n        y_75517 = slt64(max_res_75515, nR_59382);\n        bounds_check_75518 = x_75516 && y_75517;\n        if (!bounds_check_75518) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 29) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_75515;\n                    global_failure_args[1] = (int64_t) nR_59382;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_75505 = ((__global double *) tR_mem_77625)[min_res_75500];\n        r_max_75520 = ((__global double *) tR_mem_77625)[max_res_75515];\n        loop_while_75523 = 1;\n        fm_75524 = gtid_75496;\n        while (loop_while_75523) {\n            bool x_75525;\n            bool y_75526;\n            bool bounds_check_75527;\n            bool index_certs_75528;\n            int64_t loopres_75529;\n            int64_t min_res_75530;\n            bool x_75531;\n            bool y_75532;\n            bool bounds_check_75533;\n            bool index_certs_75534;\n            bool cond_75537;\n            int64_t si_next_75538;\n            int64_t max_arg1_75545;\n            int64_t max_res_75546;\n            bool x_75547;\n            bool y_75548;\n            bool bounds_check_75549;\n            bool index_certs_75550;\n            int64_t min_res_75553;\n            bool x_75554;\n            bool y_75555;\n            bool bounds_check_75556;\n            bool index_certs_75557;\n            int64_t max_arg1_75560;\n            int64_t max_res_75561;\n            bool x_75562;\n            bool y_75563;\n            bool bounds_check_75564;\n            bool index_certs_75565;\n            int64_t slice_75535;\n            double s_min_75536;\n            int64_t slice_75551;\n            int64_t slice_75558;\n            int64_t slice_75566;\n            bool defunc_0_gt_res_75568;\n", "            bool loopres_75569;\n            int64_t loopres_75570;\n            bool loop_while_tmp_78903;\n            int64_t fm_tmp_78904;\n            \n            x_75525 = sle64((int64_t) 0, fm_75524);\n            y_75526 = slt64(fm_75524, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_75527 = x_75525 && y_75526;\n            if (!bounds_check_75527) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 30) == -1) {\n                        global_failure_args[0] = (int64_t) fm_75524;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_75529 = ((__global int64_t *) mem_77646)[fm_75524];\n            min_res_75530 = smin64(gt_rhs_66981, loopres_75529);\n            x_75531 = sle64((int64_t) 0, min_res_75530);\n            y_75532 = slt64(min_res_75530, nR_59382);\n            bounds_check_75533 = x_75531 && y_75532;\n            if (!bounds_check_75533) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 31) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_75530;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_75537 = sle64(zeze_rhs_67414, fm_75524);\n            if (cond_75537) {\n                si_next_75538 = nR_59382;\n            } else {\n                int64_t tmp_75539;\n                bool x_75540;\n                bool y_75541;\n                bool bounds_check_75542;\n                bool index_certs_75543;\n                int64_t si_next_f_res_75544;\n                \n                tmp_75539 = add64((int64_t) 1, fm_75524);\n                x_75540 = sle64((int64_t) 0, tmp_7",
                                    "5539);\n                y_75541 = slt64(tmp_75539, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_75542 = x_75540 && y_75541;\n                if (!bounds_check_75542) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 32) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_75539;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_75544 = ((__global int64_t *) mem_77646)[tmp_75539];\n                si_next_75538 = si_next_f_res_75544;\n            }\n            max_arg1_75545 = sub64(si_next_75538, (int64_t) 1);\n            max_res_75546 = smax64(min_res_75530, max_arg1_75545);\n            x_75547 = sle64((int64_t) 0, max_res_75546);\n            y_75548 = slt64(max_res_75546, nR_59382);\n            bounds_check_75549 = x_75547 && y_75548;\n            if (!bounds_check_75549) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 33) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_75546;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_75553 = smin64(zeze_rhs_67414, si_next_75538);\n            x_75554 = sle64((int64_t) 0, min_res_75553);\n            y_75555 = slt64(min_res_75553, nR_59382);\n            bounds_check_75556 = x_75554 && y_75555;\n            if (!bounds_check_75556) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 34) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_75553;\n                        global_failure_args[1] = (int64_", "t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_75560 = sub64(min_res_75530, (int64_t) 1);\n            max_res_75561 = smax64((int64_t) 0, max_arg1_75560);\n            x_75562 = sle64((int64_t) 0, max_res_75561);\n            y_75563 = slt64(max_res_75561, nR_59382);\n            bounds_check_75564 = x_75562 && y_75563;\n            if (!bounds_check_75564) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 35) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_75561;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_75535 = tS_start_66998 + min_res_75530;\n            s_min_75536 = ((__global double *) tS_mem_77626)[slice_75535];\n            slice_75551 = tS_start_66998 + max_res_75546;\n            slice_75558 = tS_start_66998 + min_res_75553;\n            slice_75566 = tS_start_66998 + max_res_75561;\n            defunc_0_gt_res_75568 = s_min_75536 < r_min_75505;\n            if (defunc_0_gt_res_75568) {\n                double s_max_75552;\n                bool defunc_0_leq_res_75571;\n                bool loopres_t_res_75572;\n                int64_t loopres_t_res_75573;\n                \n                s_max_75552 = ((__global double *) tS_mem_77626)[slice_75551];\n                defunc_0_leq_res_75571 = r_min_75505 <= s_max_75552;\n                if (defunc_0_leq_res_75571) {\n                    loopres_t_res_75572 = 0;\n                    loopres_t_res_75573 = fm_75524;\n                } else {\n                    double s_nextMin_75559;\n                    bool defunc_0_leq_res_75574;\n                    int64_t zgze_lhs_75575;\n                    bool tmp_f_res_75576;\n                    bool x_75577;\n                    bool y_75578;\n                    bool tmp_75579;\n", "                    bool loopres_t_res_f_res_75580;\n                    \n                    s_nextMin_75559 = ((__global double *) tS_mem_77626)[slice_75558];\n                    defunc_0_leq_res_75574 = r_min_75505 <= s_nextMin_75559;\n                    zgze_lhs_75575 = add64((int64_t) 1, fm_75524);\n                    tmp_f_res_75576 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zgze_lhs_75575);\n                    x_75577 = !defunc_0_leq_res_75574;\n                    y_75578 = tmp_f_res_75576 && x_75577;\n                    tmp_75579 = defunc_0_leq_res_75574 || y_75578;\n                    loopres_t_res_f_res_75580 = !tmp_75579;\n                    loopres_t_res_75572 = loopres_t_res_f_res_75580;\n                    loopres_t_res_75573 = zgze_lhs_75575;\n                }\n                loopres_75569 = loopres_t_res_75572;\n                loopres_75570 = loopres_t_res_75573;\n            } else {\n                double s_prevMax_75567;\n                bool defunc_0_leq_res_75581;\n                int64_t zlze_lhs_75582;\n                bool tmp_f_res_75583;\n                bool x_75584;\n                bool y_75585;\n                bool tmp_75586;\n                int64_t max_res_75587;\n                bool loopres_f_res_75588;\n                \n                s_prevMax_75567 = ((__global double *) tS_mem_77626)[slice_75566];\n                defunc_0_leq_res_75581 = s_prevMax_75567 <= r_min_75505;\n                zlze_lhs_75582 = sub64(fm_75524, (int64_t) 1);\n                tmp_f_res_75583 = sle64(zlze_lhs_75582, (int64_t) 0);\n                x_75584 = !defunc_0_leq_res_75581;\n                y_75585 = tmp_f_res_75583 && x_75584;\n                tmp_75586 = defunc_0_leq_res_75581 || y_75585;\n                max_res_75587 = smax64((int64_t) 0, zlze_lhs_75582);\n                loopres_f_res_75588 = !tmp_75586;\n                loopres_75569 = loopres_f_res_75588;\n                loopres_75570 = max_res_75587;\n            }\n           ",
                                    " loop_while_tmp_78903 = loopres_75569;\n            fm_tmp_78904 = loopres_75570;\n            loop_while_75523 = loop_while_tmp_78903;\n            fm_75524 = fm_tmp_78904;\n        }\n        defunc_0_f_res_75521 = loop_while_75523;\n        defunc_0_f_res_75522 = fm_75524;\n        loop_while_75592 = 1;\n        lm_75593 = gtid_75496;\n        while (loop_while_75592) {\n            bool x_75594;\n            bool y_75595;\n            bool bounds_check_75596;\n            bool index_certs_75597;\n            int64_t loopres_75598;\n            int64_t min_res_75599;\n            bool x_75600;\n            bool y_75601;\n            bool bounds_check_75602;\n            bool index_certs_75603;\n            bool cond_75606;\n            int64_t si_next_75607;\n            int64_t max_arg1_75614;\n            int64_t max_res_75615;\n            bool x_75616;\n            bool y_75617;\n            bool bounds_check_75618;\n            bool index_certs_75619;\n            int64_t min_res_75622;\n            bool x_75623;\n            bool y_75624;\n            bool bounds_check_75625;\n            bool index_certs_75626;\n            int64_t max_arg1_75629;\n            int64_t max_res_75630;\n            bool x_75631;\n            bool y_75632;\n            bool bounds_check_75633;\n            bool index_certs_75634;\n            int64_t slice_75604;\n            int64_t slice_75620;\n            double s_max_75621;\n            int64_t slice_75627;\n            int64_t slice_75635;\n            bool defunc_0_gt_res_75637;\n            bool loopres_75638;\n            int64_t loopres_75639;\n            bool loop_cond_t_res_75654;\n            bool x_75655;\n            bool loop_while_tmp_78905;\n            int64_t lm_tmp_78906;\n            \n            x_75594 = sle64((int64_t) 0, lm_75593);\n            y_75595 = slt64(lm_75593, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_75596 = x_75594 && y_75595;\n            if (!bounds_check_75596) {\n                {\n    ", "                if (atomic_cmpxchg_i32_global(global_failure, -1, 36) == -1) {\n                        global_failure_args[0] = (int64_t) lm_75593;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_75598 = ((__global int64_t *) mem_77646)[lm_75593];\n            min_res_75599 = smin64(gt_rhs_66981, loopres_75598);\n            x_75600 = sle64((int64_t) 0, min_res_75599);\n            y_75601 = slt64(min_res_75599, nR_59382);\n            bounds_check_75602 = x_75600 && y_75601;\n            if (!bounds_check_75602) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 37) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_75599;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_75606 = sle64(zeze_rhs_67414, lm_75593);\n            if (cond_75606) {\n                si_next_75607 = nR_59382;\n            } else {\n                int64_t tmp_75608;\n                bool x_75609;\n                bool y_75610;\n                bool bounds_check_75611;\n                bool index_certs_75612;\n                int64_t si_next_f_res_75613;\n                \n                tmp_75608 = add64((int64_t) 1, lm_75593);\n                x_75609 = sle64((int64_t) 0, tmp_75608);\n                y_75610 = slt64(tmp_75608, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_75611 = x_75609 && y_75610;\n                if (!bounds_check_75611) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 38) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_75608;\n                        ", "    global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_75613 = ((__global int64_t *) mem_77646)[tmp_75608];\n                si_next_75607 = si_next_f_res_75613;\n            }\n            max_arg1_75614 = sub64(si_next_75607, (int64_t) 1);\n            max_res_75615 = smax64(min_res_75599, max_arg1_75614);\n            x_75616 = sle64((int64_t) 0, max_res_75615);\n            y_75617 = slt64(max_res_75615, nR_59382);\n            bounds_check_75618 = x_75616 && y_75617;\n            if (!bounds_check_75618) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 39) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_75615;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_75622 = smin64(zeze_rhs_67414, si_next_75607);\n            x_75623 = sle64((int64_t) 0, min_res_75622);\n            y_75624 = slt64(min_res_75622, nR_59382);\n            bounds_check_75625 = x_75623 && y_75624;\n            if (!bounds_check_75625) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 40) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_75622;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_75629 = sub64(min_res_75599, (int64_t) 1);\n            max_res_75630 = smax64((int64_t) 0, max_arg1_75629);\n            x_75631 = sle64((int64_t) 0, max_res_75630);\n            y_75632 = slt64(max_res_75630, nR_59382);\n            bounds_check_75633 = x_75631 && y_75632;\n            i",
                                    "f (!bounds_check_75633) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 41) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_75630;\n                        global_failure_args[1] = (int64_t) nR_59382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_75604 = tS_start_66998 + min_res_75599;\n            slice_75620 = tS_start_66998 + max_res_75615;\n            s_max_75621 = ((__global double *) tS_mem_77626)[slice_75620];\n            slice_75627 = tS_start_66998 + min_res_75622;\n            slice_75635 = tS_start_66998 + max_res_75630;\n            defunc_0_gt_res_75637 = r_max_75520 < s_max_75621;\n            if (defunc_0_gt_res_75637) {\n                double s_min_75605;\n                bool defunc_0_leq_res_75640;\n                bool loopres_t_res_75641;\n                int64_t loopres_t_res_75642;\n                \n                s_min_75605 = ((__global double *) tS_mem_77626)[slice_75604];\n                defunc_0_leq_res_75640 = s_min_75605 <= r_max_75520;\n                if (defunc_0_leq_res_75640) {\n                    loopres_t_res_75641 = 0;\n                    loopres_t_res_75642 = lm_75593;\n                } else {\n                    double s_prevMax_75636;\n                    bool defunc_0_leq_res_75643;\n                    int64_t zlze_lhs_75644;\n                    bool tmp_f_res_75645;\n                    bool x_75646;\n                    bool y_75647;\n                    bool tmp_75648;\n                    int64_t max_res_75649;\n                    bool loopres_t_res_f_res_75650;\n                    \n                    s_prevMax_75636 = ((__global double *) tS_mem_77626)[slice_75635];\n                    defunc_0_leq_res_75643 = s_prevMax_75636 <= r_max_75520;\n                    zlze_lhs_75644 = sub64(lm_75593, (int64_t) 1);\n                    tmp_f_res_75645 = sle64(zlze_lhs_75644, (int64_t) 0);\n      ", "              x_75646 = !defunc_0_leq_res_75643;\n                    y_75647 = tmp_f_res_75645 && x_75646;\n                    tmp_75648 = defunc_0_leq_res_75643 || y_75647;\n                    max_res_75649 = smax64((int64_t) 0, zlze_lhs_75644);\n                    loopres_t_res_f_res_75650 = !tmp_75648;\n                    loopres_t_res_75641 = loopres_t_res_f_res_75650;\n                    loopres_t_res_75642 = max_res_75649;\n                }\n                loopres_75638 = loopres_t_res_75641;\n                loopres_75639 = loopres_t_res_75642;\n            } else {\n                double s_nextMin_75628;\n                bool defunc_0_leq_res_75651;\n                int64_t tmp_75652;\n                bool loopres_f_res_75653;\n                \n                s_nextMin_75628 = ((__global double *) tS_mem_77626)[slice_75627];\n                defunc_0_leq_res_75651 = r_max_75520 <= s_nextMin_75628;\n                tmp_75652 = add64((int64_t) 1, lm_75593);\n                loopres_f_res_75653 = !defunc_0_leq_res_75651;\n                loopres_75638 = loopres_f_res_75653;\n                loopres_75639 = tmp_75652;\n            }\n            loop_cond_t_res_75654 = slt64(loopres_75639, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            x_75655 = loopres_75638 && loop_cond_t_res_75654;\n            loop_while_tmp_78905 = x_75655;\n            lm_tmp_78906 = loopres_75639;\n            loop_while_75592 = loop_while_tmp_78905;\n            lm_75593 = lm_tmp_78906;\n        }\n        defunc_0_f_res_75590 = loop_while_75592;\n        defunc_0_f_res_75591 = lm_75593;\n        ((__global int64_t *) mem_77680)[gtid_75496] = defunc_0_f_res_75522;\n        ((__global int64_t *) mem_77682)[gtid_75496] = defunc_0_f_res_75591;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75492\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75849_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75849(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20U", "r_startz7dUzg_67608, int64_t ext_77861, int64_t ext_77862, __global unsigned char *mem_param_77698, __global unsigned char *ext_mem_77865, __global unsigned char *mem_77869)\n{\n    #define segmap_tblock_sizze_75845 (inner_SMJ_doublezisegmap_75849zisegmap_tblock_sizze_75845)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79018;\n    int32_t tblock_sizze_79021;\n    int32_t wave_sizze_79020;\n    int32_t block_id_79019;\n    int32_t global_tid_79017;\n    int64_t phys_tid_75849;\n    int64_t global_tid_79022;\n    int64_t slice_79023;\n    int64_t gtid_75848;\n    int64_t remnant_79024;\n    \n    local_tid_79018 = get_local_id(0);\n    tblock_sizze_79021 = get_local_size(0);\n    wave_sizze_79020 = LOCKSTEP_WIDTH;\n    block_id_79019 = get_tblock_id(0);\n    global_tid_79017 = block_id_79019 * tblock_sizze_79021 + local_tid_79018;\n    phys_tid_75849 = sext_i32_i64(global_tid_79017);\n    global_tid_79022 = sext_i32_i64(block_id_79019) * segmap_tblock_sizze_75845 + sext_i32_i64(local_tid_79018);\n    slice_79023 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_75848 = global_tid_79022;\n    remnant_79024 = global_tid_79022 - gtid_75848;\n    if (slt64(gtid_75848, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_75850;\n        bool cond_75852;\n        int64_t lifted_lambda_res_75853;\n        \n        eta_p_75850 = ((__global int64_t *) mem_param_77698)[gtid_75848];\n        cond_75852 = slt64(eta_p_75850, (int64_t) 0);\n        if (cond_75852) {\n            int64_t eta_p_75851 = ((__global int64_t *) ext_mem_77865)[ext_77862 + gtid_75848 * ext_77861];\n            \n            lifted_lambda_res_75853 = eta_p_75851;\n        } else {\n            lifted_lambda_res_75853 = eta_p_75850;\n        }\n        ((__global int64_t *) mem_77869)[gtid_75848] = lifted_lambda_res_75853;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75845\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75870_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_",
                                    "75870(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77863, int64_t ext_77864, __global unsigned char *mem_param_77695, __global unsigned char *ext_mem_77866, __global unsigned char *mem_77872)\n{\n    #define segmap_tblock_sizze_75866 (inner_SMJ_doublezisegmap_75870zisegmap_tblock_sizze_75866)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79027;\n    int32_t tblock_sizze_79030;\n    int32_t wave_sizze_79029;\n    int32_t block_id_79028;\n    int32_t global_tid_79026;\n    int64_t phys_tid_75870;\n    int64_t global_tid_79031;\n    int64_t slice_79032;\n    int64_t gtid_75869;\n    int64_t remnant_79033;\n    \n    local_tid_79027 = get_local_id(0);\n    tblock_sizze_79030 = get_local_size(0);\n    wave_sizze_79029 = LOCKSTEP_WIDTH;\n    block_id_79028 = get_tblock_id(0);\n    global_tid_79026 = block_id_79028 * tblock_sizze_79030 + local_tid_79027;\n    phys_tid_75870 = sext_i32_i64(global_tid_79026);\n    global_tid_79031 = sext_i32_i64(block_id_79028) * segmap_tblock_sizze_75866 + sext_i32_i64(local_tid_79027);\n    slice_79032 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_75869 = global_tid_79031;\n    remnant_79033 = global_tid_79031 - gtid_75869;\n    if (slt64(gtid_75869, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_75871;\n        int64_t eta_p_75872;\n        int64_t defunc_0_f_res_75873;\n        \n        eta_p_75871 = ((__global int64_t *) mem_param_77695)[gtid_75869];\n        eta_p_75872 = ((__global int64_t *) ext_mem_77866)[ext_77864 + gtid_75869 * ext_77863];\n        defunc_0_f_res_75873 = add64(eta_p_75871, eta_p_75872);\n        ((__global int64_t *) mem_77872)[gtid_75869] = defunc_0_f_res_75873;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75866\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75891_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75891(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz", "20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77686, int64_t ctx_param_ext_77687, __global unsigned char *mem_param_77688, __global unsigned char *ext_mem_77877, __global unsigned char *mem_77881)\n{\n    #define segmap_tblock_sizze_75887 (inner_SMJ_doublezisegmap_75891zisegmap_tblock_sizze_75887)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79036;\n    int32_t tblock_sizze_79039;\n    int32_t wave_sizze_79038;\n    int32_t block_id_79037;\n    int32_t global_tid_79035;\n    int64_t phys_tid_75891;\n    int64_t global_tid_79040;\n    int64_t slice_79041;\n    int64_t gtid_75890;\n    int64_t remnant_79042;\n    \n    local_tid_79036 = get_local_id(0);\n    tblock_sizze_79039 = get_local_size(0);\n    wave_sizze_79038 = LOCKSTEP_WIDTH;\n    block_id_79037 = get_tblock_id(0);\n    global_tid_79035 = block_id_79037 * tblock_sizze_79039 + local_tid_79036;\n    phys_tid_75891 = sext_i32_i64(global_tid_79035);\n    global_tid_79040 = sext_i32_i64(block_id_79037) * segmap_tblock_sizze_75887 + sext_i32_i64(local_tid_79036);\n    slice_79041 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_75890 = global_tid_79040;\n    remnant_79042 = global_tid_79040 - gtid_75890;\n    if (slt64(gtid_75890, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76049;\n        int64_t eta_p_75892;\n        bool cond_75894;\n        int64_t lifted_lambda_res_75895;\n        \n        slice_76049 = loopres_f_res_f_res_67593 + gtid_75890;\n        eta_p_75892 = ((__global int64_t *) mem_param_77688)[ctx_param_ext_77686 + slice_76049 * ctx_param_ext_77687];\n        cond_75894 = slt64(eta_p_75892, (int64_t) 0);\n        if (cond_75894) {\n            int64_t eta_p_75893 = ((__global int64_t *) ext_mem_77877)[gtid_75890];\n            \n            lifted_lambda_res_75895 = eta_p_75893;\n        } else {\n            lifted_lambda_res_75895 = eta_p_75892;\n        }\n        ((__global int64_t *) mem_77881)[gtid_75890] = lifted_lambda_res_75895;\n    }\n    \n  error_0:\n    return", ";\n    #undef segmap_tblock_sizze_75887\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75912_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75912(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77683, int64_t ctx_param_ext_77684, __global unsigned char *mem_param_77685, __global unsigned char *ext_mem_77878, __global unsigned char *mem_77884)\n{\n    #define segmap_tblock_sizze_75908 (inner_SMJ_doublezisegmap_75912zisegmap_tblock_sizze_75908)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79045;\n    int32_t tblock_sizze_79048;\n    int32_t wave_sizze_79047;\n    int32_t block_id_79046;\n    int32_t global_tid_79044;\n    int64_t phys_tid_75912;\n    int64_t global_tid_79049;\n    int64_t slice_79050;\n    int64_t gtid_75911;\n    int64_t remnant_79051;\n    \n    local_tid_79045 = get_local_id(0);\n    tblock_sizze_79048 = get_local_size(0);\n    wave_sizze_79047 = LOCKSTEP_WIDTH;\n    block_id_79046 = get_tblock_id(0);\n    global_tid_79044 = block_id_79046 * tblock_sizze_79048 + local_tid_79045;\n    phys_tid_75912 = sext_i32_i64(global_tid_79044);\n    global_tid_79049 = sext_i32_i64(block_id_79046) * segmap_tblock_sizze_75908 + sext_i32_i64(local_tid_79045);\n    slice_79050 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_75911 = global_tid_79049;\n    remnant_79051 = global_tid_79049 - gtid_75911;\n    if (slt64(gtid_75911, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76048;\n        int64_t eta_p_75913;\n        int64_t eta_p_75914;\n        int64_t defunc_0_f_res_75915;\n        \n        slice_76048 = loopres_f_res_f_res_67593 + gtid_75911;\n        eta_p_75913 = ((__global int64_t *) mem_param_77685)[ctx_param_ext_77683 + slice_76048 * ctx_param_ext_77684];\n        eta_p_75914 = ((__global int64_t *) ext_mem_77878)[gtid_75911];\n        defunc_0_f_res_75915 = add64(eta_p_75913, eta_p_75914);\n        ((__global int64_t *) mem_77884)[gti",
                                    "d_75911] = defunc_0_f_res_75915;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75908\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75933_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75933(__global int *global_failure, int64_t nR_59382, int64_t ext_78072, int64_t ext_78073, __global unsigned char *mem_param_77640, __global unsigned char *ext_mem_78074, __global unsigned char *mem_78080)\n{\n    #define segmap_tblock_sizze_75929 (inner_SMJ_doublezisegmap_75933zisegmap_tblock_sizze_75929)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79054;\n    int32_t tblock_sizze_79057;\n    int32_t wave_sizze_79056;\n    int32_t block_id_79055;\n    int32_t global_tid_79053;\n    int64_t phys_tid_75933;\n    int64_t global_tid_79058;\n    int64_t slice_79059;\n    int64_t gtid_75932;\n    int64_t remnant_79060;\n    \n    local_tid_79054 = get_local_id(0);\n    tblock_sizze_79057 = get_local_size(0);\n    wave_sizze_79056 = LOCKSTEP_WIDTH;\n    block_id_79055 = get_tblock_id(0);\n    global_tid_79053 = block_id_79055 * tblock_sizze_79057 + local_tid_79054;\n    phys_tid_75933 = sext_i32_i64(global_tid_79053);\n    global_tid_79058 = sext_i32_i64(block_id_79055) * segmap_tblock_sizze_75929 + sext_i32_i64(local_tid_79054);\n    slice_79059 = nR_59382;\n    gtid_75932 = global_tid_79058;\n    remnant_79060 = global_tid_79058 - gtid_75932;\n    if (slt64(gtid_75932, nR_59382)) {\n        int64_t eta_p_75934;\n        bool cond_75936;\n        int64_t lifted_lambda_res_75937;\n        \n        eta_p_75934 = ((__global int64_t *) mem_param_77640)[gtid_75932];\n        cond_75936 = slt64(eta_p_75934, (int64_t) 0);\n        if (cond_75936) {\n            int64_t eta_p_75935 = ((__global int64_t *) ext_mem_78074)[ext_78073 + gtid_75932 * ext_78072];\n            \n            lifted_lambda_res_75937 = eta_p_75935;\n        } else {\n            lifted_lambda_res_75937 = eta_p_75934;\n        }\n        ((__global int64_t *) mem_78080)[gtid_75932] = lifted_lambda_res_75937;\n    }\n  ", "  \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75929\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75954_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75954(__global int *global_failure, int64_t nR_59382, int64_t ext_78075, int64_t ext_78076, __global unsigned char *mem_param_77637, __global unsigned char *ext_mem_78077, __global unsigned char *mem_78083)\n{\n    #define segmap_tblock_sizze_75950 (inner_SMJ_doublezisegmap_75954zisegmap_tblock_sizze_75950)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79063;\n    int32_t tblock_sizze_79066;\n    int32_t wave_sizze_79065;\n    int32_t block_id_79064;\n    int32_t global_tid_79062;\n    int64_t phys_tid_75954;\n    int64_t global_tid_79067;\n    int64_t slice_79068;\n    int64_t gtid_75953;\n    int64_t remnant_79069;\n    \n    local_tid_79063 = get_local_id(0);\n    tblock_sizze_79066 = get_local_size(0);\n    wave_sizze_79065 = LOCKSTEP_WIDTH;\n    block_id_79064 = get_tblock_id(0);\n    global_tid_79062 = block_id_79064 * tblock_sizze_79066 + local_tid_79063;\n    phys_tid_75954 = sext_i32_i64(global_tid_79062);\n    global_tid_79067 = sext_i32_i64(block_id_79064) * segmap_tblock_sizze_75950 + sext_i32_i64(local_tid_79063);\n    slice_79068 = nR_59382;\n    gtid_75953 = global_tid_79067;\n    remnant_79069 = global_tid_79067 - gtid_75953;\n    if (slt64(gtid_75953, nR_59382)) {\n        int64_t eta_p_75955;\n        int64_t eta_p_75956;\n        int64_t defunc_0_f_res_75957;\n        \n        eta_p_75955 = ((__global int64_t *) mem_param_77637)[gtid_75953];\n        eta_p_75956 = ((__global int64_t *) ext_mem_78077)[ext_78076 + gtid_75953 * ext_78075];\n        defunc_0_f_res_75957 = add64(eta_p_75955, eta_p_75956);\n        ((__global int64_t *) mem_78083)[gtid_75953] = defunc_0_f_res_75957;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75950\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_75967_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_75967(__global int *global_failure, int64_t nR_59382, ", "int64_t m_67844, int64_t num_tblocks_75972, int32_t virt_num_tblocks_79220, __global unsigned char *tR_mem_77625, __global unsigned char *ext_mem_77627, __global unsigned char *ext_mem_78095, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *mem_78103, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109)\n{\n    #define segmap_tblock_sizze_75970 (inner_SMJ_doublezisegmap_75967zisegmap_tblock_sizze_75970)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79222;\n    int32_t tblock_sizze_79225;\n    int32_t wave_sizze_79224;\n    int32_t block_id_79223;\n    int32_t global_tid_79221;\n    int64_t phys_tid_75967;\n    int32_t phys_tblock_id_79226;\n    int32_t iterations_79227;\n    \n    local_tid_79222 = get_local_id(0);\n    tblock_sizze_79225 = get_local_size(0);\n    wave_sizze_79224 = LOCKSTEP_WIDTH;\n    block_id_79223 = get_tblock_id(0);\n    global_tid_79221 = block_id_79223 * tblock_sizze_79225 + local_tid_79222;\n    phys_tid_75967 = sext_i32_i64(global_tid_79221);\n    phys_tblock_id_79226 = get_tblock_id(0);\n    iterations_79227 = sdiv_up32(virt_num_tblocks_79220 - phys_tblock_id_79226, sext_i64_i32(num_tblocks_75972));\n    for (int32_t i_79228 = 0; i_79228 < iterations_79227; i_79228++) {\n        int32_t virt_tblock_id_79229;\n        int64_t global_tid_79230;\n        int64_t slice_79231;\n        int64_t write_i_75966;\n        int64_t remnant_79232;\n        \n        virt_tblock_id_79229 = phys_tblock_id_79226 + i_79228 * sext_i64_i32(num_tblocks_75972);\n        global_tid_79230 = sext_i32_i64(virt_tblock_id_79229) * segmap_tblock_sizze_75970 + sext_i32_i64(local_tid_79222);\n        slice_79231 = nR_59382;\n        write_i_75966 = global_tid_79230;\n        remnant_79232 = global_tid_79230 - write_i_75966;\n        if (slt64(write_i_75966, nR_59382)) {\n            int64_t eta_p_68109;\n            double write_value_68111;",
                                    "\n            int64_t write_value_68112;\n            int64_t write_value_68113;\n            int64_t write_value_68114;\n            bool cond_68115;\n            int64_t lifted_lambda_res_68116;\n            \n            eta_p_68109 = ((__global int64_t *) mem_78101)[write_i_75966];\n            write_value_68111 = ((__global double *) tR_mem_77625)[write_i_75966];\n            write_value_68112 = ((__global int64_t *) ext_mem_77627)[write_i_75966];\n            write_value_68113 = ((__global int64_t *) ext_mem_78095)[write_i_75966];\n            write_value_68114 = ((__global int64_t *) ext_mem_78096)[write_i_75966];\n            cond_68115 = eta_p_68109 == (int64_t) 1;\n            if (cond_68115) {\n                int64_t eta_p_68110;\n                int64_t lifted_lambda_res_t_res_68890;\n                \n                eta_p_68110 = ((__global int64_t *) mem_78099)[write_i_75966];\n                lifted_lambda_res_t_res_68890 = sub64(eta_p_68110, (int64_t) 1);\n                lifted_lambda_res_68116 = lifted_lambda_res_t_res_68890;\n            } else {\n                lifted_lambda_res_68116 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global double *) mem_78109)[lifted_lambda_res_68116] = write_value_68111;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78107)[lifted_lambda_res_68116] = write_value_68112;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78105)[lifted_lambda_res_68116] = write_value_68113;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78103)[lifted_lambda_res_68116] = write_value_68114;\n            }\n       ", " }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75970\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_76001_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_76001(__global int *global_failure, int64_t m_67844, __global unsigned char *mem_78113, __global unsigned char *mem_78120)\n{\n    #define segmap_tblock_sizze_75997 (inner_SMJ_doublezisegmap_76001zisegmap_tblock_sizze_75997)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79388;\n    int32_t tblock_sizze_79391;\n    int32_t wave_sizze_79390;\n    int32_t block_id_79389;\n    int32_t global_tid_79387;\n    int64_t phys_tid_76001;\n    int64_t global_tid_79392;\n    int64_t slice_79393;\n    int64_t gtid_76000;\n    int64_t remnant_79394;\n    \n    local_tid_79388 = get_local_id(0);\n    tblock_sizze_79391 = get_local_size(0);\n    wave_sizze_79390 = LOCKSTEP_WIDTH;\n    block_id_79389 = get_tblock_id(0);\n    global_tid_79387 = block_id_79389 * tblock_sizze_79391 + local_tid_79388;\n    phys_tid_76001 = sext_i32_i64(global_tid_79387);\n    global_tid_79392 = sext_i32_i64(block_id_79389) * segmap_tblock_sizze_75997 + sext_i32_i64(local_tid_79388);\n    slice_79393 = m_67844;\n    gtid_76000 = global_tid_79392;\n    remnant_79394 = global_tid_79392 - gtid_76000;\n    if (slt64(gtid_76000, m_67844)) {\n        int64_t zv_lhs_76003;\n        int64_t tmp_76004;\n        bool cond_76006;\n        int64_t lifted_lambda_res_76007;\n        \n        zv_lhs_76003 = add64((int64_t) -1, gtid_76000);\n        tmp_76004 = smod64(zv_lhs_76003, m_67844);\n        cond_76006 = gtid_76000 == (int64_t) 0;\n        if (cond_76006) {\n            lifted_lambda_res_76007 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_76005 = ((__global int64_t *) mem_78113)[tmp_76004];\n            \n            lifted_lambda_res_76007 = lifted_lambda_res_76005;\n        }\n        ((__global int64_t *) mem_78120)[gtid_76000] = lifted_lambda_res_76007;\n    }\n    \n  ", "error_0:\n    return;\n    #undef segmap_tblock_sizze_75997\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_76009_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_76009(__global int *global_failure, int64_t m_67844, int64_t lower_bound_67927, int64_t min_res_67929, int64_t j_m_i_67930, int64_t num_tblocks_76014, int32_t virt_num_tblocks_79433, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109, __global unsigned char *mem_78120, __global unsigned char *mem_78149, __global unsigned char *mem_78151, __global unsigned char *mem_78153)\n{\n    #define segmap_tblock_sizze_76012 (inner_SMJ_doublezisegmap_76009zisegmap_tblock_sizze_76012)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79435;\n    int32_t tblock_sizze_79438;\n    int32_t wave_sizze_79437;\n    int32_t block_id_79436;\n    int32_t global_tid_79434;\n    int64_t phys_tid_76009;\n    int32_t phys_tblock_id_79439;\n    int32_t iterations_79440;\n    \n    local_tid_79435 = get_local_id(0);\n    tblock_sizze_79438 = get_local_size(0);\n    wave_sizze_79437 = LOCKSTEP_WIDTH;\n    block_id_79436 = get_tblock_id(0);\n    global_tid_79434 = block_id_79436 * tblock_sizze_79438 + local_tid_79435;\n    phys_tid_76009 = sext_i32_i64(global_tid_79434);\n    phys_tblock_id_79439 = get_tblock_id(0);\n    iterations_79440 = sdiv_up32(virt_num_tblocks_79433 - phys_tblock_id_79439, sext_i64_i32(num_tblocks_76014));\n    for (int32_t i_79441 = 0; i_79441 < iterations_79440; i_79441++) {\n        int32_t virt_tblock_id_79442;\n        int64_t global_tid_79443;\n        int64_t slice_79444;\n        int64_t write_i_76008;\n        int64_t remnant_79445;\n        \n        virt_tblock_id_79442 = phys_tblock_id_79439 + i_79441 * sext_i64_i32(num_tblocks_76014);\n        global_tid_79443 = sext_i32_i64(virt_tblock_id_79442) * segmap_tblock_sizze_76012 + sext_i32_i64(local_tid_79435);\n        slice_79444 = m_67844;\n        write_i_76008 = global_tid_79443;\n        remnant_79445 = global_tid",
                                    "_79443 - write_i_76008;\n        if (slt64(write_i_76008, m_67844)) {\n            int64_t eta_p_68502;\n            double write_value_68503;\n            int64_t write_value_68504;\n            int64_t write_value_68505;\n            bool cond_68506;\n            bool cond_t_res_68507;\n            bool x_68508;\n            int64_t lifted_lambda_res_68509;\n            \n            eta_p_68502 = ((__global int64_t *) mem_78120)[write_i_76008];\n            write_value_68503 = ((__global double *) mem_78109)[write_i_76008];\n            write_value_68504 = ((__global int64_t *) mem_78107)[write_i_76008];\n            write_value_68505 = ((__global int64_t *) mem_78105)[write_i_76008];\n            cond_68506 = sle64(lower_bound_67927, eta_p_68502);\n            cond_t_res_68507 = slt64(eta_p_68502, min_res_67929);\n            x_68508 = cond_68506 && cond_t_res_68507;\n            if (x_68508) {\n                int64_t lifted_lambda_res_t_res_68893 = sub64(eta_p_68502, lower_bound_67927);\n                \n                lifted_lambda_res_68509 = lifted_lambda_res_t_res_68893;\n            } else {\n                lifted_lambda_res_68509 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global double *) mem_78149)[lifted_lambda_res_68509] = write_value_68503;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78151)[lifted_lambda_res_68509] = write_value_68504;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78153)[lifted_lambda_res_68509] = write_value_68505;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_76012\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ", "_doublezisegmap_76017_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_76017(__global int *global_failure, int64_t m_67844, int64_t m_67984, int64_t num_tblocks_76022, int32_t virt_num_tblocks_79415, __global unsigned char *mem_78103, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *mem_78120, __global unsigned char *mem_78128, __global unsigned char *mem_78130)\n{\n    #define segmap_tblock_sizze_76020 (inner_SMJ_doublezisegmap_76017zisegmap_tblock_sizze_76020)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79417;\n    int32_t tblock_sizze_79420;\n    int32_t wave_sizze_79419;\n    int32_t block_id_79418;\n    int32_t global_tid_79416;\n    int64_t phys_tid_76017;\n    int32_t phys_tblock_id_79421;\n    int32_t iterations_79422;\n    \n    local_tid_79417 = get_local_id(0);\n    tblock_sizze_79420 = get_local_size(0);\n    wave_sizze_79419 = LOCKSTEP_WIDTH;\n    block_id_79418 = get_tblock_id(0);\n    global_tid_79416 = block_id_79418 * tblock_sizze_79420 + local_tid_79417;\n    phys_tid_76017 = sext_i32_i64(global_tid_79416);\n    phys_tblock_id_79421 = get_tblock_id(0);\n    iterations_79422 = sdiv_up32(virt_num_tblocks_79415 - phys_tblock_id_79421, sext_i64_i32(num_tblocks_76022));\n    for (int32_t i_79423 = 0; i_79423 < iterations_79422; i_79423++) {\n        int32_t virt_tblock_id_79424;\n        int64_t global_tid_79425;\n        int64_t slice_79426;\n        int64_t write_i_76016;\n        int64_t remnant_79427;\n        \n        virt_tblock_id_79424 = phys_tblock_id_79421 + i_79423 * sext_i64_i32(num_tblocks_76022);\n        global_tid_79425 = sext_i32_i64(virt_tblock_id_79424) * segmap_tblock_sizze_76020 + sext_i32_i64(local_tid_79417);\n        slice_79426 = m_67844;\n        write_i_76016 = global_tid_79425;\n        remnant_79427 = global_tid_79425 - write_i_76016;\n        if (slt64(write_i_76016, m_67844)) {\n            int64_t eta_p_68086;\n            int64_t write_value_68088;\n            int64_t write_value_68089;", "\n            bool cond_68090;\n            int64_t lifted_lambda_res_68091;\n            \n            eta_p_68086 = ((__global int64_t *) mem_78117)[write_i_76016];\n            write_value_68088 = ((__global int64_t *) mem_78120)[write_i_76016];\n            write_value_68089 = ((__global int64_t *) mem_78103)[write_i_76016];\n            cond_68090 = eta_p_68086 == (int64_t) 1;\n            if (cond_68090) {\n                int64_t eta_p_68087;\n                int64_t lifted_lambda_res_t_res_68898;\n                \n                eta_p_68087 = ((__global int64_t *) mem_78115)[write_i_76016];\n                lifted_lambda_res_t_res_68898 = sub64(eta_p_68087, (int64_t) 1);\n                lifted_lambda_res_68091 = lifted_lambda_res_t_res_68898;\n            } else {\n                lifted_lambda_res_68091 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78130)[lifted_lambda_res_68091] = write_value_68088;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78128)[lifted_lambda_res_68091] = write_value_68089;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_76020\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_76039_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_76039(__global int *global_failure, int64_t loopres_68028, int64_t loopres_68029, __global unsigned char *mem_78178, __global unsigned char *mem_78181)\n{\n    #define segmap_tblock_sizze_76035 (inner_SMJ_doublezisegmap_76039zisegmap_tblock_sizze_76035)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79502;\n    int32_t tblock_sizze_79505;\n    int32_t wave_sizze_79504;\n    int32_t block_id_79503;\n    int32_t global_tid_79501;\n    int64_t phys_tid_76039;\n    int64_t",
                                    " global_tid_79506;\n    int64_t slice_79507;\n    int64_t gtid_76038;\n    int64_t remnant_79508;\n    \n    local_tid_79502 = get_local_id(0);\n    tblock_sizze_79505 = get_local_size(0);\n    wave_sizze_79504 = LOCKSTEP_WIDTH;\n    block_id_79503 = get_tblock_id(0);\n    global_tid_79501 = block_id_79503 * tblock_sizze_79505 + local_tid_79502;\n    phys_tid_76039 = sext_i32_i64(global_tid_79501);\n    global_tid_79506 = sext_i32_i64(block_id_79503) * segmap_tblock_sizze_76035 + sext_i32_i64(local_tid_79502);\n    slice_79507 = loopres_68029;\n    gtid_76038 = global_tid_79506;\n    remnant_79508 = global_tid_79506 - gtid_76038;\n    if (slt64(gtid_76038, loopres_68029)) {\n        int64_t loopres_77620;\n        int64_t tmp_76041;\n        \n        loopres_77620 = ((__global int64_t *) mem_78181)[(int64_t) 0];\n        tmp_76041 = add64(gtid_76038, loopres_77620);\n        ((__global int64_t *) mem_78178)[loopres_68028 + gtid_76038] = tmp_76041;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_76035\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_76057_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_76057(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76060, int64_t num_whole_tiles_76075, int64_t residual_input_76299, unsigned char cond_76300_bits, int64_t binop_x_76316, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_78045, __global unsigned char *mem_78047)\n{\n    bool cond_76300 = cond_76300_bits;\n    \n    #define tile_sizze_76059 (inner_SMJ_doublezisegmap_intrablock_76057zitile_sizze_76059)\n    #define bytes_78007 (inner_SMJ_doublezisegmap_intrablock_76057zibytes_78007)\n    \n    volatile __local unsigned char *color_78690_backing_2 = &shared_mem[0];\n    const int64_t color_78690_backing_2_offset = 0 + (bytes_78007 + srem64((int64_t) 8 - ", "srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78689_backing_1 = &shared_mem[color_78690_backing_2_offset];\n    const int64_t color_78689_backing_1_offset = color_78690_backing_2_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78688_backing_0 = &shared_mem[color_78689_backing_1_offset];\n    const int64_t color_78688_backing_0_offset = color_78689_backing_1_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78799;\n    int32_t tblock_sizze_78802;\n    int32_t wave_sizze_78801;\n    int32_t block_id_78800;\n    int32_t global_tid_78798;\n    int64_t gid_flat_76057;\n    int64_t slice_78804;\n    int64_t ltid_pre_78803;\n    int64_t remnant_78805;\n    int64_t slice_78806;\n    int64_t gid_76056;\n    int64_t remnant_78807;\n    __local unsigned char *color_78688;\n    __local unsigned char *color_78689;\n    __local unsigned char *color_78690;\n    int64_t binop_x_76067;\n    double mem_77991[1];\n    int64_t ltid_flat_76062;\n    int64_t ltid_76061;\n    int64_t gtid_76068;\n    bool cond_76069;\n    double pre_76070;\n    int64_t mem_77995[1];\n    double mem_77999[1];\n    int64_t mem_78003[1];\n    int64_t ltid_flat_76077;\n    int64_t ltid_76076;\n    int64_t gtid_76087;\n    bool cond_76088;\n    int64_t neutral_76089;\n    double neutral_76090;\n    int64_t ext_mem_78027[1];\n    double ext_mem_78026[1];\n    int64_t ext_mem_78025[1];\n    int64_t mem_param_78004[1];\n    double mem_param_78005[1];\n    int64_t mem_param_78006[1];\n    int64_t mem_78037[1];\n    int64_t mem_78041[1];\n    int64_t ext_mem_78043[1];\n    int64_t ext_mem_78042[1];\n    \n    local_tid_78799 = get_local_id(0);\n    tblock_sizze_78802 = get_local_size(0);\n    wave_sizze_78801 = LOCKSTEP_WIDTH;\n    block_id_78800 = get_tblock_id(0);\n    global_tid_78798 = block_id_78800 * tbloc", "k_sizze_78802 + local_tid_78799;\n    gid_flat_76057 = sext_i32_i64(block_id_78800);\n    slice_78804 = tile_sizze_76059;\n    ltid_pre_78803 = sext_i32_i64(local_tid_78799);\n    remnant_78805 = sext_i32_i64(local_tid_78799) - ltid_pre_78803;\n    slice_78806 = ldim_76060;\n    gid_76056 = sext_i32_i64(block_id_78800);\n    remnant_78807 = sext_i32_i64(block_id_78800) - gid_76056;\n    color_78688 = (__local unsigned char *) color_78688_backing_0;\n    color_78689 = (__local unsigned char *) color_78689_backing_1;\n    color_78690 = (__local unsigned char *) color_78690_backing_2;\n    binop_x_76067 = gid_76056 * tile_sizze_76059;\n    ltid_flat_76062 = sext_i32_i64(local_tid_78799);\n    ltid_76061 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76068 = ltid_76061 + binop_x_76067;\n    cond_76069 = slt64(gtid_76068, min_res_68560);\n    if (cond_76069) {\n        int64_t slice_76071;\n        double eta_p_76072;\n        \n        slice_76071 = start_68558 + gtid_76068;\n        eta_p_76072 = ((__global double *) tR_mem_77625)[slice_76071];\n        pre_76070 = eta_p_76072;\n    } else {\n        pre_76070 = 0.0;\n    }\n    mem_77991[(int64_t) 0] = pre_76070;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76077 = sext_i32_i64(local_tid_78799);\n    ltid_76076 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76087 = binop_x_76067 + ltid_76076;\n    cond_76088 = slt64(gtid_76087, min_res_68560);\n    if (cond_76088) {\n        neutral_76089 = (int64_t) -1;\n    } else {\n        neutral_76089 = (int64_t) 0;\n    }\n    if (cond_76088) {\n        double eta_p_76092 = mem_77991[(int64_t) 0];\n        \n        neutral_76090 = eta_p_76092;\n    } else {\n        neutral_76090 = 0.0;\n    }\n    mem_77995[(int64_t) 0] = neutral_76089;\n    mem_77999[(int64_t) 0] = neutral_76090;\n    mem_78003[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_78004[i_3] = mem_77995[i_3];\n    for (int32_t i_4 ",
                                    "= 0; i_4 < 1; i_4++)\n        mem_param_78005[i_4] = mem_77999[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_78006[i_5] = mem_78003[i_5];\n    for (int64_t tile_id_76102 = 0; tile_id_76102 < num_whole_tiles_76075; tile_id_76102++) {\n        int64_t binop_x_76201;\n        int64_t ltid_flat_76200;\n        int64_t ltid_76199;\n        int64_t j_76202;\n        bool cond_76206;\n        int64_t pre1d_76209;\n        int64_t pre1d_76207;\n        double pre1d_76208;\n        int64_t mem_78016[1];\n        double mem_78020[1];\n        int64_t mem_78024[1];\n        int64_t ltid_flat_76220;\n        int64_t ltid_76219;\n        int64_t gtid_76222;\n        int64_t acc_76224;\n        double acc_76225;\n        int64_t acc_76226;\n        bool cond_76227;\n        int64_t acc_76228;\n        double acc_76229;\n        int64_t acc_76230;\n        int64_t mem_param_tmp_78808[1];\n        double mem_param_tmp_78809[1];\n        int64_t mem_param_tmp_78810[1];\n        \n        binop_x_76201 = tile_sizze_76059 * tile_id_76102;\n        ltid_flat_76200 = sext_i32_i64(local_tid_78799);\n        ltid_76199 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76202 = ltid_76199 + binop_x_76201;\n        cond_76206 = slt64(j_76202, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76209 = btoi_bool_i64(cond_76206);\n        if (cond_76206) {\n            int64_t tile_elem_76210;\n            int64_t slice_77479;\n            double tile_elem_76211;\n            \n            tile_elem_76210 = ((__global int64_t *) ext_mem_77925)[j_76202];\n            slice_77479 = tS_start_66998 + j_76202;\n            tile_elem_76211 = ((__global double *) tS_mem_77626)[slice_77479];\n            pre1d_76207 = tile_elem_76210;\n            pre1d_76208 = tile_elem_76211;\n        } else {\n            pre1d_76207 = (int64_t) 0;\n            pre1d_76208 = 0.0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76199] = pre1d_76207;\n        ((__local double *) color_78689)[ltid_76199] = pre1d_762", "08;\n        ((__local int64_t *) color_78688)[ltid_76199] = pre1d_76209;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76220 = sext_i32_i64(local_tid_78799);\n        ltid_76219 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76222 = binop_x_76067 + ltid_76219;\n        acc_76224 = mem_param_78004[(int64_t) 0];\n        acc_76225 = mem_param_78005[(int64_t) 0];\n        acc_76226 = mem_param_78006[(int64_t) 0];\n        cond_76227 = slt64(gtid_76222, min_res_68560);\n        if (cond_76227) {\n            double eta_p_76223;\n            int64_t x_76231;\n            double x_76232;\n            int64_t x_76233;\n            int64_t redout_77492;\n            double redout_77493;\n            int64_t redout_77494;\n            \n            eta_p_76223 = mem_77991[(int64_t) 0];\n            redout_77492 = acc_76224;\n            redout_77493 = acc_76225;\n            redout_77494 = acc_76226;\n            for (int64_t i_77495 = 0; i_77495 < tile_sizze_76059; i_77495++) {\n                int64_t x_76234;\n                double x_76235;\n                bool defunc_0_neq_res_76243;\n                bool defunc_0_neq_res_76244;\n                bool cond_f_res_76245;\n                bool y_76246;\n                bool cond_76247;\n                bool defunc_0_neq_res_76248;\n                bool defunc_0_neq_res_76249;\n                bool cond_t_res_f_res_76250;\n                bool y_76251;\n                bool cond_t_res_76252;\n                bool x_76253;\n                int64_t defunc_0_op_res_76254;\n                double defunc_0_op_res_76255;\n                int64_t defunc_0_op_res_76256;\n                int64_t redout_tmp_78814;\n                double redout_tmp_78815;\n                int64_t redout_tmp_78816;\n                \n                x_76234 = ((__local int64_t *) color_78690)[i_77495];\n                x_76235 = ((__local double *) color_78689)[i_77495];\n                defunc_0_neq_res_76243 = redout_77493 == eta_p_76223;\n                defunc_0_neq_r", "es_76244 = !defunc_0_neq_res_76243;\n                cond_f_res_76245 = slt64(redout_77492, (int64_t) 0);\n                y_76246 = defunc_0_neq_res_76243 && cond_f_res_76245;\n                cond_76247 = defunc_0_neq_res_76244 || y_76246;\n                defunc_0_neq_res_76248 = x_76235 == eta_p_76223;\n                defunc_0_neq_res_76249 = !defunc_0_neq_res_76248;\n                cond_t_res_f_res_76250 = slt64(x_76234, (int64_t) 0);\n                y_76251 = defunc_0_neq_res_76248 && cond_t_res_f_res_76250;\n                cond_t_res_76252 = defunc_0_neq_res_76249 || y_76251;\n                x_76253 = cond_76247 && cond_t_res_76252;\n                if (x_76253) {\n                    defunc_0_op_res_76254 = (int64_t) -1;\n                    defunc_0_op_res_76255 = eta_p_76223;\n                    defunc_0_op_res_76256 = (int64_t) 0;\n                } else {\n                    int64_t x_76236;\n                    int64_t defunc_0_op_res_f_res_76257;\n                    double defunc_0_op_res_f_res_76258;\n                    int64_t defunc_0_op_res_f_res_76259;\n                    \n                    x_76236 = ((__local int64_t *) color_78688)[i_77495];\n                    if (cond_76247) {\n                        defunc_0_op_res_f_res_76257 = x_76234;\n                        defunc_0_op_res_f_res_76258 = x_76235;\n                        defunc_0_op_res_f_res_76259 = x_76236;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_76260;\n                        int64_t defunc_0_op_res_f_res_f_res_76261;\n                        int64_t defunc_0_op_res_f_res_f_res_76262;\n                        \n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76260 = redout_77493;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76260 = eta_p_76223;\n                        }\n                        if (cond_t_res_76252) {\n                            defunc_",
                                    "0_op_res_f_res_f_res_76261 = redout_77492;\n                            defunc_0_op_res_f_res_f_res_76262 = redout_77494;\n                        } else {\n                            int64_t min_res_76263;\n                            int64_t tmp_76264;\n                            \n                            min_res_76263 = smin64(x_76234, redout_77492);\n                            tmp_76264 = add64(x_76236, redout_77494);\n                            defunc_0_op_res_f_res_f_res_76261 = min_res_76263;\n                            defunc_0_op_res_f_res_f_res_76262 = tmp_76264;\n                        }\n                        defunc_0_op_res_f_res_76257 = defunc_0_op_res_f_res_f_res_76261;\n                        defunc_0_op_res_f_res_76258 = defunc_0_op_res_f_res_f_res_76260;\n                        defunc_0_op_res_f_res_76259 = defunc_0_op_res_f_res_f_res_76262;\n                    }\n                    defunc_0_op_res_76254 = defunc_0_op_res_f_res_76257;\n                    defunc_0_op_res_76255 = defunc_0_op_res_f_res_76258;\n                    defunc_0_op_res_76256 = defunc_0_op_res_f_res_76259;\n                }\n                redout_tmp_78814 = defunc_0_op_res_76254;\n                redout_tmp_78815 = defunc_0_op_res_76255;\n                redout_tmp_78816 = defunc_0_op_res_76256;\n                redout_77492 = redout_tmp_78814;\n                redout_77493 = redout_tmp_78815;\n                redout_77494 = redout_tmp_78816;\n            }\n            x_76231 = redout_77492;\n            x_76232 = redout_77493;\n            x_76233 = redout_77494;\n            acc_76228 = x_76231;\n            acc_76229 = x_76232;\n            acc_76230 = x_76233;\n        } else {\n            acc_76228 = acc_76224;\n            acc_76229 = acc_76225;\n            acc_76230 = acc_76226;\n        }\n        mem_78016[(int64_t) 0] = acc_76228;\n        mem_78020[(int64_t) 0] = acc_76229;\n        mem_78024[(int64_t) 0] = acc_76230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6", " = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78808[i_6] = mem_78016[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78809[i_7] = mem_78020[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78810[i_8] = mem_78024[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_78004[i_9] = mem_param_tmp_78808[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_78005[i_10] = mem_param_tmp_78809[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_78006[i_11] = mem_param_tmp_78810[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_78027[i_12] = mem_param_78004[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_78026[i_13] = mem_param_78005[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_78025[i_14] = mem_param_78006[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76300) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_78043[i_15] = ext_mem_78027[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_78042[i_16] = ext_mem_78025[i_16];\n    } else {\n        int64_t ltid_flat_76302;\n        int64_t ltid_76301;\n        int64_t j_76317;\n        bool cond_76321;\n        int64_t pre1d_76324;\n        int64_t pre1d_76322;\n        double pre1d_76323;\n        int64_t ltid_flat_76338;\n        int64_t ltid_76337;\n        int64_t gtid_76351;\n        int64_t acc_76353;\n        int64_t acc_76355;\n        bool cond_76356;\n        int64_t acc_76357;\n        int64_t acc_76359;\n        \n        ltid_flat_76302 = sext_i32_i64(local_tid_78799);\n        ltid_76301 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76317 = ltid_76301 + binop_x_76316;\n        cond_76321 = slt64(j_76317, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76324 = btoi_bool_i64(cond_76321);\n        if (cond_76321) {\n            int64_t tile_elem_76325;\n            int64_t", " slice_77478;\n            double tile_elem_76326;\n            \n            tile_elem_76325 = ((__global int64_t *) ext_mem_77925)[j_76317];\n            slice_77478 = tS_start_66998 + j_76317;\n            tile_elem_76326 = ((__global double *) tS_mem_77626)[slice_77478];\n            pre1d_76322 = tile_elem_76325;\n            pre1d_76323 = tile_elem_76326;\n        } else {\n            pre1d_76322 = (int64_t) 0;\n            pre1d_76323 = 0.0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76301] = pre1d_76322;\n        ((__local double *) color_78689)[ltid_76301] = pre1d_76323;\n        ((__local int64_t *) color_78688)[ltid_76301] = pre1d_76324;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76338 = sext_i32_i64(local_tid_78799);\n        ltid_76337 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76351 = binop_x_76067 + ltid_76337;\n        acc_76353 = ext_mem_78027[(int64_t) 0];\n        acc_76355 = ext_mem_78025[(int64_t) 0];\n        cond_76356 = slt64(gtid_76351, min_res_68560);\n        if (cond_76356) {\n            double eta_p_76352;\n            double acc_76354;\n            int64_t x_76360;\n            double x_76361;\n            int64_t x_76362;\n            int64_t redout_77496;\n            double redout_77497;\n            int64_t redout_77498;\n            \n            eta_p_76352 = mem_77991[(int64_t) 0];\n            acc_76354 = ext_mem_78026[(int64_t) 0];\n            redout_77496 = acc_76353;\n            redout_77497 = acc_76354;\n            redout_77498 = acc_76355;\n            for (int64_t i_77499 = 0; i_77499 < residual_input_76299; i_77499++) {\n                int64_t x_76363;\n                double x_76364;\n                bool defunc_0_neq_res_76372;\n                bool defunc_0_neq_res_76373;\n                bool cond_f_res_76374;\n                bool y_76375;\n                bool cond_76376;\n                bool defunc_0_neq_res_76377;\n                bool defunc_0_neq_res_76378;\n                bool cond_t_res_f_res_76379;\n ",
                                    "               bool y_76380;\n                bool cond_t_res_76381;\n                bool x_76382;\n                int64_t defunc_0_op_res_76383;\n                double defunc_0_op_res_76384;\n                int64_t defunc_0_op_res_76385;\n                int64_t redout_tmp_78817;\n                double redout_tmp_78818;\n                int64_t redout_tmp_78819;\n                \n                x_76363 = ((__local int64_t *) color_78690)[i_77499];\n                x_76364 = ((__local double *) color_78689)[i_77499];\n                defunc_0_neq_res_76372 = redout_77497 == eta_p_76352;\n                defunc_0_neq_res_76373 = !defunc_0_neq_res_76372;\n                cond_f_res_76374 = slt64(redout_77496, (int64_t) 0);\n                y_76375 = defunc_0_neq_res_76372 && cond_f_res_76374;\n                cond_76376 = defunc_0_neq_res_76373 || y_76375;\n                defunc_0_neq_res_76377 = x_76364 == eta_p_76352;\n                defunc_0_neq_res_76378 = !defunc_0_neq_res_76377;\n                cond_t_res_f_res_76379 = slt64(x_76363, (int64_t) 0);\n                y_76380 = defunc_0_neq_res_76377 && cond_t_res_f_res_76379;\n                cond_t_res_76381 = defunc_0_neq_res_76378 || y_76380;\n                x_76382 = cond_76376 && cond_t_res_76381;\n                if (x_76382) {\n                    defunc_0_op_res_76383 = (int64_t) -1;\n                    defunc_0_op_res_76384 = eta_p_76352;\n                    defunc_0_op_res_76385 = (int64_t) 0;\n                } else {\n                    int64_t x_76365;\n                    int64_t defunc_0_op_res_f_res_76386;\n                    double defunc_0_op_res_f_res_76387;\n                    int64_t defunc_0_op_res_f_res_76388;\n                    \n                    x_76365 = ((__local int64_t *) color_78688)[i_77499];\n                    if (cond_76376) {\n                        defunc_0_op_res_f_res_76386 = x_76363;\n                        defunc_0_op_res_f_res_76387 = x_76364;\n                        defunc_0_op_res_f_r", "es_76388 = x_76365;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_76389;\n                        int64_t defunc_0_op_res_f_res_f_res_76390;\n                        int64_t defunc_0_op_res_f_res_f_res_76391;\n                        \n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76389 = redout_77497;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76389 = eta_p_76352;\n                        }\n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76390 = redout_77496;\n                            defunc_0_op_res_f_res_f_res_76391 = redout_77498;\n                        } else {\n                            int64_t min_res_76392;\n                            int64_t tmp_76393;\n                            \n                            min_res_76392 = smin64(x_76363, redout_77496);\n                            tmp_76393 = add64(x_76365, redout_77498);\n                            defunc_0_op_res_f_res_f_res_76390 = min_res_76392;\n                            defunc_0_op_res_f_res_f_res_76391 = tmp_76393;\n                        }\n                        defunc_0_op_res_f_res_76386 = defunc_0_op_res_f_res_f_res_76390;\n                        defunc_0_op_res_f_res_76387 = defunc_0_op_res_f_res_f_res_76389;\n                        defunc_0_op_res_f_res_76388 = defunc_0_op_res_f_res_f_res_76391;\n                    }\n                    defunc_0_op_res_76383 = defunc_0_op_res_f_res_76386;\n                    defunc_0_op_res_76384 = defunc_0_op_res_f_res_76387;\n                    defunc_0_op_res_76385 = defunc_0_op_res_f_res_76388;\n                }\n                redout_tmp_78817 = defunc_0_op_res_76383;\n                redout_tmp_78818 = defunc_0_op_res_76384;\n                redout_tmp_78819 = defunc_0_op_res_76385;\n                redout_77496 = redout_tmp_78817;\n                redout_774", "97 = redout_tmp_78818;\n                redout_77498 = redout_tmp_78819;\n            }\n            x_76360 = redout_77496;\n            x_76361 = redout_77497;\n            x_76362 = redout_77498;\n            acc_76357 = x_76360;\n            acc_76359 = x_76362;\n        } else {\n            acc_76357 = acc_76353;\n            acc_76359 = acc_76355;\n        }\n        mem_78037[(int64_t) 0] = acc_76357;\n        mem_78041[(int64_t) 0] = acc_76359;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_78043[i_17] = mem_78037[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_78042[i_18] = mem_78041[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78820 = ext_mem_78043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78045)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78820;\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78821 = ext_mem_78042[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78047)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78821;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76059\n    #undef bytes_78007\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_76412_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_76412(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76415, int64_t num_whole_tiles_76430, int64_t residual_input_76654, unsigned char cond_76655_bits, int64_t binop_x_76671, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_77984, __global unsigned char *mem_77",
                                    "986)\n{\n    bool cond_76655 = cond_76655_bits;\n    \n    #define tile_sizze_76414 (inner_SMJ_doublezisegmap_intrablock_76412zitile_sizze_76414)\n    #define bytes_77946 (inner_SMJ_doublezisegmap_intrablock_76412zibytes_77946)\n    \n    volatile __local unsigned char *color_78693_backing_2 = &shared_mem[0];\n    const int64_t color_78693_backing_2_offset = 0 + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78692_backing_1 = &shared_mem[color_78693_backing_2_offset];\n    const int64_t color_78692_backing_1_offset = color_78693_backing_2_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78691_backing_0 = &shared_mem[color_78692_backing_1_offset];\n    const int64_t color_78691_backing_0_offset = color_78692_backing_1_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78825;\n    int32_t tblock_sizze_78828;\n    int32_t wave_sizze_78827;\n    int32_t block_id_78826;\n    int32_t global_tid_78824;\n    int64_t gid_flat_76412;\n    int64_t slice_78830;\n    int64_t ltid_pre_78829;\n    int64_t remnant_78831;\n    int64_t slice_78832;\n    int64_t gid_76411;\n    int64_t remnant_78833;\n    __local unsigned char *color_78691;\n    __local unsigned char *color_78692;\n    __local unsigned char *color_78693;\n    int64_t binop_x_76422;\n    double mem_77930[1];\n    int64_t ltid_flat_76417;\n    int64_t ltid_76416;\n    int64_t gtid_76423;\n    bool cond_76424;\n    double pre_76425;\n    int64_t mem_77934[1];\n    double mem_77938[1];\n    int64_t mem_77942[1];\n    int64_t ltid_flat_76432;\n    int64_t ltid_76431;\n    int64_t gtid_76442;\n    bool cond_76443;\n    int64_t neutral_76444;\n    double neutral_76445;\n    int64_t ext_mem_77966[1];\n    double ext_mem_77965[1];\n    int64_t ext_mem_77964[1];\n    int64_t mem_param_779", "43[1];\n    double mem_param_77944[1];\n    int64_t mem_param_77945[1];\n    int64_t mem_77976[1];\n    int64_t mem_77980[1];\n    int64_t ext_mem_77982[1];\n    int64_t ext_mem_77981[1];\n    \n    local_tid_78825 = get_local_id(0);\n    tblock_sizze_78828 = get_local_size(0);\n    wave_sizze_78827 = LOCKSTEP_WIDTH;\n    block_id_78826 = get_tblock_id(0);\n    global_tid_78824 = block_id_78826 * tblock_sizze_78828 + local_tid_78825;\n    gid_flat_76412 = sext_i32_i64(block_id_78826);\n    slice_78830 = tile_sizze_76414;\n    ltid_pre_78829 = sext_i32_i64(local_tid_78825);\n    remnant_78831 = sext_i32_i64(local_tid_78825) - ltid_pre_78829;\n    slice_78832 = ldim_76415;\n    gid_76411 = sext_i32_i64(block_id_78826);\n    remnant_78833 = sext_i32_i64(block_id_78826) - gid_76411;\n    color_78691 = (__local unsigned char *) color_78691_backing_0;\n    color_78692 = (__local unsigned char *) color_78692_backing_1;\n    color_78693 = (__local unsigned char *) color_78693_backing_2;\n    binop_x_76422 = gid_76411 * tile_sizze_76414;\n    ltid_flat_76417 = sext_i32_i64(local_tid_78825);\n    ltid_76416 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76423 = ltid_76416 + binop_x_76422;\n    cond_76424 = slt64(gtid_76423, min_res_68560);\n    if (cond_76424) {\n        int64_t slice_76426;\n        double eta_p_76427;\n        \n        slice_76426 = start_68558 + gtid_76423;\n        eta_p_76427 = ((__global double *) tR_mem_77625)[slice_76426];\n        pre_76425 = eta_p_76427;\n    } else {\n        pre_76425 = 0.0;\n    }\n    mem_77930[(int64_t) 0] = pre_76425;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76432 = sext_i32_i64(local_tid_78825);\n    ltid_76431 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76442 = binop_x_76422 + ltid_76431;\n    cond_76443 = slt64(gtid_76442, min_res_68560);\n    if (cond_76443) {\n        neutral_76444 = (int64_t) -1;\n    } else {\n        neutral_76444 = (int64_t) 0;\n    }\n    if (cond_76443) {\n        double eta_p_76447 = mem_77930[(int64_t) 0];\n        \n", "        neutral_76445 = eta_p_76447;\n    } else {\n        neutral_76445 = 0.0;\n    }\n    mem_77934[(int64_t) 0] = neutral_76444;\n    mem_77938[(int64_t) 0] = neutral_76445;\n    mem_77942[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77943[i_3] = mem_77934[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77944[i_4] = mem_77938[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77945[i_5] = mem_77942[i_5];\n    for (int64_t tile_id_76457 = 0; tile_id_76457 < num_whole_tiles_76430; tile_id_76457++) {\n        int64_t binop_x_76556;\n        int64_t ltid_flat_76555;\n        int64_t ltid_76554;\n        int64_t j_76557;\n        bool cond_76561;\n        int64_t pre1d_76564;\n        int64_t pre1d_76562;\n        double pre1d_76563;\n        int64_t mem_77955[1];\n        double mem_77959[1];\n        int64_t mem_77963[1];\n        int64_t ltid_flat_76575;\n        int64_t ltid_76574;\n        int64_t gtid_76577;\n        int64_t acc_76579;\n        double acc_76580;\n        int64_t acc_76581;\n        bool cond_76582;\n        int64_t acc_76583;\n        double acc_76584;\n        int64_t acc_76585;\n        int64_t mem_param_tmp_78834[1];\n        double mem_param_tmp_78835[1];\n        int64_t mem_param_tmp_78836[1];\n        \n        binop_x_76556 = tile_sizze_76414 * tile_id_76457;\n        ltid_flat_76555 = sext_i32_i64(local_tid_78825);\n        ltid_76554 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76557 = ltid_76554 + binop_x_76556;\n        cond_76561 = slt64(j_76557, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76564 = btoi_bool_i64(cond_76561);\n        if (cond_76561) {\n            int64_t tile_elem_76565;\n            int64_t slice_77483;\n            double tile_elem_76566;\n            \n            tile_elem_76565 = ((__global int64_t *) ext_mem_77925)[j_76557];\n            slice_77483 = tS_start_66998 + j_76557;\n  ",
                                    "          tile_elem_76566 = ((__global double *) tS_mem_77626)[slice_77483];\n            pre1d_76562 = tile_elem_76565;\n            pre1d_76563 = tile_elem_76566;\n        } else {\n            pre1d_76562 = (int64_t) 0;\n            pre1d_76563 = 0.0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76554] = pre1d_76562;\n        ((__local double *) color_78692)[ltid_76554] = pre1d_76563;\n        ((__local int64_t *) color_78691)[ltid_76554] = pre1d_76564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76575 = sext_i32_i64(local_tid_78825);\n        ltid_76574 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76577 = binop_x_76422 + ltid_76574;\n        acc_76579 = mem_param_77943[(int64_t) 0];\n        acc_76580 = mem_param_77944[(int64_t) 0];\n        acc_76581 = mem_param_77945[(int64_t) 0];\n        cond_76582 = slt64(gtid_76577, min_res_68560);\n        if (cond_76582) {\n            double eta_p_76578;\n            int64_t x_76586;\n            double x_76587;\n            int64_t x_76588;\n            int64_t redout_77500;\n            double redout_77501;\n            int64_t redout_77502;\n            \n            eta_p_76578 = mem_77930[(int64_t) 0];\n            redout_77500 = acc_76579;\n            redout_77501 = acc_76580;\n            redout_77502 = acc_76581;\n            for (int64_t i_77503 = 0; i_77503 < tile_sizze_76414; i_77503++) {\n                int64_t x_76589;\n                double x_76590;\n                bool defunc_0_neq_res_76598;\n                bool defunc_0_neq_res_76599;\n                bool cond_f_res_76600;\n                bool y_76601;\n                bool cond_76602;\n                bool defunc_0_neq_res_76603;\n                bool defunc_0_neq_res_76604;\n                bool cond_t_res_f_res_76605;\n                bool y_76606;\n                bool cond_t_res_76607;\n                bool x_76608;\n                int64_t defunc_0_op_res_76609;\n                double defunc_0_op_res_76610;\n                int64_t defunc_0_op", "_res_76611;\n                int64_t redout_tmp_78840;\n                double redout_tmp_78841;\n                int64_t redout_tmp_78842;\n                \n                x_76589 = ((__local int64_t *) color_78693)[i_77503];\n                x_76590 = ((__local double *) color_78692)[i_77503];\n                defunc_0_neq_res_76598 = redout_77501 == eta_p_76578;\n                defunc_0_neq_res_76599 = !defunc_0_neq_res_76598;\n                cond_f_res_76600 = slt64(redout_77500, (int64_t) 0);\n                y_76601 = defunc_0_neq_res_76598 && cond_f_res_76600;\n                cond_76602 = defunc_0_neq_res_76599 || y_76601;\n                defunc_0_neq_res_76603 = x_76590 == eta_p_76578;\n                defunc_0_neq_res_76604 = !defunc_0_neq_res_76603;\n                cond_t_res_f_res_76605 = slt64(x_76589, (int64_t) 0);\n                y_76606 = defunc_0_neq_res_76603 && cond_t_res_f_res_76605;\n                cond_t_res_76607 = defunc_0_neq_res_76604 || y_76606;\n                x_76608 = cond_76602 && cond_t_res_76607;\n                if (x_76608) {\n                    defunc_0_op_res_76609 = (int64_t) -1;\n                    defunc_0_op_res_76610 = eta_p_76578;\n                    defunc_0_op_res_76611 = (int64_t) 0;\n                } else {\n                    int64_t x_76591;\n                    int64_t defunc_0_op_res_f_res_76612;\n                    double defunc_0_op_res_f_res_76613;\n                    int64_t defunc_0_op_res_f_res_76614;\n                    \n                    x_76591 = ((__local int64_t *) color_78691)[i_77503];\n                    if (cond_76602) {\n                        defunc_0_op_res_f_res_76612 = x_76589;\n                        defunc_0_op_res_f_res_76613 = x_76590;\n                        defunc_0_op_res_f_res_76614 = x_76591;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_76615;\n                        int64_t defunc_0_op_res_f_res_f_res_76616;\n                        int64_t defunc_0_op_", "res_f_res_f_res_76617;\n                        \n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76615 = redout_77501;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76615 = eta_p_76578;\n                        }\n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76616 = redout_77500;\n                            defunc_0_op_res_f_res_f_res_76617 = redout_77502;\n                        } else {\n                            int64_t min_res_76618;\n                            int64_t tmp_76619;\n                            \n                            min_res_76618 = smin64(x_76589, redout_77500);\n                            tmp_76619 = add64(x_76591, redout_77502);\n                            defunc_0_op_res_f_res_f_res_76616 = min_res_76618;\n                            defunc_0_op_res_f_res_f_res_76617 = tmp_76619;\n                        }\n                        defunc_0_op_res_f_res_76612 = defunc_0_op_res_f_res_f_res_76616;\n                        defunc_0_op_res_f_res_76613 = defunc_0_op_res_f_res_f_res_76615;\n                        defunc_0_op_res_f_res_76614 = defunc_0_op_res_f_res_f_res_76617;\n                    }\n                    defunc_0_op_res_76609 = defunc_0_op_res_f_res_76612;\n                    defunc_0_op_res_76610 = defunc_0_op_res_f_res_76613;\n                    defunc_0_op_res_76611 = defunc_0_op_res_f_res_76614;\n                }\n                redout_tmp_78840 = defunc_0_op_res_76609;\n                redout_tmp_78841 = defunc_0_op_res_76610;\n                redout_tmp_78842 = defunc_0_op_res_76611;\n                redout_77500 = redout_tmp_78840;\n                redout_77501 = redout_tmp_78841;\n                redout_77502 = redout_tmp_78842;\n            }\n            x_76586 = redout_77500;\n            x_76587 = redout_77501;\n            x_76588 = redout_77502;\n            acc_76583 = x_76586;",
                                    "\n            acc_76584 = x_76587;\n            acc_76585 = x_76588;\n        } else {\n            acc_76583 = acc_76579;\n            acc_76584 = acc_76580;\n            acc_76585 = acc_76581;\n        }\n        mem_77955[(int64_t) 0] = acc_76583;\n        mem_77959[(int64_t) 0] = acc_76584;\n        mem_77963[(int64_t) 0] = acc_76585;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78834[i_6] = mem_77955[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78835[i_7] = mem_77959[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78836[i_8] = mem_77963[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77943[i_9] = mem_param_tmp_78834[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77944[i_10] = mem_param_tmp_78835[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77945[i_11] = mem_param_tmp_78836[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77966[i_12] = mem_param_77943[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77965[i_13] = mem_param_77944[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77964[i_14] = mem_param_77945[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76655) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77982[i_15] = ext_mem_77966[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77981[i_16] = ext_mem_77964[i_16];\n    } else {\n        int64_t ltid_flat_76657;\n        int64_t ltid_76656;\n        int64_t j_76672;\n        bool cond_76676;\n        int64_t pre1d_76679;\n        int64_t pre1d_76677;\n        double pre1d_76678;\n        int64_t ltid_flat_76693;\n        int64_t ltid_76692;\n        int64_t gtid_76706;\n        int64_t acc_76708;\n        int64_t acc_76710;\n        bool cond_76711;\n        int64_t acc_76712;\n        int64_t acc_76714;\n ", "       \n        ltid_flat_76657 = sext_i32_i64(local_tid_78825);\n        ltid_76656 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76672 = ltid_76656 + binop_x_76671;\n        cond_76676 = slt64(j_76672, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76679 = btoi_bool_i64(cond_76676);\n        if (cond_76676) {\n            int64_t tile_elem_76680;\n            int64_t slice_77482;\n            double tile_elem_76681;\n            \n            tile_elem_76680 = ((__global int64_t *) ext_mem_77925)[j_76672];\n            slice_77482 = tS_start_66998 + j_76672;\n            tile_elem_76681 = ((__global double *) tS_mem_77626)[slice_77482];\n            pre1d_76677 = tile_elem_76680;\n            pre1d_76678 = tile_elem_76681;\n        } else {\n            pre1d_76677 = (int64_t) 0;\n            pre1d_76678 = 0.0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76656] = pre1d_76677;\n        ((__local double *) color_78692)[ltid_76656] = pre1d_76678;\n        ((__local int64_t *) color_78691)[ltid_76656] = pre1d_76679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76693 = sext_i32_i64(local_tid_78825);\n        ltid_76692 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76706 = binop_x_76422 + ltid_76692;\n        acc_76708 = ext_mem_77966[(int64_t) 0];\n        acc_76710 = ext_mem_77964[(int64_t) 0];\n        cond_76711 = slt64(gtid_76706, min_res_68560);\n        if (cond_76711) {\n            double eta_p_76707;\n            double acc_76709;\n            int64_t x_76715;\n            double x_76716;\n            int64_t x_76717;\n            int64_t redout_77504;\n            double redout_77505;\n            int64_t redout_77506;\n            \n            eta_p_76707 = mem_77930[(int64_t) 0];\n            acc_76709 = ext_mem_77965[(int64_t) 0];\n            redout_77504 = acc_76708;\n            redout_77505 = acc_76709;\n            redout_77506 = acc_76710;\n            for (int64_t i_77507 = 0; i_77507 < residual_input_76654; i_77507++) {\n", "                int64_t x_76718;\n                double x_76719;\n                bool defunc_0_neq_res_76727;\n                bool defunc_0_neq_res_76728;\n                bool cond_f_res_76729;\n                bool y_76730;\n                bool cond_76731;\n                bool defunc_0_neq_res_76732;\n                bool defunc_0_neq_res_76733;\n                bool cond_t_res_f_res_76734;\n                bool y_76735;\n                bool cond_t_res_76736;\n                bool x_76737;\n                int64_t defunc_0_op_res_76738;\n                double defunc_0_op_res_76739;\n                int64_t defunc_0_op_res_76740;\n                int64_t redout_tmp_78843;\n                double redout_tmp_78844;\n                int64_t redout_tmp_78845;\n                \n                x_76718 = ((__local int64_t *) color_78693)[i_77507];\n                x_76719 = ((__local double *) color_78692)[i_77507];\n                defunc_0_neq_res_76727 = redout_77505 == eta_p_76707;\n                defunc_0_neq_res_76728 = !defunc_0_neq_res_76727;\n                cond_f_res_76729 = slt64(redout_77504, (int64_t) 0);\n                y_76730 = defunc_0_neq_res_76727 && cond_f_res_76729;\n                cond_76731 = defunc_0_neq_res_76728 || y_76730;\n                defunc_0_neq_res_76732 = x_76719 == eta_p_76707;\n                defunc_0_neq_res_76733 = !defunc_0_neq_res_76732;\n                cond_t_res_f_res_76734 = slt64(x_76718, (int64_t) 0);\n                y_76735 = defunc_0_neq_res_76732 && cond_t_res_f_res_76734;\n                cond_t_res_76736 = defunc_0_neq_res_76733 || y_76735;\n                x_76737 = cond_76731 && cond_t_res_76736;\n                if (x_76737) {\n                    defunc_0_op_res_76738 = (int64_t) -1;\n                    defunc_0_op_res_76739 = eta_p_76707;\n                    defunc_0_op_res_76740 = (int64_t) 0;\n                } else {\n                    int64_t x_76720;\n                    int64_t defunc_0_op_res_f_res_76741;\n                    do",
                                    "uble defunc_0_op_res_f_res_76742;\n                    int64_t defunc_0_op_res_f_res_76743;\n                    \n                    x_76720 = ((__local int64_t *) color_78691)[i_77507];\n                    if (cond_76731) {\n                        defunc_0_op_res_f_res_76741 = x_76718;\n                        defunc_0_op_res_f_res_76742 = x_76719;\n                        defunc_0_op_res_f_res_76743 = x_76720;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_76744;\n                        int64_t defunc_0_op_res_f_res_f_res_76745;\n                        int64_t defunc_0_op_res_f_res_f_res_76746;\n                        \n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76744 = redout_77505;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76744 = eta_p_76707;\n                        }\n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76745 = redout_77504;\n                            defunc_0_op_res_f_res_f_res_76746 = redout_77506;\n                        } else {\n                            int64_t min_res_76747;\n                            int64_t tmp_76748;\n                            \n                            min_res_76747 = smin64(x_76718, redout_77504);\n                            tmp_76748 = add64(x_76720, redout_77506);\n                            defunc_0_op_res_f_res_f_res_76745 = min_res_76747;\n                            defunc_0_op_res_f_res_f_res_76746 = tmp_76748;\n                        }\n                        defunc_0_op_res_f_res_76741 = defunc_0_op_res_f_res_f_res_76745;\n                        defunc_0_op_res_f_res_76742 = defunc_0_op_res_f_res_f_res_76744;\n                        defunc_0_op_res_f_res_76743 = defunc_0_op_res_f_res_f_res_76746;\n                    }\n                    defunc_0_op_res_76738 = defunc_0_op_res_f_res_76741;\n                    ", "defunc_0_op_res_76739 = defunc_0_op_res_f_res_76742;\n                    defunc_0_op_res_76740 = defunc_0_op_res_f_res_76743;\n                }\n                redout_tmp_78843 = defunc_0_op_res_76738;\n                redout_tmp_78844 = defunc_0_op_res_76739;\n                redout_tmp_78845 = defunc_0_op_res_76740;\n                redout_77504 = redout_tmp_78843;\n                redout_77505 = redout_tmp_78844;\n                redout_77506 = redout_tmp_78845;\n            }\n            x_76715 = redout_77504;\n            x_76716 = redout_77505;\n            x_76717 = redout_77506;\n            acc_76712 = x_76715;\n            acc_76714 = x_76717;\n        } else {\n            acc_76712 = acc_76708;\n            acc_76714 = acc_76710;\n        }\n        mem_77976[(int64_t) 0] = acc_76712;\n        mem_77980[(int64_t) 0] = acc_76714;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77982[i_17] = mem_77976[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77981[i_18] = mem_77980[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78846 = ext_mem_77982[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77984)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78846;\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78847 = ext_mem_77981[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77986)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78847;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76414\n    #undef bytes_77946\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_76767_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_76767(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int", "64_t slice_67712, int64_t slice_68069, int64_t ldim_76770, int64_t num_whole_tiles_76785, int64_t residual_input_77009, unsigned char cond_77010_bits, int64_t binop_x_77026, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77840, __global unsigned char *mem_77842)\n{\n    bool cond_77010 = cond_77010_bits;\n    \n    #define tile_sizze_76769 (inner_SMJ_doublezisegmap_intrablock_76767zitile_sizze_76769)\n    #define bytes_77802 (inner_SMJ_doublezisegmap_intrablock_76767zibytes_77802)\n    \n    volatile __local unsigned char *color_78696_backing_2 = &shared_mem[0];\n    const int64_t color_78696_backing_2_offset = 0 + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78695_backing_1 = &shared_mem[color_78696_backing_2_offset];\n    const int64_t color_78695_backing_1_offset = color_78696_backing_2_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78694_backing_0 = &shared_mem[color_78695_backing_1_offset];\n    const int64_t color_78694_backing_0_offset = color_78695_backing_1_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78966;\n    int32_t tblock_sizze_78969;\n    int32_t wave_sizze_78968;\n    int32_t block_id_78967;\n    int32_t global_tid_78965;\n    int64_t gid_flat_76767;\n    int64_t slice_78971;\n    int64_t ltid_pre_78970;\n    int64_t remnant_78972;\n    int64_t slice_78973;\n    int64_t gid_76766;\n    int64_t remnant_78974;\n    __local unsigned char *color_78694;\n    __local unsigned char *color_78695;\n    __local unsigned char *color_78696;\n    int64_t binop_x_76777;\n    double mem_77786[1];\n    int64_t ltid_flat_76772;\n    int64_t ltid_76771;\n    int64_t gtid_76778;\n    bool cond_76779;\n    double",
                                    " pre_76780;\n    int64_t mem_77790[1];\n    double mem_77794[1];\n    int64_t mem_77798[1];\n    int64_t ltid_flat_76787;\n    int64_t ltid_76786;\n    int64_t gtid_76797;\n    bool cond_76798;\n    int64_t neutral_76799;\n    double neutral_76800;\n    int64_t ext_mem_77822[1];\n    double ext_mem_77821[1];\n    int64_t ext_mem_77820[1];\n    int64_t mem_param_77799[1];\n    double mem_param_77800[1];\n    int64_t mem_param_77801[1];\n    int64_t mem_77832[1];\n    int64_t mem_77836[1];\n    int64_t ext_mem_77838[1];\n    int64_t ext_mem_77837[1];\n    \n    local_tid_78966 = get_local_id(0);\n    tblock_sizze_78969 = get_local_size(0);\n    wave_sizze_78968 = LOCKSTEP_WIDTH;\n    block_id_78967 = get_tblock_id(0);\n    global_tid_78965 = block_id_78967 * tblock_sizze_78969 + local_tid_78966;\n    gid_flat_76767 = sext_i32_i64(block_id_78967);\n    slice_78971 = tile_sizze_76769;\n    ltid_pre_78970 = sext_i32_i64(local_tid_78966);\n    remnant_78972 = sext_i32_i64(local_tid_78966) - ltid_pre_78970;\n    slice_78973 = ldim_76770;\n    gid_76766 = sext_i32_i64(block_id_78967);\n    remnant_78974 = sext_i32_i64(block_id_78967) - gid_76766;\n    color_78694 = (__local unsigned char *) color_78694_backing_0;\n    color_78695 = (__local unsigned char *) color_78695_backing_1;\n    color_78696 = (__local unsigned char *) color_78696_backing_2;\n    binop_x_76777 = gid_76766 * tile_sizze_76769;\n    ltid_flat_76772 = sext_i32_i64(local_tid_78966);\n    ltid_76771 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76778 = ltid_76771 + binop_x_76777;\n    cond_76779 = slt64(gtid_76778, min_res_67698);\n    if (cond_76779) {\n        int64_t slice_76781;\n        double eta_p_76782;\n        \n        slice_76781 = slice_67712 + gtid_76778;\n        eta_p_76782 = ((__global double *) tR_mem_77625)[slice_76781];\n        pre_76780 = eta_p_76782;\n    } else {\n        pre_76780 = 0.0;\n    }\n    mem_77786[(int64_t) 0] = pre_76780;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76787 = sext_i32_i64(local_tid_78966);\n   ", " ltid_76786 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76797 = binop_x_76777 + ltid_76786;\n    cond_76798 = slt64(gtid_76797, min_res_67698);\n    if (cond_76798) {\n        neutral_76799 = (int64_t) -1;\n    } else {\n        neutral_76799 = (int64_t) 0;\n    }\n    if (cond_76798) {\n        double eta_p_76802 = mem_77786[(int64_t) 0];\n        \n        neutral_76800 = eta_p_76802;\n    } else {\n        neutral_76800 = 0.0;\n    }\n    mem_77790[(int64_t) 0] = neutral_76799;\n    mem_77794[(int64_t) 0] = neutral_76800;\n    mem_77798[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77799[i_3] = mem_77790[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77800[i_4] = mem_77794[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77801[i_5] = mem_77798[i_5];\n    for (int64_t tile_id_76812 = 0; tile_id_76812 < num_whole_tiles_76785; tile_id_76812++) {\n        int64_t binop_x_76911;\n        int64_t ltid_flat_76910;\n        int64_t ltid_76909;\n        int64_t j_76912;\n        bool cond_76916;\n        int64_t pre1d_76919;\n        int64_t pre1d_76917;\n        double pre1d_76918;\n        int64_t mem_77811[1];\n        double mem_77815[1];\n        int64_t mem_77819[1];\n        int64_t ltid_flat_76930;\n        int64_t ltid_76929;\n        int64_t gtid_76932;\n        int64_t acc_76934;\n        double acc_76935;\n        int64_t acc_76936;\n        bool cond_76937;\n        int64_t acc_76938;\n        double acc_76939;\n        int64_t acc_76940;\n        int64_t mem_param_tmp_78975[1];\n        double mem_param_tmp_78976[1];\n        int64_t mem_param_tmp_78977[1];\n        \n        binop_x_76911 = tile_sizze_76769 * tile_id_76812;\n        ltid_flat_76910 = sext_i32_i64(local_tid_78966);\n        ltid_76909 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_76912 = ltid_76909 + binop_x_76911;\n        cond_76916 = slt64(j_76912, j_m_i_67660);\n       ", " pre1d_76919 = btoi_bool_i64(cond_76916);\n        if (cond_76916) {\n            int64_t tile_elem_76920;\n            int64_t slice_77487;\n            double tile_elem_76921;\n            \n            tile_elem_76920 = ((__global int64_t *) ext_mem_77720)[j_76912];\n            slice_77487 = slice_68069 + j_76912;\n            tile_elem_76921 = ((__global double *) tS_mem_77626)[slice_77487];\n            pre1d_76917 = tile_elem_76920;\n            pre1d_76918 = tile_elem_76921;\n        } else {\n            pre1d_76917 = (int64_t) 0;\n            pre1d_76918 = 0.0;\n        }\n        ((__local int64_t *) color_78696)[ltid_76909] = pre1d_76917;\n        ((__local double *) color_78695)[ltid_76909] = pre1d_76918;\n        ((__local int64_t *) color_78694)[ltid_76909] = pre1d_76919;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76930 = sext_i32_i64(local_tid_78966);\n        ltid_76929 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_76932 = binop_x_76777 + ltid_76929;\n        acc_76934 = mem_param_77799[(int64_t) 0];\n        acc_76935 = mem_param_77800[(int64_t) 0];\n        acc_76936 = mem_param_77801[(int64_t) 0];\n        cond_76937 = slt64(gtid_76932, min_res_67698);\n        if (cond_76937) {\n            double eta_p_76933;\n            int64_t x_76941;\n            double x_76942;\n            int64_t x_76943;\n            int64_t redout_77508;\n            double redout_77509;\n            int64_t redout_77510;\n            \n            eta_p_76933 = mem_77786[(int64_t) 0];\n            redout_77508 = acc_76934;\n            redout_77509 = acc_76935;\n            redout_77510 = acc_76936;\n            for (int64_t i_77511 = 0; i_77511 < tile_sizze_76769; i_77511++) {\n                int64_t x_76944;\n                double x_76945;\n                bool defunc_0_neq_res_76953;\n                bool defunc_0_neq_res_76954;\n                bool cond_f_res_76955;\n                bool y_76956;\n                bool cond_76957;\n                bool defunc_0_neq_res_76958;\n  ",
                                    "              bool defunc_0_neq_res_76959;\n                bool cond_t_res_f_res_76960;\n                bool y_76961;\n                bool cond_t_res_76962;\n                bool x_76963;\n                int64_t defunc_0_op_res_76964;\n                double defunc_0_op_res_76965;\n                int64_t defunc_0_op_res_76966;\n                int64_t redout_tmp_78981;\n                double redout_tmp_78982;\n                int64_t redout_tmp_78983;\n                \n                x_76944 = ((__local int64_t *) color_78696)[i_77511];\n                x_76945 = ((__local double *) color_78695)[i_77511];\n                defunc_0_neq_res_76953 = redout_77509 == eta_p_76933;\n                defunc_0_neq_res_76954 = !defunc_0_neq_res_76953;\n                cond_f_res_76955 = slt64(redout_77508, (int64_t) 0);\n                y_76956 = defunc_0_neq_res_76953 && cond_f_res_76955;\n                cond_76957 = defunc_0_neq_res_76954 || y_76956;\n                defunc_0_neq_res_76958 = x_76945 == eta_p_76933;\n                defunc_0_neq_res_76959 = !defunc_0_neq_res_76958;\n                cond_t_res_f_res_76960 = slt64(x_76944, (int64_t) 0);\n                y_76961 = defunc_0_neq_res_76958 && cond_t_res_f_res_76960;\n                cond_t_res_76962 = defunc_0_neq_res_76959 || y_76961;\n                x_76963 = cond_76957 && cond_t_res_76962;\n                if (x_76963) {\n                    defunc_0_op_res_76964 = (int64_t) -1;\n                    defunc_0_op_res_76965 = eta_p_76933;\n                    defunc_0_op_res_76966 = (int64_t) 0;\n                } else {\n                    int64_t x_76946;\n                    int64_t defunc_0_op_res_f_res_76967;\n                    double defunc_0_op_res_f_res_76968;\n                    int64_t defunc_0_op_res_f_res_76969;\n                    \n                    x_76946 = ((__local int64_t *) color_78694)[i_77511];\n                    if (cond_76957) {\n                        defunc_0_op_res_f_res_76967 = x_76944;\n                 ", "       defunc_0_op_res_f_res_76968 = x_76945;\n                        defunc_0_op_res_f_res_76969 = x_76946;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_76970;\n                        int64_t defunc_0_op_res_f_res_f_res_76971;\n                        int64_t defunc_0_op_res_f_res_f_res_76972;\n                        \n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76970 = redout_77509;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76970 = eta_p_76933;\n                        }\n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76971 = redout_77508;\n                            defunc_0_op_res_f_res_f_res_76972 = redout_77510;\n                        } else {\n                            int64_t min_res_76973;\n                            int64_t tmp_76974;\n                            \n                            min_res_76973 = smin64(x_76944, redout_77508);\n                            tmp_76974 = add64(x_76946, redout_77510);\n                            defunc_0_op_res_f_res_f_res_76971 = min_res_76973;\n                            defunc_0_op_res_f_res_f_res_76972 = tmp_76974;\n                        }\n                        defunc_0_op_res_f_res_76967 = defunc_0_op_res_f_res_f_res_76971;\n                        defunc_0_op_res_f_res_76968 = defunc_0_op_res_f_res_f_res_76970;\n                        defunc_0_op_res_f_res_76969 = defunc_0_op_res_f_res_f_res_76972;\n                    }\n                    defunc_0_op_res_76964 = defunc_0_op_res_f_res_76967;\n                    defunc_0_op_res_76965 = defunc_0_op_res_f_res_76968;\n                    defunc_0_op_res_76966 = defunc_0_op_res_f_res_76969;\n                }\n                redout_tmp_78981 = defunc_0_op_res_76964;\n                redout_tmp_78982 = defunc_0_op_res_76965;\n                redout_tmp_78983 = defunc_0_", "op_res_76966;\n                redout_77508 = redout_tmp_78981;\n                redout_77509 = redout_tmp_78982;\n                redout_77510 = redout_tmp_78983;\n            }\n            x_76941 = redout_77508;\n            x_76942 = redout_77509;\n            x_76943 = redout_77510;\n            acc_76938 = x_76941;\n            acc_76939 = x_76942;\n            acc_76940 = x_76943;\n        } else {\n            acc_76938 = acc_76934;\n            acc_76939 = acc_76935;\n            acc_76940 = acc_76936;\n        }\n        mem_77811[(int64_t) 0] = acc_76938;\n        mem_77815[(int64_t) 0] = acc_76939;\n        mem_77819[(int64_t) 0] = acc_76940;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78975[i_6] = mem_77811[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78976[i_7] = mem_77815[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78977[i_8] = mem_77819[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77799[i_9] = mem_param_tmp_78975[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77800[i_10] = mem_param_tmp_78976[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77801[i_11] = mem_param_tmp_78977[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77822[i_12] = mem_param_77799[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77821[i_13] = mem_param_77800[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77820[i_14] = mem_param_77801[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77010) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77838[i_15] = ext_mem_77822[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77837[i_16] = ext_mem_77820[i_16];\n    } else {\n        int64_t ltid_flat_77012;\n        int64_t ltid_77011;\n        int64_t j_77027;\n        bool cond_7",
                                    "7031;\n        int64_t pre1d_77034;\n        int64_t pre1d_77032;\n        double pre1d_77033;\n        int64_t ltid_flat_77048;\n        int64_t ltid_77047;\n        int64_t gtid_77061;\n        int64_t acc_77063;\n        int64_t acc_77065;\n        bool cond_77066;\n        int64_t acc_77067;\n        int64_t acc_77069;\n        \n        ltid_flat_77012 = sext_i32_i64(local_tid_78966);\n        ltid_77011 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_77027 = ltid_77011 + binop_x_77026;\n        cond_77031 = slt64(j_77027, j_m_i_67660);\n        pre1d_77034 = btoi_bool_i64(cond_77031);\n        if (cond_77031) {\n            int64_t tile_elem_77035;\n            int64_t slice_77486;\n            double tile_elem_77036;\n            \n            tile_elem_77035 = ((__global int64_t *) ext_mem_77720)[j_77027];\n            slice_77486 = slice_68069 + j_77027;\n            tile_elem_77036 = ((__global double *) tS_mem_77626)[slice_77486];\n            pre1d_77032 = tile_elem_77035;\n            pre1d_77033 = tile_elem_77036;\n        } else {\n            pre1d_77032 = (int64_t) 0;\n            pre1d_77033 = 0.0;\n        }\n        ((__local int64_t *) color_78696)[ltid_77011] = pre1d_77032;\n        ((__local double *) color_78695)[ltid_77011] = pre1d_77033;\n        ((__local int64_t *) color_78694)[ltid_77011] = pre1d_77034;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77048 = sext_i32_i64(local_tid_78966);\n        ltid_77047 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_77061 = binop_x_76777 + ltid_77047;\n        acc_77063 = ext_mem_77822[(int64_t) 0];\n        acc_77065 = ext_mem_77820[(int64_t) 0];\n        cond_77066 = slt64(gtid_77061, min_res_67698);\n        if (cond_77066) {\n            double eta_p_77062;\n            double acc_77064;\n            int64_t x_77070;\n            double x_77071;\n            int64_t x_77072;\n            int64_t redout_77512;\n            double redout_77513;\n            int64_t redout_77514;\n            \n            eta_p_77062", " = mem_77786[(int64_t) 0];\n            acc_77064 = ext_mem_77821[(int64_t) 0];\n            redout_77512 = acc_77063;\n            redout_77513 = acc_77064;\n            redout_77514 = acc_77065;\n            for (int64_t i_77515 = 0; i_77515 < residual_input_77009; i_77515++) {\n                int64_t x_77073;\n                double x_77074;\n                bool defunc_0_neq_res_77082;\n                bool defunc_0_neq_res_77083;\n                bool cond_f_res_77084;\n                bool y_77085;\n                bool cond_77086;\n                bool defunc_0_neq_res_77087;\n                bool defunc_0_neq_res_77088;\n                bool cond_t_res_f_res_77089;\n                bool y_77090;\n                bool cond_t_res_77091;\n                bool x_77092;\n                int64_t defunc_0_op_res_77093;\n                double defunc_0_op_res_77094;\n                int64_t defunc_0_op_res_77095;\n                int64_t redout_tmp_78984;\n                double redout_tmp_78985;\n                int64_t redout_tmp_78986;\n                \n                x_77073 = ((__local int64_t *) color_78696)[i_77515];\n                x_77074 = ((__local double *) color_78695)[i_77515];\n                defunc_0_neq_res_77082 = redout_77513 == eta_p_77062;\n                defunc_0_neq_res_77083 = !defunc_0_neq_res_77082;\n                cond_f_res_77084 = slt64(redout_77512, (int64_t) 0);\n                y_77085 = defunc_0_neq_res_77082 && cond_f_res_77084;\n                cond_77086 = defunc_0_neq_res_77083 || y_77085;\n                defunc_0_neq_res_77087 = x_77074 == eta_p_77062;\n                defunc_0_neq_res_77088 = !defunc_0_neq_res_77087;\n                cond_t_res_f_res_77089 = slt64(x_77073, (int64_t) 0);\n                y_77090 = defunc_0_neq_res_77087 && cond_t_res_f_res_77089;\n                cond_t_res_77091 = defunc_0_neq_res_77088 || y_77090;\n                x_77092 = cond_77086 && cond_t_res_77091;\n                if (x_77092) {\n                    defunc_0_op_res_7", "7093 = (int64_t) -1;\n                    defunc_0_op_res_77094 = eta_p_77062;\n                    defunc_0_op_res_77095 = (int64_t) 0;\n                } else {\n                    int64_t x_77075;\n                    int64_t defunc_0_op_res_f_res_77096;\n                    double defunc_0_op_res_f_res_77097;\n                    int64_t defunc_0_op_res_f_res_77098;\n                    \n                    x_77075 = ((__local int64_t *) color_78694)[i_77515];\n                    if (cond_77086) {\n                        defunc_0_op_res_f_res_77096 = x_77073;\n                        defunc_0_op_res_f_res_77097 = x_77074;\n                        defunc_0_op_res_f_res_77098 = x_77075;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_77099;\n                        int64_t defunc_0_op_res_f_res_f_res_77100;\n                        int64_t defunc_0_op_res_f_res_f_res_77101;\n                        \n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77099 = redout_77513;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77099 = eta_p_77062;\n                        }\n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77100 = redout_77512;\n                            defunc_0_op_res_f_res_f_res_77101 = redout_77514;\n                        } else {\n                            int64_t min_res_77102;\n                            int64_t tmp_77103;\n                            \n                            min_res_77102 = smin64(x_77073, redout_77512);\n                            tmp_77103 = add64(x_77075, redout_77514);\n                            defunc_0_op_res_f_res_f_res_77100 = min_res_77102;\n                            defunc_0_op_res_f_res_f_res_77101 = tmp_77103;\n                        }\n                        defunc_0_op_res_f_res_77096 = defunc_0_op_res_f_res_f_res_77100;\n                 ",
                                    "       defunc_0_op_res_f_res_77097 = defunc_0_op_res_f_res_f_res_77099;\n                        defunc_0_op_res_f_res_77098 = defunc_0_op_res_f_res_f_res_77101;\n                    }\n                    defunc_0_op_res_77093 = defunc_0_op_res_f_res_77096;\n                    defunc_0_op_res_77094 = defunc_0_op_res_f_res_77097;\n                    defunc_0_op_res_77095 = defunc_0_op_res_f_res_77098;\n                }\n                redout_tmp_78984 = defunc_0_op_res_77093;\n                redout_tmp_78985 = defunc_0_op_res_77094;\n                redout_tmp_78986 = defunc_0_op_res_77095;\n                redout_77512 = redout_tmp_78984;\n                redout_77513 = redout_tmp_78985;\n                redout_77514 = redout_tmp_78986;\n            }\n            x_77070 = redout_77512;\n            x_77071 = redout_77513;\n            x_77072 = redout_77514;\n            acc_77067 = x_77070;\n            acc_77069 = x_77072;\n        } else {\n            acc_77067 = acc_77063;\n            acc_77069 = acc_77065;\n        }\n        mem_77832[(int64_t) 0] = acc_77067;\n        mem_77836[(int64_t) 0] = acc_77069;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77838[i_17] = mem_77832[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77837[i_18] = mem_77836[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78987 = ext_mem_77838[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77840)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78987;\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78988 = ext_mem_77837[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77842)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78988;\n    }\n    ", "\n  error_8:\n    return;\n    #undef tile_sizze_76769\n    #undef bytes_77802\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_77122_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_77122(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_77125, int64_t num_whole_tiles_77140, int64_t residual_input_77364, unsigned char cond_77365_bits, int64_t binop_x_77381, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77779, __global unsigned char *mem_77781)\n{\n    bool cond_77365 = cond_77365_bits;\n    \n    #define tile_sizze_77124 (inner_SMJ_doublezisegmap_intrablock_77122zitile_sizze_77124)\n    #define bytes_77741 (inner_SMJ_doublezisegmap_intrablock_77122zibytes_77741)\n    \n    volatile __local unsigned char *color_78699_backing_2 = &shared_mem[0];\n    const int64_t color_78699_backing_2_offset = 0 + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78698_backing_1 = &shared_mem[color_78699_backing_2_offset];\n    const int64_t color_78698_backing_1_offset = color_78699_backing_2_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78697_backing_0 = &shared_mem[color_78698_backing_1_offset];\n    const int64_t color_78697_backing_0_offset = color_78698_backing_1_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78992;\n    int32_t tblock_sizze_78995;\n    int32_t wave_sizze_78994;\n    int32_t block_id_78993;\n    int32_t global_tid_78991;\n    int64_t gid_flat_77122;\n    int64_t slice_78997;\n    int64_t ltid_pre_78996;\n    int64_t remnant_78998;\n    int64_t slice_78999;\n    int64_t gid_77121;\n    int64_t remnant_79000;\n    ", "__local unsigned char *color_78697;\n    __local unsigned char *color_78698;\n    __local unsigned char *color_78699;\n    int64_t binop_x_77132;\n    double mem_77725[1];\n    int64_t ltid_flat_77127;\n    int64_t ltid_77126;\n    int64_t gtid_77133;\n    bool cond_77134;\n    double pre_77135;\n    int64_t mem_77729[1];\n    double mem_77733[1];\n    int64_t mem_77737[1];\n    int64_t ltid_flat_77142;\n    int64_t ltid_77141;\n    int64_t gtid_77152;\n    bool cond_77153;\n    int64_t neutral_77154;\n    double neutral_77155;\n    int64_t ext_mem_77761[1];\n    double ext_mem_77760[1];\n    int64_t ext_mem_77759[1];\n    int64_t mem_param_77738[1];\n    double mem_param_77739[1];\n    int64_t mem_param_77740[1];\n    int64_t mem_77771[1];\n    int64_t mem_77775[1];\n    int64_t ext_mem_77777[1];\n    int64_t ext_mem_77776[1];\n    \n    local_tid_78992 = get_local_id(0);\n    tblock_sizze_78995 = get_local_size(0);\n    wave_sizze_78994 = LOCKSTEP_WIDTH;\n    block_id_78993 = get_tblock_id(0);\n    global_tid_78991 = block_id_78993 * tblock_sizze_78995 + local_tid_78992;\n    gid_flat_77122 = sext_i32_i64(block_id_78993);\n    slice_78997 = tile_sizze_77124;\n    ltid_pre_78996 = sext_i32_i64(local_tid_78992);\n    remnant_78998 = sext_i32_i64(local_tid_78992) - ltid_pre_78996;\n    slice_78999 = ldim_77125;\n    gid_77121 = sext_i32_i64(block_id_78993);\n    remnant_79000 = sext_i32_i64(block_id_78993) - gid_77121;\n    color_78697 = (__local unsigned char *) color_78697_backing_0;\n    color_78698 = (__local unsigned char *) color_78698_backing_1;\n    color_78699 = (__local unsigned char *) color_78699_backing_2;\n    binop_x_77132 = gid_77121 * tile_sizze_77124;\n    ltid_flat_77127 = sext_i32_i64(local_tid_78992);\n    ltid_77126 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77133 = ltid_77126 + binop_x_77132;\n    cond_77134 = slt64(gtid_77133, min_res_67698);\n    if (cond_77134) {\n        int64_t slice_77136;\n        double eta_p_77137;\n        \n        slice_77136 = slice_67712 + gtid_77133;\n  ",
                                    "      eta_p_77137 = ((__global double *) tR_mem_77625)[slice_77136];\n        pre_77135 = eta_p_77137;\n    } else {\n        pre_77135 = 0.0;\n    }\n    mem_77725[(int64_t) 0] = pre_77135;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_77142 = sext_i32_i64(local_tid_78992);\n    ltid_77141 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77152 = binop_x_77132 + ltid_77141;\n    cond_77153 = slt64(gtid_77152, min_res_67698);\n    if (cond_77153) {\n        neutral_77154 = (int64_t) -1;\n    } else {\n        neutral_77154 = (int64_t) 0;\n    }\n    if (cond_77153) {\n        double eta_p_77157 = mem_77725[(int64_t) 0];\n        \n        neutral_77155 = eta_p_77157;\n    } else {\n        neutral_77155 = 0.0;\n    }\n    mem_77729[(int64_t) 0] = neutral_77154;\n    mem_77733[(int64_t) 0] = neutral_77155;\n    mem_77737[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77738[i_3] = mem_77729[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77739[i_4] = mem_77733[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77740[i_5] = mem_77737[i_5];\n    for (int64_t tile_id_77167 = 0; tile_id_77167 < num_whole_tiles_77140; tile_id_77167++) {\n        int64_t binop_x_77266;\n        int64_t ltid_flat_77265;\n        int64_t ltid_77264;\n        int64_t j_77267;\n        bool cond_77271;\n        int64_t pre1d_77274;\n        int64_t pre1d_77272;\n        double pre1d_77273;\n        int64_t mem_77750[1];\n        double mem_77754[1];\n        int64_t mem_77758[1];\n        int64_t ltid_flat_77285;\n        int64_t ltid_77284;\n        int64_t gtid_77287;\n        int64_t acc_77289;\n        double acc_77290;\n        int64_t acc_77291;\n        bool cond_77292;\n        int64_t acc_77293;\n        double acc_77294;\n        int64_t acc_77295;\n        int64_t mem_param_tmp_79001[1];\n        double mem_param_tmp_79002[1];\n        int64_t mem_param_tmp_79003[1];\n        \n       ", " binop_x_77266 = tile_sizze_77124 * tile_id_77167;\n        ltid_flat_77265 = sext_i32_i64(local_tid_78992);\n        ltid_77264 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77267 = ltid_77264 + binop_x_77266;\n        cond_77271 = slt64(j_77267, j_m_i_67660);\n        pre1d_77274 = btoi_bool_i64(cond_77271);\n        if (cond_77271) {\n            int64_t tile_elem_77275;\n            int64_t slice_77491;\n            double tile_elem_77276;\n            \n            tile_elem_77275 = ((__global int64_t *) ext_mem_77720)[j_77267];\n            slice_77491 = slice_68069 + j_77267;\n            tile_elem_77276 = ((__global double *) tS_mem_77626)[slice_77491];\n            pre1d_77272 = tile_elem_77275;\n            pre1d_77273 = tile_elem_77276;\n        } else {\n            pre1d_77272 = (int64_t) 0;\n            pre1d_77273 = 0.0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77264] = pre1d_77272;\n        ((__local double *) color_78698)[ltid_77264] = pre1d_77273;\n        ((__local int64_t *) color_78697)[ltid_77264] = pre1d_77274;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77285 = sext_i32_i64(local_tid_78992);\n        ltid_77284 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77287 = binop_x_77132 + ltid_77284;\n        acc_77289 = mem_param_77738[(int64_t) 0];\n        acc_77290 = mem_param_77739[(int64_t) 0];\n        acc_77291 = mem_param_77740[(int64_t) 0];\n        cond_77292 = slt64(gtid_77287, min_res_67698);\n        if (cond_77292) {\n            double eta_p_77288;\n            int64_t x_77296;\n            double x_77297;\n            int64_t x_77298;\n            int64_t redout_77516;\n            double redout_77517;\n            int64_t redout_77518;\n            \n            eta_p_77288 = mem_77725[(int64_t) 0];\n            redout_77516 = acc_77289;\n            redout_77517 = acc_77290;\n            redout_77518 = acc_77291;\n            for (int64_t i_77519 = 0; i_77519 < tile_sizze_77124; i_77519++) {\n                int64_t x_77", "299;\n                double x_77300;\n                bool defunc_0_neq_res_77308;\n                bool defunc_0_neq_res_77309;\n                bool cond_f_res_77310;\n                bool y_77311;\n                bool cond_77312;\n                bool defunc_0_neq_res_77313;\n                bool defunc_0_neq_res_77314;\n                bool cond_t_res_f_res_77315;\n                bool y_77316;\n                bool cond_t_res_77317;\n                bool x_77318;\n                int64_t defunc_0_op_res_77319;\n                double defunc_0_op_res_77320;\n                int64_t defunc_0_op_res_77321;\n                int64_t redout_tmp_79007;\n                double redout_tmp_79008;\n                int64_t redout_tmp_79009;\n                \n                x_77299 = ((__local int64_t *) color_78699)[i_77519];\n                x_77300 = ((__local double *) color_78698)[i_77519];\n                defunc_0_neq_res_77308 = redout_77517 == eta_p_77288;\n                defunc_0_neq_res_77309 = !defunc_0_neq_res_77308;\n                cond_f_res_77310 = slt64(redout_77516, (int64_t) 0);\n                y_77311 = defunc_0_neq_res_77308 && cond_f_res_77310;\n                cond_77312 = defunc_0_neq_res_77309 || y_77311;\n                defunc_0_neq_res_77313 = x_77300 == eta_p_77288;\n                defunc_0_neq_res_77314 = !defunc_0_neq_res_77313;\n                cond_t_res_f_res_77315 = slt64(x_77299, (int64_t) 0);\n                y_77316 = defunc_0_neq_res_77313 && cond_t_res_f_res_77315;\n                cond_t_res_77317 = defunc_0_neq_res_77314 || y_77316;\n                x_77318 = cond_77312 && cond_t_res_77317;\n                if (x_77318) {\n                    defunc_0_op_res_77319 = (int64_t) -1;\n                    defunc_0_op_res_77320 = eta_p_77288;\n                    defunc_0_op_res_77321 = (int64_t) 0;\n                } else {\n                    int64_t x_77301;\n                    int64_t defunc_0_op_res_f_res_77322;\n                    double defunc_0_op_res_f_res_7",
                                    "7323;\n                    int64_t defunc_0_op_res_f_res_77324;\n                    \n                    x_77301 = ((__local int64_t *) color_78697)[i_77519];\n                    if (cond_77312) {\n                        defunc_0_op_res_f_res_77322 = x_77299;\n                        defunc_0_op_res_f_res_77323 = x_77300;\n                        defunc_0_op_res_f_res_77324 = x_77301;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_77325;\n                        int64_t defunc_0_op_res_f_res_f_res_77326;\n                        int64_t defunc_0_op_res_f_res_f_res_77327;\n                        \n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77325 = redout_77517;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77325 = eta_p_77288;\n                        }\n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77326 = redout_77516;\n                            defunc_0_op_res_f_res_f_res_77327 = redout_77518;\n                        } else {\n                            int64_t min_res_77328;\n                            int64_t tmp_77329;\n                            \n                            min_res_77328 = smin64(x_77299, redout_77516);\n                            tmp_77329 = add64(x_77301, redout_77518);\n                            defunc_0_op_res_f_res_f_res_77326 = min_res_77328;\n                            defunc_0_op_res_f_res_f_res_77327 = tmp_77329;\n                        }\n                        defunc_0_op_res_f_res_77322 = defunc_0_op_res_f_res_f_res_77326;\n                        defunc_0_op_res_f_res_77323 = defunc_0_op_res_f_res_f_res_77325;\n                        defunc_0_op_res_f_res_77324 = defunc_0_op_res_f_res_f_res_77327;\n                    }\n                    defunc_0_op_res_77319 = defunc_0_op_res_f_res_77322;\n                    defunc_0_op_res_77320 = defu", "nc_0_op_res_f_res_77323;\n                    defunc_0_op_res_77321 = defunc_0_op_res_f_res_77324;\n                }\n                redout_tmp_79007 = defunc_0_op_res_77319;\n                redout_tmp_79008 = defunc_0_op_res_77320;\n                redout_tmp_79009 = defunc_0_op_res_77321;\n                redout_77516 = redout_tmp_79007;\n                redout_77517 = redout_tmp_79008;\n                redout_77518 = redout_tmp_79009;\n            }\n            x_77296 = redout_77516;\n            x_77297 = redout_77517;\n            x_77298 = redout_77518;\n            acc_77293 = x_77296;\n            acc_77294 = x_77297;\n            acc_77295 = x_77298;\n        } else {\n            acc_77293 = acc_77289;\n            acc_77294 = acc_77290;\n            acc_77295 = acc_77291;\n        }\n        mem_77750[(int64_t) 0] = acc_77293;\n        mem_77754[(int64_t) 0] = acc_77294;\n        mem_77758[(int64_t) 0] = acc_77295;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_79001[i_6] = mem_77750[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_79002[i_7] = mem_77754[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_79003[i_8] = mem_77758[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77738[i_9] = mem_param_tmp_79001[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77739[i_10] = mem_param_tmp_79002[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77740[i_11] = mem_param_tmp_79003[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77761[i_12] = mem_param_77738[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77760[i_13] = mem_param_77739[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77759[i_14] = mem_param_77740[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77365) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n ", "           ext_mem_77777[i_15] = ext_mem_77761[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77776[i_16] = ext_mem_77759[i_16];\n    } else {\n        int64_t ltid_flat_77367;\n        int64_t ltid_77366;\n        int64_t j_77382;\n        bool cond_77386;\n        int64_t pre1d_77389;\n        int64_t pre1d_77387;\n        double pre1d_77388;\n        int64_t ltid_flat_77403;\n        int64_t ltid_77402;\n        int64_t gtid_77416;\n        int64_t acc_77418;\n        int64_t acc_77420;\n        bool cond_77421;\n        int64_t acc_77422;\n        int64_t acc_77424;\n        \n        ltid_flat_77367 = sext_i32_i64(local_tid_78992);\n        ltid_77366 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77382 = ltid_77366 + binop_x_77381;\n        cond_77386 = slt64(j_77382, j_m_i_67660);\n        pre1d_77389 = btoi_bool_i64(cond_77386);\n        if (cond_77386) {\n            int64_t tile_elem_77390;\n            int64_t slice_77490;\n            double tile_elem_77391;\n            \n            tile_elem_77390 = ((__global int64_t *) ext_mem_77720)[j_77382];\n            slice_77490 = slice_68069 + j_77382;\n            tile_elem_77391 = ((__global double *) tS_mem_77626)[slice_77490];\n            pre1d_77387 = tile_elem_77390;\n            pre1d_77388 = tile_elem_77391;\n        } else {\n            pre1d_77387 = (int64_t) 0;\n            pre1d_77388 = 0.0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77366] = pre1d_77387;\n        ((__local double *) color_78698)[ltid_77366] = pre1d_77388;\n        ((__local int64_t *) color_78697)[ltid_77366] = pre1d_77389;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77403 = sext_i32_i64(local_tid_78992);\n        ltid_77402 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77416 = binop_x_77132 + ltid_77402;\n        acc_77418 = ext_mem_77761[(int64_t) 0];\n        acc_77420 = ext_mem_77759[(int64_t) 0];\n        cond_77421 = slt64(gtid_77416, min_res_67698);\n        if (cond_77421) {\n         ",
                                    "   double eta_p_77417;\n            double acc_77419;\n            int64_t x_77425;\n            double x_77426;\n            int64_t x_77427;\n            int64_t redout_77520;\n            double redout_77521;\n            int64_t redout_77522;\n            \n            eta_p_77417 = mem_77725[(int64_t) 0];\n            acc_77419 = ext_mem_77760[(int64_t) 0];\n            redout_77520 = acc_77418;\n            redout_77521 = acc_77419;\n            redout_77522 = acc_77420;\n            for (int64_t i_77523 = 0; i_77523 < residual_input_77364; i_77523++) {\n                int64_t x_77428;\n                double x_77429;\n                bool defunc_0_neq_res_77437;\n                bool defunc_0_neq_res_77438;\n                bool cond_f_res_77439;\n                bool y_77440;\n                bool cond_77441;\n                bool defunc_0_neq_res_77442;\n                bool defunc_0_neq_res_77443;\n                bool cond_t_res_f_res_77444;\n                bool y_77445;\n                bool cond_t_res_77446;\n                bool x_77447;\n                int64_t defunc_0_op_res_77448;\n                double defunc_0_op_res_77449;\n                int64_t defunc_0_op_res_77450;\n                int64_t redout_tmp_79010;\n                double redout_tmp_79011;\n                int64_t redout_tmp_79012;\n                \n                x_77428 = ((__local int64_t *) color_78699)[i_77523];\n                x_77429 = ((__local double *) color_78698)[i_77523];\n                defunc_0_neq_res_77437 = redout_77521 == eta_p_77417;\n                defunc_0_neq_res_77438 = !defunc_0_neq_res_77437;\n                cond_f_res_77439 = slt64(redout_77520, (int64_t) 0);\n                y_77440 = defunc_0_neq_res_77437 && cond_f_res_77439;\n                cond_77441 = defunc_0_neq_res_77438 || y_77440;\n                defunc_0_neq_res_77442 = x_77429 == eta_p_77417;\n                defunc_0_neq_res_77443 = !defunc_0_neq_res_77442;\n                cond_t_res_f_res_77444 = slt64(x_77428, (int64_t) ", "0);\n                y_77445 = defunc_0_neq_res_77442 && cond_t_res_f_res_77444;\n                cond_t_res_77446 = defunc_0_neq_res_77443 || y_77445;\n                x_77447 = cond_77441 && cond_t_res_77446;\n                if (x_77447) {\n                    defunc_0_op_res_77448 = (int64_t) -1;\n                    defunc_0_op_res_77449 = eta_p_77417;\n                    defunc_0_op_res_77450 = (int64_t) 0;\n                } else {\n                    int64_t x_77430;\n                    int64_t defunc_0_op_res_f_res_77451;\n                    double defunc_0_op_res_f_res_77452;\n                    int64_t defunc_0_op_res_f_res_77453;\n                    \n                    x_77430 = ((__local int64_t *) color_78697)[i_77523];\n                    if (cond_77441) {\n                        defunc_0_op_res_f_res_77451 = x_77428;\n                        defunc_0_op_res_f_res_77452 = x_77429;\n                        defunc_0_op_res_f_res_77453 = x_77430;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_77454;\n                        int64_t defunc_0_op_res_f_res_f_res_77455;\n                        int64_t defunc_0_op_res_f_res_f_res_77456;\n                        \n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77454 = redout_77521;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77454 = eta_p_77417;\n                        }\n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77455 = redout_77520;\n                            defunc_0_op_res_f_res_f_res_77456 = redout_77522;\n                        } else {\n                            int64_t min_res_77457;\n                            int64_t tmp_77458;\n                            \n                            min_res_77457 = smin64(x_77428, redout_77520);\n                            tmp_77458 = add64(x_77430, redout_77522);\n          ", "                  defunc_0_op_res_f_res_f_res_77455 = min_res_77457;\n                            defunc_0_op_res_f_res_f_res_77456 = tmp_77458;\n                        }\n                        defunc_0_op_res_f_res_77451 = defunc_0_op_res_f_res_f_res_77455;\n                        defunc_0_op_res_f_res_77452 = defunc_0_op_res_f_res_f_res_77454;\n                        defunc_0_op_res_f_res_77453 = defunc_0_op_res_f_res_f_res_77456;\n                    }\n                    defunc_0_op_res_77448 = defunc_0_op_res_f_res_77451;\n                    defunc_0_op_res_77449 = defunc_0_op_res_f_res_77452;\n                    defunc_0_op_res_77450 = defunc_0_op_res_f_res_77453;\n                }\n                redout_tmp_79010 = defunc_0_op_res_77448;\n                redout_tmp_79011 = defunc_0_op_res_77449;\n                redout_tmp_79012 = defunc_0_op_res_77450;\n                redout_77520 = redout_tmp_79010;\n                redout_77521 = redout_tmp_79011;\n                redout_77522 = redout_tmp_79012;\n            }\n            x_77425 = redout_77520;\n            x_77426 = redout_77521;\n            x_77427 = redout_77522;\n            acc_77422 = x_77425;\n            acc_77424 = x_77427;\n        } else {\n            acc_77422 = acc_77418;\n            acc_77424 = acc_77420;\n        }\n        mem_77771[(int64_t) 0] = acc_77422;\n        mem_77775[(int64_t) 0] = acc_77424;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77777[i_17] = mem_77771[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77776[i_18] = mem_77775[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79013 = ext_mem_77777[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77779)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79013;\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + t",
                                    "ile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79014 = ext_mem_77776[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77781)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79014;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_77124\n    #undef bytes_77741\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegscan_75965_dim1, 1, 1)\nvoid inner_SMJ_doublezisegscan_75965(__global int *global_failure, int64_t nR_59382, int64_t num_tblocks_75962, int64_t num_virt_blocks_79082, int64_t num_virt_threads_79083, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *status_flags_mem_79084, __global unsigned char *aggregates_mem_79106, __global unsigned char *incprefixes_mem_79108, __global unsigned char *global_dynid_mem_79110)\n{\n    #define segscan_tblock_sizze_75960 (inner_SMJ_doublezisegscan_75965zisegscan_tblock_sizze_75960)\n    #define chunk_sizze_79081 (inner_SMJ_doublezisegscan_75965zichunk_sizze_79081)\n    \n    volatile __local unsigned char *local_mem_79140_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79140_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75960), chunk_sizze_79081 * segscan_tblock_sizze_75960 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75960), chunk_sizze_79081 * segscan_tblock_sizze_75960 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79133;\n    int32_t tblock_sizze_79136;\n    int32_t wave_sizze_79135;\n    int32_t block_id_79134;\n    int32_t global_tid_79132;\n    int64_t phys_tid_75965;\n    int32_t chunk_sizze_32b_79137;\n    int64_t byte_offsets_79138;\n    int64_t warp_byte_offset_79139;\n    __local unsigned char *local_mem_79140;\n    int64_t trans_arr_len_79141;\n    int64_t phys_block_id_79147;\n    in", "t64_t virtloop_bound_79148;\n    \n    local_tid_79133 = get_local_id(0);\n    tblock_sizze_79136 = get_local_size(0);\n    wave_sizze_79135 = LOCKSTEP_WIDTH;\n    block_id_79134 = get_tblock_id(0);\n    global_tid_79132 = block_id_79134 * tblock_sizze_79136 + local_tid_79133;\n    phys_tid_75965 = sext_i32_i64(global_tid_79132);\n    chunk_sizze_32b_79137 = sext_i64_i32(chunk_sizze_79081);\n    byte_offsets_79138 = segscan_tblock_sizze_75960 * (int64_t) 8;\n    warp_byte_offset_79139 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79140 = (__local unsigned char *) local_mem_79140_backing_0;\n    trans_arr_len_79141 = chunk_sizze_79081 * segscan_tblock_sizze_75960;\n    phys_block_id_79147 = get_tblock_id(0);\n    virtloop_bound_79148 = sdiv_up64(num_virt_blocks_79082 - phys_block_id_79147, num_tblocks_75962);\n    for (int64_t virtloop_i_79149 = 0; virtloop_i_79149 < virtloop_bound_79148; virtloop_i_79149++) {\n        int64_t dynamic_id_79150;\n        int64_t block_offset_79151;\n        int64_t sgm_idx_79152;\n        int32_t boundary_79153;\n        int32_t segsizze_compact_79154;\n        int64_t private_mem_79155[chunk_sizze_79081];\n        int64_t thd_offset_79157;\n        int64_t acc_79173;\n        int64_t prefix_79183;\n        bool block_new_sgm_79184;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79133 == 0) {\n                dynamic_id_79150 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79110)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 0] = dynamic_id_79150;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79150 == num_virt_blocks_79082 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79110)[(int64_t) 0] = 0;\n    ", "                }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79150 = ((__local int32_t *) local_mem_79140)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79151 = dynamic_id_79150 * chunk_sizze_79081 * segscan_tblock_sizze_75960;\n        sgm_idx_79152 = smod64(block_offset_79151, nR_59382);\n        boundary_79153 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_75960, nR_59382 - sgm_idx_79152));\n        segsizze_compact_79154 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_75960, nR_59382));\n        thd_offset_79157 = block_offset_79151 + sext_i32_i64(local_tid_79133);\n        // Load and map\n        {\n            for (int64_t i_79158 = 0; i_79158 < chunk_sizze_79081; i_79158++) {\n                int64_t virt_tid_79159 = thd_offset_79157 + i_79158 * segscan_tblock_sizze_75960;\n                int64_t slice_79160 = nR_59382;\n                int64_t gtid_75964 = virt_tid_79159;\n                int64_t remnant_79161 = virt_tid_79159 - gtid_75964;\n                \n                if (slt64(virt_tid_79159, nR_59382)) {\n                    int64_t eta_p_68120 = ((__global int64_t *) ext_mem_78096)[gtid_75964];\n                    bool lifted_lambda_res_68121 = slt64((int64_t) 0, eta_p_68120);\n                    int64_t defunc_0_f_res_68122 = btoi_bool_i64(lifted_lambda_res_68121);\n                    \n                    ((__global int64_t *) mem_78101)[gtid_75964] = defunc_0_f_res_68122;\n                    private_mem_79155[i_79158] = defunc_0_f_res_68122;\n                } else {\n                    private_mem_79155[i_79158] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79162 = 0; i_79162 < chunk_sizze_79081; i_79162++) {\n                int64_t sharedIdx_79163 = sext_i32_i64(local_tid_79133) + i_79162 * segscan_tblock_sizze_75960;\n          ",
                                    "      int64_t tmp_79164 = private_mem_79155[i_79162];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79163] = tmp_79164;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79165 = 0; i_79165 < chunk_sizze_79081; i_79165++) {\n                int64_t sharedIdx_79166 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79165;\n                int64_t tmp_79167 = ((__local int64_t *) local_mem_79140)[sharedIdx_79166];\n                \n                private_mem_79155[i_79165] = tmp_79167;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79168 = 0; i_79168 < chunk_sizze_79081 - (int64_t) 1; i_79168++) {\n                int64_t eta_p_67831;\n                int64_t eta_p_67832;\n                \n                eta_p_67831 = private_mem_79155[i_79168];\n                eta_p_67832 = private_mem_79155[i_79168 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_67833 = add64(eta_p_67831, eta_p_67832);\n                \n                private_mem_79155[i_79168 + (int64_t) 1] = defunc_0_op_res_67833;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79169 = private_mem_79155[chunk_sizze_79081 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = tmp_79169;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79170;\n            int64_t eta_p_79171;\n            int64_t eta_p_79174;\n            int64_t eta_p_79175;\n            bool ltid_in_bounds_79177 = slt64(sext_i32_i64(local_tid_79133), num_virt_threads_79083);\n            int32_t skip_threads_79178;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79177) {\n                    eta_p_79171 = ((volatile __local int64_t *) l", "ocal_mem_79140)[sext_i32_i64(local_tid_79133)];\n                    if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                        eta_p_79170 = eta_p_79171;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79178 = 1;\n                while (slt32(skip_threads_79178, 32)) {\n                    bool thread_active_79179 = sle32(skip_threads_79178, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && ltid_in_bounds_79177;\n                    \n                    if (thread_active_79179) {\n                        // read operands\n                        {\n                            eta_p_79170 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79178)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79179) {\n                            int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                            \n                            eta_p_79170 = defunc_0_op_res_79172;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79179) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79170;\n                            eta_p_79171 = eta_p_79170;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79178 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n  ", "          // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 31 && ltid_in_bounds_79177) {\n                    ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32))] = eta_p_79170;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79180;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                        eta_p_79175 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                        if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                            eta_p_79174 = eta_p_79175;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79180 = 1;\n                    while (slt32(skip_threads_79180, 32)) {\n                        bool thread_active_79181 = sle32(skip_threads_79180, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177);\n                        \n                        if (thread_active_79181) {\n                            // read operands\n                            {\n                                eta_p_79174 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79180)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79181) {\n                                int64_t defunc_0_op_res_79176 = add64(eta_p_79174, eta_p",
                                    "_79175);\n                                \n                                eta_p_79174 = defunc_0_op_res_79176;\n                            }\n                        }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79181) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79174;\n                                eta_p_79175 = eta_p_79174;\n                            }\n                        }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79180 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79182 = squot32(local_tid_79133, 32) == 0 || !ltid_in_bounds_79177;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79182) {\n                        eta_p_79171 = eta_p_79170;\n                        eta_p_79170 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79182) {\n                        int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                        \n                        eta_p_79170 = defunc_0_op_res_79172;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79182) {\n                        ((__local int64_t *) local_mem_79140)[sext_i32", "_i64(local_tid_79133)] = eta_p_79170;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                    ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79171;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79133 == 0) {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[segscan_tblock_sizze_75960 - (int64_t) 1];\n            } else {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79183 = (int64_t) 0;\n        block_new_sgm_79184 = sgm_idx_79152 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79184 && local_tid_79133 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = acc_79173;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                acc_79173 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79184 && slt32(local_tid_79133, wave_sizze_79135)) {\n                if (local_tid_79133 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79106)[dynamic_id_79150] = acc_79173;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 1;\n                    \n                    int8_t tmp_79185 = ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79140)[(int64_t) 0] = tmp_79185;\n                }\n  ", "              mem_fence_local();\n                \n                int8_t status_79186 = ((__local int8_t *) local_mem_79140)[(int64_t) 0];\n                \n                if (status_79186 == (int8_t) 2) {\n                    if (local_tid_79133 == 0) {\n                        prefix_79183 = ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79187 = sext_i64_i32(dynamic_id_79150 - sext_i32_i64(wave_sizze_79135));\n                    \n                    while (slt32(wave_sizze_79135 * -1, readOffset_79187)) {\n                        int32_t read_i_79188 = readOffset_79187 + local_tid_79133;\n                        int64_t aggr_79189 = (int64_t) 0;\n                        int8_t flag_79190 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79188)) {\n                            flag_79190 = ((volatile __global int8_t *) status_flags_mem_79084)[sext_i32_i64(read_i_79188)];\n                            if (flag_79190 == (int8_t) 2) {\n                                aggr_79189 = ((volatile __global int64_t *) incprefixes_mem_79108)[sext_i32_i64(read_i_79188)];\n                            } else if (flag_79190 == (int8_t) 1) {\n                                aggr_79189 = ((volatile __global int64_t *) aggregates_mem_79106)[sext_i32_i64(read_i_79188)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = aggr_79189;\n                        ((__local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flag_79190;\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        if (slt8(flag_79190, (int8_t) 2)) {\n                            int8_t flg_x_79194;\n                            int8_t flg_y_79195;\n                     ",
                                    "       int64_t eta_p_79191;\n                            int64_t eta_p_79192;\n                            int32_t skip_threads_79196;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79195 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                                eta_p_79192 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)];\n                                if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                                    eta_p_79191 = eta_p_79192;\n                                    flg_x_79194 = flg_y_79195;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79196 = 1;\n                                while (slt32(skip_threads_79196, 32)) {\n                                    if (sle32(skip_threads_79196, local_tid_79133 - squot32(local_tid_79133, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79194 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196)];\n                                            eta_p_79191 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79195 == (int8_t) 2 || flg_y_79195 == (int8_t) 0) {\n                                                flg_x_79194 = flg_y_79195;\n                                                eta_p_791", "91 = eta_p_79192;\n                                            } else {\n                                                int64_t defunc_0_op_res_79193 = add64(eta_p_79191, eta_p_79192);\n                                                \n                                                eta_p_79191 = defunc_0_op_res_79193;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flg_x_79194;\n                                            flg_y_79195 = flg_x_79194;\n                                            ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = eta_p_79191;\n                                            eta_p_79192 = eta_p_79191;\n                                        }\n                                    }\n                                    skip_threads_79196 *= 2;\n                                }\n                            }\n                        }\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        aggr_79189 = ((__local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79135) - (int64_t) 1)];\n                        if (flag_79190 == (int8_t) 2) {\n                            readOffset_79187 = wave_sizze_79135 * -1;\n                        } else if (flag_79190 == (int8_t) 1) {\n                            readOffset_79187 -= wave_sizze_79135;\n                        }\n                        if (slt8((int8_t) 0, flag_79190)) {\n                            int64_t eta_p_79197 = aggr_79189;\n                            int64_t eta_p_79198 = prefix_79183;\n                            int64_t defunc_0_op_res_79199 = add64(eta_p_79197, eta_p_79198);\n                 ", "           \n                            prefix_79183 = defunc_0_op_res_79199;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79133 == 0) {\n                    if (boundary_79153 == sext_i64_i32(segscan_tblock_sizze_75960 * chunk_sizze_79081)) {\n                        int64_t eta_p_79200 = prefix_79183;\n                        int64_t eta_p_79201 = acc_79173;\n                        int64_t defunc_0_op_res_79202 = add64(eta_p_79200, eta_p_79201);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = defunc_0_op_res_79202;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 4] = prefix_79183;\n                    acc_79173 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79150 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79183 = ((__local int64_t *) local_mem_79140)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79203;\n            int64_t eta_p_79204;\n            int64_t eta_p_79206 = prefix_79183;\n            int64_t eta_p_79207 = acc_79173;\n            \n            if (slt32(local_tid_79133 * chunk_sizze_32b_79137, boundary_79153) && !block_new_sgm_79184) {\n                int64_t defunc_0_op_res_79208 = add64(eta_p_79206, eta_p_79207);\n                \n                eta_p_79203 = defunc_0_op_res_79208;\n            } else {\n                eta_p_79203 = acc_79173;\n            }\n            \n            int32_t stopping_point_79209 = segsizze_compact_79154 - srem32(local_tid_79133 * chunk_sizze_32b_79137 - 1 + segsizze_compact_79154 - boundary_79153",
                                    ", segsizze_compact_79154);\n            \n            for (int64_t i_79210 = 0; i_79210 < chunk_sizze_79081; i_79210++) {\n                if (slt32(sext_i64_i32(i_79210), stopping_point_79209 - 1)) {\n                    eta_p_79204 = private_mem_79155[i_79210];\n                    \n                    int64_t defunc_0_op_res_79205 = add64(eta_p_79203, eta_p_79204);\n                    \n                    private_mem_79155[i_79210] = defunc_0_op_res_79205;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79211 = 0; i_79211 < chunk_sizze_79081; i_79211++) {\n                int64_t sharedIdx_79212 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79211;\n                int64_t tmp_79213 = private_mem_79155[i_79211];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79212] = tmp_79213;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79214 = 0; i_79214 < chunk_sizze_79081; i_79214++) {\n                int64_t flat_idx_79215 = thd_offset_79157 + i_79214 * segscan_tblock_sizze_75960;\n                int64_t slice_79216 = nR_59382;\n                int64_t gtid_75964 = flat_idx_79215;\n                int64_t remnant_79217 = flat_idx_79215 - gtid_75964;\n                \n                if (slt64(flat_idx_79215, nR_59382)) {\n                    int64_t tmp_79218 = ((__local int64_t *) local_mem_79140)[flat_idx_79215 - block_offset_79151];\n                    \n                    ((__global int64_t *) mem_78099)[gtid_75964] = tmp_79218;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75960\n    #undef chunk_sizze_79081\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegscan_75981_dim1, 1, 1)\nvoid inner_SMJ_doublezisegscan_75981(__global int *global_failure, int64_t m_67844, int64_t num_tblocks_75978, int", "64_t num_virt_blocks_79239, int64_t num_virt_threads_79240, __global unsigned char *mem_78103, __global unsigned char *mem_78113, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *status_flags_mem_79241, __global unsigned char *aggregates_mem_79243, __global unsigned char *incprefixes_mem_79245, __global unsigned char *aggregates_mem_79247, __global unsigned char *incprefixes_mem_79249, __global unsigned char *global_dynid_mem_79251)\n{\n    #define segscan_tblock_sizze_75976 (inner_SMJ_doublezisegscan_75981zisegscan_tblock_sizze_75976)\n    #define chunk_sizze_79238 (inner_SMJ_doublezisegscan_75981zichunk_sizze_79238)\n    \n    volatile __local unsigned char *local_mem_79263_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79263_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75976, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75976), smax64(chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75976, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75976), smax64(chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79254;\n    int32_t tblock_sizze_79257;\n    int32_t wave_sizze_79256;\n    int32_t block_id_79255;\n    int32_t global_tid_79253;\n    int64_t phys_tid_75981;\n    int32_t chunk_sizze_32b_79258;\n    int64_t byte_offsets_79259;\n    int64_t byte_offsets_79260;\n    int64_t warp_byte_offset_79261;\n    int64_t warp_byte_offset_79262;\n    __local unsigned char *local_mem_79263;\n    int64_t trans_arr_len_79264;\n    int64_t phys_block_id_79273;\n    int64_t virtloop_bound_79274;\n    \n    lo", "cal_tid_79254 = get_local_id(0);\n    tblock_sizze_79257 = get_local_size(0);\n    wave_sizze_79256 = LOCKSTEP_WIDTH;\n    block_id_79255 = get_tblock_id(0);\n    global_tid_79253 = block_id_79255 * tblock_sizze_79257 + local_tid_79254;\n    phys_tid_75981 = sext_i32_i64(global_tid_79253);\n    chunk_sizze_32b_79258 = sext_i64_i32(chunk_sizze_79238);\n    byte_offsets_79259 = segscan_tblock_sizze_75976 * (int64_t) 8;\n    byte_offsets_79260 = sdiv_up64(byte_offsets_79259, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_75976 * (int64_t) 8;\n    warp_byte_offset_79261 = (int64_t) 288;\n    warp_byte_offset_79262 = sdiv_up64(warp_byte_offset_79261, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79263 = (__local unsigned char *) local_mem_79263_backing_0;\n    trans_arr_len_79264 = chunk_sizze_79238 * segscan_tblock_sizze_75976;\n    phys_block_id_79273 = get_tblock_id(0);\n    virtloop_bound_79274 = sdiv_up64(num_virt_blocks_79239 - phys_block_id_79273, num_tblocks_75978);\n    for (int64_t virtloop_i_79275 = 0; virtloop_i_79275 < virtloop_bound_79274; virtloop_i_79275++) {\n        int64_t dynamic_id_79276;\n        int64_t block_offset_79277;\n        int64_t sgm_idx_79278;\n        int32_t boundary_79279;\n        int32_t segsizze_compact_79280;\n        int64_t private_mem_79281[chunk_sizze_79238];\n        int64_t private_mem_79283[chunk_sizze_79238];\n        int64_t thd_offset_79285;\n        int64_t acc_79311;\n        int64_t acc_79312;\n        int64_t prefix_79325;\n        int64_t prefix_79326;\n        bool block_new_sgm_79327;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79254 == 0) {\n                dynamic_id_79276 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79251)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 0] = dynam",
                                    "ic_id_79276;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79276 == num_virt_blocks_79239 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79251)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79276 = ((__local int32_t *) local_mem_79263)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79277 = dynamic_id_79276 * chunk_sizze_79238 * segscan_tblock_sizze_75976;\n        sgm_idx_79278 = smod64(block_offset_79277, m_67844);\n        boundary_79279 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_75976, m_67844 - sgm_idx_79278));\n        segsizze_compact_79280 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_75976, m_67844));\n        thd_offset_79285 = block_offset_79277 + sext_i32_i64(local_tid_79254);\n        // Load and map\n        {\n            for (int64_t i_79286 = 0; i_79286 < chunk_sizze_79238; i_79286++) {\n                int64_t virt_tid_79287 = thd_offset_79285 + i_79286 * segscan_tblock_sizze_75976;\n                int64_t slice_79288 = m_67844;\n                int64_t gtid_75980 = virt_tid_79287;\n                int64_t remnant_79289 = virt_tid_79287 - gtid_75980;\n                \n                if (slt64(virt_tid_79287, m_67844)) {\n                    int64_t x_68125 = ((__global int64_t *) mem_78103)[gtid_75980];\n                    bool lifted_lambda_res_68127 = slt64((int64_t) 1, x_68125);\n                    int64_t defunc_0_f_res_68128 = btoi_bool_i64(lifted_lambda_res_68127);\n                    \n                    ((__global int64_t *) mem_78117)[gtid_75980] = defunc_0_f_res_68128;\n                    private_mem_79281[i_79286] = x_68125;\n                    private_mem_79283[i_79286] = defunc_0_f_res_68128;\n                } else {\n                    private_mem_79281[i_7", "9286] = (int64_t) 0;\n                    private_mem_79283[i_79286] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79290 = 0; i_79290 < chunk_sizze_79238; i_79290++) {\n                int64_t sharedIdx_79291 = sext_i32_i64(local_tid_79254) + i_79290 * segscan_tblock_sizze_75976;\n                int64_t tmp_79292 = private_mem_79281[i_79290];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79291] = tmp_79292;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79293 = 0; i_79293 < chunk_sizze_79238; i_79293++) {\n                int64_t sharedIdx_79294 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79293;\n                int64_t tmp_79295 = ((__local int64_t *) local_mem_79263)[sharedIdx_79294];\n                \n                private_mem_79281[i_79293] = tmp_79295;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79296 = 0; i_79296 < chunk_sizze_79238; i_79296++) {\n                int64_t sharedIdx_79297 = sext_i32_i64(local_tid_79254) + i_79296 * segscan_tblock_sizze_75976;\n                int64_t tmp_79298 = private_mem_79283[i_79296];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79297] = tmp_79298;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79299 = 0; i_79299 < chunk_sizze_79238; i_79299++) {\n                int64_t sharedIdx_79300 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79299;\n                int64_t tmp_79301 = ((__local int64_t *) local_mem_79263)[sharedIdx_79300];\n                \n                private_mem_79283[i_79299] = tmp_79301;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79302 = 0; i_79302 < chunk_sizze_79238 - (int64_t) 1; i_79302++) {\n                int", "64_t eta_p_67881;\n                int64_t eta_p_67882;\n                \n                eta_p_67881 = private_mem_79281[i_79302];\n                eta_p_67882 = private_mem_79281[i_79302 + (int64_t) 1];\n                \n                int64_t eta_p_67974;\n                int64_t eta_p_67975;\n                \n                eta_p_67974 = private_mem_79283[i_79302];\n                eta_p_67975 = private_mem_79283[i_79302 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_67883 = add64(eta_p_67881, eta_p_67882);\n                int64_t defunc_0_op_res_67976 = add64(eta_p_67974, eta_p_67975);\n                \n                private_mem_79281[i_79302 + (int64_t) 1] = lifted_lambda_res_67883;\n                private_mem_79283[i_79302 + (int64_t) 1] = defunc_0_op_res_67976;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79303 = private_mem_79281[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = tmp_79303;\n            \n            int64_t tmp_79304 = private_mem_79283[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = tmp_79304;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79305;\n            int64_t eta_p_79306;\n            int64_t eta_p_79307;\n            int64_t eta_p_79308;\n            int64_t eta_p_79313;\n            int64_t eta_p_79314;\n            int64_t eta_p_79315;\n            int64_t eta_p_79316;\n            bool ltid_in_bounds_79319 = slt64(sext_i32_i64(local_tid_79254), num_virt_threads_79240);\n            int32_t skip_threads_79320;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79319) {\n                    eta_p_79307 = ((volatile __local int",
                                    "64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                    eta_p_79308 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                    if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                        eta_p_79305 = eta_p_79307;\n                        eta_p_79306 = eta_p_79308;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79320 = 1;\n                while (slt32(skip_threads_79320, 32)) {\n                    bool thread_active_79321 = sle32(skip_threads_79320, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && ltid_in_bounds_79319;\n                    \n                    if (thread_active_79321) {\n                        // read operands\n                        {\n                            eta_p_79305 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320)];\n                            eta_p_79306 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79321) {\n                            int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                            int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                            \n                            eta_p_79305 = lifted_lambda_res_79309;\n                            eta_p_79306 = defunc_0_op_res_79310;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (th", "read_active_79321) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                            eta_p_79307 = eta_p_79305;\n                            ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                            eta_p_79308 = eta_p_79306;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79320 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 31 && ltid_in_bounds_79319) {\n                    ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79305;\n                    ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79306;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79322;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                        eta_p_79315 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                        eta_p_79316 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                        if ((local_tid_79254 ", "- squot32(local_tid_79254, 32) * 32) == 0) {\n                            eta_p_79313 = eta_p_79315;\n                            eta_p_79314 = eta_p_79316;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79322 = 1;\n                    while (slt32(skip_threads_79322, 32)) {\n                        bool thread_active_79323 = sle32(skip_threads_79322, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319);\n                        \n                        if (thread_active_79323) {\n                            // read operands\n                            {\n                                eta_p_79313 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322)];\n                                eta_p_79314 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79323) {\n                                int64_t lifted_lambda_res_79317 = add64(eta_p_79313, eta_p_79315);\n                                int64_t defunc_0_op_res_79318 = add64(eta_p_79314, eta_p_79316);\n                                \n                                eta_p_79313 = lifted_lambda_res_79317;\n                                eta_p_79314 = defunc_0_op_res_79318;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79323) {\n                            // write result\n                      ",
                                    "      {\n                                ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79313;\n                                eta_p_79315 = eta_p_79313;\n                                ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79314;\n                                eta_p_79316 = eta_p_79314;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79322 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79324 = squot32(local_tid_79254, 32) == 0 || !ltid_in_bounds_79319;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79324) {\n                        eta_p_79307 = eta_p_79305;\n                        eta_p_79308 = eta_p_79306;\n                        eta_p_79305 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1];\n                        eta_p_79306 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79324) {\n                        int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                        int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                        \n                        eta_p_79305 = lifted_lambda_res_79309;\n                        eta_p_79306 = defunc_0_op_res_79310;\n                    }\n                }\n   ", "             // write final result\n                {\n                    if (!no_carry_in_79324) {\n                        ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                        ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                    ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79307;\n                    ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79308;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79254 == 0) {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[segscan_tblock_sizze_75976 - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (segscan_tblock_sizze_75976 - (int64_t) 1)];\n            } else {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79325 = (int64_t) 0;\n        prefix_79326 = (int64_t) 0;\n        block_new_sgm_79327 = sgm_idx_79278 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79327 && local_tid_79254 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = acc_79311;\n                ((volatile __global i", "nt64_t *) incprefixes_mem_79249)[dynamic_id_79276] = acc_79312;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                acc_79311 = (int64_t) 0;\n                acc_79312 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79327 && slt32(local_tid_79254, wave_sizze_79256)) {\n                if (local_tid_79254 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79243)[dynamic_id_79276] = acc_79311;\n                    ((volatile __global int64_t *) aggregates_mem_79247)[dynamic_id_79276] = acc_79312;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 1;\n                    \n                    int8_t tmp_79328 = ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79263)[(int64_t) 0] = tmp_79328;\n                }\n                mem_fence_local();\n                \n                int8_t status_79329 = ((__local int8_t *) local_mem_79263)[(int64_t) 0];\n                \n                if (status_79329 == (int8_t) 2) {\n                    if (local_tid_79254 == 0) {\n                        prefix_79325 = ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276 - (int64_t) 1];\n                        prefix_79326 = ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79330 = sext_i64_i32(dynamic_id_79276 - sext_i32_i64(wave_sizze_79256));\n                    \n                    while (slt32(wave_sizze_79256 * -1, readOffset_79330)) {\n                        int32_t read_i_79331 = readOffset_79330 + local_tid_79254;\n                        int64_t aggr_79332 = (int64_t) 0;\n                        int64_t aggr",
                                    "_79333 = (int64_t) 0;\n                        int8_t flag_79334 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79331)) {\n                            flag_79334 = ((volatile __global int8_t *) status_flags_mem_79241)[sext_i32_i64(read_i_79331)];\n                            if (flag_79334 == (int8_t) 2) {\n                                aggr_79332 = ((volatile __global int64_t *) incprefixes_mem_79245)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) incprefixes_mem_79249)[sext_i32_i64(read_i_79331)];\n                            } else if (flag_79334 == (int8_t) 1) {\n                                aggr_79332 = ((volatile __global int64_t *) aggregates_mem_79243)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) aggregates_mem_79247)[sext_i32_i64(read_i_79331)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = aggr_79332;\n                        ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = aggr_79333;\n                        ((__local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flag_79334;\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze_79256) - (int64_t) 1];\n                        if (slt8(flag_79334, (int8_t) 2)) {\n                            int8_t flg_x_79341;\n                            int8_t flg_y_79342;\n                            int64_t eta_p_79335;\n                            int64_t eta_p_79336;\n                            int64_t eta_p_79337;\n                            int64_t eta_p_79338;\n                            int32_t skip_threads_79343;\n                            \n                            // read input for in-block scan\n                           ", " {\n                                flg_y_79342 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                                eta_p_79337 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)];\n                                eta_p_79338 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                                    eta_p_79335 = eta_p_79337;\n                                    eta_p_79336 = eta_p_79338;\n                                    flg_x_79341 = flg_y_79342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79343 = 1;\n                                while (slt32(skip_threads_79343, 32)) {\n                                    if (sle32(skip_threads_79343, local_tid_79254 - squot32(local_tid_79254, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79341 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343)];\n                                            eta_p_79335 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                            eta_p_79336 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                        }\n                                        // perform operation\n                                        {\n                               ", "             if (flg_y_79342 == (int8_t) 2 || flg_y_79342 == (int8_t) 0) {\n                                                flg_x_79341 = flg_y_79342;\n                                                eta_p_79335 = eta_p_79337;\n                                                eta_p_79336 = eta_p_79338;\n                                            } else {\n                                                int64_t lifted_lambda_res_79339 = add64(eta_p_79335, eta_p_79337);\n                                                int64_t defunc_0_op_res_79340 = add64(eta_p_79336, eta_p_79338);\n                                                \n                                                eta_p_79335 = lifted_lambda_res_79339;\n                                                eta_p_79336 = defunc_0_op_res_79340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flg_x_79341;\n                                            flg_y_79342 = flg_x_79341;\n                                            ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = eta_p_79335;\n                                            eta_p_79337 = eta_p_79335;\n                                            ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79336;\n                                            eta_p_79338 = eta_p_79336;\n                                        }\n                                    }\n                                    skip_threads_79343 *= 2;\n                                }\n                            }\n                        }\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze",
                                    "_79256) - (int64_t) 1];\n                        aggr_79332 = ((__local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79256) - (int64_t) 1)];\n                        aggr_79333 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(wave_sizze_79256) - (int64_t) 1)];\n                        if (flag_79334 == (int8_t) 2) {\n                            readOffset_79330 = wave_sizze_79256 * -1;\n                        } else if (flag_79334 == (int8_t) 1) {\n                            readOffset_79330 -= wave_sizze_79256;\n                        }\n                        if (slt8((int8_t) 0, flag_79334)) {\n                            int64_t eta_p_79344 = aggr_79332;\n                            int64_t eta_p_79345 = aggr_79333;\n                            int64_t eta_p_79346 = prefix_79325;\n                            int64_t eta_p_79347 = prefix_79326;\n                            int64_t lifted_lambda_res_79348 = add64(eta_p_79344, eta_p_79346);\n                            int64_t defunc_0_op_res_79349 = add64(eta_p_79345, eta_p_79347);\n                            \n                            prefix_79325 = lifted_lambda_res_79348;\n                            prefix_79326 = defunc_0_op_res_79349;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79254 == 0) {\n                    if (boundary_79279 == sext_i64_i32(segscan_tblock_sizze_75976 * chunk_sizze_79238)) {\n                        int64_t eta_p_79350 = prefix_79325;\n                        int64_t eta_p_79351 = prefix_79326;\n                        int64_t eta_p_79352 = acc_79311;\n                        int64_t eta_p_79353 = acc_79312;\n                        int64_t lifted_lambda_res_79354 = add64(eta_p_79350, eta_p_79352);\n                        int64_t defunc_0_op_res_79355 = add64(eta_p_79351, eta_p_79353);\n                        \n                        (", "(volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = lifted_lambda_res_79354;\n                        ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276] = defunc_0_op_res_79355;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 4] = prefix_79325;\n                    ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8)] = prefix_79326;\n                    acc_79311 = (int64_t) 0;\n                    acc_79312 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79276 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79325 = ((__local int64_t *) local_mem_79263)[(int64_t) 4];\n                prefix_79326 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79356;\n            int64_t eta_p_79358;\n            int64_t eta_p_79362 = prefix_79325;\n            int64_t eta_p_79364 = acc_79311;\n            int64_t eta_p_79357;\n            int64_t eta_p_79359;\n            int64_t eta_p_79363 = prefix_79326;\n            int64_t eta_p_79365 = acc_79312;\n            \n            if (slt32(local_tid_79254 * chunk_sizze_32b_79258, boundary_79279) && !block_new_sgm_79327) {\n                int64_t lifted_lambda_res_79366 = add64(eta_p_79362, eta_p_79364);\n                int64_t defunc_0_op_res_79367 = add64(eta_p_79363, eta_p_79365);\n                \n                eta_p_79356 = lifted_lambda_res_79366;\n                eta_p_79357 = defunc_0_op_res_79367;\n            } else {\n                eta_p_79356 = acc_79311;\n                eta_p_79357 = acc_79312;\n            }\n            \n           ", " int32_t stopping_point_79368 = segsizze_compact_79280 - srem32(local_tid_79254 * chunk_sizze_32b_79258 - 1 + segsizze_compact_79280 - boundary_79279, segsizze_compact_79280);\n            \n            for (int64_t i_79369 = 0; i_79369 < chunk_sizze_79238; i_79369++) {\n                if (slt32(sext_i64_i32(i_79369), stopping_point_79368 - 1)) {\n                    eta_p_79358 = private_mem_79281[i_79369];\n                    eta_p_79359 = private_mem_79283[i_79369];\n                    \n                    int64_t lifted_lambda_res_79360 = add64(eta_p_79356, eta_p_79358);\n                    int64_t defunc_0_op_res_79361 = add64(eta_p_79357, eta_p_79359);\n                    \n                    private_mem_79281[i_79369] = lifted_lambda_res_79360;\n                    private_mem_79283[i_79369] = defunc_0_op_res_79361;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79370 = 0; i_79370 < chunk_sizze_79238; i_79370++) {\n                int64_t sharedIdx_79371 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79370;\n                int64_t tmp_79372 = private_mem_79281[i_79370];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79371] = tmp_79372;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79373 = 0; i_79373 < chunk_sizze_79238; i_79373++) {\n                int64_t flat_idx_79374 = thd_offset_79285 + i_79373 * segscan_tblock_sizze_75976;\n                int64_t slice_79375 = m_67844;\n                int64_t gtid_75980 = flat_idx_79374;\n                int64_t remnant_79376 = flat_idx_79374 - gtid_75980;\n                \n                if (slt64(flat_idx_79374, m_67844)) {\n                    int64_t tmp_79377 = ((__local int64_t *) local_mem_79263)[flat_idx_79374 - block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78113)[gtid_75980] = tmp_793",
                                    "77;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79378 = 0; i_79378 < chunk_sizze_79238; i_79378++) {\n                int64_t sharedIdx_79379 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79378;\n                int64_t tmp_79380 = private_mem_79283[i_79378];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79379] = tmp_79380;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79381 = 0; i_79381 < chunk_sizze_79238; i_79381++) {\n                int64_t flat_idx_79382 = thd_offset_79285 + i_79381 * segscan_tblock_sizze_75976;\n                int64_t slice_79383 = m_67844;\n                int64_t gtid_75980 = flat_idx_79382;\n                int64_t remnant_79384 = flat_idx_79382 - gtid_75980;\n                \n                if (slt64(flat_idx_79382, m_67844)) {\n                    int64_t tmp_79385 = ((__local int64_t *) local_mem_79263)[flat_idx_79382 - block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78115)[gtid_75980] = tmp_79385;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75976\n    #undef chunk_sizze_79238\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78724_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78724(__global int *global_failure, int64_t gt_rhs_66981, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77633)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78726;\n    int32_t tblock_sizze_78729;\n    int32_t wave_sizze_78728;\n    int32_t block_id_78727;\n    int32_t global_tid_78725;\n    int64_t tid_78724;\n    float x_77524;\n    \n    local_tid_78726 = get_local_id(0);\n    tblock_sizze_78729 = get_local_size(0);\n    wave_sizze_78728 = LOCKSTEP_WIDTH;\n    block_id_78727 = get_tblock_id(0);\n    global_tid_78725 = block_id_78727 * tblock_sizze_78729 + loca", "l_tid_78726;\n    tid_78724 = sext_i32_i64(global_tid_78725);\n    x_77524 = ((__global float *) tR_mem_77625)[gt_rhs_66981];\n    ((__global float *) mem_77633)[(int64_t) 0] = x_77524;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78756_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78756(__global int *global_failure, int64_t tS_start_66998, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77634, __global unsigned char *mem_77641, __global unsigned char *mem_77642)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78758;\n    int32_t tblock_sizze_78761;\n    int32_t wave_sizze_78760;\n    int32_t block_id_78759;\n    int32_t global_tid_78757;\n    int64_t tid_78756;\n    float gt_lhs_77528;\n    float gt_rhs_77530;\n    bool defunc_0_gt_res_77532;\n    \n    local_tid_78758 = get_local_id(0);\n    tblock_sizze_78761 = get_local_size(0);\n    wave_sizze_78760 = LOCKSTEP_WIDTH;\n    block_id_78759 = get_tblock_id(0);\n    global_tid_78757 = block_id_78759 * tblock_sizze_78761 + local_tid_78758;\n    tid_78756 = sext_i32_i64(global_tid_78757);\n    gt_lhs_77528 = ((__global float *) tS_mem_77626)[tS_start_66998];\n    gt_rhs_77530 = ((__global float *) ext_mem_77634)[(int64_t) 0];\n    defunc_0_gt_res_77532 = gt_rhs_77530 < gt_lhs_77528;\n    ((__global float *) mem_77641)[(int64_t) 0] = gt_lhs_77528;\n    ((__global bool *) mem_77642)[(int64_t) 0] = defunc_0_gt_res_77532;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78762_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78762(__global int *global_failure, int64_t i_p_m_t_s_67004, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77908)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78764;\n    int32_t tblock_sizze_78767;\n    int32_t wave_sizze_78766;\n    int32_t block_id_78765;\n    int32_t global_tid_78763;\n    int64_t tid_78762;\n    float x_77534;\n    \n    local_tid_78764 = get_local_id(0);\n    tblock_sizze", "_78767 = get_local_size(0);\n    wave_sizze_78766 = LOCKSTEP_WIDTH;\n    block_id_78765 = get_tblock_id(0);\n    global_tid_78763 = block_id_78765 * tblock_sizze_78767 + local_tid_78764;\n    tid_78762 = sext_i32_i64(global_tid_78763);\n    x_77534 = ((__global float *) tS_mem_77626)[i_p_m_t_s_67004];\n    ((__global float *) mem_77908)[(int64_t) 0] = x_77534;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78778_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78778(__global int *global_failure, int64_t start_68558, int64_t i_p_m_t_s_68564, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77916, __global unsigned char *mem_77917)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78780;\n    int32_t tblock_sizze_78783;\n    int32_t wave_sizze_78782;\n    int32_t block_id_78781;\n    int32_t global_tid_78779;\n    int64_t tid_78778;\n    float r_max_77538;\n    float r_min_77541;\n    \n    local_tid_78780 = get_local_id(0);\n    tblock_sizze_78783 = get_local_size(0);\n    wave_sizze_78782 = LOCKSTEP_WIDTH;\n    block_id_78781 = get_tblock_id(0);\n    global_tid_78779 = block_id_78781 * tblock_sizze_78783 + local_tid_78780;\n    tid_78778 = sext_i32_i64(global_tid_78779);\n    r_max_77538 = ((__global float *) tR_mem_77625)[i_p_m_t_s_68564];\n    r_min_77541 = ((__global float *) tR_mem_77625)[start_68558];\n    ((__global float *) mem_77916)[(int64_t) 0] = r_max_77538;\n    ((__global float *) mem_77917)[(int64_t) 0] = r_min_77541;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78784_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78784(__global int *global_failure, __global unsigned char *mem_77917, __global unsigned char *ext_mem_77918, __global unsigned char *mem_77920)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78786;\n    int32_t tblock_sizze_78789;\n    int32_t wave_sizze_78788;\n    int32_t block_id_78787;\n    int32_t global_tid_78785;\n    int64_t tid_78784;\n    float s_ma",
                                    "x_77543;\n    float r_min_77544;\n    bool defunc_0_gt_res_77545;\n    \n    local_tid_78786 = get_local_id(0);\n    tblock_sizze_78789 = get_local_size(0);\n    wave_sizze_78788 = LOCKSTEP_WIDTH;\n    block_id_78787 = get_tblock_id(0);\n    global_tid_78785 = block_id_78787 * tblock_sizze_78789 + local_tid_78786;\n    tid_78784 = sext_i32_i64(global_tid_78785);\n    s_max_77543 = ((__global float *) ext_mem_77918)[(int64_t) 0];\n    r_min_77544 = ((__global float *) mem_77917)[(int64_t) 0];\n    defunc_0_gt_res_77545 = s_max_77543 < r_min_77544;\n    ((__global bool *) mem_77920)[(int64_t) 0] = defunc_0_gt_res_77545;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78790_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78790(__global int *global_failure, __global unsigned char *mem_77916, __global unsigned char *ext_mem_77919, __global unsigned char *mem_77921)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78792;\n    int32_t tblock_sizze_78795;\n    int32_t wave_sizze_78794;\n    int32_t block_id_78793;\n    int32_t global_tid_78791;\n    int64_t tid_78790;\n    float r_max_77548;\n    float s_min_77549;\n    bool defunc_0_gt_res_77550;\n    \n    local_tid_78792 = get_local_id(0);\n    tblock_sizze_78795 = get_local_size(0);\n    wave_sizze_78794 = LOCKSTEP_WIDTH;\n    block_id_78793 = get_tblock_id(0);\n    global_tid_78791 = block_id_78793 * tblock_sizze_78795 + local_tid_78792;\n    tid_78790 = sext_i32_i64(global_tid_78791);\n    r_max_77548 = ((__global float *) mem_77916)[(int64_t) 0];\n    s_min_77549 = ((__global float *) ext_mem_77919)[(int64_t) 0];\n    defunc_0_gt_res_77550 = r_max_77548 < s_min_77549;\n    ((__global bool *) mem_77921)[(int64_t) 0] = defunc_0_gt_res_77550;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78849_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78849(__global int *global_failure, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77648)\n{\n    if (*global_failure >= 0)\n     ", "   return;\n    \n    int32_t local_tid_78851;\n    int32_t tblock_sizze_78854;\n    int32_t wave_sizze_78853;\n    int32_t block_id_78852;\n    int32_t global_tid_78850;\n    int64_t tid_78849;\n    float x_77552;\n    \n    local_tid_78851 = get_local_id(0);\n    tblock_sizze_78854 = get_local_size(0);\n    wave_sizze_78853 = LOCKSTEP_WIDTH;\n    block_id_78852 = get_tblock_id(0);\n    global_tid_78850 = block_id_78852 * tblock_sizze_78854 + local_tid_78851;\n    tid_78849 = sext_i32_i64(global_tid_78850);\n    x_77552 = ((__global float *) tR_mem_77625)[(int64_t) 0];\n    ((__global float *) mem_77648)[(int64_t) 0] = x_77552;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78855_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78855(__global int *global_failure, __global unsigned char *mem_77641, __global unsigned char *ext_mem_77649, __global unsigned char *mem_77650)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78857;\n    int32_t tblock_sizze_78860;\n    int32_t wave_sizze_78859;\n    int32_t block_id_78858;\n    int32_t global_tid_78856;\n    int64_t tid_78855;\n    float leq_lhs_77556;\n    float gt_lhs_77557;\n    bool defunc_0_leq_res_77558;\n    \n    local_tid_78857 = get_local_id(0);\n    tblock_sizze_78860 = get_local_size(0);\n    wave_sizze_78859 = LOCKSTEP_WIDTH;\n    block_id_78858 = get_tblock_id(0);\n    global_tid_78856 = block_id_78858 * tblock_sizze_78860 + local_tid_78857;\n    tid_78855 = sext_i32_i64(global_tid_78856);\n    leq_lhs_77556 = ((__global float *) ext_mem_77649)[(int64_t) 0];\n    gt_lhs_77557 = ((__global float *) mem_77641)[(int64_t) 0];\n    defunc_0_leq_res_77558 = leq_lhs_77556 <= gt_lhs_77557;\n    ((__global bool *) mem_77650)[(int64_t) 0] = defunc_0_leq_res_77558;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78861_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78861(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_54353, unsigne", "d char y_67146_bits, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77641, __global unsigned char *mem_77650, __global unsigned char *mem_77652)\n{\n    bool y_67146 = y_67146_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78863;\n    int32_t tblock_sizze_78866;\n    int32_t wave_sizze_78865;\n    int32_t block_id_78864;\n    int32_t global_tid_78862;\n    int64_t tid_78861;\n    bool defunc_0_leq_res_77560;\n    float x_77565;\n    \n    local_tid_78863 = get_local_id(0);\n    tblock_sizze_78866 = get_local_size(0);\n    wave_sizze_78865 = LOCKSTEP_WIDTH;\n    block_id_78864 = get_tblock_id(0);\n    global_tid_78862 = block_id_78864 * tblock_sizze_78866 + local_tid_78863;\n    tid_78861 = sext_i32_i64(global_tid_78862);\n    defunc_0_leq_res_77560 = ((__global bool *) mem_77650)[(int64_t) 0];\n    if (defunc_0_leq_res_77560) {\n        bool index_certs_77561;\n        float lowest_t_res_77562;\n        \n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 42) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_54353;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_77562 = ((__global float *) tR_mem_77625)[(int64_t) 0];\n        x_77565 = lowest_t_res_77562;\n    } else {\n        float gt_lhs_77564;\n        bool index_certs_77563;\n        \n        gt_lhs_77564 = ((__global float *) mem_77641)[(int64_t) 0];\n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 43) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_54353;\n                    ;\n                }\n                return;\n            }\n        }\n        x_77565 = gt_lhs_77564;\n    }\n    ((__global float *) mem_77652)[(int64_t) 0] = x_77565;\n    \n  er",
                                    "ror_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78923_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78923(__global int *global_failure, int64_t slice_68069, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77700)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78925;\n    int32_t tblock_sizze_78928;\n    int32_t wave_sizze_78927;\n    int32_t block_id_78926;\n    int32_t global_tid_78924;\n    int64_t tid_78923;\n    float x_77570;\n    \n    local_tid_78925 = get_local_id(0);\n    tblock_sizze_78928 = get_local_size(0);\n    wave_sizze_78927 = LOCKSTEP_WIDTH;\n    block_id_78926 = get_tblock_id(0);\n    global_tid_78924 = block_id_78926 * tblock_sizze_78928 + local_tid_78925;\n    tid_78923 = sext_i32_i64(global_tid_78924);\n    x_77570 = ((__global float *) tS_mem_77626)[slice_68069];\n    ((__global float *) mem_77700)[(int64_t) 0] = x_77570;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78929_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78929(__global int *global_failure, int64_t slice_68867, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77703)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78931;\n    int32_t tblock_sizze_78934;\n    int32_t wave_sizze_78933;\n    int32_t block_id_78932;\n    int32_t global_tid_78930;\n    int64_t tid_78929;\n    float x_77574;\n    \n    local_tid_78931 = get_local_id(0);\n    tblock_sizze_78934 = get_local_size(0);\n    wave_sizze_78933 = LOCKSTEP_WIDTH;\n    block_id_78932 = get_tblock_id(0);\n    global_tid_78930 = block_id_78932 * tblock_sizze_78934 + local_tid_78931;\n    tid_78929 = sext_i32_i64(global_tid_78930);\n    x_77574 = ((__global float *) tS_mem_77626)[slice_68867];\n    ((__global float *) mem_77703)[(int64_t) 0] = x_77574;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78945_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78945(__global int *global_failure, int64_t slice_67712, int64_t slic", "e_67721, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77711, __global unsigned char *mem_77712)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78947;\n    int32_t tblock_sizze_78950;\n    int32_t wave_sizze_78949;\n    int32_t block_id_78948;\n    int32_t global_tid_78946;\n    int64_t tid_78945;\n    float r_max_77578;\n    float r_min_77581;\n    \n    local_tid_78947 = get_local_id(0);\n    tblock_sizze_78950 = get_local_size(0);\n    wave_sizze_78949 = LOCKSTEP_WIDTH;\n    block_id_78948 = get_tblock_id(0);\n    global_tid_78946 = block_id_78948 * tblock_sizze_78950 + local_tid_78947;\n    tid_78945 = sext_i32_i64(global_tid_78946);\n    r_max_77578 = ((__global float *) tR_mem_77625)[slice_67721];\n    r_min_77581 = ((__global float *) tR_mem_77625)[slice_67712];\n    ((__global float *) mem_77711)[(int64_t) 0] = r_max_77578;\n    ((__global float *) mem_77712)[(int64_t) 0] = r_min_77581;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78951_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78951(__global int *global_failure, __global unsigned char *mem_77712, __global unsigned char *ext_mem_77713, __global unsigned char *mem_77715)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78953;\n    int32_t tblock_sizze_78956;\n    int32_t wave_sizze_78955;\n    int32_t block_id_78954;\n    int32_t global_tid_78952;\n    int64_t tid_78951;\n    float s_max_77583;\n    float r_min_77584;\n    bool defunc_0_gt_res_77585;\n    \n    local_tid_78953 = get_local_id(0);\n    tblock_sizze_78956 = get_local_size(0);\n    wave_sizze_78955 = LOCKSTEP_WIDTH;\n    block_id_78954 = get_tblock_id(0);\n    global_tid_78952 = block_id_78954 * tblock_sizze_78956 + local_tid_78953;\n    tid_78951 = sext_i32_i64(global_tid_78952);\n    s_max_77583 = ((__global float *) ext_mem_77713)[(int64_t) 0];\n    r_min_77584 = ((__global float *) mem_77712)[(int64_t) 0];\n    defunc_0_gt_res_77585 = s_max_77583 < r_min_77584;\n    ((__global ", "bool *) mem_77715)[(int64_t) 0] = defunc_0_gt_res_77585;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_78957_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_78957(__global int *global_failure, __global unsigned char *mem_77711, __global unsigned char *ext_mem_77714, __global unsigned char *mem_77716)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78959;\n    int32_t tblock_sizze_78962;\n    int32_t wave_sizze_78961;\n    int32_t block_id_78960;\n    int32_t global_tid_78958;\n    int64_t tid_78957;\n    float r_max_77588;\n    float s_min_77589;\n    bool defunc_0_gt_res_77590;\n    \n    local_tid_78959 = get_local_id(0);\n    tblock_sizze_78962 = get_local_size(0);\n    wave_sizze_78961 = LOCKSTEP_WIDTH;\n    block_id_78960 = get_tblock_id(0);\n    global_tid_78958 = block_id_78960 * tblock_sizze_78962 + local_tid_78959;\n    tid_78957 = sext_i32_i64(global_tid_78958);\n    r_max_77588 = ((__global float *) mem_77711)[(int64_t) 0];\n    s_min_77589 = ((__global float *) ext_mem_77714)[(int64_t) 0];\n    defunc_0_gt_res_77590 = r_max_77588 < s_min_77589;\n    ((__global bool *) mem_77716)[(int64_t) 0] = defunc_0_gt_res_77590;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_79070_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_79070(__global int *global_failure, int64_t gt_rhs_66981, int64_t i_p_m_t_s_67004, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_78084)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79072;\n    int32_t tblock_sizze_79075;\n    int32_t wave_sizze_79074;\n    int32_t block_id_79073;\n    int32_t global_tid_79071;\n    int64_t tid_79070;\n    float leq_lhs_77592;\n    float leq_rhs_77594;\n    bool defunc_0_leq_res_77598;\n    \n    local_tid_79072 = get_local_id(0);\n    tblock_sizze_79075 = get_local_size(0);\n    wave_sizze_79074 = LOCKSTEP_WIDTH;\n    block_id_79073 = get_tblock_id(0);\n    global_tid_79071 = block_id_79",
                                    "073 * tblock_sizze_79075 + local_tid_79072;\n    tid_79070 = sext_i32_i64(global_tid_79071);\n    leq_lhs_77592 = ((__global float *) tS_mem_77626)[i_p_m_t_s_67004];\n    leq_rhs_77594 = ((__global float *) tR_mem_77625)[gt_rhs_66981];\n    defunc_0_leq_res_77598 = leq_lhs_77592 <= leq_rhs_77594;\n    ((__global bool *) mem_78084)[(int64_t) 0] = defunc_0_leq_res_77598;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_79395_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_79395(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78120, __global unsigned char *mem_78122)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79397;\n    int32_t tblock_sizze_79400;\n    int32_t wave_sizze_79399;\n    int32_t block_id_79398;\n    int32_t global_tid_79396;\n    int64_t tid_79395;\n    int64_t x_77600;\n    \n    local_tid_79397 = get_local_id(0);\n    tblock_sizze_79400 = get_local_size(0);\n    wave_sizze_79399 = LOCKSTEP_WIDTH;\n    block_id_79398 = get_tblock_id(0);\n    global_tid_79396 = block_id_79398 * tblock_sizze_79400 + local_tid_79397;\n    tid_79395 = sext_i32_i64(global_tid_79396);\n    x_77600 = ((__global int64_t *) mem_78120)[m_67854];\n    ((__global int64_t *) mem_78122)[(int64_t) 0] = x_77600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_79401_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_79401(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78103, __global unsigned char *mem_78125)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79403;\n    int32_t tblock_sizze_79406;\n    int32_t wave_sizze_79405;\n    int32_t block_id_79404;\n    int32_t global_tid_79402;\n    int64_t tid_79401;\n    int64_t x_77604;\n    \n    local_tid_79403 = get_local_id(0);\n    tblock_sizze_79406 = get_local_size(0);\n    wave_sizze_79405 = LOCKSTEP_WIDTH;\n    block_id_79404 = get_tblock_id(0);\n    global_tid_79402 = block_id_79404 * tblock_sizze_79406 + local_tid_7940", "3;\n    tid_79401 = sext_i32_i64(global_tid_79402);\n    x_77604 = ((__global int64_t *) mem_78103)[m_67854];\n    ((__global int64_t *) mem_78125)[(int64_t) 0] = x_77604;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_79407_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_79407(__global int *global_failure, __global unsigned char *ext_mem_78123, __global unsigned char *ext_mem_78126, __global unsigned char *mem_78132)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79409;\n    int32_t tblock_sizze_79412;\n    int32_t wave_sizze_79411;\n    int32_t block_id_79410;\n    int32_t global_tid_79408;\n    int64_t tid_79407;\n    int64_t zp_lhs_77608;\n    int64_t n_pairs_t_res_77609;\n    int64_t n_pairs_t_res_77610;\n    \n    local_tid_79409 = get_local_id(0);\n    tblock_sizze_79412 = get_local_size(0);\n    wave_sizze_79411 = LOCKSTEP_WIDTH;\n    block_id_79410 = get_tblock_id(0);\n    global_tid_79408 = block_id_79410 * tblock_sizze_79412 + local_tid_79409;\n    tid_79407 = sext_i32_i64(global_tid_79408);\n    zp_lhs_77608 = ((__global int64_t *) ext_mem_78123)[(int64_t) 0];\n    n_pairs_t_res_77609 = ((__global int64_t *) ext_mem_78126)[(int64_t) 0];\n    n_pairs_t_res_77610 = add64(zp_lhs_77608, n_pairs_t_res_77609);\n    ((__global int64_t *) mem_78132)[(int64_t) 0] = n_pairs_t_res_77610;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_79454_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_79454(__global int *global_failure, int64_t loopres_68028, __global unsigned char *mem_param_78166, __global unsigned char *mem_param_78169, __global unsigned char *mem_param_78172, __global unsigned char *mem_78179, __global unsigned char *mem_78180, __global unsigned char *mem_78181)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79456;\n    int32_t tblock_sizze_79459;\n    int32_t wave_sizze_79458;\n    int32_t block_id_79457;\n    int32_t global_tid_79455;\n    int64_t tid_79454;\n    float loopres_77612;\n    ", "int64_t loopres_77614;\n    int64_t loopres_77616;\n    \n    local_tid_79456 = get_local_id(0);\n    tblock_sizze_79459 = get_local_size(0);\n    wave_sizze_79458 = LOCKSTEP_WIDTH;\n    block_id_79457 = get_tblock_id(0);\n    global_tid_79455 = block_id_79457 * tblock_sizze_79459 + local_tid_79456;\n    tid_79454 = sext_i32_i64(global_tid_79455);\n    loopres_77612 = ((__global float *) mem_param_78166)[loopres_68028];\n    loopres_77614 = ((__global int64_t *) mem_param_78169)[loopres_68028];\n    loopres_77616 = ((__global int64_t *) mem_param_78172)[loopres_68028];\n    ((__global float *) mem_78179)[(int64_t) 0] = loopres_77612;\n    ((__global int64_t *) mem_78180)[(int64_t) 0] = loopres_77614;\n    ((__global int64_t *) mem_78181)[(int64_t) 0] = loopres_77616;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_floatzireplicate_79461(int64_t loopres_68029, int64_t replicate_n_79460, int64_t virt_num_tblocks_79466, int64_t num_tblocks_79467, __global unsigned char *mem_78179, __global unsigned char *mem_78183)\n{\n    int32_t replicate_ltid_79462;\n    int32_t tblock_sizze_79464;\n    int32_t replicate_gid_79463;\n    int32_t replicate_gtid_79461;\n    int32_t phys_tblock_id_79468;\n    int32_t iterations_79469;\n    \n    replicate_ltid_79462 = get_local_id(0);\n    tblock_sizze_79464 = get_local_size(0);\n    replicate_gid_79463 = get_tblock_id(0);\n    replicate_gtid_79461 = replicate_gid_79463 * tblock_sizze_79464 + replicate_ltid_79462;\n    phys_tblock_id_79468 = get_tblock_id(0);\n    iterations_79469 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79466) - phys_tblock_id_79468, sext_i64_i32(num_tblocks_79467));\n    for (int32_t i_79470 = 0; i_79470 < iterations_79469; i_79470++) {\n        int32_t virt_tblock_id_79471;\n        int64_t global_tid_79472;\n        int64_t slice_79475;\n        int64_t slice_79476;\n        int64_t rep_i_79473;\n        int64_t remnant_79477;\n        int64_t rep_i_79474;\n        int64_t remnant_79478;\n        \n        virt_tblock_id_79471 = phys_tblock_",
                                    "id_79468 + i_79470 * sext_i64_i32(num_tblocks_79467);\n        global_tid_79472 = sext_i32_i64(virt_tblock_id_79471) * sext_i32_i64(tblock_sizze_79464) + sext_i32_i64(replicate_ltid_79462);\n        slice_79475 = (int64_t) 1;\n        slice_79476 = loopres_68029 * slice_79475;\n        rep_i_79473 = squot64(global_tid_79472, slice_79475);\n        remnant_79477 = global_tid_79472 - rep_i_79473 * slice_79475;\n        rep_i_79474 = remnant_79477;\n        remnant_79478 = remnant_79477 - rep_i_79474;\n        if (slt64(global_tid_79472, replicate_n_79460)) {\n            float tmp_79479 = ((__global float *) mem_78179)[rep_i_79474];\n            \n            ((__global float *) mem_78183)[rep_i_79473 + rep_i_79474] = tmp_79479;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_floatzireplicate_79481(int64_t loopres_68029, int64_t replicate_n_79480, int64_t virt_num_tblocks_79486, int64_t num_tblocks_79487, __global unsigned char *mem_78180, __global unsigned char *mem_78185)\n{\n    int32_t replicate_ltid_79482;\n    int32_t tblock_sizze_79484;\n    int32_t replicate_gid_79483;\n    int32_t replicate_gtid_79481;\n    int32_t phys_tblock_id_79488;\n    int32_t iterations_79489;\n    \n    replicate_ltid_79482 = get_local_id(0);\n    tblock_sizze_79484 = get_local_size(0);\n    replicate_gid_79483 = get_tblock_id(0);\n    replicate_gtid_79481 = replicate_gid_79483 * tblock_sizze_79484 + replicate_ltid_79482;\n    phys_tblock_id_79488 = get_tblock_id(0);\n    iterations_79489 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79486) - phys_tblock_id_79488, sext_i64_i32(num_tblocks_79487));\n    for (int32_t i_79490 = 0; i_79490 < iterations_79489; i_79490++) {\n        int32_t virt_tblock_id_79491;\n        int64_t global_tid_79492;\n        int64_t slice_79495;\n        int64_t slice_79496;\n        int64_t rep_i_79493;\n        int64_t remnant_79497;\n        int64_t rep_i_79494;\n        int64_t remnant_79498;\n        \n    ", "    virt_tblock_id_79491 = phys_tblock_id_79488 + i_79490 * sext_i64_i32(num_tblocks_79487);\n        global_tid_79492 = sext_i32_i64(virt_tblock_id_79491) * sext_i32_i64(tblock_sizze_79484) + sext_i32_i64(replicate_ltid_79482);\n        slice_79495 = (int64_t) 1;\n        slice_79496 = loopres_68029 * slice_79495;\n        rep_i_79493 = squot64(global_tid_79492, slice_79495);\n        remnant_79497 = global_tid_79492 - rep_i_79493 * slice_79495;\n        rep_i_79494 = remnant_79497;\n        remnant_79498 = remnant_79497 - rep_i_79494;\n        if (slt64(global_tid_79492, replicate_n_79480)) {\n            int64_t tmp_79499 = ((__global int64_t *) mem_78180)[rep_i_79494];\n            \n            ((__global int64_t *) mem_78185)[rep_i_79493 + rep_i_79494] = tmp_79499;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_73813_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_73813(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_54353, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t max_res_67171, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, int64_t zt_rhs_67177, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77653, __global unsigned char *mem_77662, __global unsigned char *mem_77664)\n{\n    #define segmap_tblock_sizze_73808 (inner_SMJ_floatzisegmap_73813zisegmap_tblock_sizze_73808)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78873;\n    int32_t tblock_sizze_78876;\n    int32_t wave_sizze_78875;\n    int32_t block_id_78874;\n    int32_t global_tid_78872;\n    int64_t phys_tid_73813;\n    int64_t global_tid_78877;\n    int64_t slice_78878;\n    int64_t gtid_73812;\n    int64_t remnant_78879;\n    \n    local_tid_78873 = get_local_id(0);\n    tblock_sizze_78876 = get_local", "_size(0);\n    wave_sizze_78875 = LOCKSTEP_WIDTH;\n    block_id_78874 = get_tblock_id(0);\n    global_tid_78872 = block_id_78874 * tblock_sizze_78876 + local_tid_78873;\n    phys_tid_73813 = sext_i32_i64(global_tid_78872);\n    global_tid_78877 = sext_i32_i64(block_id_78874) * segmap_tblock_sizze_73808 + sext_i32_i64(local_tid_78873);\n    slice_78878 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;\n    gtid_73812 = global_tid_78877;\n    remnant_78879 = global_tid_78877 - gtid_73812;\n    if (slt64(gtid_73812, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172)) {\n        float lowest_77569;\n        int64_t index_primexp_76055;\n        int64_t zs_lhs_73815;\n        int64_t index_73816;\n        bool cond_73817;\n        int64_t loop_over_73818;\n        int64_t loop_over_73819;\n        int64_t loop_over_73821;\n        bool defunc_0_f_res_73824;\n        int64_t defunc_0_f_res_73825;\n        int64_t defunc_0_f_res_73826;\n        int64_t defunc_0_f_res_73827;\n        bool loop_while_73828;\n        int64_t p_73829;\n        int64_t p_73830;\n        int64_t p_73831;\n        \n        lowest_77569 = ((__global float *) ext_mem_77653)[(int64_t) 0];\n        index_primexp_76055 = add64(max_res_67171, gtid_73812);\n        zs_lhs_73815 = mul64(zt_rhs_67177, index_primexp_76055);\n        index_73816 = sdiv64(zs_lhs_73815, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n        cond_73817 = slt64(nR_54353, index_73816);\n        if (cond_73817) {\n            loop_over_73818 = nR_54353;\n        } else {\n            loop_over_73818 = index_73816;\n        }\n        if (cond_73817) {\n            int64_t loop_over_t_res_73820 = sub64(index_73816, nR_54353);\n            \n            loop_over_73819 = loop_over_t_res_73820;\n        } else {\n            loop_over_73819 = (int64_t) 0;\n        }\n        if (cond_73817) {\n            int64_t zm_lhs_73822;\n            int64_t loop_over_t_res_73823;\n            \n            zm_lhs_73822 = sub64(index_73816, nR",
                                    "_54353);\n            loop_over_t_res_73823 = sub64(zm_lhs_73822, (int64_t) 1);\n            loop_over_73821 = loop_over_t_res_73823;\n        } else {\n            loop_over_73821 = (int64_t) 0;\n        }\n        loop_while_73828 = 1;\n        p_73829 = loop_over_73821;\n        p_73830 = loop_over_73818;\n        p_73831 = loop_over_73819;\n        while (loop_while_73828) {\n            int64_t zs_lhs_73832;\n            int64_t offset_73833;\n            int64_t ai_73834;\n            int64_t max_arg1_73835;\n            int64_t max_res_73836;\n            bool cond_73837;\n            float b_prev_73838;\n            bool cond_73846;\n            int64_t loopres_73847;\n            int64_t loopres_73848;\n            int64_t loopres_73849;\n            bool loopres_73850;\n            bool loop_while_tmp_78880;\n            int64_t p_tmp_78881;\n            int64_t p_tmp_78882;\n            int64_t p_tmp_78883;\n            \n            zs_lhs_73832 = sub64(p_73830, p_73829);\n            offset_73833 = sdiv64(zs_lhs_73832, (int64_t) 2);\n            ai_73834 = sub64(p_73830, offset_73833);\n            max_arg1_73835 = add64(p_73831, offset_73833);\n            max_res_73836 = smax64((int64_t) 0, max_arg1_73835);\n            cond_73837 = slt64((int64_t) 0, max_res_73836);\n            if (cond_73837) {\n                int64_t tmp_73839;\n                bool x_73840;\n                bool y_73841;\n                bool bounds_check_73842;\n                bool index_certs_73843;\n                int64_t slice_73844;\n                float b_prev_t_res_73845;\n                \n                tmp_73839 = sub64(max_res_73836, (int64_t) 1);\n                x_73840 = sle64((int64_t) 0, tmp_73839);\n                y_73841 = slt64(tmp_73839, nR_54353);\n                bounds_check_73842 = x_73840 && y_73841;\n                if (!bounds_check_73842) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 44) == -1) {\n                            global_failure_ar", "gs[0] = (int64_t) tmp_73839;\n                            global_failure_args[1] = (int64_t) nR_54353;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_73844 = tS_start_66998 + tmp_73839;\n                b_prev_t_res_73845 = ((__global float *) tS_mem_77626)[slice_73844];\n                b_prev_73838 = b_prev_t_res_73845;\n            } else {\n                b_prev_73838 = lowest_77569;\n            }\n            cond_73846 = sle64(ai_73834, (int64_t) 0);\n            if (cond_73846) {\n                loopres_73847 = p_73829;\n                loopres_73848 = (int64_t) 0;\n                loopres_73849 = max_res_73836;\n                loopres_73850 = 0;\n            } else {\n                bool cond_73851;\n                int64_t loopres_f_res_73852;\n                int64_t loopres_f_res_73853;\n                int64_t loopres_f_res_73854;\n                bool loopres_f_res_73855;\n                \n                cond_73851 = sle64(nR_54353, max_res_73836);\n                if (cond_73851) {\n                    int64_t min_arg1_73856;\n                    int64_t min_res_73857;\n                    bool x_73858;\n                    bool y_73859;\n                    bool bounds_check_73860;\n                    bool index_certs_73861;\n                    bool x_73864;\n                    bool y_73865;\n                    bool bounds_check_73866;\n                    bool index_certs_73867;\n                    int64_t slice_73862;\n                    float leq_lhs_73863;\n                    float leq_rhs_73868;\n                    bool defunc_0_leq_res_73869;\n                    int64_t loopres_f_res_t_res_73870;\n                    bool x_73871;\n                    int64_t loopres_f_res_t_res_73872;\n                    \n                    min_arg1_73856 = sub64(nR_54353, (int64_t) 1);\n                    min_res_73857 = smin64(ai_73834, min_arg1_73856);\n                    x_738", "58 = sle64((int64_t) 0, min_arg1_73856);\n                    y_73859 = slt64(min_arg1_73856, nR_54353);\n                    bounds_check_73860 = x_73858 && y_73859;\n                    if (!bounds_check_73860) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 45) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_73856;\n                                global_failure_args[1] = (int64_t) nR_54353;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_73864 = sle64((int64_t) 0, min_res_73857);\n                    y_73865 = slt64(min_res_73857, nR_54353);\n                    bounds_check_73866 = x_73864 && y_73865;\n                    if (!bounds_check_73866) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 46) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_73857;\n                                global_failure_args[1] = (int64_t) nR_54353;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_73862 = tS_start_66998 + min_arg1_73856;\n                    leq_lhs_73863 = ((__global float *) tS_mem_77626)[slice_73862];\n                    leq_rhs_73868 = ((__global float *) tR_mem_77625)[min_res_73857];\n                    defunc_0_leq_res_73869 = leq_lhs_73863 <= leq_rhs_73868;\n                    if (defunc_0_leq_res_73869) {\n                        loopres_f_res_t_res_73870 = ai_73834;\n                    } else {\n                        loopres_f_res_t_res_73870 = p_73830;\n                    }\n                    x_73871 = !defunc_0_leq_res_73869;\n                    if (defunc_0_leq_res_73869) {\n                        loopres_f_res_t_res_73872 = nR_54353;",
                                    "\n                    } else {\n                        int64_t tmp_73873 = sub64(min_arg1_73856, offset_73833);\n                        \n                        loopres_f_res_t_res_73872 = tmp_73873;\n                    }\n                    loopres_f_res_73852 = p_73829;\n                    loopres_f_res_73853 = loopres_f_res_t_res_73870;\n                    loopres_f_res_73854 = loopres_f_res_t_res_73872;\n                    loopres_f_res_73855 = x_73871;\n                } else {\n                    bool cond_73874;\n                    int64_t loopres_f_res_f_res_73875;\n                    int64_t loopres_f_res_f_res_73876;\n                    int64_t loopres_f_res_f_res_73877;\n                    bool loopres_f_res_f_res_73878;\n                    \n                    cond_73874 = sle64(nR_54353, ai_73834);\n                    if (cond_73874) {\n                        int64_t min_arg1_73879;\n                        int64_t min_res_73880;\n                        bool x_73881;\n                        bool y_73882;\n                        bool bounds_check_73883;\n                        bool index_certs_73884;\n                        bool x_73886;\n                        bool y_73887;\n                        bool bounds_check_73888;\n                        bool index_certs_73889;\n                        float leq_lhs_73885;\n                        int64_t slice_73890;\n                        float leq_rhs_73891;\n                        bool defunc_0_leq_res_73892;\n                        int64_t loopres_f_res_f_res_t_res_73893;\n                        bool x_73894;\n                        int64_t loopres_f_res_f_res_t_res_73895;\n                        \n                        min_arg1_73879 = sub64(nR_54353, (int64_t) 1);\n                        min_res_73880 = smin64(max_res_73836, min_arg1_73879);\n                        x_73881 = sle64((int64_t) 0, min_arg1_73879);\n                        y_73882 = slt64(min_arg1_73879, nR_54353);\n                        bounds_c", "heck_73883 = x_73881 && y_73882;\n                        if (!bounds_check_73883) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 47) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_73879;\n                                    global_failure_args[1] = (int64_t) nR_54353;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_73886 = sle64((int64_t) 0, min_res_73880);\n                        y_73887 = slt64(min_res_73880, nR_54353);\n                        bounds_check_73888 = x_73886 && y_73887;\n                        if (!bounds_check_73888) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 48) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_73880;\n                                    global_failure_args[1] = (int64_t) nR_54353;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_73885 = ((__global float *) tR_mem_77625)[min_arg1_73879];\n                        slice_73890 = tS_start_66998 + min_res_73880;\n                        leq_rhs_73891 = ((__global float *) tS_mem_77626)[slice_73890];\n                        defunc_0_leq_res_73892 = leq_lhs_73885 <= leq_rhs_73891;\n                        if (defunc_0_leq_res_73892) {\n                            loopres_f_res_f_res_t_res_73893 = max_res_73836;\n                        } else {\n                            loopres_f_res_f_res_t_res_73893 = p_73831;\n                        }\n                        x_73894 = !defunc_0_leq_res_73892;\n                        if (defunc_0_leq_res_73892) {\n                            loopres_f_re", "s_f_res_t_res_73895 = nR_54353;\n                        } else {\n                            loopres_f_res_f_res_t_res_73895 = min_arg1_73879;\n                        }\n                        loopres_f_res_f_res_73875 = p_73829;\n                        loopres_f_res_f_res_73876 = loopres_f_res_f_res_t_res_73895;\n                        loopres_f_res_f_res_73877 = loopres_f_res_f_res_t_res_73893;\n                        loopres_f_res_f_res_73878 = x_73894;\n                    } else {\n                        bool cond_73896;\n                        int64_t loopres_f_res_f_res_f_res_73897;\n                        int64_t loopres_f_res_f_res_f_res_73898;\n                        int64_t loopres_f_res_f_res_f_res_73899;\n                        bool loopres_f_res_f_res_f_res_73900;\n                        \n                        cond_73896 = sle64(p_73830, p_73829);\n                        if (cond_73896) {\n                            bool cond_73901;\n                            int64_t ai_73902;\n                            bool x_73915;\n                            bool y_73916;\n                            bool bounds_check_73917;\n                            bool index_certs_73918;\n                            float b_prev_73904;\n                            float gt_lhs_73919;\n                            bool defunc_0_gt_res_73920;\n                            int64_t defunc_0_partFunc_sequential_search_res_73921;\n                            int64_t defunc_0_partFunc_sequential_search_res_73922;\n                            \n                            cond_73901 = slt64(ai_73834, nR_54353);\n                            if (cond_73901) {\n                                ai_73902 = ai_73834;\n                            } else {\n                                int64_t ai_f_res_73903 = sub64(nR_54353, (int64_t) 1);\n                                \n                                ai_73902 = ai_f_res_73903;\n                            }\n                            x_73915 = sle64",
                                    "((int64_t) 0, ai_73902);\n                            y_73916 = slt64(ai_73902, nR_54353);\n                            bounds_check_73917 = x_73915 && y_73916;\n                            if (!bounds_check_73917) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 49) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_73902;\n                                        global_failure_args[1] = (int64_t) nR_54353;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_73837) {\n                                int64_t tmp_73905;\n                                bool x_73906;\n                                bool y_73907;\n                                bool bounds_check_73908;\n                                bool index_certs_73909;\n                                int64_t slice_73910;\n                                float b_prev_t_res_73911;\n                                \n                                tmp_73905 = sub64(max_res_73836, (int64_t) 1);\n                                x_73906 = sle64((int64_t) 0, tmp_73905);\n                                y_73907 = slt64(tmp_73905, nR_54353);\n                                bounds_check_73908 = x_73906 && y_73907;\n                                if (!bounds_check_73908) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 50) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_73905;\n                                            global_failure_args[1] = (int64_t) nR_54353;\n                                            ;\n                                        }\n                                        return;\n                                    }\n ", "                               }\n                                slice_73910 = tS_start_66998 + tmp_73905;\n                                b_prev_t_res_73911 = ((__global float *) tS_mem_77626)[slice_73910];\n                                b_prev_73904 = b_prev_t_res_73911;\n                            } else {\n                                bool y_73912;\n                                bool index_certs_73913;\n                                float b_prev_f_res_73914;\n                                \n                                y_73912 = slt64((int64_t) 0, nR_54353);\n                                if (!y_73912) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 51) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_54353;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_73914 = ((__global float *) tS_mem_77626)[tS_start_66998];\n                                b_prev_73904 = b_prev_f_res_73914;\n                            }\n                            gt_lhs_73919 = ((__global float *) tR_mem_77625)[ai_73902];\n                            defunc_0_gt_res_73920 = b_prev_73904 < gt_lhs_73919;\n                            if (defunc_0_gt_res_73920) {\n                                int64_t zl_rhs_73923;\n                                bool loop_cond_73924;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_73925;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_73926;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_73927;\n                                in", "t64_t defunc_0_partFunc_sequential_search_res_t_res_73928;\n                                bool loop_while_73929;\n                                int64_t p_73930;\n                                int64_t p_73931;\n                                int64_t p_73932;\n                                \n                                zl_rhs_73923 = sub64(nR_54353, max_res_73836);\n                                loop_cond_73924 = slt64((int64_t) 0, zl_rhs_73923);\n                                loop_while_73929 = loop_cond_73924;\n                                p_73930 = ai_73902;\n                                p_73931 = max_res_73836;\n                                p_73932 = (int64_t) 0;\n                                while (loop_while_73929) {\n                                    int64_t i_a_73933;\n                                    int64_t i_b_73934;\n                                    int64_t leq_lhs_73935;\n                                    bool x_73936;\n                                    bool y_73937;\n                                    bool bounds_check_73938;\n                                    bool index_certs_73939;\n                                    bool x_73941;\n                                    bool y_73942;\n                                    bool bounds_check_73943;\n                                    bool index_certs_73944;\n                                    float leq_lhs_73940;\n                                    int64_t slice_73945;\n                                    float leq_rhs_73946;\n                                    bool defunc_0_leq_res_73947;\n                                    int64_t loopres_73948;\n                                    int64_t loopres_73949;\n                                    int64_t loopres_73950;\n                                    bool loop_cond_73952;\n                                    bool loop_while_tmp_78884;\n                                    int64_t p_tmp_78885;\n                                    int64_t p_tmp_",
                                    "78886;\n                                    int64_t p_tmp_78887;\n                                    \n                                    i_a_73933 = sub64(ai_73902, p_73932);\n                                    i_b_73934 = add64(max_res_73836, p_73932);\n                                    leq_lhs_73935 = sub64(i_a_73933, (int64_t) 1);\n                                    x_73936 = sle64((int64_t) 0, leq_lhs_73935);\n                                    y_73937 = slt64(leq_lhs_73935, nR_54353);\n                                    bounds_check_73938 = x_73936 && y_73937;\n                                    if (!bounds_check_73938) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 52) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_73935;\n                                                global_failure_args[1] = (int64_t) nR_54353;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_73941 = sle64((int64_t) 0, i_b_73934);\n                                    y_73942 = slt64(i_b_73934, nR_54353);\n                                    bounds_check_73943 = x_73941 && y_73942;\n                                    if (!bounds_check_73943) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 53) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_73934;\n                                                global_failure_args[1] = (int64_t) nR_54353;\n                                                ;\n                                            }\n                                            return;\n                     ", "                   }\n                                    }\n                                    leq_lhs_73940 = ((__global float *) tR_mem_77625)[leq_lhs_73935];\n                                    slice_73945 = tS_start_66998 + i_b_73934;\n                                    leq_rhs_73946 = ((__global float *) tS_mem_77626)[slice_73945];\n                                    defunc_0_leq_res_73947 = leq_lhs_73940 <= leq_rhs_73946;\n                                    if (defunc_0_leq_res_73947) {\n                                        loopres_73948 = i_a_73933;\n                                    } else {\n                                        loopres_73948 = ai_73902;\n                                    }\n                                    if (defunc_0_leq_res_73947) {\n                                        loopres_73949 = i_b_73934;\n                                    } else {\n                                        loopres_73949 = max_res_73836;\n                                    }\n                                    if (defunc_0_leq_res_73947) {\n                                        loopres_73950 = zl_rhs_73923;\n                                    } else {\n                                        int64_t tmp_73951 = add64((int64_t) 1, p_73932);\n                                        \n                                        loopres_73950 = tmp_73951;\n                                    }\n                                    loop_cond_73952 = slt64(loopres_73950, zl_rhs_73923);\n                                    loop_while_tmp_78884 = loop_cond_73952;\n                                    p_tmp_78885 = loopres_73948;\n                                    p_tmp_78886 = loopres_73949;\n                                    p_tmp_78887 = loopres_73950;\n                                    loop_while_73929 = loop_while_tmp_78884;\n                                    p_73930 = p_tmp_78885;\n                                    p_73931 = p_tmp_78886;\n                           ", "         p_73932 = p_tmp_78887;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_73925 = loop_while_73929;\n                                defunc_0_partFunc_sequential_search_res_t_res_73926 = p_73930;\n                                defunc_0_partFunc_sequential_search_res_t_res_73927 = p_73931;\n                                defunc_0_partFunc_sequential_search_res_t_res_73928 = p_73932;\n                                defunc_0_partFunc_sequential_search_res_73921 = defunc_0_partFunc_sequential_search_res_t_res_73926;\n                                defunc_0_partFunc_sequential_search_res_73922 = defunc_0_partFunc_sequential_search_res_t_res_73927;\n                            } else {\n                                int64_t zl_rhs_73953;\n                                bool loop_cond_73954;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_73955;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73956;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73957;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73958;\n                                bool loop_while_73959;\n                                int64_t p_73960;\n                                int64_t p_73961;\n                                int64_t p_73962;\n                                \n                                zl_rhs_73953 = sub64(max_res_73836, (int64_t) 1);\n                                loop_cond_73954 = slt64((int64_t) 0, zl_rhs_73953);\n                                loop_while_73959 = loop_cond_73954;\n                                p_73960 = ai_73902;\n                                p_73961 = max_res_73836;\n                                p_73962 = (int64_t) 0;\n                                while (loop_while_73959) {\n                                    int64_t zp_lhs_73963;\n               ",
                                    "                     int64_t hi_a_73964;\n                                    bool cond_73965;\n                                    int64_t i_a_73966;\n                                    int64_t zm_lhs_73968;\n                                    int64_t i_b_73969;\n                                    bool x_73970;\n                                    bool y_73971;\n                                    bool bounds_check_73972;\n                                    bool index_certs_73973;\n                                    bool x_73975;\n                                    bool y_73976;\n                                    bool bounds_check_73977;\n                                    bool index_certs_73978;\n                                    float gt_lhs_73974;\n                                    int64_t slice_73979;\n                                    float gt_rhs_73980;\n                                    bool defunc_0_gt_res_73981;\n                                    int64_t loopres_73982;\n                                    int64_t loopres_73983;\n                                    int64_t loopres_73984;\n                                    bool loop_cond_73986;\n                                    bool loop_while_tmp_78888;\n                                    int64_t p_tmp_78889;\n                                    int64_t p_tmp_78890;\n                                    int64_t p_tmp_78891;\n                                    \n                                    zp_lhs_73963 = add64(ai_73902, p_73962);\n                                    hi_a_73964 = add64((int64_t) 1, zp_lhs_73963);\n                                    cond_73965 = slt64(hi_a_73964, nR_54353);\n                                    if (cond_73965) {\n                                        i_a_73966 = hi_a_73964;\n                                    } else {\n                                        int64_t i_a_f_res_73967 = sub64(nR_54353, (int64_t) 1);\n                                        \n                   ", "                     i_a_73966 = i_a_f_res_73967;\n                                    }\n                                    zm_lhs_73968 = sub64(max_res_73836, p_73962);\n                                    i_b_73969 = sub64(zm_lhs_73968, (int64_t) 1);\n                                    x_73970 = sle64((int64_t) 0, i_a_73966);\n                                    y_73971 = slt64(i_a_73966, nR_54353);\n                                    bounds_check_73972 = x_73970 && y_73971;\n                                    if (!bounds_check_73972) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 54) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_73966;\n                                                global_failure_args[1] = (int64_t) nR_54353;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_73975 = sle64((int64_t) 0, i_b_73969);\n                                    y_73976 = slt64(i_b_73969, nR_54353);\n                                    bounds_check_73977 = x_73975 && y_73976;\n                                    if (!bounds_check_73977) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 55) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_73969;\n                                                global_failure_args[1] = (int64_t) nR_54353;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt", "_lhs_73974 = ((__global float *) tR_mem_77625)[i_a_73966];\n                                    slice_73979 = tS_start_66998 + i_b_73969;\n                                    gt_rhs_73980 = ((__global float *) tS_mem_77626)[slice_73979];\n                                    defunc_0_gt_res_73981 = gt_rhs_73980 < gt_lhs_73974;\n                                    if (defunc_0_gt_res_73981) {\n                                        loopres_73982 = i_a_73966;\n                                    } else {\n                                        loopres_73982 = ai_73902;\n                                    }\n                                    if (defunc_0_gt_res_73981) {\n                                        loopres_73983 = zm_lhs_73968;\n                                    } else {\n                                        loopres_73983 = max_res_73836;\n                                    }\n                                    if (defunc_0_gt_res_73981) {\n                                        loopres_73984 = zl_rhs_73953;\n                                    } else {\n                                        int64_t tmp_73985 = add64((int64_t) 1, p_73962);\n                                        \n                                        loopres_73984 = tmp_73985;\n                                    }\n                                    loop_cond_73986 = slt64(loopres_73984, zl_rhs_73953);\n                                    loop_while_tmp_78888 = loop_cond_73986;\n                                    p_tmp_78889 = loopres_73982;\n                                    p_tmp_78890 = loopres_73983;\n                                    p_tmp_78891 = loopres_73984;\n                                    loop_while_73959 = loop_while_tmp_78888;\n                                    p_73960 = p_tmp_78889;\n                                    p_73961 = p_tmp_78890;\n                                    p_73962 = p_tmp_78891;\n                                }\n                                defunc_0_",
                                    "partFunc_sequential_search_res_f_res_73955 = loop_while_73959;\n                                defunc_0_partFunc_sequential_search_res_f_res_73956 = p_73960;\n                                defunc_0_partFunc_sequential_search_res_f_res_73957 = p_73961;\n                                defunc_0_partFunc_sequential_search_res_f_res_73958 = p_73962;\n                                defunc_0_partFunc_sequential_search_res_73921 = defunc_0_partFunc_sequential_search_res_f_res_73956;\n                                defunc_0_partFunc_sequential_search_res_73922 = defunc_0_partFunc_sequential_search_res_f_res_73957;\n                            }\n                            loopres_f_res_f_res_f_res_73897 = p_73829;\n                            loopres_f_res_f_res_f_res_73898 = defunc_0_partFunc_sequential_search_res_73921;\n                            loopres_f_res_f_res_f_res_73899 = defunc_0_partFunc_sequential_search_res_73922;\n                            loopres_f_res_f_res_f_res_73900 = 0;\n                        } else {\n                            bool x_73987;\n                            bool y_73988;\n                            bool bounds_check_73989;\n                            bool index_certs_73990;\n                            float gt_lhs_73991;\n                            bool defunc_0_gt_res_73992;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73993;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73994;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73995;\n                            bool loopres_f_res_f_res_f_res_f_res_73996;\n                            \n                            x_73987 = sle64((int64_t) 0, ai_73834);\n                            y_73988 = slt64(ai_73834, nR_54353);\n                            bounds_check_73989 = x_73987 && y_73988;\n                            if (!bounds_check_73989) {\n                                {\n                                    if (atomic_cmpxchg_i32_", "global(global_failure, -1, 56) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_73834;\n                                        global_failure_args[1] = (int64_t) nR_54353;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_73991 = ((__global float *) tR_mem_77625)[ai_73834];\n                            defunc_0_gt_res_73992 = b_prev_73838 < gt_lhs_73991;\n                            if (defunc_0_gt_res_73992) {\n                                int64_t leq_lhs_73997;\n                                bool x_73998;\n                                bool y_73999;\n                                bool bounds_check_74000;\n                                bool index_certs_74001;\n                                bool x_74003;\n                                bool y_74004;\n                                bool bounds_check_74005;\n                                bool index_certs_74006;\n                                float leq_lhs_74002;\n                                int64_t slice_74007;\n                                float leq_rhs_74008;\n                                bool defunc_0_leq_res_74009;\n                                bool x_74010;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_74011;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_74012;\n                                \n                                leq_lhs_73997 = sub64(ai_73834, (int64_t) 1);\n                                x_73998 = sle64((int64_t) 0, leq_lhs_73997);\n                                y_73999 = slt64(leq_lhs_73997, nR_54353);\n                                bounds_check_74000 = x_73998 && y_73999;\n                                if (!bounds_check_74000) {\n                                    {\n                                        if ", "(atomic_cmpxchg_i32_global(global_failure, -1, 57) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_73997;\n                                            global_failure_args[1] = (int64_t) nR_54353;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_74003 = sle64((int64_t) 0, max_res_73836);\n                                y_74004 = slt64(max_res_73836, nR_54353);\n                                bounds_check_74005 = x_74003 && y_74004;\n                                if (!bounds_check_74005) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 58) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_73836;\n                                            global_failure_args[1] = (int64_t) nR_54353;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_74002 = ((__global float *) tR_mem_77625)[leq_lhs_73997];\n                                slice_74007 = tS_start_66998 + max_res_73836;\n                                leq_rhs_74008 = ((__global float *) tS_mem_77626)[slice_74007];\n                                defunc_0_leq_res_74009 = leq_lhs_74002 <= leq_rhs_74008;\n                                x_74010 = !defunc_0_leq_res_74009;\n                                if (defunc_0_leq_res_74009) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_74011 = ai_73834;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_74011 = leq_lhs_73997;\n              ",
                                    "                  }\n                                if (defunc_0_leq_res_74009) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_74012 = max_res_73836;\n                                } else {\n                                    int64_t tmp_74013 = add64((int64_t) 1, max_res_73836);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_74012 = tmp_74013;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_73993 = p_73829;\n                                loopres_f_res_f_res_f_res_f_res_73994 = loopres_f_res_f_res_f_res_f_res_t_res_74011;\n                                loopres_f_res_f_res_f_res_f_res_73995 = loopres_f_res_f_res_f_res_f_res_t_res_74012;\n                                loopres_f_res_f_res_f_res_f_res_73996 = x_74010;\n                            } else {\n                                int64_t tmp_74014 = add64((int64_t) 1, ai_73834);\n                                \n                                loopres_f_res_f_res_f_res_f_res_73993 = tmp_74014;\n                                loopres_f_res_f_res_f_res_f_res_73994 = p_73830;\n                                loopres_f_res_f_res_f_res_f_res_73995 = p_73831;\n                                loopres_f_res_f_res_f_res_f_res_73996 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_73897 = loopres_f_res_f_res_f_res_f_res_73993;\n                            loopres_f_res_f_res_f_res_73898 = loopres_f_res_f_res_f_res_f_res_73994;\n                            loopres_f_res_f_res_f_res_73899 = loopres_f_res_f_res_f_res_f_res_73995;\n                            loopres_f_res_f_res_f_res_73900 = loopres_f_res_f_res_f_res_f_res_73996;\n                        }\n                        loopres_f_res_f_res_73875 = loopres_f_res_f_res_f_res_73897;\n                        loopres_f_res_f_res_73876 = loopres_f_res_f_res_f_res_73898;\n                        loo", "pres_f_res_f_res_73877 = loopres_f_res_f_res_f_res_73899;\n                        loopres_f_res_f_res_73878 = loopres_f_res_f_res_f_res_73900;\n                    }\n                    loopres_f_res_73852 = loopres_f_res_f_res_73875;\n                    loopres_f_res_73853 = loopres_f_res_f_res_73876;\n                    loopres_f_res_73854 = loopres_f_res_f_res_73877;\n                    loopres_f_res_73855 = loopres_f_res_f_res_73878;\n                }\n                loopres_73847 = loopres_f_res_73852;\n                loopres_73848 = loopres_f_res_73853;\n                loopres_73849 = loopres_f_res_73854;\n                loopres_73850 = loopres_f_res_73855;\n            }\n            loop_while_tmp_78880 = loopres_73850;\n            p_tmp_78881 = loopres_73847;\n            p_tmp_78882 = loopres_73848;\n            p_tmp_78883 = loopres_73849;\n            loop_while_73828 = loop_while_tmp_78880;\n            p_73829 = p_tmp_78881;\n            p_73830 = p_tmp_78882;\n            p_73831 = p_tmp_78883;\n        }\n        defunc_0_f_res_73824 = loop_while_73828;\n        defunc_0_f_res_73825 = p_73829;\n        defunc_0_f_res_73826 = p_73830;\n        defunc_0_f_res_73827 = p_73831;\n        ((__global int64_t *) mem_77662)[gtid_73812] = defunc_0_f_res_73826;\n        ((__global int64_t *) mem_77664)[gtid_73812] = defunc_0_f_res_73827;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73808\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74187_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74187(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_54353, int64_t gt_rhs_66981, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t zeze_rhs_67414, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77644, __global unsigned char *mem_77646, __global unsigned char *mem_77680, __global unsigned char *mem_77682)\n{\n  ", "  #define segmap_tblock_sizze_74182 (inner_SMJ_floatzisegmap_74187zisegmap_tblock_sizze_74182)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78896;\n    int32_t tblock_sizze_78899;\n    int32_t wave_sizze_78898;\n    int32_t block_id_78897;\n    int32_t global_tid_78895;\n    int64_t phys_tid_74187;\n    int64_t global_tid_78900;\n    int64_t slice_78901;\n    int64_t gtid_74186;\n    int64_t remnant_78902;\n    \n    local_tid_78896 = get_local_id(0);\n    tblock_sizze_78899 = get_local_size(0);\n    wave_sizze_78898 = LOCKSTEP_WIDTH;\n    block_id_78897 = get_tblock_id(0);\n    global_tid_78895 = block_id_78897 * tblock_sizze_78899 + local_tid_78896;\n    phys_tid_74187 = sext_i32_i64(global_tid_78895);\n    global_tid_78900 = sext_i32_i64(block_id_78897) * segmap_tblock_sizze_74182 + sext_i32_i64(local_tid_78896);\n    slice_78901 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n    gtid_74186 = global_tid_78900;\n    remnant_78902 = global_tid_78900 - gtid_74186;\n    if (slt64(gtid_74186, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140)) {\n        int64_t eta_p_74189;\n        int64_t min_res_74190;\n        bool x_74191;\n        bool y_74192;\n        bool bounds_check_74193;\n        bool index_certs_74194;\n        bool cond_74196;\n        int64_t ri_next_74197;\n        int64_t max_arg1_74204;\n        int64_t max_res_74205;\n        bool x_74206;\n        bool y_74207;\n        bool bounds_check_74208;\n        bool index_certs_74209;\n        float r_min_74195;\n        float r_max_74210;\n        bool defunc_0_f_res_74211;\n        int64_t defunc_0_f_res_74212;\n        bool loop_while_74213;\n        int64_t fm_74214;\n        bool defunc_0_f_res_74280;\n        int64_t defunc_0_f_res_74281;\n        bool loop_while_74282;\n        int64_t lm_74283;\n        \n        eta_p_74189 = ((__global int64_t *) mem_77644)[gtid_74186];\n        min_res_74190 = smin64(gt_rhs_66981, eta_p_74189);\n        x_74191 = sle64((int64_t) 0, min_re",
                                    "s_74190);\n        y_74192 = slt64(min_res_74190, nR_54353);\n        bounds_check_74193 = x_74191 && y_74192;\n        if (!bounds_check_74193) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 59) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_74190;\n                    global_failure_args[1] = (int64_t) nR_54353;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_74196 = gtid_74186 == zeze_rhs_67414;\n        if (cond_74196) {\n            ri_next_74197 = nR_54353;\n        } else {\n            int64_t tmp_74198;\n            bool x_74199;\n            bool y_74200;\n            bool bounds_check_74201;\n            bool index_certs_74202;\n            int64_t ri_next_f_res_74203;\n            \n            tmp_74198 = add64((int64_t) 1, gtid_74186);\n            x_74199 = sle64((int64_t) 0, tmp_74198);\n            y_74200 = slt64(tmp_74198, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_74201 = x_74199 && y_74200;\n            if (!bounds_check_74201) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 60) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_74198;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_74203 = ((__global int64_t *) mem_77644)[tmp_74198];\n            ri_next_74197 = ri_next_f_res_74203;\n        }\n        max_arg1_74204 = sub64(ri_next_74197, (int64_t) 1);\n        max_res_74205 = smax64((int64_t) 0, max_arg1_74204);\n        x_74206 = sle64((int64_t) 0, max_res_74205);\n        y_74207 = slt64(max_res_74205, nR_54353);\n        bounds_check_74208 = x_74206 && y_74207;\n        if (!bounds_check_74208) {\n            {\n                if (a", "tomic_cmpxchg_i32_global(global_failure, -1, 61) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_74205;\n                    global_failure_args[1] = (int64_t) nR_54353;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_74195 = ((__global float *) tR_mem_77625)[min_res_74190];\n        r_max_74210 = ((__global float *) tR_mem_77625)[max_res_74205];\n        loop_while_74213 = 1;\n        fm_74214 = gtid_74186;\n        while (loop_while_74213) {\n            bool x_74215;\n            bool y_74216;\n            bool bounds_check_74217;\n            bool index_certs_74218;\n            int64_t loopres_74219;\n            int64_t min_res_74220;\n            bool x_74221;\n            bool y_74222;\n            bool bounds_check_74223;\n            bool index_certs_74224;\n            bool cond_74227;\n            int64_t si_next_74228;\n            int64_t max_arg1_74235;\n            int64_t max_res_74236;\n            bool x_74237;\n            bool y_74238;\n            bool bounds_check_74239;\n            bool index_certs_74240;\n            int64_t min_res_74243;\n            bool x_74244;\n            bool y_74245;\n            bool bounds_check_74246;\n            bool index_certs_74247;\n            int64_t max_arg1_74250;\n            int64_t max_res_74251;\n            bool x_74252;\n            bool y_74253;\n            bool bounds_check_74254;\n            bool index_certs_74255;\n            int64_t slice_74225;\n            float s_min_74226;\n            int64_t slice_74241;\n            int64_t slice_74248;\n            int64_t slice_74256;\n            bool defunc_0_gt_res_74258;\n            bool loopres_74259;\n            int64_t loopres_74260;\n            bool loop_while_tmp_78903;\n            int64_t fm_tmp_78904;\n            \n            x_74215 = sle64((int64_t) 0, fm_74214);\n            y_74216 = slt64(fm_74214, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_74", "217 = x_74215 && y_74216;\n            if (!bounds_check_74217) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 62) == -1) {\n                        global_failure_args[0] = (int64_t) fm_74214;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_74219 = ((__global int64_t *) mem_77646)[fm_74214];\n            min_res_74220 = smin64(gt_rhs_66981, loopres_74219);\n            x_74221 = sle64((int64_t) 0, min_res_74220);\n            y_74222 = slt64(min_res_74220, nR_54353);\n            bounds_check_74223 = x_74221 && y_74222;\n            if (!bounds_check_74223) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 63) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_74220;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_74227 = sle64(zeze_rhs_67414, fm_74214);\n            if (cond_74227) {\n                si_next_74228 = nR_54353;\n            } else {\n                int64_t tmp_74229;\n                bool x_74230;\n                bool y_74231;\n                bool bounds_check_74232;\n                bool index_certs_74233;\n                int64_t si_next_f_res_74234;\n                \n                tmp_74229 = add64((int64_t) 1, fm_74214);\n                x_74230 = sle64((int64_t) 0, tmp_74229);\n                y_74231 = slt64(tmp_74229, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_74232 = x_74230 && y_74231;\n                if (!bounds_check_74232) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 64) == -1) {\n           ",
                                    "                 global_failure_args[0] = (int64_t) tmp_74229;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_74234 = ((__global int64_t *) mem_77646)[tmp_74229];\n                si_next_74228 = si_next_f_res_74234;\n            }\n            max_arg1_74235 = sub64(si_next_74228, (int64_t) 1);\n            max_res_74236 = smax64(min_res_74220, max_arg1_74235);\n            x_74237 = sle64((int64_t) 0, max_res_74236);\n            y_74238 = slt64(max_res_74236, nR_54353);\n            bounds_check_74239 = x_74237 && y_74238;\n            if (!bounds_check_74239) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 65) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_74236;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_74243 = smin64(zeze_rhs_67414, si_next_74228);\n            x_74244 = sle64((int64_t) 0, min_res_74243);\n            y_74245 = slt64(min_res_74243, nR_54353);\n            bounds_check_74246 = x_74244 && y_74245;\n            if (!bounds_check_74246) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 66) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_74243;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_74250 = sub64(min_res_74220, (int64_t) 1);\n            max_res_74251 = smax64((int64_t) 0, max_arg1_74250);\n            x_74252 = sle64((int64_t) 0, max_res_74251);\n            y_74253 = slt64(max_r", "es_74251, nR_54353);\n            bounds_check_74254 = x_74252 && y_74253;\n            if (!bounds_check_74254) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 67) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_74251;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_74225 = tS_start_66998 + min_res_74220;\n            s_min_74226 = ((__global float *) tS_mem_77626)[slice_74225];\n            slice_74241 = tS_start_66998 + max_res_74236;\n            slice_74248 = tS_start_66998 + min_res_74243;\n            slice_74256 = tS_start_66998 + max_res_74251;\n            defunc_0_gt_res_74258 = s_min_74226 < r_min_74195;\n            if (defunc_0_gt_res_74258) {\n                float s_max_74242;\n                bool defunc_0_leq_res_74261;\n                bool loopres_t_res_74262;\n                int64_t loopres_t_res_74263;\n                \n                s_max_74242 = ((__global float *) tS_mem_77626)[slice_74241];\n                defunc_0_leq_res_74261 = r_min_74195 <= s_max_74242;\n                if (defunc_0_leq_res_74261) {\n                    loopres_t_res_74262 = 0;\n                    loopres_t_res_74263 = fm_74214;\n                } else {\n                    float s_nextMin_74249;\n                    bool defunc_0_leq_res_74264;\n                    int64_t zgze_lhs_74265;\n                    bool tmp_f_res_74266;\n                    bool x_74267;\n                    bool y_74268;\n                    bool tmp_74269;\n                    bool loopres_t_res_f_res_74270;\n                    \n                    s_nextMin_74249 = ((__global float *) tS_mem_77626)[slice_74248];\n                    defunc_0_leq_res_74264 = r_min_74195 <= s_nextMin_74249;\n                    zgze_lhs_74265 = add64((int64_t) 1, fm_74214);\n                    tmp_f_res_74266 = sle", "64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zgze_lhs_74265);\n                    x_74267 = !defunc_0_leq_res_74264;\n                    y_74268 = tmp_f_res_74266 && x_74267;\n                    tmp_74269 = defunc_0_leq_res_74264 || y_74268;\n                    loopres_t_res_f_res_74270 = !tmp_74269;\n                    loopres_t_res_74262 = loopres_t_res_f_res_74270;\n                    loopres_t_res_74263 = zgze_lhs_74265;\n                }\n                loopres_74259 = loopres_t_res_74262;\n                loopres_74260 = loopres_t_res_74263;\n            } else {\n                float s_prevMax_74257;\n                bool defunc_0_leq_res_74271;\n                int64_t zlze_lhs_74272;\n                bool tmp_f_res_74273;\n                bool x_74274;\n                bool y_74275;\n                bool tmp_74276;\n                int64_t max_res_74277;\n                bool loopres_f_res_74278;\n                \n                s_prevMax_74257 = ((__global float *) tS_mem_77626)[slice_74256];\n                defunc_0_leq_res_74271 = s_prevMax_74257 <= r_min_74195;\n                zlze_lhs_74272 = sub64(fm_74214, (int64_t) 1);\n                tmp_f_res_74273 = sle64(zlze_lhs_74272, (int64_t) 0);\n                x_74274 = !defunc_0_leq_res_74271;\n                y_74275 = tmp_f_res_74273 && x_74274;\n                tmp_74276 = defunc_0_leq_res_74271 || y_74275;\n                max_res_74277 = smax64((int64_t) 0, zlze_lhs_74272);\n                loopres_f_res_74278 = !tmp_74276;\n                loopres_74259 = loopres_f_res_74278;\n                loopres_74260 = max_res_74277;\n            }\n            loop_while_tmp_78903 = loopres_74259;\n            fm_tmp_78904 = loopres_74260;\n            loop_while_74213 = loop_while_tmp_78903;\n            fm_74214 = fm_tmp_78904;\n        }\n        defunc_0_f_res_74211 = loop_while_74213;\n        defunc_0_f_res_74212 = fm_74214;\n        loop_while_74282 = 1;\n        lm_74283 = gtid_74186;\n        while (",
                                    "loop_while_74282) {\n            bool x_74284;\n            bool y_74285;\n            bool bounds_check_74286;\n            bool index_certs_74287;\n            int64_t loopres_74288;\n            int64_t min_res_74289;\n            bool x_74290;\n            bool y_74291;\n            bool bounds_check_74292;\n            bool index_certs_74293;\n            bool cond_74296;\n            int64_t si_next_74297;\n            int64_t max_arg1_74304;\n            int64_t max_res_74305;\n            bool x_74306;\n            bool y_74307;\n            bool bounds_check_74308;\n            bool index_certs_74309;\n            int64_t min_res_74312;\n            bool x_74313;\n            bool y_74314;\n            bool bounds_check_74315;\n            bool index_certs_74316;\n            int64_t max_arg1_74319;\n            int64_t max_res_74320;\n            bool x_74321;\n            bool y_74322;\n            bool bounds_check_74323;\n            bool index_certs_74324;\n            int64_t slice_74294;\n            int64_t slice_74310;\n            float s_max_74311;\n            int64_t slice_74317;\n            int64_t slice_74325;\n            bool defunc_0_gt_res_74327;\n            bool loopres_74328;\n            int64_t loopres_74329;\n            bool loop_cond_t_res_74344;\n            bool x_74345;\n            bool loop_while_tmp_78905;\n            int64_t lm_tmp_78906;\n            \n            x_74284 = sle64((int64_t) 0, lm_74283);\n            y_74285 = slt64(lm_74283, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_74286 = x_74284 && y_74285;\n            if (!bounds_check_74286) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 68) == -1) {\n                        global_failure_args[0] = (int64_t) lm_74283;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    retu", "rn;\n                }\n            }\n            loopres_74288 = ((__global int64_t *) mem_77646)[lm_74283];\n            min_res_74289 = smin64(gt_rhs_66981, loopres_74288);\n            x_74290 = sle64((int64_t) 0, min_res_74289);\n            y_74291 = slt64(min_res_74289, nR_54353);\n            bounds_check_74292 = x_74290 && y_74291;\n            if (!bounds_check_74292) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 69) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_74289;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_74296 = sle64(zeze_rhs_67414, lm_74283);\n            if (cond_74296) {\n                si_next_74297 = nR_54353;\n            } else {\n                int64_t tmp_74298;\n                bool x_74299;\n                bool y_74300;\n                bool bounds_check_74301;\n                bool index_certs_74302;\n                int64_t si_next_f_res_74303;\n                \n                tmp_74298 = add64((int64_t) 1, lm_74283);\n                x_74299 = sle64((int64_t) 0, tmp_74298);\n                y_74300 = slt64(tmp_74298, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_74301 = x_74299 && y_74300;\n                if (!bounds_check_74301) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 70) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_74298;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_74303 = ((__global int64_t *) mem_77646)[tmp_74298];\n                si_next_74297", " = si_next_f_res_74303;\n            }\n            max_arg1_74304 = sub64(si_next_74297, (int64_t) 1);\n            max_res_74305 = smax64(min_res_74289, max_arg1_74304);\n            x_74306 = sle64((int64_t) 0, max_res_74305);\n            y_74307 = slt64(max_res_74305, nR_54353);\n            bounds_check_74308 = x_74306 && y_74307;\n            if (!bounds_check_74308) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 71) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_74305;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_74312 = smin64(zeze_rhs_67414, si_next_74297);\n            x_74313 = sle64((int64_t) 0, min_res_74312);\n            y_74314 = slt64(min_res_74312, nR_54353);\n            bounds_check_74315 = x_74313 && y_74314;\n            if (!bounds_check_74315) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 72) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_74312;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_74319 = sub64(min_res_74289, (int64_t) 1);\n            max_res_74320 = smax64((int64_t) 0, max_arg1_74319);\n            x_74321 = sle64((int64_t) 0, max_res_74320);\n            y_74322 = slt64(max_res_74320, nR_54353);\n            bounds_check_74323 = x_74321 && y_74322;\n            if (!bounds_check_74323) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 73) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_74320;\n                        global_failure_args[1] = (int64_t) nR_54353;\n                        ;\n                    }\n                    return;\n  ",
                                    "              }\n            }\n            slice_74294 = tS_start_66998 + min_res_74289;\n            slice_74310 = tS_start_66998 + max_res_74305;\n            s_max_74311 = ((__global float *) tS_mem_77626)[slice_74310];\n            slice_74317 = tS_start_66998 + min_res_74312;\n            slice_74325 = tS_start_66998 + max_res_74320;\n            defunc_0_gt_res_74327 = r_max_74210 < s_max_74311;\n            if (defunc_0_gt_res_74327) {\n                float s_min_74295;\n                bool defunc_0_leq_res_74330;\n                bool loopres_t_res_74331;\n                int64_t loopres_t_res_74332;\n                \n                s_min_74295 = ((__global float *) tS_mem_77626)[slice_74294];\n                defunc_0_leq_res_74330 = s_min_74295 <= r_max_74210;\n                if (defunc_0_leq_res_74330) {\n                    loopres_t_res_74331 = 0;\n                    loopres_t_res_74332 = lm_74283;\n                } else {\n                    float s_prevMax_74326;\n                    bool defunc_0_leq_res_74333;\n                    int64_t zlze_lhs_74334;\n                    bool tmp_f_res_74335;\n                    bool x_74336;\n                    bool y_74337;\n                    bool tmp_74338;\n                    int64_t max_res_74339;\n                    bool loopres_t_res_f_res_74340;\n                    \n                    s_prevMax_74326 = ((__global float *) tS_mem_77626)[slice_74325];\n                    defunc_0_leq_res_74333 = s_prevMax_74326 <= r_max_74210;\n                    zlze_lhs_74334 = sub64(lm_74283, (int64_t) 1);\n                    tmp_f_res_74335 = sle64(zlze_lhs_74334, (int64_t) 0);\n                    x_74336 = !defunc_0_leq_res_74333;\n                    y_74337 = tmp_f_res_74335 && x_74336;\n                    tmp_74338 = defunc_0_leq_res_74333 || y_74337;\n                    max_res_74339 = smax64((int64_t) 0, zlze_lhs_74334);\n                    loopres_t_res_f_res_74340 = !tmp_74338;\n                    loopres_t_res_74331 = loop", "res_t_res_f_res_74340;\n                    loopres_t_res_74332 = max_res_74339;\n                }\n                loopres_74328 = loopres_t_res_74331;\n                loopres_74329 = loopres_t_res_74332;\n            } else {\n                float s_nextMin_74318;\n                bool defunc_0_leq_res_74341;\n                int64_t tmp_74342;\n                bool loopres_f_res_74343;\n                \n                s_nextMin_74318 = ((__global float *) tS_mem_77626)[slice_74317];\n                defunc_0_leq_res_74341 = r_max_74210 <= s_nextMin_74318;\n                tmp_74342 = add64((int64_t) 1, lm_74283);\n                loopres_f_res_74343 = !defunc_0_leq_res_74341;\n                loopres_74328 = loopres_f_res_74343;\n                loopres_74329 = tmp_74342;\n            }\n            loop_cond_t_res_74344 = slt64(loopres_74329, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            x_74345 = loopres_74328 && loop_cond_t_res_74344;\n            loop_while_tmp_78905 = x_74345;\n            lm_tmp_78906 = loopres_74329;\n            loop_while_74282 = loop_while_tmp_78905;\n            lm_74283 = lm_tmp_78906;\n        }\n        defunc_0_f_res_74280 = loop_while_74282;\n        defunc_0_f_res_74281 = lm_74283;\n        ((__global int64_t *) mem_77680)[gtid_74186] = defunc_0_f_res_74212;\n        ((__global int64_t *) mem_77682)[gtid_74186] = defunc_0_f_res_74281;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74182\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74539_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74539(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77861, int64_t ext_77862, __global unsigned char *mem_param_77698, __global unsigned char *ext_mem_77865, __global unsigned char *mem_77869)\n{\n    #define segmap_tblock_sizze_74535 (inner_SMJ_floatzisegmap_74539zisegmap_tblock_sizze_74535)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79018;\n    ", "int32_t tblock_sizze_79021;\n    int32_t wave_sizze_79020;\n    int32_t block_id_79019;\n    int32_t global_tid_79017;\n    int64_t phys_tid_74539;\n    int64_t global_tid_79022;\n    int64_t slice_79023;\n    int64_t gtid_74538;\n    int64_t remnant_79024;\n    \n    local_tid_79018 = get_local_id(0);\n    tblock_sizze_79021 = get_local_size(0);\n    wave_sizze_79020 = LOCKSTEP_WIDTH;\n    block_id_79019 = get_tblock_id(0);\n    global_tid_79017 = block_id_79019 * tblock_sizze_79021 + local_tid_79018;\n    phys_tid_74539 = sext_i32_i64(global_tid_79017);\n    global_tid_79022 = sext_i32_i64(block_id_79019) * segmap_tblock_sizze_74535 + sext_i32_i64(local_tid_79018);\n    slice_79023 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_74538 = global_tid_79022;\n    remnant_79024 = global_tid_79022 - gtid_74538;\n    if (slt64(gtid_74538, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_74540;\n        bool cond_74542;\n        int64_t lifted_lambda_res_74543;\n        \n        eta_p_74540 = ((__global int64_t *) mem_param_77698)[gtid_74538];\n        cond_74542 = slt64(eta_p_74540, (int64_t) 0);\n        if (cond_74542) {\n            int64_t eta_p_74541 = ((__global int64_t *) ext_mem_77865)[ext_77862 + gtid_74538 * ext_77861];\n            \n            lifted_lambda_res_74543 = eta_p_74541;\n        } else {\n            lifted_lambda_res_74543 = eta_p_74540;\n        }\n        ((__global int64_t *) mem_77869)[gtid_74538] = lifted_lambda_res_74543;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74535\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74560_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74560(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77863, int64_t ext_77864, __global unsigned char *mem_param_77695, __global unsigned char *ext_mem_77866, __global unsigned char *mem_77872)\n{\n    #define segmap_tblock_sizze_74556 (inner_SMJ_floatzisegmap_74560zisegmap_tblock_sizze_74556)\n    if (*global_f",
                                    "ailure >= 0)\n        return;\n    \n    int32_t local_tid_79027;\n    int32_t tblock_sizze_79030;\n    int32_t wave_sizze_79029;\n    int32_t block_id_79028;\n    int32_t global_tid_79026;\n    int64_t phys_tid_74560;\n    int64_t global_tid_79031;\n    int64_t slice_79032;\n    int64_t gtid_74559;\n    int64_t remnant_79033;\n    \n    local_tid_79027 = get_local_id(0);\n    tblock_sizze_79030 = get_local_size(0);\n    wave_sizze_79029 = LOCKSTEP_WIDTH;\n    block_id_79028 = get_tblock_id(0);\n    global_tid_79026 = block_id_79028 * tblock_sizze_79030 + local_tid_79027;\n    phys_tid_74560 = sext_i32_i64(global_tid_79026);\n    global_tid_79031 = sext_i32_i64(block_id_79028) * segmap_tblock_sizze_74556 + sext_i32_i64(local_tid_79027);\n    slice_79032 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_74559 = global_tid_79031;\n    remnant_79033 = global_tid_79031 - gtid_74559;\n    if (slt64(gtid_74559, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_74561;\n        int64_t eta_p_74562;\n        int64_t defunc_0_f_res_74563;\n        \n        eta_p_74561 = ((__global int64_t *) mem_param_77695)[gtid_74559];\n        eta_p_74562 = ((__global int64_t *) ext_mem_77866)[ext_77864 + gtid_74559 * ext_77863];\n        defunc_0_f_res_74563 = add64(eta_p_74561, eta_p_74562);\n        ((__global int64_t *) mem_77872)[gtid_74559] = defunc_0_f_res_74563;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74556\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74581_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74581(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77686, int64_t ctx_param_ext_77687, __global unsigned char *mem_param_77688, __global unsigned char *ext_mem_77877, __global unsigned char *mem_77881)\n{\n    #define segmap_tblock_sizze_74577 (inner_SMJ_floatzisegmap_74581zisegmap_tblock_sizze_74577)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t loca", "l_tid_79036;\n    int32_t tblock_sizze_79039;\n    int32_t wave_sizze_79038;\n    int32_t block_id_79037;\n    int32_t global_tid_79035;\n    int64_t phys_tid_74581;\n    int64_t global_tid_79040;\n    int64_t slice_79041;\n    int64_t gtid_74580;\n    int64_t remnant_79042;\n    \n    local_tid_79036 = get_local_id(0);\n    tblock_sizze_79039 = get_local_size(0);\n    wave_sizze_79038 = LOCKSTEP_WIDTH;\n    block_id_79037 = get_tblock_id(0);\n    global_tid_79035 = block_id_79037 * tblock_sizze_79039 + local_tid_79036;\n    phys_tid_74581 = sext_i32_i64(global_tid_79035);\n    global_tid_79040 = sext_i32_i64(block_id_79037) * segmap_tblock_sizze_74577 + sext_i32_i64(local_tid_79036);\n    slice_79041 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_74580 = global_tid_79040;\n    remnant_79042 = global_tid_79040 - gtid_74580;\n    if (slt64(gtid_74580, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76049;\n        int64_t eta_p_74582;\n        bool cond_74584;\n        int64_t lifted_lambda_res_74585;\n        \n        slice_76049 = loopres_f_res_f_res_67593 + gtid_74580;\n        eta_p_74582 = ((__global int64_t *) mem_param_77688)[ctx_param_ext_77686 + slice_76049 * ctx_param_ext_77687];\n        cond_74584 = slt64(eta_p_74582, (int64_t) 0);\n        if (cond_74584) {\n            int64_t eta_p_74583 = ((__global int64_t *) ext_mem_77877)[gtid_74580];\n            \n            lifted_lambda_res_74585 = eta_p_74583;\n        } else {\n            lifted_lambda_res_74585 = eta_p_74582;\n        }\n        ((__global int64_t *) mem_77881)[gtid_74580] = lifted_lambda_res_74585;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74577\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74602_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74602(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77683, int64_t ctx_param_ext_77684, __global unsigned char *mem_param_77685, __glob", "al unsigned char *ext_mem_77878, __global unsigned char *mem_77884)\n{\n    #define segmap_tblock_sizze_74598 (inner_SMJ_floatzisegmap_74602zisegmap_tblock_sizze_74598)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79045;\n    int32_t tblock_sizze_79048;\n    int32_t wave_sizze_79047;\n    int32_t block_id_79046;\n    int32_t global_tid_79044;\n    int64_t phys_tid_74602;\n    int64_t global_tid_79049;\n    int64_t slice_79050;\n    int64_t gtid_74601;\n    int64_t remnant_79051;\n    \n    local_tid_79045 = get_local_id(0);\n    tblock_sizze_79048 = get_local_size(0);\n    wave_sizze_79047 = LOCKSTEP_WIDTH;\n    block_id_79046 = get_tblock_id(0);\n    global_tid_79044 = block_id_79046 * tblock_sizze_79048 + local_tid_79045;\n    phys_tid_74602 = sext_i32_i64(global_tid_79044);\n    global_tid_79049 = sext_i32_i64(block_id_79046) * segmap_tblock_sizze_74598 + sext_i32_i64(local_tid_79045);\n    slice_79050 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_74601 = global_tid_79049;\n    remnant_79051 = global_tid_79049 - gtid_74601;\n    if (slt64(gtid_74601, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76048;\n        int64_t eta_p_74603;\n        int64_t eta_p_74604;\n        int64_t defunc_0_f_res_74605;\n        \n        slice_76048 = loopres_f_res_f_res_67593 + gtid_74601;\n        eta_p_74603 = ((__global int64_t *) mem_param_77685)[ctx_param_ext_77683 + slice_76048 * ctx_param_ext_77684];\n        eta_p_74604 = ((__global int64_t *) ext_mem_77878)[gtid_74601];\n        defunc_0_f_res_74605 = add64(eta_p_74603, eta_p_74604);\n        ((__global int64_t *) mem_77884)[gtid_74601] = defunc_0_f_res_74605;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74598\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74623_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74623(__global int *global_failure, int64_t nR_54353, int64_t ext_78072, int64_t ext_78073, __global unsigned char *mem_param_77640, __global unsigned char *ext_mem_7807",
                                    "4, __global unsigned char *mem_78080)\n{\n    #define segmap_tblock_sizze_74619 (inner_SMJ_floatzisegmap_74623zisegmap_tblock_sizze_74619)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79054;\n    int32_t tblock_sizze_79057;\n    int32_t wave_sizze_79056;\n    int32_t block_id_79055;\n    int32_t global_tid_79053;\n    int64_t phys_tid_74623;\n    int64_t global_tid_79058;\n    int64_t slice_79059;\n    int64_t gtid_74622;\n    int64_t remnant_79060;\n    \n    local_tid_79054 = get_local_id(0);\n    tblock_sizze_79057 = get_local_size(0);\n    wave_sizze_79056 = LOCKSTEP_WIDTH;\n    block_id_79055 = get_tblock_id(0);\n    global_tid_79053 = block_id_79055 * tblock_sizze_79057 + local_tid_79054;\n    phys_tid_74623 = sext_i32_i64(global_tid_79053);\n    global_tid_79058 = sext_i32_i64(block_id_79055) * segmap_tblock_sizze_74619 + sext_i32_i64(local_tid_79054);\n    slice_79059 = nR_54353;\n    gtid_74622 = global_tid_79058;\n    remnant_79060 = global_tid_79058 - gtid_74622;\n    if (slt64(gtid_74622, nR_54353)) {\n        int64_t eta_p_74624;\n        bool cond_74626;\n        int64_t lifted_lambda_res_74627;\n        \n        eta_p_74624 = ((__global int64_t *) mem_param_77640)[gtid_74622];\n        cond_74626 = slt64(eta_p_74624, (int64_t) 0);\n        if (cond_74626) {\n            int64_t eta_p_74625 = ((__global int64_t *) ext_mem_78074)[ext_78073 + gtid_74622 * ext_78072];\n            \n            lifted_lambda_res_74627 = eta_p_74625;\n        } else {\n            lifted_lambda_res_74627 = eta_p_74624;\n        }\n        ((__global int64_t *) mem_78080)[gtid_74622] = lifted_lambda_res_74627;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74619\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74644_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74644(__global int *global_failure, int64_t nR_54353, int64_t ext_78075, int64_t ext_78076, __global unsigned char *mem_param_77637, __global unsigned char *ext_mem_78077, __global unsigned char *mem_78083)\n{\n    ", "#define segmap_tblock_sizze_74640 (inner_SMJ_floatzisegmap_74644zisegmap_tblock_sizze_74640)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79063;\n    int32_t tblock_sizze_79066;\n    int32_t wave_sizze_79065;\n    int32_t block_id_79064;\n    int32_t global_tid_79062;\n    int64_t phys_tid_74644;\n    int64_t global_tid_79067;\n    int64_t slice_79068;\n    int64_t gtid_74643;\n    int64_t remnant_79069;\n    \n    local_tid_79063 = get_local_id(0);\n    tblock_sizze_79066 = get_local_size(0);\n    wave_sizze_79065 = LOCKSTEP_WIDTH;\n    block_id_79064 = get_tblock_id(0);\n    global_tid_79062 = block_id_79064 * tblock_sizze_79066 + local_tid_79063;\n    phys_tid_74644 = sext_i32_i64(global_tid_79062);\n    global_tid_79067 = sext_i32_i64(block_id_79064) * segmap_tblock_sizze_74640 + sext_i32_i64(local_tid_79063);\n    slice_79068 = nR_54353;\n    gtid_74643 = global_tid_79067;\n    remnant_79069 = global_tid_79067 - gtid_74643;\n    if (slt64(gtid_74643, nR_54353)) {\n        int64_t eta_p_74645;\n        int64_t eta_p_74646;\n        int64_t defunc_0_f_res_74647;\n        \n        eta_p_74645 = ((__global int64_t *) mem_param_77637)[gtid_74643];\n        eta_p_74646 = ((__global int64_t *) ext_mem_78077)[ext_78076 + gtid_74643 * ext_78075];\n        defunc_0_f_res_74647 = add64(eta_p_74645, eta_p_74646);\n        ((__global int64_t *) mem_78083)[gtid_74643] = defunc_0_f_res_74647;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74640\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74657_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74657(__global int *global_failure, int64_t nR_54353, int64_t m_67844, int64_t num_tblocks_74662, int32_t virt_num_tblocks_79220, __global unsigned char *tR_mem_77625, __global unsigned char *ext_mem_77627, __global unsigned char *ext_mem_78095, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *mem_78103, __global unsigned char *mem_78105, __gl", "obal unsigned char *mem_78107, __global unsigned char *mem_78109)\n{\n    #define segmap_tblock_sizze_74660 (inner_SMJ_floatzisegmap_74657zisegmap_tblock_sizze_74660)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79222;\n    int32_t tblock_sizze_79225;\n    int32_t wave_sizze_79224;\n    int32_t block_id_79223;\n    int32_t global_tid_79221;\n    int64_t phys_tid_74657;\n    int32_t phys_tblock_id_79226;\n    int32_t iterations_79227;\n    \n    local_tid_79222 = get_local_id(0);\n    tblock_sizze_79225 = get_local_size(0);\n    wave_sizze_79224 = LOCKSTEP_WIDTH;\n    block_id_79223 = get_tblock_id(0);\n    global_tid_79221 = block_id_79223 * tblock_sizze_79225 + local_tid_79222;\n    phys_tid_74657 = sext_i32_i64(global_tid_79221);\n    phys_tblock_id_79226 = get_tblock_id(0);\n    iterations_79227 = sdiv_up32(virt_num_tblocks_79220 - phys_tblock_id_79226, sext_i64_i32(num_tblocks_74662));\n    for (int32_t i_79228 = 0; i_79228 < iterations_79227; i_79228++) {\n        int32_t virt_tblock_id_79229;\n        int64_t global_tid_79230;\n        int64_t slice_79231;\n        int64_t write_i_74656;\n        int64_t remnant_79232;\n        \n        virt_tblock_id_79229 = phys_tblock_id_79226 + i_79228 * sext_i64_i32(num_tblocks_74662);\n        global_tid_79230 = sext_i32_i64(virt_tblock_id_79229) * segmap_tblock_sizze_74660 + sext_i32_i64(local_tid_79222);\n        slice_79231 = nR_54353;\n        write_i_74656 = global_tid_79230;\n        remnant_79232 = global_tid_79230 - write_i_74656;\n        if (slt64(write_i_74656, nR_54353)) {\n            int64_t eta_p_68109;\n            float write_value_68111;\n            int64_t write_value_68112;\n            int64_t write_value_68113;\n            int64_t write_value_68114;\n            bool cond_68115;\n            int64_t lifted_lambda_res_68116;\n            \n            eta_p_68109 = ((__global int64_t *) mem_78101)[write_i_74656];\n            write_value_68111 = ((__global float *) tR_mem_77625)[write_i_74656];\n            wri",
                                    "te_value_68112 = ((__global int64_t *) ext_mem_77627)[write_i_74656];\n            write_value_68113 = ((__global int64_t *) ext_mem_78095)[write_i_74656];\n            write_value_68114 = ((__global int64_t *) ext_mem_78096)[write_i_74656];\n            cond_68115 = eta_p_68109 == (int64_t) 1;\n            if (cond_68115) {\n                int64_t eta_p_68110;\n                int64_t lifted_lambda_res_t_res_68890;\n                \n                eta_p_68110 = ((__global int64_t *) mem_78099)[write_i_74656];\n                lifted_lambda_res_t_res_68890 = sub64(eta_p_68110, (int64_t) 1);\n                lifted_lambda_res_68116 = lifted_lambda_res_t_res_68890;\n            } else {\n                lifted_lambda_res_68116 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global float *) mem_78109)[lifted_lambda_res_68116] = write_value_68111;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78107)[lifted_lambda_res_68116] = write_value_68112;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78105)[lifted_lambda_res_68116] = write_value_68113;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78103)[lifted_lambda_res_68116] = write_value_68114;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_74660\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74691_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74691(__global int *global_failure, int64_t m_67844, __global unsigned char *mem_78113, __global unsigned char *mem_78120)\n{\n    #define segmap_tblock", "_sizze_74687 (inner_SMJ_floatzisegmap_74691zisegmap_tblock_sizze_74687)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79388;\n    int32_t tblock_sizze_79391;\n    int32_t wave_sizze_79390;\n    int32_t block_id_79389;\n    int32_t global_tid_79387;\n    int64_t phys_tid_74691;\n    int64_t global_tid_79392;\n    int64_t slice_79393;\n    int64_t gtid_74690;\n    int64_t remnant_79394;\n    \n    local_tid_79388 = get_local_id(0);\n    tblock_sizze_79391 = get_local_size(0);\n    wave_sizze_79390 = LOCKSTEP_WIDTH;\n    block_id_79389 = get_tblock_id(0);\n    global_tid_79387 = block_id_79389 * tblock_sizze_79391 + local_tid_79388;\n    phys_tid_74691 = sext_i32_i64(global_tid_79387);\n    global_tid_79392 = sext_i32_i64(block_id_79389) * segmap_tblock_sizze_74687 + sext_i32_i64(local_tid_79388);\n    slice_79393 = m_67844;\n    gtid_74690 = global_tid_79392;\n    remnant_79394 = global_tid_79392 - gtid_74690;\n    if (slt64(gtid_74690, m_67844)) {\n        int64_t zv_lhs_74693;\n        int64_t tmp_74694;\n        bool cond_74696;\n        int64_t lifted_lambda_res_74697;\n        \n        zv_lhs_74693 = add64((int64_t) -1, gtid_74690);\n        tmp_74694 = smod64(zv_lhs_74693, m_67844);\n        cond_74696 = gtid_74690 == (int64_t) 0;\n        if (cond_74696) {\n            lifted_lambda_res_74697 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_74695 = ((__global int64_t *) mem_78113)[tmp_74694];\n            \n            lifted_lambda_res_74697 = lifted_lambda_res_74695;\n        }\n        ((__global int64_t *) mem_78120)[gtid_74690] = lifted_lambda_res_74697;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74687\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74699_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74699(__global int *global_failure, int64_t m_67844, int64_t lower_bound_67927, int64_t min_res_67929, int64_t j_m_i_67930, int64_t num_tblocks_74704, int32_t virt_num_tblocks_79433, __global unsigned char *mem_78105, __global uns", "igned char *mem_78107, __global unsigned char *mem_78109, __global unsigned char *mem_78120, __global unsigned char *mem_78149, __global unsigned char *mem_78151, __global unsigned char *mem_78153)\n{\n    #define segmap_tblock_sizze_74702 (inner_SMJ_floatzisegmap_74699zisegmap_tblock_sizze_74702)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79435;\n    int32_t tblock_sizze_79438;\n    int32_t wave_sizze_79437;\n    int32_t block_id_79436;\n    int32_t global_tid_79434;\n    int64_t phys_tid_74699;\n    int32_t phys_tblock_id_79439;\n    int32_t iterations_79440;\n    \n    local_tid_79435 = get_local_id(0);\n    tblock_sizze_79438 = get_local_size(0);\n    wave_sizze_79437 = LOCKSTEP_WIDTH;\n    block_id_79436 = get_tblock_id(0);\n    global_tid_79434 = block_id_79436 * tblock_sizze_79438 + local_tid_79435;\n    phys_tid_74699 = sext_i32_i64(global_tid_79434);\n    phys_tblock_id_79439 = get_tblock_id(0);\n    iterations_79440 = sdiv_up32(virt_num_tblocks_79433 - phys_tblock_id_79439, sext_i64_i32(num_tblocks_74704));\n    for (int32_t i_79441 = 0; i_79441 < iterations_79440; i_79441++) {\n        int32_t virt_tblock_id_79442;\n        int64_t global_tid_79443;\n        int64_t slice_79444;\n        int64_t write_i_74698;\n        int64_t remnant_79445;\n        \n        virt_tblock_id_79442 = phys_tblock_id_79439 + i_79441 * sext_i64_i32(num_tblocks_74704);\n        global_tid_79443 = sext_i32_i64(virt_tblock_id_79442) * segmap_tblock_sizze_74702 + sext_i32_i64(local_tid_79435);\n        slice_79444 = m_67844;\n        write_i_74698 = global_tid_79443;\n        remnant_79445 = global_tid_79443 - write_i_74698;\n        if (slt64(write_i_74698, m_67844)) {\n            int64_t eta_p_68502;\n            float write_value_68503;\n            int64_t write_value_68504;\n            int64_t write_value_68505;\n            bool cond_68506;\n            bool cond_t_res_68507;\n            bool x_68508;\n            int64_t lifted_lambda_res_68509;\n            \n            eta_p_68",
                                    "502 = ((__global int64_t *) mem_78120)[write_i_74698];\n            write_value_68503 = ((__global float *) mem_78109)[write_i_74698];\n            write_value_68504 = ((__global int64_t *) mem_78107)[write_i_74698];\n            write_value_68505 = ((__global int64_t *) mem_78105)[write_i_74698];\n            cond_68506 = sle64(lower_bound_67927, eta_p_68502);\n            cond_t_res_68507 = slt64(eta_p_68502, min_res_67929);\n            x_68508 = cond_68506 && cond_t_res_68507;\n            if (x_68508) {\n                int64_t lifted_lambda_res_t_res_68893 = sub64(eta_p_68502, lower_bound_67927);\n                \n                lifted_lambda_res_68509 = lifted_lambda_res_t_res_68893;\n            } else {\n                lifted_lambda_res_68509 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global float *) mem_78149)[lifted_lambda_res_68509] = write_value_68503;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78151)[lifted_lambda_res_68509] = write_value_68504;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78153)[lifted_lambda_res_68509] = write_value_68505;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_74702\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74707_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74707(__global int *global_failure, int64_t m_67844, int64_t m_67984, int64_t num_tblocks_74712, int32_t virt_num_tblocks_79415, __global unsigned char *mem_78103, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *mem_78120, __global unsigned char *mem_78128, __global unsigned char", " *mem_78130)\n{\n    #define segmap_tblock_sizze_74710 (inner_SMJ_floatzisegmap_74707zisegmap_tblock_sizze_74710)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79417;\n    int32_t tblock_sizze_79420;\n    int32_t wave_sizze_79419;\n    int32_t block_id_79418;\n    int32_t global_tid_79416;\n    int64_t phys_tid_74707;\n    int32_t phys_tblock_id_79421;\n    int32_t iterations_79422;\n    \n    local_tid_79417 = get_local_id(0);\n    tblock_sizze_79420 = get_local_size(0);\n    wave_sizze_79419 = LOCKSTEP_WIDTH;\n    block_id_79418 = get_tblock_id(0);\n    global_tid_79416 = block_id_79418 * tblock_sizze_79420 + local_tid_79417;\n    phys_tid_74707 = sext_i32_i64(global_tid_79416);\n    phys_tblock_id_79421 = get_tblock_id(0);\n    iterations_79422 = sdiv_up32(virt_num_tblocks_79415 - phys_tblock_id_79421, sext_i64_i32(num_tblocks_74712));\n    for (int32_t i_79423 = 0; i_79423 < iterations_79422; i_79423++) {\n        int32_t virt_tblock_id_79424;\n        int64_t global_tid_79425;\n        int64_t slice_79426;\n        int64_t write_i_74706;\n        int64_t remnant_79427;\n        \n        virt_tblock_id_79424 = phys_tblock_id_79421 + i_79423 * sext_i64_i32(num_tblocks_74712);\n        global_tid_79425 = sext_i32_i64(virt_tblock_id_79424) * segmap_tblock_sizze_74710 + sext_i32_i64(local_tid_79417);\n        slice_79426 = m_67844;\n        write_i_74706 = global_tid_79425;\n        remnant_79427 = global_tid_79425 - write_i_74706;\n        if (slt64(write_i_74706, m_67844)) {\n            int64_t eta_p_68086;\n            int64_t write_value_68088;\n            int64_t write_value_68089;\n            bool cond_68090;\n            int64_t lifted_lambda_res_68091;\n            \n            eta_p_68086 = ((__global int64_t *) mem_78117)[write_i_74706];\n            write_value_68088 = ((__global int64_t *) mem_78120)[write_i_74706];\n            write_value_68089 = ((__global int64_t *) mem_78103)[write_i_74706];\n            cond_68090 = eta_p_68086 == (int64_t) 1;\n            i", "f (cond_68090) {\n                int64_t eta_p_68087;\n                int64_t lifted_lambda_res_t_res_68898;\n                \n                eta_p_68087 = ((__global int64_t *) mem_78115)[write_i_74706];\n                lifted_lambda_res_t_res_68898 = sub64(eta_p_68087, (int64_t) 1);\n                lifted_lambda_res_68091 = lifted_lambda_res_t_res_68898;\n            } else {\n                lifted_lambda_res_68091 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78130)[lifted_lambda_res_68091] = write_value_68088;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78128)[lifted_lambda_res_68091] = write_value_68089;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_74710\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_74729_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_74729(__global int *global_failure, int64_t loopres_68028, int64_t loopres_68029, __global unsigned char *mem_78178, __global unsigned char *mem_78181)\n{\n    #define segmap_tblock_sizze_74725 (inner_SMJ_floatzisegmap_74729zisegmap_tblock_sizze_74725)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79502;\n    int32_t tblock_sizze_79505;\n    int32_t wave_sizze_79504;\n    int32_t block_id_79503;\n    int32_t global_tid_79501;\n    int64_t phys_tid_74729;\n    int64_t global_tid_79506;\n    int64_t slice_79507;\n    int64_t gtid_74728;\n    int64_t remnant_79508;\n    \n    local_tid_79502 = get_local_id(0);\n    tblock_sizze_79505 = get_local_size(0);\n    wave_sizze_79504 = LOCKSTEP_WIDTH;\n    block_id_79503 = get_tblock_id(0);\n    global_tid_79501 = block_id_79503 * tblock_sizze_79505 + local_tid_79502;\n    phys_tid_74729 = sext_i32_i64(global_tid_79501);\n  ",
                                    "  global_tid_79506 = sext_i32_i64(block_id_79503) * segmap_tblock_sizze_74725 + sext_i32_i64(local_tid_79502);\n    slice_79507 = loopres_68029;\n    gtid_74728 = global_tid_79506;\n    remnant_79508 = global_tid_79506 - gtid_74728;\n    if (slt64(gtid_74728, loopres_68029)) {\n        int64_t loopres_77620;\n        int64_t tmp_74731;\n        \n        loopres_77620 = ((__global int64_t *) mem_78181)[(int64_t) 0];\n        tmp_74731 = add64(gtid_74728, loopres_77620);\n        ((__global int64_t *) mem_78178)[loopres_68028 + gtid_74728] = tmp_74731;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74725\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_76057_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_76057(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76060, int64_t num_whole_tiles_76075, int64_t residual_input_76299, unsigned char cond_76300_bits, int64_t binop_x_76316, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_78045, __global unsigned char *mem_78047)\n{\n    bool cond_76300 = cond_76300_bits;\n    \n    #define tile_sizze_76059 (inner_SMJ_floatzisegmap_intrablock_76057zitile_sizze_76059)\n    #define bytes_78007 (inner_SMJ_floatzisegmap_intrablock_76057zibytes_78007)\n    #define bytes_78009 (inner_SMJ_floatzisegmap_intrablock_76057zibytes_78009)\n    \n    volatile __local unsigned char *color_78690_backing_2 = &shared_mem[0];\n    const int64_t color_78690_backing_2_offset = 0 + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78689_backing_1 = &shared_mem[color_78690_backing_2_offset];\n    const int64_t color_78689_backing_1_offset = color_78690_backing_2_offset + (bytes_78009 + srem64((int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8));\n ", "   volatile __local unsigned char *color_78688_backing_0 = &shared_mem[color_78689_backing_1_offset];\n    const int64_t color_78688_backing_0_offset = color_78689_backing_1_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78799;\n    int32_t tblock_sizze_78802;\n    int32_t wave_sizze_78801;\n    int32_t block_id_78800;\n    int32_t global_tid_78798;\n    int64_t gid_flat_76057;\n    int64_t slice_78804;\n    int64_t ltid_pre_78803;\n    int64_t remnant_78805;\n    int64_t slice_78806;\n    int64_t gid_76056;\n    int64_t remnant_78807;\n    __local unsigned char *color_78688;\n    __local unsigned char *color_78689;\n    __local unsigned char *color_78690;\n    int64_t binop_x_76067;\n    float mem_77991[1];\n    int64_t ltid_flat_76062;\n    int64_t ltid_76061;\n    int64_t gtid_76068;\n    bool cond_76069;\n    float pre_76070;\n    int64_t mem_77995[1];\n    float mem_77999[1];\n    int64_t mem_78003[1];\n    int64_t ltid_flat_76077;\n    int64_t ltid_76076;\n    int64_t gtid_76087;\n    bool cond_76088;\n    int64_t neutral_76089;\n    float neutral_76090;\n    int64_t ext_mem_78027[1];\n    float ext_mem_78026[1];\n    int64_t ext_mem_78025[1];\n    int64_t mem_param_78004[1];\n    float mem_param_78005[1];\n    int64_t mem_param_78006[1];\n    int64_t mem_78037[1];\n    int64_t mem_78041[1];\n    int64_t ext_mem_78043[1];\n    int64_t ext_mem_78042[1];\n    \n    local_tid_78799 = get_local_id(0);\n    tblock_sizze_78802 = get_local_size(0);\n    wave_sizze_78801 = LOCKSTEP_WIDTH;\n    block_id_78800 = get_tblock_id(0);\n    global_tid_78798 = block_id_78800 * tblock_sizze_78802 + local_tid_78799;\n    gid_flat_76057 = sext_i32_i64(block_id_78800);\n    slice_78804 = tile_sizze_76059;\n    ltid_pre_78803 = sext_i32_i64(local_tid_78799);\n    remnant_78805 = sext_i32_i64(local_tid_78799) - ltid_pre_78803;\n    slice_78806 = ldim_76060;\n    gid_76056 = sext_i32_i64(block_id_78800);\n    remn", "ant_78807 = sext_i32_i64(block_id_78800) - gid_76056;\n    color_78688 = (__local unsigned char *) color_78688_backing_0;\n    color_78689 = (__local unsigned char *) color_78689_backing_1;\n    color_78690 = (__local unsigned char *) color_78690_backing_2;\n    binop_x_76067 = gid_76056 * tile_sizze_76059;\n    ltid_flat_76062 = sext_i32_i64(local_tid_78799);\n    ltid_76061 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76068 = ltid_76061 + binop_x_76067;\n    cond_76069 = slt64(gtid_76068, min_res_68560);\n    if (cond_76069) {\n        int64_t slice_76071;\n        float eta_p_76072;\n        \n        slice_76071 = start_68558 + gtid_76068;\n        eta_p_76072 = ((__global float *) tR_mem_77625)[slice_76071];\n        pre_76070 = eta_p_76072;\n    } else {\n        pre_76070 = 0.0F;\n    }\n    mem_77991[(int64_t) 0] = pre_76070;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76077 = sext_i32_i64(local_tid_78799);\n    ltid_76076 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76087 = binop_x_76067 + ltid_76076;\n    cond_76088 = slt64(gtid_76087, min_res_68560);\n    if (cond_76088) {\n        neutral_76089 = (int64_t) -1;\n    } else {\n        neutral_76089 = (int64_t) 0;\n    }\n    if (cond_76088) {\n        float eta_p_76092 = mem_77991[(int64_t) 0];\n        \n        neutral_76090 = eta_p_76092;\n    } else {\n        neutral_76090 = 0.0F;\n    }\n    mem_77995[(int64_t) 0] = neutral_76089;\n    mem_77999[(int64_t) 0] = neutral_76090;\n    mem_78003[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_78004[i_3] = mem_77995[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_78005[i_4] = mem_77999[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_78006[i_5] = mem_78003[i_5];\n    for (int64_t tile_id_76102 = 0; tile_id_76102 < num_whole_tiles_76075; tile_id_76102++) {\n        int64_t binop_x_76201;\n        int64_t ltid_flat_76200;\n        in",
                                    "t64_t ltid_76199;\n        int64_t j_76202;\n        bool cond_76206;\n        int64_t pre1d_76209;\n        int64_t pre1d_76207;\n        float pre1d_76208;\n        int64_t mem_78016[1];\n        float mem_78020[1];\n        int64_t mem_78024[1];\n        int64_t ltid_flat_76220;\n        int64_t ltid_76219;\n        int64_t gtid_76222;\n        int64_t acc_76224;\n        float acc_76225;\n        int64_t acc_76226;\n        bool cond_76227;\n        int64_t acc_76228;\n        float acc_76229;\n        int64_t acc_76230;\n        int64_t mem_param_tmp_78808[1];\n        float mem_param_tmp_78809[1];\n        int64_t mem_param_tmp_78810[1];\n        \n        binop_x_76201 = tile_sizze_76059 * tile_id_76102;\n        ltid_flat_76200 = sext_i32_i64(local_tid_78799);\n        ltid_76199 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76202 = ltid_76199 + binop_x_76201;\n        cond_76206 = slt64(j_76202, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76209 = btoi_bool_i64(cond_76206);\n        if (cond_76206) {\n            int64_t tile_elem_76210;\n            int64_t slice_77479;\n            float tile_elem_76211;\n            \n            tile_elem_76210 = ((__global int64_t *) ext_mem_77925)[j_76202];\n            slice_77479 = tS_start_66998 + j_76202;\n            tile_elem_76211 = ((__global float *) tS_mem_77626)[slice_77479];\n            pre1d_76207 = tile_elem_76210;\n            pre1d_76208 = tile_elem_76211;\n        } else {\n            pre1d_76207 = (int64_t) 0;\n            pre1d_76208 = 0.0F;\n        }\n        ((__local int64_t *) color_78690)[ltid_76199] = pre1d_76207;\n        ((__local float *) color_78689)[ltid_76199] = pre1d_76208;\n        ((__local int64_t *) color_78688)[ltid_76199] = pre1d_76209;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76220 = sext_i32_i64(local_tid_78799);\n        ltid_76219 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76222 = binop_x_76067 + ltid_76219;\n        acc_76224 = mem_param_78004[(int64_t) 0];\n", "        acc_76225 = mem_param_78005[(int64_t) 0];\n        acc_76226 = mem_param_78006[(int64_t) 0];\n        cond_76227 = slt64(gtid_76222, min_res_68560);\n        if (cond_76227) {\n            float eta_p_76223;\n            int64_t x_76231;\n            float x_76232;\n            int64_t x_76233;\n            int64_t redout_77492;\n            float redout_77493;\n            int64_t redout_77494;\n            \n            eta_p_76223 = mem_77991[(int64_t) 0];\n            redout_77492 = acc_76224;\n            redout_77493 = acc_76225;\n            redout_77494 = acc_76226;\n            for (int64_t i_77495 = 0; i_77495 < tile_sizze_76059; i_77495++) {\n                int64_t x_76234;\n                float x_76235;\n                bool defunc_0_neq_res_76243;\n                bool defunc_0_neq_res_76244;\n                bool cond_f_res_76245;\n                bool y_76246;\n                bool cond_76247;\n                bool defunc_0_neq_res_76248;\n                bool defunc_0_neq_res_76249;\n                bool cond_t_res_f_res_76250;\n                bool y_76251;\n                bool cond_t_res_76252;\n                bool x_76253;\n                int64_t defunc_0_op_res_76254;\n                float defunc_0_op_res_76255;\n                int64_t defunc_0_op_res_76256;\n                int64_t redout_tmp_78814;\n                float redout_tmp_78815;\n                int64_t redout_tmp_78816;\n                \n                x_76234 = ((__local int64_t *) color_78690)[i_77495];\n                x_76235 = ((__local float *) color_78689)[i_77495];\n                defunc_0_neq_res_76243 = redout_77493 == eta_p_76223;\n                defunc_0_neq_res_76244 = !defunc_0_neq_res_76243;\n                cond_f_res_76245 = slt64(redout_77492, (int64_t) 0);\n                y_76246 = defunc_0_neq_res_76243 && cond_f_res_76245;\n                cond_76247 = defunc_0_neq_res_76244 || y_76246;\n                defunc_0_neq_res_76248 = x_76235 == eta_p_76223;\n                defunc_0_neq_res_76", "249 = !defunc_0_neq_res_76248;\n                cond_t_res_f_res_76250 = slt64(x_76234, (int64_t) 0);\n                y_76251 = defunc_0_neq_res_76248 && cond_t_res_f_res_76250;\n                cond_t_res_76252 = defunc_0_neq_res_76249 || y_76251;\n                x_76253 = cond_76247 && cond_t_res_76252;\n                if (x_76253) {\n                    defunc_0_op_res_76254 = (int64_t) -1;\n                    defunc_0_op_res_76255 = eta_p_76223;\n                    defunc_0_op_res_76256 = (int64_t) 0;\n                } else {\n                    int64_t x_76236;\n                    int64_t defunc_0_op_res_f_res_76257;\n                    float defunc_0_op_res_f_res_76258;\n                    int64_t defunc_0_op_res_f_res_76259;\n                    \n                    x_76236 = ((__local int64_t *) color_78688)[i_77495];\n                    if (cond_76247) {\n                        defunc_0_op_res_f_res_76257 = x_76234;\n                        defunc_0_op_res_f_res_76258 = x_76235;\n                        defunc_0_op_res_f_res_76259 = x_76236;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_76260;\n                        int64_t defunc_0_op_res_f_res_f_res_76261;\n                        int64_t defunc_0_op_res_f_res_f_res_76262;\n                        \n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76260 = redout_77493;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76260 = eta_p_76223;\n                        }\n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76261 = redout_77492;\n                            defunc_0_op_res_f_res_f_res_76262 = redout_77494;\n                        } else {\n                            int64_t min_res_76263;\n                            int64_t tmp_76264;\n                            \n                            min_res_76263 = smin64(x_76234, ",
                                    "redout_77492);\n                            tmp_76264 = add64(x_76236, redout_77494);\n                            defunc_0_op_res_f_res_f_res_76261 = min_res_76263;\n                            defunc_0_op_res_f_res_f_res_76262 = tmp_76264;\n                        }\n                        defunc_0_op_res_f_res_76257 = defunc_0_op_res_f_res_f_res_76261;\n                        defunc_0_op_res_f_res_76258 = defunc_0_op_res_f_res_f_res_76260;\n                        defunc_0_op_res_f_res_76259 = defunc_0_op_res_f_res_f_res_76262;\n                    }\n                    defunc_0_op_res_76254 = defunc_0_op_res_f_res_76257;\n                    defunc_0_op_res_76255 = defunc_0_op_res_f_res_76258;\n                    defunc_0_op_res_76256 = defunc_0_op_res_f_res_76259;\n                }\n                redout_tmp_78814 = defunc_0_op_res_76254;\n                redout_tmp_78815 = defunc_0_op_res_76255;\n                redout_tmp_78816 = defunc_0_op_res_76256;\n                redout_77492 = redout_tmp_78814;\n                redout_77493 = redout_tmp_78815;\n                redout_77494 = redout_tmp_78816;\n            }\n            x_76231 = redout_77492;\n            x_76232 = redout_77493;\n            x_76233 = redout_77494;\n            acc_76228 = x_76231;\n            acc_76229 = x_76232;\n            acc_76230 = x_76233;\n        } else {\n            acc_76228 = acc_76224;\n            acc_76229 = acc_76225;\n            acc_76230 = acc_76226;\n        }\n        mem_78016[(int64_t) 0] = acc_76228;\n        mem_78020[(int64_t) 0] = acc_76229;\n        mem_78024[(int64_t) 0] = acc_76230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78808[i_6] = mem_78016[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78809[i_7] = mem_78020[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78810[i_8] = mem_78024[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_", "param_78004[i_9] = mem_param_tmp_78808[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_78005[i_10] = mem_param_tmp_78809[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_78006[i_11] = mem_param_tmp_78810[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_78027[i_12] = mem_param_78004[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_78026[i_13] = mem_param_78005[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_78025[i_14] = mem_param_78006[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76300) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_78043[i_15] = ext_mem_78027[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_78042[i_16] = ext_mem_78025[i_16];\n    } else {\n        int64_t ltid_flat_76302;\n        int64_t ltid_76301;\n        int64_t j_76317;\n        bool cond_76321;\n        int64_t pre1d_76324;\n        int64_t pre1d_76322;\n        float pre1d_76323;\n        int64_t ltid_flat_76338;\n        int64_t ltid_76337;\n        int64_t gtid_76351;\n        int64_t acc_76353;\n        int64_t acc_76355;\n        bool cond_76356;\n        int64_t acc_76357;\n        int64_t acc_76359;\n        \n        ltid_flat_76302 = sext_i32_i64(local_tid_78799);\n        ltid_76301 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76317 = ltid_76301 + binop_x_76316;\n        cond_76321 = slt64(j_76317, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76324 = btoi_bool_i64(cond_76321);\n        if (cond_76321) {\n            int64_t tile_elem_76325;\n            int64_t slice_77478;\n            float tile_elem_76326;\n            \n            tile_elem_76325 = ((__global int64_t *) ext_mem_77925)[j_76317];\n            slice_77478 = tS_start_66998 + j_76317;\n            tile_elem_76326 = ((__global float *) tS_mem_77626)[slice_77478];\n            pre1d_76322 = tile_elem_76325;\n            pre1d_76323 = tile", "_elem_76326;\n        } else {\n            pre1d_76322 = (int64_t) 0;\n            pre1d_76323 = 0.0F;\n        }\n        ((__local int64_t *) color_78690)[ltid_76301] = pre1d_76322;\n        ((__local float *) color_78689)[ltid_76301] = pre1d_76323;\n        ((__local int64_t *) color_78688)[ltid_76301] = pre1d_76324;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76338 = sext_i32_i64(local_tid_78799);\n        ltid_76337 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76351 = binop_x_76067 + ltid_76337;\n        acc_76353 = ext_mem_78027[(int64_t) 0];\n        acc_76355 = ext_mem_78025[(int64_t) 0];\n        cond_76356 = slt64(gtid_76351, min_res_68560);\n        if (cond_76356) {\n            float eta_p_76352;\n            float acc_76354;\n            int64_t x_76360;\n            float x_76361;\n            int64_t x_76362;\n            int64_t redout_77496;\n            float redout_77497;\n            int64_t redout_77498;\n            \n            eta_p_76352 = mem_77991[(int64_t) 0];\n            acc_76354 = ext_mem_78026[(int64_t) 0];\n            redout_77496 = acc_76353;\n            redout_77497 = acc_76354;\n            redout_77498 = acc_76355;\n            for (int64_t i_77499 = 0; i_77499 < residual_input_76299; i_77499++) {\n                int64_t x_76363;\n                float x_76364;\n                bool defunc_0_neq_res_76372;\n                bool defunc_0_neq_res_76373;\n                bool cond_f_res_76374;\n                bool y_76375;\n                bool cond_76376;\n                bool defunc_0_neq_res_76377;\n                bool defunc_0_neq_res_76378;\n                bool cond_t_res_f_res_76379;\n                bool y_76380;\n                bool cond_t_res_76381;\n                bool x_76382;\n                int64_t defunc_0_op_res_76383;\n                float defunc_0_op_res_76384;\n                int64_t defunc_0_op_res_76385;\n                int64_t redout_tmp_78817;\n                float redout_tmp_78818;\n                int64_t redout",
                                    "_tmp_78819;\n                \n                x_76363 = ((__local int64_t *) color_78690)[i_77499];\n                x_76364 = ((__local float *) color_78689)[i_77499];\n                defunc_0_neq_res_76372 = redout_77497 == eta_p_76352;\n                defunc_0_neq_res_76373 = !defunc_0_neq_res_76372;\n                cond_f_res_76374 = slt64(redout_77496, (int64_t) 0);\n                y_76375 = defunc_0_neq_res_76372 && cond_f_res_76374;\n                cond_76376 = defunc_0_neq_res_76373 || y_76375;\n                defunc_0_neq_res_76377 = x_76364 == eta_p_76352;\n                defunc_0_neq_res_76378 = !defunc_0_neq_res_76377;\n                cond_t_res_f_res_76379 = slt64(x_76363, (int64_t) 0);\n                y_76380 = defunc_0_neq_res_76377 && cond_t_res_f_res_76379;\n                cond_t_res_76381 = defunc_0_neq_res_76378 || y_76380;\n                x_76382 = cond_76376 && cond_t_res_76381;\n                if (x_76382) {\n                    defunc_0_op_res_76383 = (int64_t) -1;\n                    defunc_0_op_res_76384 = eta_p_76352;\n                    defunc_0_op_res_76385 = (int64_t) 0;\n                } else {\n                    int64_t x_76365;\n                    int64_t defunc_0_op_res_f_res_76386;\n                    float defunc_0_op_res_f_res_76387;\n                    int64_t defunc_0_op_res_f_res_76388;\n                    \n                    x_76365 = ((__local int64_t *) color_78688)[i_77499];\n                    if (cond_76376) {\n                        defunc_0_op_res_f_res_76386 = x_76363;\n                        defunc_0_op_res_f_res_76387 = x_76364;\n                        defunc_0_op_res_f_res_76388 = x_76365;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_76389;\n                        int64_t defunc_0_op_res_f_res_f_res_76390;\n                        int64_t defunc_0_op_res_f_res_f_res_76391;\n                        \n                        if (cond_t_res_76381) {\n                            defu", "nc_0_op_res_f_res_f_res_76389 = redout_77497;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76389 = eta_p_76352;\n                        }\n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76390 = redout_77496;\n                            defunc_0_op_res_f_res_f_res_76391 = redout_77498;\n                        } else {\n                            int64_t min_res_76392;\n                            int64_t tmp_76393;\n                            \n                            min_res_76392 = smin64(x_76363, redout_77496);\n                            tmp_76393 = add64(x_76365, redout_77498);\n                            defunc_0_op_res_f_res_f_res_76390 = min_res_76392;\n                            defunc_0_op_res_f_res_f_res_76391 = tmp_76393;\n                        }\n                        defunc_0_op_res_f_res_76386 = defunc_0_op_res_f_res_f_res_76390;\n                        defunc_0_op_res_f_res_76387 = defunc_0_op_res_f_res_f_res_76389;\n                        defunc_0_op_res_f_res_76388 = defunc_0_op_res_f_res_f_res_76391;\n                    }\n                    defunc_0_op_res_76383 = defunc_0_op_res_f_res_76386;\n                    defunc_0_op_res_76384 = defunc_0_op_res_f_res_76387;\n                    defunc_0_op_res_76385 = defunc_0_op_res_f_res_76388;\n                }\n                redout_tmp_78817 = defunc_0_op_res_76383;\n                redout_tmp_78818 = defunc_0_op_res_76384;\n                redout_tmp_78819 = defunc_0_op_res_76385;\n                redout_77496 = redout_tmp_78817;\n                redout_77497 = redout_tmp_78818;\n                redout_77498 = redout_tmp_78819;\n            }\n            x_76360 = redout_77496;\n            x_76361 = redout_77497;\n            x_76362 = redout_77498;\n            acc_76357 = x_76360;\n            acc_76359 = x_76362;\n        } else {\n            acc_76357 = acc_76353;\n            acc_76359 = acc_76355;\n       ", " }\n        mem_78037[(int64_t) 0] = acc_76357;\n        mem_78041[(int64_t) 0] = acc_76359;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_78043[i_17] = mem_78037[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_78042[i_18] = mem_78041[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78820 = ext_mem_78043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78045)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78820;\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78821 = ext_mem_78042[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78047)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78821;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76059\n    #undef bytes_78007\n    #undef bytes_78009\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_76412_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_76412(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76415, int64_t num_whole_tiles_76430, int64_t residual_input_76654, unsigned char cond_76655_bits, int64_t binop_x_76671, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_77984, __global unsigned char *mem_77986)\n{\n    bool cond_76655 = cond_76655_bits;\n    \n    #define tile_sizze_76414 (inner_SMJ_floatzisegmap_intrablock_76412zitile_sizze_76414)\n    #define bytes_77946 (inner_SMJ_floatzisegmap_intrablock_76412zibytes_77946)\n    #define bytes_77948 (inner_SMJ_floatzisegmap_intrablock_76412zibytes_77948)\n    \n    volatile __local unsign",
                                    "ed char *color_78693_backing_2 = &shared_mem[0];\n    const int64_t color_78693_backing_2_offset = 0 + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78692_backing_1 = &shared_mem[color_78693_backing_2_offset];\n    const int64_t color_78692_backing_1_offset = color_78693_backing_2_offset + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78691_backing_0 = &shared_mem[color_78692_backing_1_offset];\n    const int64_t color_78691_backing_0_offset = color_78692_backing_1_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78825;\n    int32_t tblock_sizze_78828;\n    int32_t wave_sizze_78827;\n    int32_t block_id_78826;\n    int32_t global_tid_78824;\n    int64_t gid_flat_76412;\n    int64_t slice_78830;\n    int64_t ltid_pre_78829;\n    int64_t remnant_78831;\n    int64_t slice_78832;\n    int64_t gid_76411;\n    int64_t remnant_78833;\n    __local unsigned char *color_78691;\n    __local unsigned char *color_78692;\n    __local unsigned char *color_78693;\n    int64_t binop_x_76422;\n    float mem_77930[1];\n    int64_t ltid_flat_76417;\n    int64_t ltid_76416;\n    int64_t gtid_76423;\n    bool cond_76424;\n    float pre_76425;\n    int64_t mem_77934[1];\n    float mem_77938[1];\n    int64_t mem_77942[1];\n    int64_t ltid_flat_76432;\n    int64_t ltid_76431;\n    int64_t gtid_76442;\n    bool cond_76443;\n    int64_t neutral_76444;\n    float neutral_76445;\n    int64_t ext_mem_77966[1];\n    float ext_mem_77965[1];\n    int64_t ext_mem_77964[1];\n    int64_t mem_param_77943[1];\n    float mem_param_77944[1];\n    int64_t mem_param_77945[1];\n    int64_t mem_77976[1];\n    int64_t mem_77980[1];\n    int64_t ext_mem_77982[1];\n    int64_t ext_mem_77981[1];\n    \n    local_tid_78825 = get_local_id(0);\n    tblock_sizze_78828 = get_local_", "size(0);\n    wave_sizze_78827 = LOCKSTEP_WIDTH;\n    block_id_78826 = get_tblock_id(0);\n    global_tid_78824 = block_id_78826 * tblock_sizze_78828 + local_tid_78825;\n    gid_flat_76412 = sext_i32_i64(block_id_78826);\n    slice_78830 = tile_sizze_76414;\n    ltid_pre_78829 = sext_i32_i64(local_tid_78825);\n    remnant_78831 = sext_i32_i64(local_tid_78825) - ltid_pre_78829;\n    slice_78832 = ldim_76415;\n    gid_76411 = sext_i32_i64(block_id_78826);\n    remnant_78833 = sext_i32_i64(block_id_78826) - gid_76411;\n    color_78691 = (__local unsigned char *) color_78691_backing_0;\n    color_78692 = (__local unsigned char *) color_78692_backing_1;\n    color_78693 = (__local unsigned char *) color_78693_backing_2;\n    binop_x_76422 = gid_76411 * tile_sizze_76414;\n    ltid_flat_76417 = sext_i32_i64(local_tid_78825);\n    ltid_76416 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76423 = ltid_76416 + binop_x_76422;\n    cond_76424 = slt64(gtid_76423, min_res_68560);\n    if (cond_76424) {\n        int64_t slice_76426;\n        float eta_p_76427;\n        \n        slice_76426 = start_68558 + gtid_76423;\n        eta_p_76427 = ((__global float *) tR_mem_77625)[slice_76426];\n        pre_76425 = eta_p_76427;\n    } else {\n        pre_76425 = 0.0F;\n    }\n    mem_77930[(int64_t) 0] = pre_76425;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76432 = sext_i32_i64(local_tid_78825);\n    ltid_76431 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76442 = binop_x_76422 + ltid_76431;\n    cond_76443 = slt64(gtid_76442, min_res_68560);\n    if (cond_76443) {\n        neutral_76444 = (int64_t) -1;\n    } else {\n        neutral_76444 = (int64_t) 0;\n    }\n    if (cond_76443) {\n        float eta_p_76447 = mem_77930[(int64_t) 0];\n        \n        neutral_76445 = eta_p_76447;\n    } else {\n        neutral_76445 = 0.0F;\n    }\n    mem_77934[(int64_t) 0] = neutral_76444;\n    mem_77938[(int64_t) 0] = neutral_76445;\n    mem_77942[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(C", "LK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77943[i_3] = mem_77934[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77944[i_4] = mem_77938[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77945[i_5] = mem_77942[i_5];\n    for (int64_t tile_id_76457 = 0; tile_id_76457 < num_whole_tiles_76430; tile_id_76457++) {\n        int64_t binop_x_76556;\n        int64_t ltid_flat_76555;\n        int64_t ltid_76554;\n        int64_t j_76557;\n        bool cond_76561;\n        int64_t pre1d_76564;\n        int64_t pre1d_76562;\n        float pre1d_76563;\n        int64_t mem_77955[1];\n        float mem_77959[1];\n        int64_t mem_77963[1];\n        int64_t ltid_flat_76575;\n        int64_t ltid_76574;\n        int64_t gtid_76577;\n        int64_t acc_76579;\n        float acc_76580;\n        int64_t acc_76581;\n        bool cond_76582;\n        int64_t acc_76583;\n        float acc_76584;\n        int64_t acc_76585;\n        int64_t mem_param_tmp_78834[1];\n        float mem_param_tmp_78835[1];\n        int64_t mem_param_tmp_78836[1];\n        \n        binop_x_76556 = tile_sizze_76414 * tile_id_76457;\n        ltid_flat_76555 = sext_i32_i64(local_tid_78825);\n        ltid_76554 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76557 = ltid_76554 + binop_x_76556;\n        cond_76561 = slt64(j_76557, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76564 = btoi_bool_i64(cond_76561);\n        if (cond_76561) {\n            int64_t tile_elem_76565;\n            int64_t slice_77483;\n            float tile_elem_76566;\n            \n            tile_elem_76565 = ((__global int64_t *) ext_mem_77925)[j_76557];\n            slice_77483 = tS_start_66998 + j_76557;\n            tile_elem_76566 = ((__global float *) tS_mem_77626)[slice_77483];\n            pre1d_76562 = tile_elem_76565;\n            pre1d_76563 = tile_elem_76566;\n        } else {\n            pre1d_76562 = (int64_t) 0;\n            pre1d_76563 = 0.0F;\n        }\n        ",
                                    "((__local int64_t *) color_78693)[ltid_76554] = pre1d_76562;\n        ((__local float *) color_78692)[ltid_76554] = pre1d_76563;\n        ((__local int64_t *) color_78691)[ltid_76554] = pre1d_76564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76575 = sext_i32_i64(local_tid_78825);\n        ltid_76574 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76577 = binop_x_76422 + ltid_76574;\n        acc_76579 = mem_param_77943[(int64_t) 0];\n        acc_76580 = mem_param_77944[(int64_t) 0];\n        acc_76581 = mem_param_77945[(int64_t) 0];\n        cond_76582 = slt64(gtid_76577, min_res_68560);\n        if (cond_76582) {\n            float eta_p_76578;\n            int64_t x_76586;\n            float x_76587;\n            int64_t x_76588;\n            int64_t redout_77500;\n            float redout_77501;\n            int64_t redout_77502;\n            \n            eta_p_76578 = mem_77930[(int64_t) 0];\n            redout_77500 = acc_76579;\n            redout_77501 = acc_76580;\n            redout_77502 = acc_76581;\n            for (int64_t i_77503 = 0; i_77503 < tile_sizze_76414; i_77503++) {\n                int64_t x_76589;\n                float x_76590;\n                bool defunc_0_neq_res_76598;\n                bool defunc_0_neq_res_76599;\n                bool cond_f_res_76600;\n                bool y_76601;\n                bool cond_76602;\n                bool defunc_0_neq_res_76603;\n                bool defunc_0_neq_res_76604;\n                bool cond_t_res_f_res_76605;\n                bool y_76606;\n                bool cond_t_res_76607;\n                bool x_76608;\n                int64_t defunc_0_op_res_76609;\n                float defunc_0_op_res_76610;\n                int64_t defunc_0_op_res_76611;\n                int64_t redout_tmp_78840;\n                float redout_tmp_78841;\n                int64_t redout_tmp_78842;\n                \n                x_76589 = ((__local int64_t *) color_78693)[i_77503];\n                x_76590 = ((__local float *) color_", "78692)[i_77503];\n                defunc_0_neq_res_76598 = redout_77501 == eta_p_76578;\n                defunc_0_neq_res_76599 = !defunc_0_neq_res_76598;\n                cond_f_res_76600 = slt64(redout_77500, (int64_t) 0);\n                y_76601 = defunc_0_neq_res_76598 && cond_f_res_76600;\n                cond_76602 = defunc_0_neq_res_76599 || y_76601;\n                defunc_0_neq_res_76603 = x_76590 == eta_p_76578;\n                defunc_0_neq_res_76604 = !defunc_0_neq_res_76603;\n                cond_t_res_f_res_76605 = slt64(x_76589, (int64_t) 0);\n                y_76606 = defunc_0_neq_res_76603 && cond_t_res_f_res_76605;\n                cond_t_res_76607 = defunc_0_neq_res_76604 || y_76606;\n                x_76608 = cond_76602 && cond_t_res_76607;\n                if (x_76608) {\n                    defunc_0_op_res_76609 = (int64_t) -1;\n                    defunc_0_op_res_76610 = eta_p_76578;\n                    defunc_0_op_res_76611 = (int64_t) 0;\n                } else {\n                    int64_t x_76591;\n                    int64_t defunc_0_op_res_f_res_76612;\n                    float defunc_0_op_res_f_res_76613;\n                    int64_t defunc_0_op_res_f_res_76614;\n                    \n                    x_76591 = ((__local int64_t *) color_78691)[i_77503];\n                    if (cond_76602) {\n                        defunc_0_op_res_f_res_76612 = x_76589;\n                        defunc_0_op_res_f_res_76613 = x_76590;\n                        defunc_0_op_res_f_res_76614 = x_76591;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_76615;\n                        int64_t defunc_0_op_res_f_res_f_res_76616;\n                        int64_t defunc_0_op_res_f_res_f_res_76617;\n                        \n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76615 = redout_77501;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76615 = eta_p_7", "6578;\n                        }\n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76616 = redout_77500;\n                            defunc_0_op_res_f_res_f_res_76617 = redout_77502;\n                        } else {\n                            int64_t min_res_76618;\n                            int64_t tmp_76619;\n                            \n                            min_res_76618 = smin64(x_76589, redout_77500);\n                            tmp_76619 = add64(x_76591, redout_77502);\n                            defunc_0_op_res_f_res_f_res_76616 = min_res_76618;\n                            defunc_0_op_res_f_res_f_res_76617 = tmp_76619;\n                        }\n                        defunc_0_op_res_f_res_76612 = defunc_0_op_res_f_res_f_res_76616;\n                        defunc_0_op_res_f_res_76613 = defunc_0_op_res_f_res_f_res_76615;\n                        defunc_0_op_res_f_res_76614 = defunc_0_op_res_f_res_f_res_76617;\n                    }\n                    defunc_0_op_res_76609 = defunc_0_op_res_f_res_76612;\n                    defunc_0_op_res_76610 = defunc_0_op_res_f_res_76613;\n                    defunc_0_op_res_76611 = defunc_0_op_res_f_res_76614;\n                }\n                redout_tmp_78840 = defunc_0_op_res_76609;\n                redout_tmp_78841 = defunc_0_op_res_76610;\n                redout_tmp_78842 = defunc_0_op_res_76611;\n                redout_77500 = redout_tmp_78840;\n                redout_77501 = redout_tmp_78841;\n                redout_77502 = redout_tmp_78842;\n            }\n            x_76586 = redout_77500;\n            x_76587 = redout_77501;\n            x_76588 = redout_77502;\n            acc_76583 = x_76586;\n            acc_76584 = x_76587;\n            acc_76585 = x_76588;\n        } else {\n            acc_76583 = acc_76579;\n            acc_76584 = acc_76580;\n            acc_76585 = acc_76581;\n        }\n        mem_77955[(int64_t) 0] = acc_76583;\n        mem_77959[(int64_t) 0] = ac",
                                    "c_76584;\n        mem_77963[(int64_t) 0] = acc_76585;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78834[i_6] = mem_77955[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78835[i_7] = mem_77959[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78836[i_8] = mem_77963[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77943[i_9] = mem_param_tmp_78834[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77944[i_10] = mem_param_tmp_78835[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77945[i_11] = mem_param_tmp_78836[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77966[i_12] = mem_param_77943[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77965[i_13] = mem_param_77944[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77964[i_14] = mem_param_77945[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76655) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77982[i_15] = ext_mem_77966[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77981[i_16] = ext_mem_77964[i_16];\n    } else {\n        int64_t ltid_flat_76657;\n        int64_t ltid_76656;\n        int64_t j_76672;\n        bool cond_76676;\n        int64_t pre1d_76679;\n        int64_t pre1d_76677;\n        float pre1d_76678;\n        int64_t ltid_flat_76693;\n        int64_t ltid_76692;\n        int64_t gtid_76706;\n        int64_t acc_76708;\n        int64_t acc_76710;\n        bool cond_76711;\n        int64_t acc_76712;\n        int64_t acc_76714;\n        \n        ltid_flat_76657 = sext_i32_i64(local_tid_78825);\n        ltid_76656 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76672 = ltid_76656 + binop_x_76671;\n        cond_76676 = slt64(j_76672, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_766", "79 = btoi_bool_i64(cond_76676);\n        if (cond_76676) {\n            int64_t tile_elem_76680;\n            int64_t slice_77482;\n            float tile_elem_76681;\n            \n            tile_elem_76680 = ((__global int64_t *) ext_mem_77925)[j_76672];\n            slice_77482 = tS_start_66998 + j_76672;\n            tile_elem_76681 = ((__global float *) tS_mem_77626)[slice_77482];\n            pre1d_76677 = tile_elem_76680;\n            pre1d_76678 = tile_elem_76681;\n        } else {\n            pre1d_76677 = (int64_t) 0;\n            pre1d_76678 = 0.0F;\n        }\n        ((__local int64_t *) color_78693)[ltid_76656] = pre1d_76677;\n        ((__local float *) color_78692)[ltid_76656] = pre1d_76678;\n        ((__local int64_t *) color_78691)[ltid_76656] = pre1d_76679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76693 = sext_i32_i64(local_tid_78825);\n        ltid_76692 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76706 = binop_x_76422 + ltid_76692;\n        acc_76708 = ext_mem_77966[(int64_t) 0];\n        acc_76710 = ext_mem_77964[(int64_t) 0];\n        cond_76711 = slt64(gtid_76706, min_res_68560);\n        if (cond_76711) {\n            float eta_p_76707;\n            float acc_76709;\n            int64_t x_76715;\n            float x_76716;\n            int64_t x_76717;\n            int64_t redout_77504;\n            float redout_77505;\n            int64_t redout_77506;\n            \n            eta_p_76707 = mem_77930[(int64_t) 0];\n            acc_76709 = ext_mem_77965[(int64_t) 0];\n            redout_77504 = acc_76708;\n            redout_77505 = acc_76709;\n            redout_77506 = acc_76710;\n            for (int64_t i_77507 = 0; i_77507 < residual_input_76654; i_77507++) {\n                int64_t x_76718;\n                float x_76719;\n                bool defunc_0_neq_res_76727;\n                bool defunc_0_neq_res_76728;\n                bool cond_f_res_76729;\n                bool y_76730;\n                bool cond_76731;\n                bool defunc_0", "_neq_res_76732;\n                bool defunc_0_neq_res_76733;\n                bool cond_t_res_f_res_76734;\n                bool y_76735;\n                bool cond_t_res_76736;\n                bool x_76737;\n                int64_t defunc_0_op_res_76738;\n                float defunc_0_op_res_76739;\n                int64_t defunc_0_op_res_76740;\n                int64_t redout_tmp_78843;\n                float redout_tmp_78844;\n                int64_t redout_tmp_78845;\n                \n                x_76718 = ((__local int64_t *) color_78693)[i_77507];\n                x_76719 = ((__local float *) color_78692)[i_77507];\n                defunc_0_neq_res_76727 = redout_77505 == eta_p_76707;\n                defunc_0_neq_res_76728 = !defunc_0_neq_res_76727;\n                cond_f_res_76729 = slt64(redout_77504, (int64_t) 0);\n                y_76730 = defunc_0_neq_res_76727 && cond_f_res_76729;\n                cond_76731 = defunc_0_neq_res_76728 || y_76730;\n                defunc_0_neq_res_76732 = x_76719 == eta_p_76707;\n                defunc_0_neq_res_76733 = !defunc_0_neq_res_76732;\n                cond_t_res_f_res_76734 = slt64(x_76718, (int64_t) 0);\n                y_76735 = defunc_0_neq_res_76732 && cond_t_res_f_res_76734;\n                cond_t_res_76736 = defunc_0_neq_res_76733 || y_76735;\n                x_76737 = cond_76731 && cond_t_res_76736;\n                if (x_76737) {\n                    defunc_0_op_res_76738 = (int64_t) -1;\n                    defunc_0_op_res_76739 = eta_p_76707;\n                    defunc_0_op_res_76740 = (int64_t) 0;\n                } else {\n                    int64_t x_76720;\n                    int64_t defunc_0_op_res_f_res_76741;\n                    float defunc_0_op_res_f_res_76742;\n                    int64_t defunc_0_op_res_f_res_76743;\n                    \n                    x_76720 = ((__local int64_t *) color_78691)[i_77507];\n                    if (cond_76731) {\n                        defunc_0_op_res_f_res_76741 = x_76718;\n   ",
                                    "                     defunc_0_op_res_f_res_76742 = x_76719;\n                        defunc_0_op_res_f_res_76743 = x_76720;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_76744;\n                        int64_t defunc_0_op_res_f_res_f_res_76745;\n                        int64_t defunc_0_op_res_f_res_f_res_76746;\n                        \n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76744 = redout_77505;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76744 = eta_p_76707;\n                        }\n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76745 = redout_77504;\n                            defunc_0_op_res_f_res_f_res_76746 = redout_77506;\n                        } else {\n                            int64_t min_res_76747;\n                            int64_t tmp_76748;\n                            \n                            min_res_76747 = smin64(x_76718, redout_77504);\n                            tmp_76748 = add64(x_76720, redout_77506);\n                            defunc_0_op_res_f_res_f_res_76745 = min_res_76747;\n                            defunc_0_op_res_f_res_f_res_76746 = tmp_76748;\n                        }\n                        defunc_0_op_res_f_res_76741 = defunc_0_op_res_f_res_f_res_76745;\n                        defunc_0_op_res_f_res_76742 = defunc_0_op_res_f_res_f_res_76744;\n                        defunc_0_op_res_f_res_76743 = defunc_0_op_res_f_res_f_res_76746;\n                    }\n                    defunc_0_op_res_76738 = defunc_0_op_res_f_res_76741;\n                    defunc_0_op_res_76739 = defunc_0_op_res_f_res_76742;\n                    defunc_0_op_res_76740 = defunc_0_op_res_f_res_76743;\n                }\n                redout_tmp_78843 = defunc_0_op_res_76738;\n                redout_tmp_78844 = defunc_0_op_res_76739;\n                redout_tmp_7884", "5 = defunc_0_op_res_76740;\n                redout_77504 = redout_tmp_78843;\n                redout_77505 = redout_tmp_78844;\n                redout_77506 = redout_tmp_78845;\n            }\n            x_76715 = redout_77504;\n            x_76716 = redout_77505;\n            x_76717 = redout_77506;\n            acc_76712 = x_76715;\n            acc_76714 = x_76717;\n        } else {\n            acc_76712 = acc_76708;\n            acc_76714 = acc_76710;\n        }\n        mem_77976[(int64_t) 0] = acc_76712;\n        mem_77980[(int64_t) 0] = acc_76714;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77982[i_17] = mem_77976[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77981[i_18] = mem_77980[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78846 = ext_mem_77982[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77984)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78846;\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78847 = ext_mem_77981[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77986)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78847;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76414\n    #undef bytes_77946\n    #undef bytes_77948\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_76767_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_76767(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_76770, int64_t num_whole_tiles_76785, int64_t residual_input_77009, unsigned char cond_77010_bits, int64_t binop_x_77026, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned ch", "ar *ext_mem_77720, __global unsigned char *mem_77840, __global unsigned char *mem_77842)\n{\n    bool cond_77010 = cond_77010_bits;\n    \n    #define tile_sizze_76769 (inner_SMJ_floatzisegmap_intrablock_76767zitile_sizze_76769)\n    #define bytes_77802 (inner_SMJ_floatzisegmap_intrablock_76767zibytes_77802)\n    #define bytes_77804 (inner_SMJ_floatzisegmap_intrablock_76767zibytes_77804)\n    \n    volatile __local unsigned char *color_78696_backing_2 = &shared_mem[0];\n    const int64_t color_78696_backing_2_offset = 0 + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78695_backing_1 = &shared_mem[color_78696_backing_2_offset];\n    const int64_t color_78695_backing_1_offset = color_78696_backing_2_offset + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78694_backing_0 = &shared_mem[color_78695_backing_1_offset];\n    const int64_t color_78694_backing_0_offset = color_78695_backing_1_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78966;\n    int32_t tblock_sizze_78969;\n    int32_t wave_sizze_78968;\n    int32_t block_id_78967;\n    int32_t global_tid_78965;\n    int64_t gid_flat_76767;\n    int64_t slice_78971;\n    int64_t ltid_pre_78970;\n    int64_t remnant_78972;\n    int64_t slice_78973;\n    int64_t gid_76766;\n    int64_t remnant_78974;\n    __local unsigned char *color_78694;\n    __local unsigned char *color_78695;\n    __local unsigned char *color_78696;\n    int64_t binop_x_76777;\n    float mem_77786[1];\n    int64_t ltid_flat_76772;\n    int64_t ltid_76771;\n    int64_t gtid_76778;\n    bool cond_76779;\n    float pre_76780;\n    int64_t mem_77790[1];\n    float mem_77794[1];\n    int64_t mem_77798[1];\n    int64_t ltid_flat_76787;\n    int64_t ltid_76786;\n    int64_t gtid_76797;\n    bool cond_76798;\n    int6",
                                    "4_t neutral_76799;\n    float neutral_76800;\n    int64_t ext_mem_77822[1];\n    float ext_mem_77821[1];\n    int64_t ext_mem_77820[1];\n    int64_t mem_param_77799[1];\n    float mem_param_77800[1];\n    int64_t mem_param_77801[1];\n    int64_t mem_77832[1];\n    int64_t mem_77836[1];\n    int64_t ext_mem_77838[1];\n    int64_t ext_mem_77837[1];\n    \n    local_tid_78966 = get_local_id(0);\n    tblock_sizze_78969 = get_local_size(0);\n    wave_sizze_78968 = LOCKSTEP_WIDTH;\n    block_id_78967 = get_tblock_id(0);\n    global_tid_78965 = block_id_78967 * tblock_sizze_78969 + local_tid_78966;\n    gid_flat_76767 = sext_i32_i64(block_id_78967);\n    slice_78971 = tile_sizze_76769;\n    ltid_pre_78970 = sext_i32_i64(local_tid_78966);\n    remnant_78972 = sext_i32_i64(local_tid_78966) - ltid_pre_78970;\n    slice_78973 = ldim_76770;\n    gid_76766 = sext_i32_i64(block_id_78967);\n    remnant_78974 = sext_i32_i64(block_id_78967) - gid_76766;\n    color_78694 = (__local unsigned char *) color_78694_backing_0;\n    color_78695 = (__local unsigned char *) color_78695_backing_1;\n    color_78696 = (__local unsigned char *) color_78696_backing_2;\n    binop_x_76777 = gid_76766 * tile_sizze_76769;\n    ltid_flat_76772 = sext_i32_i64(local_tid_78966);\n    ltid_76771 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76778 = ltid_76771 + binop_x_76777;\n    cond_76779 = slt64(gtid_76778, min_res_67698);\n    if (cond_76779) {\n        int64_t slice_76781;\n        float eta_p_76782;\n        \n        slice_76781 = slice_67712 + gtid_76778;\n        eta_p_76782 = ((__global float *) tR_mem_77625)[slice_76781];\n        pre_76780 = eta_p_76782;\n    } else {\n        pre_76780 = 0.0F;\n    }\n    mem_77786[(int64_t) 0] = pre_76780;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76787 = sext_i32_i64(local_tid_78966);\n    ltid_76786 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76797 = binop_x_76777 + ltid_76786;\n    cond_76798 = slt64(gtid_76797, min_res_67698);\n    if (cond_76798) {\n        neutral_76799 =", " (int64_t) -1;\n    } else {\n        neutral_76799 = (int64_t) 0;\n    }\n    if (cond_76798) {\n        float eta_p_76802 = mem_77786[(int64_t) 0];\n        \n        neutral_76800 = eta_p_76802;\n    } else {\n        neutral_76800 = 0.0F;\n    }\n    mem_77790[(int64_t) 0] = neutral_76799;\n    mem_77794[(int64_t) 0] = neutral_76800;\n    mem_77798[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77799[i_3] = mem_77790[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77800[i_4] = mem_77794[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77801[i_5] = mem_77798[i_5];\n    for (int64_t tile_id_76812 = 0; tile_id_76812 < num_whole_tiles_76785; tile_id_76812++) {\n        int64_t binop_x_76911;\n        int64_t ltid_flat_76910;\n        int64_t ltid_76909;\n        int64_t j_76912;\n        bool cond_76916;\n        int64_t pre1d_76919;\n        int64_t pre1d_76917;\n        float pre1d_76918;\n        int64_t mem_77811[1];\n        float mem_77815[1];\n        int64_t mem_77819[1];\n        int64_t ltid_flat_76930;\n        int64_t ltid_76929;\n        int64_t gtid_76932;\n        int64_t acc_76934;\n        float acc_76935;\n        int64_t acc_76936;\n        bool cond_76937;\n        int64_t acc_76938;\n        float acc_76939;\n        int64_t acc_76940;\n        int64_t mem_param_tmp_78975[1];\n        float mem_param_tmp_78976[1];\n        int64_t mem_param_tmp_78977[1];\n        \n        binop_x_76911 = tile_sizze_76769 * tile_id_76812;\n        ltid_flat_76910 = sext_i32_i64(local_tid_78966);\n        ltid_76909 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_76912 = ltid_76909 + binop_x_76911;\n        cond_76916 = slt64(j_76912, j_m_i_67660);\n        pre1d_76919 = btoi_bool_i64(cond_76916);\n        if (cond_76916) {\n            int64_t tile_elem_76920;\n            int64_t slice_77487;\n            float tile_elem_76921;\n            \n            tile_e", "lem_76920 = ((__global int64_t *) ext_mem_77720)[j_76912];\n            slice_77487 = slice_68069 + j_76912;\n            tile_elem_76921 = ((__global float *) tS_mem_77626)[slice_77487];\n            pre1d_76917 = tile_elem_76920;\n            pre1d_76918 = tile_elem_76921;\n        } else {\n            pre1d_76917 = (int64_t) 0;\n            pre1d_76918 = 0.0F;\n        }\n        ((__local int64_t *) color_78696)[ltid_76909] = pre1d_76917;\n        ((__local float *) color_78695)[ltid_76909] = pre1d_76918;\n        ((__local int64_t *) color_78694)[ltid_76909] = pre1d_76919;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76930 = sext_i32_i64(local_tid_78966);\n        ltid_76929 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_76932 = binop_x_76777 + ltid_76929;\n        acc_76934 = mem_param_77799[(int64_t) 0];\n        acc_76935 = mem_param_77800[(int64_t) 0];\n        acc_76936 = mem_param_77801[(int64_t) 0];\n        cond_76937 = slt64(gtid_76932, min_res_67698);\n        if (cond_76937) {\n            float eta_p_76933;\n            int64_t x_76941;\n            float x_76942;\n            int64_t x_76943;\n            int64_t redout_77508;\n            float redout_77509;\n            int64_t redout_77510;\n            \n            eta_p_76933 = mem_77786[(int64_t) 0];\n            redout_77508 = acc_76934;\n            redout_77509 = acc_76935;\n            redout_77510 = acc_76936;\n            for (int64_t i_77511 = 0; i_77511 < tile_sizze_76769; i_77511++) {\n                int64_t x_76944;\n                float x_76945;\n                bool defunc_0_neq_res_76953;\n                bool defunc_0_neq_res_76954;\n                bool cond_f_res_76955;\n                bool y_76956;\n                bool cond_76957;\n                bool defunc_0_neq_res_76958;\n                bool defunc_0_neq_res_76959;\n                bool cond_t_res_f_res_76960;\n                bool y_76961;\n                bool cond_t_res_76962;\n                bool x_76963;\n                int64_t",
                                    " defunc_0_op_res_76964;\n                float defunc_0_op_res_76965;\n                int64_t defunc_0_op_res_76966;\n                int64_t redout_tmp_78981;\n                float redout_tmp_78982;\n                int64_t redout_tmp_78983;\n                \n                x_76944 = ((__local int64_t *) color_78696)[i_77511];\n                x_76945 = ((__local float *) color_78695)[i_77511];\n                defunc_0_neq_res_76953 = redout_77509 == eta_p_76933;\n                defunc_0_neq_res_76954 = !defunc_0_neq_res_76953;\n                cond_f_res_76955 = slt64(redout_77508, (int64_t) 0);\n                y_76956 = defunc_0_neq_res_76953 && cond_f_res_76955;\n                cond_76957 = defunc_0_neq_res_76954 || y_76956;\n                defunc_0_neq_res_76958 = x_76945 == eta_p_76933;\n                defunc_0_neq_res_76959 = !defunc_0_neq_res_76958;\n                cond_t_res_f_res_76960 = slt64(x_76944, (int64_t) 0);\n                y_76961 = defunc_0_neq_res_76958 && cond_t_res_f_res_76960;\n                cond_t_res_76962 = defunc_0_neq_res_76959 || y_76961;\n                x_76963 = cond_76957 && cond_t_res_76962;\n                if (x_76963) {\n                    defunc_0_op_res_76964 = (int64_t) -1;\n                    defunc_0_op_res_76965 = eta_p_76933;\n                    defunc_0_op_res_76966 = (int64_t) 0;\n                } else {\n                    int64_t x_76946;\n                    int64_t defunc_0_op_res_f_res_76967;\n                    float defunc_0_op_res_f_res_76968;\n                    int64_t defunc_0_op_res_f_res_76969;\n                    \n                    x_76946 = ((__local int64_t *) color_78694)[i_77511];\n                    if (cond_76957) {\n                        defunc_0_op_res_f_res_76967 = x_76944;\n                        defunc_0_op_res_f_res_76968 = x_76945;\n                        defunc_0_op_res_f_res_76969 = x_76946;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_76970;\n           ", "             int64_t defunc_0_op_res_f_res_f_res_76971;\n                        int64_t defunc_0_op_res_f_res_f_res_76972;\n                        \n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76970 = redout_77509;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76970 = eta_p_76933;\n                        }\n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76971 = redout_77508;\n                            defunc_0_op_res_f_res_f_res_76972 = redout_77510;\n                        } else {\n                            int64_t min_res_76973;\n                            int64_t tmp_76974;\n                            \n                            min_res_76973 = smin64(x_76944, redout_77508);\n                            tmp_76974 = add64(x_76946, redout_77510);\n                            defunc_0_op_res_f_res_f_res_76971 = min_res_76973;\n                            defunc_0_op_res_f_res_f_res_76972 = tmp_76974;\n                        }\n                        defunc_0_op_res_f_res_76967 = defunc_0_op_res_f_res_f_res_76971;\n                        defunc_0_op_res_f_res_76968 = defunc_0_op_res_f_res_f_res_76970;\n                        defunc_0_op_res_f_res_76969 = defunc_0_op_res_f_res_f_res_76972;\n                    }\n                    defunc_0_op_res_76964 = defunc_0_op_res_f_res_76967;\n                    defunc_0_op_res_76965 = defunc_0_op_res_f_res_76968;\n                    defunc_0_op_res_76966 = defunc_0_op_res_f_res_76969;\n                }\n                redout_tmp_78981 = defunc_0_op_res_76964;\n                redout_tmp_78982 = defunc_0_op_res_76965;\n                redout_tmp_78983 = defunc_0_op_res_76966;\n                redout_77508 = redout_tmp_78981;\n                redout_77509 = redout_tmp_78982;\n                redout_77510 = redout_tmp_78983;\n            }\n            x_76941 = redout_77508;\n    ", "        x_76942 = redout_77509;\n            x_76943 = redout_77510;\n            acc_76938 = x_76941;\n            acc_76939 = x_76942;\n            acc_76940 = x_76943;\n        } else {\n            acc_76938 = acc_76934;\n            acc_76939 = acc_76935;\n            acc_76940 = acc_76936;\n        }\n        mem_77811[(int64_t) 0] = acc_76938;\n        mem_77815[(int64_t) 0] = acc_76939;\n        mem_77819[(int64_t) 0] = acc_76940;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78975[i_6] = mem_77811[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78976[i_7] = mem_77815[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78977[i_8] = mem_77819[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77799[i_9] = mem_param_tmp_78975[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77800[i_10] = mem_param_tmp_78976[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77801[i_11] = mem_param_tmp_78977[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77822[i_12] = mem_param_77799[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77821[i_13] = mem_param_77800[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77820[i_14] = mem_param_77801[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77010) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77838[i_15] = ext_mem_77822[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77837[i_16] = ext_mem_77820[i_16];\n    } else {\n        int64_t ltid_flat_77012;\n        int64_t ltid_77011;\n        int64_t j_77027;\n        bool cond_77031;\n        int64_t pre1d_77034;\n        int64_t pre1d_77032;\n        float pre1d_77033;\n        int64_t ltid_flat_77048;\n        int64_t ltid_77047;\n        int64_t gtid_77061;\n        int64_t acc_77063;\n        ",
                                    "int64_t acc_77065;\n        bool cond_77066;\n        int64_t acc_77067;\n        int64_t acc_77069;\n        \n        ltid_flat_77012 = sext_i32_i64(local_tid_78966);\n        ltid_77011 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_77027 = ltid_77011 + binop_x_77026;\n        cond_77031 = slt64(j_77027, j_m_i_67660);\n        pre1d_77034 = btoi_bool_i64(cond_77031);\n        if (cond_77031) {\n            int64_t tile_elem_77035;\n            int64_t slice_77486;\n            float tile_elem_77036;\n            \n            tile_elem_77035 = ((__global int64_t *) ext_mem_77720)[j_77027];\n            slice_77486 = slice_68069 + j_77027;\n            tile_elem_77036 = ((__global float *) tS_mem_77626)[slice_77486];\n            pre1d_77032 = tile_elem_77035;\n            pre1d_77033 = tile_elem_77036;\n        } else {\n            pre1d_77032 = (int64_t) 0;\n            pre1d_77033 = 0.0F;\n        }\n        ((__local int64_t *) color_78696)[ltid_77011] = pre1d_77032;\n        ((__local float *) color_78695)[ltid_77011] = pre1d_77033;\n        ((__local int64_t *) color_78694)[ltid_77011] = pre1d_77034;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77048 = sext_i32_i64(local_tid_78966);\n        ltid_77047 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_77061 = binop_x_76777 + ltid_77047;\n        acc_77063 = ext_mem_77822[(int64_t) 0];\n        acc_77065 = ext_mem_77820[(int64_t) 0];\n        cond_77066 = slt64(gtid_77061, min_res_67698);\n        if (cond_77066) {\n            float eta_p_77062;\n            float acc_77064;\n            int64_t x_77070;\n            float x_77071;\n            int64_t x_77072;\n            int64_t redout_77512;\n            float redout_77513;\n            int64_t redout_77514;\n            \n            eta_p_77062 = mem_77786[(int64_t) 0];\n            acc_77064 = ext_mem_77821[(int64_t) 0];\n            redout_77512 = acc_77063;\n            redout_77513 = acc_77064;\n            redout_77514 = acc_77065;\n            for (int64_t i_77", "515 = 0; i_77515 < residual_input_77009; i_77515++) {\n                int64_t x_77073;\n                float x_77074;\n                bool defunc_0_neq_res_77082;\n                bool defunc_0_neq_res_77083;\n                bool cond_f_res_77084;\n                bool y_77085;\n                bool cond_77086;\n                bool defunc_0_neq_res_77087;\n                bool defunc_0_neq_res_77088;\n                bool cond_t_res_f_res_77089;\n                bool y_77090;\n                bool cond_t_res_77091;\n                bool x_77092;\n                int64_t defunc_0_op_res_77093;\n                float defunc_0_op_res_77094;\n                int64_t defunc_0_op_res_77095;\n                int64_t redout_tmp_78984;\n                float redout_tmp_78985;\n                int64_t redout_tmp_78986;\n                \n                x_77073 = ((__local int64_t *) color_78696)[i_77515];\n                x_77074 = ((__local float *) color_78695)[i_77515];\n                defunc_0_neq_res_77082 = redout_77513 == eta_p_77062;\n                defunc_0_neq_res_77083 = !defunc_0_neq_res_77082;\n                cond_f_res_77084 = slt64(redout_77512, (int64_t) 0);\n                y_77085 = defunc_0_neq_res_77082 && cond_f_res_77084;\n                cond_77086 = defunc_0_neq_res_77083 || y_77085;\n                defunc_0_neq_res_77087 = x_77074 == eta_p_77062;\n                defunc_0_neq_res_77088 = !defunc_0_neq_res_77087;\n                cond_t_res_f_res_77089 = slt64(x_77073, (int64_t) 0);\n                y_77090 = defunc_0_neq_res_77087 && cond_t_res_f_res_77089;\n                cond_t_res_77091 = defunc_0_neq_res_77088 || y_77090;\n                x_77092 = cond_77086 && cond_t_res_77091;\n                if (x_77092) {\n                    defunc_0_op_res_77093 = (int64_t) -1;\n                    defunc_0_op_res_77094 = eta_p_77062;\n                    defunc_0_op_res_77095 = (int64_t) 0;\n                } else {\n                    int64_t x_77075;\n                    int64_t d", "efunc_0_op_res_f_res_77096;\n                    float defunc_0_op_res_f_res_77097;\n                    int64_t defunc_0_op_res_f_res_77098;\n                    \n                    x_77075 = ((__local int64_t *) color_78694)[i_77515];\n                    if (cond_77086) {\n                        defunc_0_op_res_f_res_77096 = x_77073;\n                        defunc_0_op_res_f_res_77097 = x_77074;\n                        defunc_0_op_res_f_res_77098 = x_77075;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_77099;\n                        int64_t defunc_0_op_res_f_res_f_res_77100;\n                        int64_t defunc_0_op_res_f_res_f_res_77101;\n                        \n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77099 = redout_77513;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77099 = eta_p_77062;\n                        }\n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77100 = redout_77512;\n                            defunc_0_op_res_f_res_f_res_77101 = redout_77514;\n                        } else {\n                            int64_t min_res_77102;\n                            int64_t tmp_77103;\n                            \n                            min_res_77102 = smin64(x_77073, redout_77512);\n                            tmp_77103 = add64(x_77075, redout_77514);\n                            defunc_0_op_res_f_res_f_res_77100 = min_res_77102;\n                            defunc_0_op_res_f_res_f_res_77101 = tmp_77103;\n                        }\n                        defunc_0_op_res_f_res_77096 = defunc_0_op_res_f_res_f_res_77100;\n                        defunc_0_op_res_f_res_77097 = defunc_0_op_res_f_res_f_res_77099;\n                        defunc_0_op_res_f_res_77098 = defunc_0_op_res_f_res_f_res_77101;\n                    }\n                    defunc_0_op_res_77093 = d",
                                    "efunc_0_op_res_f_res_77096;\n                    defunc_0_op_res_77094 = defunc_0_op_res_f_res_77097;\n                    defunc_0_op_res_77095 = defunc_0_op_res_f_res_77098;\n                }\n                redout_tmp_78984 = defunc_0_op_res_77093;\n                redout_tmp_78985 = defunc_0_op_res_77094;\n                redout_tmp_78986 = defunc_0_op_res_77095;\n                redout_77512 = redout_tmp_78984;\n                redout_77513 = redout_tmp_78985;\n                redout_77514 = redout_tmp_78986;\n            }\n            x_77070 = redout_77512;\n            x_77071 = redout_77513;\n            x_77072 = redout_77514;\n            acc_77067 = x_77070;\n            acc_77069 = x_77072;\n        } else {\n            acc_77067 = acc_77063;\n            acc_77069 = acc_77065;\n        }\n        mem_77832[(int64_t) 0] = acc_77067;\n        mem_77836[(int64_t) 0] = acc_77069;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77838[i_17] = mem_77832[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77837[i_18] = mem_77836[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78987 = ext_mem_77838[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77840)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78987;\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78988 = ext_mem_77837[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77842)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78988;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76769\n    #undef bytes_77802\n    #undef bytes_77804\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_77122_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_77122(__global", " int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_77125, int64_t num_whole_tiles_77140, int64_t residual_input_77364, unsigned char cond_77365_bits, int64_t binop_x_77381, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77779, __global unsigned char *mem_77781)\n{\n    bool cond_77365 = cond_77365_bits;\n    \n    #define tile_sizze_77124 (inner_SMJ_floatzisegmap_intrablock_77122zitile_sizze_77124)\n    #define bytes_77741 (inner_SMJ_floatzisegmap_intrablock_77122zibytes_77741)\n    #define bytes_77743 (inner_SMJ_floatzisegmap_intrablock_77122zibytes_77743)\n    \n    volatile __local unsigned char *color_78699_backing_2 = &shared_mem[0];\n    const int64_t color_78699_backing_2_offset = 0 + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78698_backing_1 = &shared_mem[color_78699_backing_2_offset];\n    const int64_t color_78698_backing_1_offset = color_78699_backing_2_offset + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78697_backing_0 = &shared_mem[color_78698_backing_1_offset];\n    const int64_t color_78697_backing_0_offset = color_78698_backing_1_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78992;\n    int32_t tblock_sizze_78995;\n    int32_t wave_sizze_78994;\n    int32_t block_id_78993;\n    int32_t global_tid_78991;\n    int64_t gid_flat_77122;\n    int64_t slice_78997;\n    int64_t ltid_pre_78996;\n    int64_t remnant_78998;\n    int64_t slice_78999;\n    int64_t gid_77121;\n    int64_t remnant_79000;\n    __local unsigned char *color_78697;\n    __local unsigned char *color_78698;\n    __local unsigned char *color_78699;\n    int64_t b", "inop_x_77132;\n    float mem_77725[1];\n    int64_t ltid_flat_77127;\n    int64_t ltid_77126;\n    int64_t gtid_77133;\n    bool cond_77134;\n    float pre_77135;\n    int64_t mem_77729[1];\n    float mem_77733[1];\n    int64_t mem_77737[1];\n    int64_t ltid_flat_77142;\n    int64_t ltid_77141;\n    int64_t gtid_77152;\n    bool cond_77153;\n    int64_t neutral_77154;\n    float neutral_77155;\n    int64_t ext_mem_77761[1];\n    float ext_mem_77760[1];\n    int64_t ext_mem_77759[1];\n    int64_t mem_param_77738[1];\n    float mem_param_77739[1];\n    int64_t mem_param_77740[1];\n    int64_t mem_77771[1];\n    int64_t mem_77775[1];\n    int64_t ext_mem_77777[1];\n    int64_t ext_mem_77776[1];\n    \n    local_tid_78992 = get_local_id(0);\n    tblock_sizze_78995 = get_local_size(0);\n    wave_sizze_78994 = LOCKSTEP_WIDTH;\n    block_id_78993 = get_tblock_id(0);\n    global_tid_78991 = block_id_78993 * tblock_sizze_78995 + local_tid_78992;\n    gid_flat_77122 = sext_i32_i64(block_id_78993);\n    slice_78997 = tile_sizze_77124;\n    ltid_pre_78996 = sext_i32_i64(local_tid_78992);\n    remnant_78998 = sext_i32_i64(local_tid_78992) - ltid_pre_78996;\n    slice_78999 = ldim_77125;\n    gid_77121 = sext_i32_i64(block_id_78993);\n    remnant_79000 = sext_i32_i64(block_id_78993) - gid_77121;\n    color_78697 = (__local unsigned char *) color_78697_backing_0;\n    color_78698 = (__local unsigned char *) color_78698_backing_1;\n    color_78699 = (__local unsigned char *) color_78699_backing_2;\n    binop_x_77132 = gid_77121 * tile_sizze_77124;\n    ltid_flat_77127 = sext_i32_i64(local_tid_78992);\n    ltid_77126 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77133 = ltid_77126 + binop_x_77132;\n    cond_77134 = slt64(gtid_77133, min_res_67698);\n    if (cond_77134) {\n        int64_t slice_77136;\n        float eta_p_77137;\n        \n        slice_77136 = slice_67712 + gtid_77133;\n        eta_p_77137 = ((__global float *) tR_mem_77625)[slice_77136];\n        pre_77135 = eta_p_77137;\n    } else {\n        pre_77135 = 0.",
                                    "0F;\n    }\n    mem_77725[(int64_t) 0] = pre_77135;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_77142 = sext_i32_i64(local_tid_78992);\n    ltid_77141 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77152 = binop_x_77132 + ltid_77141;\n    cond_77153 = slt64(gtid_77152, min_res_67698);\n    if (cond_77153) {\n        neutral_77154 = (int64_t) -1;\n    } else {\n        neutral_77154 = (int64_t) 0;\n    }\n    if (cond_77153) {\n        float eta_p_77157 = mem_77725[(int64_t) 0];\n        \n        neutral_77155 = eta_p_77157;\n    } else {\n        neutral_77155 = 0.0F;\n    }\n    mem_77729[(int64_t) 0] = neutral_77154;\n    mem_77733[(int64_t) 0] = neutral_77155;\n    mem_77737[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77738[i_3] = mem_77729[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77739[i_4] = mem_77733[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77740[i_5] = mem_77737[i_5];\n    for (int64_t tile_id_77167 = 0; tile_id_77167 < num_whole_tiles_77140; tile_id_77167++) {\n        int64_t binop_x_77266;\n        int64_t ltid_flat_77265;\n        int64_t ltid_77264;\n        int64_t j_77267;\n        bool cond_77271;\n        int64_t pre1d_77274;\n        int64_t pre1d_77272;\n        float pre1d_77273;\n        int64_t mem_77750[1];\n        float mem_77754[1];\n        int64_t mem_77758[1];\n        int64_t ltid_flat_77285;\n        int64_t ltid_77284;\n        int64_t gtid_77287;\n        int64_t acc_77289;\n        float acc_77290;\n        int64_t acc_77291;\n        bool cond_77292;\n        int64_t acc_77293;\n        float acc_77294;\n        int64_t acc_77295;\n        int64_t mem_param_tmp_79001[1];\n        float mem_param_tmp_79002[1];\n        int64_t mem_param_tmp_79003[1];\n        \n        binop_x_77266 = tile_sizze_77124 * tile_id_77167;\n        ltid_flat_77265 = sext_i32_i64(local_tid_78992);\n        ltid_77264 = sext_i32_i64", "(sext_i64_i32(ltid_pre_78996));\n        j_77267 = ltid_77264 + binop_x_77266;\n        cond_77271 = slt64(j_77267, j_m_i_67660);\n        pre1d_77274 = btoi_bool_i64(cond_77271);\n        if (cond_77271) {\n            int64_t tile_elem_77275;\n            int64_t slice_77491;\n            float tile_elem_77276;\n            \n            tile_elem_77275 = ((__global int64_t *) ext_mem_77720)[j_77267];\n            slice_77491 = slice_68069 + j_77267;\n            tile_elem_77276 = ((__global float *) tS_mem_77626)[slice_77491];\n            pre1d_77272 = tile_elem_77275;\n            pre1d_77273 = tile_elem_77276;\n        } else {\n            pre1d_77272 = (int64_t) 0;\n            pre1d_77273 = 0.0F;\n        }\n        ((__local int64_t *) color_78699)[ltid_77264] = pre1d_77272;\n        ((__local float *) color_78698)[ltid_77264] = pre1d_77273;\n        ((__local int64_t *) color_78697)[ltid_77264] = pre1d_77274;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77285 = sext_i32_i64(local_tid_78992);\n        ltid_77284 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77287 = binop_x_77132 + ltid_77284;\n        acc_77289 = mem_param_77738[(int64_t) 0];\n        acc_77290 = mem_param_77739[(int64_t) 0];\n        acc_77291 = mem_param_77740[(int64_t) 0];\n        cond_77292 = slt64(gtid_77287, min_res_67698);\n        if (cond_77292) {\n            float eta_p_77288;\n            int64_t x_77296;\n            float x_77297;\n            int64_t x_77298;\n            int64_t redout_77516;\n            float redout_77517;\n            int64_t redout_77518;\n            \n            eta_p_77288 = mem_77725[(int64_t) 0];\n            redout_77516 = acc_77289;\n            redout_77517 = acc_77290;\n            redout_77518 = acc_77291;\n            for (int64_t i_77519 = 0; i_77519 < tile_sizze_77124; i_77519++) {\n                int64_t x_77299;\n                float x_77300;\n                bool defunc_0_neq_res_77308;\n                bool defunc_0_neq_res_77309;\n                bool", " cond_f_res_77310;\n                bool y_77311;\n                bool cond_77312;\n                bool defunc_0_neq_res_77313;\n                bool defunc_0_neq_res_77314;\n                bool cond_t_res_f_res_77315;\n                bool y_77316;\n                bool cond_t_res_77317;\n                bool x_77318;\n                int64_t defunc_0_op_res_77319;\n                float defunc_0_op_res_77320;\n                int64_t defunc_0_op_res_77321;\n                int64_t redout_tmp_79007;\n                float redout_tmp_79008;\n                int64_t redout_tmp_79009;\n                \n                x_77299 = ((__local int64_t *) color_78699)[i_77519];\n                x_77300 = ((__local float *) color_78698)[i_77519];\n                defunc_0_neq_res_77308 = redout_77517 == eta_p_77288;\n                defunc_0_neq_res_77309 = !defunc_0_neq_res_77308;\n                cond_f_res_77310 = slt64(redout_77516, (int64_t) 0);\n                y_77311 = defunc_0_neq_res_77308 && cond_f_res_77310;\n                cond_77312 = defunc_0_neq_res_77309 || y_77311;\n                defunc_0_neq_res_77313 = x_77300 == eta_p_77288;\n                defunc_0_neq_res_77314 = !defunc_0_neq_res_77313;\n                cond_t_res_f_res_77315 = slt64(x_77299, (int64_t) 0);\n                y_77316 = defunc_0_neq_res_77313 && cond_t_res_f_res_77315;\n                cond_t_res_77317 = defunc_0_neq_res_77314 || y_77316;\n                x_77318 = cond_77312 && cond_t_res_77317;\n                if (x_77318) {\n                    defunc_0_op_res_77319 = (int64_t) -1;\n                    defunc_0_op_res_77320 = eta_p_77288;\n                    defunc_0_op_res_77321 = (int64_t) 0;\n                } else {\n                    int64_t x_77301;\n                    int64_t defunc_0_op_res_f_res_77322;\n                    float defunc_0_op_res_f_res_77323;\n                    int64_t defunc_0_op_res_f_res_77324;\n                    \n                    x_77301 = ((__local int64_t *) color_78697)[i_7",
                                    "7519];\n                    if (cond_77312) {\n                        defunc_0_op_res_f_res_77322 = x_77299;\n                        defunc_0_op_res_f_res_77323 = x_77300;\n                        defunc_0_op_res_f_res_77324 = x_77301;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_77325;\n                        int64_t defunc_0_op_res_f_res_f_res_77326;\n                        int64_t defunc_0_op_res_f_res_f_res_77327;\n                        \n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77325 = redout_77517;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77325 = eta_p_77288;\n                        }\n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77326 = redout_77516;\n                            defunc_0_op_res_f_res_f_res_77327 = redout_77518;\n                        } else {\n                            int64_t min_res_77328;\n                            int64_t tmp_77329;\n                            \n                            min_res_77328 = smin64(x_77299, redout_77516);\n                            tmp_77329 = add64(x_77301, redout_77518);\n                            defunc_0_op_res_f_res_f_res_77326 = min_res_77328;\n                            defunc_0_op_res_f_res_f_res_77327 = tmp_77329;\n                        }\n                        defunc_0_op_res_f_res_77322 = defunc_0_op_res_f_res_f_res_77326;\n                        defunc_0_op_res_f_res_77323 = defunc_0_op_res_f_res_f_res_77325;\n                        defunc_0_op_res_f_res_77324 = defunc_0_op_res_f_res_f_res_77327;\n                    }\n                    defunc_0_op_res_77319 = defunc_0_op_res_f_res_77322;\n                    defunc_0_op_res_77320 = defunc_0_op_res_f_res_77323;\n                    defunc_0_op_res_77321 = defunc_0_op_res_f_res_77324;\n                }\n                redout_tmp_79007 = d", "efunc_0_op_res_77319;\n                redout_tmp_79008 = defunc_0_op_res_77320;\n                redout_tmp_79009 = defunc_0_op_res_77321;\n                redout_77516 = redout_tmp_79007;\n                redout_77517 = redout_tmp_79008;\n                redout_77518 = redout_tmp_79009;\n            }\n            x_77296 = redout_77516;\n            x_77297 = redout_77517;\n            x_77298 = redout_77518;\n            acc_77293 = x_77296;\n            acc_77294 = x_77297;\n            acc_77295 = x_77298;\n        } else {\n            acc_77293 = acc_77289;\n            acc_77294 = acc_77290;\n            acc_77295 = acc_77291;\n        }\n        mem_77750[(int64_t) 0] = acc_77293;\n        mem_77754[(int64_t) 0] = acc_77294;\n        mem_77758[(int64_t) 0] = acc_77295;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_79001[i_6] = mem_77750[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_79002[i_7] = mem_77754[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_79003[i_8] = mem_77758[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77738[i_9] = mem_param_tmp_79001[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77739[i_10] = mem_param_tmp_79002[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77740[i_11] = mem_param_tmp_79003[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77761[i_12] = mem_param_77738[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77760[i_13] = mem_param_77739[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77759[i_14] = mem_param_77740[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77365) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77777[i_15] = ext_mem_77761[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77776[i_16] = ext_mem_77759[i", "_16];\n    } else {\n        int64_t ltid_flat_77367;\n        int64_t ltid_77366;\n        int64_t j_77382;\n        bool cond_77386;\n        int64_t pre1d_77389;\n        int64_t pre1d_77387;\n        float pre1d_77388;\n        int64_t ltid_flat_77403;\n        int64_t ltid_77402;\n        int64_t gtid_77416;\n        int64_t acc_77418;\n        int64_t acc_77420;\n        bool cond_77421;\n        int64_t acc_77422;\n        int64_t acc_77424;\n        \n        ltid_flat_77367 = sext_i32_i64(local_tid_78992);\n        ltid_77366 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77382 = ltid_77366 + binop_x_77381;\n        cond_77386 = slt64(j_77382, j_m_i_67660);\n        pre1d_77389 = btoi_bool_i64(cond_77386);\n        if (cond_77386) {\n            int64_t tile_elem_77390;\n            int64_t slice_77490;\n            float tile_elem_77391;\n            \n            tile_elem_77390 = ((__global int64_t *) ext_mem_77720)[j_77382];\n            slice_77490 = slice_68069 + j_77382;\n            tile_elem_77391 = ((__global float *) tS_mem_77626)[slice_77490];\n            pre1d_77387 = tile_elem_77390;\n            pre1d_77388 = tile_elem_77391;\n        } else {\n            pre1d_77387 = (int64_t) 0;\n            pre1d_77388 = 0.0F;\n        }\n        ((__local int64_t *) color_78699)[ltid_77366] = pre1d_77387;\n        ((__local float *) color_78698)[ltid_77366] = pre1d_77388;\n        ((__local int64_t *) color_78697)[ltid_77366] = pre1d_77389;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77403 = sext_i32_i64(local_tid_78992);\n        ltid_77402 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77416 = binop_x_77132 + ltid_77402;\n        acc_77418 = ext_mem_77761[(int64_t) 0];\n        acc_77420 = ext_mem_77759[(int64_t) 0];\n        cond_77421 = slt64(gtid_77416, min_res_67698);\n        if (cond_77421) {\n            float eta_p_77417;\n            float acc_77419;\n            int64_t x_77425;\n            float x_77426;\n            int64_t x_77427;\n            int64_t",
                                    " redout_77520;\n            float redout_77521;\n            int64_t redout_77522;\n            \n            eta_p_77417 = mem_77725[(int64_t) 0];\n            acc_77419 = ext_mem_77760[(int64_t) 0];\n            redout_77520 = acc_77418;\n            redout_77521 = acc_77419;\n            redout_77522 = acc_77420;\n            for (int64_t i_77523 = 0; i_77523 < residual_input_77364; i_77523++) {\n                int64_t x_77428;\n                float x_77429;\n                bool defunc_0_neq_res_77437;\n                bool defunc_0_neq_res_77438;\n                bool cond_f_res_77439;\n                bool y_77440;\n                bool cond_77441;\n                bool defunc_0_neq_res_77442;\n                bool defunc_0_neq_res_77443;\n                bool cond_t_res_f_res_77444;\n                bool y_77445;\n                bool cond_t_res_77446;\n                bool x_77447;\n                int64_t defunc_0_op_res_77448;\n                float defunc_0_op_res_77449;\n                int64_t defunc_0_op_res_77450;\n                int64_t redout_tmp_79010;\n                float redout_tmp_79011;\n                int64_t redout_tmp_79012;\n                \n                x_77428 = ((__local int64_t *) color_78699)[i_77523];\n                x_77429 = ((__local float *) color_78698)[i_77523];\n                defunc_0_neq_res_77437 = redout_77521 == eta_p_77417;\n                defunc_0_neq_res_77438 = !defunc_0_neq_res_77437;\n                cond_f_res_77439 = slt64(redout_77520, (int64_t) 0);\n                y_77440 = defunc_0_neq_res_77437 && cond_f_res_77439;\n                cond_77441 = defunc_0_neq_res_77438 || y_77440;\n                defunc_0_neq_res_77442 = x_77429 == eta_p_77417;\n                defunc_0_neq_res_77443 = !defunc_0_neq_res_77442;\n                cond_t_res_f_res_77444 = slt64(x_77428, (int64_t) 0);\n                y_77445 = defunc_0_neq_res_77442 && cond_t_res_f_res_77444;\n                cond_t_res_77446 = defunc_0_neq_res_77443 || y_77445;\n             ", "   x_77447 = cond_77441 && cond_t_res_77446;\n                if (x_77447) {\n                    defunc_0_op_res_77448 = (int64_t) -1;\n                    defunc_0_op_res_77449 = eta_p_77417;\n                    defunc_0_op_res_77450 = (int64_t) 0;\n                } else {\n                    int64_t x_77430;\n                    int64_t defunc_0_op_res_f_res_77451;\n                    float defunc_0_op_res_f_res_77452;\n                    int64_t defunc_0_op_res_f_res_77453;\n                    \n                    x_77430 = ((__local int64_t *) color_78697)[i_77523];\n                    if (cond_77441) {\n                        defunc_0_op_res_f_res_77451 = x_77428;\n                        defunc_0_op_res_f_res_77452 = x_77429;\n                        defunc_0_op_res_f_res_77453 = x_77430;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_77454;\n                        int64_t defunc_0_op_res_f_res_f_res_77455;\n                        int64_t defunc_0_op_res_f_res_f_res_77456;\n                        \n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77454 = redout_77521;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77454 = eta_p_77417;\n                        }\n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77455 = redout_77520;\n                            defunc_0_op_res_f_res_f_res_77456 = redout_77522;\n                        } else {\n                            int64_t min_res_77457;\n                            int64_t tmp_77458;\n                            \n                            min_res_77457 = smin64(x_77428, redout_77520);\n                            tmp_77458 = add64(x_77430, redout_77522);\n                            defunc_0_op_res_f_res_f_res_77455 = min_res_77457;\n                            defunc_0_op_res_f_res_f_res_77456 = tmp_77458;\n                     ", "   }\n                        defunc_0_op_res_f_res_77451 = defunc_0_op_res_f_res_f_res_77455;\n                        defunc_0_op_res_f_res_77452 = defunc_0_op_res_f_res_f_res_77454;\n                        defunc_0_op_res_f_res_77453 = defunc_0_op_res_f_res_f_res_77456;\n                    }\n                    defunc_0_op_res_77448 = defunc_0_op_res_f_res_77451;\n                    defunc_0_op_res_77449 = defunc_0_op_res_f_res_77452;\n                    defunc_0_op_res_77450 = defunc_0_op_res_f_res_77453;\n                }\n                redout_tmp_79010 = defunc_0_op_res_77448;\n                redout_tmp_79011 = defunc_0_op_res_77449;\n                redout_tmp_79012 = defunc_0_op_res_77450;\n                redout_77520 = redout_tmp_79010;\n                redout_77521 = redout_tmp_79011;\n                redout_77522 = redout_tmp_79012;\n            }\n            x_77425 = redout_77520;\n            x_77426 = redout_77521;\n            x_77427 = redout_77522;\n            acc_77422 = x_77425;\n            acc_77424 = x_77427;\n        } else {\n            acc_77422 = acc_77418;\n            acc_77424 = acc_77420;\n        }\n        mem_77771[(int64_t) 0] = acc_77422;\n        mem_77775[(int64_t) 0] = acc_77424;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77777[i_17] = mem_77771[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77776[i_18] = mem_77775[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79013 = ext_mem_77777[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77779)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79013;\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79014 = ext_mem_77776[(int64_t) 0];\n        \n        ((__global int64_t *) mem_",
                                    "77781)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79014;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_77124\n    #undef bytes_77741\n    #undef bytes_77743\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegscan_74655_dim1, 1, 1)\nvoid inner_SMJ_floatzisegscan_74655(__global int *global_failure, int64_t nR_54353, int64_t num_tblocks_74652, int64_t num_virt_blocks_79082, int64_t num_virt_threads_79083, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *status_flags_mem_79084, __global unsigned char *aggregates_mem_79106, __global unsigned char *incprefixes_mem_79108, __global unsigned char *global_dynid_mem_79110)\n{\n    #define segscan_tblock_sizze_74650 (inner_SMJ_floatzisegscan_74655zisegscan_tblock_sizze_74650)\n    #define chunk_sizze_79081 (inner_SMJ_floatzisegscan_74655zichunk_sizze_79081)\n    \n    volatile __local unsigned char *local_mem_79140_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79140_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74650), chunk_sizze_79081 * segscan_tblock_sizze_74650 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74650), chunk_sizze_79081 * segscan_tblock_sizze_74650 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79133;\n    int32_t tblock_sizze_79136;\n    int32_t wave_sizze_79135;\n    int32_t block_id_79134;\n    int32_t global_tid_79132;\n    int64_t phys_tid_74655;\n    int32_t chunk_sizze_32b_79137;\n    int64_t byte_offsets_79138;\n    int64_t warp_byte_offset_79139;\n    __local unsigned char *local_mem_79140;\n    int64_t trans_arr_len_79141;\n    int64_t phys_block_id_79147;\n    int64_t virtloop_bound_79148;\n    \n    local_tid_79133 = get_local_id(0);\n    tblock_sizze_79136 = get_local_size(0);\n    wave_sizze_79135 = LOCKSTE", "P_WIDTH;\n    block_id_79134 = get_tblock_id(0);\n    global_tid_79132 = block_id_79134 * tblock_sizze_79136 + local_tid_79133;\n    phys_tid_74655 = sext_i32_i64(global_tid_79132);\n    chunk_sizze_32b_79137 = sext_i64_i32(chunk_sizze_79081);\n    byte_offsets_79138 = segscan_tblock_sizze_74650 * (int64_t) 8;\n    warp_byte_offset_79139 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79140 = (__local unsigned char *) local_mem_79140_backing_0;\n    trans_arr_len_79141 = chunk_sizze_79081 * segscan_tblock_sizze_74650;\n    phys_block_id_79147 = get_tblock_id(0);\n    virtloop_bound_79148 = sdiv_up64(num_virt_blocks_79082 - phys_block_id_79147, num_tblocks_74652);\n    for (int64_t virtloop_i_79149 = 0; virtloop_i_79149 < virtloop_bound_79148; virtloop_i_79149++) {\n        int64_t dynamic_id_79150;\n        int64_t block_offset_79151;\n        int64_t sgm_idx_79152;\n        int32_t boundary_79153;\n        int32_t segsizze_compact_79154;\n        int64_t private_mem_79155[chunk_sizze_79081];\n        int64_t thd_offset_79157;\n        int64_t acc_79173;\n        int64_t prefix_79183;\n        bool block_new_sgm_79184;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79133 == 0) {\n                dynamic_id_79150 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79110)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 0] = dynamic_id_79150;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79150 == num_virt_blocks_79082 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79110)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79150 = ((__local int32_t *) ", "local_mem_79140)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79151 = dynamic_id_79150 * chunk_sizze_79081 * segscan_tblock_sizze_74650;\n        sgm_idx_79152 = smod64(block_offset_79151, nR_54353);\n        boundary_79153 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_74650, nR_54353 - sgm_idx_79152));\n        segsizze_compact_79154 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_74650, nR_54353));\n        thd_offset_79157 = block_offset_79151 + sext_i32_i64(local_tid_79133);\n        // Load and map\n        {\n            for (int64_t i_79158 = 0; i_79158 < chunk_sizze_79081; i_79158++) {\n                int64_t virt_tid_79159 = thd_offset_79157 + i_79158 * segscan_tblock_sizze_74650;\n                int64_t slice_79160 = nR_54353;\n                int64_t gtid_74654 = virt_tid_79159;\n                int64_t remnant_79161 = virt_tid_79159 - gtid_74654;\n                \n                if (slt64(virt_tid_79159, nR_54353)) {\n                    int64_t eta_p_68120 = ((__global int64_t *) ext_mem_78096)[gtid_74654];\n                    bool lifted_lambda_res_68121 = slt64((int64_t) 0, eta_p_68120);\n                    int64_t defunc_0_f_res_68122 = btoi_bool_i64(lifted_lambda_res_68121);\n                    \n                    ((__global int64_t *) mem_78101)[gtid_74654] = defunc_0_f_res_68122;\n                    private_mem_79155[i_79158] = defunc_0_f_res_68122;\n                } else {\n                    private_mem_79155[i_79158] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79162 = 0; i_79162 < chunk_sizze_79081; i_79162++) {\n                int64_t sharedIdx_79163 = sext_i32_i64(local_tid_79133) + i_79162 * segscan_tblock_sizze_74650;\n                int64_t tmp_79164 = private_mem_79155[i_79162];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79163] = tm",
                                    "p_79164;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79165 = 0; i_79165 < chunk_sizze_79081; i_79165++) {\n                int64_t sharedIdx_79166 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79165;\n                int64_t tmp_79167 = ((__local int64_t *) local_mem_79140)[sharedIdx_79166];\n                \n                private_mem_79155[i_79165] = tmp_79167;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79168 = 0; i_79168 < chunk_sizze_79081 - (int64_t) 1; i_79168++) {\n                int64_t eta_p_67831;\n                int64_t eta_p_67832;\n                \n                eta_p_67831 = private_mem_79155[i_79168];\n                eta_p_67832 = private_mem_79155[i_79168 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_67833 = add64(eta_p_67831, eta_p_67832);\n                \n                private_mem_79155[i_79168 + (int64_t) 1] = defunc_0_op_res_67833;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79169 = private_mem_79155[chunk_sizze_79081 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = tmp_79169;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79170;\n            int64_t eta_p_79171;\n            int64_t eta_p_79174;\n            int64_t eta_p_79175;\n            bool ltid_in_bounds_79177 = slt64(sext_i32_i64(local_tid_79133), num_virt_threads_79083);\n            int32_t skip_threads_79178;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79177) {\n                    eta_p_79171 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                    if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n            ", "            eta_p_79170 = eta_p_79171;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79178 = 1;\n                while (slt32(skip_threads_79178, 32)) {\n                    bool thread_active_79179 = sle32(skip_threads_79178, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && ltid_in_bounds_79177;\n                    \n                    if (thread_active_79179) {\n                        // read operands\n                        {\n                            eta_p_79170 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79178)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79179) {\n                            int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                            \n                            eta_p_79170 = defunc_0_op_res_79172;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79179) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79170;\n                            eta_p_79171 = eta_p_79170;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79178 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79133 - squot32(local_tid_79133", ", 32) * 32) == 31 && ltid_in_bounds_79177) {\n                    ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32))] = eta_p_79170;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79180;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                        eta_p_79175 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                        if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                            eta_p_79174 = eta_p_79175;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79180 = 1;\n                    while (slt32(skip_threads_79180, 32)) {\n                        bool thread_active_79181 = sle32(skip_threads_79180, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177);\n                        \n                        if (thread_active_79181) {\n                            // read operands\n                            {\n                                eta_p_79174 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79180)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79181) {\n                                int64_t defunc_0_op_res_79176 = add64(eta_p_79174, eta_p_79175);\n                                \n                                eta_p_79174 = defunc_0_op_res_79176;\n                            }\n     ",
                                    "                   }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79181) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79174;\n                                eta_p_79175 = eta_p_79174;\n                            }\n                        }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79180 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79182 = squot32(local_tid_79133, 32) == 0 || !ltid_in_bounds_79177;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79182) {\n                        eta_p_79171 = eta_p_79170;\n                        eta_p_79170 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79182) {\n                        int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                        \n                        eta_p_79170 = defunc_0_op_res_79172;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79182) {\n                        ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79170;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            ", "// restore correct values for first block\n            {\n                if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                    ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79171;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79133 == 0) {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[segscan_tblock_sizze_74650 - (int64_t) 1];\n            } else {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79183 = (int64_t) 0;\n        block_new_sgm_79184 = sgm_idx_79152 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79184 && local_tid_79133 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = acc_79173;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                acc_79173 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79184 && slt32(local_tid_79133, wave_sizze_79135)) {\n                if (local_tid_79133 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79106)[dynamic_id_79150] = acc_79173;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 1;\n                    \n                    int8_t tmp_79185 = ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79140)[(int64_t) 0] = tmp_79185;\n                }\n                mem_fence_local();\n                \n                int8_t status_79186 = ((__local int8_t *) local_mem_79140)[(int64_t) 0];\n       ", "         \n                if (status_79186 == (int8_t) 2) {\n                    if (local_tid_79133 == 0) {\n                        prefix_79183 = ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79187 = sext_i64_i32(dynamic_id_79150 - sext_i32_i64(wave_sizze_79135));\n                    \n                    while (slt32(wave_sizze_79135 * -1, readOffset_79187)) {\n                        int32_t read_i_79188 = readOffset_79187 + local_tid_79133;\n                        int64_t aggr_79189 = (int64_t) 0;\n                        int8_t flag_79190 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79188)) {\n                            flag_79190 = ((volatile __global int8_t *) status_flags_mem_79084)[sext_i32_i64(read_i_79188)];\n                            if (flag_79190 == (int8_t) 2) {\n                                aggr_79189 = ((volatile __global int64_t *) incprefixes_mem_79108)[sext_i32_i64(read_i_79188)];\n                            } else if (flag_79190 == (int8_t) 1) {\n                                aggr_79189 = ((volatile __global int64_t *) aggregates_mem_79106)[sext_i32_i64(read_i_79188)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = aggr_79189;\n                        ((__local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flag_79190;\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        if (slt8(flag_79190, (int8_t) 2)) {\n                            int8_t flg_x_79194;\n                            int8_t flg_y_79195;\n                            int64_t eta_p_79191;\n                            int64_t eta_p_79192;\n                            int32_t skip_threads_79196;\n             ",
                                    "               \n                            // read input for in-block scan\n                            {\n                                flg_y_79195 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                                eta_p_79192 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)];\n                                if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                                    eta_p_79191 = eta_p_79192;\n                                    flg_x_79194 = flg_y_79195;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79196 = 1;\n                                while (slt32(skip_threads_79196, 32)) {\n                                    if (sle32(skip_threads_79196, local_tid_79133 - squot32(local_tid_79133, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79194 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196)];\n                                            eta_p_79191 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79195 == (int8_t) 2 || flg_y_79195 == (int8_t) 0) {\n                                                flg_x_79194 = flg_y_79195;\n                                                eta_p_79191 = eta_p_79192;\n                                            } else {\n                                                int64_t defunc_0_op_res_791", "93 = add64(eta_p_79191, eta_p_79192);\n                                                \n                                                eta_p_79191 = defunc_0_op_res_79193;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flg_x_79194;\n                                            flg_y_79195 = flg_x_79194;\n                                            ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = eta_p_79191;\n                                            eta_p_79192 = eta_p_79191;\n                                        }\n                                    }\n                                    skip_threads_79196 *= 2;\n                                }\n                            }\n                        }\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        aggr_79189 = ((__local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79135) - (int64_t) 1)];\n                        if (flag_79190 == (int8_t) 2) {\n                            readOffset_79187 = wave_sizze_79135 * -1;\n                        } else if (flag_79190 == (int8_t) 1) {\n                            readOffset_79187 -= wave_sizze_79135;\n                        }\n                        if (slt8((int8_t) 0, flag_79190)) {\n                            int64_t eta_p_79197 = aggr_79189;\n                            int64_t eta_p_79198 = prefix_79183;\n                            int64_t defunc_0_op_res_79199 = add64(eta_p_79197, eta_p_79198);\n                            \n                            prefix_79183 = defunc_0_op_res_79199;\n                        }\n                        mem_fence_local();", "\n                    }\n                }\n                if (local_tid_79133 == 0) {\n                    if (boundary_79153 == sext_i64_i32(segscan_tblock_sizze_74650 * chunk_sizze_79081)) {\n                        int64_t eta_p_79200 = prefix_79183;\n                        int64_t eta_p_79201 = acc_79173;\n                        int64_t defunc_0_op_res_79202 = add64(eta_p_79200, eta_p_79201);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = defunc_0_op_res_79202;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 4] = prefix_79183;\n                    acc_79173 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79150 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79183 = ((__local int64_t *) local_mem_79140)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79203;\n            int64_t eta_p_79204;\n            int64_t eta_p_79206 = prefix_79183;\n            int64_t eta_p_79207 = acc_79173;\n            \n            if (slt32(local_tid_79133 * chunk_sizze_32b_79137, boundary_79153) && !block_new_sgm_79184) {\n                int64_t defunc_0_op_res_79208 = add64(eta_p_79206, eta_p_79207);\n                \n                eta_p_79203 = defunc_0_op_res_79208;\n            } else {\n                eta_p_79203 = acc_79173;\n            }\n            \n            int32_t stopping_point_79209 = segsizze_compact_79154 - srem32(local_tid_79133 * chunk_sizze_32b_79137 - 1 + segsizze_compact_79154 - boundary_79153, segsizze_compact_79154);\n            \n            for (int64_t i_79210 = 0; i_79210 < chunk_sizze_79081; i_79210++) {\n                if (slt32(",
                                    "sext_i64_i32(i_79210), stopping_point_79209 - 1)) {\n                    eta_p_79204 = private_mem_79155[i_79210];\n                    \n                    int64_t defunc_0_op_res_79205 = add64(eta_p_79203, eta_p_79204);\n                    \n                    private_mem_79155[i_79210] = defunc_0_op_res_79205;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79211 = 0; i_79211 < chunk_sizze_79081; i_79211++) {\n                int64_t sharedIdx_79212 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79211;\n                int64_t tmp_79213 = private_mem_79155[i_79211];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79212] = tmp_79213;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79214 = 0; i_79214 < chunk_sizze_79081; i_79214++) {\n                int64_t flat_idx_79215 = thd_offset_79157 + i_79214 * segscan_tblock_sizze_74650;\n                int64_t slice_79216 = nR_54353;\n                int64_t gtid_74654 = flat_idx_79215;\n                int64_t remnant_79217 = flat_idx_79215 - gtid_74654;\n                \n                if (slt64(flat_idx_79215, nR_54353)) {\n                    int64_t tmp_79218 = ((__local int64_t *) local_mem_79140)[flat_idx_79215 - block_offset_79151];\n                    \n                    ((__global int64_t *) mem_78099)[gtid_74654] = tmp_79218;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_74650\n    #undef chunk_sizze_79081\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegscan_74671_dim1, 1, 1)\nvoid inner_SMJ_floatzisegscan_74671(__global int *global_failure, int64_t m_67844, int64_t num_tblocks_74668, int64_t num_virt_blocks_79239, int64_t num_virt_threads_79240, __global unsigned char *mem_78103, __global unsigned char *mem_78113, __global unsigned ", "char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *status_flags_mem_79241, __global unsigned char *aggregates_mem_79243, __global unsigned char *incprefixes_mem_79245, __global unsigned char *aggregates_mem_79247, __global unsigned char *incprefixes_mem_79249, __global unsigned char *global_dynid_mem_79251)\n{\n    #define segscan_tblock_sizze_74666 (inner_SMJ_floatzisegscan_74671zisegscan_tblock_sizze_74666)\n    #define chunk_sizze_79238 (inner_SMJ_floatzisegscan_74671zichunk_sizze_79238)\n    \n    volatile __local unsigned char *local_mem_79263_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79263_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_74666, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_74666), smax64(chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_74666, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_74666), smax64(chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79254;\n    int32_t tblock_sizze_79257;\n    int32_t wave_sizze_79256;\n    int32_t block_id_79255;\n    int32_t global_tid_79253;\n    int64_t phys_tid_74671;\n    int32_t chunk_sizze_32b_79258;\n    int64_t byte_offsets_79259;\n    int64_t byte_offsets_79260;\n    int64_t warp_byte_offset_79261;\n    int64_t warp_byte_offset_79262;\n    __local unsigned char *local_mem_79263;\n    int64_t trans_arr_len_79264;\n    int64_t phys_block_id_79273;\n    int64_t virtloop_bound_79274;\n    \n    local_tid_79254 = get_local_id(0);\n    tblock_sizze_79257 = get_local_size(0);\n    wave_sizze_79256 = LOCKSTEP_WIDTH;\n    block_id_79255 = get_tblock_id", "(0);\n    global_tid_79253 = block_id_79255 * tblock_sizze_79257 + local_tid_79254;\n    phys_tid_74671 = sext_i32_i64(global_tid_79253);\n    chunk_sizze_32b_79258 = sext_i64_i32(chunk_sizze_79238);\n    byte_offsets_79259 = segscan_tblock_sizze_74666 * (int64_t) 8;\n    byte_offsets_79260 = sdiv_up64(byte_offsets_79259, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_74666 * (int64_t) 8;\n    warp_byte_offset_79261 = (int64_t) 288;\n    warp_byte_offset_79262 = sdiv_up64(warp_byte_offset_79261, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79263 = (__local unsigned char *) local_mem_79263_backing_0;\n    trans_arr_len_79264 = chunk_sizze_79238 * segscan_tblock_sizze_74666;\n    phys_block_id_79273 = get_tblock_id(0);\n    virtloop_bound_79274 = sdiv_up64(num_virt_blocks_79239 - phys_block_id_79273, num_tblocks_74668);\n    for (int64_t virtloop_i_79275 = 0; virtloop_i_79275 < virtloop_bound_79274; virtloop_i_79275++) {\n        int64_t dynamic_id_79276;\n        int64_t block_offset_79277;\n        int64_t sgm_idx_79278;\n        int32_t boundary_79279;\n        int32_t segsizze_compact_79280;\n        int64_t private_mem_79281[chunk_sizze_79238];\n        int64_t private_mem_79283[chunk_sizze_79238];\n        int64_t thd_offset_79285;\n        int64_t acc_79311;\n        int64_t acc_79312;\n        int64_t prefix_79325;\n        int64_t prefix_79326;\n        bool block_new_sgm_79327;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79254 == 0) {\n                dynamic_id_79276 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79251)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 0] = dynamic_id_79276;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    ",
                                    "if (dynamic_id_79276 == num_virt_blocks_79239 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79251)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79276 = ((__local int32_t *) local_mem_79263)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79277 = dynamic_id_79276 * chunk_sizze_79238 * segscan_tblock_sizze_74666;\n        sgm_idx_79278 = smod64(block_offset_79277, m_67844);\n        boundary_79279 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_74666, m_67844 - sgm_idx_79278));\n        segsizze_compact_79280 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_74666, m_67844));\n        thd_offset_79285 = block_offset_79277 + sext_i32_i64(local_tid_79254);\n        // Load and map\n        {\n            for (int64_t i_79286 = 0; i_79286 < chunk_sizze_79238; i_79286++) {\n                int64_t virt_tid_79287 = thd_offset_79285 + i_79286 * segscan_tblock_sizze_74666;\n                int64_t slice_79288 = m_67844;\n                int64_t gtid_74670 = virt_tid_79287;\n                int64_t remnant_79289 = virt_tid_79287 - gtid_74670;\n                \n                if (slt64(virt_tid_79287, m_67844)) {\n                    int64_t x_68125 = ((__global int64_t *) mem_78103)[gtid_74670];\n                    bool lifted_lambda_res_68127 = slt64((int64_t) 1, x_68125);\n                    int64_t defunc_0_f_res_68128 = btoi_bool_i64(lifted_lambda_res_68127);\n                    \n                    ((__global int64_t *) mem_78117)[gtid_74670] = defunc_0_f_res_68128;\n                    private_mem_79281[i_79286] = x_68125;\n                    private_mem_79283[i_79286] = defunc_0_f_res_68128;\n                } else {\n                    private_mem_79281[i_79286] = (int64_t) 0;\n                    private_mem_79283[i_79286] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL", "_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79290 = 0; i_79290 < chunk_sizze_79238; i_79290++) {\n                int64_t sharedIdx_79291 = sext_i32_i64(local_tid_79254) + i_79290 * segscan_tblock_sizze_74666;\n                int64_t tmp_79292 = private_mem_79281[i_79290];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79291] = tmp_79292;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79293 = 0; i_79293 < chunk_sizze_79238; i_79293++) {\n                int64_t sharedIdx_79294 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79293;\n                int64_t tmp_79295 = ((__local int64_t *) local_mem_79263)[sharedIdx_79294];\n                \n                private_mem_79281[i_79293] = tmp_79295;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79296 = 0; i_79296 < chunk_sizze_79238; i_79296++) {\n                int64_t sharedIdx_79297 = sext_i32_i64(local_tid_79254) + i_79296 * segscan_tblock_sizze_74666;\n                int64_t tmp_79298 = private_mem_79283[i_79296];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79297] = tmp_79298;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79299 = 0; i_79299 < chunk_sizze_79238; i_79299++) {\n                int64_t sharedIdx_79300 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79299;\n                int64_t tmp_79301 = ((__local int64_t *) local_mem_79263)[sharedIdx_79300];\n                \n                private_mem_79283[i_79299] = tmp_79301;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79302 = 0; i_79302 < chunk_sizze_79238 - (int64_t) 1; i_79302++) {\n                int64_t eta_p_67881;\n                int64_t eta_p_67882;\n                \n                eta_p_67881 = private_mem_79281[i_79302];\n                eta_", "p_67882 = private_mem_79281[i_79302 + (int64_t) 1];\n                \n                int64_t eta_p_67974;\n                int64_t eta_p_67975;\n                \n                eta_p_67974 = private_mem_79283[i_79302];\n                eta_p_67975 = private_mem_79283[i_79302 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_67883 = add64(eta_p_67881, eta_p_67882);\n                int64_t defunc_0_op_res_67976 = add64(eta_p_67974, eta_p_67975);\n                \n                private_mem_79281[i_79302 + (int64_t) 1] = lifted_lambda_res_67883;\n                private_mem_79283[i_79302 + (int64_t) 1] = defunc_0_op_res_67976;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79303 = private_mem_79281[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = tmp_79303;\n            \n            int64_t tmp_79304 = private_mem_79283[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = tmp_79304;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79305;\n            int64_t eta_p_79306;\n            int64_t eta_p_79307;\n            int64_t eta_p_79308;\n            int64_t eta_p_79313;\n            int64_t eta_p_79314;\n            int64_t eta_p_79315;\n            int64_t eta_p_79316;\n            bool ltid_in_bounds_79319 = slt64(sext_i32_i64(local_tid_79254), num_virt_threads_79240);\n            int32_t skip_threads_79320;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79319) {\n                    eta_p_79307 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                    eta_p_79308 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte",
                                    "_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                    if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                        eta_p_79305 = eta_p_79307;\n                        eta_p_79306 = eta_p_79308;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79320 = 1;\n                while (slt32(skip_threads_79320, 32)) {\n                    bool thread_active_79321 = sle32(skip_threads_79320, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && ltid_in_bounds_79319;\n                    \n                    if (thread_active_79321) {\n                        // read operands\n                        {\n                            eta_p_79305 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320)];\n                            eta_p_79306 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79321) {\n                            int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                            int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                            \n                            eta_p_79305 = lifted_lambda_res_79309;\n                            eta_p_79306 = defunc_0_op_res_79310;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79321) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local", "_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                            eta_p_79307 = eta_p_79305;\n                            ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                            eta_p_79308 = eta_p_79306;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79320 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 31 && ltid_in_bounds_79319) {\n                    ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79305;\n                    ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79306;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79322;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                        eta_p_79315 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                        eta_p_79316 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                        if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                            eta_p_79313 = eta_p_79315;\n                            eta_p_79314 = eta_p_79", "316;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79322 = 1;\n                    while (slt32(skip_threads_79322, 32)) {\n                        bool thread_active_79323 = sle32(skip_threads_79322, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319);\n                        \n                        if (thread_active_79323) {\n                            // read operands\n                            {\n                                eta_p_79313 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322)];\n                                eta_p_79314 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79323) {\n                                int64_t lifted_lambda_res_79317 = add64(eta_p_79313, eta_p_79315);\n                                int64_t defunc_0_op_res_79318 = add64(eta_p_79314, eta_p_79316);\n                                \n                                eta_p_79313 = lifted_lambda_res_79317;\n                                eta_p_79314 = defunc_0_op_res_79318;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79323) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79313;\n                 ",
                                    "               eta_p_79315 = eta_p_79313;\n                                ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79314;\n                                eta_p_79316 = eta_p_79314;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79322 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79324 = squot32(local_tid_79254, 32) == 0 || !ltid_in_bounds_79319;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79324) {\n                        eta_p_79307 = eta_p_79305;\n                        eta_p_79308 = eta_p_79306;\n                        eta_p_79305 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1];\n                        eta_p_79306 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79324) {\n                        int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                        int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                        \n                        eta_p_79305 = lifted_lambda_res_79309;\n                        eta_p_79306 = defunc_0_op_res_79310;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79324) {\n                        ((__local int64_t *) local_", "mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                        ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                    ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79307;\n                    ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79308;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79254 == 0) {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[segscan_tblock_sizze_74666 - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (segscan_tblock_sizze_74666 - (int64_t) 1)];\n            } else {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79325 = (int64_t) 0;\n        prefix_79326 = (int64_t) 0;\n        block_new_sgm_79327 = sgm_idx_79278 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79327 && local_tid_79254 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = acc_79311;\n                ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276] = acc_79312;\n                mem_fence_global();\n                ((volatile __global int8_t *) stat", "us_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                acc_79311 = (int64_t) 0;\n                acc_79312 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79327 && slt32(local_tid_79254, wave_sizze_79256)) {\n                if (local_tid_79254 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79243)[dynamic_id_79276] = acc_79311;\n                    ((volatile __global int64_t *) aggregates_mem_79247)[dynamic_id_79276] = acc_79312;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 1;\n                    \n                    int8_t tmp_79328 = ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79263)[(int64_t) 0] = tmp_79328;\n                }\n                mem_fence_local();\n                \n                int8_t status_79329 = ((__local int8_t *) local_mem_79263)[(int64_t) 0];\n                \n                if (status_79329 == (int8_t) 2) {\n                    if (local_tid_79254 == 0) {\n                        prefix_79325 = ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276 - (int64_t) 1];\n                        prefix_79326 = ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79330 = sext_i64_i32(dynamic_id_79276 - sext_i32_i64(wave_sizze_79256));\n                    \n                    while (slt32(wave_sizze_79256 * -1, readOffset_79330)) {\n                        int32_t read_i_79331 = readOffset_79330 + local_tid_79254;\n                        int64_t aggr_79332 = (int64_t) 0;\n                        int64_t aggr_79333 = (int64_t) 0;\n                        int8_t flag_79334 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_793",
                                    "31)) {\n                            flag_79334 = ((volatile __global int8_t *) status_flags_mem_79241)[sext_i32_i64(read_i_79331)];\n                            if (flag_79334 == (int8_t) 2) {\n                                aggr_79332 = ((volatile __global int64_t *) incprefixes_mem_79245)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) incprefixes_mem_79249)[sext_i32_i64(read_i_79331)];\n                            } else if (flag_79334 == (int8_t) 1) {\n                                aggr_79332 = ((volatile __global int64_t *) aggregates_mem_79243)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) aggregates_mem_79247)[sext_i32_i64(read_i_79331)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = aggr_79332;\n                        ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = aggr_79333;\n                        ((__local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flag_79334;\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze_79256) - (int64_t) 1];\n                        if (slt8(flag_79334, (int8_t) 2)) {\n                            int8_t flg_x_79341;\n                            int8_t flg_y_79342;\n                            int64_t eta_p_79335;\n                            int64_t eta_p_79336;\n                            int64_t eta_p_79337;\n                            int64_t eta_p_79338;\n                            int32_t skip_threads_79343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79342 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                       ", "         eta_p_79337 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)];\n                                eta_p_79338 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                                    eta_p_79335 = eta_p_79337;\n                                    eta_p_79336 = eta_p_79338;\n                                    flg_x_79341 = flg_y_79342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79343 = 1;\n                                while (slt32(skip_threads_79343, 32)) {\n                                    if (sle32(skip_threads_79343, local_tid_79254 - squot32(local_tid_79254, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79341 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343)];\n                                            eta_p_79335 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                            eta_p_79336 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79342 == (int8_t) 2 || flg_y_79342 == (int8_t) 0) {\n                                                flg_x_79341 = flg_y_79342;\n", "                                                eta_p_79335 = eta_p_79337;\n                                                eta_p_79336 = eta_p_79338;\n                                            } else {\n                                                int64_t lifted_lambda_res_79339 = add64(eta_p_79335, eta_p_79337);\n                                                int64_t defunc_0_op_res_79340 = add64(eta_p_79336, eta_p_79338);\n                                                \n                                                eta_p_79335 = lifted_lambda_res_79339;\n                                                eta_p_79336 = defunc_0_op_res_79340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flg_x_79341;\n                                            flg_y_79342 = flg_x_79341;\n                                            ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = eta_p_79335;\n                                            eta_p_79337 = eta_p_79335;\n                                            ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79336;\n                                            eta_p_79338 = eta_p_79336;\n                                        }\n                                    }\n                                    skip_threads_79343 *= 2;\n                                }\n                            }\n                        }\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze_79256) - (int64_t) 1];\n                        aggr_79332 = ((__local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79256) - (in",
                                    "t64_t) 1)];\n                        aggr_79333 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(wave_sizze_79256) - (int64_t) 1)];\n                        if (flag_79334 == (int8_t) 2) {\n                            readOffset_79330 = wave_sizze_79256 * -1;\n                        } else if (flag_79334 == (int8_t) 1) {\n                            readOffset_79330 -= wave_sizze_79256;\n                        }\n                        if (slt8((int8_t) 0, flag_79334)) {\n                            int64_t eta_p_79344 = aggr_79332;\n                            int64_t eta_p_79345 = aggr_79333;\n                            int64_t eta_p_79346 = prefix_79325;\n                            int64_t eta_p_79347 = prefix_79326;\n                            int64_t lifted_lambda_res_79348 = add64(eta_p_79344, eta_p_79346);\n                            int64_t defunc_0_op_res_79349 = add64(eta_p_79345, eta_p_79347);\n                            \n                            prefix_79325 = lifted_lambda_res_79348;\n                            prefix_79326 = defunc_0_op_res_79349;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79254 == 0) {\n                    if (boundary_79279 == sext_i64_i32(segscan_tblock_sizze_74666 * chunk_sizze_79238)) {\n                        int64_t eta_p_79350 = prefix_79325;\n                        int64_t eta_p_79351 = prefix_79326;\n                        int64_t eta_p_79352 = acc_79311;\n                        int64_t eta_p_79353 = acc_79312;\n                        int64_t lifted_lambda_res_79354 = add64(eta_p_79350, eta_p_79352);\n                        int64_t defunc_0_op_res_79355 = add64(eta_p_79351, eta_p_79353);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = lifted_lambda_res_79354;\n                        ((volatile __global int64_t ", "*) incprefixes_mem_79249)[dynamic_id_79276] = defunc_0_op_res_79355;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 4] = prefix_79325;\n                    ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8)] = prefix_79326;\n                    acc_79311 = (int64_t) 0;\n                    acc_79312 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79276 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79325 = ((__local int64_t *) local_mem_79263)[(int64_t) 4];\n                prefix_79326 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79356;\n            int64_t eta_p_79358;\n            int64_t eta_p_79362 = prefix_79325;\n            int64_t eta_p_79364 = acc_79311;\n            int64_t eta_p_79357;\n            int64_t eta_p_79359;\n            int64_t eta_p_79363 = prefix_79326;\n            int64_t eta_p_79365 = acc_79312;\n            \n            if (slt32(local_tid_79254 * chunk_sizze_32b_79258, boundary_79279) && !block_new_sgm_79327) {\n                int64_t lifted_lambda_res_79366 = add64(eta_p_79362, eta_p_79364);\n                int64_t defunc_0_op_res_79367 = add64(eta_p_79363, eta_p_79365);\n                \n                eta_p_79356 = lifted_lambda_res_79366;\n                eta_p_79357 = defunc_0_op_res_79367;\n            } else {\n                eta_p_79356 = acc_79311;\n                eta_p_79357 = acc_79312;\n            }\n            \n            int32_t stopping_point_79368 = segsizze_compact_79280 - srem32(local_tid_79254 * chunk_sizze_32b_79258 - 1 + segsizze_compact_79280 - boundary_79279,", " segsizze_compact_79280);\n            \n            for (int64_t i_79369 = 0; i_79369 < chunk_sizze_79238; i_79369++) {\n                if (slt32(sext_i64_i32(i_79369), stopping_point_79368 - 1)) {\n                    eta_p_79358 = private_mem_79281[i_79369];\n                    eta_p_79359 = private_mem_79283[i_79369];\n                    \n                    int64_t lifted_lambda_res_79360 = add64(eta_p_79356, eta_p_79358);\n                    int64_t defunc_0_op_res_79361 = add64(eta_p_79357, eta_p_79359);\n                    \n                    private_mem_79281[i_79369] = lifted_lambda_res_79360;\n                    private_mem_79283[i_79369] = defunc_0_op_res_79361;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79370 = 0; i_79370 < chunk_sizze_79238; i_79370++) {\n                int64_t sharedIdx_79371 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79370;\n                int64_t tmp_79372 = private_mem_79281[i_79370];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79371] = tmp_79372;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79373 = 0; i_79373 < chunk_sizze_79238; i_79373++) {\n                int64_t flat_idx_79374 = thd_offset_79285 + i_79373 * segscan_tblock_sizze_74666;\n                int64_t slice_79375 = m_67844;\n                int64_t gtid_74670 = flat_idx_79374;\n                int64_t remnant_79376 = flat_idx_79374 - gtid_74670;\n                \n                if (slt64(flat_idx_79374, m_67844)) {\n                    int64_t tmp_79377 = ((__local int64_t *) local_mem_79263)[flat_idx_79374 - block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78113)[gtid_74670] = tmp_79377;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79378 = 0; i_79378 < chunk_sizze_79238; i_793",
                                    "78++) {\n                int64_t sharedIdx_79379 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79378;\n                int64_t tmp_79380 = private_mem_79283[i_79378];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79379] = tmp_79380;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79381 = 0; i_79381 < chunk_sizze_79238; i_79381++) {\n                int64_t flat_idx_79382 = thd_offset_79285 + i_79381 * segscan_tblock_sizze_74666;\n                int64_t slice_79383 = m_67844;\n                int64_t gtid_74670 = flat_idx_79382;\n                int64_t remnant_79384 = flat_idx_79382 - gtid_74670;\n                \n                if (slt64(flat_idx_79382, m_67844)) {\n                    int64_t tmp_79385 = ((__local int64_t *) local_mem_79263)[flat_idx_79382 - block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78115)[gtid_74670] = tmp_79385;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_74666\n    #undef chunk_sizze_79238\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78724_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78724(__global int *global_failure, int64_t gt_rhs_66981, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77633)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78726;\n    int32_t tblock_sizze_78729;\n    int32_t wave_sizze_78728;\n    int32_t block_id_78727;\n    int32_t global_tid_78725;\n    int64_t tid_78724;\n    int32_t x_77524;\n    \n    local_tid_78726 = get_local_id(0);\n    tblock_sizze_78729 = get_local_size(0);\n    wave_sizze_78728 = LOCKSTEP_WIDTH;\n    block_id_78727 = get_tblock_id(0);\n    global_tid_78725 = block_id_78727 * tblock_sizze_78729 + local_tid_78726;\n    tid_78724 = sext_i32_i64(global_tid_78725);\n    x_77524 = ((__global int32_t *) tR_mem_77625)[gt_rhs_66981];\n    ((__global int32_t *) ", "mem_77633)[(int64_t) 0] = x_77524;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78756_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78756(__global int *global_failure, int64_t tS_start_66998, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77634, __global unsigned char *mem_77641, __global unsigned char *mem_77642)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78758;\n    int32_t tblock_sizze_78761;\n    int32_t wave_sizze_78760;\n    int32_t block_id_78759;\n    int32_t global_tid_78757;\n    int64_t tid_78756;\n    int32_t gt_lhs_77528;\n    int32_t gt_rhs_77530;\n    bool defunc_0_gt_res_77532;\n    \n    local_tid_78758 = get_local_id(0);\n    tblock_sizze_78761 = get_local_size(0);\n    wave_sizze_78760 = LOCKSTEP_WIDTH;\n    block_id_78759 = get_tblock_id(0);\n    global_tid_78757 = block_id_78759 * tblock_sizze_78761 + local_tid_78758;\n    tid_78756 = sext_i32_i64(global_tid_78757);\n    gt_lhs_77528 = ((__global int32_t *) tS_mem_77626)[tS_start_66998];\n    gt_rhs_77530 = ((__global int32_t *) ext_mem_77634)[(int64_t) 0];\n    defunc_0_gt_res_77532 = slt32(gt_rhs_77530, gt_lhs_77528);\n    ((__global int32_t *) mem_77641)[(int64_t) 0] = gt_lhs_77528;\n    ((__global bool *) mem_77642)[(int64_t) 0] = defunc_0_gt_res_77532;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78762_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78762(__global int *global_failure, int64_t i_p_m_t_s_67004, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77908)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78764;\n    int32_t tblock_sizze_78767;\n    int32_t wave_sizze_78766;\n    int32_t block_id_78765;\n    int32_t global_tid_78763;\n    int64_t tid_78762;\n    int32_t x_77534;\n    \n    local_tid_78764 = get_local_id(0);\n    tblock_sizze_78767 = get_local_size(0);\n    wave_sizze_78766 = LOCKSTEP_WIDTH;\n    block_id_78765 = get_tblock_id(0);\n    global_tid_78763 = block_id_", "78765 * tblock_sizze_78767 + local_tid_78764;\n    tid_78762 = sext_i32_i64(global_tid_78763);\n    x_77534 = ((__global int32_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    ((__global int32_t *) mem_77908)[(int64_t) 0] = x_77534;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78778_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78778(__global int *global_failure, int64_t start_68558, int64_t i_p_m_t_s_68564, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77916, __global unsigned char *mem_77917)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78780;\n    int32_t tblock_sizze_78783;\n    int32_t wave_sizze_78782;\n    int32_t block_id_78781;\n    int32_t global_tid_78779;\n    int64_t tid_78778;\n    int32_t r_max_77538;\n    int32_t r_min_77541;\n    \n    local_tid_78780 = get_local_id(0);\n    tblock_sizze_78783 = get_local_size(0);\n    wave_sizze_78782 = LOCKSTEP_WIDTH;\n    block_id_78781 = get_tblock_id(0);\n    global_tid_78779 = block_id_78781 * tblock_sizze_78783 + local_tid_78780;\n    tid_78778 = sext_i32_i64(global_tid_78779);\n    r_max_77538 = ((__global int32_t *) tR_mem_77625)[i_p_m_t_s_68564];\n    r_min_77541 = ((__global int32_t *) tR_mem_77625)[start_68558];\n    ((__global int32_t *) mem_77916)[(int64_t) 0] = r_max_77538;\n    ((__global int32_t *) mem_77917)[(int64_t) 0] = r_min_77541;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78784_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78784(__global int *global_failure, __global unsigned char *mem_77917, __global unsigned char *ext_mem_77918, __global unsigned char *mem_77920)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78786;\n    int32_t tblock_sizze_78789;\n    int32_t wave_sizze_78788;\n    int32_t block_id_78787;\n    int32_t global_tid_78785;\n    int64_t tid_78784;\n    int32_t s_max_77543;\n    int32_t r_min_77544;\n    bool defunc_0_gt_res_77545;\n    \n    local_tid_78786 = get_local_id(0);\n    tblock_sizze_7",
                                    "8789 = get_local_size(0);\n    wave_sizze_78788 = LOCKSTEP_WIDTH;\n    block_id_78787 = get_tblock_id(0);\n    global_tid_78785 = block_id_78787 * tblock_sizze_78789 + local_tid_78786;\n    tid_78784 = sext_i32_i64(global_tid_78785);\n    s_max_77543 = ((__global int32_t *) ext_mem_77918)[(int64_t) 0];\n    r_min_77544 = ((__global int32_t *) mem_77917)[(int64_t) 0];\n    defunc_0_gt_res_77545 = slt32(s_max_77543, r_min_77544);\n    ((__global bool *) mem_77920)[(int64_t) 0] = defunc_0_gt_res_77545;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78790_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78790(__global int *global_failure, __global unsigned char *mem_77916, __global unsigned char *ext_mem_77919, __global unsigned char *mem_77921)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78792;\n    int32_t tblock_sizze_78795;\n    int32_t wave_sizze_78794;\n    int32_t block_id_78793;\n    int32_t global_tid_78791;\n    int64_t tid_78790;\n    int32_t r_max_77548;\n    int32_t s_min_77549;\n    bool defunc_0_gt_res_77550;\n    \n    local_tid_78792 = get_local_id(0);\n    tblock_sizze_78795 = get_local_size(0);\n    wave_sizze_78794 = LOCKSTEP_WIDTH;\n    block_id_78793 = get_tblock_id(0);\n    global_tid_78791 = block_id_78793 * tblock_sizze_78795 + local_tid_78792;\n    tid_78790 = sext_i32_i64(global_tid_78791);\n    r_max_77548 = ((__global int32_t *) mem_77916)[(int64_t) 0];\n    s_min_77549 = ((__global int32_t *) ext_mem_77919)[(int64_t) 0];\n    defunc_0_gt_res_77550 = slt32(r_max_77548, s_min_77549);\n    ((__global bool *) mem_77921)[(int64_t) 0] = defunc_0_gt_res_77550;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78849_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78849(__global int *global_failure, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77648)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78851;\n    int32_t tblock_sizze_78854;\n    int32_t wave_sizze_78853;\n   ", " int32_t block_id_78852;\n    int32_t global_tid_78850;\n    int64_t tid_78849;\n    int32_t x_77552;\n    \n    local_tid_78851 = get_local_id(0);\n    tblock_sizze_78854 = get_local_size(0);\n    wave_sizze_78853 = LOCKSTEP_WIDTH;\n    block_id_78852 = get_tblock_id(0);\n    global_tid_78850 = block_id_78852 * tblock_sizze_78854 + local_tid_78851;\n    tid_78849 = sext_i32_i64(global_tid_78850);\n    x_77552 = ((__global int32_t *) tR_mem_77625)[(int64_t) 0];\n    ((__global int32_t *) mem_77648)[(int64_t) 0] = x_77552;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78855_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78855(__global int *global_failure, __global unsigned char *mem_77641, __global unsigned char *ext_mem_77649, __global unsigned char *mem_77650)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78857;\n    int32_t tblock_sizze_78860;\n    int32_t wave_sizze_78859;\n    int32_t block_id_78858;\n    int32_t global_tid_78856;\n    int64_t tid_78855;\n    int32_t leq_lhs_77556;\n    int32_t gt_lhs_77557;\n    bool defunc_0_leq_res_77558;\n    \n    local_tid_78857 = get_local_id(0);\n    tblock_sizze_78860 = get_local_size(0);\n    wave_sizze_78859 = LOCKSTEP_WIDTH;\n    block_id_78858 = get_tblock_id(0);\n    global_tid_78856 = block_id_78858 * tblock_sizze_78860 + local_tid_78857;\n    tid_78855 = sext_i32_i64(global_tid_78856);\n    leq_lhs_77556 = ((__global int32_t *) ext_mem_77649)[(int64_t) 0];\n    gt_lhs_77557 = ((__global int32_t *) mem_77641)[(int64_t) 0];\n    defunc_0_leq_res_77558 = sle32(leq_lhs_77556, gt_lhs_77557);\n    ((__global bool *) mem_77650)[(int64_t) 0] = defunc_0_leq_res_77558;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78861_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78861(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_44377, unsigned char y_67146_bits, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77641, __glo", "bal unsigned char *mem_77650, __global unsigned char *mem_77652)\n{\n    bool y_67146 = y_67146_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78863;\n    int32_t tblock_sizze_78866;\n    int32_t wave_sizze_78865;\n    int32_t block_id_78864;\n    int32_t global_tid_78862;\n    int64_t tid_78861;\n    bool defunc_0_leq_res_77560;\n    int32_t x_77565;\n    \n    local_tid_78863 = get_local_id(0);\n    tblock_sizze_78866 = get_local_size(0);\n    wave_sizze_78865 = LOCKSTEP_WIDTH;\n    block_id_78864 = get_tblock_id(0);\n    global_tid_78862 = block_id_78864 * tblock_sizze_78866 + local_tid_78863;\n    tid_78861 = sext_i32_i64(global_tid_78862);\n    defunc_0_leq_res_77560 = ((__global bool *) mem_77650)[(int64_t) 0];\n    if (defunc_0_leq_res_77560) {\n        bool index_certs_77561;\n        int32_t lowest_t_res_77562;\n        \n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 74) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_44377;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_77562 = ((__global int32_t *) tR_mem_77625)[(int64_t) 0];\n        x_77565 = lowest_t_res_77562;\n    } else {\n        int32_t gt_lhs_77564;\n        bool index_certs_77563;\n        \n        gt_lhs_77564 = ((__global int32_t *) mem_77641)[(int64_t) 0];\n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 75) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_44377;\n                    ;\n                }\n                return;\n            }\n        }\n        x_77565 = gt_lhs_77564;\n    }\n    ((__global int32_t *) mem_77652)[(int64_t) 0] = x_77565;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78923_dim1, 1, 1)\nvoid ",
                                    "inner_SMJ_intzigpuseq_78923(__global int *global_failure, int64_t slice_68069, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77700)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78925;\n    int32_t tblock_sizze_78928;\n    int32_t wave_sizze_78927;\n    int32_t block_id_78926;\n    int32_t global_tid_78924;\n    int64_t tid_78923;\n    int32_t x_77570;\n    \n    local_tid_78925 = get_local_id(0);\n    tblock_sizze_78928 = get_local_size(0);\n    wave_sizze_78927 = LOCKSTEP_WIDTH;\n    block_id_78926 = get_tblock_id(0);\n    global_tid_78924 = block_id_78926 * tblock_sizze_78928 + local_tid_78925;\n    tid_78923 = sext_i32_i64(global_tid_78924);\n    x_77570 = ((__global int32_t *) tS_mem_77626)[slice_68069];\n    ((__global int32_t *) mem_77700)[(int64_t) 0] = x_77570;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78929_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78929(__global int *global_failure, int64_t slice_68867, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77703)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78931;\n    int32_t tblock_sizze_78934;\n    int32_t wave_sizze_78933;\n    int32_t block_id_78932;\n    int32_t global_tid_78930;\n    int64_t tid_78929;\n    int32_t x_77574;\n    \n    local_tid_78931 = get_local_id(0);\n    tblock_sizze_78934 = get_local_size(0);\n    wave_sizze_78933 = LOCKSTEP_WIDTH;\n    block_id_78932 = get_tblock_id(0);\n    global_tid_78930 = block_id_78932 * tblock_sizze_78934 + local_tid_78931;\n    tid_78929 = sext_i32_i64(global_tid_78930);\n    x_77574 = ((__global int32_t *) tS_mem_77626)[slice_68867];\n    ((__global int32_t *) mem_77703)[(int64_t) 0] = x_77574;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78945_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78945(__global int *global_failure, int64_t slice_67712, int64_t slice_67721, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77711, __glo", "bal unsigned char *mem_77712)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78947;\n    int32_t tblock_sizze_78950;\n    int32_t wave_sizze_78949;\n    int32_t block_id_78948;\n    int32_t global_tid_78946;\n    int64_t tid_78945;\n    int32_t r_max_77578;\n    int32_t r_min_77581;\n    \n    local_tid_78947 = get_local_id(0);\n    tblock_sizze_78950 = get_local_size(0);\n    wave_sizze_78949 = LOCKSTEP_WIDTH;\n    block_id_78948 = get_tblock_id(0);\n    global_tid_78946 = block_id_78948 * tblock_sizze_78950 + local_tid_78947;\n    tid_78945 = sext_i32_i64(global_tid_78946);\n    r_max_77578 = ((__global int32_t *) tR_mem_77625)[slice_67721];\n    r_min_77581 = ((__global int32_t *) tR_mem_77625)[slice_67712];\n    ((__global int32_t *) mem_77711)[(int64_t) 0] = r_max_77578;\n    ((__global int32_t *) mem_77712)[(int64_t) 0] = r_min_77581;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78951_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78951(__global int *global_failure, __global unsigned char *mem_77712, __global unsigned char *ext_mem_77713, __global unsigned char *mem_77715)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78953;\n    int32_t tblock_sizze_78956;\n    int32_t wave_sizze_78955;\n    int32_t block_id_78954;\n    int32_t global_tid_78952;\n    int64_t tid_78951;\n    int32_t s_max_77583;\n    int32_t r_min_77584;\n    bool defunc_0_gt_res_77585;\n    \n    local_tid_78953 = get_local_id(0);\n    tblock_sizze_78956 = get_local_size(0);\n    wave_sizze_78955 = LOCKSTEP_WIDTH;\n    block_id_78954 = get_tblock_id(0);\n    global_tid_78952 = block_id_78954 * tblock_sizze_78956 + local_tid_78953;\n    tid_78951 = sext_i32_i64(global_tid_78952);\n    s_max_77583 = ((__global int32_t *) ext_mem_77713)[(int64_t) 0];\n    r_min_77584 = ((__global int32_t *) mem_77712)[(int64_t) 0];\n    defunc_0_gt_res_77585 = slt32(s_max_77583, r_min_77584);\n    ((__global bool *) mem_77715)[(int64_t) 0] = defunc_0_gt_res_77585;\n    \n  e", "rror_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_78957_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_78957(__global int *global_failure, __global unsigned char *mem_77711, __global unsigned char *ext_mem_77714, __global unsigned char *mem_77716)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78959;\n    int32_t tblock_sizze_78962;\n    int32_t wave_sizze_78961;\n    int32_t block_id_78960;\n    int32_t global_tid_78958;\n    int64_t tid_78957;\n    int32_t r_max_77588;\n    int32_t s_min_77589;\n    bool defunc_0_gt_res_77590;\n    \n    local_tid_78959 = get_local_id(0);\n    tblock_sizze_78962 = get_local_size(0);\n    wave_sizze_78961 = LOCKSTEP_WIDTH;\n    block_id_78960 = get_tblock_id(0);\n    global_tid_78958 = block_id_78960 * tblock_sizze_78962 + local_tid_78959;\n    tid_78957 = sext_i32_i64(global_tid_78958);\n    r_max_77588 = ((__global int32_t *) mem_77711)[(int64_t) 0];\n    s_min_77589 = ((__global int32_t *) ext_mem_77714)[(int64_t) 0];\n    defunc_0_gt_res_77590 = slt32(r_max_77588, s_min_77589);\n    ((__global bool *) mem_77716)[(int64_t) 0] = defunc_0_gt_res_77590;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_79070_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_79070(__global int *global_failure, int64_t gt_rhs_66981, int64_t i_p_m_t_s_67004, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_78084)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79072;\n    int32_t tblock_sizze_79075;\n    int32_t wave_sizze_79074;\n    int32_t block_id_79073;\n    int32_t global_tid_79071;\n    int64_t tid_79070;\n    int32_t leq_lhs_77592;\n    int32_t leq_rhs_77594;\n    bool defunc_0_leq_res_77598;\n    \n    local_tid_79072 = get_local_id(0);\n    tblock_sizze_79075 = get_local_size(0);\n    wave_sizze_79074 = LOCKSTEP_WIDTH;\n    block_id_79073 = get_tblock_id(0);\n    global_tid_79071 = block_id_79073 * tblock_sizze_79075 + local_tid_79072;\n    tid_790",
                                    "70 = sext_i32_i64(global_tid_79071);\n    leq_lhs_77592 = ((__global int32_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    leq_rhs_77594 = ((__global int32_t *) tR_mem_77625)[gt_rhs_66981];\n    defunc_0_leq_res_77598 = sle32(leq_lhs_77592, leq_rhs_77594);\n    ((__global bool *) mem_78084)[(int64_t) 0] = defunc_0_leq_res_77598;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_79375_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_79375(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78120, __global unsigned char *mem_78122)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79377;\n    int32_t tblock_sizze_79380;\n    int32_t wave_sizze_79379;\n    int32_t block_id_79378;\n    int32_t global_tid_79376;\n    int64_t tid_79375;\n    int64_t x_77600;\n    \n    local_tid_79377 = get_local_id(0);\n    tblock_sizze_79380 = get_local_size(0);\n    wave_sizze_79379 = LOCKSTEP_WIDTH;\n    block_id_79378 = get_tblock_id(0);\n    global_tid_79376 = block_id_79378 * tblock_sizze_79380 + local_tid_79377;\n    tid_79375 = sext_i32_i64(global_tid_79376);\n    x_77600 = ((__global int64_t *) mem_78120)[m_67854];\n    ((__global int64_t *) mem_78122)[(int64_t) 0] = x_77600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_79381_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_79381(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78103, __global unsigned char *mem_78125)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79383;\n    int32_t tblock_sizze_79386;\n    int32_t wave_sizze_79385;\n    int32_t block_id_79384;\n    int32_t global_tid_79382;\n    int64_t tid_79381;\n    int64_t x_77604;\n    \n    local_tid_79383 = get_local_id(0);\n    tblock_sizze_79386 = get_local_size(0);\n    wave_sizze_79385 = LOCKSTEP_WIDTH;\n    block_id_79384 = get_tblock_id(0);\n    global_tid_79382 = block_id_79384 * tblock_sizze_79386 + local_tid_79383;\n    tid_79381 = sext_i32_i64(global_tid_79382);\n   ", " x_77604 = ((__global int64_t *) mem_78103)[m_67854];\n    ((__global int64_t *) mem_78125)[(int64_t) 0] = x_77604;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_79387_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_79387(__global int *global_failure, __global unsigned char *ext_mem_78123, __global unsigned char *ext_mem_78126, __global unsigned char *mem_78132)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79389;\n    int32_t tblock_sizze_79392;\n    int32_t wave_sizze_79391;\n    int32_t block_id_79390;\n    int32_t global_tid_79388;\n    int64_t tid_79387;\n    int64_t zp_lhs_77608;\n    int64_t n_pairs_t_res_77609;\n    int64_t n_pairs_t_res_77610;\n    \n    local_tid_79389 = get_local_id(0);\n    tblock_sizze_79392 = get_local_size(0);\n    wave_sizze_79391 = LOCKSTEP_WIDTH;\n    block_id_79390 = get_tblock_id(0);\n    global_tid_79388 = block_id_79390 * tblock_sizze_79392 + local_tid_79389;\n    tid_79387 = sext_i32_i64(global_tid_79388);\n    zp_lhs_77608 = ((__global int64_t *) ext_mem_78123)[(int64_t) 0];\n    n_pairs_t_res_77609 = ((__global int64_t *) ext_mem_78126)[(int64_t) 0];\n    n_pairs_t_res_77610 = add64(zp_lhs_77608, n_pairs_t_res_77609);\n    ((__global int64_t *) mem_78132)[(int64_t) 0] = n_pairs_t_res_77610;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_79434_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_79434(__global int *global_failure, int64_t loopres_68028, __global unsigned char *mem_param_78166, __global unsigned char *mem_param_78169, __global unsigned char *mem_param_78172, __global unsigned char *mem_78179, __global unsigned char *mem_78180, __global unsigned char *mem_78181)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79436;\n    int32_t tblock_sizze_79439;\n    int32_t wave_sizze_79438;\n    int32_t block_id_79437;\n    int32_t global_tid_79435;\n    int64_t tid_79434;\n    int32_t loopres_77612;\n    int64_t loopres_77614;\n    int64_t loopres_77616;\n    \n    l", "ocal_tid_79436 = get_local_id(0);\n    tblock_sizze_79439 = get_local_size(0);\n    wave_sizze_79438 = LOCKSTEP_WIDTH;\n    block_id_79437 = get_tblock_id(0);\n    global_tid_79435 = block_id_79437 * tblock_sizze_79439 + local_tid_79436;\n    tid_79434 = sext_i32_i64(global_tid_79435);\n    loopres_77612 = ((__global int32_t *) mem_param_78166)[loopres_68028];\n    loopres_77614 = ((__global int64_t *) mem_param_78169)[loopres_68028];\n    loopres_77616 = ((__global int64_t *) mem_param_78172)[loopres_68028];\n    ((__global int32_t *) mem_78179)[(int64_t) 0] = loopres_77612;\n    ((__global int64_t *) mem_78180)[(int64_t) 0] = loopres_77614;\n    ((__global int64_t *) mem_78181)[(int64_t) 0] = loopres_77616;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_intzireplicate_79441(int64_t loopres_68029, int64_t replicate_n_79440, int64_t virt_num_tblocks_79446, int64_t num_tblocks_79447, __global unsigned char *mem_78179, __global unsigned char *mem_78183)\n{\n    int32_t replicate_ltid_79442;\n    int32_t tblock_sizze_79444;\n    int32_t replicate_gid_79443;\n    int32_t replicate_gtid_79441;\n    int32_t phys_tblock_id_79448;\n    int32_t iterations_79449;\n    \n    replicate_ltid_79442 = get_local_id(0);\n    tblock_sizze_79444 = get_local_size(0);\n    replicate_gid_79443 = get_tblock_id(0);\n    replicate_gtid_79441 = replicate_gid_79443 * tblock_sizze_79444 + replicate_ltid_79442;\n    phys_tblock_id_79448 = get_tblock_id(0);\n    iterations_79449 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79446) - phys_tblock_id_79448, sext_i64_i32(num_tblocks_79447));\n    for (int32_t i_79450 = 0; i_79450 < iterations_79449; i_79450++) {\n        int32_t virt_tblock_id_79451;\n        int64_t global_tid_79452;\n        int64_t slice_79455;\n        int64_t slice_79456;\n        int64_t rep_i_79453;\n        int64_t remnant_79457;\n        int64_t rep_i_79454;\n        int64_t remnant_79458;\n        \n        virt_tblock_id_79451 = phys_tblock_id_79448 + i_79450 * sext_i64_i32(num_tblocks_79447);\n    ",
                                    "    global_tid_79452 = sext_i32_i64(virt_tblock_id_79451) * sext_i32_i64(tblock_sizze_79444) + sext_i32_i64(replicate_ltid_79442);\n        slice_79455 = (int64_t) 1;\n        slice_79456 = loopres_68029 * slice_79455;\n        rep_i_79453 = squot64(global_tid_79452, slice_79455);\n        remnant_79457 = global_tid_79452 - rep_i_79453 * slice_79455;\n        rep_i_79454 = remnant_79457;\n        remnant_79458 = remnant_79457 - rep_i_79454;\n        if (slt64(global_tid_79452, replicate_n_79440)) {\n            int32_t tmp_79459 = ((__global int32_t *) mem_78179)[rep_i_79454];\n            \n            ((__global int32_t *) mem_78183)[rep_i_79453 + rep_i_79454] = tmp_79459;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_intzireplicate_79461(int64_t loopres_68029, int64_t replicate_n_79460, int64_t virt_num_tblocks_79466, int64_t num_tblocks_79467, __global unsigned char *mem_78180, __global unsigned char *mem_78185)\n{\n    int32_t replicate_ltid_79462;\n    int32_t tblock_sizze_79464;\n    int32_t replicate_gid_79463;\n    int32_t replicate_gtid_79461;\n    int32_t phys_tblock_id_79468;\n    int32_t iterations_79469;\n    \n    replicate_ltid_79462 = get_local_id(0);\n    tblock_sizze_79464 = get_local_size(0);\n    replicate_gid_79463 = get_tblock_id(0);\n    replicate_gtid_79461 = replicate_gid_79463 * tblock_sizze_79464 + replicate_ltid_79462;\n    phys_tblock_id_79468 = get_tblock_id(0);\n    iterations_79469 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79466) - phys_tblock_id_79468, sext_i64_i32(num_tblocks_79467));\n    for (int32_t i_79470 = 0; i_79470 < iterations_79469; i_79470++) {\n        int32_t virt_tblock_id_79471;\n        int64_t global_tid_79472;\n        int64_t slice_79475;\n        int64_t slice_79476;\n        int64_t rep_i_79473;\n        int64_t remnant_79477;\n        int64_t rep_i_79474;\n        int64_t remnant_79478;\n        \n        virt_tblock_id_79471 = phys_tblock_id_79468 + i_79", "470 * sext_i64_i32(num_tblocks_79467);\n        global_tid_79472 = sext_i32_i64(virt_tblock_id_79471) * sext_i32_i64(tblock_sizze_79464) + sext_i32_i64(replicate_ltid_79462);\n        slice_79475 = (int64_t) 1;\n        slice_79476 = loopres_68029 * slice_79475;\n        rep_i_79473 = squot64(global_tid_79472, slice_79475);\n        remnant_79477 = global_tid_79472 - rep_i_79473 * slice_79475;\n        rep_i_79474 = remnant_79477;\n        remnant_79478 = remnant_79477 - rep_i_79474;\n        if (slt64(global_tid_79472, replicate_n_79460)) {\n            int64_t tmp_79479 = ((__global int64_t *) mem_78180)[rep_i_79474];\n            \n            ((__global int64_t *) mem_78185)[rep_i_79473 + rep_i_79474] = tmp_79479;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71193_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71193(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_44377, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t max_res_67171, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, int64_t zt_rhs_67177, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77653, __global unsigned char *mem_77662, __global unsigned char *mem_77664)\n{\n    #define segmap_tblock_sizze_71188 (inner_SMJ_intzisegmap_71193zisegmap_tblock_sizze_71188)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78873;\n    int32_t tblock_sizze_78876;\n    int32_t wave_sizze_78875;\n    int32_t block_id_78874;\n    int32_t global_tid_78872;\n    int64_t phys_tid_71193;\n    int64_t global_tid_78877;\n    int64_t slice_78878;\n    int64_t gtid_71192;\n    int64_t remnant_78879;\n    \n    local_tid_78873 = get_local_id(0);\n    tblock_sizze_78876 = get_local_size(0);\n    wave_sizze_78875 = LOCKSTEP_WIDTH;\n    block_i", "d_78874 = get_tblock_id(0);\n    global_tid_78872 = block_id_78874 * tblock_sizze_78876 + local_tid_78873;\n    phys_tid_71193 = sext_i32_i64(global_tid_78872);\n    global_tid_78877 = sext_i32_i64(block_id_78874) * segmap_tblock_sizze_71188 + sext_i32_i64(local_tid_78873);\n    slice_78878 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;\n    gtid_71192 = global_tid_78877;\n    remnant_78879 = global_tid_78877 - gtid_71192;\n    if (slt64(gtid_71192, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172)) {\n        int32_t lowest_77569;\n        int64_t index_primexp_76055;\n        int64_t zs_lhs_71195;\n        int64_t index_71196;\n        bool cond_71197;\n        int64_t loop_over_71198;\n        int64_t loop_over_71199;\n        int64_t loop_over_71201;\n        bool defunc_0_f_res_71204;\n        int64_t defunc_0_f_res_71205;\n        int64_t defunc_0_f_res_71206;\n        int64_t defunc_0_f_res_71207;\n        bool loop_while_71208;\n        int64_t p_71209;\n        int64_t p_71210;\n        int64_t p_71211;\n        \n        lowest_77569 = ((__global int32_t *) ext_mem_77653)[(int64_t) 0];\n        index_primexp_76055 = add64(max_res_67171, gtid_71192);\n        zs_lhs_71195 = mul64(zt_rhs_67177, index_primexp_76055);\n        index_71196 = sdiv64(zs_lhs_71195, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n        cond_71197 = slt64(nR_44377, index_71196);\n        if (cond_71197) {\n            loop_over_71198 = nR_44377;\n        } else {\n            loop_over_71198 = index_71196;\n        }\n        if (cond_71197) {\n            int64_t loop_over_t_res_71200 = sub64(index_71196, nR_44377);\n            \n            loop_over_71199 = loop_over_t_res_71200;\n        } else {\n            loop_over_71199 = (int64_t) 0;\n        }\n        if (cond_71197) {\n            int64_t zm_lhs_71202;\n            int64_t loop_over_t_res_71203;\n            \n            zm_lhs_71202 = sub64(index_71196, nR_44377);\n            loop_over_t_res_71203 = sub64(zm_lh",
                                    "s_71202, (int64_t) 1);\n            loop_over_71201 = loop_over_t_res_71203;\n        } else {\n            loop_over_71201 = (int64_t) 0;\n        }\n        loop_while_71208 = 1;\n        p_71209 = loop_over_71201;\n        p_71210 = loop_over_71198;\n        p_71211 = loop_over_71199;\n        while (loop_while_71208) {\n            int64_t zs_lhs_71212;\n            int64_t offset_71213;\n            int64_t ai_71214;\n            int64_t max_arg1_71215;\n            int64_t max_res_71216;\n            bool cond_71217;\n            int32_t b_prev_71218;\n            bool cond_71226;\n            int64_t loopres_71227;\n            int64_t loopres_71228;\n            int64_t loopres_71229;\n            bool loopres_71230;\n            bool loop_while_tmp_78880;\n            int64_t p_tmp_78881;\n            int64_t p_tmp_78882;\n            int64_t p_tmp_78883;\n            \n            zs_lhs_71212 = sub64(p_71210, p_71209);\n            offset_71213 = sdiv64(zs_lhs_71212, (int64_t) 2);\n            ai_71214 = sub64(p_71210, offset_71213);\n            max_arg1_71215 = add64(p_71211, offset_71213);\n            max_res_71216 = smax64((int64_t) 0, max_arg1_71215);\n            cond_71217 = slt64((int64_t) 0, max_res_71216);\n            if (cond_71217) {\n                int64_t tmp_71219;\n                bool x_71220;\n                bool y_71221;\n                bool bounds_check_71222;\n                bool index_certs_71223;\n                int64_t slice_71224;\n                int32_t b_prev_t_res_71225;\n                \n                tmp_71219 = sub64(max_res_71216, (int64_t) 1);\n                x_71220 = sle64((int64_t) 0, tmp_71219);\n                y_71221 = slt64(tmp_71219, nR_44377);\n                bounds_check_71222 = x_71220 && y_71221;\n                if (!bounds_check_71222) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 76) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_71219;\n                       ", "     global_failure_args[1] = (int64_t) nR_44377;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_71224 = tS_start_66998 + tmp_71219;\n                b_prev_t_res_71225 = ((__global int32_t *) tS_mem_77626)[slice_71224];\n                b_prev_71218 = b_prev_t_res_71225;\n            } else {\n                b_prev_71218 = lowest_77569;\n            }\n            cond_71226 = sle64(ai_71214, (int64_t) 0);\n            if (cond_71226) {\n                loopres_71227 = p_71209;\n                loopres_71228 = (int64_t) 0;\n                loopres_71229 = max_res_71216;\n                loopres_71230 = 0;\n            } else {\n                bool cond_71231;\n                int64_t loopres_f_res_71232;\n                int64_t loopres_f_res_71233;\n                int64_t loopres_f_res_71234;\n                bool loopres_f_res_71235;\n                \n                cond_71231 = sle64(nR_44377, max_res_71216);\n                if (cond_71231) {\n                    int64_t min_arg1_71236;\n                    int64_t min_res_71237;\n                    bool x_71238;\n                    bool y_71239;\n                    bool bounds_check_71240;\n                    bool index_certs_71241;\n                    bool x_71244;\n                    bool y_71245;\n                    bool bounds_check_71246;\n                    bool index_certs_71247;\n                    int64_t slice_71242;\n                    int32_t leq_lhs_71243;\n                    int32_t leq_rhs_71248;\n                    bool defunc_0_leq_res_71249;\n                    int64_t loopres_f_res_t_res_71250;\n                    bool x_71251;\n                    int64_t loopres_f_res_t_res_71252;\n                    \n                    min_arg1_71236 = sub64(nR_44377, (int64_t) 1);\n                    min_res_71237 = smin64(ai_71214, min_arg1_71236);\n                    x_71238 = sle64((int64_t) 0, min_arg1_71236);\n     ", "               y_71239 = slt64(min_arg1_71236, nR_44377);\n                    bounds_check_71240 = x_71238 && y_71239;\n                    if (!bounds_check_71240) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 77) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_71236;\n                                global_failure_args[1] = (int64_t) nR_44377;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_71244 = sle64((int64_t) 0, min_res_71237);\n                    y_71245 = slt64(min_res_71237, nR_44377);\n                    bounds_check_71246 = x_71244 && y_71245;\n                    if (!bounds_check_71246) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 78) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_71237;\n                                global_failure_args[1] = (int64_t) nR_44377;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_71242 = tS_start_66998 + min_arg1_71236;\n                    leq_lhs_71243 = ((__global int32_t *) tS_mem_77626)[slice_71242];\n                    leq_rhs_71248 = ((__global int32_t *) tR_mem_77625)[min_res_71237];\n                    defunc_0_leq_res_71249 = sle32(leq_lhs_71243, leq_rhs_71248);\n                    if (defunc_0_leq_res_71249) {\n                        loopres_f_res_t_res_71250 = ai_71214;\n                    } else {\n                        loopres_f_res_t_res_71250 = p_71210;\n                    }\n                    x_71251 = !defunc_0_leq_res_71249;\n                    if (defunc_0_leq_res_71249) {\n                        loopres_f_res_t_res_71252 = nR_44377;\n                    } else {\n       ",
                                    "                 int64_t tmp_71253 = sub64(min_arg1_71236, offset_71213);\n                        \n                        loopres_f_res_t_res_71252 = tmp_71253;\n                    }\n                    loopres_f_res_71232 = p_71209;\n                    loopres_f_res_71233 = loopres_f_res_t_res_71250;\n                    loopres_f_res_71234 = loopres_f_res_t_res_71252;\n                    loopres_f_res_71235 = x_71251;\n                } else {\n                    bool cond_71254;\n                    int64_t loopres_f_res_f_res_71255;\n                    int64_t loopres_f_res_f_res_71256;\n                    int64_t loopres_f_res_f_res_71257;\n                    bool loopres_f_res_f_res_71258;\n                    \n                    cond_71254 = sle64(nR_44377, ai_71214);\n                    if (cond_71254) {\n                        int64_t min_arg1_71259;\n                        int64_t min_res_71260;\n                        bool x_71261;\n                        bool y_71262;\n                        bool bounds_check_71263;\n                        bool index_certs_71264;\n                        bool x_71266;\n                        bool y_71267;\n                        bool bounds_check_71268;\n                        bool index_certs_71269;\n                        int32_t leq_lhs_71265;\n                        int64_t slice_71270;\n                        int32_t leq_rhs_71271;\n                        bool defunc_0_leq_res_71272;\n                        int64_t loopres_f_res_f_res_t_res_71273;\n                        bool x_71274;\n                        int64_t loopres_f_res_f_res_t_res_71275;\n                        \n                        min_arg1_71259 = sub64(nR_44377, (int64_t) 1);\n                        min_res_71260 = smin64(max_res_71216, min_arg1_71259);\n                        x_71261 = sle64((int64_t) 0, min_arg1_71259);\n                        y_71262 = slt64(min_arg1_71259, nR_44377);\n                        bounds_check_71263 = x_71261 && y_71262;\n", "                        if (!bounds_check_71263) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 79) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_71259;\n                                    global_failure_args[1] = (int64_t) nR_44377;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_71266 = sle64((int64_t) 0, min_res_71260);\n                        y_71267 = slt64(min_res_71260, nR_44377);\n                        bounds_check_71268 = x_71266 && y_71267;\n                        if (!bounds_check_71268) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 80) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_71260;\n                                    global_failure_args[1] = (int64_t) nR_44377;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_71265 = ((__global int32_t *) tR_mem_77625)[min_arg1_71259];\n                        slice_71270 = tS_start_66998 + min_res_71260;\n                        leq_rhs_71271 = ((__global int32_t *) tS_mem_77626)[slice_71270];\n                        defunc_0_leq_res_71272 = sle32(leq_lhs_71265, leq_rhs_71271);\n                        if (defunc_0_leq_res_71272) {\n                            loopres_f_res_f_res_t_res_71273 = max_res_71216;\n                        } else {\n                            loopres_f_res_f_res_t_res_71273 = p_71211;\n                        }\n                        x_71274 = !defunc_0_leq_res_71272;\n                        if (defunc_0_leq_res_71272) {\n                            loopres_f_res_f_res_t_res_71275 = nR", "_44377;\n                        } else {\n                            loopres_f_res_f_res_t_res_71275 = min_arg1_71259;\n                        }\n                        loopres_f_res_f_res_71255 = p_71209;\n                        loopres_f_res_f_res_71256 = loopres_f_res_f_res_t_res_71275;\n                        loopres_f_res_f_res_71257 = loopres_f_res_f_res_t_res_71273;\n                        loopres_f_res_f_res_71258 = x_71274;\n                    } else {\n                        bool cond_71276;\n                        int64_t loopres_f_res_f_res_f_res_71277;\n                        int64_t loopres_f_res_f_res_f_res_71278;\n                        int64_t loopres_f_res_f_res_f_res_71279;\n                        bool loopres_f_res_f_res_f_res_71280;\n                        \n                        cond_71276 = sle64(p_71210, p_71209);\n                        if (cond_71276) {\n                            bool cond_71281;\n                            int64_t ai_71282;\n                            bool x_71295;\n                            bool y_71296;\n                            bool bounds_check_71297;\n                            bool index_certs_71298;\n                            int32_t b_prev_71284;\n                            int32_t gt_lhs_71299;\n                            bool defunc_0_gt_res_71300;\n                            int64_t defunc_0_partFunc_sequential_search_res_71301;\n                            int64_t defunc_0_partFunc_sequential_search_res_71302;\n                            \n                            cond_71281 = slt64(ai_71214, nR_44377);\n                            if (cond_71281) {\n                                ai_71282 = ai_71214;\n                            } else {\n                                int64_t ai_f_res_71283 = sub64(nR_44377, (int64_t) 1);\n                                \n                                ai_71282 = ai_f_res_71283;\n                            }\n                            x_71295 = sle64((int64_t) 0, ai_712",
                                    "82);\n                            y_71296 = slt64(ai_71282, nR_44377);\n                            bounds_check_71297 = x_71295 && y_71296;\n                            if (!bounds_check_71297) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 81) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_71282;\n                                        global_failure_args[1] = (int64_t) nR_44377;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_71217) {\n                                int64_t tmp_71285;\n                                bool x_71286;\n                                bool y_71287;\n                                bool bounds_check_71288;\n                                bool index_certs_71289;\n                                int64_t slice_71290;\n                                int32_t b_prev_t_res_71291;\n                                \n                                tmp_71285 = sub64(max_res_71216, (int64_t) 1);\n                                x_71286 = sle64((int64_t) 0, tmp_71285);\n                                y_71287 = slt64(tmp_71285, nR_44377);\n                                bounds_check_71288 = x_71286 && y_71287;\n                                if (!bounds_check_71288) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 82) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_71285;\n                                            global_failure_args[1] = (int64_t) nR_44377;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                   ", "             }\n                                slice_71290 = tS_start_66998 + tmp_71285;\n                                b_prev_t_res_71291 = ((__global int32_t *) tS_mem_77626)[slice_71290];\n                                b_prev_71284 = b_prev_t_res_71291;\n                            } else {\n                                bool y_71292;\n                                bool index_certs_71293;\n                                int32_t b_prev_f_res_71294;\n                                \n                                y_71292 = slt64((int64_t) 0, nR_44377);\n                                if (!y_71292) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 83) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_44377;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_71294 = ((__global int32_t *) tS_mem_77626)[tS_start_66998];\n                                b_prev_71284 = b_prev_f_res_71294;\n                            }\n                            gt_lhs_71299 = ((__global int32_t *) tR_mem_77625)[ai_71282];\n                            defunc_0_gt_res_71300 = slt32(b_prev_71284, gt_lhs_71299);\n                            if (defunc_0_gt_res_71300) {\n                                int64_t zl_rhs_71303;\n                                bool loop_cond_71304;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_71305;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_71306;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_71307;\n                                int64_", "t defunc_0_partFunc_sequential_search_res_t_res_71308;\n                                bool loop_while_71309;\n                                int64_t p_71310;\n                                int64_t p_71311;\n                                int64_t p_71312;\n                                \n                                zl_rhs_71303 = sub64(nR_44377, max_res_71216);\n                                loop_cond_71304 = slt64((int64_t) 0, zl_rhs_71303);\n                                loop_while_71309 = loop_cond_71304;\n                                p_71310 = ai_71282;\n                                p_71311 = max_res_71216;\n                                p_71312 = (int64_t) 0;\n                                while (loop_while_71309) {\n                                    int64_t i_a_71313;\n                                    int64_t i_b_71314;\n                                    int64_t leq_lhs_71315;\n                                    bool x_71316;\n                                    bool y_71317;\n                                    bool bounds_check_71318;\n                                    bool index_certs_71319;\n                                    bool x_71321;\n                                    bool y_71322;\n                                    bool bounds_check_71323;\n                                    bool index_certs_71324;\n                                    int32_t leq_lhs_71320;\n                                    int64_t slice_71325;\n                                    int32_t leq_rhs_71326;\n                                    bool defunc_0_leq_res_71327;\n                                    int64_t loopres_71328;\n                                    int64_t loopres_71329;\n                                    int64_t loopres_71330;\n                                    bool loop_cond_71332;\n                                    bool loop_while_tmp_78884;\n                                    int64_t p_tmp_78885;\n                                    int64_t p_tmp_",
                                    "78886;\n                                    int64_t p_tmp_78887;\n                                    \n                                    i_a_71313 = sub64(ai_71282, p_71312);\n                                    i_b_71314 = add64(max_res_71216, p_71312);\n                                    leq_lhs_71315 = sub64(i_a_71313, (int64_t) 1);\n                                    x_71316 = sle64((int64_t) 0, leq_lhs_71315);\n                                    y_71317 = slt64(leq_lhs_71315, nR_44377);\n                                    bounds_check_71318 = x_71316 && y_71317;\n                                    if (!bounds_check_71318) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 84) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_71315;\n                                                global_failure_args[1] = (int64_t) nR_44377;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_71321 = sle64((int64_t) 0, i_b_71314);\n                                    y_71322 = slt64(i_b_71314, nR_44377);\n                                    bounds_check_71323 = x_71321 && y_71322;\n                                    if (!bounds_check_71323) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 85) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_71314;\n                                                global_failure_args[1] = (int64_t) nR_44377;\n                                                ;\n                                            }\n                                            return;\n                     ", "                   }\n                                    }\n                                    leq_lhs_71320 = ((__global int32_t *) tR_mem_77625)[leq_lhs_71315];\n                                    slice_71325 = tS_start_66998 + i_b_71314;\n                                    leq_rhs_71326 = ((__global int32_t *) tS_mem_77626)[slice_71325];\n                                    defunc_0_leq_res_71327 = sle32(leq_lhs_71320, leq_rhs_71326);\n                                    if (defunc_0_leq_res_71327) {\n                                        loopres_71328 = i_a_71313;\n                                    } else {\n                                        loopres_71328 = ai_71282;\n                                    }\n                                    if (defunc_0_leq_res_71327) {\n                                        loopres_71329 = i_b_71314;\n                                    } else {\n                                        loopres_71329 = max_res_71216;\n                                    }\n                                    if (defunc_0_leq_res_71327) {\n                                        loopres_71330 = zl_rhs_71303;\n                                    } else {\n                                        int64_t tmp_71331 = add64((int64_t) 1, p_71312);\n                                        \n                                        loopres_71330 = tmp_71331;\n                                    }\n                                    loop_cond_71332 = slt64(loopres_71330, zl_rhs_71303);\n                                    loop_while_tmp_78884 = loop_cond_71332;\n                                    p_tmp_78885 = loopres_71328;\n                                    p_tmp_78886 = loopres_71329;\n                                    p_tmp_78887 = loopres_71330;\n                                    loop_while_71309 = loop_while_tmp_78884;\n                                    p_71310 = p_tmp_78885;\n                                    p_71311 = p_tmp_78886;\n                  ", "                  p_71312 = p_tmp_78887;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_71305 = loop_while_71309;\n                                defunc_0_partFunc_sequential_search_res_t_res_71306 = p_71310;\n                                defunc_0_partFunc_sequential_search_res_t_res_71307 = p_71311;\n                                defunc_0_partFunc_sequential_search_res_t_res_71308 = p_71312;\n                                defunc_0_partFunc_sequential_search_res_71301 = defunc_0_partFunc_sequential_search_res_t_res_71306;\n                                defunc_0_partFunc_sequential_search_res_71302 = defunc_0_partFunc_sequential_search_res_t_res_71307;\n                            } else {\n                                int64_t zl_rhs_71333;\n                                bool loop_cond_71334;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_71335;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71336;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71337;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71338;\n                                bool loop_while_71339;\n                                int64_t p_71340;\n                                int64_t p_71341;\n                                int64_t p_71342;\n                                \n                                zl_rhs_71333 = sub64(max_res_71216, (int64_t) 1);\n                                loop_cond_71334 = slt64((int64_t) 0, zl_rhs_71333);\n                                loop_while_71339 = loop_cond_71334;\n                                p_71340 = ai_71282;\n                                p_71341 = max_res_71216;\n                                p_71342 = (int64_t) 0;\n                                while (loop_while_71339) {\n                                    int64_t zp_lhs_71343;\n      ",
                                    "                              int64_t hi_a_71344;\n                                    bool cond_71345;\n                                    int64_t i_a_71346;\n                                    int64_t zm_lhs_71348;\n                                    int64_t i_b_71349;\n                                    bool x_71350;\n                                    bool y_71351;\n                                    bool bounds_check_71352;\n                                    bool index_certs_71353;\n                                    bool x_71355;\n                                    bool y_71356;\n                                    bool bounds_check_71357;\n                                    bool index_certs_71358;\n                                    int32_t gt_lhs_71354;\n                                    int64_t slice_71359;\n                                    int32_t gt_rhs_71360;\n                                    bool defunc_0_gt_res_71361;\n                                    int64_t loopres_71362;\n                                    int64_t loopres_71363;\n                                    int64_t loopres_71364;\n                                    bool loop_cond_71366;\n                                    bool loop_while_tmp_78888;\n                                    int64_t p_tmp_78889;\n                                    int64_t p_tmp_78890;\n                                    int64_t p_tmp_78891;\n                                    \n                                    zp_lhs_71343 = add64(ai_71282, p_71342);\n                                    hi_a_71344 = add64((int64_t) 1, zp_lhs_71343);\n                                    cond_71345 = slt64(hi_a_71344, nR_44377);\n                                    if (cond_71345) {\n                                        i_a_71346 = hi_a_71344;\n                                    } else {\n                                        int64_t i_a_f_res_71347 = sub64(nR_44377, (int64_t) 1);\n                                        \n      ", "                                  i_a_71346 = i_a_f_res_71347;\n                                    }\n                                    zm_lhs_71348 = sub64(max_res_71216, p_71342);\n                                    i_b_71349 = sub64(zm_lhs_71348, (int64_t) 1);\n                                    x_71350 = sle64((int64_t) 0, i_a_71346);\n                                    y_71351 = slt64(i_a_71346, nR_44377);\n                                    bounds_check_71352 = x_71350 && y_71351;\n                                    if (!bounds_check_71352) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 86) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_71346;\n                                                global_failure_args[1] = (int64_t) nR_44377;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_71355 = sle64((int64_t) 0, i_b_71349);\n                                    y_71356 = slt64(i_b_71349, nR_44377);\n                                    bounds_check_71357 = x_71355 && y_71356;\n                                    if (!bounds_check_71357) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 87) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_71349;\n                                                global_failure_args[1] = (int64_t) nR_44377;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                         ", "           gt_lhs_71354 = ((__global int32_t *) tR_mem_77625)[i_a_71346];\n                                    slice_71359 = tS_start_66998 + i_b_71349;\n                                    gt_rhs_71360 = ((__global int32_t *) tS_mem_77626)[slice_71359];\n                                    defunc_0_gt_res_71361 = slt32(gt_rhs_71360, gt_lhs_71354);\n                                    if (defunc_0_gt_res_71361) {\n                                        loopres_71362 = i_a_71346;\n                                    } else {\n                                        loopres_71362 = ai_71282;\n                                    }\n                                    if (defunc_0_gt_res_71361) {\n                                        loopres_71363 = zm_lhs_71348;\n                                    } else {\n                                        loopres_71363 = max_res_71216;\n                                    }\n                                    if (defunc_0_gt_res_71361) {\n                                        loopres_71364 = zl_rhs_71333;\n                                    } else {\n                                        int64_t tmp_71365 = add64((int64_t) 1, p_71342);\n                                        \n                                        loopres_71364 = tmp_71365;\n                                    }\n                                    loop_cond_71366 = slt64(loopres_71364, zl_rhs_71333);\n                                    loop_while_tmp_78888 = loop_cond_71366;\n                                    p_tmp_78889 = loopres_71362;\n                                    p_tmp_78890 = loopres_71363;\n                                    p_tmp_78891 = loopres_71364;\n                                    loop_while_71339 = loop_while_tmp_78888;\n                                    p_71340 = p_tmp_78889;\n                                    p_71341 = p_tmp_78890;\n                                    p_71342 = p_tmp_78891;\n                                }\n                  ",
                                    "              defunc_0_partFunc_sequential_search_res_f_res_71335 = loop_while_71339;\n                                defunc_0_partFunc_sequential_search_res_f_res_71336 = p_71340;\n                                defunc_0_partFunc_sequential_search_res_f_res_71337 = p_71341;\n                                defunc_0_partFunc_sequential_search_res_f_res_71338 = p_71342;\n                                defunc_0_partFunc_sequential_search_res_71301 = defunc_0_partFunc_sequential_search_res_f_res_71336;\n                                defunc_0_partFunc_sequential_search_res_71302 = defunc_0_partFunc_sequential_search_res_f_res_71337;\n                            }\n                            loopres_f_res_f_res_f_res_71277 = p_71209;\n                            loopres_f_res_f_res_f_res_71278 = defunc_0_partFunc_sequential_search_res_71301;\n                            loopres_f_res_f_res_f_res_71279 = defunc_0_partFunc_sequential_search_res_71302;\n                            loopres_f_res_f_res_f_res_71280 = 0;\n                        } else {\n                            bool x_71367;\n                            bool y_71368;\n                            bool bounds_check_71369;\n                            bool index_certs_71370;\n                            int32_t gt_lhs_71371;\n                            bool defunc_0_gt_res_71372;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71373;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71374;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71375;\n                            bool loopres_f_res_f_res_f_res_f_res_71376;\n                            \n                            x_71367 = sle64((int64_t) 0, ai_71214);\n                            y_71368 = slt64(ai_71214, nR_44377);\n                            bounds_check_71369 = x_71367 && y_71368;\n                            if (!bounds_check_71369) {\n                                {\n                                  ", "  if (atomic_cmpxchg_i32_global(global_failure, -1, 88) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_71214;\n                                        global_failure_args[1] = (int64_t) nR_44377;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_71371 = ((__global int32_t *) tR_mem_77625)[ai_71214];\n                            defunc_0_gt_res_71372 = slt32(b_prev_71218, gt_lhs_71371);\n                            if (defunc_0_gt_res_71372) {\n                                int64_t leq_lhs_71377;\n                                bool x_71378;\n                                bool y_71379;\n                                bool bounds_check_71380;\n                                bool index_certs_71381;\n                                bool x_71383;\n                                bool y_71384;\n                                bool bounds_check_71385;\n                                bool index_certs_71386;\n                                int32_t leq_lhs_71382;\n                                int64_t slice_71387;\n                                int32_t leq_rhs_71388;\n                                bool defunc_0_leq_res_71389;\n                                bool x_71390;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_71391;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_71392;\n                                \n                                leq_lhs_71377 = sub64(ai_71214, (int64_t) 1);\n                                x_71378 = sle64((int64_t) 0, leq_lhs_71377);\n                                y_71379 = slt64(leq_lhs_71377, nR_44377);\n                                bounds_check_71380 = x_71378 && y_71379;\n                                if (!bounds_check_71380) {\n                                    {\n      ", "                                  if (atomic_cmpxchg_i32_global(global_failure, -1, 89) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_71377;\n                                            global_failure_args[1] = (int64_t) nR_44377;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_71383 = sle64((int64_t) 0, max_res_71216);\n                                y_71384 = slt64(max_res_71216, nR_44377);\n                                bounds_check_71385 = x_71383 && y_71384;\n                                if (!bounds_check_71385) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 90) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_71216;\n                                            global_failure_args[1] = (int64_t) nR_44377;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_71382 = ((__global int32_t *) tR_mem_77625)[leq_lhs_71377];\n                                slice_71387 = tS_start_66998 + max_res_71216;\n                                leq_rhs_71388 = ((__global int32_t *) tS_mem_77626)[slice_71387];\n                                defunc_0_leq_res_71389 = sle32(leq_lhs_71382, leq_rhs_71388);\n                                x_71390 = !defunc_0_leq_res_71389;\n                                if (defunc_0_leq_res_71389) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_71391 = ai_71214;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_r",
                                    "es_t_res_71391 = leq_lhs_71377;\n                                }\n                                if (defunc_0_leq_res_71389) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_71392 = max_res_71216;\n                                } else {\n                                    int64_t tmp_71393 = add64((int64_t) 1, max_res_71216);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_71392 = tmp_71393;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_71373 = p_71209;\n                                loopres_f_res_f_res_f_res_f_res_71374 = loopres_f_res_f_res_f_res_f_res_t_res_71391;\n                                loopres_f_res_f_res_f_res_f_res_71375 = loopres_f_res_f_res_f_res_f_res_t_res_71392;\n                                loopres_f_res_f_res_f_res_f_res_71376 = x_71390;\n                            } else {\n                                int64_t tmp_71394 = add64((int64_t) 1, ai_71214);\n                                \n                                loopres_f_res_f_res_f_res_f_res_71373 = tmp_71394;\n                                loopres_f_res_f_res_f_res_f_res_71374 = p_71210;\n                                loopres_f_res_f_res_f_res_f_res_71375 = p_71211;\n                                loopres_f_res_f_res_f_res_f_res_71376 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_71277 = loopres_f_res_f_res_f_res_f_res_71373;\n                            loopres_f_res_f_res_f_res_71278 = loopres_f_res_f_res_f_res_f_res_71374;\n                            loopres_f_res_f_res_f_res_71279 = loopres_f_res_f_res_f_res_f_res_71375;\n                            loopres_f_res_f_res_f_res_71280 = loopres_f_res_f_res_f_res_f_res_71376;\n                        }\n                        loopres_f_res_f_res_71255 = loopres_f_res_f_res_f_res_71277;\n                        loopres_f_res_f_res_71256 = loopres_f_res_", "f_res_f_res_71278;\n                        loopres_f_res_f_res_71257 = loopres_f_res_f_res_f_res_71279;\n                        loopres_f_res_f_res_71258 = loopres_f_res_f_res_f_res_71280;\n                    }\n                    loopres_f_res_71232 = loopres_f_res_f_res_71255;\n                    loopres_f_res_71233 = loopres_f_res_f_res_71256;\n                    loopres_f_res_71234 = loopres_f_res_f_res_71257;\n                    loopres_f_res_71235 = loopres_f_res_f_res_71258;\n                }\n                loopres_71227 = loopres_f_res_71232;\n                loopres_71228 = loopres_f_res_71233;\n                loopres_71229 = loopres_f_res_71234;\n                loopres_71230 = loopres_f_res_71235;\n            }\n            loop_while_tmp_78880 = loopres_71230;\n            p_tmp_78881 = loopres_71227;\n            p_tmp_78882 = loopres_71228;\n            p_tmp_78883 = loopres_71229;\n            loop_while_71208 = loop_while_tmp_78880;\n            p_71209 = p_tmp_78881;\n            p_71210 = p_tmp_78882;\n            p_71211 = p_tmp_78883;\n        }\n        defunc_0_f_res_71204 = loop_while_71208;\n        defunc_0_f_res_71205 = p_71209;\n        defunc_0_f_res_71206 = p_71210;\n        defunc_0_f_res_71207 = p_71211;\n        ((__global int64_t *) mem_77662)[gtid_71192] = defunc_0_f_res_71206;\n        ((__global int64_t *) mem_77664)[gtid_71192] = defunc_0_f_res_71207;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71188\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71567_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71567(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_44377, int64_t gt_rhs_66981, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t zeze_rhs_67414, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77644, __global unsigned char *mem_77646, __global unsigned char *mem_7768", "0, __global unsigned char *mem_77682)\n{\n    #define segmap_tblock_sizze_71562 (inner_SMJ_intzisegmap_71567zisegmap_tblock_sizze_71562)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78896;\n    int32_t tblock_sizze_78899;\n    int32_t wave_sizze_78898;\n    int32_t block_id_78897;\n    int32_t global_tid_78895;\n    int64_t phys_tid_71567;\n    int64_t global_tid_78900;\n    int64_t slice_78901;\n    int64_t gtid_71566;\n    int64_t remnant_78902;\n    \n    local_tid_78896 = get_local_id(0);\n    tblock_sizze_78899 = get_local_size(0);\n    wave_sizze_78898 = LOCKSTEP_WIDTH;\n    block_id_78897 = get_tblock_id(0);\n    global_tid_78895 = block_id_78897 * tblock_sizze_78899 + local_tid_78896;\n    phys_tid_71567 = sext_i32_i64(global_tid_78895);\n    global_tid_78900 = sext_i32_i64(block_id_78897) * segmap_tblock_sizze_71562 + sext_i32_i64(local_tid_78896);\n    slice_78901 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n    gtid_71566 = global_tid_78900;\n    remnant_78902 = global_tid_78900 - gtid_71566;\n    if (slt64(gtid_71566, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140)) {\n        int64_t eta_p_71569;\n        int64_t min_res_71570;\n        bool x_71571;\n        bool y_71572;\n        bool bounds_check_71573;\n        bool index_certs_71574;\n        bool cond_71576;\n        int64_t ri_next_71577;\n        int64_t max_arg1_71584;\n        int64_t max_res_71585;\n        bool x_71586;\n        bool y_71587;\n        bool bounds_check_71588;\n        bool index_certs_71589;\n        int32_t r_min_71575;\n        int32_t r_max_71590;\n        bool defunc_0_f_res_71591;\n        int64_t defunc_0_f_res_71592;\n        bool loop_while_71593;\n        int64_t fm_71594;\n        bool defunc_0_f_res_71660;\n        int64_t defunc_0_f_res_71661;\n        bool loop_while_71662;\n        int64_t lm_71663;\n        \n        eta_p_71569 = ((__global int64_t *) mem_77644)[gtid_71566];\n        min_res_71570 = smin64(gt_rhs_66981, eta_p_71569);",
                                    "\n        x_71571 = sle64((int64_t) 0, min_res_71570);\n        y_71572 = slt64(min_res_71570, nR_44377);\n        bounds_check_71573 = x_71571 && y_71572;\n        if (!bounds_check_71573) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 91) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_71570;\n                    global_failure_args[1] = (int64_t) nR_44377;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_71576 = gtid_71566 == zeze_rhs_67414;\n        if (cond_71576) {\n            ri_next_71577 = nR_44377;\n        } else {\n            int64_t tmp_71578;\n            bool x_71579;\n            bool y_71580;\n            bool bounds_check_71581;\n            bool index_certs_71582;\n            int64_t ri_next_f_res_71583;\n            \n            tmp_71578 = add64((int64_t) 1, gtid_71566);\n            x_71579 = sle64((int64_t) 0, tmp_71578);\n            y_71580 = slt64(tmp_71578, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_71581 = x_71579 && y_71580;\n            if (!bounds_check_71581) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 92) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_71578;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_71583 = ((__global int64_t *) mem_77644)[tmp_71578];\n            ri_next_71577 = ri_next_f_res_71583;\n        }\n        max_arg1_71584 = sub64(ri_next_71577, (int64_t) 1);\n        max_res_71585 = smax64((int64_t) 0, max_arg1_71584);\n        x_71586 = sle64((int64_t) 0, max_res_71585);\n        y_71587 = slt64(max_res_71585, nR_44377);\n        bounds_check_71588 = x_71586 && y_71587;\n        if (!bounds_check_", "71588) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 93) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_71585;\n                    global_failure_args[1] = (int64_t) nR_44377;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_71575 = ((__global int32_t *) tR_mem_77625)[min_res_71570];\n        r_max_71590 = ((__global int32_t *) tR_mem_77625)[max_res_71585];\n        loop_while_71593 = 1;\n        fm_71594 = gtid_71566;\n        while (loop_while_71593) {\n            bool x_71595;\n            bool y_71596;\n            bool bounds_check_71597;\n            bool index_certs_71598;\n            int64_t loopres_71599;\n            int64_t min_res_71600;\n            bool x_71601;\n            bool y_71602;\n            bool bounds_check_71603;\n            bool index_certs_71604;\n            bool cond_71607;\n            int64_t si_next_71608;\n            int64_t max_arg1_71615;\n            int64_t max_res_71616;\n            bool x_71617;\n            bool y_71618;\n            bool bounds_check_71619;\n            bool index_certs_71620;\n            int64_t min_res_71623;\n            bool x_71624;\n            bool y_71625;\n            bool bounds_check_71626;\n            bool index_certs_71627;\n            int64_t max_arg1_71630;\n            int64_t max_res_71631;\n            bool x_71632;\n            bool y_71633;\n            bool bounds_check_71634;\n            bool index_certs_71635;\n            int64_t slice_71605;\n            int32_t s_min_71606;\n            int64_t slice_71621;\n            int64_t slice_71628;\n            int64_t slice_71636;\n            bool defunc_0_gt_res_71638;\n            bool loopres_71639;\n            int64_t loopres_71640;\n            bool loop_while_tmp_78903;\n            int64_t fm_tmp_78904;\n            \n            x_71595 = sle64((int64_t) 0, fm_71594);\n            y_71596 = slt64(fm_71594, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberO", "fWindowsz7dUzg_67140);\n            bounds_check_71597 = x_71595 && y_71596;\n            if (!bounds_check_71597) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 94) == -1) {\n                        global_failure_args[0] = (int64_t) fm_71594;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_71599 = ((__global int64_t *) mem_77646)[fm_71594];\n            min_res_71600 = smin64(gt_rhs_66981, loopres_71599);\n            x_71601 = sle64((int64_t) 0, min_res_71600);\n            y_71602 = slt64(min_res_71600, nR_44377);\n            bounds_check_71603 = x_71601 && y_71602;\n            if (!bounds_check_71603) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 95) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_71600;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_71607 = sle64(zeze_rhs_67414, fm_71594);\n            if (cond_71607) {\n                si_next_71608 = nR_44377;\n            } else {\n                int64_t tmp_71609;\n                bool x_71610;\n                bool y_71611;\n                bool bounds_check_71612;\n                bool index_certs_71613;\n                int64_t si_next_f_res_71614;\n                \n                tmp_71609 = add64((int64_t) 1, fm_71594);\n                x_71610 = sle64((int64_t) 0, tmp_71609);\n                y_71611 = slt64(tmp_71609, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_71612 = x_71610 && y_71611;\n                if (!bounds_check_71612) {\n                    {\n                        if (atomic_cmpxchg_i32_g",
                                    "lobal(global_failure, -1, 96) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_71609;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_71614 = ((__global int64_t *) mem_77646)[tmp_71609];\n                si_next_71608 = si_next_f_res_71614;\n            }\n            max_arg1_71615 = sub64(si_next_71608, (int64_t) 1);\n            max_res_71616 = smax64(min_res_71600, max_arg1_71615);\n            x_71617 = sle64((int64_t) 0, max_res_71616);\n            y_71618 = slt64(max_res_71616, nR_44377);\n            bounds_check_71619 = x_71617 && y_71618;\n            if (!bounds_check_71619) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 97) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_71616;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_71623 = smin64(zeze_rhs_67414, si_next_71608);\n            x_71624 = sle64((int64_t) 0, min_res_71623);\n            y_71625 = slt64(min_res_71623, nR_44377);\n            bounds_check_71626 = x_71624 && y_71625;\n            if (!bounds_check_71626) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 98) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_71623;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_71630 = sub64(min_res_71600, (int64_t) 1);\n            max_res_71631 = smax64((int64_t) 0, max_arg1_71630);\n            x_71632 = sle64((int64_t) 0,", " max_res_71631);\n            y_71633 = slt64(max_res_71631, nR_44377);\n            bounds_check_71634 = x_71632 && y_71633;\n            if (!bounds_check_71634) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 99) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_71631;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_71605 = tS_start_66998 + min_res_71600;\n            s_min_71606 = ((__global int32_t *) tS_mem_77626)[slice_71605];\n            slice_71621 = tS_start_66998 + max_res_71616;\n            slice_71628 = tS_start_66998 + min_res_71623;\n            slice_71636 = tS_start_66998 + max_res_71631;\n            defunc_0_gt_res_71638 = slt32(s_min_71606, r_min_71575);\n            if (defunc_0_gt_res_71638) {\n                int32_t s_max_71622;\n                bool defunc_0_leq_res_71641;\n                bool loopres_t_res_71642;\n                int64_t loopres_t_res_71643;\n                \n                s_max_71622 = ((__global int32_t *) tS_mem_77626)[slice_71621];\n                defunc_0_leq_res_71641 = sle32(r_min_71575, s_max_71622);\n                if (defunc_0_leq_res_71641) {\n                    loopres_t_res_71642 = 0;\n                    loopres_t_res_71643 = fm_71594;\n                } else {\n                    int32_t s_nextMin_71629;\n                    bool defunc_0_leq_res_71644;\n                    int64_t zgze_lhs_71645;\n                    bool tmp_f_res_71646;\n                    bool x_71647;\n                    bool y_71648;\n                    bool tmp_71649;\n                    bool loopres_t_res_f_res_71650;\n                    \n                    s_nextMin_71629 = ((__global int32_t *) tS_mem_77626)[slice_71628];\n                    defunc_0_leq_res_71644 = sle32(r_min_71575, s_nextMin_71629);\n                    zgze_lhs_716", "45 = add64((int64_t) 1, fm_71594);\n                    tmp_f_res_71646 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zgze_lhs_71645);\n                    x_71647 = !defunc_0_leq_res_71644;\n                    y_71648 = tmp_f_res_71646 && x_71647;\n                    tmp_71649 = defunc_0_leq_res_71644 || y_71648;\n                    loopres_t_res_f_res_71650 = !tmp_71649;\n                    loopres_t_res_71642 = loopres_t_res_f_res_71650;\n                    loopres_t_res_71643 = zgze_lhs_71645;\n                }\n                loopres_71639 = loopres_t_res_71642;\n                loopres_71640 = loopres_t_res_71643;\n            } else {\n                int32_t s_prevMax_71637;\n                bool defunc_0_leq_res_71651;\n                int64_t zlze_lhs_71652;\n                bool tmp_f_res_71653;\n                bool x_71654;\n                bool y_71655;\n                bool tmp_71656;\n                int64_t max_res_71657;\n                bool loopres_f_res_71658;\n                \n                s_prevMax_71637 = ((__global int32_t *) tS_mem_77626)[slice_71636];\n                defunc_0_leq_res_71651 = sle32(s_prevMax_71637, r_min_71575);\n                zlze_lhs_71652 = sub64(fm_71594, (int64_t) 1);\n                tmp_f_res_71653 = sle64(zlze_lhs_71652, (int64_t) 0);\n                x_71654 = !defunc_0_leq_res_71651;\n                y_71655 = tmp_f_res_71653 && x_71654;\n                tmp_71656 = defunc_0_leq_res_71651 || y_71655;\n                max_res_71657 = smax64((int64_t) 0, zlze_lhs_71652);\n                loopres_f_res_71658 = !tmp_71656;\n                loopres_71639 = loopres_f_res_71658;\n                loopres_71640 = max_res_71657;\n            }\n            loop_while_tmp_78903 = loopres_71639;\n            fm_tmp_78904 = loopres_71640;\n            loop_while_71593 = loop_while_tmp_78903;\n            fm_71594 = fm_tmp_78904;\n        }\n        defunc_0_f_res_71591 = loop_while_71593;\n        defunc_0_f_res_71592 = f",
                                    "m_71594;\n        loop_while_71662 = 1;\n        lm_71663 = gtid_71566;\n        while (loop_while_71662) {\n            bool x_71664;\n            bool y_71665;\n            bool bounds_check_71666;\n            bool index_certs_71667;\n            int64_t loopres_71668;\n            int64_t min_res_71669;\n            bool x_71670;\n            bool y_71671;\n            bool bounds_check_71672;\n            bool index_certs_71673;\n            bool cond_71676;\n            int64_t si_next_71677;\n            int64_t max_arg1_71684;\n            int64_t max_res_71685;\n            bool x_71686;\n            bool y_71687;\n            bool bounds_check_71688;\n            bool index_certs_71689;\n            int64_t min_res_71692;\n            bool x_71693;\n            bool y_71694;\n            bool bounds_check_71695;\n            bool index_certs_71696;\n            int64_t max_arg1_71699;\n            int64_t max_res_71700;\n            bool x_71701;\n            bool y_71702;\n            bool bounds_check_71703;\n            bool index_certs_71704;\n            int64_t slice_71674;\n            int64_t slice_71690;\n            int32_t s_max_71691;\n            int64_t slice_71697;\n            int64_t slice_71705;\n            bool defunc_0_gt_res_71707;\n            bool loopres_71708;\n            int64_t loopres_71709;\n            bool loop_cond_t_res_71724;\n            bool x_71725;\n            bool loop_while_tmp_78905;\n            int64_t lm_tmp_78906;\n            \n            x_71664 = sle64((int64_t) 0, lm_71663);\n            y_71665 = slt64(lm_71663, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_71666 = x_71664 && y_71665;\n            if (!bounds_check_71666) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 100) == -1) {\n                        global_failure_args[0] = (int64_t) lm_71663;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindo", "wsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_71668 = ((__global int64_t *) mem_77646)[lm_71663];\n            min_res_71669 = smin64(gt_rhs_66981, loopres_71668);\n            x_71670 = sle64((int64_t) 0, min_res_71669);\n            y_71671 = slt64(min_res_71669, nR_44377);\n            bounds_check_71672 = x_71670 && y_71671;\n            if (!bounds_check_71672) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 101) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_71669;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_71676 = sle64(zeze_rhs_67414, lm_71663);\n            if (cond_71676) {\n                si_next_71677 = nR_44377;\n            } else {\n                int64_t tmp_71678;\n                bool x_71679;\n                bool y_71680;\n                bool bounds_check_71681;\n                bool index_certs_71682;\n                int64_t si_next_f_res_71683;\n                \n                tmp_71678 = add64((int64_t) 1, lm_71663);\n                x_71679 = sle64((int64_t) 0, tmp_71678);\n                y_71680 = slt64(tmp_71678, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_71681 = x_71679 && y_71680;\n                if (!bounds_check_71681) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 102) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_71678;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_nex", "t_f_res_71683 = ((__global int64_t *) mem_77646)[tmp_71678];\n                si_next_71677 = si_next_f_res_71683;\n            }\n            max_arg1_71684 = sub64(si_next_71677, (int64_t) 1);\n            max_res_71685 = smax64(min_res_71669, max_arg1_71684);\n            x_71686 = sle64((int64_t) 0, max_res_71685);\n            y_71687 = slt64(max_res_71685, nR_44377);\n            bounds_check_71688 = x_71686 && y_71687;\n            if (!bounds_check_71688) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 103) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_71685;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_71692 = smin64(zeze_rhs_67414, si_next_71677);\n            x_71693 = sle64((int64_t) 0, min_res_71692);\n            y_71694 = slt64(min_res_71692, nR_44377);\n            bounds_check_71695 = x_71693 && y_71694;\n            if (!bounds_check_71695) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 104) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_71692;\n                        global_failure_args[1] = (int64_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_71699 = sub64(min_res_71669, (int64_t) 1);\n            max_res_71700 = smax64((int64_t) 0, max_arg1_71699);\n            x_71701 = sle64((int64_t) 0, max_res_71700);\n            y_71702 = slt64(max_res_71700, nR_44377);\n            bounds_check_71703 = x_71701 && y_71702;\n            if (!bounds_check_71703) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 105) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_71700;\n                        global_failure_args[1] = (int6",
                                    "4_t) nR_44377;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_71674 = tS_start_66998 + min_res_71669;\n            slice_71690 = tS_start_66998 + max_res_71685;\n            s_max_71691 = ((__global int32_t *) tS_mem_77626)[slice_71690];\n            slice_71697 = tS_start_66998 + min_res_71692;\n            slice_71705 = tS_start_66998 + max_res_71700;\n            defunc_0_gt_res_71707 = slt32(r_max_71590, s_max_71691);\n            if (defunc_0_gt_res_71707) {\n                int32_t s_min_71675;\n                bool defunc_0_leq_res_71710;\n                bool loopres_t_res_71711;\n                int64_t loopres_t_res_71712;\n                \n                s_min_71675 = ((__global int32_t *) tS_mem_77626)[slice_71674];\n                defunc_0_leq_res_71710 = sle32(s_min_71675, r_max_71590);\n                if (defunc_0_leq_res_71710) {\n                    loopres_t_res_71711 = 0;\n                    loopres_t_res_71712 = lm_71663;\n                } else {\n                    int32_t s_prevMax_71706;\n                    bool defunc_0_leq_res_71713;\n                    int64_t zlze_lhs_71714;\n                    bool tmp_f_res_71715;\n                    bool x_71716;\n                    bool y_71717;\n                    bool tmp_71718;\n                    int64_t max_res_71719;\n                    bool loopres_t_res_f_res_71720;\n                    \n                    s_prevMax_71706 = ((__global int32_t *) tS_mem_77626)[slice_71705];\n                    defunc_0_leq_res_71713 = sle32(s_prevMax_71706, r_max_71590);\n                    zlze_lhs_71714 = sub64(lm_71663, (int64_t) 1);\n                    tmp_f_res_71715 = sle64(zlze_lhs_71714, (int64_t) 0);\n                    x_71716 = !defunc_0_leq_res_71713;\n                    y_71717 = tmp_f_res_71715 && x_71716;\n                    tmp_71718 = defunc_0_leq_res_71713 || y_71717;\n                    max_res_71719 = smax64((int64_t) 0, zlze", "_lhs_71714);\n                    loopres_t_res_f_res_71720 = !tmp_71718;\n                    loopres_t_res_71711 = loopres_t_res_f_res_71720;\n                    loopres_t_res_71712 = max_res_71719;\n                }\n                loopres_71708 = loopres_t_res_71711;\n                loopres_71709 = loopres_t_res_71712;\n            } else {\n                int32_t s_nextMin_71698;\n                bool defunc_0_leq_res_71721;\n                int64_t tmp_71722;\n                bool loopres_f_res_71723;\n                \n                s_nextMin_71698 = ((__global int32_t *) tS_mem_77626)[slice_71697];\n                defunc_0_leq_res_71721 = sle32(r_max_71590, s_nextMin_71698);\n                tmp_71722 = add64((int64_t) 1, lm_71663);\n                loopres_f_res_71723 = !defunc_0_leq_res_71721;\n                loopres_71708 = loopres_f_res_71723;\n                loopres_71709 = tmp_71722;\n            }\n            loop_cond_t_res_71724 = slt64(loopres_71709, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            x_71725 = loopres_71708 && loop_cond_t_res_71724;\n            loop_while_tmp_78905 = x_71725;\n            lm_tmp_78906 = loopres_71709;\n            loop_while_71662 = loop_while_tmp_78905;\n            lm_71663 = lm_tmp_78906;\n        }\n        defunc_0_f_res_71660 = loop_while_71662;\n        defunc_0_f_res_71661 = lm_71663;\n        ((__global int64_t *) mem_77680)[gtid_71566] = defunc_0_f_res_71592;\n        ((__global int64_t *) mem_77682)[gtid_71566] = defunc_0_f_res_71661;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71562\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71919_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71919(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77861, int64_t ext_77862, __global unsigned char *mem_param_77698, __global unsigned char *ext_mem_77865, __global unsigned char *mem_77869)\n{\n    #define segmap_tblock_sizze_71915 (inner_SMJ_intziseg", "map_71919zisegmap_tblock_sizze_71915)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79018;\n    int32_t tblock_sizze_79021;\n    int32_t wave_sizze_79020;\n    int32_t block_id_79019;\n    int32_t global_tid_79017;\n    int64_t phys_tid_71919;\n    int64_t global_tid_79022;\n    int64_t slice_79023;\n    int64_t gtid_71918;\n    int64_t remnant_79024;\n    \n    local_tid_79018 = get_local_id(0);\n    tblock_sizze_79021 = get_local_size(0);\n    wave_sizze_79020 = LOCKSTEP_WIDTH;\n    block_id_79019 = get_tblock_id(0);\n    global_tid_79017 = block_id_79019 * tblock_sizze_79021 + local_tid_79018;\n    phys_tid_71919 = sext_i32_i64(global_tid_79017);\n    global_tid_79022 = sext_i32_i64(block_id_79019) * segmap_tblock_sizze_71915 + sext_i32_i64(local_tid_79018);\n    slice_79023 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_71918 = global_tid_79022;\n    remnant_79024 = global_tid_79022 - gtid_71918;\n    if (slt64(gtid_71918, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_71920;\n        bool cond_71922;\n        int64_t lifted_lambda_res_71923;\n        \n        eta_p_71920 = ((__global int64_t *) mem_param_77698)[gtid_71918];\n        cond_71922 = slt64(eta_p_71920, (int64_t) 0);\n        if (cond_71922) {\n            int64_t eta_p_71921 = ((__global int64_t *) ext_mem_77865)[ext_77862 + gtid_71918 * ext_77861];\n            \n            lifted_lambda_res_71923 = eta_p_71921;\n        } else {\n            lifted_lambda_res_71923 = eta_p_71920;\n        }\n        ((__global int64_t *) mem_77869)[gtid_71918] = lifted_lambda_res_71923;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71915\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71940_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71940(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77863, int64_t ext_77864, __global unsigned char *mem_param_77695, __global unsigned char *ext_mem_77866, __global unsigned char *mem_77872",
                                    ")\n{\n    #define segmap_tblock_sizze_71936 (inner_SMJ_intzisegmap_71940zisegmap_tblock_sizze_71936)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79027;\n    int32_t tblock_sizze_79030;\n    int32_t wave_sizze_79029;\n    int32_t block_id_79028;\n    int32_t global_tid_79026;\n    int64_t phys_tid_71940;\n    int64_t global_tid_79031;\n    int64_t slice_79032;\n    int64_t gtid_71939;\n    int64_t remnant_79033;\n    \n    local_tid_79027 = get_local_id(0);\n    tblock_sizze_79030 = get_local_size(0);\n    wave_sizze_79029 = LOCKSTEP_WIDTH;\n    block_id_79028 = get_tblock_id(0);\n    global_tid_79026 = block_id_79028 * tblock_sizze_79030 + local_tid_79027;\n    phys_tid_71940 = sext_i32_i64(global_tid_79026);\n    global_tid_79031 = sext_i32_i64(block_id_79028) * segmap_tblock_sizze_71936 + sext_i32_i64(local_tid_79027);\n    slice_79032 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_71939 = global_tid_79031;\n    remnant_79033 = global_tid_79031 - gtid_71939;\n    if (slt64(gtid_71939, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_71941;\n        int64_t eta_p_71942;\n        int64_t defunc_0_f_res_71943;\n        \n        eta_p_71941 = ((__global int64_t *) mem_param_77695)[gtid_71939];\n        eta_p_71942 = ((__global int64_t *) ext_mem_77866)[ext_77864 + gtid_71939 * ext_77863];\n        defunc_0_f_res_71943 = add64(eta_p_71941, eta_p_71942);\n        ((__global int64_t *) mem_77872)[gtid_71939] = defunc_0_f_res_71943;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71936\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71961_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71961(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77686, int64_t ctx_param_ext_77687, __global unsigned char *mem_param_77688, __global unsigned char *ext_mem_77877, __global unsigned char *mem_77881)\n{\n    #define segmap_tblock_sizze_71957 (inner_SMJ_int", "zisegmap_71961zisegmap_tblock_sizze_71957)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79036;\n    int32_t tblock_sizze_79039;\n    int32_t wave_sizze_79038;\n    int32_t block_id_79037;\n    int32_t global_tid_79035;\n    int64_t phys_tid_71961;\n    int64_t global_tid_79040;\n    int64_t slice_79041;\n    int64_t gtid_71960;\n    int64_t remnant_79042;\n    \n    local_tid_79036 = get_local_id(0);\n    tblock_sizze_79039 = get_local_size(0);\n    wave_sizze_79038 = LOCKSTEP_WIDTH;\n    block_id_79037 = get_tblock_id(0);\n    global_tid_79035 = block_id_79037 * tblock_sizze_79039 + local_tid_79036;\n    phys_tid_71961 = sext_i32_i64(global_tid_79035);\n    global_tid_79040 = sext_i32_i64(block_id_79037) * segmap_tblock_sizze_71957 + sext_i32_i64(local_tid_79036);\n    slice_79041 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_71960 = global_tid_79040;\n    remnant_79042 = global_tid_79040 - gtid_71960;\n    if (slt64(gtid_71960, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76049;\n        int64_t eta_p_71962;\n        bool cond_71964;\n        int64_t lifted_lambda_res_71965;\n        \n        slice_76049 = loopres_f_res_f_res_67593 + gtid_71960;\n        eta_p_71962 = ((__global int64_t *) mem_param_77688)[ctx_param_ext_77686 + slice_76049 * ctx_param_ext_77687];\n        cond_71964 = slt64(eta_p_71962, (int64_t) 0);\n        if (cond_71964) {\n            int64_t eta_p_71963 = ((__global int64_t *) ext_mem_77877)[gtid_71960];\n            \n            lifted_lambda_res_71965 = eta_p_71963;\n        } else {\n            lifted_lambda_res_71965 = eta_p_71962;\n        }\n        ((__global int64_t *) mem_77881)[gtid_71960] = lifted_lambda_res_71965;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71957\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_71982_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_71982(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608,", " int64_t ctx_param_ext_77683, int64_t ctx_param_ext_77684, __global unsigned char *mem_param_77685, __global unsigned char *ext_mem_77878, __global unsigned char *mem_77884)\n{\n    #define segmap_tblock_sizze_71978 (inner_SMJ_intzisegmap_71982zisegmap_tblock_sizze_71978)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79045;\n    int32_t tblock_sizze_79048;\n    int32_t wave_sizze_79047;\n    int32_t block_id_79046;\n    int32_t global_tid_79044;\n    int64_t phys_tid_71982;\n    int64_t global_tid_79049;\n    int64_t slice_79050;\n    int64_t gtid_71981;\n    int64_t remnant_79051;\n    \n    local_tid_79045 = get_local_id(0);\n    tblock_sizze_79048 = get_local_size(0);\n    wave_sizze_79047 = LOCKSTEP_WIDTH;\n    block_id_79046 = get_tblock_id(0);\n    global_tid_79044 = block_id_79046 * tblock_sizze_79048 + local_tid_79045;\n    phys_tid_71982 = sext_i32_i64(global_tid_79044);\n    global_tid_79049 = sext_i32_i64(block_id_79046) * segmap_tblock_sizze_71978 + sext_i32_i64(local_tid_79045);\n    slice_79050 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_71981 = global_tid_79049;\n    remnant_79051 = global_tid_79049 - gtid_71981;\n    if (slt64(gtid_71981, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76048;\n        int64_t eta_p_71983;\n        int64_t eta_p_71984;\n        int64_t defunc_0_f_res_71985;\n        \n        slice_76048 = loopres_f_res_f_res_67593 + gtid_71981;\n        eta_p_71983 = ((__global int64_t *) mem_param_77685)[ctx_param_ext_77683 + slice_76048 * ctx_param_ext_77684];\n        eta_p_71984 = ((__global int64_t *) ext_mem_77878)[gtid_71981];\n        defunc_0_f_res_71985 = add64(eta_p_71983, eta_p_71984);\n        ((__global int64_t *) mem_77884)[gtid_71981] = defunc_0_f_res_71985;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71978\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72003_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72003(__global int *global_failure, int64_t nR_44377, int64_t ext_780",
                                    "72, int64_t ext_78073, __global unsigned char *mem_param_77640, __global unsigned char *ext_mem_78074, __global unsigned char *mem_78080)\n{\n    #define segmap_tblock_sizze_71999 (inner_SMJ_intzisegmap_72003zisegmap_tblock_sizze_71999)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79054;\n    int32_t tblock_sizze_79057;\n    int32_t wave_sizze_79056;\n    int32_t block_id_79055;\n    int32_t global_tid_79053;\n    int64_t phys_tid_72003;\n    int64_t global_tid_79058;\n    int64_t slice_79059;\n    int64_t gtid_72002;\n    int64_t remnant_79060;\n    \n    local_tid_79054 = get_local_id(0);\n    tblock_sizze_79057 = get_local_size(0);\n    wave_sizze_79056 = LOCKSTEP_WIDTH;\n    block_id_79055 = get_tblock_id(0);\n    global_tid_79053 = block_id_79055 * tblock_sizze_79057 + local_tid_79054;\n    phys_tid_72003 = sext_i32_i64(global_tid_79053);\n    global_tid_79058 = sext_i32_i64(block_id_79055) * segmap_tblock_sizze_71999 + sext_i32_i64(local_tid_79054);\n    slice_79059 = nR_44377;\n    gtid_72002 = global_tid_79058;\n    remnant_79060 = global_tid_79058 - gtid_72002;\n    if (slt64(gtid_72002, nR_44377)) {\n        int64_t eta_p_72004;\n        bool cond_72006;\n        int64_t lifted_lambda_res_72007;\n        \n        eta_p_72004 = ((__global int64_t *) mem_param_77640)[gtid_72002];\n        cond_72006 = slt64(eta_p_72004, (int64_t) 0);\n        if (cond_72006) {\n            int64_t eta_p_72005 = ((__global int64_t *) ext_mem_78074)[ext_78073 + gtid_72002 * ext_78072];\n            \n            lifted_lambda_res_72007 = eta_p_72005;\n        } else {\n            lifted_lambda_res_72007 = eta_p_72004;\n        }\n        ((__global int64_t *) mem_78080)[gtid_72002] = lifted_lambda_res_72007;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71999\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72024_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72024(__global int *global_failure, int64_t nR_44377, int64_t ext_78075, int64_t ext_78076, __global unsigned char *mem", "_param_77637, __global unsigned char *ext_mem_78077, __global unsigned char *mem_78083)\n{\n    #define segmap_tblock_sizze_72020 (inner_SMJ_intzisegmap_72024zisegmap_tblock_sizze_72020)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79063;\n    int32_t tblock_sizze_79066;\n    int32_t wave_sizze_79065;\n    int32_t block_id_79064;\n    int32_t global_tid_79062;\n    int64_t phys_tid_72024;\n    int64_t global_tid_79067;\n    int64_t slice_79068;\n    int64_t gtid_72023;\n    int64_t remnant_79069;\n    \n    local_tid_79063 = get_local_id(0);\n    tblock_sizze_79066 = get_local_size(0);\n    wave_sizze_79065 = LOCKSTEP_WIDTH;\n    block_id_79064 = get_tblock_id(0);\n    global_tid_79062 = block_id_79064 * tblock_sizze_79066 + local_tid_79063;\n    phys_tid_72024 = sext_i32_i64(global_tid_79062);\n    global_tid_79067 = sext_i32_i64(block_id_79064) * segmap_tblock_sizze_72020 + sext_i32_i64(local_tid_79063);\n    slice_79068 = nR_44377;\n    gtid_72023 = global_tid_79067;\n    remnant_79069 = global_tid_79067 - gtid_72023;\n    if (slt64(gtid_72023, nR_44377)) {\n        int64_t eta_p_72025;\n        int64_t eta_p_72026;\n        int64_t defunc_0_f_res_72027;\n        \n        eta_p_72025 = ((__global int64_t *) mem_param_77637)[gtid_72023];\n        eta_p_72026 = ((__global int64_t *) ext_mem_78077)[ext_78076 + gtid_72023 * ext_78075];\n        defunc_0_f_res_72027 = add64(eta_p_72025, eta_p_72026);\n        ((__global int64_t *) mem_78083)[gtid_72023] = defunc_0_f_res_72027;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72020\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72037_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72037(__global int *global_failure, int64_t nR_44377, int64_t m_67844, int64_t num_tblocks_72042, int32_t virt_num_tblocks_79200, __global unsigned char *tR_mem_77625, __global unsigned char *ext_mem_77627, __global unsigned char *ext_mem_78095, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned cha", "r *mem_78101, __global unsigned char *mem_78103, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109)\n{\n    #define segmap_tblock_sizze_72040 (inner_SMJ_intzisegmap_72037zisegmap_tblock_sizze_72040)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79202;\n    int32_t tblock_sizze_79205;\n    int32_t wave_sizze_79204;\n    int32_t block_id_79203;\n    int32_t global_tid_79201;\n    int64_t phys_tid_72037;\n    int32_t phys_tblock_id_79206;\n    int32_t iterations_79207;\n    \n    local_tid_79202 = get_local_id(0);\n    tblock_sizze_79205 = get_local_size(0);\n    wave_sizze_79204 = LOCKSTEP_WIDTH;\n    block_id_79203 = get_tblock_id(0);\n    global_tid_79201 = block_id_79203 * tblock_sizze_79205 + local_tid_79202;\n    phys_tid_72037 = sext_i32_i64(global_tid_79201);\n    phys_tblock_id_79206 = get_tblock_id(0);\n    iterations_79207 = sdiv_up32(virt_num_tblocks_79200 - phys_tblock_id_79206, sext_i64_i32(num_tblocks_72042));\n    for (int32_t i_79208 = 0; i_79208 < iterations_79207; i_79208++) {\n        int32_t virt_tblock_id_79209;\n        int64_t global_tid_79210;\n        int64_t slice_79211;\n        int64_t write_i_72036;\n        int64_t remnant_79212;\n        \n        virt_tblock_id_79209 = phys_tblock_id_79206 + i_79208 * sext_i64_i32(num_tblocks_72042);\n        global_tid_79210 = sext_i32_i64(virt_tblock_id_79209) * segmap_tblock_sizze_72040 + sext_i32_i64(local_tid_79202);\n        slice_79211 = nR_44377;\n        write_i_72036 = global_tid_79210;\n        remnant_79212 = global_tid_79210 - write_i_72036;\n        if (slt64(write_i_72036, nR_44377)) {\n            int64_t eta_p_68109;\n            int32_t write_value_68111;\n            int64_t write_value_68112;\n            int64_t write_value_68113;\n            int64_t write_value_68114;\n            bool cond_68115;\n            int64_t lifted_lambda_res_68116;\n            \n            eta_p_68109 = ((__global int64_t *) mem_78101)[write_i_72036];\n         ",
                                    "   write_value_68111 = ((__global int32_t *) tR_mem_77625)[write_i_72036];\n            write_value_68112 = ((__global int64_t *) ext_mem_77627)[write_i_72036];\n            write_value_68113 = ((__global int64_t *) ext_mem_78095)[write_i_72036];\n            write_value_68114 = ((__global int64_t *) ext_mem_78096)[write_i_72036];\n            cond_68115 = eta_p_68109 == (int64_t) 1;\n            if (cond_68115) {\n                int64_t eta_p_68110;\n                int64_t lifted_lambda_res_t_res_68890;\n                \n                eta_p_68110 = ((__global int64_t *) mem_78099)[write_i_72036];\n                lifted_lambda_res_t_res_68890 = sub64(eta_p_68110, (int64_t) 1);\n                lifted_lambda_res_68116 = lifted_lambda_res_t_res_68890;\n            } else {\n                lifted_lambda_res_68116 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int32_t *) mem_78109)[lifted_lambda_res_68116] = write_value_68111;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78107)[lifted_lambda_res_68116] = write_value_68112;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78105)[lifted_lambda_res_68116] = write_value_68113;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78103)[lifted_lambda_res_68116] = write_value_68114;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72040\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72071_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72071(__global int *global_failure, int64_t m_67844, __global ", "unsigned char *mem_78113, __global unsigned char *mem_78120)\n{\n    #define segmap_tblock_sizze_72067 (inner_SMJ_intzisegmap_72071zisegmap_tblock_sizze_72067)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79368;\n    int32_t tblock_sizze_79371;\n    int32_t wave_sizze_79370;\n    int32_t block_id_79369;\n    int32_t global_tid_79367;\n    int64_t phys_tid_72071;\n    int64_t global_tid_79372;\n    int64_t slice_79373;\n    int64_t gtid_72070;\n    int64_t remnant_79374;\n    \n    local_tid_79368 = get_local_id(0);\n    tblock_sizze_79371 = get_local_size(0);\n    wave_sizze_79370 = LOCKSTEP_WIDTH;\n    block_id_79369 = get_tblock_id(0);\n    global_tid_79367 = block_id_79369 * tblock_sizze_79371 + local_tid_79368;\n    phys_tid_72071 = sext_i32_i64(global_tid_79367);\n    global_tid_79372 = sext_i32_i64(block_id_79369) * segmap_tblock_sizze_72067 + sext_i32_i64(local_tid_79368);\n    slice_79373 = m_67844;\n    gtid_72070 = global_tid_79372;\n    remnant_79374 = global_tid_79372 - gtid_72070;\n    if (slt64(gtid_72070, m_67844)) {\n        int64_t zv_lhs_72073;\n        int64_t tmp_72074;\n        bool cond_72076;\n        int64_t lifted_lambda_res_72077;\n        \n        zv_lhs_72073 = add64((int64_t) -1, gtid_72070);\n        tmp_72074 = smod64(zv_lhs_72073, m_67844);\n        cond_72076 = gtid_72070 == (int64_t) 0;\n        if (cond_72076) {\n            lifted_lambda_res_72077 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_72075 = ((__global int64_t *) mem_78113)[tmp_72074];\n            \n            lifted_lambda_res_72077 = lifted_lambda_res_72075;\n        }\n        ((__global int64_t *) mem_78120)[gtid_72070] = lifted_lambda_res_72077;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72067\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72079_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72079(__global int *global_failure, int64_t m_67844, int64_t lower_bound_67927, int64_t min_res_67929, int64_t j_m_i_67930, int64_t num_tblocks_7208", "4, int32_t virt_num_tblocks_79413, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109, __global unsigned char *mem_78120, __global unsigned char *mem_78149, __global unsigned char *mem_78151, __global unsigned char *mem_78153)\n{\n    #define segmap_tblock_sizze_72082 (inner_SMJ_intzisegmap_72079zisegmap_tblock_sizze_72082)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79415;\n    int32_t tblock_sizze_79418;\n    int32_t wave_sizze_79417;\n    int32_t block_id_79416;\n    int32_t global_tid_79414;\n    int64_t phys_tid_72079;\n    int32_t phys_tblock_id_79419;\n    int32_t iterations_79420;\n    \n    local_tid_79415 = get_local_id(0);\n    tblock_sizze_79418 = get_local_size(0);\n    wave_sizze_79417 = LOCKSTEP_WIDTH;\n    block_id_79416 = get_tblock_id(0);\n    global_tid_79414 = block_id_79416 * tblock_sizze_79418 + local_tid_79415;\n    phys_tid_72079 = sext_i32_i64(global_tid_79414);\n    phys_tblock_id_79419 = get_tblock_id(0);\n    iterations_79420 = sdiv_up32(virt_num_tblocks_79413 - phys_tblock_id_79419, sext_i64_i32(num_tblocks_72084));\n    for (int32_t i_79421 = 0; i_79421 < iterations_79420; i_79421++) {\n        int32_t virt_tblock_id_79422;\n        int64_t global_tid_79423;\n        int64_t slice_79424;\n        int64_t write_i_72078;\n        int64_t remnant_79425;\n        \n        virt_tblock_id_79422 = phys_tblock_id_79419 + i_79421 * sext_i64_i32(num_tblocks_72084);\n        global_tid_79423 = sext_i32_i64(virt_tblock_id_79422) * segmap_tblock_sizze_72082 + sext_i32_i64(local_tid_79415);\n        slice_79424 = m_67844;\n        write_i_72078 = global_tid_79423;\n        remnant_79425 = global_tid_79423 - write_i_72078;\n        if (slt64(write_i_72078, m_67844)) {\n            int64_t eta_p_68502;\n            int32_t write_value_68503;\n            int64_t write_value_68504;\n            int64_t write_value_68505;\n            bool cond_68506;\n            bool cond_t_res_68507;\n            bool x_685",
                                    "08;\n            int64_t lifted_lambda_res_68509;\n            \n            eta_p_68502 = ((__global int64_t *) mem_78120)[write_i_72078];\n            write_value_68503 = ((__global int32_t *) mem_78109)[write_i_72078];\n            write_value_68504 = ((__global int64_t *) mem_78107)[write_i_72078];\n            write_value_68505 = ((__global int64_t *) mem_78105)[write_i_72078];\n            cond_68506 = sle64(lower_bound_67927, eta_p_68502);\n            cond_t_res_68507 = slt64(eta_p_68502, min_res_67929);\n            x_68508 = cond_68506 && cond_t_res_68507;\n            if (x_68508) {\n                int64_t lifted_lambda_res_t_res_68893 = sub64(eta_p_68502, lower_bound_67927);\n                \n                lifted_lambda_res_68509 = lifted_lambda_res_t_res_68893;\n            } else {\n                lifted_lambda_res_68509 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int32_t *) mem_78149)[lifted_lambda_res_68509] = write_value_68503;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78151)[lifted_lambda_res_68509] = write_value_68504;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78153)[lifted_lambda_res_68509] = write_value_68505;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72082\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72087_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72087(__global int *global_failure, int64_t m_67844, int64_t m_67984, int64_t num_tblocks_72092, int32_t virt_num_tblocks_79395, __global unsigned char *mem_78103, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global u", "nsigned char *mem_78120, __global unsigned char *mem_78128, __global unsigned char *mem_78130)\n{\n    #define segmap_tblock_sizze_72090 (inner_SMJ_intzisegmap_72087zisegmap_tblock_sizze_72090)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79397;\n    int32_t tblock_sizze_79400;\n    int32_t wave_sizze_79399;\n    int32_t block_id_79398;\n    int32_t global_tid_79396;\n    int64_t phys_tid_72087;\n    int32_t phys_tblock_id_79401;\n    int32_t iterations_79402;\n    \n    local_tid_79397 = get_local_id(0);\n    tblock_sizze_79400 = get_local_size(0);\n    wave_sizze_79399 = LOCKSTEP_WIDTH;\n    block_id_79398 = get_tblock_id(0);\n    global_tid_79396 = block_id_79398 * tblock_sizze_79400 + local_tid_79397;\n    phys_tid_72087 = sext_i32_i64(global_tid_79396);\n    phys_tblock_id_79401 = get_tblock_id(0);\n    iterations_79402 = sdiv_up32(virt_num_tblocks_79395 - phys_tblock_id_79401, sext_i64_i32(num_tblocks_72092));\n    for (int32_t i_79403 = 0; i_79403 < iterations_79402; i_79403++) {\n        int32_t virt_tblock_id_79404;\n        int64_t global_tid_79405;\n        int64_t slice_79406;\n        int64_t write_i_72086;\n        int64_t remnant_79407;\n        \n        virt_tblock_id_79404 = phys_tblock_id_79401 + i_79403 * sext_i64_i32(num_tblocks_72092);\n        global_tid_79405 = sext_i32_i64(virt_tblock_id_79404) * segmap_tblock_sizze_72090 + sext_i32_i64(local_tid_79397);\n        slice_79406 = m_67844;\n        write_i_72086 = global_tid_79405;\n        remnant_79407 = global_tid_79405 - write_i_72086;\n        if (slt64(write_i_72086, m_67844)) {\n            int64_t eta_p_68086;\n            int64_t write_value_68088;\n            int64_t write_value_68089;\n            bool cond_68090;\n            int64_t lifted_lambda_res_68091;\n            \n            eta_p_68086 = ((__global int64_t *) mem_78117)[write_i_72086];\n            write_value_68088 = ((__global int64_t *) mem_78120)[write_i_72086];\n            write_value_68089 = ((__global int64_t *) mem_78103)[wr", "ite_i_72086];\n            cond_68090 = eta_p_68086 == (int64_t) 1;\n            if (cond_68090) {\n                int64_t eta_p_68087;\n                int64_t lifted_lambda_res_t_res_68898;\n                \n                eta_p_68087 = ((__global int64_t *) mem_78115)[write_i_72086];\n                lifted_lambda_res_t_res_68898 = sub64(eta_p_68087, (int64_t) 1);\n                lifted_lambda_res_68091 = lifted_lambda_res_t_res_68898;\n            } else {\n                lifted_lambda_res_68091 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78130)[lifted_lambda_res_68091] = write_value_68088;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78128)[lifted_lambda_res_68091] = write_value_68089;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72090\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_72109_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_72109(__global int *global_failure, int64_t loopres_68028, int64_t loopres_68029, __global unsigned char *mem_78178, __global unsigned char *mem_78181)\n{\n    #define segmap_tblock_sizze_72105 (inner_SMJ_intzisegmap_72109zisegmap_tblock_sizze_72105)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79482;\n    int32_t tblock_sizze_79485;\n    int32_t wave_sizze_79484;\n    int32_t block_id_79483;\n    int32_t global_tid_79481;\n    int64_t phys_tid_72109;\n    int64_t global_tid_79486;\n    int64_t slice_79487;\n    int64_t gtid_72108;\n    int64_t remnant_79488;\n    \n    local_tid_79482 = get_local_id(0);\n    tblock_sizze_79485 = get_local_size(0);\n    wave_sizze_79484 = LOCKSTEP_WIDTH;\n    block_id_79483 = get_tblock_id(0);\n    global_tid_79481 = block_id_79483 * tblock_sizze_79485 ",
                                    "+ local_tid_79482;\n    phys_tid_72109 = sext_i32_i64(global_tid_79481);\n    global_tid_79486 = sext_i32_i64(block_id_79483) * segmap_tblock_sizze_72105 + sext_i32_i64(local_tid_79482);\n    slice_79487 = loopres_68029;\n    gtid_72108 = global_tid_79486;\n    remnant_79488 = global_tid_79486 - gtid_72108;\n    if (slt64(gtid_72108, loopres_68029)) {\n        int64_t loopres_77620;\n        int64_t tmp_72111;\n        \n        loopres_77620 = ((__global int64_t *) mem_78181)[(int64_t) 0];\n        tmp_72111 = add64(gtid_72108, loopres_77620);\n        ((__global int64_t *) mem_78178)[loopres_68028 + gtid_72108] = tmp_72111;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72105\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_76057_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_76057(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76060, int64_t num_whole_tiles_76075, int64_t residual_input_76299, unsigned char cond_76300_bits, int64_t binop_x_76316, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_78045, __global unsigned char *mem_78047)\n{\n    bool cond_76300 = cond_76300_bits;\n    \n    #define tile_sizze_76059 (inner_SMJ_intzisegmap_intrablock_76057zitile_sizze_76059)\n    #define bytes_78007 (inner_SMJ_intzisegmap_intrablock_76057zibytes_78007)\n    #define bytes_78009 (inner_SMJ_intzisegmap_intrablock_76057zibytes_78009)\n    \n    volatile __local unsigned char *color_78690_backing_2 = &shared_mem[0];\n    const int64_t color_78690_backing_2_offset = 0 + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78689_backing_1 = &shared_mem[color_78690_backing_2_offset];\n    const int64_t color_78689_backing_1_offset = color_78690_backing_2_offset + (bytes_78009 + srem64(", "(int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78688_backing_0 = &shared_mem[color_78689_backing_1_offset];\n    const int64_t color_78688_backing_0_offset = color_78689_backing_1_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78799;\n    int32_t tblock_sizze_78802;\n    int32_t wave_sizze_78801;\n    int32_t block_id_78800;\n    int32_t global_tid_78798;\n    int64_t gid_flat_76057;\n    int64_t slice_78804;\n    int64_t ltid_pre_78803;\n    int64_t remnant_78805;\n    int64_t slice_78806;\n    int64_t gid_76056;\n    int64_t remnant_78807;\n    __local unsigned char *color_78688;\n    __local unsigned char *color_78689;\n    __local unsigned char *color_78690;\n    int64_t binop_x_76067;\n    int32_t mem_77991[1];\n    int64_t ltid_flat_76062;\n    int64_t ltid_76061;\n    int64_t gtid_76068;\n    bool cond_76069;\n    int32_t pre_76070;\n    int64_t mem_77995[1];\n    int32_t mem_77999[1];\n    int64_t mem_78003[1];\n    int64_t ltid_flat_76077;\n    int64_t ltid_76076;\n    int64_t gtid_76087;\n    bool cond_76088;\n    int64_t neutral_76089;\n    int32_t neutral_76090;\n    int64_t ext_mem_78027[1];\n    int32_t ext_mem_78026[1];\n    int64_t ext_mem_78025[1];\n    int64_t mem_param_78004[1];\n    int32_t mem_param_78005[1];\n    int64_t mem_param_78006[1];\n    int64_t mem_78037[1];\n    int64_t mem_78041[1];\n    int64_t ext_mem_78043[1];\n    int64_t ext_mem_78042[1];\n    \n    local_tid_78799 = get_local_id(0);\n    tblock_sizze_78802 = get_local_size(0);\n    wave_sizze_78801 = LOCKSTEP_WIDTH;\n    block_id_78800 = get_tblock_id(0);\n    global_tid_78798 = block_id_78800 * tblock_sizze_78802 + local_tid_78799;\n    gid_flat_76057 = sext_i32_i64(block_id_78800);\n    slice_78804 = tile_sizze_76059;\n    ltid_pre_78803 = sext_i32_i64(local_tid_78799);\n    remnant_78805 = sext_i32_i64(local_tid_78799) - ltid_pre_78803;\n    slic", "e_78806 = ldim_76060;\n    gid_76056 = sext_i32_i64(block_id_78800);\n    remnant_78807 = sext_i32_i64(block_id_78800) - gid_76056;\n    color_78688 = (__local unsigned char *) color_78688_backing_0;\n    color_78689 = (__local unsigned char *) color_78689_backing_1;\n    color_78690 = (__local unsigned char *) color_78690_backing_2;\n    binop_x_76067 = gid_76056 * tile_sizze_76059;\n    ltid_flat_76062 = sext_i32_i64(local_tid_78799);\n    ltid_76061 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76068 = ltid_76061 + binop_x_76067;\n    cond_76069 = slt64(gtid_76068, min_res_68560);\n    if (cond_76069) {\n        int64_t slice_76071;\n        int32_t eta_p_76072;\n        \n        slice_76071 = start_68558 + gtid_76068;\n        eta_p_76072 = ((__global int32_t *) tR_mem_77625)[slice_76071];\n        pre_76070 = eta_p_76072;\n    } else {\n        pre_76070 = 0;\n    }\n    mem_77991[(int64_t) 0] = pre_76070;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76077 = sext_i32_i64(local_tid_78799);\n    ltid_76076 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76087 = binop_x_76067 + ltid_76076;\n    cond_76088 = slt64(gtid_76087, min_res_68560);\n    if (cond_76088) {\n        neutral_76089 = (int64_t) -1;\n    } else {\n        neutral_76089 = (int64_t) 0;\n    }\n    if (cond_76088) {\n        int32_t eta_p_76092 = mem_77991[(int64_t) 0];\n        \n        neutral_76090 = eta_p_76092;\n    } else {\n        neutral_76090 = 0;\n    }\n    mem_77995[(int64_t) 0] = neutral_76089;\n    mem_77999[(int64_t) 0] = neutral_76090;\n    mem_78003[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_78004[i_3] = mem_77995[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_78005[i_4] = mem_77999[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_78006[i_5] = mem_78003[i_5];\n    for (int64_t tile_id_76102 = 0; tile_id_76102 < num_whole_tiles_76075; tile_id_76102++) ",
                                    "{\n        int64_t binop_x_76201;\n        int64_t ltid_flat_76200;\n        int64_t ltid_76199;\n        int64_t j_76202;\n        bool cond_76206;\n        int64_t pre1d_76209;\n        int64_t pre1d_76207;\n        int32_t pre1d_76208;\n        int64_t mem_78016[1];\n        int32_t mem_78020[1];\n        int64_t mem_78024[1];\n        int64_t ltid_flat_76220;\n        int64_t ltid_76219;\n        int64_t gtid_76222;\n        int64_t acc_76224;\n        int32_t acc_76225;\n        int64_t acc_76226;\n        bool cond_76227;\n        int64_t acc_76228;\n        int32_t acc_76229;\n        int64_t acc_76230;\n        int64_t mem_param_tmp_78808[1];\n        int32_t mem_param_tmp_78809[1];\n        int64_t mem_param_tmp_78810[1];\n        \n        binop_x_76201 = tile_sizze_76059 * tile_id_76102;\n        ltid_flat_76200 = sext_i32_i64(local_tid_78799);\n        ltid_76199 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76202 = ltid_76199 + binop_x_76201;\n        cond_76206 = slt64(j_76202, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76209 = btoi_bool_i64(cond_76206);\n        if (cond_76206) {\n            int64_t tile_elem_76210;\n            int64_t slice_77479;\n            int32_t tile_elem_76211;\n            \n            tile_elem_76210 = ((__global int64_t *) ext_mem_77925)[j_76202];\n            slice_77479 = tS_start_66998 + j_76202;\n            tile_elem_76211 = ((__global int32_t *) tS_mem_77626)[slice_77479];\n            pre1d_76207 = tile_elem_76210;\n            pre1d_76208 = tile_elem_76211;\n        } else {\n            pre1d_76207 = (int64_t) 0;\n            pre1d_76208 = 0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76199] = pre1d_76207;\n        ((__local int32_t *) color_78689)[ltid_76199] = pre1d_76208;\n        ((__local int64_t *) color_78688)[ltid_76199] = pre1d_76209;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76220 = sext_i32_i64(local_tid_78799);\n        ltid_76219 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gt", "id_76222 = binop_x_76067 + ltid_76219;\n        acc_76224 = mem_param_78004[(int64_t) 0];\n        acc_76225 = mem_param_78005[(int64_t) 0];\n        acc_76226 = mem_param_78006[(int64_t) 0];\n        cond_76227 = slt64(gtid_76222, min_res_68560);\n        if (cond_76227) {\n            int32_t eta_p_76223;\n            int64_t x_76231;\n            int32_t x_76232;\n            int64_t x_76233;\n            int64_t redout_77492;\n            int32_t redout_77493;\n            int64_t redout_77494;\n            \n            eta_p_76223 = mem_77991[(int64_t) 0];\n            redout_77492 = acc_76224;\n            redout_77493 = acc_76225;\n            redout_77494 = acc_76226;\n            for (int64_t i_77495 = 0; i_77495 < tile_sizze_76059; i_77495++) {\n                int64_t x_76234;\n                int32_t x_76235;\n                bool defunc_0_neq_res_76243;\n                bool defunc_0_neq_res_76244;\n                bool cond_f_res_76245;\n                bool y_76246;\n                bool cond_76247;\n                bool defunc_0_neq_res_76248;\n                bool defunc_0_neq_res_76249;\n                bool cond_t_res_f_res_76250;\n                bool y_76251;\n                bool cond_t_res_76252;\n                bool x_76253;\n                int64_t defunc_0_op_res_76254;\n                int32_t defunc_0_op_res_76255;\n                int64_t defunc_0_op_res_76256;\n                int64_t redout_tmp_78814;\n                int32_t redout_tmp_78815;\n                int64_t redout_tmp_78816;\n                \n                x_76234 = ((__local int64_t *) color_78690)[i_77495];\n                x_76235 = ((__local int32_t *) color_78689)[i_77495];\n                defunc_0_neq_res_76243 = redout_77493 == eta_p_76223;\n                defunc_0_neq_res_76244 = !defunc_0_neq_res_76243;\n                cond_f_res_76245 = slt64(redout_77492, (int64_t) 0);\n                y_76246 = defunc_0_neq_res_76243 && cond_f_res_76245;\n                cond_76247 = defunc_0_neq_res_76244 || y_7624", "6;\n                defunc_0_neq_res_76248 = x_76235 == eta_p_76223;\n                defunc_0_neq_res_76249 = !defunc_0_neq_res_76248;\n                cond_t_res_f_res_76250 = slt64(x_76234, (int64_t) 0);\n                y_76251 = defunc_0_neq_res_76248 && cond_t_res_f_res_76250;\n                cond_t_res_76252 = defunc_0_neq_res_76249 || y_76251;\n                x_76253 = cond_76247 && cond_t_res_76252;\n                if (x_76253) {\n                    defunc_0_op_res_76254 = (int64_t) -1;\n                    defunc_0_op_res_76255 = eta_p_76223;\n                    defunc_0_op_res_76256 = (int64_t) 0;\n                } else {\n                    int64_t x_76236;\n                    int64_t defunc_0_op_res_f_res_76257;\n                    int32_t defunc_0_op_res_f_res_76258;\n                    int64_t defunc_0_op_res_f_res_76259;\n                    \n                    x_76236 = ((__local int64_t *) color_78688)[i_77495];\n                    if (cond_76247) {\n                        defunc_0_op_res_f_res_76257 = x_76234;\n                        defunc_0_op_res_f_res_76258 = x_76235;\n                        defunc_0_op_res_f_res_76259 = x_76236;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_76260;\n                        int64_t defunc_0_op_res_f_res_f_res_76261;\n                        int64_t defunc_0_op_res_f_res_f_res_76262;\n                        \n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76260 = redout_77493;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76260 = eta_p_76223;\n                        }\n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76261 = redout_77492;\n                            defunc_0_op_res_f_res_f_res_76262 = redout_77494;\n                        } else {\n                            int64_t min_res_76263;\n                            i",
                                    "nt64_t tmp_76264;\n                            \n                            min_res_76263 = smin64(x_76234, redout_77492);\n                            tmp_76264 = add64(x_76236, redout_77494);\n                            defunc_0_op_res_f_res_f_res_76261 = min_res_76263;\n                            defunc_0_op_res_f_res_f_res_76262 = tmp_76264;\n                        }\n                        defunc_0_op_res_f_res_76257 = defunc_0_op_res_f_res_f_res_76261;\n                        defunc_0_op_res_f_res_76258 = defunc_0_op_res_f_res_f_res_76260;\n                        defunc_0_op_res_f_res_76259 = defunc_0_op_res_f_res_f_res_76262;\n                    }\n                    defunc_0_op_res_76254 = defunc_0_op_res_f_res_76257;\n                    defunc_0_op_res_76255 = defunc_0_op_res_f_res_76258;\n                    defunc_0_op_res_76256 = defunc_0_op_res_f_res_76259;\n                }\n                redout_tmp_78814 = defunc_0_op_res_76254;\n                redout_tmp_78815 = defunc_0_op_res_76255;\n                redout_tmp_78816 = defunc_0_op_res_76256;\n                redout_77492 = redout_tmp_78814;\n                redout_77493 = redout_tmp_78815;\n                redout_77494 = redout_tmp_78816;\n            }\n            x_76231 = redout_77492;\n            x_76232 = redout_77493;\n            x_76233 = redout_77494;\n            acc_76228 = x_76231;\n            acc_76229 = x_76232;\n            acc_76230 = x_76233;\n        } else {\n            acc_76228 = acc_76224;\n            acc_76229 = acc_76225;\n            acc_76230 = acc_76226;\n        }\n        mem_78016[(int64_t) 0] = acc_76228;\n        mem_78020[(int64_t) 0] = acc_76229;\n        mem_78024[(int64_t) 0] = acc_76230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78808[i_6] = mem_78016[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78809[i_7] = mem_78020[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n          ", "  mem_param_tmp_78810[i_8] = mem_78024[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_78004[i_9] = mem_param_tmp_78808[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_78005[i_10] = mem_param_tmp_78809[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_78006[i_11] = mem_param_tmp_78810[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_78027[i_12] = mem_param_78004[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_78026[i_13] = mem_param_78005[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_78025[i_14] = mem_param_78006[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76300) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_78043[i_15] = ext_mem_78027[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_78042[i_16] = ext_mem_78025[i_16];\n    } else {\n        int64_t ltid_flat_76302;\n        int64_t ltid_76301;\n        int64_t j_76317;\n        bool cond_76321;\n        int64_t pre1d_76324;\n        int64_t pre1d_76322;\n        int32_t pre1d_76323;\n        int64_t ltid_flat_76338;\n        int64_t ltid_76337;\n        int64_t gtid_76351;\n        int64_t acc_76353;\n        int64_t acc_76355;\n        bool cond_76356;\n        int64_t acc_76357;\n        int64_t acc_76359;\n        \n        ltid_flat_76302 = sext_i32_i64(local_tid_78799);\n        ltid_76301 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76317 = ltid_76301 + binop_x_76316;\n        cond_76321 = slt64(j_76317, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76324 = btoi_bool_i64(cond_76321);\n        if (cond_76321) {\n            int64_t tile_elem_76325;\n            int64_t slice_77478;\n            int32_t tile_elem_76326;\n            \n            tile_elem_76325 = ((__global int64_t *) ext_mem_77925)[j_76317];\n            slice_77478 = tS_start_66998 + j_76317;\n            tile_elem_76326 = ((__global", " int32_t *) tS_mem_77626)[slice_77478];\n            pre1d_76322 = tile_elem_76325;\n            pre1d_76323 = tile_elem_76326;\n        } else {\n            pre1d_76322 = (int64_t) 0;\n            pre1d_76323 = 0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76301] = pre1d_76322;\n        ((__local int32_t *) color_78689)[ltid_76301] = pre1d_76323;\n        ((__local int64_t *) color_78688)[ltid_76301] = pre1d_76324;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76338 = sext_i32_i64(local_tid_78799);\n        ltid_76337 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76351 = binop_x_76067 + ltid_76337;\n        acc_76353 = ext_mem_78027[(int64_t) 0];\n        acc_76355 = ext_mem_78025[(int64_t) 0];\n        cond_76356 = slt64(gtid_76351, min_res_68560);\n        if (cond_76356) {\n            int32_t eta_p_76352;\n            int32_t acc_76354;\n            int64_t x_76360;\n            int32_t x_76361;\n            int64_t x_76362;\n            int64_t redout_77496;\n            int32_t redout_77497;\n            int64_t redout_77498;\n            \n            eta_p_76352 = mem_77991[(int64_t) 0];\n            acc_76354 = ext_mem_78026[(int64_t) 0];\n            redout_77496 = acc_76353;\n            redout_77497 = acc_76354;\n            redout_77498 = acc_76355;\n            for (int64_t i_77499 = 0; i_77499 < residual_input_76299; i_77499++) {\n                int64_t x_76363;\n                int32_t x_76364;\n                bool defunc_0_neq_res_76372;\n                bool defunc_0_neq_res_76373;\n                bool cond_f_res_76374;\n                bool y_76375;\n                bool cond_76376;\n                bool defunc_0_neq_res_76377;\n                bool defunc_0_neq_res_76378;\n                bool cond_t_res_f_res_76379;\n                bool y_76380;\n                bool cond_t_res_76381;\n                bool x_76382;\n                int64_t defunc_0_op_res_76383;\n                int32_t defunc_0_op_res_76384;\n                int64_t defunc_0_op",
                                    "_res_76385;\n                int64_t redout_tmp_78817;\n                int32_t redout_tmp_78818;\n                int64_t redout_tmp_78819;\n                \n                x_76363 = ((__local int64_t *) color_78690)[i_77499];\n                x_76364 = ((__local int32_t *) color_78689)[i_77499];\n                defunc_0_neq_res_76372 = redout_77497 == eta_p_76352;\n                defunc_0_neq_res_76373 = !defunc_0_neq_res_76372;\n                cond_f_res_76374 = slt64(redout_77496, (int64_t) 0);\n                y_76375 = defunc_0_neq_res_76372 && cond_f_res_76374;\n                cond_76376 = defunc_0_neq_res_76373 || y_76375;\n                defunc_0_neq_res_76377 = x_76364 == eta_p_76352;\n                defunc_0_neq_res_76378 = !defunc_0_neq_res_76377;\n                cond_t_res_f_res_76379 = slt64(x_76363, (int64_t) 0);\n                y_76380 = defunc_0_neq_res_76377 && cond_t_res_f_res_76379;\n                cond_t_res_76381 = defunc_0_neq_res_76378 || y_76380;\n                x_76382 = cond_76376 && cond_t_res_76381;\n                if (x_76382) {\n                    defunc_0_op_res_76383 = (int64_t) -1;\n                    defunc_0_op_res_76384 = eta_p_76352;\n                    defunc_0_op_res_76385 = (int64_t) 0;\n                } else {\n                    int64_t x_76365;\n                    int64_t defunc_0_op_res_f_res_76386;\n                    int32_t defunc_0_op_res_f_res_76387;\n                    int64_t defunc_0_op_res_f_res_76388;\n                    \n                    x_76365 = ((__local int64_t *) color_78688)[i_77499];\n                    if (cond_76376) {\n                        defunc_0_op_res_f_res_76386 = x_76363;\n                        defunc_0_op_res_f_res_76387 = x_76364;\n                        defunc_0_op_res_f_res_76388 = x_76365;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_76389;\n                        int64_t defunc_0_op_res_f_res_f_res_76390;\n                        int64_t defunc_0", "_op_res_f_res_f_res_76391;\n                        \n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76389 = redout_77497;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76389 = eta_p_76352;\n                        }\n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76390 = redout_77496;\n                            defunc_0_op_res_f_res_f_res_76391 = redout_77498;\n                        } else {\n                            int64_t min_res_76392;\n                            int64_t tmp_76393;\n                            \n                            min_res_76392 = smin64(x_76363, redout_77496);\n                            tmp_76393 = add64(x_76365, redout_77498);\n                            defunc_0_op_res_f_res_f_res_76390 = min_res_76392;\n                            defunc_0_op_res_f_res_f_res_76391 = tmp_76393;\n                        }\n                        defunc_0_op_res_f_res_76386 = defunc_0_op_res_f_res_f_res_76390;\n                        defunc_0_op_res_f_res_76387 = defunc_0_op_res_f_res_f_res_76389;\n                        defunc_0_op_res_f_res_76388 = defunc_0_op_res_f_res_f_res_76391;\n                    }\n                    defunc_0_op_res_76383 = defunc_0_op_res_f_res_76386;\n                    defunc_0_op_res_76384 = defunc_0_op_res_f_res_76387;\n                    defunc_0_op_res_76385 = defunc_0_op_res_f_res_76388;\n                }\n                redout_tmp_78817 = defunc_0_op_res_76383;\n                redout_tmp_78818 = defunc_0_op_res_76384;\n                redout_tmp_78819 = defunc_0_op_res_76385;\n                redout_77496 = redout_tmp_78817;\n                redout_77497 = redout_tmp_78818;\n                redout_77498 = redout_tmp_78819;\n            }\n            x_76360 = redout_77496;\n            x_76361 = redout_77497;\n            x_76362 = redout_77498;\n            acc_76357 = x_76", "360;\n            acc_76359 = x_76362;\n        } else {\n            acc_76357 = acc_76353;\n            acc_76359 = acc_76355;\n        }\n        mem_78037[(int64_t) 0] = acc_76357;\n        mem_78041[(int64_t) 0] = acc_76359;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_78043[i_17] = mem_78037[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_78042[i_18] = mem_78041[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78820 = ext_mem_78043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78045)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78820;\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78821 = ext_mem_78042[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78047)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78821;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76059\n    #undef bytes_78007\n    #undef bytes_78009\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_76412_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_76412(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76415, int64_t num_whole_tiles_76430, int64_t residual_input_76654, unsigned char cond_76655_bits, int64_t binop_x_76671, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_77984, __global unsigned char *mem_77986)\n{\n    bool cond_76655 = cond_76655_bits;\n    \n    #define tile_sizze_76414 (inner_SMJ_intzisegmap_intrablock_76412zitile_sizze_76414)\n    #define bytes_77946 (inner_SMJ_intzisegmap_intrablock_76412zib",
                                    "ytes_77946)\n    #define bytes_77948 (inner_SMJ_intzisegmap_intrablock_76412zibytes_77948)\n    \n    volatile __local unsigned char *color_78693_backing_2 = &shared_mem[0];\n    const int64_t color_78693_backing_2_offset = 0 + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78692_backing_1 = &shared_mem[color_78693_backing_2_offset];\n    const int64_t color_78692_backing_1_offset = color_78693_backing_2_offset + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78691_backing_0 = &shared_mem[color_78692_backing_1_offset];\n    const int64_t color_78691_backing_0_offset = color_78692_backing_1_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78825;\n    int32_t tblock_sizze_78828;\n    int32_t wave_sizze_78827;\n    int32_t block_id_78826;\n    int32_t global_tid_78824;\n    int64_t gid_flat_76412;\n    int64_t slice_78830;\n    int64_t ltid_pre_78829;\n    int64_t remnant_78831;\n    int64_t slice_78832;\n    int64_t gid_76411;\n    int64_t remnant_78833;\n    __local unsigned char *color_78691;\n    __local unsigned char *color_78692;\n    __local unsigned char *color_78693;\n    int64_t binop_x_76422;\n    int32_t mem_77930[1];\n    int64_t ltid_flat_76417;\n    int64_t ltid_76416;\n    int64_t gtid_76423;\n    bool cond_76424;\n    int32_t pre_76425;\n    int64_t mem_77934[1];\n    int32_t mem_77938[1];\n    int64_t mem_77942[1];\n    int64_t ltid_flat_76432;\n    int64_t ltid_76431;\n    int64_t gtid_76442;\n    bool cond_76443;\n    int64_t neutral_76444;\n    int32_t neutral_76445;\n    int64_t ext_mem_77966[1];\n    int32_t ext_mem_77965[1];\n    int64_t ext_mem_77964[1];\n    int64_t mem_param_77943[1];\n    int32_t mem_param_77944[1];\n    int64_t mem_param_77945[1];\n    int64_t mem_77976[1];\n    int64_t mem_77980[1];\n    i", "nt64_t ext_mem_77982[1];\n    int64_t ext_mem_77981[1];\n    \n    local_tid_78825 = get_local_id(0);\n    tblock_sizze_78828 = get_local_size(0);\n    wave_sizze_78827 = LOCKSTEP_WIDTH;\n    block_id_78826 = get_tblock_id(0);\n    global_tid_78824 = block_id_78826 * tblock_sizze_78828 + local_tid_78825;\n    gid_flat_76412 = sext_i32_i64(block_id_78826);\n    slice_78830 = tile_sizze_76414;\n    ltid_pre_78829 = sext_i32_i64(local_tid_78825);\n    remnant_78831 = sext_i32_i64(local_tid_78825) - ltid_pre_78829;\n    slice_78832 = ldim_76415;\n    gid_76411 = sext_i32_i64(block_id_78826);\n    remnant_78833 = sext_i32_i64(block_id_78826) - gid_76411;\n    color_78691 = (__local unsigned char *) color_78691_backing_0;\n    color_78692 = (__local unsigned char *) color_78692_backing_1;\n    color_78693 = (__local unsigned char *) color_78693_backing_2;\n    binop_x_76422 = gid_76411 * tile_sizze_76414;\n    ltid_flat_76417 = sext_i32_i64(local_tid_78825);\n    ltid_76416 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76423 = ltid_76416 + binop_x_76422;\n    cond_76424 = slt64(gtid_76423, min_res_68560);\n    if (cond_76424) {\n        int64_t slice_76426;\n        int32_t eta_p_76427;\n        \n        slice_76426 = start_68558 + gtid_76423;\n        eta_p_76427 = ((__global int32_t *) tR_mem_77625)[slice_76426];\n        pre_76425 = eta_p_76427;\n    } else {\n        pre_76425 = 0;\n    }\n    mem_77930[(int64_t) 0] = pre_76425;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76432 = sext_i32_i64(local_tid_78825);\n    ltid_76431 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76442 = binop_x_76422 + ltid_76431;\n    cond_76443 = slt64(gtid_76442, min_res_68560);\n    if (cond_76443) {\n        neutral_76444 = (int64_t) -1;\n    } else {\n        neutral_76444 = (int64_t) 0;\n    }\n    if (cond_76443) {\n        int32_t eta_p_76447 = mem_77930[(int64_t) 0];\n        \n        neutral_76445 = eta_p_76447;\n    } else {\n        neutral_76445 = 0;\n    }\n    mem_77934[(int64_t) 0] = neutral_76444;", "\n    mem_77938[(int64_t) 0] = neutral_76445;\n    mem_77942[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77943[i_3] = mem_77934[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77944[i_4] = mem_77938[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77945[i_5] = mem_77942[i_5];\n    for (int64_t tile_id_76457 = 0; tile_id_76457 < num_whole_tiles_76430; tile_id_76457++) {\n        int64_t binop_x_76556;\n        int64_t ltid_flat_76555;\n        int64_t ltid_76554;\n        int64_t j_76557;\n        bool cond_76561;\n        int64_t pre1d_76564;\n        int64_t pre1d_76562;\n        int32_t pre1d_76563;\n        int64_t mem_77955[1];\n        int32_t mem_77959[1];\n        int64_t mem_77963[1];\n        int64_t ltid_flat_76575;\n        int64_t ltid_76574;\n        int64_t gtid_76577;\n        int64_t acc_76579;\n        int32_t acc_76580;\n        int64_t acc_76581;\n        bool cond_76582;\n        int64_t acc_76583;\n        int32_t acc_76584;\n        int64_t acc_76585;\n        int64_t mem_param_tmp_78834[1];\n        int32_t mem_param_tmp_78835[1];\n        int64_t mem_param_tmp_78836[1];\n        \n        binop_x_76556 = tile_sizze_76414 * tile_id_76457;\n        ltid_flat_76555 = sext_i32_i64(local_tid_78825);\n        ltid_76554 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76557 = ltid_76554 + binop_x_76556;\n        cond_76561 = slt64(j_76557, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76564 = btoi_bool_i64(cond_76561);\n        if (cond_76561) {\n            int64_t tile_elem_76565;\n            int64_t slice_77483;\n            int32_t tile_elem_76566;\n            \n            tile_elem_76565 = ((__global int64_t *) ext_mem_77925)[j_76557];\n            slice_77483 = tS_start_66998 + j_76557;\n            tile_elem_76566 = ((__global int32_t *) tS_mem_77626)[slice_77483];\n            pre1d_76562 = tile_elem_76565;\n ",
                                    "           pre1d_76563 = tile_elem_76566;\n        } else {\n            pre1d_76562 = (int64_t) 0;\n            pre1d_76563 = 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76554] = pre1d_76562;\n        ((__local int32_t *) color_78692)[ltid_76554] = pre1d_76563;\n        ((__local int64_t *) color_78691)[ltid_76554] = pre1d_76564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76575 = sext_i32_i64(local_tid_78825);\n        ltid_76574 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76577 = binop_x_76422 + ltid_76574;\n        acc_76579 = mem_param_77943[(int64_t) 0];\n        acc_76580 = mem_param_77944[(int64_t) 0];\n        acc_76581 = mem_param_77945[(int64_t) 0];\n        cond_76582 = slt64(gtid_76577, min_res_68560);\n        if (cond_76582) {\n            int32_t eta_p_76578;\n            int64_t x_76586;\n            int32_t x_76587;\n            int64_t x_76588;\n            int64_t redout_77500;\n            int32_t redout_77501;\n            int64_t redout_77502;\n            \n            eta_p_76578 = mem_77930[(int64_t) 0];\n            redout_77500 = acc_76579;\n            redout_77501 = acc_76580;\n            redout_77502 = acc_76581;\n            for (int64_t i_77503 = 0; i_77503 < tile_sizze_76414; i_77503++) {\n                int64_t x_76589;\n                int32_t x_76590;\n                bool defunc_0_neq_res_76598;\n                bool defunc_0_neq_res_76599;\n                bool cond_f_res_76600;\n                bool y_76601;\n                bool cond_76602;\n                bool defunc_0_neq_res_76603;\n                bool defunc_0_neq_res_76604;\n                bool cond_t_res_f_res_76605;\n                bool y_76606;\n                bool cond_t_res_76607;\n                bool x_76608;\n                int64_t defunc_0_op_res_76609;\n                int32_t defunc_0_op_res_76610;\n                int64_t defunc_0_op_res_76611;\n                int64_t redout_tmp_78840;\n                int32_t redout_tmp_78841;\n                int64", "_t redout_tmp_78842;\n                \n                x_76589 = ((__local int64_t *) color_78693)[i_77503];\n                x_76590 = ((__local int32_t *) color_78692)[i_77503];\n                defunc_0_neq_res_76598 = redout_77501 == eta_p_76578;\n                defunc_0_neq_res_76599 = !defunc_0_neq_res_76598;\n                cond_f_res_76600 = slt64(redout_77500, (int64_t) 0);\n                y_76601 = defunc_0_neq_res_76598 && cond_f_res_76600;\n                cond_76602 = defunc_0_neq_res_76599 || y_76601;\n                defunc_0_neq_res_76603 = x_76590 == eta_p_76578;\n                defunc_0_neq_res_76604 = !defunc_0_neq_res_76603;\n                cond_t_res_f_res_76605 = slt64(x_76589, (int64_t) 0);\n                y_76606 = defunc_0_neq_res_76603 && cond_t_res_f_res_76605;\n                cond_t_res_76607 = defunc_0_neq_res_76604 || y_76606;\n                x_76608 = cond_76602 && cond_t_res_76607;\n                if (x_76608) {\n                    defunc_0_op_res_76609 = (int64_t) -1;\n                    defunc_0_op_res_76610 = eta_p_76578;\n                    defunc_0_op_res_76611 = (int64_t) 0;\n                } else {\n                    int64_t x_76591;\n                    int64_t defunc_0_op_res_f_res_76612;\n                    int32_t defunc_0_op_res_f_res_76613;\n                    int64_t defunc_0_op_res_f_res_76614;\n                    \n                    x_76591 = ((__local int64_t *) color_78691)[i_77503];\n                    if (cond_76602) {\n                        defunc_0_op_res_f_res_76612 = x_76589;\n                        defunc_0_op_res_f_res_76613 = x_76590;\n                        defunc_0_op_res_f_res_76614 = x_76591;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_76615;\n                        int64_t defunc_0_op_res_f_res_f_res_76616;\n                        int64_t defunc_0_op_res_f_res_f_res_76617;\n                        \n                        if (cond_t_res_76607) {\n                 ", "           defunc_0_op_res_f_res_f_res_76615 = redout_77501;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76615 = eta_p_76578;\n                        }\n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76616 = redout_77500;\n                            defunc_0_op_res_f_res_f_res_76617 = redout_77502;\n                        } else {\n                            int64_t min_res_76618;\n                            int64_t tmp_76619;\n                            \n                            min_res_76618 = smin64(x_76589, redout_77500);\n                            tmp_76619 = add64(x_76591, redout_77502);\n                            defunc_0_op_res_f_res_f_res_76616 = min_res_76618;\n                            defunc_0_op_res_f_res_f_res_76617 = tmp_76619;\n                        }\n                        defunc_0_op_res_f_res_76612 = defunc_0_op_res_f_res_f_res_76616;\n                        defunc_0_op_res_f_res_76613 = defunc_0_op_res_f_res_f_res_76615;\n                        defunc_0_op_res_f_res_76614 = defunc_0_op_res_f_res_f_res_76617;\n                    }\n                    defunc_0_op_res_76609 = defunc_0_op_res_f_res_76612;\n                    defunc_0_op_res_76610 = defunc_0_op_res_f_res_76613;\n                    defunc_0_op_res_76611 = defunc_0_op_res_f_res_76614;\n                }\n                redout_tmp_78840 = defunc_0_op_res_76609;\n                redout_tmp_78841 = defunc_0_op_res_76610;\n                redout_tmp_78842 = defunc_0_op_res_76611;\n                redout_77500 = redout_tmp_78840;\n                redout_77501 = redout_tmp_78841;\n                redout_77502 = redout_tmp_78842;\n            }\n            x_76586 = redout_77500;\n            x_76587 = redout_77501;\n            x_76588 = redout_77502;\n            acc_76583 = x_76586;\n            acc_76584 = x_76587;\n            acc_76585 = x_76588;\n        } else {\n            acc_76583 = acc_7",
                                    "6579;\n            acc_76584 = acc_76580;\n            acc_76585 = acc_76581;\n        }\n        mem_77955[(int64_t) 0] = acc_76583;\n        mem_77959[(int64_t) 0] = acc_76584;\n        mem_77963[(int64_t) 0] = acc_76585;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78834[i_6] = mem_77955[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78835[i_7] = mem_77959[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78836[i_8] = mem_77963[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77943[i_9] = mem_param_tmp_78834[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77944[i_10] = mem_param_tmp_78835[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77945[i_11] = mem_param_tmp_78836[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77966[i_12] = mem_param_77943[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77965[i_13] = mem_param_77944[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77964[i_14] = mem_param_77945[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76655) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77982[i_15] = ext_mem_77966[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77981[i_16] = ext_mem_77964[i_16];\n    } else {\n        int64_t ltid_flat_76657;\n        int64_t ltid_76656;\n        int64_t j_76672;\n        bool cond_76676;\n        int64_t pre1d_76679;\n        int64_t pre1d_76677;\n        int32_t pre1d_76678;\n        int64_t ltid_flat_76693;\n        int64_t ltid_76692;\n        int64_t gtid_76706;\n        int64_t acc_76708;\n        int64_t acc_76710;\n        bool cond_76711;\n        int64_t acc_76712;\n        int64_t acc_76714;\n        \n        ltid_flat_76657 = sext_i32_i64(local_tid_78825);\n        ltid_76656 = sext_i32_i64(sext_i64_i32(", "ltid_pre_78829));\n        j_76672 = ltid_76656 + binop_x_76671;\n        cond_76676 = slt64(j_76672, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76679 = btoi_bool_i64(cond_76676);\n        if (cond_76676) {\n            int64_t tile_elem_76680;\n            int64_t slice_77482;\n            int32_t tile_elem_76681;\n            \n            tile_elem_76680 = ((__global int64_t *) ext_mem_77925)[j_76672];\n            slice_77482 = tS_start_66998 + j_76672;\n            tile_elem_76681 = ((__global int32_t *) tS_mem_77626)[slice_77482];\n            pre1d_76677 = tile_elem_76680;\n            pre1d_76678 = tile_elem_76681;\n        } else {\n            pre1d_76677 = (int64_t) 0;\n            pre1d_76678 = 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76656] = pre1d_76677;\n        ((__local int32_t *) color_78692)[ltid_76656] = pre1d_76678;\n        ((__local int64_t *) color_78691)[ltid_76656] = pre1d_76679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76693 = sext_i32_i64(local_tid_78825);\n        ltid_76692 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76706 = binop_x_76422 + ltid_76692;\n        acc_76708 = ext_mem_77966[(int64_t) 0];\n        acc_76710 = ext_mem_77964[(int64_t) 0];\n        cond_76711 = slt64(gtid_76706, min_res_68560);\n        if (cond_76711) {\n            int32_t eta_p_76707;\n            int32_t acc_76709;\n            int64_t x_76715;\n            int32_t x_76716;\n            int64_t x_76717;\n            int64_t redout_77504;\n            int32_t redout_77505;\n            int64_t redout_77506;\n            \n            eta_p_76707 = mem_77930[(int64_t) 0];\n            acc_76709 = ext_mem_77965[(int64_t) 0];\n            redout_77504 = acc_76708;\n            redout_77505 = acc_76709;\n            redout_77506 = acc_76710;\n            for (int64_t i_77507 = 0; i_77507 < residual_input_76654; i_77507++) {\n                int64_t x_76718;\n                int32_t x_76719;\n                bool defunc_0_neq_res_767", "27;\n                bool defunc_0_neq_res_76728;\n                bool cond_f_res_76729;\n                bool y_76730;\n                bool cond_76731;\n                bool defunc_0_neq_res_76732;\n                bool defunc_0_neq_res_76733;\n                bool cond_t_res_f_res_76734;\n                bool y_76735;\n                bool cond_t_res_76736;\n                bool x_76737;\n                int64_t defunc_0_op_res_76738;\n                int32_t defunc_0_op_res_76739;\n                int64_t defunc_0_op_res_76740;\n                int64_t redout_tmp_78843;\n                int32_t redout_tmp_78844;\n                int64_t redout_tmp_78845;\n                \n                x_76718 = ((__local int64_t *) color_78693)[i_77507];\n                x_76719 = ((__local int32_t *) color_78692)[i_77507];\n                defunc_0_neq_res_76727 = redout_77505 == eta_p_76707;\n                defunc_0_neq_res_76728 = !defunc_0_neq_res_76727;\n                cond_f_res_76729 = slt64(redout_77504, (int64_t) 0);\n                y_76730 = defunc_0_neq_res_76727 && cond_f_res_76729;\n                cond_76731 = defunc_0_neq_res_76728 || y_76730;\n                defunc_0_neq_res_76732 = x_76719 == eta_p_76707;\n                defunc_0_neq_res_76733 = !defunc_0_neq_res_76732;\n                cond_t_res_f_res_76734 = slt64(x_76718, (int64_t) 0);\n                y_76735 = defunc_0_neq_res_76732 && cond_t_res_f_res_76734;\n                cond_t_res_76736 = defunc_0_neq_res_76733 || y_76735;\n                x_76737 = cond_76731 && cond_t_res_76736;\n                if (x_76737) {\n                    defunc_0_op_res_76738 = (int64_t) -1;\n                    defunc_0_op_res_76739 = eta_p_76707;\n                    defunc_0_op_res_76740 = (int64_t) 0;\n                } else {\n                    int64_t x_76720;\n                    int64_t defunc_0_op_res_f_res_76741;\n                    int32_t defunc_0_op_res_f_res_76742;\n                    int64_t defunc_0_op_res_f_res_76743;\n           ",
                                    "         \n                    x_76720 = ((__local int64_t *) color_78691)[i_77507];\n                    if (cond_76731) {\n                        defunc_0_op_res_f_res_76741 = x_76718;\n                        defunc_0_op_res_f_res_76742 = x_76719;\n                        defunc_0_op_res_f_res_76743 = x_76720;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_76744;\n                        int64_t defunc_0_op_res_f_res_f_res_76745;\n                        int64_t defunc_0_op_res_f_res_f_res_76746;\n                        \n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76744 = redout_77505;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76744 = eta_p_76707;\n                        }\n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76745 = redout_77504;\n                            defunc_0_op_res_f_res_f_res_76746 = redout_77506;\n                        } else {\n                            int64_t min_res_76747;\n                            int64_t tmp_76748;\n                            \n                            min_res_76747 = smin64(x_76718, redout_77504);\n                            tmp_76748 = add64(x_76720, redout_77506);\n                            defunc_0_op_res_f_res_f_res_76745 = min_res_76747;\n                            defunc_0_op_res_f_res_f_res_76746 = tmp_76748;\n                        }\n                        defunc_0_op_res_f_res_76741 = defunc_0_op_res_f_res_f_res_76745;\n                        defunc_0_op_res_f_res_76742 = defunc_0_op_res_f_res_f_res_76744;\n                        defunc_0_op_res_f_res_76743 = defunc_0_op_res_f_res_f_res_76746;\n                    }\n                    defunc_0_op_res_76738 = defunc_0_op_res_f_res_76741;\n                    defunc_0_op_res_76739 = defunc_0_op_res_f_res_76742;\n                    defunc_0_op_res_76740 = defu", "nc_0_op_res_f_res_76743;\n                }\n                redout_tmp_78843 = defunc_0_op_res_76738;\n                redout_tmp_78844 = defunc_0_op_res_76739;\n                redout_tmp_78845 = defunc_0_op_res_76740;\n                redout_77504 = redout_tmp_78843;\n                redout_77505 = redout_tmp_78844;\n                redout_77506 = redout_tmp_78845;\n            }\n            x_76715 = redout_77504;\n            x_76716 = redout_77505;\n            x_76717 = redout_77506;\n            acc_76712 = x_76715;\n            acc_76714 = x_76717;\n        } else {\n            acc_76712 = acc_76708;\n            acc_76714 = acc_76710;\n        }\n        mem_77976[(int64_t) 0] = acc_76712;\n        mem_77980[(int64_t) 0] = acc_76714;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77982[i_17] = mem_77976[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77981[i_18] = mem_77980[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78846 = ext_mem_77982[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77984)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78846;\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78847 = ext_mem_77981[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77986)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78847;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76414\n    #undef bytes_77946\n    #undef bytes_77948\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_76767_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_76767(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_76770, int64_t num_whole_tiles_7", "6785, int64_t residual_input_77009, unsigned char cond_77010_bits, int64_t binop_x_77026, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77840, __global unsigned char *mem_77842)\n{\n    bool cond_77010 = cond_77010_bits;\n    \n    #define tile_sizze_76769 (inner_SMJ_intzisegmap_intrablock_76767zitile_sizze_76769)\n    #define bytes_77802 (inner_SMJ_intzisegmap_intrablock_76767zibytes_77802)\n    #define bytes_77804 (inner_SMJ_intzisegmap_intrablock_76767zibytes_77804)\n    \n    volatile __local unsigned char *color_78696_backing_2 = &shared_mem[0];\n    const int64_t color_78696_backing_2_offset = 0 + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78695_backing_1 = &shared_mem[color_78696_backing_2_offset];\n    const int64_t color_78695_backing_1_offset = color_78696_backing_2_offset + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78694_backing_0 = &shared_mem[color_78695_backing_1_offset];\n    const int64_t color_78694_backing_0_offset = color_78695_backing_1_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78966;\n    int32_t tblock_sizze_78969;\n    int32_t wave_sizze_78968;\n    int32_t block_id_78967;\n    int32_t global_tid_78965;\n    int64_t gid_flat_76767;\n    int64_t slice_78971;\n    int64_t ltid_pre_78970;\n    int64_t remnant_78972;\n    int64_t slice_78973;\n    int64_t gid_76766;\n    int64_t remnant_78974;\n    __local unsigned char *color_78694;\n    __local unsigned char *color_78695;\n    __local unsigned char *color_78696;\n    int64_t binop_x_76777;\n    int32_t mem_77786[1];\n    int64_t ltid_flat_76772;\n    int64_t ltid_76771;\n    int64_t gtid_76778;\n    bool cond_76779;\n    int32_t pre_76780",
                                    ";\n    int64_t mem_77790[1];\n    int32_t mem_77794[1];\n    int64_t mem_77798[1];\n    int64_t ltid_flat_76787;\n    int64_t ltid_76786;\n    int64_t gtid_76797;\n    bool cond_76798;\n    int64_t neutral_76799;\n    int32_t neutral_76800;\n    int64_t ext_mem_77822[1];\n    int32_t ext_mem_77821[1];\n    int64_t ext_mem_77820[1];\n    int64_t mem_param_77799[1];\n    int32_t mem_param_77800[1];\n    int64_t mem_param_77801[1];\n    int64_t mem_77832[1];\n    int64_t mem_77836[1];\n    int64_t ext_mem_77838[1];\n    int64_t ext_mem_77837[1];\n    \n    local_tid_78966 = get_local_id(0);\n    tblock_sizze_78969 = get_local_size(0);\n    wave_sizze_78968 = LOCKSTEP_WIDTH;\n    block_id_78967 = get_tblock_id(0);\n    global_tid_78965 = block_id_78967 * tblock_sizze_78969 + local_tid_78966;\n    gid_flat_76767 = sext_i32_i64(block_id_78967);\n    slice_78971 = tile_sizze_76769;\n    ltid_pre_78970 = sext_i32_i64(local_tid_78966);\n    remnant_78972 = sext_i32_i64(local_tid_78966) - ltid_pre_78970;\n    slice_78973 = ldim_76770;\n    gid_76766 = sext_i32_i64(block_id_78967);\n    remnant_78974 = sext_i32_i64(block_id_78967) - gid_76766;\n    color_78694 = (__local unsigned char *) color_78694_backing_0;\n    color_78695 = (__local unsigned char *) color_78695_backing_1;\n    color_78696 = (__local unsigned char *) color_78696_backing_2;\n    binop_x_76777 = gid_76766 * tile_sizze_76769;\n    ltid_flat_76772 = sext_i32_i64(local_tid_78966);\n    ltid_76771 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76778 = ltid_76771 + binop_x_76777;\n    cond_76779 = slt64(gtid_76778, min_res_67698);\n    if (cond_76779) {\n        int64_t slice_76781;\n        int32_t eta_p_76782;\n        \n        slice_76781 = slice_67712 + gtid_76778;\n        eta_p_76782 = ((__global int32_t *) tR_mem_77625)[slice_76781];\n        pre_76780 = eta_p_76782;\n    } else {\n        pre_76780 = 0;\n    }\n    mem_77786[(int64_t) 0] = pre_76780;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76787 = sext_i32_i64(local_tid_78966);\n    ltid_", "76786 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76797 = binop_x_76777 + ltid_76786;\n    cond_76798 = slt64(gtid_76797, min_res_67698);\n    if (cond_76798) {\n        neutral_76799 = (int64_t) -1;\n    } else {\n        neutral_76799 = (int64_t) 0;\n    }\n    if (cond_76798) {\n        int32_t eta_p_76802 = mem_77786[(int64_t) 0];\n        \n        neutral_76800 = eta_p_76802;\n    } else {\n        neutral_76800 = 0;\n    }\n    mem_77790[(int64_t) 0] = neutral_76799;\n    mem_77794[(int64_t) 0] = neutral_76800;\n    mem_77798[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77799[i_3] = mem_77790[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77800[i_4] = mem_77794[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77801[i_5] = mem_77798[i_5];\n    for (int64_t tile_id_76812 = 0; tile_id_76812 < num_whole_tiles_76785; tile_id_76812++) {\n        int64_t binop_x_76911;\n        int64_t ltid_flat_76910;\n        int64_t ltid_76909;\n        int64_t j_76912;\n        bool cond_76916;\n        int64_t pre1d_76919;\n        int64_t pre1d_76917;\n        int32_t pre1d_76918;\n        int64_t mem_77811[1];\n        int32_t mem_77815[1];\n        int64_t mem_77819[1];\n        int64_t ltid_flat_76930;\n        int64_t ltid_76929;\n        int64_t gtid_76932;\n        int64_t acc_76934;\n        int32_t acc_76935;\n        int64_t acc_76936;\n        bool cond_76937;\n        int64_t acc_76938;\n        int32_t acc_76939;\n        int64_t acc_76940;\n        int64_t mem_param_tmp_78975[1];\n        int32_t mem_param_tmp_78976[1];\n        int64_t mem_param_tmp_78977[1];\n        \n        binop_x_76911 = tile_sizze_76769 * tile_id_76812;\n        ltid_flat_76910 = sext_i32_i64(local_tid_78966);\n        ltid_76909 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_76912 = ltid_76909 + binop_x_76911;\n        cond_76916 = slt64(j_76912, j_m_i_67660);\n        p", "re1d_76919 = btoi_bool_i64(cond_76916);\n        if (cond_76916) {\n            int64_t tile_elem_76920;\n            int64_t slice_77487;\n            int32_t tile_elem_76921;\n            \n            tile_elem_76920 = ((__global int64_t *) ext_mem_77720)[j_76912];\n            slice_77487 = slice_68069 + j_76912;\n            tile_elem_76921 = ((__global int32_t *) tS_mem_77626)[slice_77487];\n            pre1d_76917 = tile_elem_76920;\n            pre1d_76918 = tile_elem_76921;\n        } else {\n            pre1d_76917 = (int64_t) 0;\n            pre1d_76918 = 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_76909] = pre1d_76917;\n        ((__local int32_t *) color_78695)[ltid_76909] = pre1d_76918;\n        ((__local int64_t *) color_78694)[ltid_76909] = pre1d_76919;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76930 = sext_i32_i64(local_tid_78966);\n        ltid_76929 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_76932 = binop_x_76777 + ltid_76929;\n        acc_76934 = mem_param_77799[(int64_t) 0];\n        acc_76935 = mem_param_77800[(int64_t) 0];\n        acc_76936 = mem_param_77801[(int64_t) 0];\n        cond_76937 = slt64(gtid_76932, min_res_67698);\n        if (cond_76937) {\n            int32_t eta_p_76933;\n            int64_t x_76941;\n            int32_t x_76942;\n            int64_t x_76943;\n            int64_t redout_77508;\n            int32_t redout_77509;\n            int64_t redout_77510;\n            \n            eta_p_76933 = mem_77786[(int64_t) 0];\n            redout_77508 = acc_76934;\n            redout_77509 = acc_76935;\n            redout_77510 = acc_76936;\n            for (int64_t i_77511 = 0; i_77511 < tile_sizze_76769; i_77511++) {\n                int64_t x_76944;\n                int32_t x_76945;\n                bool defunc_0_neq_res_76953;\n                bool defunc_0_neq_res_76954;\n                bool cond_f_res_76955;\n                bool y_76956;\n                bool cond_76957;\n                bool defunc_0_neq_res_76958;",
                                    "\n                bool defunc_0_neq_res_76959;\n                bool cond_t_res_f_res_76960;\n                bool y_76961;\n                bool cond_t_res_76962;\n                bool x_76963;\n                int64_t defunc_0_op_res_76964;\n                int32_t defunc_0_op_res_76965;\n                int64_t defunc_0_op_res_76966;\n                int64_t redout_tmp_78981;\n                int32_t redout_tmp_78982;\n                int64_t redout_tmp_78983;\n                \n                x_76944 = ((__local int64_t *) color_78696)[i_77511];\n                x_76945 = ((__local int32_t *) color_78695)[i_77511];\n                defunc_0_neq_res_76953 = redout_77509 == eta_p_76933;\n                defunc_0_neq_res_76954 = !defunc_0_neq_res_76953;\n                cond_f_res_76955 = slt64(redout_77508, (int64_t) 0);\n                y_76956 = defunc_0_neq_res_76953 && cond_f_res_76955;\n                cond_76957 = defunc_0_neq_res_76954 || y_76956;\n                defunc_0_neq_res_76958 = x_76945 == eta_p_76933;\n                defunc_0_neq_res_76959 = !defunc_0_neq_res_76958;\n                cond_t_res_f_res_76960 = slt64(x_76944, (int64_t) 0);\n                y_76961 = defunc_0_neq_res_76958 && cond_t_res_f_res_76960;\n                cond_t_res_76962 = defunc_0_neq_res_76959 || y_76961;\n                x_76963 = cond_76957 && cond_t_res_76962;\n                if (x_76963) {\n                    defunc_0_op_res_76964 = (int64_t) -1;\n                    defunc_0_op_res_76965 = eta_p_76933;\n                    defunc_0_op_res_76966 = (int64_t) 0;\n                } else {\n                    int64_t x_76946;\n                    int64_t defunc_0_op_res_f_res_76967;\n                    int32_t defunc_0_op_res_f_res_76968;\n                    int64_t defunc_0_op_res_f_res_76969;\n                    \n                    x_76946 = ((__local int64_t *) color_78694)[i_77511];\n                    if (cond_76957) {\n                        defunc_0_op_res_f_res_76967 = x_76944;\n          ", "              defunc_0_op_res_f_res_76968 = x_76945;\n                        defunc_0_op_res_f_res_76969 = x_76946;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_76970;\n                        int64_t defunc_0_op_res_f_res_f_res_76971;\n                        int64_t defunc_0_op_res_f_res_f_res_76972;\n                        \n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76970 = redout_77509;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76970 = eta_p_76933;\n                        }\n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76971 = redout_77508;\n                            defunc_0_op_res_f_res_f_res_76972 = redout_77510;\n                        } else {\n                            int64_t min_res_76973;\n                            int64_t tmp_76974;\n                            \n                            min_res_76973 = smin64(x_76944, redout_77508);\n                            tmp_76974 = add64(x_76946, redout_77510);\n                            defunc_0_op_res_f_res_f_res_76971 = min_res_76973;\n                            defunc_0_op_res_f_res_f_res_76972 = tmp_76974;\n                        }\n                        defunc_0_op_res_f_res_76967 = defunc_0_op_res_f_res_f_res_76971;\n                        defunc_0_op_res_f_res_76968 = defunc_0_op_res_f_res_f_res_76970;\n                        defunc_0_op_res_f_res_76969 = defunc_0_op_res_f_res_f_res_76972;\n                    }\n                    defunc_0_op_res_76964 = defunc_0_op_res_f_res_76967;\n                    defunc_0_op_res_76965 = defunc_0_op_res_f_res_76968;\n                    defunc_0_op_res_76966 = defunc_0_op_res_f_res_76969;\n                }\n                redout_tmp_78981 = defunc_0_op_res_76964;\n                redout_tmp_78982 = defunc_0_op_res_76965;\n                redout_tmp_78983 = d", "efunc_0_op_res_76966;\n                redout_77508 = redout_tmp_78981;\n                redout_77509 = redout_tmp_78982;\n                redout_77510 = redout_tmp_78983;\n            }\n            x_76941 = redout_77508;\n            x_76942 = redout_77509;\n            x_76943 = redout_77510;\n            acc_76938 = x_76941;\n            acc_76939 = x_76942;\n            acc_76940 = x_76943;\n        } else {\n            acc_76938 = acc_76934;\n            acc_76939 = acc_76935;\n            acc_76940 = acc_76936;\n        }\n        mem_77811[(int64_t) 0] = acc_76938;\n        mem_77815[(int64_t) 0] = acc_76939;\n        mem_77819[(int64_t) 0] = acc_76940;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78975[i_6] = mem_77811[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78976[i_7] = mem_77815[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78977[i_8] = mem_77819[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77799[i_9] = mem_param_tmp_78975[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77800[i_10] = mem_param_tmp_78976[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77801[i_11] = mem_param_tmp_78977[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77822[i_12] = mem_param_77799[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77821[i_13] = mem_param_77800[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77820[i_14] = mem_param_77801[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77010) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77838[i_15] = ext_mem_77822[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77837[i_16] = ext_mem_77820[i_16];\n    } else {\n        int64_t ltid_flat_77012;\n        int64_t ltid_77011;\n        int64_t j_77027;\n        boo",
                                    "l cond_77031;\n        int64_t pre1d_77034;\n        int64_t pre1d_77032;\n        int32_t pre1d_77033;\n        int64_t ltid_flat_77048;\n        int64_t ltid_77047;\n        int64_t gtid_77061;\n        int64_t acc_77063;\n        int64_t acc_77065;\n        bool cond_77066;\n        int64_t acc_77067;\n        int64_t acc_77069;\n        \n        ltid_flat_77012 = sext_i32_i64(local_tid_78966);\n        ltid_77011 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_77027 = ltid_77011 + binop_x_77026;\n        cond_77031 = slt64(j_77027, j_m_i_67660);\n        pre1d_77034 = btoi_bool_i64(cond_77031);\n        if (cond_77031) {\n            int64_t tile_elem_77035;\n            int64_t slice_77486;\n            int32_t tile_elem_77036;\n            \n            tile_elem_77035 = ((__global int64_t *) ext_mem_77720)[j_77027];\n            slice_77486 = slice_68069 + j_77027;\n            tile_elem_77036 = ((__global int32_t *) tS_mem_77626)[slice_77486];\n            pre1d_77032 = tile_elem_77035;\n            pre1d_77033 = tile_elem_77036;\n        } else {\n            pre1d_77032 = (int64_t) 0;\n            pre1d_77033 = 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_77011] = pre1d_77032;\n        ((__local int32_t *) color_78695)[ltid_77011] = pre1d_77033;\n        ((__local int64_t *) color_78694)[ltid_77011] = pre1d_77034;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77048 = sext_i32_i64(local_tid_78966);\n        ltid_77047 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_77061 = binop_x_76777 + ltid_77047;\n        acc_77063 = ext_mem_77822[(int64_t) 0];\n        acc_77065 = ext_mem_77820[(int64_t) 0];\n        cond_77066 = slt64(gtid_77061, min_res_67698);\n        if (cond_77066) {\n            int32_t eta_p_77062;\n            int32_t acc_77064;\n            int64_t x_77070;\n            int32_t x_77071;\n            int64_t x_77072;\n            int64_t redout_77512;\n            int32_t redout_77513;\n            int64_t redout_77514;\n            \n         ", "   eta_p_77062 = mem_77786[(int64_t) 0];\n            acc_77064 = ext_mem_77821[(int64_t) 0];\n            redout_77512 = acc_77063;\n            redout_77513 = acc_77064;\n            redout_77514 = acc_77065;\n            for (int64_t i_77515 = 0; i_77515 < residual_input_77009; i_77515++) {\n                int64_t x_77073;\n                int32_t x_77074;\n                bool defunc_0_neq_res_77082;\n                bool defunc_0_neq_res_77083;\n                bool cond_f_res_77084;\n                bool y_77085;\n                bool cond_77086;\n                bool defunc_0_neq_res_77087;\n                bool defunc_0_neq_res_77088;\n                bool cond_t_res_f_res_77089;\n                bool y_77090;\n                bool cond_t_res_77091;\n                bool x_77092;\n                int64_t defunc_0_op_res_77093;\n                int32_t defunc_0_op_res_77094;\n                int64_t defunc_0_op_res_77095;\n                int64_t redout_tmp_78984;\n                int32_t redout_tmp_78985;\n                int64_t redout_tmp_78986;\n                \n                x_77073 = ((__local int64_t *) color_78696)[i_77515];\n                x_77074 = ((__local int32_t *) color_78695)[i_77515];\n                defunc_0_neq_res_77082 = redout_77513 == eta_p_77062;\n                defunc_0_neq_res_77083 = !defunc_0_neq_res_77082;\n                cond_f_res_77084 = slt64(redout_77512, (int64_t) 0);\n                y_77085 = defunc_0_neq_res_77082 && cond_f_res_77084;\n                cond_77086 = defunc_0_neq_res_77083 || y_77085;\n                defunc_0_neq_res_77087 = x_77074 == eta_p_77062;\n                defunc_0_neq_res_77088 = !defunc_0_neq_res_77087;\n                cond_t_res_f_res_77089 = slt64(x_77073, (int64_t) 0);\n                y_77090 = defunc_0_neq_res_77087 && cond_t_res_f_res_77089;\n                cond_t_res_77091 = defunc_0_neq_res_77088 || y_77090;\n                x_77092 = cond_77086 && cond_t_res_77091;\n                if (x_77092) {\n                   ", " defunc_0_op_res_77093 = (int64_t) -1;\n                    defunc_0_op_res_77094 = eta_p_77062;\n                    defunc_0_op_res_77095 = (int64_t) 0;\n                } else {\n                    int64_t x_77075;\n                    int64_t defunc_0_op_res_f_res_77096;\n                    int32_t defunc_0_op_res_f_res_77097;\n                    int64_t defunc_0_op_res_f_res_77098;\n                    \n                    x_77075 = ((__local int64_t *) color_78694)[i_77515];\n                    if (cond_77086) {\n                        defunc_0_op_res_f_res_77096 = x_77073;\n                        defunc_0_op_res_f_res_77097 = x_77074;\n                        defunc_0_op_res_f_res_77098 = x_77075;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_77099;\n                        int64_t defunc_0_op_res_f_res_f_res_77100;\n                        int64_t defunc_0_op_res_f_res_f_res_77101;\n                        \n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77099 = redout_77513;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77099 = eta_p_77062;\n                        }\n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77100 = redout_77512;\n                            defunc_0_op_res_f_res_f_res_77101 = redout_77514;\n                        } else {\n                            int64_t min_res_77102;\n                            int64_t tmp_77103;\n                            \n                            min_res_77102 = smin64(x_77073, redout_77512);\n                            tmp_77103 = add64(x_77075, redout_77514);\n                            defunc_0_op_res_f_res_f_res_77100 = min_res_77102;\n                            defunc_0_op_res_f_res_f_res_77101 = tmp_77103;\n                        }\n                        defunc_0_op_res_f_res_77096 = defunc_0_op_res_f_res_f_res_7710",
                                    "0;\n                        defunc_0_op_res_f_res_77097 = defunc_0_op_res_f_res_f_res_77099;\n                        defunc_0_op_res_f_res_77098 = defunc_0_op_res_f_res_f_res_77101;\n                    }\n                    defunc_0_op_res_77093 = defunc_0_op_res_f_res_77096;\n                    defunc_0_op_res_77094 = defunc_0_op_res_f_res_77097;\n                    defunc_0_op_res_77095 = defunc_0_op_res_f_res_77098;\n                }\n                redout_tmp_78984 = defunc_0_op_res_77093;\n                redout_tmp_78985 = defunc_0_op_res_77094;\n                redout_tmp_78986 = defunc_0_op_res_77095;\n                redout_77512 = redout_tmp_78984;\n                redout_77513 = redout_tmp_78985;\n                redout_77514 = redout_tmp_78986;\n            }\n            x_77070 = redout_77512;\n            x_77071 = redout_77513;\n            x_77072 = redout_77514;\n            acc_77067 = x_77070;\n            acc_77069 = x_77072;\n        } else {\n            acc_77067 = acc_77063;\n            acc_77069 = acc_77065;\n        }\n        mem_77832[(int64_t) 0] = acc_77067;\n        mem_77836[(int64_t) 0] = acc_77069;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77838[i_17] = mem_77832[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77837[i_18] = mem_77836[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78987 = ext_mem_77838[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77840)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78987;\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78988 = ext_mem_77837[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77842)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = t", "mp_78988;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76769\n    #undef bytes_77802\n    #undef bytes_77804\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_77122_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_77122(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_77125, int64_t num_whole_tiles_77140, int64_t residual_input_77364, unsigned char cond_77365_bits, int64_t binop_x_77381, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77779, __global unsigned char *mem_77781)\n{\n    bool cond_77365 = cond_77365_bits;\n    \n    #define tile_sizze_77124 (inner_SMJ_intzisegmap_intrablock_77122zitile_sizze_77124)\n    #define bytes_77741 (inner_SMJ_intzisegmap_intrablock_77122zibytes_77741)\n    #define bytes_77743 (inner_SMJ_intzisegmap_intrablock_77122zibytes_77743)\n    \n    volatile __local unsigned char *color_78699_backing_2 = &shared_mem[0];\n    const int64_t color_78699_backing_2_offset = 0 + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78698_backing_1 = &shared_mem[color_78699_backing_2_offset];\n    const int64_t color_78698_backing_1_offset = color_78699_backing_2_offset + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78697_backing_0 = &shared_mem[color_78698_backing_1_offset];\n    const int64_t color_78697_backing_0_offset = color_78698_backing_1_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78992;\n    int32_t tblock_sizze_78995;\n    int32_t wave_sizze_78994;\n    int32_t block_id_78993;\n    int32_t global_tid_78991;\n    int64_t gid_flat_77122;\n    int64_t slice_78997;\n    int64_t ltid_pre_7899", "6;\n    int64_t remnant_78998;\n    int64_t slice_78999;\n    int64_t gid_77121;\n    int64_t remnant_79000;\n    __local unsigned char *color_78697;\n    __local unsigned char *color_78698;\n    __local unsigned char *color_78699;\n    int64_t binop_x_77132;\n    int32_t mem_77725[1];\n    int64_t ltid_flat_77127;\n    int64_t ltid_77126;\n    int64_t gtid_77133;\n    bool cond_77134;\n    int32_t pre_77135;\n    int64_t mem_77729[1];\n    int32_t mem_77733[1];\n    int64_t mem_77737[1];\n    int64_t ltid_flat_77142;\n    int64_t ltid_77141;\n    int64_t gtid_77152;\n    bool cond_77153;\n    int64_t neutral_77154;\n    int32_t neutral_77155;\n    int64_t ext_mem_77761[1];\n    int32_t ext_mem_77760[1];\n    int64_t ext_mem_77759[1];\n    int64_t mem_param_77738[1];\n    int32_t mem_param_77739[1];\n    int64_t mem_param_77740[1];\n    int64_t mem_77771[1];\n    int64_t mem_77775[1];\n    int64_t ext_mem_77777[1];\n    int64_t ext_mem_77776[1];\n    \n    local_tid_78992 = get_local_id(0);\n    tblock_sizze_78995 = get_local_size(0);\n    wave_sizze_78994 = LOCKSTEP_WIDTH;\n    block_id_78993 = get_tblock_id(0);\n    global_tid_78991 = block_id_78993 * tblock_sizze_78995 + local_tid_78992;\n    gid_flat_77122 = sext_i32_i64(block_id_78993);\n    slice_78997 = tile_sizze_77124;\n    ltid_pre_78996 = sext_i32_i64(local_tid_78992);\n    remnant_78998 = sext_i32_i64(local_tid_78992) - ltid_pre_78996;\n    slice_78999 = ldim_77125;\n    gid_77121 = sext_i32_i64(block_id_78993);\n    remnant_79000 = sext_i32_i64(block_id_78993) - gid_77121;\n    color_78697 = (__local unsigned char *) color_78697_backing_0;\n    color_78698 = (__local unsigned char *) color_78698_backing_1;\n    color_78699 = (__local unsigned char *) color_78699_backing_2;\n    binop_x_77132 = gid_77121 * tile_sizze_77124;\n    ltid_flat_77127 = sext_i32_i64(local_tid_78992);\n    ltid_77126 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77133 = ltid_77126 + binop_x_77132;\n    cond_77134 = slt64(gtid_77133, min_res_67698);\n    if (cond_77134) {\n ",
                                    "       int64_t slice_77136;\n        int32_t eta_p_77137;\n        \n        slice_77136 = slice_67712 + gtid_77133;\n        eta_p_77137 = ((__global int32_t *) tR_mem_77625)[slice_77136];\n        pre_77135 = eta_p_77137;\n    } else {\n        pre_77135 = 0;\n    }\n    mem_77725[(int64_t) 0] = pre_77135;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_77142 = sext_i32_i64(local_tid_78992);\n    ltid_77141 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77152 = binop_x_77132 + ltid_77141;\n    cond_77153 = slt64(gtid_77152, min_res_67698);\n    if (cond_77153) {\n        neutral_77154 = (int64_t) -1;\n    } else {\n        neutral_77154 = (int64_t) 0;\n    }\n    if (cond_77153) {\n        int32_t eta_p_77157 = mem_77725[(int64_t) 0];\n        \n        neutral_77155 = eta_p_77157;\n    } else {\n        neutral_77155 = 0;\n    }\n    mem_77729[(int64_t) 0] = neutral_77154;\n    mem_77733[(int64_t) 0] = neutral_77155;\n    mem_77737[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77738[i_3] = mem_77729[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77739[i_4] = mem_77733[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77740[i_5] = mem_77737[i_5];\n    for (int64_t tile_id_77167 = 0; tile_id_77167 < num_whole_tiles_77140; tile_id_77167++) {\n        int64_t binop_x_77266;\n        int64_t ltid_flat_77265;\n        int64_t ltid_77264;\n        int64_t j_77267;\n        bool cond_77271;\n        int64_t pre1d_77274;\n        int64_t pre1d_77272;\n        int32_t pre1d_77273;\n        int64_t mem_77750[1];\n        int32_t mem_77754[1];\n        int64_t mem_77758[1];\n        int64_t ltid_flat_77285;\n        int64_t ltid_77284;\n        int64_t gtid_77287;\n        int64_t acc_77289;\n        int32_t acc_77290;\n        int64_t acc_77291;\n        bool cond_77292;\n        int64_t acc_77293;\n        int32_t acc_77294;\n        int64_t acc_77295;\n        int64_t m", "em_param_tmp_79001[1];\n        int32_t mem_param_tmp_79002[1];\n        int64_t mem_param_tmp_79003[1];\n        \n        binop_x_77266 = tile_sizze_77124 * tile_id_77167;\n        ltid_flat_77265 = sext_i32_i64(local_tid_78992);\n        ltid_77264 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77267 = ltid_77264 + binop_x_77266;\n        cond_77271 = slt64(j_77267, j_m_i_67660);\n        pre1d_77274 = btoi_bool_i64(cond_77271);\n        if (cond_77271) {\n            int64_t tile_elem_77275;\n            int64_t slice_77491;\n            int32_t tile_elem_77276;\n            \n            tile_elem_77275 = ((__global int64_t *) ext_mem_77720)[j_77267];\n            slice_77491 = slice_68069 + j_77267;\n            tile_elem_77276 = ((__global int32_t *) tS_mem_77626)[slice_77491];\n            pre1d_77272 = tile_elem_77275;\n            pre1d_77273 = tile_elem_77276;\n        } else {\n            pre1d_77272 = (int64_t) 0;\n            pre1d_77273 = 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77264] = pre1d_77272;\n        ((__local int32_t *) color_78698)[ltid_77264] = pre1d_77273;\n        ((__local int64_t *) color_78697)[ltid_77264] = pre1d_77274;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77285 = sext_i32_i64(local_tid_78992);\n        ltid_77284 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77287 = binop_x_77132 + ltid_77284;\n        acc_77289 = mem_param_77738[(int64_t) 0];\n        acc_77290 = mem_param_77739[(int64_t) 0];\n        acc_77291 = mem_param_77740[(int64_t) 0];\n        cond_77292 = slt64(gtid_77287, min_res_67698);\n        if (cond_77292) {\n            int32_t eta_p_77288;\n            int64_t x_77296;\n            int32_t x_77297;\n            int64_t x_77298;\n            int64_t redout_77516;\n            int32_t redout_77517;\n            int64_t redout_77518;\n            \n            eta_p_77288 = mem_77725[(int64_t) 0];\n            redout_77516 = acc_77289;\n            redout_77517 = acc_77290;\n            redout_775", "18 = acc_77291;\n            for (int64_t i_77519 = 0; i_77519 < tile_sizze_77124; i_77519++) {\n                int64_t x_77299;\n                int32_t x_77300;\n                bool defunc_0_neq_res_77308;\n                bool defunc_0_neq_res_77309;\n                bool cond_f_res_77310;\n                bool y_77311;\n                bool cond_77312;\n                bool defunc_0_neq_res_77313;\n                bool defunc_0_neq_res_77314;\n                bool cond_t_res_f_res_77315;\n                bool y_77316;\n                bool cond_t_res_77317;\n                bool x_77318;\n                int64_t defunc_0_op_res_77319;\n                int32_t defunc_0_op_res_77320;\n                int64_t defunc_0_op_res_77321;\n                int64_t redout_tmp_79007;\n                int32_t redout_tmp_79008;\n                int64_t redout_tmp_79009;\n                \n                x_77299 = ((__local int64_t *) color_78699)[i_77519];\n                x_77300 = ((__local int32_t *) color_78698)[i_77519];\n                defunc_0_neq_res_77308 = redout_77517 == eta_p_77288;\n                defunc_0_neq_res_77309 = !defunc_0_neq_res_77308;\n                cond_f_res_77310 = slt64(redout_77516, (int64_t) 0);\n                y_77311 = defunc_0_neq_res_77308 && cond_f_res_77310;\n                cond_77312 = defunc_0_neq_res_77309 || y_77311;\n                defunc_0_neq_res_77313 = x_77300 == eta_p_77288;\n                defunc_0_neq_res_77314 = !defunc_0_neq_res_77313;\n                cond_t_res_f_res_77315 = slt64(x_77299, (int64_t) 0);\n                y_77316 = defunc_0_neq_res_77313 && cond_t_res_f_res_77315;\n                cond_t_res_77317 = defunc_0_neq_res_77314 || y_77316;\n                x_77318 = cond_77312 && cond_t_res_77317;\n                if (x_77318) {\n                    defunc_0_op_res_77319 = (int64_t) -1;\n                    defunc_0_op_res_77320 = eta_p_77288;\n                    defunc_0_op_res_77321 = (int64_t) 0;\n                } else {\n                 ",
                                    "   int64_t x_77301;\n                    int64_t defunc_0_op_res_f_res_77322;\n                    int32_t defunc_0_op_res_f_res_77323;\n                    int64_t defunc_0_op_res_f_res_77324;\n                    \n                    x_77301 = ((__local int64_t *) color_78697)[i_77519];\n                    if (cond_77312) {\n                        defunc_0_op_res_f_res_77322 = x_77299;\n                        defunc_0_op_res_f_res_77323 = x_77300;\n                        defunc_0_op_res_f_res_77324 = x_77301;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_77325;\n                        int64_t defunc_0_op_res_f_res_f_res_77326;\n                        int64_t defunc_0_op_res_f_res_f_res_77327;\n                        \n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77325 = redout_77517;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77325 = eta_p_77288;\n                        }\n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77326 = redout_77516;\n                            defunc_0_op_res_f_res_f_res_77327 = redout_77518;\n                        } else {\n                            int64_t min_res_77328;\n                            int64_t tmp_77329;\n                            \n                            min_res_77328 = smin64(x_77299, redout_77516);\n                            tmp_77329 = add64(x_77301, redout_77518);\n                            defunc_0_op_res_f_res_f_res_77326 = min_res_77328;\n                            defunc_0_op_res_f_res_f_res_77327 = tmp_77329;\n                        }\n                        defunc_0_op_res_f_res_77322 = defunc_0_op_res_f_res_f_res_77326;\n                        defunc_0_op_res_f_res_77323 = defunc_0_op_res_f_res_f_res_77325;\n                        defunc_0_op_res_f_res_77324 = defunc_0_op_res_f_res_f_res_77327;\n              ", "      }\n                    defunc_0_op_res_77319 = defunc_0_op_res_f_res_77322;\n                    defunc_0_op_res_77320 = defunc_0_op_res_f_res_77323;\n                    defunc_0_op_res_77321 = defunc_0_op_res_f_res_77324;\n                }\n                redout_tmp_79007 = defunc_0_op_res_77319;\n                redout_tmp_79008 = defunc_0_op_res_77320;\n                redout_tmp_79009 = defunc_0_op_res_77321;\n                redout_77516 = redout_tmp_79007;\n                redout_77517 = redout_tmp_79008;\n                redout_77518 = redout_tmp_79009;\n            }\n            x_77296 = redout_77516;\n            x_77297 = redout_77517;\n            x_77298 = redout_77518;\n            acc_77293 = x_77296;\n            acc_77294 = x_77297;\n            acc_77295 = x_77298;\n        } else {\n            acc_77293 = acc_77289;\n            acc_77294 = acc_77290;\n            acc_77295 = acc_77291;\n        }\n        mem_77750[(int64_t) 0] = acc_77293;\n        mem_77754[(int64_t) 0] = acc_77294;\n        mem_77758[(int64_t) 0] = acc_77295;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_79001[i_6] = mem_77750[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_79002[i_7] = mem_77754[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_79003[i_8] = mem_77758[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77738[i_9] = mem_param_tmp_79001[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77739[i_10] = mem_param_tmp_79002[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77740[i_11] = mem_param_tmp_79003[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77761[i_12] = mem_param_77738[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77760[i_13] = mem_param_77739[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77759[i_14] = ", "mem_param_77740[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77365) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77777[i_15] = ext_mem_77761[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77776[i_16] = ext_mem_77759[i_16];\n    } else {\n        int64_t ltid_flat_77367;\n        int64_t ltid_77366;\n        int64_t j_77382;\n        bool cond_77386;\n        int64_t pre1d_77389;\n        int64_t pre1d_77387;\n        int32_t pre1d_77388;\n        int64_t ltid_flat_77403;\n        int64_t ltid_77402;\n        int64_t gtid_77416;\n        int64_t acc_77418;\n        int64_t acc_77420;\n        bool cond_77421;\n        int64_t acc_77422;\n        int64_t acc_77424;\n        \n        ltid_flat_77367 = sext_i32_i64(local_tid_78992);\n        ltid_77366 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77382 = ltid_77366 + binop_x_77381;\n        cond_77386 = slt64(j_77382, j_m_i_67660);\n        pre1d_77389 = btoi_bool_i64(cond_77386);\n        if (cond_77386) {\n            int64_t tile_elem_77390;\n            int64_t slice_77490;\n            int32_t tile_elem_77391;\n            \n            tile_elem_77390 = ((__global int64_t *) ext_mem_77720)[j_77382];\n            slice_77490 = slice_68069 + j_77382;\n            tile_elem_77391 = ((__global int32_t *) tS_mem_77626)[slice_77490];\n            pre1d_77387 = tile_elem_77390;\n            pre1d_77388 = tile_elem_77391;\n        } else {\n            pre1d_77387 = (int64_t) 0;\n            pre1d_77388 = 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77366] = pre1d_77387;\n        ((__local int32_t *) color_78698)[ltid_77366] = pre1d_77388;\n        ((__local int64_t *) color_78697)[ltid_77366] = pre1d_77389;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77403 = sext_i32_i64(local_tid_78992);\n        ltid_77402 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77416 = binop_x_77132 + ltid_77402;\n        acc_77418 = ext_mem_77761[(int64_t) 0];\n       ",
                                    " acc_77420 = ext_mem_77759[(int64_t) 0];\n        cond_77421 = slt64(gtid_77416, min_res_67698);\n        if (cond_77421) {\n            int32_t eta_p_77417;\n            int32_t acc_77419;\n            int64_t x_77425;\n            int32_t x_77426;\n            int64_t x_77427;\n            int64_t redout_77520;\n            int32_t redout_77521;\n            int64_t redout_77522;\n            \n            eta_p_77417 = mem_77725[(int64_t) 0];\n            acc_77419 = ext_mem_77760[(int64_t) 0];\n            redout_77520 = acc_77418;\n            redout_77521 = acc_77419;\n            redout_77522 = acc_77420;\n            for (int64_t i_77523 = 0; i_77523 < residual_input_77364; i_77523++) {\n                int64_t x_77428;\n                int32_t x_77429;\n                bool defunc_0_neq_res_77437;\n                bool defunc_0_neq_res_77438;\n                bool cond_f_res_77439;\n                bool y_77440;\n                bool cond_77441;\n                bool defunc_0_neq_res_77442;\n                bool defunc_0_neq_res_77443;\n                bool cond_t_res_f_res_77444;\n                bool y_77445;\n                bool cond_t_res_77446;\n                bool x_77447;\n                int64_t defunc_0_op_res_77448;\n                int32_t defunc_0_op_res_77449;\n                int64_t defunc_0_op_res_77450;\n                int64_t redout_tmp_79010;\n                int32_t redout_tmp_79011;\n                int64_t redout_tmp_79012;\n                \n                x_77428 = ((__local int64_t *) color_78699)[i_77523];\n                x_77429 = ((__local int32_t *) color_78698)[i_77523];\n                defunc_0_neq_res_77437 = redout_77521 == eta_p_77417;\n                defunc_0_neq_res_77438 = !defunc_0_neq_res_77437;\n                cond_f_res_77439 = slt64(redout_77520, (int64_t) 0);\n                y_77440 = defunc_0_neq_res_77437 && cond_f_res_77439;\n                cond_77441 = defunc_0_neq_res_77438 || y_77440;\n                defunc_0_neq_res_77442 = x_77429 == eta_p_", "77417;\n                defunc_0_neq_res_77443 = !defunc_0_neq_res_77442;\n                cond_t_res_f_res_77444 = slt64(x_77428, (int64_t) 0);\n                y_77445 = defunc_0_neq_res_77442 && cond_t_res_f_res_77444;\n                cond_t_res_77446 = defunc_0_neq_res_77443 || y_77445;\n                x_77447 = cond_77441 && cond_t_res_77446;\n                if (x_77447) {\n                    defunc_0_op_res_77448 = (int64_t) -1;\n                    defunc_0_op_res_77449 = eta_p_77417;\n                    defunc_0_op_res_77450 = (int64_t) 0;\n                } else {\n                    int64_t x_77430;\n                    int64_t defunc_0_op_res_f_res_77451;\n                    int32_t defunc_0_op_res_f_res_77452;\n                    int64_t defunc_0_op_res_f_res_77453;\n                    \n                    x_77430 = ((__local int64_t *) color_78697)[i_77523];\n                    if (cond_77441) {\n                        defunc_0_op_res_f_res_77451 = x_77428;\n                        defunc_0_op_res_f_res_77452 = x_77429;\n                        defunc_0_op_res_f_res_77453 = x_77430;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_77454;\n                        int64_t defunc_0_op_res_f_res_f_res_77455;\n                        int64_t defunc_0_op_res_f_res_f_res_77456;\n                        \n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77454 = redout_77521;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77454 = eta_p_77417;\n                        }\n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77455 = redout_77520;\n                            defunc_0_op_res_f_res_f_res_77456 = redout_77522;\n                        } else {\n                            int64_t min_res_77457;\n                            int64_t tmp_77458;\n                            \n              ", "              min_res_77457 = smin64(x_77428, redout_77520);\n                            tmp_77458 = add64(x_77430, redout_77522);\n                            defunc_0_op_res_f_res_f_res_77455 = min_res_77457;\n                            defunc_0_op_res_f_res_f_res_77456 = tmp_77458;\n                        }\n                        defunc_0_op_res_f_res_77451 = defunc_0_op_res_f_res_f_res_77455;\n                        defunc_0_op_res_f_res_77452 = defunc_0_op_res_f_res_f_res_77454;\n                        defunc_0_op_res_f_res_77453 = defunc_0_op_res_f_res_f_res_77456;\n                    }\n                    defunc_0_op_res_77448 = defunc_0_op_res_f_res_77451;\n                    defunc_0_op_res_77449 = defunc_0_op_res_f_res_77452;\n                    defunc_0_op_res_77450 = defunc_0_op_res_f_res_77453;\n                }\n                redout_tmp_79010 = defunc_0_op_res_77448;\n                redout_tmp_79011 = defunc_0_op_res_77449;\n                redout_tmp_79012 = defunc_0_op_res_77450;\n                redout_77520 = redout_tmp_79010;\n                redout_77521 = redout_tmp_79011;\n                redout_77522 = redout_tmp_79012;\n            }\n            x_77425 = redout_77520;\n            x_77426 = redout_77521;\n            x_77427 = redout_77522;\n            acc_77422 = x_77425;\n            acc_77424 = x_77427;\n        } else {\n            acc_77422 = acc_77418;\n            acc_77424 = acc_77420;\n        }\n        mem_77771[(int64_t) 0] = acc_77422;\n        mem_77775[(int64_t) 0] = acc_77424;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77777[i_17] = mem_77771[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77776[i_18] = mem_77775[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79013 = ext_mem_77777[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77779)[sext_i",
                                    "32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79013;\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79014 = ext_mem_77776[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77781)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79014;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_77124\n    #undef bytes_77741\n    #undef bytes_77743\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegscan_72035_dim1, 1, 1)\nvoid inner_SMJ_intzisegscan_72035(__global int *global_failure, int64_t nR_44377, int64_t num_tblocks_72032, int64_t num_virt_blocks_79082, int64_t num_virt_threads_79083, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *status_flags_mem_79084, __global unsigned char *aggregates_mem_79106, __global unsigned char *incprefixes_mem_79108, __global unsigned char *global_dynid_mem_79110)\n{\n    #define segscan_tblock_sizze_72030 (inner_SMJ_intzisegscan_72035zisegscan_tblock_sizze_72030)\n    #define chunk_sizze_79081 (inner_SMJ_intzisegscan_72035zichunk_sizze_79081)\n    \n    volatile __local unsigned char *local_mem_79120_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79120_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72030), chunk_sizze_79081 * segscan_tblock_sizze_72030 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72030), chunk_sizze_79081 * segscan_tblock_sizze_72030 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79113;\n    int32_t tblock_sizze_79116;\n    int32_t wave_sizze_79115;\n    int32_t block_id_79114;\n    int32_t global_tid_79112;\n    int64_t phys_tid_72035;\n    int32_t chunk_sizze_32b_79117;\n    int64_t byte_offsets_79118;\n", "    int64_t warp_byte_offset_79119;\n    __local unsigned char *local_mem_79120;\n    int64_t trans_arr_len_79121;\n    int64_t phys_block_id_79127;\n    int64_t virtloop_bound_79128;\n    \n    local_tid_79113 = get_local_id(0);\n    tblock_sizze_79116 = get_local_size(0);\n    wave_sizze_79115 = LOCKSTEP_WIDTH;\n    block_id_79114 = get_tblock_id(0);\n    global_tid_79112 = block_id_79114 * tblock_sizze_79116 + local_tid_79113;\n    phys_tid_72035 = sext_i32_i64(global_tid_79112);\n    chunk_sizze_32b_79117 = sext_i64_i32(chunk_sizze_79081);\n    byte_offsets_79118 = segscan_tblock_sizze_72030 * (int64_t) 8;\n    warp_byte_offset_79119 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79120 = (__local unsigned char *) local_mem_79120_backing_0;\n    trans_arr_len_79121 = chunk_sizze_79081 * segscan_tblock_sizze_72030;\n    phys_block_id_79127 = get_tblock_id(0);\n    virtloop_bound_79128 = sdiv_up64(num_virt_blocks_79082 - phys_block_id_79127, num_tblocks_72032);\n    for (int64_t virtloop_i_79129 = 0; virtloop_i_79129 < virtloop_bound_79128; virtloop_i_79129++) {\n        int64_t dynamic_id_79130;\n        int64_t block_offset_79131;\n        int64_t sgm_idx_79132;\n        int32_t boundary_79133;\n        int32_t segsizze_compact_79134;\n        int64_t private_mem_79135[chunk_sizze_79081];\n        int64_t thd_offset_79137;\n        int64_t acc_79153;\n        int64_t prefix_79163;\n        bool block_new_sgm_79164;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79113 == 0) {\n                dynamic_id_79130 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79110)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79120)[(int64_t) 0] = dynamic_id_79130;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if ", "(dynamic_id_79130 == num_virt_blocks_79082 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79110)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79130 = ((__local int32_t *) local_mem_79120)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79131 = dynamic_id_79130 * chunk_sizze_79081 * segscan_tblock_sizze_72030;\n        sgm_idx_79132 = smod64(block_offset_79131, nR_44377);\n        boundary_79133 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_72030, nR_44377 - sgm_idx_79132));\n        segsizze_compact_79134 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_72030, nR_44377));\n        thd_offset_79137 = block_offset_79131 + sext_i32_i64(local_tid_79113);\n        // Load and map\n        {\n            for (int64_t i_79138 = 0; i_79138 < chunk_sizze_79081; i_79138++) {\n                int64_t virt_tid_79139 = thd_offset_79137 + i_79138 * segscan_tblock_sizze_72030;\n                int64_t slice_79140 = nR_44377;\n                int64_t gtid_72034 = virt_tid_79139;\n                int64_t remnant_79141 = virt_tid_79139 - gtid_72034;\n                \n                if (slt64(virt_tid_79139, nR_44377)) {\n                    int64_t eta_p_68120 = ((__global int64_t *) ext_mem_78096)[gtid_72034];\n                    bool lifted_lambda_res_68121 = slt64((int64_t) 0, eta_p_68120);\n                    int64_t defunc_0_f_res_68122 = btoi_bool_i64(lifted_lambda_res_68121);\n                    \n                    ((__global int64_t *) mem_78101)[gtid_72034] = defunc_0_f_res_68122;\n                    private_mem_79135[i_79138] = defunc_0_f_res_68122;\n                } else {\n                    private_mem_79135[i_79138] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79142 = 0; i_79142 < ch",
                                    "unk_sizze_79081; i_79142++) {\n                int64_t sharedIdx_79143 = sext_i32_i64(local_tid_79113) + i_79142 * segscan_tblock_sizze_72030;\n                int64_t tmp_79144 = private_mem_79135[i_79142];\n                \n                ((__local int64_t *) local_mem_79120)[sharedIdx_79143] = tmp_79144;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79145 = 0; i_79145 < chunk_sizze_79081; i_79145++) {\n                int64_t sharedIdx_79146 = sext_i32_i64(local_tid_79113) * chunk_sizze_79081 + i_79145;\n                int64_t tmp_79147 = ((__local int64_t *) local_mem_79120)[sharedIdx_79146];\n                \n                private_mem_79135[i_79145] = tmp_79147;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79148 = 0; i_79148 < chunk_sizze_79081 - (int64_t) 1; i_79148++) {\n                int64_t eta_p_67831;\n                int64_t eta_p_67832;\n                \n                eta_p_67831 = private_mem_79135[i_79148];\n                eta_p_67832 = private_mem_79135[i_79148 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_67833 = add64(eta_p_67831, eta_p_67832);\n                \n                private_mem_79135[i_79148 + (int64_t) 1] = defunc_0_op_res_67833;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79149 = private_mem_79135[chunk_sizze_79081 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = tmp_79149;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79150;\n            int64_t eta_p_79151;\n            int64_t eta_p_79154;\n            int64_t eta_p_79155;\n            bool ltid_in_bounds_79157 = slt64(sext_i32_i64(local_tid_79113), num_virt_threads_79083);\n            int32_t skip_threads_79158;\n            \n            // ", "read input for in-block scan\n            {\n                if (ltid_in_bounds_79157) {\n                    eta_p_79151 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                    if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                        eta_p_79150 = eta_p_79151;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79158 = 1;\n                while (slt32(skip_threads_79158, 32)) {\n                    bool thread_active_79159 = sle32(skip_threads_79158, local_tid_79113 - squot32(local_tid_79113, 32) * 32) && ltid_in_bounds_79157;\n                    \n                    if (thread_active_79159) {\n                        // read operands\n                        {\n                            eta_p_79150 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79158)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79159) {\n                            int64_t defunc_0_op_res_79152 = add64(eta_p_79150, eta_p_79151);\n                            \n                            eta_p_79150 = defunc_0_op_res_79152;\n                        }\n                    }\n                    if (sle32(wave_sizze_79115, skip_threads_79158)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79159) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79150;\n                            eta_p_79151 = eta_p_79150;\n                        }\n                    }\n                    if (sle32(wave_sizze_79115, skip_threads_79158)) {\n                        barrier(CLK_LOCAL_MEM", "_FENCE);\n                    }\n                    skip_threads_79158 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 31 && ltid_in_bounds_79157) {\n                    ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(squot32(local_tid_79113, 32))] = eta_p_79150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79160;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157) {\n                        eta_p_79155 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                        if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                            eta_p_79154 = eta_p_79155;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79160 = 1;\n                    while (slt32(skip_threads_79160, 32)) {\n                        bool thread_active_79161 = sle32(skip_threads_79160, local_tid_79113 - squot32(local_tid_79113, 32) * 32) && (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157);\n                        \n                        if (thread_active_79161) {\n                            // read operands\n                            {\n                                eta_p_79154 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79160)];\n                            }\n                        }\n                        // perform operation\n                 ",
                                    "       {\n                            if (thread_active_79161) {\n                                int64_t defunc_0_op_res_79156 = add64(eta_p_79154, eta_p_79155);\n                                \n                                eta_p_79154 = defunc_0_op_res_79156;\n                            }\n                        }\n                        if (sle32(wave_sizze_79115, skip_threads_79160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79161) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79154;\n                                eta_p_79155 = eta_p_79154;\n                            }\n                        }\n                        if (sle32(wave_sizze_79115, skip_threads_79160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79160 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79162 = squot32(local_tid_79113, 32) == 0 || !ltid_in_bounds_79157;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79162) {\n                        eta_p_79151 = eta_p_79150;\n                        eta_p_79150 = ((__local int64_t *) local_mem_79120)[sext_i32_i64(squot32(local_tid_79113, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79162) {\n                        int64_t defunc_0_op_res_79152 = add64(eta_p_79150, eta_p_79151);\n                        \n                        eta_p_79150 = defunc_0_op_res_79152;\n                    }\n                }\n                // w", "rite final result\n                {\n                    if (!no_carry_in_79162) {\n                        ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79150;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157) {\n                    ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79151;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79113 == 0) {\n                acc_79153 = ((__local int64_t *) local_mem_79120)[segscan_tblock_sizze_72030 - (int64_t) 1];\n            } else {\n                acc_79153 = ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79163 = (int64_t) 0;\n        block_new_sgm_79164 = sgm_idx_79132 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79164 && local_tid_79113 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79130] = acc_79153;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79130] = (int8_t) 2;\n                acc_79153 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79164 && slt32(local_tid_79113, wave_sizze_79115)) {\n                if (local_tid_79113 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79106)[dynamic_id_79130] = acc_79153;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79130] = (int8_t) 1;\n                    \n                    int8_t tmp_79165 = ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_791", "30 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79120)[(int64_t) 0] = tmp_79165;\n                }\n                mem_fence_local();\n                \n                int8_t status_79166 = ((__local int8_t *) local_mem_79120)[(int64_t) 0];\n                \n                if (status_79166 == (int8_t) 2) {\n                    if (local_tid_79113 == 0) {\n                        prefix_79163 = ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79130 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79167 = sext_i64_i32(dynamic_id_79130 - sext_i32_i64(wave_sizze_79115));\n                    \n                    while (slt32(wave_sizze_79115 * -1, readOffset_79167)) {\n                        int32_t read_i_79168 = readOffset_79167 + local_tid_79113;\n                        int64_t aggr_79169 = (int64_t) 0;\n                        int8_t flag_79170 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79168)) {\n                            flag_79170 = ((volatile __global int8_t *) status_flags_mem_79084)[sext_i32_i64(read_i_79168)];\n                            if (flag_79170 == (int8_t) 2) {\n                                aggr_79169 = ((volatile __global int64_t *) incprefixes_mem_79108)[sext_i32_i64(read_i_79168)];\n                            } else if (flag_79170 == (int8_t) 1) {\n                                aggr_79169 = ((volatile __global int64_t *) aggregates_mem_79106)[sext_i32_i64(read_i_79168)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)] = aggr_79169;\n                        ((__local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = flag_79170;\n                        flag_79170 = ((__local int8_t *) local_mem_79120)[sext_i32_i64(wave_sizze_79115) - (int64_t) 1];\n                        i",
                                    "f (slt8(flag_79170, (int8_t) 2)) {\n                            int8_t flg_x_79174;\n                            int8_t flg_y_79175;\n                            int64_t eta_p_79171;\n                            int64_t eta_p_79172;\n                            int32_t skip_threads_79176;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79175 = ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                                eta_p_79172 = ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)];\n                                if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                                    eta_p_79171 = eta_p_79172;\n                                    flg_x_79174 = flg_y_79175;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79176 = 1;\n                                while (slt32(skip_threads_79176, 32)) {\n                                    if (sle32(skip_threads_79176, local_tid_79113 - squot32(local_tid_79113, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79174 = ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79176)];\n                                            eta_p_79171 = ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + (sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79176))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79175 == (int8_t) 2 || flg_y_791", "75 == (int8_t) 0) {\n                                                flg_x_79174 = flg_y_79175;\n                                                eta_p_79171 = eta_p_79172;\n                                            } else {\n                                                int64_t defunc_0_op_res_79173 = add64(eta_p_79171, eta_p_79172);\n                                                \n                                                eta_p_79171 = defunc_0_op_res_79173;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = flg_x_79174;\n                                            flg_y_79175 = flg_x_79174;\n                                            ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)] = eta_p_79171;\n                                            eta_p_79172 = eta_p_79171;\n                                        }\n                                    }\n                                    skip_threads_79176 *= 2;\n                                }\n                            }\n                        }\n                        flag_79170 = ((__local int8_t *) local_mem_79120)[sext_i32_i64(wave_sizze_79115) - (int64_t) 1];\n                        aggr_79169 = ((__local int64_t *) local_mem_79120)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79115) - (int64_t) 1)];\n                        if (flag_79170 == (int8_t) 2) {\n                            readOffset_79167 = wave_sizze_79115 * -1;\n                        } else if (flag_79170 == (int8_t) 1) {\n                            readOffset_79167 -= wave_sizze_79115;\n                        }\n                        if (slt8((int8_t) 0, flag_79170)) {\n                            int64_t eta_p_79177 = aggr_79169;\n                      ", "      int64_t eta_p_79178 = prefix_79163;\n                            int64_t defunc_0_op_res_79179 = add64(eta_p_79177, eta_p_79178);\n                            \n                            prefix_79163 = defunc_0_op_res_79179;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79113 == 0) {\n                    if (boundary_79133 == sext_i64_i32(segscan_tblock_sizze_72030 * chunk_sizze_79081)) {\n                        int64_t eta_p_79180 = prefix_79163;\n                        int64_t eta_p_79181 = acc_79153;\n                        int64_t defunc_0_op_res_79182 = add64(eta_p_79180, eta_p_79181);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79130] = defunc_0_op_res_79182;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79130] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79120)[(int64_t) 4] = prefix_79163;\n                    acc_79153 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79130 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79163 = ((__local int64_t *) local_mem_79120)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79183;\n            int64_t eta_p_79184;\n            int64_t eta_p_79186 = prefix_79163;\n            int64_t eta_p_79187 = acc_79153;\n            \n            if (slt32(local_tid_79113 * chunk_sizze_32b_79117, boundary_79133) && !block_new_sgm_79164) {\n                int64_t defunc_0_op_res_79188 = add64(eta_p_79186, eta_p_79187);\n                \n                eta_p_79183 = defunc_0_op_res_79188;\n            } else {\n                eta_p_79183 = acc_79153;\n            }\n            \n        ",
                                    "    int32_t stopping_point_79189 = segsizze_compact_79134 - srem32(local_tid_79113 * chunk_sizze_32b_79117 - 1 + segsizze_compact_79134 - boundary_79133, segsizze_compact_79134);\n            \n            for (int64_t i_79190 = 0; i_79190 < chunk_sizze_79081; i_79190++) {\n                if (slt32(sext_i64_i32(i_79190), stopping_point_79189 - 1)) {\n                    eta_p_79184 = private_mem_79135[i_79190];\n                    \n                    int64_t defunc_0_op_res_79185 = add64(eta_p_79183, eta_p_79184);\n                    \n                    private_mem_79135[i_79190] = defunc_0_op_res_79185;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79191 = 0; i_79191 < chunk_sizze_79081; i_79191++) {\n                int64_t sharedIdx_79192 = sext_i32_i64(local_tid_79113) * chunk_sizze_79081 + i_79191;\n                int64_t tmp_79193 = private_mem_79135[i_79191];\n                \n                ((__local int64_t *) local_mem_79120)[sharedIdx_79192] = tmp_79193;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79194 = 0; i_79194 < chunk_sizze_79081; i_79194++) {\n                int64_t flat_idx_79195 = thd_offset_79137 + i_79194 * segscan_tblock_sizze_72030;\n                int64_t slice_79196 = nR_44377;\n                int64_t gtid_72034 = flat_idx_79195;\n                int64_t remnant_79197 = flat_idx_79195 - gtid_72034;\n                \n                if (slt64(flat_idx_79195, nR_44377)) {\n                    int64_t tmp_79198 = ((__local int64_t *) local_mem_79120)[flat_idx_79195 - block_offset_79131];\n                    \n                    ((__global int64_t *) mem_78099)[gtid_72034] = tmp_79198;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_72030\n    #undef chunk_sizze_79081\n}\nFUTHARK_KERNEL_SIZED(inner_", "SMJ_intzisegscan_72051_dim1, 1, 1)\nvoid inner_SMJ_intzisegscan_72051(__global int *global_failure, int64_t m_67844, int64_t num_tblocks_72048, int64_t num_virt_blocks_79219, int64_t num_virt_threads_79220, __global unsigned char *mem_78103, __global unsigned char *mem_78113, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *status_flags_mem_79221, __global unsigned char *aggregates_mem_79223, __global unsigned char *incprefixes_mem_79225, __global unsigned char *aggregates_mem_79227, __global unsigned char *incprefixes_mem_79229, __global unsigned char *global_dynid_mem_79231)\n{\n    #define segscan_tblock_sizze_72046 (inner_SMJ_intzisegscan_72051zisegscan_tblock_sizze_72046)\n    #define chunk_sizze_79218 (inner_SMJ_intzisegscan_72051zichunk_sizze_79218)\n    \n    volatile __local unsigned char *local_mem_79243_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79243_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72046, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72046), smax64(chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72046, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72046), smax64(chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79234;\n    int32_t tblock_sizze_79237;\n    int32_t wave_sizze_79236;\n    int32_t block_id_79235;\n    int32_t global_tid_79233;\n    int64_t phys_tid_72051;\n    int32_t chunk_sizze_32b_79238;\n    int64_t byte_offsets_79239;\n    int64_t byte_offsets_79240;\n    int64_t warp_byte_offset_79241;\n    int64_t warp_byte_offset_79242;\n    __local uns", "igned char *local_mem_79243;\n    int64_t trans_arr_len_79244;\n    int64_t phys_block_id_79253;\n    int64_t virtloop_bound_79254;\n    \n    local_tid_79234 = get_local_id(0);\n    tblock_sizze_79237 = get_local_size(0);\n    wave_sizze_79236 = LOCKSTEP_WIDTH;\n    block_id_79235 = get_tblock_id(0);\n    global_tid_79233 = block_id_79235 * tblock_sizze_79237 + local_tid_79234;\n    phys_tid_72051 = sext_i32_i64(global_tid_79233);\n    chunk_sizze_32b_79238 = sext_i64_i32(chunk_sizze_79218);\n    byte_offsets_79239 = segscan_tblock_sizze_72046 * (int64_t) 8;\n    byte_offsets_79240 = sdiv_up64(byte_offsets_79239, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_72046 * (int64_t) 8;\n    warp_byte_offset_79241 = (int64_t) 288;\n    warp_byte_offset_79242 = sdiv_up64(warp_byte_offset_79241, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79243 = (__local unsigned char *) local_mem_79243_backing_0;\n    trans_arr_len_79244 = chunk_sizze_79218 * segscan_tblock_sizze_72046;\n    phys_block_id_79253 = get_tblock_id(0);\n    virtloop_bound_79254 = sdiv_up64(num_virt_blocks_79219 - phys_block_id_79253, num_tblocks_72048);\n    for (int64_t virtloop_i_79255 = 0; virtloop_i_79255 < virtloop_bound_79254; virtloop_i_79255++) {\n        int64_t dynamic_id_79256;\n        int64_t block_offset_79257;\n        int64_t sgm_idx_79258;\n        int32_t boundary_79259;\n        int32_t segsizze_compact_79260;\n        int64_t private_mem_79261[chunk_sizze_79218];\n        int64_t private_mem_79263[chunk_sizze_79218];\n        int64_t thd_offset_79265;\n        int64_t acc_79291;\n        int64_t acc_79292;\n        int64_t prefix_79305;\n        int64_t prefix_79306;\n        bool block_new_sgm_79307;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79234 == 0) {\n                dynamic_id_79256 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79231)[(int64_t) 0], (int) 1);\n     ",
                                    "           // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79243)[(int64_t) 0] = dynamic_id_79256;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79256 == num_virt_blocks_79219 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79231)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79256 = ((__local int32_t *) local_mem_79243)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79257 = dynamic_id_79256 * chunk_sizze_79218 * segscan_tblock_sizze_72046;\n        sgm_idx_79258 = smod64(block_offset_79257, m_67844);\n        boundary_79259 = sext_i64_i32(smin64(chunk_sizze_79218 * segscan_tblock_sizze_72046, m_67844 - sgm_idx_79258));\n        segsizze_compact_79260 = sext_i64_i32(smin64(chunk_sizze_79218 * segscan_tblock_sizze_72046, m_67844));\n        thd_offset_79265 = block_offset_79257 + sext_i32_i64(local_tid_79234);\n        // Load and map\n        {\n            for (int64_t i_79266 = 0; i_79266 < chunk_sizze_79218; i_79266++) {\n                int64_t virt_tid_79267 = thd_offset_79265 + i_79266 * segscan_tblock_sizze_72046;\n                int64_t slice_79268 = m_67844;\n                int64_t gtid_72050 = virt_tid_79267;\n                int64_t remnant_79269 = virt_tid_79267 - gtid_72050;\n                \n                if (slt64(virt_tid_79267, m_67844)) {\n                    int64_t x_68125 = ((__global int64_t *) mem_78103)[gtid_72050];\n                    bool lifted_lambda_res_68127 = slt64((int64_t) 1, x_68125);\n                    int64_t defunc_0_f_res_68128 = btoi_bool_i64(lifted_lambda_res_68127);\n                    \n                    ((__global int64_t *) mem_78117)[gtid_72050] = defunc_0_f_res_68128;\n                    private_mem_79261[i_79266] = x_6812", "5;\n                    private_mem_79263[i_79266] = defunc_0_f_res_68128;\n                } else {\n                    private_mem_79261[i_79266] = (int64_t) 0;\n                    private_mem_79263[i_79266] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79270 = 0; i_79270 < chunk_sizze_79218; i_79270++) {\n                int64_t sharedIdx_79271 = sext_i32_i64(local_tid_79234) + i_79270 * segscan_tblock_sizze_72046;\n                int64_t tmp_79272 = private_mem_79261[i_79270];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79271] = tmp_79272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79273 = 0; i_79273 < chunk_sizze_79218; i_79273++) {\n                int64_t sharedIdx_79274 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79273;\n                int64_t tmp_79275 = ((__local int64_t *) local_mem_79243)[sharedIdx_79274];\n                \n                private_mem_79261[i_79273] = tmp_79275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79276 = 0; i_79276 < chunk_sizze_79218; i_79276++) {\n                int64_t sharedIdx_79277 = sext_i32_i64(local_tid_79234) + i_79276 * segscan_tblock_sizze_72046;\n                int64_t tmp_79278 = private_mem_79263[i_79276];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79277] = tmp_79278;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79279 = 0; i_79279 < chunk_sizze_79218; i_79279++) {\n                int64_t sharedIdx_79280 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79279;\n                int64_t tmp_79281 = ((__local int64_t *) local_mem_79243)[sharedIdx_79280];\n                \n                private_mem_79263[i_79279] = tmp_79281;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        //", " Per thread scan\n        {\n            for (int64_t i_79282 = 0; i_79282 < chunk_sizze_79218 - (int64_t) 1; i_79282++) {\n                int64_t eta_p_67881;\n                int64_t eta_p_67882;\n                \n                eta_p_67881 = private_mem_79261[i_79282];\n                eta_p_67882 = private_mem_79261[i_79282 + (int64_t) 1];\n                \n                int64_t eta_p_67974;\n                int64_t eta_p_67975;\n                \n                eta_p_67974 = private_mem_79263[i_79282];\n                eta_p_67975 = private_mem_79263[i_79282 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_67883 = add64(eta_p_67881, eta_p_67882);\n                int64_t defunc_0_op_res_67976 = add64(eta_p_67974, eta_p_67975);\n                \n                private_mem_79261[i_79282 + (int64_t) 1] = lifted_lambda_res_67883;\n                private_mem_79263[i_79282 + (int64_t) 1] = defunc_0_op_res_67976;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79283 = private_mem_79261[chunk_sizze_79218 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = tmp_79283;\n            \n            int64_t tmp_79284 = private_mem_79263[chunk_sizze_79218 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = tmp_79284;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79285;\n            int64_t eta_p_79286;\n            int64_t eta_p_79287;\n            int64_t eta_p_79288;\n            int64_t eta_p_79293;\n            int64_t eta_p_79294;\n            int64_t eta_p_79295;\n            int64_t eta_p_79296;\n            bool ltid_in_bounds_79299 = slt64(sext_i32_i64(local_tid_79234), num_virt_threads_79220);\n            int32_t skip_threads_79300;\n            \n            // rea",
                                    "d input for in-block scan\n            {\n                if (ltid_in_bounds_79299) {\n                    eta_p_79287 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                    eta_p_79288 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                    if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                        eta_p_79285 = eta_p_79287;\n                        eta_p_79286 = eta_p_79288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79300 = 1;\n                while (slt32(skip_threads_79300, 32)) {\n                    bool thread_active_79301 = sle32(skip_threads_79300, local_tid_79234 - squot32(local_tid_79234, 32) * 32) && ltid_in_bounds_79299;\n                    \n                    if (thread_active_79301) {\n                        // read operands\n                        {\n                            eta_p_79285 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79300)];\n                            eta_p_79286 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79300))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79301) {\n                            int64_t lifted_lambda_res_79289 = add64(eta_p_79285, eta_p_79287);\n                            int64_t defunc_0_op_res_79290 = add64(eta_p_79286, eta_p_79288);\n                            \n                            eta_p_79285 = lifted_lambda_res_79289;\n                            eta_p_79286 = defunc_0_op_res_79290;\n                        }\n                    }\n                    if (sle32(wav", "e_sizze_79236, skip_threads_79300)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79301) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79285;\n                            eta_p_79287 = eta_p_79285;\n                            ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79286;\n                            eta_p_79288 = eta_p_79286;\n                        }\n                    }\n                    if (sle32(wave_sizze_79236, skip_threads_79300)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79300 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 31 && ltid_in_bounds_79299) {\n                    ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(squot32(local_tid_79234, 32))] = eta_p_79285;\n                    ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(squot32(local_tid_79234, 32))] = eta_p_79286;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79302;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299) {\n                        eta_p_79295 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                        eta_p_79296 = ((volatile __local int64_t ", "*) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                        if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                            eta_p_79293 = eta_p_79295;\n                            eta_p_79294 = eta_p_79296;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79302 = 1;\n                    while (slt32(skip_threads_79302, 32)) {\n                        bool thread_active_79303 = sle32(skip_threads_79302, local_tid_79234 - squot32(local_tid_79234, 32) * 32) && (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299);\n                        \n                        if (thread_active_79303) {\n                            // read operands\n                            {\n                                eta_p_79293 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79302)];\n                                eta_p_79294 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79302))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79303) {\n                                int64_t lifted_lambda_res_79297 = add64(eta_p_79293, eta_p_79295);\n                                int64_t defunc_0_op_res_79298 = add64(eta_p_79294, eta_p_79296);\n                                \n                                eta_p_79293 = lifted_lambda_res_79297;\n                                eta_p_79294 = defunc_0_op_res_79298;\n                            }\n                        }\n                        if (sle32(wave_sizze_79236, skip_threads_79302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n   ",
                                    "                     }\n                        if (thread_active_79303) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79293;\n                                eta_p_79295 = eta_p_79293;\n                                ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79294;\n                                eta_p_79296 = eta_p_79294;\n                            }\n                        }\n                        if (sle32(wave_sizze_79236, skip_threads_79302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79302 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79304 = squot32(local_tid_79234, 32) == 0 || !ltid_in_bounds_79299;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79304) {\n                        eta_p_79287 = eta_p_79285;\n                        eta_p_79288 = eta_p_79286;\n                        eta_p_79285 = ((__local int64_t *) local_mem_79243)[sext_i32_i64(squot32(local_tid_79234, 32)) - (int64_t) 1];\n                        eta_p_79286 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_79234, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79304) {\n                        int64_t lifted_lambda_res_79289 = add64(eta_p_79285, eta_p_79287);\n                        int64_t defunc_0_op_res_79290 = add64(eta_p_79286, eta_p_79288);\n                        \n                        eta", "_p_79285 = lifted_lambda_res_79289;\n                        eta_p_79286 = defunc_0_op_res_79290;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79304) {\n                        ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79285;\n                        ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79286;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299) {\n                    ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79287;\n                    ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79234 == 0) {\n                acc_79291 = ((__local int64_t *) local_mem_79243)[segscan_tblock_sizze_72046 - (int64_t) 1];\n                acc_79292 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (segscan_tblock_sizze_72046 - (int64_t) 1)];\n            } else {\n                acc_79291 = ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - (int64_t) 1];\n                acc_79292 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79305 = (int64_t) 0;\n        prefix_79306 = (int64_t) 0;\n        block_new_sgm_79307 = sgm_idx_79258 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79307 && local_tid_79234 == 0) ", "{\n                ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256] = acc_79291;\n                ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256] = acc_79292;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 2;\n                acc_79291 = (int64_t) 0;\n                acc_79292 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79307 && slt32(local_tid_79234, wave_sizze_79236)) {\n                if (local_tid_79234 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79223)[dynamic_id_79256] = acc_79291;\n                    ((volatile __global int64_t *) aggregates_mem_79227)[dynamic_id_79256] = acc_79292;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 1;\n                    \n                    int8_t tmp_79308 = ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79243)[(int64_t) 0] = tmp_79308;\n                }\n                mem_fence_local();\n                \n                int8_t status_79309 = ((__local int8_t *) local_mem_79243)[(int64_t) 0];\n                \n                if (status_79309 == (int8_t) 2) {\n                    if (local_tid_79234 == 0) {\n                        prefix_79305 = ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256 - (int64_t) 1];\n                        prefix_79306 = ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79310 = sext_i64_i32(dynamic_id_79256 - sext_i32_i64(wave_sizze_79236));\n                    \n                    while (slt32(wave_sizze_79236 * -1, readOffset_79310)) {\n                        int32_t read_",
                                    "i_79311 = readOffset_79310 + local_tid_79234;\n                        int64_t aggr_79312 = (int64_t) 0;\n                        int64_t aggr_79313 = (int64_t) 0;\n                        int8_t flag_79314 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79311)) {\n                            flag_79314 = ((volatile __global int8_t *) status_flags_mem_79221)[sext_i32_i64(read_i_79311)];\n                            if (flag_79314 == (int8_t) 2) {\n                                aggr_79312 = ((volatile __global int64_t *) incprefixes_mem_79225)[sext_i32_i64(read_i_79311)];\n                                aggr_79313 = ((volatile __global int64_t *) incprefixes_mem_79229)[sext_i32_i64(read_i_79311)];\n                            } else if (flag_79314 == (int8_t) 1) {\n                                aggr_79312 = ((volatile __global int64_t *) aggregates_mem_79223)[sext_i32_i64(read_i_79311)];\n                                aggr_79313 = ((volatile __global int64_t *) aggregates_mem_79227)[sext_i32_i64(read_i_79311)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)] = aggr_79312;\n                        ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = aggr_79313;\n                        ((__local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = flag_79314;\n                        flag_79314 = ((__local int8_t *) local_mem_79243)[sext_i32_i64(wave_sizze_79236) - (int64_t) 1];\n                        if (slt8(flag_79314, (int8_t) 2)) {\n                            int8_t flg_x_79321;\n                            int8_t flg_y_79322;\n                            int64_t eta_p_79315;\n                            int64_t eta_p_79316;\n                            int64_t eta_p_79317;\n                            int64_t eta_p_79318;\n                            int3", "2_t skip_threads_79323;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79322 = ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                                eta_p_79317 = ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)];\n                                eta_p_79318 = ((volatile __local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                                if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                                    eta_p_79315 = eta_p_79317;\n                                    eta_p_79316 = eta_p_79318;\n                                    flg_x_79321 = flg_y_79322;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79323 = 1;\n                                while (slt32(skip_threads_79323, 32)) {\n                                    if (sle32(skip_threads_79323, local_tid_79234 - squot32(local_tid_79234, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79321 = ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323)];\n                                            eta_p_79315 = ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323))];\n                                            eta_p_79316 = ((volatile __local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323))];\n                                    ", "    }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79322 == (int8_t) 2 || flg_y_79322 == (int8_t) 0) {\n                                                flg_x_79321 = flg_y_79322;\n                                                eta_p_79315 = eta_p_79317;\n                                                eta_p_79316 = eta_p_79318;\n                                            } else {\n                                                int64_t lifted_lambda_res_79319 = add64(eta_p_79315, eta_p_79317);\n                                                int64_t defunc_0_op_res_79320 = add64(eta_p_79316, eta_p_79318);\n                                                \n                                                eta_p_79315 = lifted_lambda_res_79319;\n                                                eta_p_79316 = defunc_0_op_res_79320;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = flg_x_79321;\n                                            flg_y_79322 = flg_x_79321;\n                                            ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)] = eta_p_79315;\n                                            eta_p_79317 = eta_p_79315;\n                                            ((volatile __local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79316;\n                                            eta_p_79318 = eta_p_79316;\n                                        }\n                                    }\n                                    skip_threads_79323 *= 2;\n                                }\n             ",
                                    "               }\n                        }\n                        flag_79314 = ((__local int8_t *) local_mem_79243)[sext_i32_i64(wave_sizze_79236) - (int64_t) 1];\n                        aggr_79312 = ((__local int64_t *) local_mem_79243)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79236) - (int64_t) 1)];\n                        aggr_79313 = ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + (sext_i32_i64(wave_sizze_79236) - (int64_t) 1)];\n                        if (flag_79314 == (int8_t) 2) {\n                            readOffset_79310 = wave_sizze_79236 * -1;\n                        } else if (flag_79314 == (int8_t) 1) {\n                            readOffset_79310 -= wave_sizze_79236;\n                        }\n                        if (slt8((int8_t) 0, flag_79314)) {\n                            int64_t eta_p_79324 = aggr_79312;\n                            int64_t eta_p_79325 = aggr_79313;\n                            int64_t eta_p_79326 = prefix_79305;\n                            int64_t eta_p_79327 = prefix_79306;\n                            int64_t lifted_lambda_res_79328 = add64(eta_p_79324, eta_p_79326);\n                            int64_t defunc_0_op_res_79329 = add64(eta_p_79325, eta_p_79327);\n                            \n                            prefix_79305 = lifted_lambda_res_79328;\n                            prefix_79306 = defunc_0_op_res_79329;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79234 == 0) {\n                    if (boundary_79259 == sext_i64_i32(segscan_tblock_sizze_72046 * chunk_sizze_79218)) {\n                        int64_t eta_p_79330 = prefix_79305;\n                        int64_t eta_p_79331 = prefix_79306;\n                        int64_t eta_p_79332 = acc_79291;\n                        int64_t eta_p_79333 = acc_79292;\n                        int64_t lifted_lambda_res_79334 = add64(eta_p_79330, eta_p_79332);", "\n                        int64_t defunc_0_op_res_79335 = add64(eta_p_79331, eta_p_79333);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256] = lifted_lambda_res_79334;\n                        ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256] = defunc_0_op_res_79335;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79243)[(int64_t) 4] = prefix_79305;\n                    ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8)] = prefix_79306;\n                    acc_79291 = (int64_t) 0;\n                    acc_79292 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79256 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79305 = ((__local int64_t *) local_mem_79243)[(int64_t) 4];\n                prefix_79306 = ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79336;\n            int64_t eta_p_79338;\n            int64_t eta_p_79342 = prefix_79305;\n            int64_t eta_p_79344 = acc_79291;\n            int64_t eta_p_79337;\n            int64_t eta_p_79339;\n            int64_t eta_p_79343 = prefix_79306;\n            int64_t eta_p_79345 = acc_79292;\n            \n            if (slt32(local_tid_79234 * chunk_sizze_32b_79238, boundary_79259) && !block_new_sgm_79307) {\n                int64_t lifted_lambda_res_79346 = add64(eta_p_79342, eta_p_79344);\n                int64_t defunc_0_op_res_79347 = add64(eta_p_79343, eta_p_79345);\n                \n                eta_p_79336 = lifted_lambda_res_79346;\n                eta_p_79337 = defunc_0_op_res_79347;\n ", "           } else {\n                eta_p_79336 = acc_79291;\n                eta_p_79337 = acc_79292;\n            }\n            \n            int32_t stopping_point_79348 = segsizze_compact_79260 - srem32(local_tid_79234 * chunk_sizze_32b_79238 - 1 + segsizze_compact_79260 - boundary_79259, segsizze_compact_79260);\n            \n            for (int64_t i_79349 = 0; i_79349 < chunk_sizze_79218; i_79349++) {\n                if (slt32(sext_i64_i32(i_79349), stopping_point_79348 - 1)) {\n                    eta_p_79338 = private_mem_79261[i_79349];\n                    eta_p_79339 = private_mem_79263[i_79349];\n                    \n                    int64_t lifted_lambda_res_79340 = add64(eta_p_79336, eta_p_79338);\n                    int64_t defunc_0_op_res_79341 = add64(eta_p_79337, eta_p_79339);\n                    \n                    private_mem_79261[i_79349] = lifted_lambda_res_79340;\n                    private_mem_79263[i_79349] = defunc_0_op_res_79341;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79350 = 0; i_79350 < chunk_sizze_79218; i_79350++) {\n                int64_t sharedIdx_79351 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79350;\n                int64_t tmp_79352 = private_mem_79261[i_79350];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79351] = tmp_79352;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79353 = 0; i_79353 < chunk_sizze_79218; i_79353++) {\n                int64_t flat_idx_79354 = thd_offset_79265 + i_79353 * segscan_tblock_sizze_72046;\n                int64_t slice_79355 = m_67844;\n                int64_t gtid_72050 = flat_idx_79354;\n                int64_t remnant_79356 = flat_idx_79354 - gtid_72050;\n                \n                if (slt64(flat_idx_79354, m_67844)) {\n                    int64_t tmp_79357 = ((__local int64_t *) local_mem_",
                                    "79243)[flat_idx_79354 - block_offset_79257];\n                    \n                    ((__global int64_t *) mem_78113)[gtid_72050] = tmp_79357;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79358 = 0; i_79358 < chunk_sizze_79218; i_79358++) {\n                int64_t sharedIdx_79359 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79358;\n                int64_t tmp_79360 = private_mem_79263[i_79358];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79359] = tmp_79360;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79361 = 0; i_79361 < chunk_sizze_79218; i_79361++) {\n                int64_t flat_idx_79362 = thd_offset_79265 + i_79361 * segscan_tblock_sizze_72046;\n                int64_t slice_79363 = m_67844;\n                int64_t gtid_72050 = flat_idx_79362;\n                int64_t remnant_79364 = flat_idx_79362 - gtid_72050;\n                \n                if (slt64(flat_idx_79362, m_67844)) {\n                    int64_t tmp_79365 = ((__local int64_t *) local_mem_79243)[flat_idx_79362 - block_offset_79257];\n                    \n                    ((__global int64_t *) mem_78115)[gtid_72050] = tmp_79365;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_72046\n    #undef chunk_sizze_79218\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78724_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78724(__global int *global_failure, int64_t gt_rhs_66981, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77633)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78726;\n    int32_t tblock_sizze_78729;\n    int32_t wave_sizze_78728;\n    int32_t block_id_78727;\n    int32_t global_tid_78725;\n    int64_t tid_78724;\n    int64_t x_77524;\n    \n    local_tid_78726 = get_local_id(0);\n    tblock_sizze_78729 = get_local_size(0);\n   ", " wave_sizze_78728 = LOCKSTEP_WIDTH;\n    block_id_78727 = get_tblock_id(0);\n    global_tid_78725 = block_id_78727 * tblock_sizze_78729 + local_tid_78726;\n    tid_78724 = sext_i32_i64(global_tid_78725);\n    x_77524 = ((__global int64_t *) tR_mem_77625)[gt_rhs_66981];\n    ((__global int64_t *) mem_77633)[(int64_t) 0] = x_77524;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78736_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78736(__global int *global_failure, int64_t tS_start_66998, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77634, __global unsigned char *mem_77641, __global unsigned char *mem_77642)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78738;\n    int32_t tblock_sizze_78741;\n    int32_t wave_sizze_78740;\n    int32_t block_id_78739;\n    int32_t global_tid_78737;\n    int64_t tid_78736;\n    int64_t gt_lhs_77528;\n    int64_t gt_rhs_77530;\n    bool defunc_0_gt_res_77532;\n    \n    local_tid_78738 = get_local_id(0);\n    tblock_sizze_78741 = get_local_size(0);\n    wave_sizze_78740 = LOCKSTEP_WIDTH;\n    block_id_78739 = get_tblock_id(0);\n    global_tid_78737 = block_id_78739 * tblock_sizze_78741 + local_tid_78738;\n    tid_78736 = sext_i32_i64(global_tid_78737);\n    gt_lhs_77528 = ((__global int64_t *) tS_mem_77626)[tS_start_66998];\n    gt_rhs_77530 = ((__global int64_t *) ext_mem_77634)[(int64_t) 0];\n    defunc_0_gt_res_77532 = slt64(gt_rhs_77530, gt_lhs_77528);\n    ((__global int64_t *) mem_77641)[(int64_t) 0] = gt_lhs_77528;\n    ((__global bool *) mem_77642)[(int64_t) 0] = defunc_0_gt_res_77532;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78742_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78742(__global int *global_failure, int64_t i_p_m_t_s_67004, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77908)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78744;\n    int32_t tblock_sizze_78747;\n    int32_t wave_sizze_78746;\n    ", "int32_t block_id_78745;\n    int32_t global_tid_78743;\n    int64_t tid_78742;\n    int64_t x_77534;\n    \n    local_tid_78744 = get_local_id(0);\n    tblock_sizze_78747 = get_local_size(0);\n    wave_sizze_78746 = LOCKSTEP_WIDTH;\n    block_id_78745 = get_tblock_id(0);\n    global_tid_78743 = block_id_78745 * tblock_sizze_78747 + local_tid_78744;\n    tid_78742 = sext_i32_i64(global_tid_78743);\n    x_77534 = ((__global int64_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    ((__global int64_t *) mem_77908)[(int64_t) 0] = x_77534;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78758_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78758(__global int *global_failure, int64_t start_68558, int64_t i_p_m_t_s_68564, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77916, __global unsigned char *mem_77917)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78760;\n    int32_t tblock_sizze_78763;\n    int32_t wave_sizze_78762;\n    int32_t block_id_78761;\n    int32_t global_tid_78759;\n    int64_t tid_78758;\n    int64_t r_max_77538;\n    int64_t r_min_77541;\n    \n    local_tid_78760 = get_local_id(0);\n    tblock_sizze_78763 = get_local_size(0);\n    wave_sizze_78762 = LOCKSTEP_WIDTH;\n    block_id_78761 = get_tblock_id(0);\n    global_tid_78759 = block_id_78761 * tblock_sizze_78763 + local_tid_78760;\n    tid_78758 = sext_i32_i64(global_tid_78759);\n    r_max_77538 = ((__global int64_t *) tR_mem_77625)[i_p_m_t_s_68564];\n    r_min_77541 = ((__global int64_t *) tR_mem_77625)[start_68558];\n    ((__global int64_t *) mem_77916)[(int64_t) 0] = r_max_77538;\n    ((__global int64_t *) mem_77917)[(int64_t) 0] = r_min_77541;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78764_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78764(__global int *global_failure, __global unsigned char *mem_77917, __global unsigned char *ext_mem_77918, __global unsigned char *mem_77920)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t loca",
                                    "l_tid_78766;\n    int32_t tblock_sizze_78769;\n    int32_t wave_sizze_78768;\n    int32_t block_id_78767;\n    int32_t global_tid_78765;\n    int64_t tid_78764;\n    int64_t s_max_77543;\n    int64_t r_min_77544;\n    bool defunc_0_gt_res_77545;\n    \n    local_tid_78766 = get_local_id(0);\n    tblock_sizze_78769 = get_local_size(0);\n    wave_sizze_78768 = LOCKSTEP_WIDTH;\n    block_id_78767 = get_tblock_id(0);\n    global_tid_78765 = block_id_78767 * tblock_sizze_78769 + local_tid_78766;\n    tid_78764 = sext_i32_i64(global_tid_78765);\n    s_max_77543 = ((__global int64_t *) ext_mem_77918)[(int64_t) 0];\n    r_min_77544 = ((__global int64_t *) mem_77917)[(int64_t) 0];\n    defunc_0_gt_res_77545 = slt64(s_max_77543, r_min_77544);\n    ((__global bool *) mem_77920)[(int64_t) 0] = defunc_0_gt_res_77545;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78770_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78770(__global int *global_failure, __global unsigned char *mem_77916, __global unsigned char *ext_mem_77919, __global unsigned char *mem_77921)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78772;\n    int32_t tblock_sizze_78775;\n    int32_t wave_sizze_78774;\n    int32_t block_id_78773;\n    int32_t global_tid_78771;\n    int64_t tid_78770;\n    int64_t r_max_77548;\n    int64_t s_min_77549;\n    bool defunc_0_gt_res_77550;\n    \n    local_tid_78772 = get_local_id(0);\n    tblock_sizze_78775 = get_local_size(0);\n    wave_sizze_78774 = LOCKSTEP_WIDTH;\n    block_id_78773 = get_tblock_id(0);\n    global_tid_78771 = block_id_78773 * tblock_sizze_78775 + local_tid_78772;\n    tid_78770 = sext_i32_i64(global_tid_78771);\n    r_max_77548 = ((__global int64_t *) mem_77916)[(int64_t) 0];\n    s_min_77549 = ((__global int64_t *) ext_mem_77919)[(int64_t) 0];\n    defunc_0_gt_res_77550 = slt64(r_max_77548, s_min_77549);\n    ((__global bool *) mem_77921)[(int64_t) 0] = defunc_0_gt_res_77550;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuse", "q_78829_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78829(__global int *global_failure, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77648)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78831;\n    int32_t tblock_sizze_78834;\n    int32_t wave_sizze_78833;\n    int32_t block_id_78832;\n    int32_t global_tid_78830;\n    int64_t tid_78829;\n    int64_t x_77552;\n    \n    local_tid_78831 = get_local_id(0);\n    tblock_sizze_78834 = get_local_size(0);\n    wave_sizze_78833 = LOCKSTEP_WIDTH;\n    block_id_78832 = get_tblock_id(0);\n    global_tid_78830 = block_id_78832 * tblock_sizze_78834 + local_tid_78831;\n    tid_78829 = sext_i32_i64(global_tid_78830);\n    x_77552 = ((__global int64_t *) tR_mem_77625)[(int64_t) 0];\n    ((__global int64_t *) mem_77648)[(int64_t) 0] = x_77552;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78835_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78835(__global int *global_failure, __global unsigned char *mem_77641, __global unsigned char *ext_mem_77649, __global unsigned char *mem_77650)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78837;\n    int32_t tblock_sizze_78840;\n    int32_t wave_sizze_78839;\n    int32_t block_id_78838;\n    int32_t global_tid_78836;\n    int64_t tid_78835;\n    int64_t leq_lhs_77556;\n    int64_t gt_lhs_77557;\n    bool defunc_0_leq_res_77558;\n    \n    local_tid_78837 = get_local_id(0);\n    tblock_sizze_78840 = get_local_size(0);\n    wave_sizze_78839 = LOCKSTEP_WIDTH;\n    block_id_78838 = get_tblock_id(0);\n    global_tid_78836 = block_id_78838 * tblock_sizze_78840 + local_tid_78837;\n    tid_78835 = sext_i32_i64(global_tid_78836);\n    leq_lhs_77556 = ((__global int64_t *) ext_mem_77649)[(int64_t) 0];\n    gt_lhs_77557 = ((__global int64_t *) mem_77641)[(int64_t) 0];\n    defunc_0_leq_res_77558 = sle64(leq_lhs_77556, gt_lhs_77557);\n    ((__global bool *) mem_77650)[(int64_t) 0] = defunc_0_leq_res_77558;\n    \n  error_0:\n    return;\n}\nFUTHARK", "_KERNEL_SIZED(inner_SMJ_longzigpuseq_78841_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78841(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_49324, unsigned char y_67146_bits, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77641, __global unsigned char *mem_77650, __global unsigned char *mem_77652)\n{\n    bool y_67146 = y_67146_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78843;\n    int32_t tblock_sizze_78846;\n    int32_t wave_sizze_78845;\n    int32_t block_id_78844;\n    int32_t global_tid_78842;\n    int64_t tid_78841;\n    bool defunc_0_leq_res_77560;\n    int64_t x_77565;\n    \n    local_tid_78843 = get_local_id(0);\n    tblock_sizze_78846 = get_local_size(0);\n    wave_sizze_78845 = LOCKSTEP_WIDTH;\n    block_id_78844 = get_tblock_id(0);\n    global_tid_78842 = block_id_78844 * tblock_sizze_78846 + local_tid_78843;\n    tid_78841 = sext_i32_i64(global_tid_78842);\n    defunc_0_leq_res_77560 = ((__global bool *) mem_77650)[(int64_t) 0];\n    if (defunc_0_leq_res_77560) {\n        bool index_certs_77561;\n        int64_t lowest_t_res_77562;\n        \n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 106) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_49324;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_77562 = ((__global int64_t *) tR_mem_77625)[(int64_t) 0];\n        x_77565 = lowest_t_res_77562;\n    } else {\n        int64_t gt_lhs_77564;\n        bool index_certs_77563;\n        \n        gt_lhs_77564 = ((__global int64_t *) mem_77641)[(int64_t) 0];\n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 107) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_arg",
                                    "s[1] = (int64_t) nR_49324;\n                    ;\n                }\n                return;\n            }\n        }\n        x_77565 = gt_lhs_77564;\n    }\n    ((__global int64_t *) mem_77652)[(int64_t) 0] = x_77565;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78903_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78903(__global int *global_failure, int64_t slice_68069, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77700)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78905;\n    int32_t tblock_sizze_78908;\n    int32_t wave_sizze_78907;\n    int32_t block_id_78906;\n    int32_t global_tid_78904;\n    int64_t tid_78903;\n    int64_t x_77570;\n    \n    local_tid_78905 = get_local_id(0);\n    tblock_sizze_78908 = get_local_size(0);\n    wave_sizze_78907 = LOCKSTEP_WIDTH;\n    block_id_78906 = get_tblock_id(0);\n    global_tid_78904 = block_id_78906 * tblock_sizze_78908 + local_tid_78905;\n    tid_78903 = sext_i32_i64(global_tid_78904);\n    x_77570 = ((__global int64_t *) tS_mem_77626)[slice_68069];\n    ((__global int64_t *) mem_77700)[(int64_t) 0] = x_77570;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78909_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78909(__global int *global_failure, int64_t slice_68867, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77703)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78911;\n    int32_t tblock_sizze_78914;\n    int32_t wave_sizze_78913;\n    int32_t block_id_78912;\n    int32_t global_tid_78910;\n    int64_t tid_78909;\n    int64_t x_77574;\n    \n    local_tid_78911 = get_local_id(0);\n    tblock_sizze_78914 = get_local_size(0);\n    wave_sizze_78913 = LOCKSTEP_WIDTH;\n    block_id_78912 = get_tblock_id(0);\n    global_tid_78910 = block_id_78912 * tblock_sizze_78914 + local_tid_78911;\n    tid_78909 = sext_i32_i64(global_tid_78910);\n    x_77574 = ((__global int64_t *) tS_mem_77626)[slice_68867];\n    ((__global int64_", "t *) mem_77703)[(int64_t) 0] = x_77574;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78925_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78925(__global int *global_failure, int64_t slice_67712, int64_t slice_67721, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77711, __global unsigned char *mem_77712)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78927;\n    int32_t tblock_sizze_78930;\n    int32_t wave_sizze_78929;\n    int32_t block_id_78928;\n    int32_t global_tid_78926;\n    int64_t tid_78925;\n    int64_t r_max_77578;\n    int64_t r_min_77581;\n    \n    local_tid_78927 = get_local_id(0);\n    tblock_sizze_78930 = get_local_size(0);\n    wave_sizze_78929 = LOCKSTEP_WIDTH;\n    block_id_78928 = get_tblock_id(0);\n    global_tid_78926 = block_id_78928 * tblock_sizze_78930 + local_tid_78927;\n    tid_78925 = sext_i32_i64(global_tid_78926);\n    r_max_77578 = ((__global int64_t *) tR_mem_77625)[slice_67721];\n    r_min_77581 = ((__global int64_t *) tR_mem_77625)[slice_67712];\n    ((__global int64_t *) mem_77711)[(int64_t) 0] = r_max_77578;\n    ((__global int64_t *) mem_77712)[(int64_t) 0] = r_min_77581;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78931_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78931(__global int *global_failure, __global unsigned char *mem_77712, __global unsigned char *ext_mem_77713, __global unsigned char *mem_77715)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78933;\n    int32_t tblock_sizze_78936;\n    int32_t wave_sizze_78935;\n    int32_t block_id_78934;\n    int32_t global_tid_78932;\n    int64_t tid_78931;\n    int64_t s_max_77583;\n    int64_t r_min_77584;\n    bool defunc_0_gt_res_77585;\n    \n    local_tid_78933 = get_local_id(0);\n    tblock_sizze_78936 = get_local_size(0);\n    wave_sizze_78935 = LOCKSTEP_WIDTH;\n    block_id_78934 = get_tblock_id(0);\n    global_tid_78932 = block_id_78934 * tblock_sizze_78936 + local_tid_78933;\n    t", "id_78931 = sext_i32_i64(global_tid_78932);\n    s_max_77583 = ((__global int64_t *) ext_mem_77713)[(int64_t) 0];\n    r_min_77584 = ((__global int64_t *) mem_77712)[(int64_t) 0];\n    defunc_0_gt_res_77585 = slt64(s_max_77583, r_min_77584);\n    ((__global bool *) mem_77715)[(int64_t) 0] = defunc_0_gt_res_77585;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_78937_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_78937(__global int *global_failure, __global unsigned char *mem_77711, __global unsigned char *ext_mem_77714, __global unsigned char *mem_77716)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78939;\n    int32_t tblock_sizze_78942;\n    int32_t wave_sizze_78941;\n    int32_t block_id_78940;\n    int32_t global_tid_78938;\n    int64_t tid_78937;\n    int64_t r_max_77588;\n    int64_t s_min_77589;\n    bool defunc_0_gt_res_77590;\n    \n    local_tid_78939 = get_local_id(0);\n    tblock_sizze_78942 = get_local_size(0);\n    wave_sizze_78941 = LOCKSTEP_WIDTH;\n    block_id_78940 = get_tblock_id(0);\n    global_tid_78938 = block_id_78940 * tblock_sizze_78942 + local_tid_78939;\n    tid_78937 = sext_i32_i64(global_tid_78938);\n    r_max_77588 = ((__global int64_t *) mem_77711)[(int64_t) 0];\n    s_min_77589 = ((__global int64_t *) ext_mem_77714)[(int64_t) 0];\n    defunc_0_gt_res_77590 = slt64(r_max_77588, s_min_77589);\n    ((__global bool *) mem_77716)[(int64_t) 0] = defunc_0_gt_res_77590;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_79050_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_79050(__global int *global_failure, int64_t gt_rhs_66981, int64_t i_p_m_t_s_67004, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_78084)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79052;\n    int32_t tblock_sizze_79055;\n    int32_t wave_sizze_79054;\n    int32_t block_id_79053;\n    int32_t global_tid_79051;\n    int64_t tid_79050;\n    int64_t leq_lhs_",
                                    "77592;\n    int64_t leq_rhs_77594;\n    bool defunc_0_leq_res_77598;\n    \n    local_tid_79052 = get_local_id(0);\n    tblock_sizze_79055 = get_local_size(0);\n    wave_sizze_79054 = LOCKSTEP_WIDTH;\n    block_id_79053 = get_tblock_id(0);\n    global_tid_79051 = block_id_79053 * tblock_sizze_79055 + local_tid_79052;\n    tid_79050 = sext_i32_i64(global_tid_79051);\n    leq_lhs_77592 = ((__global int64_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    leq_rhs_77594 = ((__global int64_t *) tR_mem_77625)[gt_rhs_66981];\n    defunc_0_leq_res_77598 = sle64(leq_lhs_77592, leq_rhs_77594);\n    ((__global bool *) mem_78084)[(int64_t) 0] = defunc_0_leq_res_77598;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_79375_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_79375(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78120, __global unsigned char *mem_78122)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79377;\n    int32_t tblock_sizze_79380;\n    int32_t wave_sizze_79379;\n    int32_t block_id_79378;\n    int32_t global_tid_79376;\n    int64_t tid_79375;\n    int64_t x_77600;\n    \n    local_tid_79377 = get_local_id(0);\n    tblock_sizze_79380 = get_local_size(0);\n    wave_sizze_79379 = LOCKSTEP_WIDTH;\n    block_id_79378 = get_tblock_id(0);\n    global_tid_79376 = block_id_79378 * tblock_sizze_79380 + local_tid_79377;\n    tid_79375 = sext_i32_i64(global_tid_79376);\n    x_77600 = ((__global int64_t *) mem_78120)[m_67854];\n    ((__global int64_t *) mem_78122)[(int64_t) 0] = x_77600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_79381_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_79381(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78103, __global unsigned char *mem_78125)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79383;\n    int32_t tblock_sizze_79386;\n    int32_t wave_sizze_79385;\n    int32_t block_id_79384;\n    int32_t global_tid_79382;\n    int64_t t", "id_79381;\n    int64_t x_77604;\n    \n    local_tid_79383 = get_local_id(0);\n    tblock_sizze_79386 = get_local_size(0);\n    wave_sizze_79385 = LOCKSTEP_WIDTH;\n    block_id_79384 = get_tblock_id(0);\n    global_tid_79382 = block_id_79384 * tblock_sizze_79386 + local_tid_79383;\n    tid_79381 = sext_i32_i64(global_tid_79382);\n    x_77604 = ((__global int64_t *) mem_78103)[m_67854];\n    ((__global int64_t *) mem_78125)[(int64_t) 0] = x_77604;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_79387_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_79387(__global int *global_failure, __global unsigned char *ext_mem_78123, __global unsigned char *ext_mem_78126, __global unsigned char *mem_78132)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79389;\n    int32_t tblock_sizze_79392;\n    int32_t wave_sizze_79391;\n    int32_t block_id_79390;\n    int32_t global_tid_79388;\n    int64_t tid_79387;\n    int64_t zp_lhs_77608;\n    int64_t n_pairs_t_res_77609;\n    int64_t n_pairs_t_res_77610;\n    \n    local_tid_79389 = get_local_id(0);\n    tblock_sizze_79392 = get_local_size(0);\n    wave_sizze_79391 = LOCKSTEP_WIDTH;\n    block_id_79390 = get_tblock_id(0);\n    global_tid_79388 = block_id_79390 * tblock_sizze_79392 + local_tid_79389;\n    tid_79387 = sext_i32_i64(global_tid_79388);\n    zp_lhs_77608 = ((__global int64_t *) ext_mem_78123)[(int64_t) 0];\n    n_pairs_t_res_77609 = ((__global int64_t *) ext_mem_78126)[(int64_t) 0];\n    n_pairs_t_res_77610 = add64(zp_lhs_77608, n_pairs_t_res_77609);\n    ((__global int64_t *) mem_78132)[(int64_t) 0] = n_pairs_t_res_77610;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_79434_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_79434(__global int *global_failure, int64_t loopres_68028, __global unsigned char *mem_param_78166, __global unsigned char *mem_param_78169, __global unsigned char *mem_param_78172, __global unsigned char *mem_78179, __global unsigned char *mem_78180, __global unsigned cha", "r *mem_78181)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79436;\n    int32_t tblock_sizze_79439;\n    int32_t wave_sizze_79438;\n    int32_t block_id_79437;\n    int32_t global_tid_79435;\n    int64_t tid_79434;\n    int64_t loopres_77612;\n    int64_t loopres_77614;\n    int64_t loopres_77616;\n    \n    local_tid_79436 = get_local_id(0);\n    tblock_sizze_79439 = get_local_size(0);\n    wave_sizze_79438 = LOCKSTEP_WIDTH;\n    block_id_79437 = get_tblock_id(0);\n    global_tid_79435 = block_id_79437 * tblock_sizze_79439 + local_tid_79436;\n    tid_79434 = sext_i32_i64(global_tid_79435);\n    loopres_77612 = ((__global int64_t *) mem_param_78166)[loopres_68028];\n    loopres_77614 = ((__global int64_t *) mem_param_78169)[loopres_68028];\n    loopres_77616 = ((__global int64_t *) mem_param_78172)[loopres_68028];\n    ((__global int64_t *) mem_78179)[(int64_t) 0] = loopres_77612;\n    ((__global int64_t *) mem_78180)[(int64_t) 0] = loopres_77614;\n    ((__global int64_t *) mem_78181)[(int64_t) 0] = loopres_77616;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_longzireplicate_79441(int64_t loopres_68029, int64_t replicate_n_79440, int64_t virt_num_tblocks_79446, int64_t num_tblocks_79447, __global unsigned char *mem_78179, __global unsigned char *mem_78183)\n{\n    int32_t replicate_ltid_79442;\n    int32_t tblock_sizze_79444;\n    int32_t replicate_gid_79443;\n    int32_t replicate_gtid_79441;\n    int32_t phys_tblock_id_79448;\n    int32_t iterations_79449;\n    \n    replicate_ltid_79442 = get_local_id(0);\n    tblock_sizze_79444 = get_local_size(0);\n    replicate_gid_79443 = get_tblock_id(0);\n    replicate_gtid_79441 = replicate_gid_79443 * tblock_sizze_79444 + replicate_ltid_79442;\n    phys_tblock_id_79448 = get_tblock_id(0);\n    iterations_79449 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79446) - phys_tblock_id_79448, sext_i64_i32(num_tblocks_79447));\n    for (int32_t i_79450 = 0; i_79450 < iterations_79449; i_79450++) {\n        int32_t virt_tblock_i",
                                    "d_79451;\n        int64_t global_tid_79452;\n        int64_t slice_79455;\n        int64_t slice_79456;\n        int64_t rep_i_79453;\n        int64_t remnant_79457;\n        int64_t rep_i_79454;\n        int64_t remnant_79458;\n        \n        virt_tblock_id_79451 = phys_tblock_id_79448 + i_79450 * sext_i64_i32(num_tblocks_79447);\n        global_tid_79452 = sext_i32_i64(virt_tblock_id_79451) * sext_i32_i64(tblock_sizze_79444) + sext_i32_i64(replicate_ltid_79442);\n        slice_79455 = (int64_t) 1;\n        slice_79456 = loopres_68029 * slice_79455;\n        rep_i_79453 = squot64(global_tid_79452, slice_79455);\n        remnant_79457 = global_tid_79452 - rep_i_79453 * slice_79455;\n        rep_i_79454 = remnant_79457;\n        remnant_79458 = remnant_79457 - rep_i_79454;\n        if (slt64(global_tid_79452, replicate_n_79440)) {\n            int64_t tmp_79459 = ((__global int64_t *) mem_78179)[rep_i_79454];\n            \n            ((__global int64_t *) mem_78183)[rep_i_79453 + rep_i_79454] = tmp_79459;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_longzireplicate_79461(int64_t loopres_68029, int64_t replicate_n_79460, int64_t virt_num_tblocks_79466, int64_t num_tblocks_79467, __global unsigned char *mem_78180, __global unsigned char *mem_78185)\n{\n    int32_t replicate_ltid_79462;\n    int32_t tblock_sizze_79464;\n    int32_t replicate_gid_79463;\n    int32_t replicate_gtid_79461;\n    int32_t phys_tblock_id_79468;\n    int32_t iterations_79469;\n    \n    replicate_ltid_79462 = get_local_id(0);\n    tblock_sizze_79464 = get_local_size(0);\n    replicate_gid_79463 = get_tblock_id(0);\n    replicate_gtid_79461 = replicate_gid_79463 * tblock_sizze_79464 + replicate_ltid_79462;\n    phys_tblock_id_79468 = get_tblock_id(0);\n    iterations_79469 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79466) - phys_tblock_id_79468, sext_i64_i32(num_tblocks_79467));\n    for (int32_t i_79470 = 0; i_79470 < iterations_79469", "; i_79470++) {\n        int32_t virt_tblock_id_79471;\n        int64_t global_tid_79472;\n        int64_t slice_79475;\n        int64_t slice_79476;\n        int64_t rep_i_79473;\n        int64_t remnant_79477;\n        int64_t rep_i_79474;\n        int64_t remnant_79478;\n        \n        virt_tblock_id_79471 = phys_tblock_id_79468 + i_79470 * sext_i64_i32(num_tblocks_79467);\n        global_tid_79472 = sext_i32_i64(virt_tblock_id_79471) * sext_i32_i64(tblock_sizze_79464) + sext_i32_i64(replicate_ltid_79462);\n        slice_79475 = (int64_t) 1;\n        slice_79476 = loopres_68029 * slice_79475;\n        rep_i_79473 = squot64(global_tid_79472, slice_79475);\n        remnant_79477 = global_tid_79472 - rep_i_79473 * slice_79475;\n        rep_i_79474 = remnant_79477;\n        remnant_79478 = remnant_79477 - rep_i_79474;\n        if (slt64(global_tid_79472, replicate_n_79460)) {\n            int64_t tmp_79479 = ((__global int64_t *) mem_78180)[rep_i_79474];\n            \n            ((__global int64_t *) mem_78185)[rep_i_79473 + rep_i_79474] = tmp_79479;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_72503_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_72503(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_49324, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t max_res_67171, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, int64_t zt_rhs_67177, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77653, __global unsigned char *mem_77662, __global unsigned char *mem_77664)\n{\n    #define segmap_tblock_sizze_72498 (inner_SMJ_longzisegmap_72503zisegmap_tblock_sizze_72498)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78853;\n    int32_t tblock_sizze_78856;\n    int32_t wave_sizze_78", "855;\n    int32_t block_id_78854;\n    int32_t global_tid_78852;\n    int64_t phys_tid_72503;\n    int64_t global_tid_78857;\n    int64_t slice_78858;\n    int64_t gtid_72502;\n    int64_t remnant_78859;\n    \n    local_tid_78853 = get_local_id(0);\n    tblock_sizze_78856 = get_local_size(0);\n    wave_sizze_78855 = LOCKSTEP_WIDTH;\n    block_id_78854 = get_tblock_id(0);\n    global_tid_78852 = block_id_78854 * tblock_sizze_78856 + local_tid_78853;\n    phys_tid_72503 = sext_i32_i64(global_tid_78852);\n    global_tid_78857 = sext_i32_i64(block_id_78854) * segmap_tblock_sizze_72498 + sext_i32_i64(local_tid_78853);\n    slice_78858 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;\n    gtid_72502 = global_tid_78857;\n    remnant_78859 = global_tid_78857 - gtid_72502;\n    if (slt64(gtid_72502, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172)) {\n        int64_t lowest_77569;\n        int64_t index_primexp_76055;\n        int64_t zs_lhs_72505;\n        int64_t index_72506;\n        bool cond_72507;\n        int64_t loop_over_72508;\n        int64_t loop_over_72509;\n        int64_t loop_over_72511;\n        bool defunc_0_f_res_72514;\n        int64_t defunc_0_f_res_72515;\n        int64_t defunc_0_f_res_72516;\n        int64_t defunc_0_f_res_72517;\n        bool loop_while_72518;\n        int64_t p_72519;\n        int64_t p_72520;\n        int64_t p_72521;\n        \n        lowest_77569 = ((__global int64_t *) ext_mem_77653)[(int64_t) 0];\n        index_primexp_76055 = add64(max_res_67171, gtid_72502);\n        zs_lhs_72505 = mul64(zt_rhs_67177, index_primexp_76055);\n        index_72506 = sdiv64(zs_lhs_72505, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n        cond_72507 = slt64(nR_49324, index_72506);\n        if (cond_72507) {\n            loop_over_72508 = nR_49324;\n        } else {\n            loop_over_72508 = index_72506;\n        }\n        if (cond_72507) {\n            int64_t loop_over_t_res_72510 = sub64(index_72506, nR_49324);\n            \n        ",
                                    "    loop_over_72509 = loop_over_t_res_72510;\n        } else {\n            loop_over_72509 = (int64_t) 0;\n        }\n        if (cond_72507) {\n            int64_t zm_lhs_72512;\n            int64_t loop_over_t_res_72513;\n            \n            zm_lhs_72512 = sub64(index_72506, nR_49324);\n            loop_over_t_res_72513 = sub64(zm_lhs_72512, (int64_t) 1);\n            loop_over_72511 = loop_over_t_res_72513;\n        } else {\n            loop_over_72511 = (int64_t) 0;\n        }\n        loop_while_72518 = 1;\n        p_72519 = loop_over_72511;\n        p_72520 = loop_over_72508;\n        p_72521 = loop_over_72509;\n        while (loop_while_72518) {\n            int64_t zs_lhs_72522;\n            int64_t offset_72523;\n            int64_t ai_72524;\n            int64_t max_arg1_72525;\n            int64_t max_res_72526;\n            bool cond_72527;\n            int64_t b_prev_72528;\n            bool cond_72536;\n            int64_t loopres_72537;\n            int64_t loopres_72538;\n            int64_t loopres_72539;\n            bool loopres_72540;\n            bool loop_while_tmp_78860;\n            int64_t p_tmp_78861;\n            int64_t p_tmp_78862;\n            int64_t p_tmp_78863;\n            \n            zs_lhs_72522 = sub64(p_72520, p_72519);\n            offset_72523 = sdiv64(zs_lhs_72522, (int64_t) 2);\n            ai_72524 = sub64(p_72520, offset_72523);\n            max_arg1_72525 = add64(p_72521, offset_72523);\n            max_res_72526 = smax64((int64_t) 0, max_arg1_72525);\n            cond_72527 = slt64((int64_t) 0, max_res_72526);\n            if (cond_72527) {\n                int64_t tmp_72529;\n                bool x_72530;\n                bool y_72531;\n                bool bounds_check_72532;\n                bool index_certs_72533;\n                int64_t slice_72534;\n                int64_t b_prev_t_res_72535;\n                \n                tmp_72529 = sub64(max_res_72526, (int64_t) 1);\n                x_72530 = sle64((int64_t) 0, tmp_72529);\n                y_72531 =", " slt64(tmp_72529, nR_49324);\n                bounds_check_72532 = x_72530 && y_72531;\n                if (!bounds_check_72532) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 108) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_72529;\n                            global_failure_args[1] = (int64_t) nR_49324;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_72534 = tS_start_66998 + tmp_72529;\n                b_prev_t_res_72535 = ((__global int64_t *) tS_mem_77626)[slice_72534];\n                b_prev_72528 = b_prev_t_res_72535;\n            } else {\n                b_prev_72528 = lowest_77569;\n            }\n            cond_72536 = sle64(ai_72524, (int64_t) 0);\n            if (cond_72536) {\n                loopres_72537 = p_72519;\n                loopres_72538 = (int64_t) 0;\n                loopres_72539 = max_res_72526;\n                loopres_72540 = 0;\n            } else {\n                bool cond_72541;\n                int64_t loopres_f_res_72542;\n                int64_t loopres_f_res_72543;\n                int64_t loopres_f_res_72544;\n                bool loopres_f_res_72545;\n                \n                cond_72541 = sle64(nR_49324, max_res_72526);\n                if (cond_72541) {\n                    int64_t min_arg1_72546;\n                    int64_t min_res_72547;\n                    bool x_72548;\n                    bool y_72549;\n                    bool bounds_check_72550;\n                    bool index_certs_72551;\n                    bool x_72554;\n                    bool y_72555;\n                    bool bounds_check_72556;\n                    bool index_certs_72557;\n                    int64_t slice_72552;\n                    int64_t leq_lhs_72553;\n                    int64_t leq_rhs_72558;\n                    bool defunc_0_leq_res_72559;\n                    int64_t loopres_f", "_res_t_res_72560;\n                    bool x_72561;\n                    int64_t loopres_f_res_t_res_72562;\n                    \n                    min_arg1_72546 = sub64(nR_49324, (int64_t) 1);\n                    min_res_72547 = smin64(ai_72524, min_arg1_72546);\n                    x_72548 = sle64((int64_t) 0, min_arg1_72546);\n                    y_72549 = slt64(min_arg1_72546, nR_49324);\n                    bounds_check_72550 = x_72548 && y_72549;\n                    if (!bounds_check_72550) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 109) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_72546;\n                                global_failure_args[1] = (int64_t) nR_49324;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_72554 = sle64((int64_t) 0, min_res_72547);\n                    y_72555 = slt64(min_res_72547, nR_49324);\n                    bounds_check_72556 = x_72554 && y_72555;\n                    if (!bounds_check_72556) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 110) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_72547;\n                                global_failure_args[1] = (int64_t) nR_49324;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_72552 = tS_start_66998 + min_arg1_72546;\n                    leq_lhs_72553 = ((__global int64_t *) tS_mem_77626)[slice_72552];\n                    leq_rhs_72558 = ((__global int64_t *) tR_mem_77625)[min_res_72547];\n                    defunc_0_leq_res_72559 = sle64(leq_lhs_72553, leq_rhs_72558);\n                    if (defunc_0_leq_res_72559) {\n                        loopres_f_res_t",
                                    "_res_72560 = ai_72524;\n                    } else {\n                        loopres_f_res_t_res_72560 = p_72520;\n                    }\n                    x_72561 = !defunc_0_leq_res_72559;\n                    if (defunc_0_leq_res_72559) {\n                        loopres_f_res_t_res_72562 = nR_49324;\n                    } else {\n                        int64_t tmp_72563 = sub64(min_arg1_72546, offset_72523);\n                        \n                        loopres_f_res_t_res_72562 = tmp_72563;\n                    }\n                    loopres_f_res_72542 = p_72519;\n                    loopres_f_res_72543 = loopres_f_res_t_res_72560;\n                    loopres_f_res_72544 = loopres_f_res_t_res_72562;\n                    loopres_f_res_72545 = x_72561;\n                } else {\n                    bool cond_72564;\n                    int64_t loopres_f_res_f_res_72565;\n                    int64_t loopres_f_res_f_res_72566;\n                    int64_t loopres_f_res_f_res_72567;\n                    bool loopres_f_res_f_res_72568;\n                    \n                    cond_72564 = sle64(nR_49324, ai_72524);\n                    if (cond_72564) {\n                        int64_t min_arg1_72569;\n                        int64_t min_res_72570;\n                        bool x_72571;\n                        bool y_72572;\n                        bool bounds_check_72573;\n                        bool index_certs_72574;\n                        bool x_72576;\n                        bool y_72577;\n                        bool bounds_check_72578;\n                        bool index_certs_72579;\n                        int64_t leq_lhs_72575;\n                        int64_t slice_72580;\n                        int64_t leq_rhs_72581;\n                        bool defunc_0_leq_res_72582;\n                        int64_t loopres_f_res_f_res_t_res_72583;\n                        bool x_72584;\n                        int64_t loopres_f_res_f_res_t_res_72585;\n                        \n              ", "          min_arg1_72569 = sub64(nR_49324, (int64_t) 1);\n                        min_res_72570 = smin64(max_res_72526, min_arg1_72569);\n                        x_72571 = sle64((int64_t) 0, min_arg1_72569);\n                        y_72572 = slt64(min_arg1_72569, nR_49324);\n                        bounds_check_72573 = x_72571 && y_72572;\n                        if (!bounds_check_72573) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 111) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_72569;\n                                    global_failure_args[1] = (int64_t) nR_49324;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_72576 = sle64((int64_t) 0, min_res_72570);\n                        y_72577 = slt64(min_res_72570, nR_49324);\n                        bounds_check_72578 = x_72576 && y_72577;\n                        if (!bounds_check_72578) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 112) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_72570;\n                                    global_failure_args[1] = (int64_t) nR_49324;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_72575 = ((__global int64_t *) tR_mem_77625)[min_arg1_72569];\n                        slice_72580 = tS_start_66998 + min_res_72570;\n                        leq_rhs_72581 = ((__global int64_t *) tS_mem_77626)[slice_72580];\n                        defunc_0_leq_res_72582 = sle64(leq_lhs_72575, leq_rhs_72581);\n                        if (defunc_0_leq_res_72582) {\n                            loopres_f_res_f_", "res_t_res_72583 = max_res_72526;\n                        } else {\n                            loopres_f_res_f_res_t_res_72583 = p_72521;\n                        }\n                        x_72584 = !defunc_0_leq_res_72582;\n                        if (defunc_0_leq_res_72582) {\n                            loopres_f_res_f_res_t_res_72585 = nR_49324;\n                        } else {\n                            loopres_f_res_f_res_t_res_72585 = min_arg1_72569;\n                        }\n                        loopres_f_res_f_res_72565 = p_72519;\n                        loopres_f_res_f_res_72566 = loopres_f_res_f_res_t_res_72585;\n                        loopres_f_res_f_res_72567 = loopres_f_res_f_res_t_res_72583;\n                        loopres_f_res_f_res_72568 = x_72584;\n                    } else {\n                        bool cond_72586;\n                        int64_t loopres_f_res_f_res_f_res_72587;\n                        int64_t loopres_f_res_f_res_f_res_72588;\n                        int64_t loopres_f_res_f_res_f_res_72589;\n                        bool loopres_f_res_f_res_f_res_72590;\n                        \n                        cond_72586 = sle64(p_72520, p_72519);\n                        if (cond_72586) {\n                            bool cond_72591;\n                            int64_t ai_72592;\n                            bool x_72605;\n                            bool y_72606;\n                            bool bounds_check_72607;\n                            bool index_certs_72608;\n                            int64_t b_prev_72594;\n                            int64_t gt_lhs_72609;\n                            bool defunc_0_gt_res_72610;\n                            int64_t defunc_0_partFunc_sequential_search_res_72611;\n                            int64_t defunc_0_partFunc_sequential_search_res_72612;\n                            \n                            cond_72591 = slt64(ai_72524, nR_49324);\n                            if (cond_72591) {\n                      ",
                                    "          ai_72592 = ai_72524;\n                            } else {\n                                int64_t ai_f_res_72593 = sub64(nR_49324, (int64_t) 1);\n                                \n                                ai_72592 = ai_f_res_72593;\n                            }\n                            x_72605 = sle64((int64_t) 0, ai_72592);\n                            y_72606 = slt64(ai_72592, nR_49324);\n                            bounds_check_72607 = x_72605 && y_72606;\n                            if (!bounds_check_72607) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 113) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_72592;\n                                        global_failure_args[1] = (int64_t) nR_49324;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_72527) {\n                                int64_t tmp_72595;\n                                bool x_72596;\n                                bool y_72597;\n                                bool bounds_check_72598;\n                                bool index_certs_72599;\n                                int64_t slice_72600;\n                                int64_t b_prev_t_res_72601;\n                                \n                                tmp_72595 = sub64(max_res_72526, (int64_t) 1);\n                                x_72596 = sle64((int64_t) 0, tmp_72595);\n                                y_72597 = slt64(tmp_72595, nR_49324);\n                                bounds_check_72598 = x_72596 && y_72597;\n                                if (!bounds_check_72598) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 114) == -1) {\n                              ", "              global_failure_args[0] = (int64_t) tmp_72595;\n                                            global_failure_args[1] = (int64_t) nR_49324;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_72600 = tS_start_66998 + tmp_72595;\n                                b_prev_t_res_72601 = ((__global int64_t *) tS_mem_77626)[slice_72600];\n                                b_prev_72594 = b_prev_t_res_72601;\n                            } else {\n                                bool y_72602;\n                                bool index_certs_72603;\n                                int64_t b_prev_f_res_72604;\n                                \n                                y_72602 = slt64((int64_t) 0, nR_49324);\n                                if (!y_72602) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 115) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_49324;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_72604 = ((__global int64_t *) tS_mem_77626)[tS_start_66998];\n                                b_prev_72594 = b_prev_f_res_72604;\n                            }\n                            gt_lhs_72609 = ((__global int64_t *) tR_mem_77625)[ai_72592];\n                            defunc_0_gt_res_72610 = slt64(b_prev_72594, gt_lhs_72609);\n                            if (defunc_0_gt_res_72610) {\n                                int64_t zl_rhs_72613;\n                         ", "       bool loop_cond_72614;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_72615;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_72616;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_72617;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_72618;\n                                bool loop_while_72619;\n                                int64_t p_72620;\n                                int64_t p_72621;\n                                int64_t p_72622;\n                                \n                                zl_rhs_72613 = sub64(nR_49324, max_res_72526);\n                                loop_cond_72614 = slt64((int64_t) 0, zl_rhs_72613);\n                                loop_while_72619 = loop_cond_72614;\n                                p_72620 = ai_72592;\n                                p_72621 = max_res_72526;\n                                p_72622 = (int64_t) 0;\n                                while (loop_while_72619) {\n                                    int64_t i_a_72623;\n                                    int64_t i_b_72624;\n                                    int64_t leq_lhs_72625;\n                                    bool x_72626;\n                                    bool y_72627;\n                                    bool bounds_check_72628;\n                                    bool index_certs_72629;\n                                    bool x_72631;\n                                    bool y_72632;\n                                    bool bounds_check_72633;\n                                    bool index_certs_72634;\n                                    int64_t leq_lhs_72630;\n                                    int64_t slice_72635;\n                                    int64_t leq_rhs_72636;\n                                    bool defunc_0_leq_res_72637;\n                                    int64_t loopres_72638;\n   ",
                                    "                                 int64_t loopres_72639;\n                                    int64_t loopres_72640;\n                                    bool loop_cond_72642;\n                                    bool loop_while_tmp_78864;\n                                    int64_t p_tmp_78865;\n                                    int64_t p_tmp_78866;\n                                    int64_t p_tmp_78867;\n                                    \n                                    i_a_72623 = sub64(ai_72592, p_72622);\n                                    i_b_72624 = add64(max_res_72526, p_72622);\n                                    leq_lhs_72625 = sub64(i_a_72623, (int64_t) 1);\n                                    x_72626 = sle64((int64_t) 0, leq_lhs_72625);\n                                    y_72627 = slt64(leq_lhs_72625, nR_49324);\n                                    bounds_check_72628 = x_72626 && y_72627;\n                                    if (!bounds_check_72628) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 116) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_72625;\n                                                global_failure_args[1] = (int64_t) nR_49324;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_72631 = sle64((int64_t) 0, i_b_72624);\n                                    y_72632 = slt64(i_b_72624, nR_49324);\n                                    bounds_check_72633 = x_72631 && y_72632;\n                                    if (!bounds_check_72633) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 117) == -1) {\n           ", "                                     global_failure_args[0] = (int64_t) i_b_72624;\n                                                global_failure_args[1] = (int64_t) nR_49324;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_72630 = ((__global int64_t *) tR_mem_77625)[leq_lhs_72625];\n                                    slice_72635 = tS_start_66998 + i_b_72624;\n                                    leq_rhs_72636 = ((__global int64_t *) tS_mem_77626)[slice_72635];\n                                    defunc_0_leq_res_72637 = sle64(leq_lhs_72630, leq_rhs_72636);\n                                    if (defunc_0_leq_res_72637) {\n                                        loopres_72638 = i_a_72623;\n                                    } else {\n                                        loopres_72638 = ai_72592;\n                                    }\n                                    if (defunc_0_leq_res_72637) {\n                                        loopres_72639 = i_b_72624;\n                                    } else {\n                                        loopres_72639 = max_res_72526;\n                                    }\n                                    if (defunc_0_leq_res_72637) {\n                                        loopres_72640 = zl_rhs_72613;\n                                    } else {\n                                        int64_t tmp_72641 = add64((int64_t) 1, p_72622);\n                                        \n                                        loopres_72640 = tmp_72641;\n                                    }\n                                    loop_cond_72642 = slt64(loopres_72640, zl_rhs_72613);\n                                    loop_while_tmp_78864 = loop_cond_72642;\n                                    p_tmp_78865 = loopres_72638", ";\n                                    p_tmp_78866 = loopres_72639;\n                                    p_tmp_78867 = loopres_72640;\n                                    loop_while_72619 = loop_while_tmp_78864;\n                                    p_72620 = p_tmp_78865;\n                                    p_72621 = p_tmp_78866;\n                                    p_72622 = p_tmp_78867;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_72615 = loop_while_72619;\n                                defunc_0_partFunc_sequential_search_res_t_res_72616 = p_72620;\n                                defunc_0_partFunc_sequential_search_res_t_res_72617 = p_72621;\n                                defunc_0_partFunc_sequential_search_res_t_res_72618 = p_72622;\n                                defunc_0_partFunc_sequential_search_res_72611 = defunc_0_partFunc_sequential_search_res_t_res_72616;\n                                defunc_0_partFunc_sequential_search_res_72612 = defunc_0_partFunc_sequential_search_res_t_res_72617;\n                            } else {\n                                int64_t zl_rhs_72643;\n                                bool loop_cond_72644;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_72645;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_72646;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_72647;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_72648;\n                                bool loop_while_72649;\n                                int64_t p_72650;\n                                int64_t p_72651;\n                                int64_t p_72652;\n                                \n                                zl_rhs_72643 = sub64(max_res_72526, (int64_t) 1);\n                                loop_cond_72644 = slt64((int64_t) 0, zl_rhs_72643);\n          ",
                                    "                      loop_while_72649 = loop_cond_72644;\n                                p_72650 = ai_72592;\n                                p_72651 = max_res_72526;\n                                p_72652 = (int64_t) 0;\n                                while (loop_while_72649) {\n                                    int64_t zp_lhs_72653;\n                                    int64_t hi_a_72654;\n                                    bool cond_72655;\n                                    int64_t i_a_72656;\n                                    int64_t zm_lhs_72658;\n                                    int64_t i_b_72659;\n                                    bool x_72660;\n                                    bool y_72661;\n                                    bool bounds_check_72662;\n                                    bool index_certs_72663;\n                                    bool x_72665;\n                                    bool y_72666;\n                                    bool bounds_check_72667;\n                                    bool index_certs_72668;\n                                    int64_t gt_lhs_72664;\n                                    int64_t slice_72669;\n                                    int64_t gt_rhs_72670;\n                                    bool defunc_0_gt_res_72671;\n                                    int64_t loopres_72672;\n                                    int64_t loopres_72673;\n                                    int64_t loopres_72674;\n                                    bool loop_cond_72676;\n                                    bool loop_while_tmp_78868;\n                                    int64_t p_tmp_78869;\n                                    int64_t p_tmp_78870;\n                                    int64_t p_tmp_78871;\n                                    \n                                    zp_lhs_72653 = add64(ai_72592, p_72652);\n                                    hi_a_72654 = add64((int64_t) 1, zp_lhs_72653);\n                                    con", "d_72655 = slt64(hi_a_72654, nR_49324);\n                                    if (cond_72655) {\n                                        i_a_72656 = hi_a_72654;\n                                    } else {\n                                        int64_t i_a_f_res_72657 = sub64(nR_49324, (int64_t) 1);\n                                        \n                                        i_a_72656 = i_a_f_res_72657;\n                                    }\n                                    zm_lhs_72658 = sub64(max_res_72526, p_72652);\n                                    i_b_72659 = sub64(zm_lhs_72658, (int64_t) 1);\n                                    x_72660 = sle64((int64_t) 0, i_a_72656);\n                                    y_72661 = slt64(i_a_72656, nR_49324);\n                                    bounds_check_72662 = x_72660 && y_72661;\n                                    if (!bounds_check_72662) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 118) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_72656;\n                                                global_failure_args[1] = (int64_t) nR_49324;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_72665 = sle64((int64_t) 0, i_b_72659);\n                                    y_72666 = slt64(i_b_72659, nR_49324);\n                                    bounds_check_72667 = x_72665 && y_72666;\n                                    if (!bounds_check_72667) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 119) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_72659;", "\n                                                global_failure_args[1] = (int64_t) nR_49324;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_72664 = ((__global int64_t *) tR_mem_77625)[i_a_72656];\n                                    slice_72669 = tS_start_66998 + i_b_72659;\n                                    gt_rhs_72670 = ((__global int64_t *) tS_mem_77626)[slice_72669];\n                                    defunc_0_gt_res_72671 = slt64(gt_rhs_72670, gt_lhs_72664);\n                                    if (defunc_0_gt_res_72671) {\n                                        loopres_72672 = i_a_72656;\n                                    } else {\n                                        loopres_72672 = ai_72592;\n                                    }\n                                    if (defunc_0_gt_res_72671) {\n                                        loopres_72673 = zm_lhs_72658;\n                                    } else {\n                                        loopres_72673 = max_res_72526;\n                                    }\n                                    if (defunc_0_gt_res_72671) {\n                                        loopres_72674 = zl_rhs_72643;\n                                    } else {\n                                        int64_t tmp_72675 = add64((int64_t) 1, p_72652);\n                                        \n                                        loopres_72674 = tmp_72675;\n                                    }\n                                    loop_cond_72676 = slt64(loopres_72674, zl_rhs_72643);\n                                    loop_while_tmp_78868 = loop_cond_72676;\n                                    p_tmp_78869 = loopres_72672;\n                                    p_tmp_78870 = loopres_72673;\n                        ",
                                    "            p_tmp_78871 = loopres_72674;\n                                    loop_while_72649 = loop_while_tmp_78868;\n                                    p_72650 = p_tmp_78869;\n                                    p_72651 = p_tmp_78870;\n                                    p_72652 = p_tmp_78871;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_72645 = loop_while_72649;\n                                defunc_0_partFunc_sequential_search_res_f_res_72646 = p_72650;\n                                defunc_0_partFunc_sequential_search_res_f_res_72647 = p_72651;\n                                defunc_0_partFunc_sequential_search_res_f_res_72648 = p_72652;\n                                defunc_0_partFunc_sequential_search_res_72611 = defunc_0_partFunc_sequential_search_res_f_res_72646;\n                                defunc_0_partFunc_sequential_search_res_72612 = defunc_0_partFunc_sequential_search_res_f_res_72647;\n                            }\n                            loopres_f_res_f_res_f_res_72587 = p_72519;\n                            loopres_f_res_f_res_f_res_72588 = defunc_0_partFunc_sequential_search_res_72611;\n                            loopres_f_res_f_res_f_res_72589 = defunc_0_partFunc_sequential_search_res_72612;\n                            loopres_f_res_f_res_f_res_72590 = 0;\n                        } else {\n                            bool x_72677;\n                            bool y_72678;\n                            bool bounds_check_72679;\n                            bool index_certs_72680;\n                            int64_t gt_lhs_72681;\n                            bool defunc_0_gt_res_72682;\n                            int64_t loopres_f_res_f_res_f_res_f_res_72683;\n                            int64_t loopres_f_res_f_res_f_res_f_res_72684;\n                            int64_t loopres_f_res_f_res_f_res_f_res_72685;\n                            bool loopres_f_res_f_res_f_res_f_res_72686;\n       ", "                     \n                            x_72677 = sle64((int64_t) 0, ai_72524);\n                            y_72678 = slt64(ai_72524, nR_49324);\n                            bounds_check_72679 = x_72677 && y_72678;\n                            if (!bounds_check_72679) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 120) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_72524;\n                                        global_failure_args[1] = (int64_t) nR_49324;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_72681 = ((__global int64_t *) tR_mem_77625)[ai_72524];\n                            defunc_0_gt_res_72682 = slt64(b_prev_72528, gt_lhs_72681);\n                            if (defunc_0_gt_res_72682) {\n                                int64_t leq_lhs_72687;\n                                bool x_72688;\n                                bool y_72689;\n                                bool bounds_check_72690;\n                                bool index_certs_72691;\n                                bool x_72693;\n                                bool y_72694;\n                                bool bounds_check_72695;\n                                bool index_certs_72696;\n                                int64_t leq_lhs_72692;\n                                int64_t slice_72697;\n                                int64_t leq_rhs_72698;\n                                bool defunc_0_leq_res_72699;\n                                bool x_72700;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_72701;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_72702;\n                                \n                                leq_lhs_72687 = sub64(ai_", "72524, (int64_t) 1);\n                                x_72688 = sle64((int64_t) 0, leq_lhs_72687);\n                                y_72689 = slt64(leq_lhs_72687, nR_49324);\n                                bounds_check_72690 = x_72688 && y_72689;\n                                if (!bounds_check_72690) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 121) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_72687;\n                                            global_failure_args[1] = (int64_t) nR_49324;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_72693 = sle64((int64_t) 0, max_res_72526);\n                                y_72694 = slt64(max_res_72526, nR_49324);\n                                bounds_check_72695 = x_72693 && y_72694;\n                                if (!bounds_check_72695) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 122) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_72526;\n                                            global_failure_args[1] = (int64_t) nR_49324;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_72692 = ((__global int64_t *) tR_mem_77625)[leq_lhs_72687];\n                                slice_72697 = tS_start_66998 + max_res_72526;\n                                leq_rhs_72698 = ((__global int64_t *) tS_mem_77626)[slice_72697];\n                                defunc_0_leq_res_72699 = sle64(leq_lhs_",
                                    "72692, leq_rhs_72698);\n                                x_72700 = !defunc_0_leq_res_72699;\n                                if (defunc_0_leq_res_72699) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_72701 = ai_72524;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_72701 = leq_lhs_72687;\n                                }\n                                if (defunc_0_leq_res_72699) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_72702 = max_res_72526;\n                                } else {\n                                    int64_t tmp_72703 = add64((int64_t) 1, max_res_72526);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_72702 = tmp_72703;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_72683 = p_72519;\n                                loopres_f_res_f_res_f_res_f_res_72684 = loopres_f_res_f_res_f_res_f_res_t_res_72701;\n                                loopres_f_res_f_res_f_res_f_res_72685 = loopres_f_res_f_res_f_res_f_res_t_res_72702;\n                                loopres_f_res_f_res_f_res_f_res_72686 = x_72700;\n                            } else {\n                                int64_t tmp_72704 = add64((int64_t) 1, ai_72524);\n                                \n                                loopres_f_res_f_res_f_res_f_res_72683 = tmp_72704;\n                                loopres_f_res_f_res_f_res_f_res_72684 = p_72520;\n                                loopres_f_res_f_res_f_res_f_res_72685 = p_72521;\n                                loopres_f_res_f_res_f_res_f_res_72686 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_72587 = loopres_f_res_f_res_f_res_f_res_72683;\n                            loopres_f_res_f_res_f_res_72588 = loopres_f_res_f_res_f_res_f_res_72684;\n                            l", "oopres_f_res_f_res_f_res_72589 = loopres_f_res_f_res_f_res_f_res_72685;\n                            loopres_f_res_f_res_f_res_72590 = loopres_f_res_f_res_f_res_f_res_72686;\n                        }\n                        loopres_f_res_f_res_72565 = loopres_f_res_f_res_f_res_72587;\n                        loopres_f_res_f_res_72566 = loopres_f_res_f_res_f_res_72588;\n                        loopres_f_res_f_res_72567 = loopres_f_res_f_res_f_res_72589;\n                        loopres_f_res_f_res_72568 = loopres_f_res_f_res_f_res_72590;\n                    }\n                    loopres_f_res_72542 = loopres_f_res_f_res_72565;\n                    loopres_f_res_72543 = loopres_f_res_f_res_72566;\n                    loopres_f_res_72544 = loopres_f_res_f_res_72567;\n                    loopres_f_res_72545 = loopres_f_res_f_res_72568;\n                }\n                loopres_72537 = loopres_f_res_72542;\n                loopres_72538 = loopres_f_res_72543;\n                loopres_72539 = loopres_f_res_72544;\n                loopres_72540 = loopres_f_res_72545;\n            }\n            loop_while_tmp_78860 = loopres_72540;\n            p_tmp_78861 = loopres_72537;\n            p_tmp_78862 = loopres_72538;\n            p_tmp_78863 = loopres_72539;\n            loop_while_72518 = loop_while_tmp_78860;\n            p_72519 = p_tmp_78861;\n            p_72520 = p_tmp_78862;\n            p_72521 = p_tmp_78863;\n        }\n        defunc_0_f_res_72514 = loop_while_72518;\n        defunc_0_f_res_72515 = p_72519;\n        defunc_0_f_res_72516 = p_72520;\n        defunc_0_f_res_72517 = p_72521;\n        ((__global int64_t *) mem_77662)[gtid_72502] = defunc_0_f_res_72516;\n        ((__global int64_t *) mem_77664)[gtid_72502] = defunc_0_f_res_72517;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72498\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_72877_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_72877(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failu", "re_args, int64_t nR_49324, int64_t gt_rhs_66981, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t zeze_rhs_67414, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77644, __global unsigned char *mem_77646, __global unsigned char *mem_77680, __global unsigned char *mem_77682)\n{\n    #define segmap_tblock_sizze_72872 (inner_SMJ_longzisegmap_72877zisegmap_tblock_sizze_72872)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78876;\n    int32_t tblock_sizze_78879;\n    int32_t wave_sizze_78878;\n    int32_t block_id_78877;\n    int32_t global_tid_78875;\n    int64_t phys_tid_72877;\n    int64_t global_tid_78880;\n    int64_t slice_78881;\n    int64_t gtid_72876;\n    int64_t remnant_78882;\n    \n    local_tid_78876 = get_local_id(0);\n    tblock_sizze_78879 = get_local_size(0);\n    wave_sizze_78878 = LOCKSTEP_WIDTH;\n    block_id_78877 = get_tblock_id(0);\n    global_tid_78875 = block_id_78877 * tblock_sizze_78879 + local_tid_78876;\n    phys_tid_72877 = sext_i32_i64(global_tid_78875);\n    global_tid_78880 = sext_i32_i64(block_id_78877) * segmap_tblock_sizze_72872 + sext_i32_i64(local_tid_78876);\n    slice_78881 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n    gtid_72876 = global_tid_78880;\n    remnant_78882 = global_tid_78880 - gtid_72876;\n    if (slt64(gtid_72876, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140)) {\n        int64_t eta_p_72879;\n        int64_t min_res_72880;\n        bool x_72881;\n        bool y_72882;\n        bool bounds_check_72883;\n        bool index_certs_72884;\n        bool cond_72886;\n        int64_t ri_next_72887;\n        int64_t max_arg1_72894;\n        int64_t max_res_72895;\n        bool x_72896;\n        bool y_72897;\n        bool bounds_check_72898;\n        bool index_certs_72899;\n        int64_t r_min_72885;\n        int64_t r_max_72900;\n        bool defunc_0_f_res_72901;\n       ",
                                    " int64_t defunc_0_f_res_72902;\n        bool loop_while_72903;\n        int64_t fm_72904;\n        bool defunc_0_f_res_72970;\n        int64_t defunc_0_f_res_72971;\n        bool loop_while_72972;\n        int64_t lm_72973;\n        \n        eta_p_72879 = ((__global int64_t *) mem_77644)[gtid_72876];\n        min_res_72880 = smin64(gt_rhs_66981, eta_p_72879);\n        x_72881 = sle64((int64_t) 0, min_res_72880);\n        y_72882 = slt64(min_res_72880, nR_49324);\n        bounds_check_72883 = x_72881 && y_72882;\n        if (!bounds_check_72883) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 123) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_72880;\n                    global_failure_args[1] = (int64_t) nR_49324;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_72886 = gtid_72876 == zeze_rhs_67414;\n        if (cond_72886) {\n            ri_next_72887 = nR_49324;\n        } else {\n            int64_t tmp_72888;\n            bool x_72889;\n            bool y_72890;\n            bool bounds_check_72891;\n            bool index_certs_72892;\n            int64_t ri_next_f_res_72893;\n            \n            tmp_72888 = add64((int64_t) 1, gtid_72876);\n            x_72889 = sle64((int64_t) 0, tmp_72888);\n            y_72890 = slt64(tmp_72888, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_72891 = x_72889 && y_72890;\n            if (!bounds_check_72891) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 124) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_72888;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_72893 = ((__global int64_t *) mem_77644)[tmp_72888];\n   ", "         ri_next_72887 = ri_next_f_res_72893;\n        }\n        max_arg1_72894 = sub64(ri_next_72887, (int64_t) 1);\n        max_res_72895 = smax64((int64_t) 0, max_arg1_72894);\n        x_72896 = sle64((int64_t) 0, max_res_72895);\n        y_72897 = slt64(max_res_72895, nR_49324);\n        bounds_check_72898 = x_72896 && y_72897;\n        if (!bounds_check_72898) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 125) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_72895;\n                    global_failure_args[1] = (int64_t) nR_49324;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_72885 = ((__global int64_t *) tR_mem_77625)[min_res_72880];\n        r_max_72900 = ((__global int64_t *) tR_mem_77625)[max_res_72895];\n        loop_while_72903 = 1;\n        fm_72904 = gtid_72876;\n        while (loop_while_72903) {\n            bool x_72905;\n            bool y_72906;\n            bool bounds_check_72907;\n            bool index_certs_72908;\n            int64_t loopres_72909;\n            int64_t min_res_72910;\n            bool x_72911;\n            bool y_72912;\n            bool bounds_check_72913;\n            bool index_certs_72914;\n            bool cond_72917;\n            int64_t si_next_72918;\n            int64_t max_arg1_72925;\n            int64_t max_res_72926;\n            bool x_72927;\n            bool y_72928;\n            bool bounds_check_72929;\n            bool index_certs_72930;\n            int64_t min_res_72933;\n            bool x_72934;\n            bool y_72935;\n            bool bounds_check_72936;\n            bool index_certs_72937;\n            int64_t max_arg1_72940;\n            int64_t max_res_72941;\n            bool x_72942;\n            bool y_72943;\n            bool bounds_check_72944;\n            bool index_certs_72945;\n            int64_t slice_72915;\n            int64_t s_min_72916;\n            int64_t slice_72931;\n            int64_t slice_72938;\n       ", "     int64_t slice_72946;\n            bool defunc_0_gt_res_72948;\n            bool loopres_72949;\n            int64_t loopres_72950;\n            bool loop_while_tmp_78883;\n            int64_t fm_tmp_78884;\n            \n            x_72905 = sle64((int64_t) 0, fm_72904);\n            y_72906 = slt64(fm_72904, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_72907 = x_72905 && y_72906;\n            if (!bounds_check_72907) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 126) == -1) {\n                        global_failure_args[0] = (int64_t) fm_72904;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_72909 = ((__global int64_t *) mem_77646)[fm_72904];\n            min_res_72910 = smin64(gt_rhs_66981, loopres_72909);\n            x_72911 = sle64((int64_t) 0, min_res_72910);\n            y_72912 = slt64(min_res_72910, nR_49324);\n            bounds_check_72913 = x_72911 && y_72912;\n            if (!bounds_check_72913) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 127) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72910;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_72917 = sle64(zeze_rhs_67414, fm_72904);\n            if (cond_72917) {\n                si_next_72918 = nR_49324;\n            } else {\n                int64_t tmp_72919;\n                bool x_72920;\n                bool y_72921;\n                bool bounds_check_72922;\n                bool index_certs_72923;\n                int64_t si_next_f_res_72924;\n                \n                tmp_72919 = add64((int64",
                                    "_t) 1, fm_72904);\n                x_72920 = sle64((int64_t) 0, tmp_72919);\n                y_72921 = slt64(tmp_72919, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_72922 = x_72920 && y_72921;\n                if (!bounds_check_72922) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 128) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_72919;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_72924 = ((__global int64_t *) mem_77646)[tmp_72919];\n                si_next_72918 = si_next_f_res_72924;\n            }\n            max_arg1_72925 = sub64(si_next_72918, (int64_t) 1);\n            max_res_72926 = smax64(min_res_72910, max_arg1_72925);\n            x_72927 = sle64((int64_t) 0, max_res_72926);\n            y_72928 = slt64(max_res_72926, nR_49324);\n            bounds_check_72929 = x_72927 && y_72928;\n            if (!bounds_check_72929) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 129) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72926;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_72933 = smin64(zeze_rhs_67414, si_next_72918);\n            x_72934 = sle64((int64_t) 0, min_res_72933);\n            y_72935 = slt64(min_res_72933, nR_49324);\n            bounds_check_72936 = x_72934 && y_72935;\n            if (!bounds_check_72936) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 130) == -1) {\n                        global_failure_args[0] = (int64_t) ", "min_res_72933;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_72940 = sub64(min_res_72910, (int64_t) 1);\n            max_res_72941 = smax64((int64_t) 0, max_arg1_72940);\n            x_72942 = sle64((int64_t) 0, max_res_72941);\n            y_72943 = slt64(max_res_72941, nR_49324);\n            bounds_check_72944 = x_72942 && y_72943;\n            if (!bounds_check_72944) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 131) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72941;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_72915 = tS_start_66998 + min_res_72910;\n            s_min_72916 = ((__global int64_t *) tS_mem_77626)[slice_72915];\n            slice_72931 = tS_start_66998 + max_res_72926;\n            slice_72938 = tS_start_66998 + min_res_72933;\n            slice_72946 = tS_start_66998 + max_res_72941;\n            defunc_0_gt_res_72948 = slt64(s_min_72916, r_min_72885);\n            if (defunc_0_gt_res_72948) {\n                int64_t s_max_72932;\n                bool defunc_0_leq_res_72951;\n                bool loopres_t_res_72952;\n                int64_t loopres_t_res_72953;\n                \n                s_max_72932 = ((__global int64_t *) tS_mem_77626)[slice_72931];\n                defunc_0_leq_res_72951 = sle64(r_min_72885, s_max_72932);\n                if (defunc_0_leq_res_72951) {\n                    loopres_t_res_72952 = 0;\n                    loopres_t_res_72953 = fm_72904;\n                } else {\n                    int64_t s_nextMin_72939;\n                    bool defunc_0_leq_res_72954;\n                    int64_t zgze_lhs_72955;\n                    bool tmp_f_res_72956;\n                 ", "   bool x_72957;\n                    bool y_72958;\n                    bool tmp_72959;\n                    bool loopres_t_res_f_res_72960;\n                    \n                    s_nextMin_72939 = ((__global int64_t *) tS_mem_77626)[slice_72938];\n                    defunc_0_leq_res_72954 = sle64(r_min_72885, s_nextMin_72939);\n                    zgze_lhs_72955 = add64((int64_t) 1, fm_72904);\n                    tmp_f_res_72956 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zgze_lhs_72955);\n                    x_72957 = !defunc_0_leq_res_72954;\n                    y_72958 = tmp_f_res_72956 && x_72957;\n                    tmp_72959 = defunc_0_leq_res_72954 || y_72958;\n                    loopres_t_res_f_res_72960 = !tmp_72959;\n                    loopres_t_res_72952 = loopres_t_res_f_res_72960;\n                    loopres_t_res_72953 = zgze_lhs_72955;\n                }\n                loopres_72949 = loopres_t_res_72952;\n                loopres_72950 = loopres_t_res_72953;\n            } else {\n                int64_t s_prevMax_72947;\n                bool defunc_0_leq_res_72961;\n                int64_t zlze_lhs_72962;\n                bool tmp_f_res_72963;\n                bool x_72964;\n                bool y_72965;\n                bool tmp_72966;\n                int64_t max_res_72967;\n                bool loopres_f_res_72968;\n                \n                s_prevMax_72947 = ((__global int64_t *) tS_mem_77626)[slice_72946];\n                defunc_0_leq_res_72961 = sle64(s_prevMax_72947, r_min_72885);\n                zlze_lhs_72962 = sub64(fm_72904, (int64_t) 1);\n                tmp_f_res_72963 = sle64(zlze_lhs_72962, (int64_t) 0);\n                x_72964 = !defunc_0_leq_res_72961;\n                y_72965 = tmp_f_res_72963 && x_72964;\n                tmp_72966 = defunc_0_leq_res_72961 || y_72965;\n                max_res_72967 = smax64((int64_t) 0, zlze_lhs_72962);\n                loopres_f_res_72968 = !tmp_72966;\n                loopres_7",
                                    "2949 = loopres_f_res_72968;\n                loopres_72950 = max_res_72967;\n            }\n            loop_while_tmp_78883 = loopres_72949;\n            fm_tmp_78884 = loopres_72950;\n            loop_while_72903 = loop_while_tmp_78883;\n            fm_72904 = fm_tmp_78884;\n        }\n        defunc_0_f_res_72901 = loop_while_72903;\n        defunc_0_f_res_72902 = fm_72904;\n        loop_while_72972 = 1;\n        lm_72973 = gtid_72876;\n        while (loop_while_72972) {\n            bool x_72974;\n            bool y_72975;\n            bool bounds_check_72976;\n            bool index_certs_72977;\n            int64_t loopres_72978;\n            int64_t min_res_72979;\n            bool x_72980;\n            bool y_72981;\n            bool bounds_check_72982;\n            bool index_certs_72983;\n            bool cond_72986;\n            int64_t si_next_72987;\n            int64_t max_arg1_72994;\n            int64_t max_res_72995;\n            bool x_72996;\n            bool y_72997;\n            bool bounds_check_72998;\n            bool index_certs_72999;\n            int64_t min_res_73002;\n            bool x_73003;\n            bool y_73004;\n            bool bounds_check_73005;\n            bool index_certs_73006;\n            int64_t max_arg1_73009;\n            int64_t max_res_73010;\n            bool x_73011;\n            bool y_73012;\n            bool bounds_check_73013;\n            bool index_certs_73014;\n            int64_t slice_72984;\n            int64_t slice_73000;\n            int64_t s_max_73001;\n            int64_t slice_73007;\n            int64_t slice_73015;\n            bool defunc_0_gt_res_73017;\n            bool loopres_73018;\n            int64_t loopres_73019;\n            bool loop_cond_t_res_73034;\n            bool x_73035;\n            bool loop_while_tmp_78885;\n            int64_t lm_tmp_78886;\n            \n            x_72974 = sle64((int64_t) 0, lm_72973);\n            y_72975 = slt64(lm_72973, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            b", "ounds_check_72976 = x_72974 && y_72975;\n            if (!bounds_check_72976) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 132) == -1) {\n                        global_failure_args[0] = (int64_t) lm_72973;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_72978 = ((__global int64_t *) mem_77646)[lm_72973];\n            min_res_72979 = smin64(gt_rhs_66981, loopres_72978);\n            x_72980 = sle64((int64_t) 0, min_res_72979);\n            y_72981 = slt64(min_res_72979, nR_49324);\n            bounds_check_72982 = x_72980 && y_72981;\n            if (!bounds_check_72982) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 133) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72979;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_72986 = sle64(zeze_rhs_67414, lm_72973);\n            if (cond_72986) {\n                si_next_72987 = nR_49324;\n            } else {\n                int64_t tmp_72988;\n                bool x_72989;\n                bool y_72990;\n                bool bounds_check_72991;\n                bool index_certs_72992;\n                int64_t si_next_f_res_72993;\n                \n                tmp_72988 = add64((int64_t) 1, lm_72973);\n                x_72989 = sle64((int64_t) 0, tmp_72988);\n                y_72990 = slt64(tmp_72988, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_72991 = x_72989 && y_72990;\n                if (!bounds_check_72991) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 134) == ", "-1) {\n                            global_failure_args[0] = (int64_t) tmp_72988;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_72993 = ((__global int64_t *) mem_77646)[tmp_72988];\n                si_next_72987 = si_next_f_res_72993;\n            }\n            max_arg1_72994 = sub64(si_next_72987, (int64_t) 1);\n            max_res_72995 = smax64(min_res_72979, max_arg1_72994);\n            x_72996 = sle64((int64_t) 0, max_res_72995);\n            y_72997 = slt64(max_res_72995, nR_49324);\n            bounds_check_72998 = x_72996 && y_72997;\n            if (!bounds_check_72998) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 135) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72995;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_73002 = smin64(zeze_rhs_67414, si_next_72987);\n            x_73003 = sle64((int64_t) 0, min_res_73002);\n            y_73004 = slt64(min_res_73002, nR_49324);\n            bounds_check_73005 = x_73003 && y_73004;\n            if (!bounds_check_73005) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 136) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_73002;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_73009 = sub64(min_res_72979, (int64_t) 1);\n            max_res_73010 = smax64((int64_t) 0, max_arg1_73009);\n            x_73011 = sle64((int64_t) 0, max_res_73010);\n            y_",
                                    "73012 = slt64(max_res_73010, nR_49324);\n            bounds_check_73013 = x_73011 && y_73012;\n            if (!bounds_check_73013) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 137) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_73010;\n                        global_failure_args[1] = (int64_t) nR_49324;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_72984 = tS_start_66998 + min_res_72979;\n            slice_73000 = tS_start_66998 + max_res_72995;\n            s_max_73001 = ((__global int64_t *) tS_mem_77626)[slice_73000];\n            slice_73007 = tS_start_66998 + min_res_73002;\n            slice_73015 = tS_start_66998 + max_res_73010;\n            defunc_0_gt_res_73017 = slt64(r_max_72900, s_max_73001);\n            if (defunc_0_gt_res_73017) {\n                int64_t s_min_72985;\n                bool defunc_0_leq_res_73020;\n                bool loopres_t_res_73021;\n                int64_t loopres_t_res_73022;\n                \n                s_min_72985 = ((__global int64_t *) tS_mem_77626)[slice_72984];\n                defunc_0_leq_res_73020 = sle64(s_min_72985, r_max_72900);\n                if (defunc_0_leq_res_73020) {\n                    loopres_t_res_73021 = 0;\n                    loopres_t_res_73022 = lm_72973;\n                } else {\n                    int64_t s_prevMax_73016;\n                    bool defunc_0_leq_res_73023;\n                    int64_t zlze_lhs_73024;\n                    bool tmp_f_res_73025;\n                    bool x_73026;\n                    bool y_73027;\n                    bool tmp_73028;\n                    int64_t max_res_73029;\n                    bool loopres_t_res_f_res_73030;\n                    \n                    s_prevMax_73016 = ((__global int64_t *) tS_mem_77626)[slice_73015];\n                    defunc_0_leq_res_73023 = sle64(s_prevMax_73016, r_max_72900);\n                   ", " zlze_lhs_73024 = sub64(lm_72973, (int64_t) 1);\n                    tmp_f_res_73025 = sle64(zlze_lhs_73024, (int64_t) 0);\n                    x_73026 = !defunc_0_leq_res_73023;\n                    y_73027 = tmp_f_res_73025 && x_73026;\n                    tmp_73028 = defunc_0_leq_res_73023 || y_73027;\n                    max_res_73029 = smax64((int64_t) 0, zlze_lhs_73024);\n                    loopres_t_res_f_res_73030 = !tmp_73028;\n                    loopres_t_res_73021 = loopres_t_res_f_res_73030;\n                    loopres_t_res_73022 = max_res_73029;\n                }\n                loopres_73018 = loopres_t_res_73021;\n                loopres_73019 = loopres_t_res_73022;\n            } else {\n                int64_t s_nextMin_73008;\n                bool defunc_0_leq_res_73031;\n                int64_t tmp_73032;\n                bool loopres_f_res_73033;\n                \n                s_nextMin_73008 = ((__global int64_t *) tS_mem_77626)[slice_73007];\n                defunc_0_leq_res_73031 = sle64(r_max_72900, s_nextMin_73008);\n                tmp_73032 = add64((int64_t) 1, lm_72973);\n                loopres_f_res_73033 = !defunc_0_leq_res_73031;\n                loopres_73018 = loopres_f_res_73033;\n                loopres_73019 = tmp_73032;\n            }\n            loop_cond_t_res_73034 = slt64(loopres_73019, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            x_73035 = loopres_73018 && loop_cond_t_res_73034;\n            loop_while_tmp_78885 = x_73035;\n            lm_tmp_78886 = loopres_73019;\n            loop_while_72972 = loop_while_tmp_78885;\n            lm_72973 = lm_tmp_78886;\n        }\n        defunc_0_f_res_72970 = loop_while_72972;\n        defunc_0_f_res_72971 = lm_72973;\n        ((__global int64_t *) mem_77680)[gtid_72876] = defunc_0_f_res_72902;\n        ((__global int64_t *) mem_77682)[gtid_72876] = defunc_0_f_res_72971;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72872\n}\nFUTHARK_KERNEL_SIZED(inner_SM", "J_longzisegmap_73229_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73229(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77861, int64_t ext_77862, __global unsigned char *mem_param_77698, __global unsigned char *ext_mem_77865, __global unsigned char *mem_77869)\n{\n    #define segmap_tblock_sizze_73225 (inner_SMJ_longzisegmap_73229zisegmap_tblock_sizze_73225)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78998;\n    int32_t tblock_sizze_79001;\n    int32_t wave_sizze_79000;\n    int32_t block_id_78999;\n    int32_t global_tid_78997;\n    int64_t phys_tid_73229;\n    int64_t global_tid_79002;\n    int64_t slice_79003;\n    int64_t gtid_73228;\n    int64_t remnant_79004;\n    \n    local_tid_78998 = get_local_id(0);\n    tblock_sizze_79001 = get_local_size(0);\n    wave_sizze_79000 = LOCKSTEP_WIDTH;\n    block_id_78999 = get_tblock_id(0);\n    global_tid_78997 = block_id_78999 * tblock_sizze_79001 + local_tid_78998;\n    phys_tid_73229 = sext_i32_i64(global_tid_78997);\n    global_tid_79002 = sext_i32_i64(block_id_78999) * segmap_tblock_sizze_73225 + sext_i32_i64(local_tid_78998);\n    slice_79003 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_73228 = global_tid_79002;\n    remnant_79004 = global_tid_79002 - gtid_73228;\n    if (slt64(gtid_73228, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_73230;\n        bool cond_73232;\n        int64_t lifted_lambda_res_73233;\n        \n        eta_p_73230 = ((__global int64_t *) mem_param_77698)[gtid_73228];\n        cond_73232 = slt64(eta_p_73230, (int64_t) 0);\n        if (cond_73232) {\n            int64_t eta_p_73231 = ((__global int64_t *) ext_mem_77865)[ext_77862 + gtid_73228 * ext_77861];\n            \n            lifted_lambda_res_73233 = eta_p_73231;\n        } else {\n            lifted_lambda_res_73233 = eta_p_73230;\n        }\n        ((__global int64_t *) mem_77869)[gtid_73228] = lifted_lambda_res_73233;\n    }\n    \n  error_0:\n    return;\n    ",
                                    "#undef segmap_tblock_sizze_73225\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73250_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73250(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77863, int64_t ext_77864, __global unsigned char *mem_param_77695, __global unsigned char *ext_mem_77866, __global unsigned char *mem_77872)\n{\n    #define segmap_tblock_sizze_73246 (inner_SMJ_longzisegmap_73250zisegmap_tblock_sizze_73246)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79007;\n    int32_t tblock_sizze_79010;\n    int32_t wave_sizze_79009;\n    int32_t block_id_79008;\n    int32_t global_tid_79006;\n    int64_t phys_tid_73250;\n    int64_t global_tid_79011;\n    int64_t slice_79012;\n    int64_t gtid_73249;\n    int64_t remnant_79013;\n    \n    local_tid_79007 = get_local_id(0);\n    tblock_sizze_79010 = get_local_size(0);\n    wave_sizze_79009 = LOCKSTEP_WIDTH;\n    block_id_79008 = get_tblock_id(0);\n    global_tid_79006 = block_id_79008 * tblock_sizze_79010 + local_tid_79007;\n    phys_tid_73250 = sext_i32_i64(global_tid_79006);\n    global_tid_79011 = sext_i32_i64(block_id_79008) * segmap_tblock_sizze_73246 + sext_i32_i64(local_tid_79007);\n    slice_79012 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_73249 = global_tid_79011;\n    remnant_79013 = global_tid_79011 - gtid_73249;\n    if (slt64(gtid_73249, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_73251;\n        int64_t eta_p_73252;\n        int64_t defunc_0_f_res_73253;\n        \n        eta_p_73251 = ((__global int64_t *) mem_param_77695)[gtid_73249];\n        eta_p_73252 = ((__global int64_t *) ext_mem_77866)[ext_77864 + gtid_73249 * ext_77863];\n        defunc_0_f_res_73253 = add64(eta_p_73251, eta_p_73252);\n        ((__global int64_t *) mem_77872)[gtid_73249] = defunc_0_f_res_73253;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73246\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73271_dim1, 1, 1)\nvoid inner_", "SMJ_longzisegmap_73271(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77686, int64_t ctx_param_ext_77687, __global unsigned char *mem_param_77688, __global unsigned char *ext_mem_77877, __global unsigned char *mem_77881)\n{\n    #define segmap_tblock_sizze_73267 (inner_SMJ_longzisegmap_73271zisegmap_tblock_sizze_73267)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79016;\n    int32_t tblock_sizze_79019;\n    int32_t wave_sizze_79018;\n    int32_t block_id_79017;\n    int32_t global_tid_79015;\n    int64_t phys_tid_73271;\n    int64_t global_tid_79020;\n    int64_t slice_79021;\n    int64_t gtid_73270;\n    int64_t remnant_79022;\n    \n    local_tid_79016 = get_local_id(0);\n    tblock_sizze_79019 = get_local_size(0);\n    wave_sizze_79018 = LOCKSTEP_WIDTH;\n    block_id_79017 = get_tblock_id(0);\n    global_tid_79015 = block_id_79017 * tblock_sizze_79019 + local_tid_79016;\n    phys_tid_73271 = sext_i32_i64(global_tid_79015);\n    global_tid_79020 = sext_i32_i64(block_id_79017) * segmap_tblock_sizze_73267 + sext_i32_i64(local_tid_79016);\n    slice_79021 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_73270 = global_tid_79020;\n    remnant_79022 = global_tid_79020 - gtid_73270;\n    if (slt64(gtid_73270, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76049;\n        int64_t eta_p_73272;\n        bool cond_73274;\n        int64_t lifted_lambda_res_73275;\n        \n        slice_76049 = loopres_f_res_f_res_67593 + gtid_73270;\n        eta_p_73272 = ((__global int64_t *) mem_param_77688)[ctx_param_ext_77686 + slice_76049 * ctx_param_ext_77687];\n        cond_73274 = slt64(eta_p_73272, (int64_t) 0);\n        if (cond_73274) {\n            int64_t eta_p_73273 = ((__global int64_t *) ext_mem_77877)[gtid_73270];\n            \n            lifted_lambda_res_73275 = eta_p_73273;\n        } else {\n            lifted_lambda_res_73275 = eta_p_73272;\n     ", "   }\n        ((__global int64_t *) mem_77881)[gtid_73270] = lifted_lambda_res_73275;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73267\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73292_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73292(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77683, int64_t ctx_param_ext_77684, __global unsigned char *mem_param_77685, __global unsigned char *ext_mem_77878, __global unsigned char *mem_77884)\n{\n    #define segmap_tblock_sizze_73288 (inner_SMJ_longzisegmap_73292zisegmap_tblock_sizze_73288)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79025;\n    int32_t tblock_sizze_79028;\n    int32_t wave_sizze_79027;\n    int32_t block_id_79026;\n    int32_t global_tid_79024;\n    int64_t phys_tid_73292;\n    int64_t global_tid_79029;\n    int64_t slice_79030;\n    int64_t gtid_73291;\n    int64_t remnant_79031;\n    \n    local_tid_79025 = get_local_id(0);\n    tblock_sizze_79028 = get_local_size(0);\n    wave_sizze_79027 = LOCKSTEP_WIDTH;\n    block_id_79026 = get_tblock_id(0);\n    global_tid_79024 = block_id_79026 * tblock_sizze_79028 + local_tid_79025;\n    phys_tid_73292 = sext_i32_i64(global_tid_79024);\n    global_tid_79029 = sext_i32_i64(block_id_79026) * segmap_tblock_sizze_73288 + sext_i32_i64(local_tid_79025);\n    slice_79030 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_73291 = global_tid_79029;\n    remnant_79031 = global_tid_79029 - gtid_73291;\n    if (slt64(gtid_73291, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76048;\n        int64_t eta_p_73293;\n        int64_t eta_p_73294;\n        int64_t defunc_0_f_res_73295;\n        \n        slice_76048 = loopres_f_res_f_res_67593 + gtid_73291;\n        eta_p_73293 = ((__global int64_t *) mem_param_77685)[ctx_param_ext_77683 + slice_76048 * ctx_param_ext_77684];\n        eta_p_73294 = ((__global int64_t *) ext_mem_77878)[gtid_73291",
                                    "];\n        defunc_0_f_res_73295 = add64(eta_p_73293, eta_p_73294);\n        ((__global int64_t *) mem_77884)[gtid_73291] = defunc_0_f_res_73295;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73288\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73313_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73313(__global int *global_failure, int64_t nR_49324, int64_t ext_78072, int64_t ext_78073, __global unsigned char *mem_param_77640, __global unsigned char *ext_mem_78074, __global unsigned char *mem_78080)\n{\n    #define segmap_tblock_sizze_73309 (inner_SMJ_longzisegmap_73313zisegmap_tblock_sizze_73309)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79034;\n    int32_t tblock_sizze_79037;\n    int32_t wave_sizze_79036;\n    int32_t block_id_79035;\n    int32_t global_tid_79033;\n    int64_t phys_tid_73313;\n    int64_t global_tid_79038;\n    int64_t slice_79039;\n    int64_t gtid_73312;\n    int64_t remnant_79040;\n    \n    local_tid_79034 = get_local_id(0);\n    tblock_sizze_79037 = get_local_size(0);\n    wave_sizze_79036 = LOCKSTEP_WIDTH;\n    block_id_79035 = get_tblock_id(0);\n    global_tid_79033 = block_id_79035 * tblock_sizze_79037 + local_tid_79034;\n    phys_tid_73313 = sext_i32_i64(global_tid_79033);\n    global_tid_79038 = sext_i32_i64(block_id_79035) * segmap_tblock_sizze_73309 + sext_i32_i64(local_tid_79034);\n    slice_79039 = nR_49324;\n    gtid_73312 = global_tid_79038;\n    remnant_79040 = global_tid_79038 - gtid_73312;\n    if (slt64(gtid_73312, nR_49324)) {\n        int64_t eta_p_73314;\n        bool cond_73316;\n        int64_t lifted_lambda_res_73317;\n        \n        eta_p_73314 = ((__global int64_t *) mem_param_77640)[gtid_73312];\n        cond_73316 = slt64(eta_p_73314, (int64_t) 0);\n        if (cond_73316) {\n            int64_t eta_p_73315 = ((__global int64_t *) ext_mem_78074)[ext_78073 + gtid_73312 * ext_78072];\n            \n            lifted_lambda_res_73317 = eta_p_73315;\n        } else {\n            lifted_lambda_res_73317 = eta_p_", "73314;\n        }\n        ((__global int64_t *) mem_78080)[gtid_73312] = lifted_lambda_res_73317;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73309\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73334_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73334(__global int *global_failure, int64_t nR_49324, int64_t ext_78075, int64_t ext_78076, __global unsigned char *mem_param_77637, __global unsigned char *ext_mem_78077, __global unsigned char *mem_78083)\n{\n    #define segmap_tblock_sizze_73330 (inner_SMJ_longzisegmap_73334zisegmap_tblock_sizze_73330)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79043;\n    int32_t tblock_sizze_79046;\n    int32_t wave_sizze_79045;\n    int32_t block_id_79044;\n    int32_t global_tid_79042;\n    int64_t phys_tid_73334;\n    int64_t global_tid_79047;\n    int64_t slice_79048;\n    int64_t gtid_73333;\n    int64_t remnant_79049;\n    \n    local_tid_79043 = get_local_id(0);\n    tblock_sizze_79046 = get_local_size(0);\n    wave_sizze_79045 = LOCKSTEP_WIDTH;\n    block_id_79044 = get_tblock_id(0);\n    global_tid_79042 = block_id_79044 * tblock_sizze_79046 + local_tid_79043;\n    phys_tid_73334 = sext_i32_i64(global_tid_79042);\n    global_tid_79047 = sext_i32_i64(block_id_79044) * segmap_tblock_sizze_73330 + sext_i32_i64(local_tid_79043);\n    slice_79048 = nR_49324;\n    gtid_73333 = global_tid_79047;\n    remnant_79049 = global_tid_79047 - gtid_73333;\n    if (slt64(gtid_73333, nR_49324)) {\n        int64_t eta_p_73335;\n        int64_t eta_p_73336;\n        int64_t defunc_0_f_res_73337;\n        \n        eta_p_73335 = ((__global int64_t *) mem_param_77637)[gtid_73333];\n        eta_p_73336 = ((__global int64_t *) ext_mem_78077)[ext_78076 + gtid_73333 * ext_78075];\n        defunc_0_f_res_73337 = add64(eta_p_73335, eta_p_73336);\n        ((__global int64_t *) mem_78083)[gtid_73333] = defunc_0_f_res_73337;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73330\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73347", "_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73347(__global int *global_failure, int64_t nR_49324, int64_t m_67844, int64_t num_tblocks_73352, int32_t virt_num_tblocks_79200, __global unsigned char *tR_mem_77625, __global unsigned char *ext_mem_77627, __global unsigned char *ext_mem_78095, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *mem_78103, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109)\n{\n    #define segmap_tblock_sizze_73350 (inner_SMJ_longzisegmap_73347zisegmap_tblock_sizze_73350)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79202;\n    int32_t tblock_sizze_79205;\n    int32_t wave_sizze_79204;\n    int32_t block_id_79203;\n    int32_t global_tid_79201;\n    int64_t phys_tid_73347;\n    int32_t phys_tblock_id_79206;\n    int32_t iterations_79207;\n    \n    local_tid_79202 = get_local_id(0);\n    tblock_sizze_79205 = get_local_size(0);\n    wave_sizze_79204 = LOCKSTEP_WIDTH;\n    block_id_79203 = get_tblock_id(0);\n    global_tid_79201 = block_id_79203 * tblock_sizze_79205 + local_tid_79202;\n    phys_tid_73347 = sext_i32_i64(global_tid_79201);\n    phys_tblock_id_79206 = get_tblock_id(0);\n    iterations_79207 = sdiv_up32(virt_num_tblocks_79200 - phys_tblock_id_79206, sext_i64_i32(num_tblocks_73352));\n    for (int32_t i_79208 = 0; i_79208 < iterations_79207; i_79208++) {\n        int32_t virt_tblock_id_79209;\n        int64_t global_tid_79210;\n        int64_t slice_79211;\n        int64_t write_i_73346;\n        int64_t remnant_79212;\n        \n        virt_tblock_id_79209 = phys_tblock_id_79206 + i_79208 * sext_i64_i32(num_tblocks_73352);\n        global_tid_79210 = sext_i32_i64(virt_tblock_id_79209) * segmap_tblock_sizze_73350 + sext_i32_i64(local_tid_79202);\n        slice_79211 = nR_49324;\n        write_i_73346 = global_tid_79210;\n        remnant_79212 = global_tid_79210 - write_i_73346;\n        if (slt64(write",
                                    "_i_73346, nR_49324)) {\n            int64_t eta_p_68109;\n            int64_t write_value_68111;\n            int64_t write_value_68112;\n            int64_t write_value_68113;\n            int64_t write_value_68114;\n            bool cond_68115;\n            int64_t lifted_lambda_res_68116;\n            \n            eta_p_68109 = ((__global int64_t *) mem_78101)[write_i_73346];\n            write_value_68111 = ((__global int64_t *) tR_mem_77625)[write_i_73346];\n            write_value_68112 = ((__global int64_t *) ext_mem_77627)[write_i_73346];\n            write_value_68113 = ((__global int64_t *) ext_mem_78095)[write_i_73346];\n            write_value_68114 = ((__global int64_t *) ext_mem_78096)[write_i_73346];\n            cond_68115 = eta_p_68109 == (int64_t) 1;\n            if (cond_68115) {\n                int64_t eta_p_68110;\n                int64_t lifted_lambda_res_t_res_68890;\n                \n                eta_p_68110 = ((__global int64_t *) mem_78099)[write_i_73346];\n                lifted_lambda_res_t_res_68890 = sub64(eta_p_68110, (int64_t) 1);\n                lifted_lambda_res_68116 = lifted_lambda_res_t_res_68890;\n            } else {\n                lifted_lambda_res_68116 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78109)[lifted_lambda_res_68116] = write_value_68111;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78107)[lifted_lambda_res_68116] = write_value_68112;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78105)[lifted_lambda_res_68116] = write_value_68113;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__", "global int64_t *) mem_78103)[lifted_lambda_res_68116] = write_value_68114;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73350\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73381_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73381(__global int *global_failure, int64_t m_67844, __global unsigned char *mem_78113, __global unsigned char *mem_78120)\n{\n    #define segmap_tblock_sizze_73377 (inner_SMJ_longzisegmap_73381zisegmap_tblock_sizze_73377)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79368;\n    int32_t tblock_sizze_79371;\n    int32_t wave_sizze_79370;\n    int32_t block_id_79369;\n    int32_t global_tid_79367;\n    int64_t phys_tid_73381;\n    int64_t global_tid_79372;\n    int64_t slice_79373;\n    int64_t gtid_73380;\n    int64_t remnant_79374;\n    \n    local_tid_79368 = get_local_id(0);\n    tblock_sizze_79371 = get_local_size(0);\n    wave_sizze_79370 = LOCKSTEP_WIDTH;\n    block_id_79369 = get_tblock_id(0);\n    global_tid_79367 = block_id_79369 * tblock_sizze_79371 + local_tid_79368;\n    phys_tid_73381 = sext_i32_i64(global_tid_79367);\n    global_tid_79372 = sext_i32_i64(block_id_79369) * segmap_tblock_sizze_73377 + sext_i32_i64(local_tid_79368);\n    slice_79373 = m_67844;\n    gtid_73380 = global_tid_79372;\n    remnant_79374 = global_tid_79372 - gtid_73380;\n    if (slt64(gtid_73380, m_67844)) {\n        int64_t zv_lhs_73383;\n        int64_t tmp_73384;\n        bool cond_73386;\n        int64_t lifted_lambda_res_73387;\n        \n        zv_lhs_73383 = add64((int64_t) -1, gtid_73380);\n        tmp_73384 = smod64(zv_lhs_73383, m_67844);\n        cond_73386 = gtid_73380 == (int64_t) 0;\n        if (cond_73386) {\n            lifted_lambda_res_73387 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_73385 = ((__global int64_t *) mem_78113)[tmp_73384];\n            \n            lifted_lambda_res_73387 = lifted_lambda_res_73385;\n        }\n   ", "     ((__global int64_t *) mem_78120)[gtid_73380] = lifted_lambda_res_73387;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73377\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73389_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73389(__global int *global_failure, int64_t m_67844, int64_t lower_bound_67927, int64_t min_res_67929, int64_t j_m_i_67930, int64_t num_tblocks_73394, int32_t virt_num_tblocks_79413, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109, __global unsigned char *mem_78120, __global unsigned char *mem_78149, __global unsigned char *mem_78151, __global unsigned char *mem_78153)\n{\n    #define segmap_tblock_sizze_73392 (inner_SMJ_longzisegmap_73389zisegmap_tblock_sizze_73392)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79415;\n    int32_t tblock_sizze_79418;\n    int32_t wave_sizze_79417;\n    int32_t block_id_79416;\n    int32_t global_tid_79414;\n    int64_t phys_tid_73389;\n    int32_t phys_tblock_id_79419;\n    int32_t iterations_79420;\n    \n    local_tid_79415 = get_local_id(0);\n    tblock_sizze_79418 = get_local_size(0);\n    wave_sizze_79417 = LOCKSTEP_WIDTH;\n    block_id_79416 = get_tblock_id(0);\n    global_tid_79414 = block_id_79416 * tblock_sizze_79418 + local_tid_79415;\n    phys_tid_73389 = sext_i32_i64(global_tid_79414);\n    phys_tblock_id_79419 = get_tblock_id(0);\n    iterations_79420 = sdiv_up32(virt_num_tblocks_79413 - phys_tblock_id_79419, sext_i64_i32(num_tblocks_73394));\n    for (int32_t i_79421 = 0; i_79421 < iterations_79420; i_79421++) {\n        int32_t virt_tblock_id_79422;\n        int64_t global_tid_79423;\n        int64_t slice_79424;\n        int64_t write_i_73388;\n        int64_t remnant_79425;\n        \n        virt_tblock_id_79422 = phys_tblock_id_79419 + i_79421 * sext_i64_i32(num_tblocks_73394);\n        global_tid_79423 = sext_i32_i64(virt_tblock_id_79422) * segmap_tblock_sizze_73392 + sext_i32_i64(local_tid_79415);\n        slice_79424 = m",
                                    "_67844;\n        write_i_73388 = global_tid_79423;\n        remnant_79425 = global_tid_79423 - write_i_73388;\n        if (slt64(write_i_73388, m_67844)) {\n            int64_t eta_p_68502;\n            int64_t write_value_68503;\n            int64_t write_value_68504;\n            int64_t write_value_68505;\n            bool cond_68506;\n            bool cond_t_res_68507;\n            bool x_68508;\n            int64_t lifted_lambda_res_68509;\n            \n            eta_p_68502 = ((__global int64_t *) mem_78120)[write_i_73388];\n            write_value_68503 = ((__global int64_t *) mem_78109)[write_i_73388];\n            write_value_68504 = ((__global int64_t *) mem_78107)[write_i_73388];\n            write_value_68505 = ((__global int64_t *) mem_78105)[write_i_73388];\n            cond_68506 = sle64(lower_bound_67927, eta_p_68502);\n            cond_t_res_68507 = slt64(eta_p_68502, min_res_67929);\n            x_68508 = cond_68506 && cond_t_res_68507;\n            if (x_68508) {\n                int64_t lifted_lambda_res_t_res_68893 = sub64(eta_p_68502, lower_bound_67927);\n                \n                lifted_lambda_res_68509 = lifted_lambda_res_t_res_68893;\n            } else {\n                lifted_lambda_res_68509 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78149)[lifted_lambda_res_68509] = write_value_68503;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78151)[lifted_lambda_res_68509] = write_value_68504;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78153)[lifted_lambda_res_68509] = write_value_68505;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  err", "or_1:\n    return;\n    #undef segmap_tblock_sizze_73392\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73397_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73397(__global int *global_failure, int64_t m_67844, int64_t m_67984, int64_t num_tblocks_73402, int32_t virt_num_tblocks_79395, __global unsigned char *mem_78103, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *mem_78120, __global unsigned char *mem_78128, __global unsigned char *mem_78130)\n{\n    #define segmap_tblock_sizze_73400 (inner_SMJ_longzisegmap_73397zisegmap_tblock_sizze_73400)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79397;\n    int32_t tblock_sizze_79400;\n    int32_t wave_sizze_79399;\n    int32_t block_id_79398;\n    int32_t global_tid_79396;\n    int64_t phys_tid_73397;\n    int32_t phys_tblock_id_79401;\n    int32_t iterations_79402;\n    \n    local_tid_79397 = get_local_id(0);\n    tblock_sizze_79400 = get_local_size(0);\n    wave_sizze_79399 = LOCKSTEP_WIDTH;\n    block_id_79398 = get_tblock_id(0);\n    global_tid_79396 = block_id_79398 * tblock_sizze_79400 + local_tid_79397;\n    phys_tid_73397 = sext_i32_i64(global_tid_79396);\n    phys_tblock_id_79401 = get_tblock_id(0);\n    iterations_79402 = sdiv_up32(virt_num_tblocks_79395 - phys_tblock_id_79401, sext_i64_i32(num_tblocks_73402));\n    for (int32_t i_79403 = 0; i_79403 < iterations_79402; i_79403++) {\n        int32_t virt_tblock_id_79404;\n        int64_t global_tid_79405;\n        int64_t slice_79406;\n        int64_t write_i_73396;\n        int64_t remnant_79407;\n        \n        virt_tblock_id_79404 = phys_tblock_id_79401 + i_79403 * sext_i64_i32(num_tblocks_73402);\n        global_tid_79405 = sext_i32_i64(virt_tblock_id_79404) * segmap_tblock_sizze_73400 + sext_i32_i64(local_tid_79397);\n        slice_79406 = m_67844;\n        write_i_73396 = global_tid_79405;\n        remnant_79407 = global_tid_79405 - write_i_73396;\n        if (slt64(write_i_73396, m_67844)) {\n            int64_t eta_p_680", "86;\n            int64_t write_value_68088;\n            int64_t write_value_68089;\n            bool cond_68090;\n            int64_t lifted_lambda_res_68091;\n            \n            eta_p_68086 = ((__global int64_t *) mem_78117)[write_i_73396];\n            write_value_68088 = ((__global int64_t *) mem_78120)[write_i_73396];\n            write_value_68089 = ((__global int64_t *) mem_78103)[write_i_73396];\n            cond_68090 = eta_p_68086 == (int64_t) 1;\n            if (cond_68090) {\n                int64_t eta_p_68087;\n                int64_t lifted_lambda_res_t_res_68898;\n                \n                eta_p_68087 = ((__global int64_t *) mem_78115)[write_i_73396];\n                lifted_lambda_res_t_res_68898 = sub64(eta_p_68087, (int64_t) 1);\n                lifted_lambda_res_68091 = lifted_lambda_res_t_res_68898;\n            } else {\n                lifted_lambda_res_68091 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78130)[lifted_lambda_res_68091] = write_value_68088;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78128)[lifted_lambda_res_68091] = write_value_68089;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73400\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_73419_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_73419(__global int *global_failure, int64_t loopres_68028, int64_t loopres_68029, __global unsigned char *mem_78178, __global unsigned char *mem_78181)\n{\n    #define segmap_tblock_sizze_73415 (inner_SMJ_longzisegmap_73419zisegmap_tblock_sizze_73415)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79482;\n    int32_t tblock_sizze_79485;\n    int32_t wave_sizze_79484;\n    int32_t block_id_7",
                                    "9483;\n    int32_t global_tid_79481;\n    int64_t phys_tid_73419;\n    int64_t global_tid_79486;\n    int64_t slice_79487;\n    int64_t gtid_73418;\n    int64_t remnant_79488;\n    \n    local_tid_79482 = get_local_id(0);\n    tblock_sizze_79485 = get_local_size(0);\n    wave_sizze_79484 = LOCKSTEP_WIDTH;\n    block_id_79483 = get_tblock_id(0);\n    global_tid_79481 = block_id_79483 * tblock_sizze_79485 + local_tid_79482;\n    phys_tid_73419 = sext_i32_i64(global_tid_79481);\n    global_tid_79486 = sext_i32_i64(block_id_79483) * segmap_tblock_sizze_73415 + sext_i32_i64(local_tid_79482);\n    slice_79487 = loopres_68029;\n    gtid_73418 = global_tid_79486;\n    remnant_79488 = global_tid_79486 - gtid_73418;\n    if (slt64(gtid_73418, loopres_68029)) {\n        int64_t loopres_77620;\n        int64_t tmp_73421;\n        \n        loopres_77620 = ((__global int64_t *) mem_78181)[(int64_t) 0];\n        tmp_73421 = add64(gtid_73418, loopres_77620);\n        ((__global int64_t *) mem_78178)[loopres_68028 + gtid_73418] = tmp_73421;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73415\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_76057_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_76057(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76060, int64_t num_whole_tiles_76075, int64_t residual_input_76299, unsigned char cond_76300_bits, int64_t binop_x_76316, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_78045, __global unsigned char *mem_78047)\n{\n    bool cond_76300 = cond_76300_bits;\n    \n    #define tile_sizze_76059 (inner_SMJ_longzisegmap_intrablock_76057zitile_sizze_76059)\n    #define bytes_78007 (inner_SMJ_longzisegmap_intrablock_76057zibytes_78007)\n    \n    volatile __local unsigned char *color_78690_backing_2 = &shared_mem[0];\n    const int64_t colo", "r_78690_backing_2_offset = 0 + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78689_backing_1 = &shared_mem[color_78690_backing_2_offset];\n    const int64_t color_78689_backing_1_offset = color_78690_backing_2_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78688_backing_0 = &shared_mem[color_78689_backing_1_offset];\n    const int64_t color_78688_backing_0_offset = color_78689_backing_1_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78779;\n    int32_t tblock_sizze_78782;\n    int32_t wave_sizze_78781;\n    int32_t block_id_78780;\n    int32_t global_tid_78778;\n    int64_t gid_flat_76057;\n    int64_t slice_78784;\n    int64_t ltid_pre_78783;\n    int64_t remnant_78785;\n    int64_t slice_78786;\n    int64_t gid_76056;\n    int64_t remnant_78787;\n    __local unsigned char *color_78688;\n    __local unsigned char *color_78689;\n    __local unsigned char *color_78690;\n    int64_t binop_x_76067;\n    int64_t mem_77991[1];\n    int64_t ltid_flat_76062;\n    int64_t ltid_76061;\n    int64_t gtid_76068;\n    bool cond_76069;\n    int64_t pre_76070;\n    int64_t mem_77995[1];\n    int64_t mem_77999[1];\n    int64_t mem_78003[1];\n    int64_t ltid_flat_76077;\n    int64_t ltid_76076;\n    int64_t gtid_76087;\n    bool cond_76088;\n    int64_t neutral_76089;\n    int64_t neutral_76090;\n    int64_t ext_mem_78027[1];\n    int64_t ext_mem_78026[1];\n    int64_t ext_mem_78025[1];\n    int64_t mem_param_78004[1];\n    int64_t mem_param_78005[1];\n    int64_t mem_param_78006[1];\n    int64_t mem_78037[1];\n    int64_t mem_78041[1];\n    int64_t ext_mem_78043[1];\n    int64_t ext_mem_78042[1];\n    \n    local_tid_78779 = get_local_id(0);\n    tblock_sizze_78782 = get_local_size(0);\n    wave_sizze_78781 = LOCKSTEP_WIDTH;\n    block_i", "d_78780 = get_tblock_id(0);\n    global_tid_78778 = block_id_78780 * tblock_sizze_78782 + local_tid_78779;\n    gid_flat_76057 = sext_i32_i64(block_id_78780);\n    slice_78784 = tile_sizze_76059;\n    ltid_pre_78783 = sext_i32_i64(local_tid_78779);\n    remnant_78785 = sext_i32_i64(local_tid_78779) - ltid_pre_78783;\n    slice_78786 = ldim_76060;\n    gid_76056 = sext_i32_i64(block_id_78780);\n    remnant_78787 = sext_i32_i64(block_id_78780) - gid_76056;\n    color_78688 = (__local unsigned char *) color_78688_backing_0;\n    color_78689 = (__local unsigned char *) color_78689_backing_1;\n    color_78690 = (__local unsigned char *) color_78690_backing_2;\n    binop_x_76067 = gid_76056 * tile_sizze_76059;\n    ltid_flat_76062 = sext_i32_i64(local_tid_78779);\n    ltid_76061 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n    gtid_76068 = ltid_76061 + binop_x_76067;\n    cond_76069 = slt64(gtid_76068, min_res_68560);\n    if (cond_76069) {\n        int64_t slice_76071;\n        int64_t eta_p_76072;\n        \n        slice_76071 = start_68558 + gtid_76068;\n        eta_p_76072 = ((__global int64_t *) tR_mem_77625)[slice_76071];\n        pre_76070 = eta_p_76072;\n    } else {\n        pre_76070 = (int64_t) 0;\n    }\n    mem_77991[(int64_t) 0] = pre_76070;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76077 = sext_i32_i64(local_tid_78779);\n    ltid_76076 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n    gtid_76087 = binop_x_76067 + ltid_76076;\n    cond_76088 = slt64(gtid_76087, min_res_68560);\n    if (cond_76088) {\n        neutral_76089 = (int64_t) -1;\n    } else {\n        neutral_76089 = (int64_t) 0;\n    }\n    if (cond_76088) {\n        int64_t eta_p_76092 = mem_77991[(int64_t) 0];\n        \n        neutral_76090 = eta_p_76092;\n    } else {\n        neutral_76090 = (int64_t) 0;\n    }\n    mem_77995[(int64_t) 0] = neutral_76089;\n    mem_77999[(int64_t) 0] = neutral_76090;\n    mem_78003[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i",
                                    "_3 = 0; i_3 < 1; i_3++)\n        mem_param_78004[i_3] = mem_77995[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_78005[i_4] = mem_77999[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_78006[i_5] = mem_78003[i_5];\n    for (int64_t tile_id_76102 = 0; tile_id_76102 < num_whole_tiles_76075; tile_id_76102++) {\n        int64_t binop_x_76201;\n        int64_t ltid_flat_76200;\n        int64_t ltid_76199;\n        int64_t j_76202;\n        bool cond_76206;\n        int64_t pre1d_76209;\n        int64_t pre1d_76207;\n        int64_t pre1d_76208;\n        int64_t mem_78016[1];\n        int64_t mem_78020[1];\n        int64_t mem_78024[1];\n        int64_t ltid_flat_76220;\n        int64_t ltid_76219;\n        int64_t gtid_76222;\n        int64_t acc_76224;\n        int64_t acc_76225;\n        int64_t acc_76226;\n        bool cond_76227;\n        int64_t acc_76228;\n        int64_t acc_76229;\n        int64_t acc_76230;\n        int64_t mem_param_tmp_78788[1];\n        int64_t mem_param_tmp_78789[1];\n        int64_t mem_param_tmp_78790[1];\n        \n        binop_x_76201 = tile_sizze_76059 * tile_id_76102;\n        ltid_flat_76200 = sext_i32_i64(local_tid_78779);\n        ltid_76199 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n        j_76202 = ltid_76199 + binop_x_76201;\n        cond_76206 = slt64(j_76202, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76209 = btoi_bool_i64(cond_76206);\n        if (cond_76206) {\n            int64_t tile_elem_76210;\n            int64_t slice_77479;\n            int64_t tile_elem_76211;\n            \n            tile_elem_76210 = ((__global int64_t *) ext_mem_77925)[j_76202];\n            slice_77479 = tS_start_66998 + j_76202;\n            tile_elem_76211 = ((__global int64_t *) tS_mem_77626)[slice_77479];\n            pre1d_76207 = tile_elem_76210;\n            pre1d_76208 = tile_elem_76211;\n        } else {\n            pre1d_76207 = (int64_t) 0;\n            pre1d_76208 = (int64_t) 0;\n        }\n        ((__local int64_t ", "*) color_78690)[ltid_76199] = pre1d_76207;\n        ((__local int64_t *) color_78689)[ltid_76199] = pre1d_76208;\n        ((__local int64_t *) color_78688)[ltid_76199] = pre1d_76209;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76220 = sext_i32_i64(local_tid_78779);\n        ltid_76219 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n        gtid_76222 = binop_x_76067 + ltid_76219;\n        acc_76224 = mem_param_78004[(int64_t) 0];\n        acc_76225 = mem_param_78005[(int64_t) 0];\n        acc_76226 = mem_param_78006[(int64_t) 0];\n        cond_76227 = slt64(gtid_76222, min_res_68560);\n        if (cond_76227) {\n            int64_t eta_p_76223;\n            int64_t x_76231;\n            int64_t x_76232;\n            int64_t x_76233;\n            int64_t redout_77492;\n            int64_t redout_77493;\n            int64_t redout_77494;\n            \n            eta_p_76223 = mem_77991[(int64_t) 0];\n            redout_77492 = acc_76224;\n            redout_77493 = acc_76225;\n            redout_77494 = acc_76226;\n            for (int64_t i_77495 = 0; i_77495 < tile_sizze_76059; i_77495++) {\n                int64_t x_76234;\n                int64_t x_76235;\n                bool defunc_0_neq_res_76243;\n                bool defunc_0_neq_res_76244;\n                bool cond_f_res_76245;\n                bool y_76246;\n                bool cond_76247;\n                bool defunc_0_neq_res_76248;\n                bool defunc_0_neq_res_76249;\n                bool cond_t_res_f_res_76250;\n                bool y_76251;\n                bool cond_t_res_76252;\n                bool x_76253;\n                int64_t defunc_0_op_res_76254;\n                int64_t defunc_0_op_res_76255;\n                int64_t defunc_0_op_res_76256;\n                int64_t redout_tmp_78794;\n                int64_t redout_tmp_78795;\n                int64_t redout_tmp_78796;\n                \n                x_76234 = ((__local int64_t *) color_78690)[i_77495];\n                x_76235 = ((__local int64_t *) color_78", "689)[i_77495];\n                defunc_0_neq_res_76243 = redout_77493 == eta_p_76223;\n                defunc_0_neq_res_76244 = !defunc_0_neq_res_76243;\n                cond_f_res_76245 = slt64(redout_77492, (int64_t) 0);\n                y_76246 = defunc_0_neq_res_76243 && cond_f_res_76245;\n                cond_76247 = defunc_0_neq_res_76244 || y_76246;\n                defunc_0_neq_res_76248 = x_76235 == eta_p_76223;\n                defunc_0_neq_res_76249 = !defunc_0_neq_res_76248;\n                cond_t_res_f_res_76250 = slt64(x_76234, (int64_t) 0);\n                y_76251 = defunc_0_neq_res_76248 && cond_t_res_f_res_76250;\n                cond_t_res_76252 = defunc_0_neq_res_76249 || y_76251;\n                x_76253 = cond_76247 && cond_t_res_76252;\n                if (x_76253) {\n                    defunc_0_op_res_76254 = (int64_t) -1;\n                    defunc_0_op_res_76255 = eta_p_76223;\n                    defunc_0_op_res_76256 = (int64_t) 0;\n                } else {\n                    int64_t x_76236;\n                    int64_t defunc_0_op_res_f_res_76257;\n                    int64_t defunc_0_op_res_f_res_76258;\n                    int64_t defunc_0_op_res_f_res_76259;\n                    \n                    x_76236 = ((__local int64_t *) color_78688)[i_77495];\n                    if (cond_76247) {\n                        defunc_0_op_res_f_res_76257 = x_76234;\n                        defunc_0_op_res_f_res_76258 = x_76235;\n                        defunc_0_op_res_f_res_76259 = x_76236;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_76260;\n                        int64_t defunc_0_op_res_f_res_f_res_76261;\n                        int64_t defunc_0_op_res_f_res_f_res_76262;\n                        \n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76260 = redout_77493;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76260 = eta_p",
                                    "_76223;\n                        }\n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76261 = redout_77492;\n                            defunc_0_op_res_f_res_f_res_76262 = redout_77494;\n                        } else {\n                            int64_t min_res_76263;\n                            int64_t tmp_76264;\n                            \n                            min_res_76263 = smin64(x_76234, redout_77492);\n                            tmp_76264 = add64(x_76236, redout_77494);\n                            defunc_0_op_res_f_res_f_res_76261 = min_res_76263;\n                            defunc_0_op_res_f_res_f_res_76262 = tmp_76264;\n                        }\n                        defunc_0_op_res_f_res_76257 = defunc_0_op_res_f_res_f_res_76261;\n                        defunc_0_op_res_f_res_76258 = defunc_0_op_res_f_res_f_res_76260;\n                        defunc_0_op_res_f_res_76259 = defunc_0_op_res_f_res_f_res_76262;\n                    }\n                    defunc_0_op_res_76254 = defunc_0_op_res_f_res_76257;\n                    defunc_0_op_res_76255 = defunc_0_op_res_f_res_76258;\n                    defunc_0_op_res_76256 = defunc_0_op_res_f_res_76259;\n                }\n                redout_tmp_78794 = defunc_0_op_res_76254;\n                redout_tmp_78795 = defunc_0_op_res_76255;\n                redout_tmp_78796 = defunc_0_op_res_76256;\n                redout_77492 = redout_tmp_78794;\n                redout_77493 = redout_tmp_78795;\n                redout_77494 = redout_tmp_78796;\n            }\n            x_76231 = redout_77492;\n            x_76232 = redout_77493;\n            x_76233 = redout_77494;\n            acc_76228 = x_76231;\n            acc_76229 = x_76232;\n            acc_76230 = x_76233;\n        } else {\n            acc_76228 = acc_76224;\n            acc_76229 = acc_76225;\n            acc_76230 = acc_76226;\n        }\n        mem_78016[(int64_t) 0] = acc_76228;\n        mem_78020[(int64_t) 0] = ", "acc_76229;\n        mem_78024[(int64_t) 0] = acc_76230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78788[i_6] = mem_78016[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78789[i_7] = mem_78020[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78790[i_8] = mem_78024[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_78004[i_9] = mem_param_tmp_78788[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_78005[i_10] = mem_param_tmp_78789[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_78006[i_11] = mem_param_tmp_78790[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_78027[i_12] = mem_param_78004[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_78026[i_13] = mem_param_78005[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_78025[i_14] = mem_param_78006[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76300) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_78043[i_15] = ext_mem_78027[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_78042[i_16] = ext_mem_78025[i_16];\n    } else {\n        int64_t ltid_flat_76302;\n        int64_t ltid_76301;\n        int64_t j_76317;\n        bool cond_76321;\n        int64_t pre1d_76324;\n        int64_t pre1d_76322;\n        int64_t pre1d_76323;\n        int64_t ltid_flat_76338;\n        int64_t ltid_76337;\n        int64_t gtid_76351;\n        int64_t acc_76353;\n        int64_t acc_76355;\n        bool cond_76356;\n        int64_t acc_76357;\n        int64_t acc_76359;\n        \n        ltid_flat_76302 = sext_i32_i64(local_tid_78779);\n        ltid_76301 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n        j_76317 = ltid_76301 + binop_x_76316;\n        cond_76321 = slt64(j_76317, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d", "_76324 = btoi_bool_i64(cond_76321);\n        if (cond_76321) {\n            int64_t tile_elem_76325;\n            int64_t slice_77478;\n            int64_t tile_elem_76326;\n            \n            tile_elem_76325 = ((__global int64_t *) ext_mem_77925)[j_76317];\n            slice_77478 = tS_start_66998 + j_76317;\n            tile_elem_76326 = ((__global int64_t *) tS_mem_77626)[slice_77478];\n            pre1d_76322 = tile_elem_76325;\n            pre1d_76323 = tile_elem_76326;\n        } else {\n            pre1d_76322 = (int64_t) 0;\n            pre1d_76323 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76301] = pre1d_76322;\n        ((__local int64_t *) color_78689)[ltid_76301] = pre1d_76323;\n        ((__local int64_t *) color_78688)[ltid_76301] = pre1d_76324;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76338 = sext_i32_i64(local_tid_78779);\n        ltid_76337 = sext_i32_i64(sext_i64_i32(ltid_pre_78783));\n        gtid_76351 = binop_x_76067 + ltid_76337;\n        acc_76353 = ext_mem_78027[(int64_t) 0];\n        acc_76355 = ext_mem_78025[(int64_t) 0];\n        cond_76356 = slt64(gtid_76351, min_res_68560);\n        if (cond_76356) {\n            int64_t eta_p_76352;\n            int64_t acc_76354;\n            int64_t x_76360;\n            int64_t x_76361;\n            int64_t x_76362;\n            int64_t redout_77496;\n            int64_t redout_77497;\n            int64_t redout_77498;\n            \n            eta_p_76352 = mem_77991[(int64_t) 0];\n            acc_76354 = ext_mem_78026[(int64_t) 0];\n            redout_77496 = acc_76353;\n            redout_77497 = acc_76354;\n            redout_77498 = acc_76355;\n            for (int64_t i_77499 = 0; i_77499 < residual_input_76299; i_77499++) {\n                int64_t x_76363;\n                int64_t x_76364;\n                bool defunc_0_neq_res_76372;\n                bool defunc_0_neq_res_76373;\n                bool cond_f_res_76374;\n                bool y_76375;\n                bool cond_76376;\n  ",
                                    "              bool defunc_0_neq_res_76377;\n                bool defunc_0_neq_res_76378;\n                bool cond_t_res_f_res_76379;\n                bool y_76380;\n                bool cond_t_res_76381;\n                bool x_76382;\n                int64_t defunc_0_op_res_76383;\n                int64_t defunc_0_op_res_76384;\n                int64_t defunc_0_op_res_76385;\n                int64_t redout_tmp_78797;\n                int64_t redout_tmp_78798;\n                int64_t redout_tmp_78799;\n                \n                x_76363 = ((__local int64_t *) color_78690)[i_77499];\n                x_76364 = ((__local int64_t *) color_78689)[i_77499];\n                defunc_0_neq_res_76372 = redout_77497 == eta_p_76352;\n                defunc_0_neq_res_76373 = !defunc_0_neq_res_76372;\n                cond_f_res_76374 = slt64(redout_77496, (int64_t) 0);\n                y_76375 = defunc_0_neq_res_76372 && cond_f_res_76374;\n                cond_76376 = defunc_0_neq_res_76373 || y_76375;\n                defunc_0_neq_res_76377 = x_76364 == eta_p_76352;\n                defunc_0_neq_res_76378 = !defunc_0_neq_res_76377;\n                cond_t_res_f_res_76379 = slt64(x_76363, (int64_t) 0);\n                y_76380 = defunc_0_neq_res_76377 && cond_t_res_f_res_76379;\n                cond_t_res_76381 = defunc_0_neq_res_76378 || y_76380;\n                x_76382 = cond_76376 && cond_t_res_76381;\n                if (x_76382) {\n                    defunc_0_op_res_76383 = (int64_t) -1;\n                    defunc_0_op_res_76384 = eta_p_76352;\n                    defunc_0_op_res_76385 = (int64_t) 0;\n                } else {\n                    int64_t x_76365;\n                    int64_t defunc_0_op_res_f_res_76386;\n                    int64_t defunc_0_op_res_f_res_76387;\n                    int64_t defunc_0_op_res_f_res_76388;\n                    \n                    x_76365 = ((__local int64_t *) color_78688)[i_77499];\n                    if (cond_76376) {\n                        defunc_", "0_op_res_f_res_76386 = x_76363;\n                        defunc_0_op_res_f_res_76387 = x_76364;\n                        defunc_0_op_res_f_res_76388 = x_76365;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_76389;\n                        int64_t defunc_0_op_res_f_res_f_res_76390;\n                        int64_t defunc_0_op_res_f_res_f_res_76391;\n                        \n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76389 = redout_77497;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76389 = eta_p_76352;\n                        }\n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76390 = redout_77496;\n                            defunc_0_op_res_f_res_f_res_76391 = redout_77498;\n                        } else {\n                            int64_t min_res_76392;\n                            int64_t tmp_76393;\n                            \n                            min_res_76392 = smin64(x_76363, redout_77496);\n                            tmp_76393 = add64(x_76365, redout_77498);\n                            defunc_0_op_res_f_res_f_res_76390 = min_res_76392;\n                            defunc_0_op_res_f_res_f_res_76391 = tmp_76393;\n                        }\n                        defunc_0_op_res_f_res_76386 = defunc_0_op_res_f_res_f_res_76390;\n                        defunc_0_op_res_f_res_76387 = defunc_0_op_res_f_res_f_res_76389;\n                        defunc_0_op_res_f_res_76388 = defunc_0_op_res_f_res_f_res_76391;\n                    }\n                    defunc_0_op_res_76383 = defunc_0_op_res_f_res_76386;\n                    defunc_0_op_res_76384 = defunc_0_op_res_f_res_76387;\n                    defunc_0_op_res_76385 = defunc_0_op_res_f_res_76388;\n                }\n                redout_tmp_78797 = defunc_0_op_res_76383;\n                redout_tmp_78798 = defunc_0_op_res_7", "6384;\n                redout_tmp_78799 = defunc_0_op_res_76385;\n                redout_77496 = redout_tmp_78797;\n                redout_77497 = redout_tmp_78798;\n                redout_77498 = redout_tmp_78799;\n            }\n            x_76360 = redout_77496;\n            x_76361 = redout_77497;\n            x_76362 = redout_77498;\n            acc_76357 = x_76360;\n            acc_76359 = x_76362;\n        } else {\n            acc_76357 = acc_76353;\n            acc_76359 = acc_76355;\n        }\n        mem_78037[(int64_t) 0] = acc_76357;\n        mem_78041[(int64_t) 0] = acc_76359;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_78043[i_17] = mem_78037[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_78042[i_18] = mem_78041[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78779) + tile_sizze_76059 * sext_i32_i64(block_id_78780), min_res_68560)) {\n        int64_t tmp_78800 = ext_mem_78043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78045)[sext_i32_i64(local_tid_78779) + tile_sizze_76059 * sext_i32_i64(block_id_78780)] = tmp_78800;\n    }\n    if (slt64(sext_i32_i64(local_tid_78779) + tile_sizze_76059 * sext_i32_i64(block_id_78780), min_res_68560)) {\n        int64_t tmp_78801 = ext_mem_78042[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78047)[sext_i32_i64(local_tid_78779) + tile_sizze_76059 * sext_i32_i64(block_id_78780)] = tmp_78801;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76059\n    #undef bytes_78007\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_76412_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_76412(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76415, int64_t num_whole_tiles_76430, int64_t residual_input_76654, unsigned char cond_76655_bits, int64_t binop_x_76671, __global unsigned char *tR_mem_77625, __globa",
                                    "l unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_77984, __global unsigned char *mem_77986)\n{\n    bool cond_76655 = cond_76655_bits;\n    \n    #define tile_sizze_76414 (inner_SMJ_longzisegmap_intrablock_76412zitile_sizze_76414)\n    #define bytes_77946 (inner_SMJ_longzisegmap_intrablock_76412zibytes_77946)\n    \n    volatile __local unsigned char *color_78693_backing_2 = &shared_mem[0];\n    const int64_t color_78693_backing_2_offset = 0 + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78692_backing_1 = &shared_mem[color_78693_backing_2_offset];\n    const int64_t color_78692_backing_1_offset = color_78693_backing_2_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78691_backing_0 = &shared_mem[color_78692_backing_1_offset];\n    const int64_t color_78691_backing_0_offset = color_78692_backing_1_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78805;\n    int32_t tblock_sizze_78808;\n    int32_t wave_sizze_78807;\n    int32_t block_id_78806;\n    int32_t global_tid_78804;\n    int64_t gid_flat_76412;\n    int64_t slice_78810;\n    int64_t ltid_pre_78809;\n    int64_t remnant_78811;\n    int64_t slice_78812;\n    int64_t gid_76411;\n    int64_t remnant_78813;\n    __local unsigned char *color_78691;\n    __local unsigned char *color_78692;\n    __local unsigned char *color_78693;\n    int64_t binop_x_76422;\n    int64_t mem_77930[1];\n    int64_t ltid_flat_76417;\n    int64_t ltid_76416;\n    int64_t gtid_76423;\n    bool cond_76424;\n    int64_t pre_76425;\n    int64_t mem_77934[1];\n    int64_t mem_77938[1];\n    int64_t mem_77942[1];\n    int64_t ltid_flat_76432;\n    int64_t ltid_76431;\n    int64_t gtid_76442;\n    bool cond_76443;\n    int64_t neutral_76444;\n    in", "t64_t neutral_76445;\n    int64_t ext_mem_77966[1];\n    int64_t ext_mem_77965[1];\n    int64_t ext_mem_77964[1];\n    int64_t mem_param_77943[1];\n    int64_t mem_param_77944[1];\n    int64_t mem_param_77945[1];\n    int64_t mem_77976[1];\n    int64_t mem_77980[1];\n    int64_t ext_mem_77982[1];\n    int64_t ext_mem_77981[1];\n    \n    local_tid_78805 = get_local_id(0);\n    tblock_sizze_78808 = get_local_size(0);\n    wave_sizze_78807 = LOCKSTEP_WIDTH;\n    block_id_78806 = get_tblock_id(0);\n    global_tid_78804 = block_id_78806 * tblock_sizze_78808 + local_tid_78805;\n    gid_flat_76412 = sext_i32_i64(block_id_78806);\n    slice_78810 = tile_sizze_76414;\n    ltid_pre_78809 = sext_i32_i64(local_tid_78805);\n    remnant_78811 = sext_i32_i64(local_tid_78805) - ltid_pre_78809;\n    slice_78812 = ldim_76415;\n    gid_76411 = sext_i32_i64(block_id_78806);\n    remnant_78813 = sext_i32_i64(block_id_78806) - gid_76411;\n    color_78691 = (__local unsigned char *) color_78691_backing_0;\n    color_78692 = (__local unsigned char *) color_78692_backing_1;\n    color_78693 = (__local unsigned char *) color_78693_backing_2;\n    binop_x_76422 = gid_76411 * tile_sizze_76414;\n    ltid_flat_76417 = sext_i32_i64(local_tid_78805);\n    ltid_76416 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n    gtid_76423 = ltid_76416 + binop_x_76422;\n    cond_76424 = slt64(gtid_76423, min_res_68560);\n    if (cond_76424) {\n        int64_t slice_76426;\n        int64_t eta_p_76427;\n        \n        slice_76426 = start_68558 + gtid_76423;\n        eta_p_76427 = ((__global int64_t *) tR_mem_77625)[slice_76426];\n        pre_76425 = eta_p_76427;\n    } else {\n        pre_76425 = (int64_t) 0;\n    }\n    mem_77930[(int64_t) 0] = pre_76425;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76432 = sext_i32_i64(local_tid_78805);\n    ltid_76431 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n    gtid_76442 = binop_x_76422 + ltid_76431;\n    cond_76443 = slt64(gtid_76442, min_res_68560);\n    if (cond_76443) {\n        neutral_76444 = (int64_", "t) -1;\n    } else {\n        neutral_76444 = (int64_t) 0;\n    }\n    if (cond_76443) {\n        int64_t eta_p_76447 = mem_77930[(int64_t) 0];\n        \n        neutral_76445 = eta_p_76447;\n    } else {\n        neutral_76445 = (int64_t) 0;\n    }\n    mem_77934[(int64_t) 0] = neutral_76444;\n    mem_77938[(int64_t) 0] = neutral_76445;\n    mem_77942[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77943[i_3] = mem_77934[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77944[i_4] = mem_77938[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77945[i_5] = mem_77942[i_5];\n    for (int64_t tile_id_76457 = 0; tile_id_76457 < num_whole_tiles_76430; tile_id_76457++) {\n        int64_t binop_x_76556;\n        int64_t ltid_flat_76555;\n        int64_t ltid_76554;\n        int64_t j_76557;\n        bool cond_76561;\n        int64_t pre1d_76564;\n        int64_t pre1d_76562;\n        int64_t pre1d_76563;\n        int64_t mem_77955[1];\n        int64_t mem_77959[1];\n        int64_t mem_77963[1];\n        int64_t ltid_flat_76575;\n        int64_t ltid_76574;\n        int64_t gtid_76577;\n        int64_t acc_76579;\n        int64_t acc_76580;\n        int64_t acc_76581;\n        bool cond_76582;\n        int64_t acc_76583;\n        int64_t acc_76584;\n        int64_t acc_76585;\n        int64_t mem_param_tmp_78814[1];\n        int64_t mem_param_tmp_78815[1];\n        int64_t mem_param_tmp_78816[1];\n        \n        binop_x_76556 = tile_sizze_76414 * tile_id_76457;\n        ltid_flat_76555 = sext_i32_i64(local_tid_78805);\n        ltid_76554 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n        j_76557 = ltid_76554 + binop_x_76556;\n        cond_76561 = slt64(j_76557, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76564 = btoi_bool_i64(cond_76561);\n        if (cond_76561) {\n            int64_t tile_elem_76565;\n            int64_t slice_77483;\n            int64_t",
                                    " tile_elem_76566;\n            \n            tile_elem_76565 = ((__global int64_t *) ext_mem_77925)[j_76557];\n            slice_77483 = tS_start_66998 + j_76557;\n            tile_elem_76566 = ((__global int64_t *) tS_mem_77626)[slice_77483];\n            pre1d_76562 = tile_elem_76565;\n            pre1d_76563 = tile_elem_76566;\n        } else {\n            pre1d_76562 = (int64_t) 0;\n            pre1d_76563 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76554] = pre1d_76562;\n        ((__local int64_t *) color_78692)[ltid_76554] = pre1d_76563;\n        ((__local int64_t *) color_78691)[ltid_76554] = pre1d_76564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76575 = sext_i32_i64(local_tid_78805);\n        ltid_76574 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n        gtid_76577 = binop_x_76422 + ltid_76574;\n        acc_76579 = mem_param_77943[(int64_t) 0];\n        acc_76580 = mem_param_77944[(int64_t) 0];\n        acc_76581 = mem_param_77945[(int64_t) 0];\n        cond_76582 = slt64(gtid_76577, min_res_68560);\n        if (cond_76582) {\n            int64_t eta_p_76578;\n            int64_t x_76586;\n            int64_t x_76587;\n            int64_t x_76588;\n            int64_t redout_77500;\n            int64_t redout_77501;\n            int64_t redout_77502;\n            \n            eta_p_76578 = mem_77930[(int64_t) 0];\n            redout_77500 = acc_76579;\n            redout_77501 = acc_76580;\n            redout_77502 = acc_76581;\n            for (int64_t i_77503 = 0; i_77503 < tile_sizze_76414; i_77503++) {\n                int64_t x_76589;\n                int64_t x_76590;\n                bool defunc_0_neq_res_76598;\n                bool defunc_0_neq_res_76599;\n                bool cond_f_res_76600;\n                bool y_76601;\n                bool cond_76602;\n                bool defunc_0_neq_res_76603;\n                bool defunc_0_neq_res_76604;\n                bool cond_t_res_f_res_76605;\n                bool y_76606;\n                bool ", "cond_t_res_76607;\n                bool x_76608;\n                int64_t defunc_0_op_res_76609;\n                int64_t defunc_0_op_res_76610;\n                int64_t defunc_0_op_res_76611;\n                int64_t redout_tmp_78820;\n                int64_t redout_tmp_78821;\n                int64_t redout_tmp_78822;\n                \n                x_76589 = ((__local int64_t *) color_78693)[i_77503];\n                x_76590 = ((__local int64_t *) color_78692)[i_77503];\n                defunc_0_neq_res_76598 = redout_77501 == eta_p_76578;\n                defunc_0_neq_res_76599 = !defunc_0_neq_res_76598;\n                cond_f_res_76600 = slt64(redout_77500, (int64_t) 0);\n                y_76601 = defunc_0_neq_res_76598 && cond_f_res_76600;\n                cond_76602 = defunc_0_neq_res_76599 || y_76601;\n                defunc_0_neq_res_76603 = x_76590 == eta_p_76578;\n                defunc_0_neq_res_76604 = !defunc_0_neq_res_76603;\n                cond_t_res_f_res_76605 = slt64(x_76589, (int64_t) 0);\n                y_76606 = defunc_0_neq_res_76603 && cond_t_res_f_res_76605;\n                cond_t_res_76607 = defunc_0_neq_res_76604 || y_76606;\n                x_76608 = cond_76602 && cond_t_res_76607;\n                if (x_76608) {\n                    defunc_0_op_res_76609 = (int64_t) -1;\n                    defunc_0_op_res_76610 = eta_p_76578;\n                    defunc_0_op_res_76611 = (int64_t) 0;\n                } else {\n                    int64_t x_76591;\n                    int64_t defunc_0_op_res_f_res_76612;\n                    int64_t defunc_0_op_res_f_res_76613;\n                    int64_t defunc_0_op_res_f_res_76614;\n                    \n                    x_76591 = ((__local int64_t *) color_78691)[i_77503];\n                    if (cond_76602) {\n                        defunc_0_op_res_f_res_76612 = x_76589;\n                        defunc_0_op_res_f_res_76613 = x_76590;\n                        defunc_0_op_res_f_res_76614 = x_76591;\n                    } else", " {\n                        int64_t defunc_0_op_res_f_res_f_res_76615;\n                        int64_t defunc_0_op_res_f_res_f_res_76616;\n                        int64_t defunc_0_op_res_f_res_f_res_76617;\n                        \n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76615 = redout_77501;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76615 = eta_p_76578;\n                        }\n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76616 = redout_77500;\n                            defunc_0_op_res_f_res_f_res_76617 = redout_77502;\n                        } else {\n                            int64_t min_res_76618;\n                            int64_t tmp_76619;\n                            \n                            min_res_76618 = smin64(x_76589, redout_77500);\n                            tmp_76619 = add64(x_76591, redout_77502);\n                            defunc_0_op_res_f_res_f_res_76616 = min_res_76618;\n                            defunc_0_op_res_f_res_f_res_76617 = tmp_76619;\n                        }\n                        defunc_0_op_res_f_res_76612 = defunc_0_op_res_f_res_f_res_76616;\n                        defunc_0_op_res_f_res_76613 = defunc_0_op_res_f_res_f_res_76615;\n                        defunc_0_op_res_f_res_76614 = defunc_0_op_res_f_res_f_res_76617;\n                    }\n                    defunc_0_op_res_76609 = defunc_0_op_res_f_res_76612;\n                    defunc_0_op_res_76610 = defunc_0_op_res_f_res_76613;\n                    defunc_0_op_res_76611 = defunc_0_op_res_f_res_76614;\n                }\n                redout_tmp_78820 = defunc_0_op_res_76609;\n                redout_tmp_78821 = defunc_0_op_res_76610;\n                redout_tmp_78822 = defunc_0_op_res_76611;\n                redout_77500 = redout_tmp_78820;\n                redout_77501 = redout_tmp_78821;\n                redout",
                                    "_77502 = redout_tmp_78822;\n            }\n            x_76586 = redout_77500;\n            x_76587 = redout_77501;\n            x_76588 = redout_77502;\n            acc_76583 = x_76586;\n            acc_76584 = x_76587;\n            acc_76585 = x_76588;\n        } else {\n            acc_76583 = acc_76579;\n            acc_76584 = acc_76580;\n            acc_76585 = acc_76581;\n        }\n        mem_77955[(int64_t) 0] = acc_76583;\n        mem_77959[(int64_t) 0] = acc_76584;\n        mem_77963[(int64_t) 0] = acc_76585;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78814[i_6] = mem_77955[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78815[i_7] = mem_77959[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78816[i_8] = mem_77963[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77943[i_9] = mem_param_tmp_78814[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77944[i_10] = mem_param_tmp_78815[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77945[i_11] = mem_param_tmp_78816[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77966[i_12] = mem_param_77943[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77965[i_13] = mem_param_77944[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77964[i_14] = mem_param_77945[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76655) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77982[i_15] = ext_mem_77966[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77981[i_16] = ext_mem_77964[i_16];\n    } else {\n        int64_t ltid_flat_76657;\n        int64_t ltid_76656;\n        int64_t j_76672;\n        bool cond_76676;\n        int64_t pre1d_76679;\n        int64_t pre1d_76677;\n        int64_t pre1d_76678;\n        int64_t ltid_flat_76693;\n        ", "int64_t ltid_76692;\n        int64_t gtid_76706;\n        int64_t acc_76708;\n        int64_t acc_76710;\n        bool cond_76711;\n        int64_t acc_76712;\n        int64_t acc_76714;\n        \n        ltid_flat_76657 = sext_i32_i64(local_tid_78805);\n        ltid_76656 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n        j_76672 = ltid_76656 + binop_x_76671;\n        cond_76676 = slt64(j_76672, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76679 = btoi_bool_i64(cond_76676);\n        if (cond_76676) {\n            int64_t tile_elem_76680;\n            int64_t slice_77482;\n            int64_t tile_elem_76681;\n            \n            tile_elem_76680 = ((__global int64_t *) ext_mem_77925)[j_76672];\n            slice_77482 = tS_start_66998 + j_76672;\n            tile_elem_76681 = ((__global int64_t *) tS_mem_77626)[slice_77482];\n            pre1d_76677 = tile_elem_76680;\n            pre1d_76678 = tile_elem_76681;\n        } else {\n            pre1d_76677 = (int64_t) 0;\n            pre1d_76678 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76656] = pre1d_76677;\n        ((__local int64_t *) color_78692)[ltid_76656] = pre1d_76678;\n        ((__local int64_t *) color_78691)[ltid_76656] = pre1d_76679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76693 = sext_i32_i64(local_tid_78805);\n        ltid_76692 = sext_i32_i64(sext_i64_i32(ltid_pre_78809));\n        gtid_76706 = binop_x_76422 + ltid_76692;\n        acc_76708 = ext_mem_77966[(int64_t) 0];\n        acc_76710 = ext_mem_77964[(int64_t) 0];\n        cond_76711 = slt64(gtid_76706, min_res_68560);\n        if (cond_76711) {\n            int64_t eta_p_76707;\n            int64_t acc_76709;\n            int64_t x_76715;\n            int64_t x_76716;\n            int64_t x_76717;\n            int64_t redout_77504;\n            int64_t redout_77505;\n            int64_t redout_77506;\n            \n            eta_p_76707 = mem_77930[(int64_t) 0];\n            acc_76709 = ext_mem_77965[(int64_t) 0];\n", "            redout_77504 = acc_76708;\n            redout_77505 = acc_76709;\n            redout_77506 = acc_76710;\n            for (int64_t i_77507 = 0; i_77507 < residual_input_76654; i_77507++) {\n                int64_t x_76718;\n                int64_t x_76719;\n                bool defunc_0_neq_res_76727;\n                bool defunc_0_neq_res_76728;\n                bool cond_f_res_76729;\n                bool y_76730;\n                bool cond_76731;\n                bool defunc_0_neq_res_76732;\n                bool defunc_0_neq_res_76733;\n                bool cond_t_res_f_res_76734;\n                bool y_76735;\n                bool cond_t_res_76736;\n                bool x_76737;\n                int64_t defunc_0_op_res_76738;\n                int64_t defunc_0_op_res_76739;\n                int64_t defunc_0_op_res_76740;\n                int64_t redout_tmp_78823;\n                int64_t redout_tmp_78824;\n                int64_t redout_tmp_78825;\n                \n                x_76718 = ((__local int64_t *) color_78693)[i_77507];\n                x_76719 = ((__local int64_t *) color_78692)[i_77507];\n                defunc_0_neq_res_76727 = redout_77505 == eta_p_76707;\n                defunc_0_neq_res_76728 = !defunc_0_neq_res_76727;\n                cond_f_res_76729 = slt64(redout_77504, (int64_t) 0);\n                y_76730 = defunc_0_neq_res_76727 && cond_f_res_76729;\n                cond_76731 = defunc_0_neq_res_76728 || y_76730;\n                defunc_0_neq_res_76732 = x_76719 == eta_p_76707;\n                defunc_0_neq_res_76733 = !defunc_0_neq_res_76732;\n                cond_t_res_f_res_76734 = slt64(x_76718, (int64_t) 0);\n                y_76735 = defunc_0_neq_res_76732 && cond_t_res_f_res_76734;\n                cond_t_res_76736 = defunc_0_neq_res_76733 || y_76735;\n                x_76737 = cond_76731 && cond_t_res_76736;\n                if (x_76737) {\n                    defunc_0_op_res_76738 = (int64_t) -1;\n                    defunc_0_op_res_76739 = eta_p_7670",
                                    "7;\n                    defunc_0_op_res_76740 = (int64_t) 0;\n                } else {\n                    int64_t x_76720;\n                    int64_t defunc_0_op_res_f_res_76741;\n                    int64_t defunc_0_op_res_f_res_76742;\n                    int64_t defunc_0_op_res_f_res_76743;\n                    \n                    x_76720 = ((__local int64_t *) color_78691)[i_77507];\n                    if (cond_76731) {\n                        defunc_0_op_res_f_res_76741 = x_76718;\n                        defunc_0_op_res_f_res_76742 = x_76719;\n                        defunc_0_op_res_f_res_76743 = x_76720;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_76744;\n                        int64_t defunc_0_op_res_f_res_f_res_76745;\n                        int64_t defunc_0_op_res_f_res_f_res_76746;\n                        \n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76744 = redout_77505;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76744 = eta_p_76707;\n                        }\n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76745 = redout_77504;\n                            defunc_0_op_res_f_res_f_res_76746 = redout_77506;\n                        } else {\n                            int64_t min_res_76747;\n                            int64_t tmp_76748;\n                            \n                            min_res_76747 = smin64(x_76718, redout_77504);\n                            tmp_76748 = add64(x_76720, redout_77506);\n                            defunc_0_op_res_f_res_f_res_76745 = min_res_76747;\n                            defunc_0_op_res_f_res_f_res_76746 = tmp_76748;\n                        }\n                        defunc_0_op_res_f_res_76741 = defunc_0_op_res_f_res_f_res_76745;\n                        defunc_0_op_res_f_res_76742 = defunc_0_op_res_f_res_f_res_76744;\n ", "                       defunc_0_op_res_f_res_76743 = defunc_0_op_res_f_res_f_res_76746;\n                    }\n                    defunc_0_op_res_76738 = defunc_0_op_res_f_res_76741;\n                    defunc_0_op_res_76739 = defunc_0_op_res_f_res_76742;\n                    defunc_0_op_res_76740 = defunc_0_op_res_f_res_76743;\n                }\n                redout_tmp_78823 = defunc_0_op_res_76738;\n                redout_tmp_78824 = defunc_0_op_res_76739;\n                redout_tmp_78825 = defunc_0_op_res_76740;\n                redout_77504 = redout_tmp_78823;\n                redout_77505 = redout_tmp_78824;\n                redout_77506 = redout_tmp_78825;\n            }\n            x_76715 = redout_77504;\n            x_76716 = redout_77505;\n            x_76717 = redout_77506;\n            acc_76712 = x_76715;\n            acc_76714 = x_76717;\n        } else {\n            acc_76712 = acc_76708;\n            acc_76714 = acc_76710;\n        }\n        mem_77976[(int64_t) 0] = acc_76712;\n        mem_77980[(int64_t) 0] = acc_76714;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77982[i_17] = mem_77976[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77981[i_18] = mem_77980[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78805) + tile_sizze_76414 * sext_i32_i64(block_id_78806), min_res_68560)) {\n        int64_t tmp_78826 = ext_mem_77982[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77984)[sext_i32_i64(local_tid_78805) + tile_sizze_76414 * sext_i32_i64(block_id_78806)] = tmp_78826;\n    }\n    if (slt64(sext_i32_i64(local_tid_78805) + tile_sizze_76414 * sext_i32_i64(block_id_78806), min_res_68560)) {\n        int64_t tmp_78827 = ext_mem_77981[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77986)[sext_i32_i64(local_tid_78805) + tile_sizze_76414 * sext_i32_i64(block_id_78806)] = tmp_78827;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76414\n    #undef bytes_7794", "6\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_76767_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_76767(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_76770, int64_t num_whole_tiles_76785, int64_t residual_input_77009, unsigned char cond_77010_bits, int64_t binop_x_77026, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77840, __global unsigned char *mem_77842)\n{\n    bool cond_77010 = cond_77010_bits;\n    \n    #define tile_sizze_76769 (inner_SMJ_longzisegmap_intrablock_76767zitile_sizze_76769)\n    #define bytes_77802 (inner_SMJ_longzisegmap_intrablock_76767zibytes_77802)\n    \n    volatile __local unsigned char *color_78696_backing_2 = &shared_mem[0];\n    const int64_t color_78696_backing_2_offset = 0 + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78695_backing_1 = &shared_mem[color_78696_backing_2_offset];\n    const int64_t color_78695_backing_1_offset = color_78696_backing_2_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78694_backing_0 = &shared_mem[color_78695_backing_1_offset];\n    const int64_t color_78694_backing_0_offset = color_78695_backing_1_offset + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78946;\n    int32_t tblock_sizze_78949;\n    int32_t wave_sizze_78948;\n    int32_t block_id_78947;\n    int32_t global_tid_78945;\n    int64_t gid_flat_76767;\n    int64_t slice_78951;\n    int64_t ltid_pre_78950;\n    int64_t remnant_78952;\n    int64_t slice_78953;\n    int64_t gid_76766;\n    int64_t remnant_78954;\n    __local unsigned char *color_78694;\n    __local unsigned char *color_78695;\n    _",
                                    "_local unsigned char *color_78696;\n    int64_t binop_x_76777;\n    int64_t mem_77786[1];\n    int64_t ltid_flat_76772;\n    int64_t ltid_76771;\n    int64_t gtid_76778;\n    bool cond_76779;\n    int64_t pre_76780;\n    int64_t mem_77790[1];\n    int64_t mem_77794[1];\n    int64_t mem_77798[1];\n    int64_t ltid_flat_76787;\n    int64_t ltid_76786;\n    int64_t gtid_76797;\n    bool cond_76798;\n    int64_t neutral_76799;\n    int64_t neutral_76800;\n    int64_t ext_mem_77822[1];\n    int64_t ext_mem_77821[1];\n    int64_t ext_mem_77820[1];\n    int64_t mem_param_77799[1];\n    int64_t mem_param_77800[1];\n    int64_t mem_param_77801[1];\n    int64_t mem_77832[1];\n    int64_t mem_77836[1];\n    int64_t ext_mem_77838[1];\n    int64_t ext_mem_77837[1];\n    \n    local_tid_78946 = get_local_id(0);\n    tblock_sizze_78949 = get_local_size(0);\n    wave_sizze_78948 = LOCKSTEP_WIDTH;\n    block_id_78947 = get_tblock_id(0);\n    global_tid_78945 = block_id_78947 * tblock_sizze_78949 + local_tid_78946;\n    gid_flat_76767 = sext_i32_i64(block_id_78947);\n    slice_78951 = tile_sizze_76769;\n    ltid_pre_78950 = sext_i32_i64(local_tid_78946);\n    remnant_78952 = sext_i32_i64(local_tid_78946) - ltid_pre_78950;\n    slice_78953 = ldim_76770;\n    gid_76766 = sext_i32_i64(block_id_78947);\n    remnant_78954 = sext_i32_i64(block_id_78947) - gid_76766;\n    color_78694 = (__local unsigned char *) color_78694_backing_0;\n    color_78695 = (__local unsigned char *) color_78695_backing_1;\n    color_78696 = (__local unsigned char *) color_78696_backing_2;\n    binop_x_76777 = gid_76766 * tile_sizze_76769;\n    ltid_flat_76772 = sext_i32_i64(local_tid_78946);\n    ltid_76771 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n    gtid_76778 = ltid_76771 + binop_x_76777;\n    cond_76779 = slt64(gtid_76778, min_res_67698);\n    if (cond_76779) {\n        int64_t slice_76781;\n        int64_t eta_p_76782;\n        \n        slice_76781 = slice_67712 + gtid_76778;\n        eta_p_76782 = ((__global int64_t *) tR_mem_77625)[slice_76781];\n    ", "    pre_76780 = eta_p_76782;\n    } else {\n        pre_76780 = (int64_t) 0;\n    }\n    mem_77786[(int64_t) 0] = pre_76780;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76787 = sext_i32_i64(local_tid_78946);\n    ltid_76786 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n    gtid_76797 = binop_x_76777 + ltid_76786;\n    cond_76798 = slt64(gtid_76797, min_res_67698);\n    if (cond_76798) {\n        neutral_76799 = (int64_t) -1;\n    } else {\n        neutral_76799 = (int64_t) 0;\n    }\n    if (cond_76798) {\n        int64_t eta_p_76802 = mem_77786[(int64_t) 0];\n        \n        neutral_76800 = eta_p_76802;\n    } else {\n        neutral_76800 = (int64_t) 0;\n    }\n    mem_77790[(int64_t) 0] = neutral_76799;\n    mem_77794[(int64_t) 0] = neutral_76800;\n    mem_77798[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77799[i_3] = mem_77790[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77800[i_4] = mem_77794[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77801[i_5] = mem_77798[i_5];\n    for (int64_t tile_id_76812 = 0; tile_id_76812 < num_whole_tiles_76785; tile_id_76812++) {\n        int64_t binop_x_76911;\n        int64_t ltid_flat_76910;\n        int64_t ltid_76909;\n        int64_t j_76912;\n        bool cond_76916;\n        int64_t pre1d_76919;\n        int64_t pre1d_76917;\n        int64_t pre1d_76918;\n        int64_t mem_77811[1];\n        int64_t mem_77815[1];\n        int64_t mem_77819[1];\n        int64_t ltid_flat_76930;\n        int64_t ltid_76929;\n        int64_t gtid_76932;\n        int64_t acc_76934;\n        int64_t acc_76935;\n        int64_t acc_76936;\n        bool cond_76937;\n        int64_t acc_76938;\n        int64_t acc_76939;\n        int64_t acc_76940;\n        int64_t mem_param_tmp_78955[1];\n        int64_t mem_param_tmp_78956[1];\n        int64_t mem_param_tmp_78957[1];\n        \n        binop_x_76911 = tile_sizze_76769 * tile_id_76812;\n", "        ltid_flat_76910 = sext_i32_i64(local_tid_78946);\n        ltid_76909 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n        j_76912 = ltid_76909 + binop_x_76911;\n        cond_76916 = slt64(j_76912, j_m_i_67660);\n        pre1d_76919 = btoi_bool_i64(cond_76916);\n        if (cond_76916) {\n            int64_t tile_elem_76920;\n            int64_t slice_77487;\n            int64_t tile_elem_76921;\n            \n            tile_elem_76920 = ((__global int64_t *) ext_mem_77720)[j_76912];\n            slice_77487 = slice_68069 + j_76912;\n            tile_elem_76921 = ((__global int64_t *) tS_mem_77626)[slice_77487];\n            pre1d_76917 = tile_elem_76920;\n            pre1d_76918 = tile_elem_76921;\n        } else {\n            pre1d_76917 = (int64_t) 0;\n            pre1d_76918 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_76909] = pre1d_76917;\n        ((__local int64_t *) color_78695)[ltid_76909] = pre1d_76918;\n        ((__local int64_t *) color_78694)[ltid_76909] = pre1d_76919;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76930 = sext_i32_i64(local_tid_78946);\n        ltid_76929 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n        gtid_76932 = binop_x_76777 + ltid_76929;\n        acc_76934 = mem_param_77799[(int64_t) 0];\n        acc_76935 = mem_param_77800[(int64_t) 0];\n        acc_76936 = mem_param_77801[(int64_t) 0];\n        cond_76937 = slt64(gtid_76932, min_res_67698);\n        if (cond_76937) {\n            int64_t eta_p_76933;\n            int64_t x_76941;\n            int64_t x_76942;\n            int64_t x_76943;\n            int64_t redout_77508;\n            int64_t redout_77509;\n            int64_t redout_77510;\n            \n            eta_p_76933 = mem_77786[(int64_t) 0];\n            redout_77508 = acc_76934;\n            redout_77509 = acc_76935;\n            redout_77510 = acc_76936;\n            for (int64_t i_77511 = 0; i_77511 < tile_sizze_76769; i_77511++) {\n                int64_t x_76944;\n                int64_t x_76945;",
                                    "\n                bool defunc_0_neq_res_76953;\n                bool defunc_0_neq_res_76954;\n                bool cond_f_res_76955;\n                bool y_76956;\n                bool cond_76957;\n                bool defunc_0_neq_res_76958;\n                bool defunc_0_neq_res_76959;\n                bool cond_t_res_f_res_76960;\n                bool y_76961;\n                bool cond_t_res_76962;\n                bool x_76963;\n                int64_t defunc_0_op_res_76964;\n                int64_t defunc_0_op_res_76965;\n                int64_t defunc_0_op_res_76966;\n                int64_t redout_tmp_78961;\n                int64_t redout_tmp_78962;\n                int64_t redout_tmp_78963;\n                \n                x_76944 = ((__local int64_t *) color_78696)[i_77511];\n                x_76945 = ((__local int64_t *) color_78695)[i_77511];\n                defunc_0_neq_res_76953 = redout_77509 == eta_p_76933;\n                defunc_0_neq_res_76954 = !defunc_0_neq_res_76953;\n                cond_f_res_76955 = slt64(redout_77508, (int64_t) 0);\n                y_76956 = defunc_0_neq_res_76953 && cond_f_res_76955;\n                cond_76957 = defunc_0_neq_res_76954 || y_76956;\n                defunc_0_neq_res_76958 = x_76945 == eta_p_76933;\n                defunc_0_neq_res_76959 = !defunc_0_neq_res_76958;\n                cond_t_res_f_res_76960 = slt64(x_76944, (int64_t) 0);\n                y_76961 = defunc_0_neq_res_76958 && cond_t_res_f_res_76960;\n                cond_t_res_76962 = defunc_0_neq_res_76959 || y_76961;\n                x_76963 = cond_76957 && cond_t_res_76962;\n                if (x_76963) {\n                    defunc_0_op_res_76964 = (int64_t) -1;\n                    defunc_0_op_res_76965 = eta_p_76933;\n                    defunc_0_op_res_76966 = (int64_t) 0;\n                } else {\n                    int64_t x_76946;\n                    int64_t defunc_0_op_res_f_res_76967;\n                    int64_t defunc_0_op_res_f_res_76968;\n                    int64_", "t defunc_0_op_res_f_res_76969;\n                    \n                    x_76946 = ((__local int64_t *) color_78694)[i_77511];\n                    if (cond_76957) {\n                        defunc_0_op_res_f_res_76967 = x_76944;\n                        defunc_0_op_res_f_res_76968 = x_76945;\n                        defunc_0_op_res_f_res_76969 = x_76946;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_76970;\n                        int64_t defunc_0_op_res_f_res_f_res_76971;\n                        int64_t defunc_0_op_res_f_res_f_res_76972;\n                        \n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76970 = redout_77509;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76970 = eta_p_76933;\n                        }\n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76971 = redout_77508;\n                            defunc_0_op_res_f_res_f_res_76972 = redout_77510;\n                        } else {\n                            int64_t min_res_76973;\n                            int64_t tmp_76974;\n                            \n                            min_res_76973 = smin64(x_76944, redout_77508);\n                            tmp_76974 = add64(x_76946, redout_77510);\n                            defunc_0_op_res_f_res_f_res_76971 = min_res_76973;\n                            defunc_0_op_res_f_res_f_res_76972 = tmp_76974;\n                        }\n                        defunc_0_op_res_f_res_76967 = defunc_0_op_res_f_res_f_res_76971;\n                        defunc_0_op_res_f_res_76968 = defunc_0_op_res_f_res_f_res_76970;\n                        defunc_0_op_res_f_res_76969 = defunc_0_op_res_f_res_f_res_76972;\n                    }\n                    defunc_0_op_res_76964 = defunc_0_op_res_f_res_76967;\n                    defunc_0_op_res_76965 = defunc_0_op_res_f_res_76968;\n      ", "              defunc_0_op_res_76966 = defunc_0_op_res_f_res_76969;\n                }\n                redout_tmp_78961 = defunc_0_op_res_76964;\n                redout_tmp_78962 = defunc_0_op_res_76965;\n                redout_tmp_78963 = defunc_0_op_res_76966;\n                redout_77508 = redout_tmp_78961;\n                redout_77509 = redout_tmp_78962;\n                redout_77510 = redout_tmp_78963;\n            }\n            x_76941 = redout_77508;\n            x_76942 = redout_77509;\n            x_76943 = redout_77510;\n            acc_76938 = x_76941;\n            acc_76939 = x_76942;\n            acc_76940 = x_76943;\n        } else {\n            acc_76938 = acc_76934;\n            acc_76939 = acc_76935;\n            acc_76940 = acc_76936;\n        }\n        mem_77811[(int64_t) 0] = acc_76938;\n        mem_77815[(int64_t) 0] = acc_76939;\n        mem_77819[(int64_t) 0] = acc_76940;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78955[i_6] = mem_77811[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78956[i_7] = mem_77815[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78957[i_8] = mem_77819[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77799[i_9] = mem_param_tmp_78955[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77800[i_10] = mem_param_tmp_78956[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77801[i_11] = mem_param_tmp_78957[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77822[i_12] = mem_param_77799[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77821[i_13] = mem_param_77800[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77820[i_14] = mem_param_77801[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77010) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77838[i_15] ",
                                    "= ext_mem_77822[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77837[i_16] = ext_mem_77820[i_16];\n    } else {\n        int64_t ltid_flat_77012;\n        int64_t ltid_77011;\n        int64_t j_77027;\n        bool cond_77031;\n        int64_t pre1d_77034;\n        int64_t pre1d_77032;\n        int64_t pre1d_77033;\n        int64_t ltid_flat_77048;\n        int64_t ltid_77047;\n        int64_t gtid_77061;\n        int64_t acc_77063;\n        int64_t acc_77065;\n        bool cond_77066;\n        int64_t acc_77067;\n        int64_t acc_77069;\n        \n        ltid_flat_77012 = sext_i32_i64(local_tid_78946);\n        ltid_77011 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n        j_77027 = ltid_77011 + binop_x_77026;\n        cond_77031 = slt64(j_77027, j_m_i_67660);\n        pre1d_77034 = btoi_bool_i64(cond_77031);\n        if (cond_77031) {\n            int64_t tile_elem_77035;\n            int64_t slice_77486;\n            int64_t tile_elem_77036;\n            \n            tile_elem_77035 = ((__global int64_t *) ext_mem_77720)[j_77027];\n            slice_77486 = slice_68069 + j_77027;\n            tile_elem_77036 = ((__global int64_t *) tS_mem_77626)[slice_77486];\n            pre1d_77032 = tile_elem_77035;\n            pre1d_77033 = tile_elem_77036;\n        } else {\n            pre1d_77032 = (int64_t) 0;\n            pre1d_77033 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_77011] = pre1d_77032;\n        ((__local int64_t *) color_78695)[ltid_77011] = pre1d_77033;\n        ((__local int64_t *) color_78694)[ltid_77011] = pre1d_77034;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77048 = sext_i32_i64(local_tid_78946);\n        ltid_77047 = sext_i32_i64(sext_i64_i32(ltid_pre_78950));\n        gtid_77061 = binop_x_76777 + ltid_77047;\n        acc_77063 = ext_mem_77822[(int64_t) 0];\n        acc_77065 = ext_mem_77820[(int64_t) 0];\n        cond_77066 = slt64(gtid_77061, min_res_67698);\n        if (cond_77066) {\n            int64_t eta_p_77", "062;\n            int64_t acc_77064;\n            int64_t x_77070;\n            int64_t x_77071;\n            int64_t x_77072;\n            int64_t redout_77512;\n            int64_t redout_77513;\n            int64_t redout_77514;\n            \n            eta_p_77062 = mem_77786[(int64_t) 0];\n            acc_77064 = ext_mem_77821[(int64_t) 0];\n            redout_77512 = acc_77063;\n            redout_77513 = acc_77064;\n            redout_77514 = acc_77065;\n            for (int64_t i_77515 = 0; i_77515 < residual_input_77009; i_77515++) {\n                int64_t x_77073;\n                int64_t x_77074;\n                bool defunc_0_neq_res_77082;\n                bool defunc_0_neq_res_77083;\n                bool cond_f_res_77084;\n                bool y_77085;\n                bool cond_77086;\n                bool defunc_0_neq_res_77087;\n                bool defunc_0_neq_res_77088;\n                bool cond_t_res_f_res_77089;\n                bool y_77090;\n                bool cond_t_res_77091;\n                bool x_77092;\n                int64_t defunc_0_op_res_77093;\n                int64_t defunc_0_op_res_77094;\n                int64_t defunc_0_op_res_77095;\n                int64_t redout_tmp_78964;\n                int64_t redout_tmp_78965;\n                int64_t redout_tmp_78966;\n                \n                x_77073 = ((__local int64_t *) color_78696)[i_77515];\n                x_77074 = ((__local int64_t *) color_78695)[i_77515];\n                defunc_0_neq_res_77082 = redout_77513 == eta_p_77062;\n                defunc_0_neq_res_77083 = !defunc_0_neq_res_77082;\n                cond_f_res_77084 = slt64(redout_77512, (int64_t) 0);\n                y_77085 = defunc_0_neq_res_77082 && cond_f_res_77084;\n                cond_77086 = defunc_0_neq_res_77083 || y_77085;\n                defunc_0_neq_res_77087 = x_77074 == eta_p_77062;\n                defunc_0_neq_res_77088 = !defunc_0_neq_res_77087;\n                cond_t_res_f_res_77089 = slt64(x_77073, (int64_t) 0);\n       ", "         y_77090 = defunc_0_neq_res_77087 && cond_t_res_f_res_77089;\n                cond_t_res_77091 = defunc_0_neq_res_77088 || y_77090;\n                x_77092 = cond_77086 && cond_t_res_77091;\n                if (x_77092) {\n                    defunc_0_op_res_77093 = (int64_t) -1;\n                    defunc_0_op_res_77094 = eta_p_77062;\n                    defunc_0_op_res_77095 = (int64_t) 0;\n                } else {\n                    int64_t x_77075;\n                    int64_t defunc_0_op_res_f_res_77096;\n                    int64_t defunc_0_op_res_f_res_77097;\n                    int64_t defunc_0_op_res_f_res_77098;\n                    \n                    x_77075 = ((__local int64_t *) color_78694)[i_77515];\n                    if (cond_77086) {\n                        defunc_0_op_res_f_res_77096 = x_77073;\n                        defunc_0_op_res_f_res_77097 = x_77074;\n                        defunc_0_op_res_f_res_77098 = x_77075;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_77099;\n                        int64_t defunc_0_op_res_f_res_f_res_77100;\n                        int64_t defunc_0_op_res_f_res_f_res_77101;\n                        \n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77099 = redout_77513;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77099 = eta_p_77062;\n                        }\n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77100 = redout_77512;\n                            defunc_0_op_res_f_res_f_res_77101 = redout_77514;\n                        } else {\n                            int64_t min_res_77102;\n                            int64_t tmp_77103;\n                            \n                            min_res_77102 = smin64(x_77073, redout_77512);\n                            tmp_77103 = add64(x_77075, redout_77514);\n                   ",
                                    "         defunc_0_op_res_f_res_f_res_77100 = min_res_77102;\n                            defunc_0_op_res_f_res_f_res_77101 = tmp_77103;\n                        }\n                        defunc_0_op_res_f_res_77096 = defunc_0_op_res_f_res_f_res_77100;\n                        defunc_0_op_res_f_res_77097 = defunc_0_op_res_f_res_f_res_77099;\n                        defunc_0_op_res_f_res_77098 = defunc_0_op_res_f_res_f_res_77101;\n                    }\n                    defunc_0_op_res_77093 = defunc_0_op_res_f_res_77096;\n                    defunc_0_op_res_77094 = defunc_0_op_res_f_res_77097;\n                    defunc_0_op_res_77095 = defunc_0_op_res_f_res_77098;\n                }\n                redout_tmp_78964 = defunc_0_op_res_77093;\n                redout_tmp_78965 = defunc_0_op_res_77094;\n                redout_tmp_78966 = defunc_0_op_res_77095;\n                redout_77512 = redout_tmp_78964;\n                redout_77513 = redout_tmp_78965;\n                redout_77514 = redout_tmp_78966;\n            }\n            x_77070 = redout_77512;\n            x_77071 = redout_77513;\n            x_77072 = redout_77514;\n            acc_77067 = x_77070;\n            acc_77069 = x_77072;\n        } else {\n            acc_77067 = acc_77063;\n            acc_77069 = acc_77065;\n        }\n        mem_77832[(int64_t) 0] = acc_77067;\n        mem_77836[(int64_t) 0] = acc_77069;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77838[i_17] = mem_77832[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77837[i_18] = mem_77836[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78946) + tile_sizze_76769 * sext_i32_i64(block_id_78947), min_res_67698)) {\n        int64_t tmp_78967 = ext_mem_77838[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77840)[sext_i32_i64(local_tid_78946) + tile_sizze_76769 * sext_i32_i64(block_id_78947)] = tmp_78967;\n    }\n    if (slt64(sext_i32_i64(local_tid_78946) + tile_sizze", "_76769 * sext_i32_i64(block_id_78947), min_res_67698)) {\n        int64_t tmp_78968 = ext_mem_77837[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77842)[sext_i32_i64(local_tid_78946) + tile_sizze_76769 * sext_i32_i64(block_id_78947)] = tmp_78968;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76769\n    #undef bytes_77802\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_77122_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_77122(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_77125, int64_t num_whole_tiles_77140, int64_t residual_input_77364, unsigned char cond_77365_bits, int64_t binop_x_77381, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77779, __global unsigned char *mem_77781)\n{\n    bool cond_77365 = cond_77365_bits;\n    \n    #define tile_sizze_77124 (inner_SMJ_longzisegmap_intrablock_77122zitile_sizze_77124)\n    #define bytes_77741 (inner_SMJ_longzisegmap_intrablock_77122zibytes_77741)\n    \n    volatile __local unsigned char *color_78699_backing_2 = &shared_mem[0];\n    const int64_t color_78699_backing_2_offset = 0 + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78698_backing_1 = &shared_mem[color_78699_backing_2_offset];\n    const int64_t color_78698_backing_1_offset = color_78699_backing_2_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78697_backing_0 = &shared_mem[color_78698_backing_1_offset];\n    const int64_t color_78697_backing_0_offset = color_78698_backing_1_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78972;\n    int32_t tblock_sizze_78975;\n    int32_t wave", "_sizze_78974;\n    int32_t block_id_78973;\n    int32_t global_tid_78971;\n    int64_t gid_flat_77122;\n    int64_t slice_78977;\n    int64_t ltid_pre_78976;\n    int64_t remnant_78978;\n    int64_t slice_78979;\n    int64_t gid_77121;\n    int64_t remnant_78980;\n    __local unsigned char *color_78697;\n    __local unsigned char *color_78698;\n    __local unsigned char *color_78699;\n    int64_t binop_x_77132;\n    int64_t mem_77725[1];\n    int64_t ltid_flat_77127;\n    int64_t ltid_77126;\n    int64_t gtid_77133;\n    bool cond_77134;\n    int64_t pre_77135;\n    int64_t mem_77729[1];\n    int64_t mem_77733[1];\n    int64_t mem_77737[1];\n    int64_t ltid_flat_77142;\n    int64_t ltid_77141;\n    int64_t gtid_77152;\n    bool cond_77153;\n    int64_t neutral_77154;\n    int64_t neutral_77155;\n    int64_t ext_mem_77761[1];\n    int64_t ext_mem_77760[1];\n    int64_t ext_mem_77759[1];\n    int64_t mem_param_77738[1];\n    int64_t mem_param_77739[1];\n    int64_t mem_param_77740[1];\n    int64_t mem_77771[1];\n    int64_t mem_77775[1];\n    int64_t ext_mem_77777[1];\n    int64_t ext_mem_77776[1];\n    \n    local_tid_78972 = get_local_id(0);\n    tblock_sizze_78975 = get_local_size(0);\n    wave_sizze_78974 = LOCKSTEP_WIDTH;\n    block_id_78973 = get_tblock_id(0);\n    global_tid_78971 = block_id_78973 * tblock_sizze_78975 + local_tid_78972;\n    gid_flat_77122 = sext_i32_i64(block_id_78973);\n    slice_78977 = tile_sizze_77124;\n    ltid_pre_78976 = sext_i32_i64(local_tid_78972);\n    remnant_78978 = sext_i32_i64(local_tid_78972) - ltid_pre_78976;\n    slice_78979 = ldim_77125;\n    gid_77121 = sext_i32_i64(block_id_78973);\n    remnant_78980 = sext_i32_i64(block_id_78973) - gid_77121;\n    color_78697 = (__local unsigned char *) color_78697_backing_0;\n    color_78698 = (__local unsigned char *) color_78698_backing_1;\n    color_78699 = (__local unsigned char *) color_78699_backing_2;\n    binop_x_77132 = gid_77121 * tile_sizze_77124;\n    ltid_flat_77127 = sext_i32_i64(local_tid_78972);\n    ltid_77126 = sext_i32_i64(",
                                    "sext_i64_i32(ltid_pre_78976));\n    gtid_77133 = ltid_77126 + binop_x_77132;\n    cond_77134 = slt64(gtid_77133, min_res_67698);\n    if (cond_77134) {\n        int64_t slice_77136;\n        int64_t eta_p_77137;\n        \n        slice_77136 = slice_67712 + gtid_77133;\n        eta_p_77137 = ((__global int64_t *) tR_mem_77625)[slice_77136];\n        pre_77135 = eta_p_77137;\n    } else {\n        pre_77135 = (int64_t) 0;\n    }\n    mem_77725[(int64_t) 0] = pre_77135;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_77142 = sext_i32_i64(local_tid_78972);\n    ltid_77141 = sext_i32_i64(sext_i64_i32(ltid_pre_78976));\n    gtid_77152 = binop_x_77132 + ltid_77141;\n    cond_77153 = slt64(gtid_77152, min_res_67698);\n    if (cond_77153) {\n        neutral_77154 = (int64_t) -1;\n    } else {\n        neutral_77154 = (int64_t) 0;\n    }\n    if (cond_77153) {\n        int64_t eta_p_77157 = mem_77725[(int64_t) 0];\n        \n        neutral_77155 = eta_p_77157;\n    } else {\n        neutral_77155 = (int64_t) 0;\n    }\n    mem_77729[(int64_t) 0] = neutral_77154;\n    mem_77733[(int64_t) 0] = neutral_77155;\n    mem_77737[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77738[i_3] = mem_77729[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77739[i_4] = mem_77733[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77740[i_5] = mem_77737[i_5];\n    for (int64_t tile_id_77167 = 0; tile_id_77167 < num_whole_tiles_77140; tile_id_77167++) {\n        int64_t binop_x_77266;\n        int64_t ltid_flat_77265;\n        int64_t ltid_77264;\n        int64_t j_77267;\n        bool cond_77271;\n        int64_t pre1d_77274;\n        int64_t pre1d_77272;\n        int64_t pre1d_77273;\n        int64_t mem_77750[1];\n        int64_t mem_77754[1];\n        int64_t mem_77758[1];\n        int64_t ltid_flat_77285;\n        int64_t ltid_77284;\n        int64_t gtid_77287;\n        int64_t acc_77289;\n       ", " int64_t acc_77290;\n        int64_t acc_77291;\n        bool cond_77292;\n        int64_t acc_77293;\n        int64_t acc_77294;\n        int64_t acc_77295;\n        int64_t mem_param_tmp_78981[1];\n        int64_t mem_param_tmp_78982[1];\n        int64_t mem_param_tmp_78983[1];\n        \n        binop_x_77266 = tile_sizze_77124 * tile_id_77167;\n        ltid_flat_77265 = sext_i32_i64(local_tid_78972);\n        ltid_77264 = sext_i32_i64(sext_i64_i32(ltid_pre_78976));\n        j_77267 = ltid_77264 + binop_x_77266;\n        cond_77271 = slt64(j_77267, j_m_i_67660);\n        pre1d_77274 = btoi_bool_i64(cond_77271);\n        if (cond_77271) {\n            int64_t tile_elem_77275;\n            int64_t slice_77491;\n            int64_t tile_elem_77276;\n            \n            tile_elem_77275 = ((__global int64_t *) ext_mem_77720)[j_77267];\n            slice_77491 = slice_68069 + j_77267;\n            tile_elem_77276 = ((__global int64_t *) tS_mem_77626)[slice_77491];\n            pre1d_77272 = tile_elem_77275;\n            pre1d_77273 = tile_elem_77276;\n        } else {\n            pre1d_77272 = (int64_t) 0;\n            pre1d_77273 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77264] = pre1d_77272;\n        ((__local int64_t *) color_78698)[ltid_77264] = pre1d_77273;\n        ((__local int64_t *) color_78697)[ltid_77264] = pre1d_77274;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77285 = sext_i32_i64(local_tid_78972);\n        ltid_77284 = sext_i32_i64(sext_i64_i32(ltid_pre_78976));\n        gtid_77287 = binop_x_77132 + ltid_77284;\n        acc_77289 = mem_param_77738[(int64_t) 0];\n        acc_77290 = mem_param_77739[(int64_t) 0];\n        acc_77291 = mem_param_77740[(int64_t) 0];\n        cond_77292 = slt64(gtid_77287, min_res_67698);\n        if (cond_77292) {\n            int64_t eta_p_77288;\n            int64_t x_77296;\n            int64_t x_77297;\n            int64_t x_77298;\n            int64_t redout_77516;\n            int64_t redout_77517;\n            int", "64_t redout_77518;\n            \n            eta_p_77288 = mem_77725[(int64_t) 0];\n            redout_77516 = acc_77289;\n            redout_77517 = acc_77290;\n            redout_77518 = acc_77291;\n            for (int64_t i_77519 = 0; i_77519 < tile_sizze_77124; i_77519++) {\n                int64_t x_77299;\n                int64_t x_77300;\n                bool defunc_0_neq_res_77308;\n                bool defunc_0_neq_res_77309;\n                bool cond_f_res_77310;\n                bool y_77311;\n                bool cond_77312;\n                bool defunc_0_neq_res_77313;\n                bool defunc_0_neq_res_77314;\n                bool cond_t_res_f_res_77315;\n                bool y_77316;\n                bool cond_t_res_77317;\n                bool x_77318;\n                int64_t defunc_0_op_res_77319;\n                int64_t defunc_0_op_res_77320;\n                int64_t defunc_0_op_res_77321;\n                int64_t redout_tmp_78987;\n                int64_t redout_tmp_78988;\n                int64_t redout_tmp_78989;\n                \n                x_77299 = ((__local int64_t *) color_78699)[i_77519];\n                x_77300 = ((__local int64_t *) color_78698)[i_77519];\n                defunc_0_neq_res_77308 = redout_77517 == eta_p_77288;\n                defunc_0_neq_res_77309 = !defunc_0_neq_res_77308;\n                cond_f_res_77310 = slt64(redout_77516, (int64_t) 0);\n                y_77311 = defunc_0_neq_res_77308 && cond_f_res_77310;\n                cond_77312 = defunc_0_neq_res_77309 || y_77311;\n                defunc_0_neq_res_77313 = x_77300 == eta_p_77288;\n                defunc_0_neq_res_77314 = !defunc_0_neq_res_77313;\n                cond_t_res_f_res_77315 = slt64(x_77299, (int64_t) 0);\n                y_77316 = defunc_0_neq_res_77313 && cond_t_res_f_res_77315;\n                cond_t_res_77317 = defunc_0_neq_res_77314 || y_77316;\n                x_77318 = cond_77312 && cond_t_res_77317;\n                if (x_77318) {\n                    defunc_0_op_re",
                                    "s_77319 = (int64_t) -1;\n                    defunc_0_op_res_77320 = eta_p_77288;\n                    defunc_0_op_res_77321 = (int64_t) 0;\n                } else {\n                    int64_t x_77301;\n                    int64_t defunc_0_op_res_f_res_77322;\n                    int64_t defunc_0_op_res_f_res_77323;\n                    int64_t defunc_0_op_res_f_res_77324;\n                    \n                    x_77301 = ((__local int64_t *) color_78697)[i_77519];\n                    if (cond_77312) {\n                        defunc_0_op_res_f_res_77322 = x_77299;\n                        defunc_0_op_res_f_res_77323 = x_77300;\n                        defunc_0_op_res_f_res_77324 = x_77301;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_77325;\n                        int64_t defunc_0_op_res_f_res_f_res_77326;\n                        int64_t defunc_0_op_res_f_res_f_res_77327;\n                        \n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77325 = redout_77517;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77325 = eta_p_77288;\n                        }\n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77326 = redout_77516;\n                            defunc_0_op_res_f_res_f_res_77327 = redout_77518;\n                        } else {\n                            int64_t min_res_77328;\n                            int64_t tmp_77329;\n                            \n                            min_res_77328 = smin64(x_77299, redout_77516);\n                            tmp_77329 = add64(x_77301, redout_77518);\n                            defunc_0_op_res_f_res_f_res_77326 = min_res_77328;\n                            defunc_0_op_res_f_res_f_res_77327 = tmp_77329;\n                        }\n                        defunc_0_op_res_f_res_77322 = defunc_0_op_res_f_res_f_res_77326;\n            ", "            defunc_0_op_res_f_res_77323 = defunc_0_op_res_f_res_f_res_77325;\n                        defunc_0_op_res_f_res_77324 = defunc_0_op_res_f_res_f_res_77327;\n                    }\n                    defunc_0_op_res_77319 = defunc_0_op_res_f_res_77322;\n                    defunc_0_op_res_77320 = defunc_0_op_res_f_res_77323;\n                    defunc_0_op_res_77321 = defunc_0_op_res_f_res_77324;\n                }\n                redout_tmp_78987 = defunc_0_op_res_77319;\n                redout_tmp_78988 = defunc_0_op_res_77320;\n                redout_tmp_78989 = defunc_0_op_res_77321;\n                redout_77516 = redout_tmp_78987;\n                redout_77517 = redout_tmp_78988;\n                redout_77518 = redout_tmp_78989;\n            }\n            x_77296 = redout_77516;\n            x_77297 = redout_77517;\n            x_77298 = redout_77518;\n            acc_77293 = x_77296;\n            acc_77294 = x_77297;\n            acc_77295 = x_77298;\n        } else {\n            acc_77293 = acc_77289;\n            acc_77294 = acc_77290;\n            acc_77295 = acc_77291;\n        }\n        mem_77750[(int64_t) 0] = acc_77293;\n        mem_77754[(int64_t) 0] = acc_77294;\n        mem_77758[(int64_t) 0] = acc_77295;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78981[i_6] = mem_77750[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78982[i_7] = mem_77754[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78983[i_8] = mem_77758[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77738[i_9] = mem_param_tmp_78981[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77739[i_10] = mem_param_tmp_78982[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77740[i_11] = mem_param_tmp_78983[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77761[i_12] = mem_param_77738[", "i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77760[i_13] = mem_param_77739[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77759[i_14] = mem_param_77740[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77365) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77777[i_15] = ext_mem_77761[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77776[i_16] = ext_mem_77759[i_16];\n    } else {\n        int64_t ltid_flat_77367;\n        int64_t ltid_77366;\n        int64_t j_77382;\n        bool cond_77386;\n        int64_t pre1d_77389;\n        int64_t pre1d_77387;\n        int64_t pre1d_77388;\n        int64_t ltid_flat_77403;\n        int64_t ltid_77402;\n        int64_t gtid_77416;\n        int64_t acc_77418;\n        int64_t acc_77420;\n        bool cond_77421;\n        int64_t acc_77422;\n        int64_t acc_77424;\n        \n        ltid_flat_77367 = sext_i32_i64(local_tid_78972);\n        ltid_77366 = sext_i32_i64(sext_i64_i32(ltid_pre_78976));\n        j_77382 = ltid_77366 + binop_x_77381;\n        cond_77386 = slt64(j_77382, j_m_i_67660);\n        pre1d_77389 = btoi_bool_i64(cond_77386);\n        if (cond_77386) {\n            int64_t tile_elem_77390;\n            int64_t slice_77490;\n            int64_t tile_elem_77391;\n            \n            tile_elem_77390 = ((__global int64_t *) ext_mem_77720)[j_77382];\n            slice_77490 = slice_68069 + j_77382;\n            tile_elem_77391 = ((__global int64_t *) tS_mem_77626)[slice_77490];\n            pre1d_77387 = tile_elem_77390;\n            pre1d_77388 = tile_elem_77391;\n        } else {\n            pre1d_77387 = (int64_t) 0;\n            pre1d_77388 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77366] = pre1d_77387;\n        ((__local int64_t *) color_78698)[ltid_77366] = pre1d_77388;\n        ((__local int64_t *) color_78697)[ltid_77366] = pre1d_77389;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77403 = sext_i32_i",
                                    "64(local_tid_78972);\n        ltid_77402 = sext_i32_i64(sext_i64_i32(ltid_pre_78976));\n        gtid_77416 = binop_x_77132 + ltid_77402;\n        acc_77418 = ext_mem_77761[(int64_t) 0];\n        acc_77420 = ext_mem_77759[(int64_t) 0];\n        cond_77421 = slt64(gtid_77416, min_res_67698);\n        if (cond_77421) {\n            int64_t eta_p_77417;\n            int64_t acc_77419;\n            int64_t x_77425;\n            int64_t x_77426;\n            int64_t x_77427;\n            int64_t redout_77520;\n            int64_t redout_77521;\n            int64_t redout_77522;\n            \n            eta_p_77417 = mem_77725[(int64_t) 0];\n            acc_77419 = ext_mem_77760[(int64_t) 0];\n            redout_77520 = acc_77418;\n            redout_77521 = acc_77419;\n            redout_77522 = acc_77420;\n            for (int64_t i_77523 = 0; i_77523 < residual_input_77364; i_77523++) {\n                int64_t x_77428;\n                int64_t x_77429;\n                bool defunc_0_neq_res_77437;\n                bool defunc_0_neq_res_77438;\n                bool cond_f_res_77439;\n                bool y_77440;\n                bool cond_77441;\n                bool defunc_0_neq_res_77442;\n                bool defunc_0_neq_res_77443;\n                bool cond_t_res_f_res_77444;\n                bool y_77445;\n                bool cond_t_res_77446;\n                bool x_77447;\n                int64_t defunc_0_op_res_77448;\n                int64_t defunc_0_op_res_77449;\n                int64_t defunc_0_op_res_77450;\n                int64_t redout_tmp_78990;\n                int64_t redout_tmp_78991;\n                int64_t redout_tmp_78992;\n                \n                x_77428 = ((__local int64_t *) color_78699)[i_77523];\n                x_77429 = ((__local int64_t *) color_78698)[i_77523];\n                defunc_0_neq_res_77437 = redout_77521 == eta_p_77417;\n                defunc_0_neq_res_77438 = !defunc_0_neq_res_77437;\n                cond_f_res_77439 = slt64(redout_77520, (int64_t) 0);\n  ", "              y_77440 = defunc_0_neq_res_77437 && cond_f_res_77439;\n                cond_77441 = defunc_0_neq_res_77438 || y_77440;\n                defunc_0_neq_res_77442 = x_77429 == eta_p_77417;\n                defunc_0_neq_res_77443 = !defunc_0_neq_res_77442;\n                cond_t_res_f_res_77444 = slt64(x_77428, (int64_t) 0);\n                y_77445 = defunc_0_neq_res_77442 && cond_t_res_f_res_77444;\n                cond_t_res_77446 = defunc_0_neq_res_77443 || y_77445;\n                x_77447 = cond_77441 && cond_t_res_77446;\n                if (x_77447) {\n                    defunc_0_op_res_77448 = (int64_t) -1;\n                    defunc_0_op_res_77449 = eta_p_77417;\n                    defunc_0_op_res_77450 = (int64_t) 0;\n                } else {\n                    int64_t x_77430;\n                    int64_t defunc_0_op_res_f_res_77451;\n                    int64_t defunc_0_op_res_f_res_77452;\n                    int64_t defunc_0_op_res_f_res_77453;\n                    \n                    x_77430 = ((__local int64_t *) color_78697)[i_77523];\n                    if (cond_77441) {\n                        defunc_0_op_res_f_res_77451 = x_77428;\n                        defunc_0_op_res_f_res_77452 = x_77429;\n                        defunc_0_op_res_f_res_77453 = x_77430;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_77454;\n                        int64_t defunc_0_op_res_f_res_f_res_77455;\n                        int64_t defunc_0_op_res_f_res_f_res_77456;\n                        \n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77454 = redout_77521;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77454 = eta_p_77417;\n                        }\n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77455 = redout_77520;\n                            defunc_0_op_res_f_res_f_res_77456 ", "= redout_77522;\n                        } else {\n                            int64_t min_res_77457;\n                            int64_t tmp_77458;\n                            \n                            min_res_77457 = smin64(x_77428, redout_77520);\n                            tmp_77458 = add64(x_77430, redout_77522);\n                            defunc_0_op_res_f_res_f_res_77455 = min_res_77457;\n                            defunc_0_op_res_f_res_f_res_77456 = tmp_77458;\n                        }\n                        defunc_0_op_res_f_res_77451 = defunc_0_op_res_f_res_f_res_77455;\n                        defunc_0_op_res_f_res_77452 = defunc_0_op_res_f_res_f_res_77454;\n                        defunc_0_op_res_f_res_77453 = defunc_0_op_res_f_res_f_res_77456;\n                    }\n                    defunc_0_op_res_77448 = defunc_0_op_res_f_res_77451;\n                    defunc_0_op_res_77449 = defunc_0_op_res_f_res_77452;\n                    defunc_0_op_res_77450 = defunc_0_op_res_f_res_77453;\n                }\n                redout_tmp_78990 = defunc_0_op_res_77448;\n                redout_tmp_78991 = defunc_0_op_res_77449;\n                redout_tmp_78992 = defunc_0_op_res_77450;\n                redout_77520 = redout_tmp_78990;\n                redout_77521 = redout_tmp_78991;\n                redout_77522 = redout_tmp_78992;\n            }\n            x_77425 = redout_77520;\n            x_77426 = redout_77521;\n            x_77427 = redout_77522;\n            acc_77422 = x_77425;\n            acc_77424 = x_77427;\n        } else {\n            acc_77422 = acc_77418;\n            acc_77424 = acc_77420;\n        }\n        mem_77771[(int64_t) 0] = acc_77422;\n        mem_77775[(int64_t) 0] = acc_77424;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77777[i_17] = mem_77771[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77776[i_18] = mem_77775[i_18];\n    }\n    if (slt64(sext_i32_i64(local_ti",
                                    "d_78972) + tile_sizze_77124 * sext_i32_i64(block_id_78973), min_res_67698)) {\n        int64_t tmp_78993 = ext_mem_77777[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77779)[sext_i32_i64(local_tid_78972) + tile_sizze_77124 * sext_i32_i64(block_id_78973)] = tmp_78993;\n    }\n    if (slt64(sext_i32_i64(local_tid_78972) + tile_sizze_77124 * sext_i32_i64(block_id_78973), min_res_67698)) {\n        int64_t tmp_78994 = ext_mem_77776[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77781)[sext_i32_i64(local_tid_78972) + tile_sizze_77124 * sext_i32_i64(block_id_78973)] = tmp_78994;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_77124\n    #undef bytes_77741\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegscan_73345_dim1, 1, 1)\nvoid inner_SMJ_longzisegscan_73345(__global int *global_failure, int64_t nR_49324, int64_t num_tblocks_73342, int64_t num_virt_blocks_79062, int64_t num_virt_threads_79063, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *status_flags_mem_79064, __global unsigned char *aggregates_mem_79086, __global unsigned char *incprefixes_mem_79088, __global unsigned char *global_dynid_mem_79090)\n{\n    #define segscan_tblock_sizze_73340 (inner_SMJ_longzisegscan_73345zisegscan_tblock_sizze_73340)\n    #define chunk_sizze_79061 (inner_SMJ_longzisegscan_73345zichunk_sizze_79061)\n    \n    volatile __local unsigned char *local_mem_79120_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79120_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73340), chunk_sizze_79061 * segscan_tblock_sizze_73340 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73340), chunk_sizze_79061 * segscan_tblock_sizze_73340 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79113;\n    int32_t tblock_sizze_79116;\n    int32_t ", "wave_sizze_79115;\n    int32_t block_id_79114;\n    int32_t global_tid_79112;\n    int64_t phys_tid_73345;\n    int32_t chunk_sizze_32b_79117;\n    int64_t byte_offsets_79118;\n    int64_t warp_byte_offset_79119;\n    __local unsigned char *local_mem_79120;\n    int64_t trans_arr_len_79121;\n    int64_t phys_block_id_79127;\n    int64_t virtloop_bound_79128;\n    \n    local_tid_79113 = get_local_id(0);\n    tblock_sizze_79116 = get_local_size(0);\n    wave_sizze_79115 = LOCKSTEP_WIDTH;\n    block_id_79114 = get_tblock_id(0);\n    global_tid_79112 = block_id_79114 * tblock_sizze_79116 + local_tid_79113;\n    phys_tid_73345 = sext_i32_i64(global_tid_79112);\n    chunk_sizze_32b_79117 = sext_i64_i32(chunk_sizze_79061);\n    byte_offsets_79118 = segscan_tblock_sizze_73340 * (int64_t) 8;\n    warp_byte_offset_79119 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79120 = (__local unsigned char *) local_mem_79120_backing_0;\n    trans_arr_len_79121 = chunk_sizze_79061 * segscan_tblock_sizze_73340;\n    phys_block_id_79127 = get_tblock_id(0);\n    virtloop_bound_79128 = sdiv_up64(num_virt_blocks_79062 - phys_block_id_79127, num_tblocks_73342);\n    for (int64_t virtloop_i_79129 = 0; virtloop_i_79129 < virtloop_bound_79128; virtloop_i_79129++) {\n        int64_t dynamic_id_79130;\n        int64_t block_offset_79131;\n        int64_t sgm_idx_79132;\n        int32_t boundary_79133;\n        int32_t segsizze_compact_79134;\n        int64_t private_mem_79135[chunk_sizze_79061];\n        int64_t thd_offset_79137;\n        int64_t acc_79153;\n        int64_t prefix_79163;\n        bool block_new_sgm_79164;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79113 == 0) {\n                dynamic_id_79130 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79090)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79120)[(i", "nt64_t) 0] = dynamic_id_79130;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79130 == num_virt_blocks_79062 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79090)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79130 = ((__local int32_t *) local_mem_79120)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79131 = dynamic_id_79130 * chunk_sizze_79061 * segscan_tblock_sizze_73340;\n        sgm_idx_79132 = smod64(block_offset_79131, nR_49324);\n        boundary_79133 = sext_i64_i32(smin64(chunk_sizze_79061 * segscan_tblock_sizze_73340, nR_49324 - sgm_idx_79132));\n        segsizze_compact_79134 = sext_i64_i32(smin64(chunk_sizze_79061 * segscan_tblock_sizze_73340, nR_49324));\n        thd_offset_79137 = block_offset_79131 + sext_i32_i64(local_tid_79113);\n        // Load and map\n        {\n            for (int64_t i_79138 = 0; i_79138 < chunk_sizze_79061; i_79138++) {\n                int64_t virt_tid_79139 = thd_offset_79137 + i_79138 * segscan_tblock_sizze_73340;\n                int64_t slice_79140 = nR_49324;\n                int64_t gtid_73344 = virt_tid_79139;\n                int64_t remnant_79141 = virt_tid_79139 - gtid_73344;\n                \n                if (slt64(virt_tid_79139, nR_49324)) {\n                    int64_t eta_p_68120 = ((__global int64_t *) ext_mem_78096)[gtid_73344];\n                    bool lifted_lambda_res_68121 = slt64((int64_t) 0, eta_p_68120);\n                    int64_t defunc_0_f_res_68122 = btoi_bool_i64(lifted_lambda_res_68121);\n                    \n                    ((__global int64_t *) mem_78101)[gtid_73344] = defunc_0_f_res_68122;\n                    private_mem_79135[i_79138] = defunc_0_f_res_68122;\n                } else {\n                    private_mem_79135[i_79138] = (int64_t) 0;\n  ",
                                    "              }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79142 = 0; i_79142 < chunk_sizze_79061; i_79142++) {\n                int64_t sharedIdx_79143 = sext_i32_i64(local_tid_79113) + i_79142 * segscan_tblock_sizze_73340;\n                int64_t tmp_79144 = private_mem_79135[i_79142];\n                \n                ((__local int64_t *) local_mem_79120)[sharedIdx_79143] = tmp_79144;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79145 = 0; i_79145 < chunk_sizze_79061; i_79145++) {\n                int64_t sharedIdx_79146 = sext_i32_i64(local_tid_79113) * chunk_sizze_79061 + i_79145;\n                int64_t tmp_79147 = ((__local int64_t *) local_mem_79120)[sharedIdx_79146];\n                \n                private_mem_79135[i_79145] = tmp_79147;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79148 = 0; i_79148 < chunk_sizze_79061 - (int64_t) 1; i_79148++) {\n                int64_t eta_p_67831;\n                int64_t eta_p_67832;\n                \n                eta_p_67831 = private_mem_79135[i_79148];\n                eta_p_67832 = private_mem_79135[i_79148 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_67833 = add64(eta_p_67831, eta_p_67832);\n                \n                private_mem_79135[i_79148 + (int64_t) 1] = defunc_0_op_res_67833;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79149 = private_mem_79135[chunk_sizze_79061 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = tmp_79149;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79150;\n            int64_t eta_p_79151;\n            int64_t eta_p_79154;\n            int64_t eta_p_79155;", "\n            bool ltid_in_bounds_79157 = slt64(sext_i32_i64(local_tid_79113), num_virt_threads_79063);\n            int32_t skip_threads_79158;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79157) {\n                    eta_p_79151 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                    if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                        eta_p_79150 = eta_p_79151;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79158 = 1;\n                while (slt32(skip_threads_79158, 32)) {\n                    bool thread_active_79159 = sle32(skip_threads_79158, local_tid_79113 - squot32(local_tid_79113, 32) * 32) && ltid_in_bounds_79157;\n                    \n                    if (thread_active_79159) {\n                        // read operands\n                        {\n                            eta_p_79150 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79158)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79159) {\n                            int64_t defunc_0_op_res_79152 = add64(eta_p_79150, eta_p_79151);\n                            \n                            eta_p_79150 = defunc_0_op_res_79152;\n                        }\n                    }\n                    if (sle32(wave_sizze_79115, skip_threads_79158)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79159) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79150;\n                            eta_p_79151 = eta_p_", "79150;\n                        }\n                    }\n                    if (sle32(wave_sizze_79115, skip_threads_79158)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79158 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 31 && ltid_in_bounds_79157) {\n                    ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(squot32(local_tid_79113, 32))] = eta_p_79150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79160;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157) {\n                        eta_p_79155 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                        if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                            eta_p_79154 = eta_p_79155;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79160 = 1;\n                    while (slt32(skip_threads_79160, 32)) {\n                        bool thread_active_79161 = sle32(skip_threads_79160, local_tid_79113 - squot32(local_tid_79113, 32) * 32) && (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157);\n                        \n                        if (thread_active_79161) {\n                            // read operands\n                            {\n                                eta_p_79154 = ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(l",
                                    "ocal_tid_79113) - sext_i32_i64(skip_threads_79160)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79161) {\n                                int64_t defunc_0_op_res_79156 = add64(eta_p_79154, eta_p_79155);\n                                \n                                eta_p_79154 = defunc_0_op_res_79156;\n                            }\n                        }\n                        if (sle32(wave_sizze_79115, skip_threads_79160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79161) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79154;\n                                eta_p_79155 = eta_p_79154;\n                            }\n                        }\n                        if (sle32(wave_sizze_79115, skip_threads_79160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79160 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79162 = squot32(local_tid_79113, 32) == 0 || !ltid_in_bounds_79157;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79162) {\n                        eta_p_79151 = eta_p_79150;\n                        eta_p_79150 = ((__local int64_t *) local_mem_79120)[sext_i32_i64(squot32(local_tid_79113, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79162) {\n                        int64_t defunc_0_op_res_79152 = add64(et", "a_p_79150, eta_p_79151);\n                        \n                        eta_p_79150 = defunc_0_op_res_79152;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79162) {\n                        ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79150;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79113, 32) == 0 && ltid_in_bounds_79157) {\n                    ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = eta_p_79151;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79113 == 0) {\n                acc_79153 = ((__local int64_t *) local_mem_79120)[segscan_tblock_sizze_73340 - (int64_t) 1];\n            } else {\n                acc_79153 = ((__local int64_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79163 = (int64_t) 0;\n        block_new_sgm_79164 = sgm_idx_79132 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79164 && local_tid_79113 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79088)[dynamic_id_79130] = acc_79153;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79064)[dynamic_id_79130] = (int8_t) 2;\n                acc_79153 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79164 && slt32(local_tid_79113, wave_sizze_79115)) {\n                if (local_tid_79113 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79086)[dynamic_id_79130] = acc_79153;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_", "mem_79064)[dynamic_id_79130] = (int8_t) 1;\n                    \n                    int8_t tmp_79165 = ((volatile __global int8_t *) status_flags_mem_79064)[dynamic_id_79130 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79120)[(int64_t) 0] = tmp_79165;\n                }\n                mem_fence_local();\n                \n                int8_t status_79166 = ((__local int8_t *) local_mem_79120)[(int64_t) 0];\n                \n                if (status_79166 == (int8_t) 2) {\n                    if (local_tid_79113 == 0) {\n                        prefix_79163 = ((volatile __global int64_t *) incprefixes_mem_79088)[dynamic_id_79130 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79167 = sext_i64_i32(dynamic_id_79130 - sext_i32_i64(wave_sizze_79115));\n                    \n                    while (slt32(wave_sizze_79115 * -1, readOffset_79167)) {\n                        int32_t read_i_79168 = readOffset_79167 + local_tid_79113;\n                        int64_t aggr_79169 = (int64_t) 0;\n                        int8_t flag_79170 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79168)) {\n                            flag_79170 = ((volatile __global int8_t *) status_flags_mem_79064)[sext_i32_i64(read_i_79168)];\n                            if (flag_79170 == (int8_t) 2) {\n                                aggr_79169 = ((volatile __global int64_t *) incprefixes_mem_79088)[sext_i32_i64(read_i_79168)];\n                            } else if (flag_79170 == (int8_t) 1) {\n                                aggr_79169 = ((volatile __global int64_t *) aggregates_mem_79086)[sext_i32_i64(read_i_79168)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)] = aggr_79169;\n                        ((__local int8_t *) local_mem_79120)[sext_i32_i64(local_t",
                                    "id_79113)] = flag_79170;\n                        flag_79170 = ((__local int8_t *) local_mem_79120)[sext_i32_i64(wave_sizze_79115) - (int64_t) 1];\n                        if (slt8(flag_79170, (int8_t) 2)) {\n                            int8_t flg_x_79174;\n                            int8_t flg_y_79175;\n                            int64_t eta_p_79171;\n                            int64_t eta_p_79172;\n                            int32_t skip_threads_79176;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79175 = ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)];\n                                eta_p_79172 = ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)];\n                                if ((local_tid_79113 - squot32(local_tid_79113, 32) * 32) == 0) {\n                                    eta_p_79171 = eta_p_79172;\n                                    flg_x_79174 = flg_y_79175;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79176 = 1;\n                                while (slt32(skip_threads_79176, 32)) {\n                                    if (sle32(skip_threads_79176, local_tid_79113 - squot32(local_tid_79113, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79174 = ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79176)];\n                                            eta_p_79171 = ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + (sext_i32_i64(local_tid_79113) - sext_i32_i64(skip_threads_79176))];\n                                        }\n                  ", "                      // perform operation\n                                        {\n                                            if (flg_y_79175 == (int8_t) 2 || flg_y_79175 == (int8_t) 0) {\n                                                flg_x_79174 = flg_y_79175;\n                                                eta_p_79171 = eta_p_79172;\n                                            } else {\n                                                int64_t defunc_0_op_res_79173 = add64(eta_p_79171, eta_p_79172);\n                                                \n                                                eta_p_79171 = defunc_0_op_res_79173;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79120)[sext_i32_i64(local_tid_79113)] = flg_x_79174;\n                                            flg_y_79175 = flg_x_79174;\n                                            ((volatile __local int64_t *) local_mem_79120)[(int64_t) 4 + sext_i32_i64(local_tid_79113)] = eta_p_79171;\n                                            eta_p_79172 = eta_p_79171;\n                                        }\n                                    }\n                                    skip_threads_79176 *= 2;\n                                }\n                            }\n                        }\n                        flag_79170 = ((__local int8_t *) local_mem_79120)[sext_i32_i64(wave_sizze_79115) - (int64_t) 1];\n                        aggr_79169 = ((__local int64_t *) local_mem_79120)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79115) - (int64_t) 1)];\n                        if (flag_79170 == (int8_t) 2) {\n                            readOffset_79167 = wave_sizze_79115 * -1;\n                        } else if (flag_79170 == (int8_t) 1) {\n                            readOffset_79167 -= wave_sizze_79115;", "\n                        }\n                        if (slt8((int8_t) 0, flag_79170)) {\n                            int64_t eta_p_79177 = aggr_79169;\n                            int64_t eta_p_79178 = prefix_79163;\n                            int64_t defunc_0_op_res_79179 = add64(eta_p_79177, eta_p_79178);\n                            \n                            prefix_79163 = defunc_0_op_res_79179;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79113 == 0) {\n                    if (boundary_79133 == sext_i64_i32(segscan_tblock_sizze_73340 * chunk_sizze_79061)) {\n                        int64_t eta_p_79180 = prefix_79163;\n                        int64_t eta_p_79181 = acc_79153;\n                        int64_t defunc_0_op_res_79182 = add64(eta_p_79180, eta_p_79181);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79088)[dynamic_id_79130] = defunc_0_op_res_79182;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79064)[dynamic_id_79130] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79120)[(int64_t) 4] = prefix_79163;\n                    acc_79153 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79130 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79163 = ((__local int64_t *) local_mem_79120)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79183;\n            int64_t eta_p_79184;\n            int64_t eta_p_79186 = prefix_79163;\n            int64_t eta_p_79187 = acc_79153;\n            \n            if (slt32(local_tid_79113 * chunk_sizze_32b_79117, boundary_79133) && !block_new_sgm_79164) {\n                int64_t defunc_0_op_res_79188 = add64(eta_p_79186, eta_p_7918",
                                    "7);\n                \n                eta_p_79183 = defunc_0_op_res_79188;\n            } else {\n                eta_p_79183 = acc_79153;\n            }\n            \n            int32_t stopping_point_79189 = segsizze_compact_79134 - srem32(local_tid_79113 * chunk_sizze_32b_79117 - 1 + segsizze_compact_79134 - boundary_79133, segsizze_compact_79134);\n            \n            for (int64_t i_79190 = 0; i_79190 < chunk_sizze_79061; i_79190++) {\n                if (slt32(sext_i64_i32(i_79190), stopping_point_79189 - 1)) {\n                    eta_p_79184 = private_mem_79135[i_79190];\n                    \n                    int64_t defunc_0_op_res_79185 = add64(eta_p_79183, eta_p_79184);\n                    \n                    private_mem_79135[i_79190] = defunc_0_op_res_79185;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79191 = 0; i_79191 < chunk_sizze_79061; i_79191++) {\n                int64_t sharedIdx_79192 = sext_i32_i64(local_tid_79113) * chunk_sizze_79061 + i_79191;\n                int64_t tmp_79193 = private_mem_79135[i_79191];\n                \n                ((__local int64_t *) local_mem_79120)[sharedIdx_79192] = tmp_79193;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79194 = 0; i_79194 < chunk_sizze_79061; i_79194++) {\n                int64_t flat_idx_79195 = thd_offset_79137 + i_79194 * segscan_tblock_sizze_73340;\n                int64_t slice_79196 = nR_49324;\n                int64_t gtid_73344 = flat_idx_79195;\n                int64_t remnant_79197 = flat_idx_79195 - gtid_73344;\n                \n                if (slt64(flat_idx_79195, nR_49324)) {\n                    int64_t tmp_79198 = ((__local int64_t *) local_mem_79120)[flat_idx_79195 - block_offset_79131];\n                    \n                    ((__global int64_t *) mem_78099)[gtid_73344] = tmp_79198;\n                }\n            }\n           ", " barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_73340\n    #undef chunk_sizze_79061\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegscan_73361_dim1, 1, 1)\nvoid inner_SMJ_longzisegscan_73361(__global int *global_failure, int64_t m_67844, int64_t num_tblocks_73358, int64_t num_virt_blocks_79219, int64_t num_virt_threads_79220, __global unsigned char *mem_78103, __global unsigned char *mem_78113, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *status_flags_mem_79221, __global unsigned char *aggregates_mem_79223, __global unsigned char *incprefixes_mem_79225, __global unsigned char *aggregates_mem_79227, __global unsigned char *incprefixes_mem_79229, __global unsigned char *global_dynid_mem_79231)\n{\n    #define segscan_tblock_sizze_73356 (inner_SMJ_longzisegscan_73361zisegscan_tblock_sizze_73356)\n    #define chunk_sizze_79218 (inner_SMJ_longzisegscan_73361zichunk_sizze_79218)\n    \n    volatile __local unsigned char *local_mem_79243_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79243_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73356, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73356), smax64(chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73356, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73356), smax64(chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79234;\n    int32_t tblock_sizze_79237;\n    int32_t wave_sizze_79236;\n    int32_t block_id_79235;\n    int32_t global_tid_79233;\n    int64_t phys_tid_73361;\n    int32_t", " chunk_sizze_32b_79238;\n    int64_t byte_offsets_79239;\n    int64_t byte_offsets_79240;\n    int64_t warp_byte_offset_79241;\n    int64_t warp_byte_offset_79242;\n    __local unsigned char *local_mem_79243;\n    int64_t trans_arr_len_79244;\n    int64_t phys_block_id_79253;\n    int64_t virtloop_bound_79254;\n    \n    local_tid_79234 = get_local_id(0);\n    tblock_sizze_79237 = get_local_size(0);\n    wave_sizze_79236 = LOCKSTEP_WIDTH;\n    block_id_79235 = get_tblock_id(0);\n    global_tid_79233 = block_id_79235 * tblock_sizze_79237 + local_tid_79234;\n    phys_tid_73361 = sext_i32_i64(global_tid_79233);\n    chunk_sizze_32b_79238 = sext_i64_i32(chunk_sizze_79218);\n    byte_offsets_79239 = segscan_tblock_sizze_73356 * (int64_t) 8;\n    byte_offsets_79240 = sdiv_up64(byte_offsets_79239, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_73356 * (int64_t) 8;\n    warp_byte_offset_79241 = (int64_t) 288;\n    warp_byte_offset_79242 = sdiv_up64(warp_byte_offset_79241, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79243 = (__local unsigned char *) local_mem_79243_backing_0;\n    trans_arr_len_79244 = chunk_sizze_79218 * segscan_tblock_sizze_73356;\n    phys_block_id_79253 = get_tblock_id(0);\n    virtloop_bound_79254 = sdiv_up64(num_virt_blocks_79219 - phys_block_id_79253, num_tblocks_73358);\n    for (int64_t virtloop_i_79255 = 0; virtloop_i_79255 < virtloop_bound_79254; virtloop_i_79255++) {\n        int64_t dynamic_id_79256;\n        int64_t block_offset_79257;\n        int64_t sgm_idx_79258;\n        int32_t boundary_79259;\n        int32_t segsizze_compact_79260;\n        int64_t private_mem_79261[chunk_sizze_79218];\n        int64_t private_mem_79263[chunk_sizze_79218];\n        int64_t thd_offset_79265;\n        int64_t acc_79291;\n        int64_t acc_79292;\n        int64_t prefix_79305;\n        int64_t prefix_79306;\n        bool block_new_sgm_79307;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n   ",
                                    "         if (local_tid_79234 == 0) {\n                dynamic_id_79256 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79231)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79243)[(int64_t) 0] = dynamic_id_79256;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79256 == num_virt_blocks_79219 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79231)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79256 = ((__local int32_t *) local_mem_79243)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79257 = dynamic_id_79256 * chunk_sizze_79218 * segscan_tblock_sizze_73356;\n        sgm_idx_79258 = smod64(block_offset_79257, m_67844);\n        boundary_79259 = sext_i64_i32(smin64(chunk_sizze_79218 * segscan_tblock_sizze_73356, m_67844 - sgm_idx_79258));\n        segsizze_compact_79260 = sext_i64_i32(smin64(chunk_sizze_79218 * segscan_tblock_sizze_73356, m_67844));\n        thd_offset_79265 = block_offset_79257 + sext_i32_i64(local_tid_79234);\n        // Load and map\n        {\n            for (int64_t i_79266 = 0; i_79266 < chunk_sizze_79218; i_79266++) {\n                int64_t virt_tid_79267 = thd_offset_79265 + i_79266 * segscan_tblock_sizze_73356;\n                int64_t slice_79268 = m_67844;\n                int64_t gtid_73360 = virt_tid_79267;\n                int64_t remnant_79269 = virt_tid_79267 - gtid_73360;\n                \n                if (slt64(virt_tid_79267, m_67844)) {\n                    int64_t x_68125 = ((__global int64_t *) mem_78103)[gtid_73360];\n                    bool lifted_lambda_res_68127 = slt64((int64_t) 1, x_68125);\n                    int64_t defunc_0_f_res_68128 = btoi_bool_i64(lifted_lambda_re", "s_68127);\n                    \n                    ((__global int64_t *) mem_78117)[gtid_73360] = defunc_0_f_res_68128;\n                    private_mem_79261[i_79266] = x_68125;\n                    private_mem_79263[i_79266] = defunc_0_f_res_68128;\n                } else {\n                    private_mem_79261[i_79266] = (int64_t) 0;\n                    private_mem_79263[i_79266] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79270 = 0; i_79270 < chunk_sizze_79218; i_79270++) {\n                int64_t sharedIdx_79271 = sext_i32_i64(local_tid_79234) + i_79270 * segscan_tblock_sizze_73356;\n                int64_t tmp_79272 = private_mem_79261[i_79270];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79271] = tmp_79272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79273 = 0; i_79273 < chunk_sizze_79218; i_79273++) {\n                int64_t sharedIdx_79274 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79273;\n                int64_t tmp_79275 = ((__local int64_t *) local_mem_79243)[sharedIdx_79274];\n                \n                private_mem_79261[i_79273] = tmp_79275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79276 = 0; i_79276 < chunk_sizze_79218; i_79276++) {\n                int64_t sharedIdx_79277 = sext_i32_i64(local_tid_79234) + i_79276 * segscan_tblock_sizze_73356;\n                int64_t tmp_79278 = private_mem_79263[i_79276];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79277] = tmp_79278;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79279 = 0; i_79279 < chunk_sizze_79218; i_79279++) {\n                int64_t sharedIdx_79280 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79279;\n                int64_t tmp_79281 = ((__local int64_t *) local_mem", "_79243)[sharedIdx_79280];\n                \n                private_mem_79263[i_79279] = tmp_79281;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79282 = 0; i_79282 < chunk_sizze_79218 - (int64_t) 1; i_79282++) {\n                int64_t eta_p_67881;\n                int64_t eta_p_67882;\n                \n                eta_p_67881 = private_mem_79261[i_79282];\n                eta_p_67882 = private_mem_79261[i_79282 + (int64_t) 1];\n                \n                int64_t eta_p_67974;\n                int64_t eta_p_67975;\n                \n                eta_p_67974 = private_mem_79263[i_79282];\n                eta_p_67975 = private_mem_79263[i_79282 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_67883 = add64(eta_p_67881, eta_p_67882);\n                int64_t defunc_0_op_res_67976 = add64(eta_p_67974, eta_p_67975);\n                \n                private_mem_79261[i_79282 + (int64_t) 1] = lifted_lambda_res_67883;\n                private_mem_79263[i_79282 + (int64_t) 1] = defunc_0_op_res_67976;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79283 = private_mem_79261[chunk_sizze_79218 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = tmp_79283;\n            \n            int64_t tmp_79284 = private_mem_79263[chunk_sizze_79218 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = tmp_79284;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79285;\n            int64_t eta_p_79286;\n            int64_t eta_p_79287;\n            int64_t eta_p_79288;\n            int64_t eta_p_79293;\n            int64_t eta_p_79294;\n            int64_t eta_p_79295;\n            int64_t eta_p_79296",
                                    ";\n            bool ltid_in_bounds_79299 = slt64(sext_i32_i64(local_tid_79234), num_virt_threads_79220);\n            int32_t skip_threads_79300;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79299) {\n                    eta_p_79287 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                    eta_p_79288 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                    if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                        eta_p_79285 = eta_p_79287;\n                        eta_p_79286 = eta_p_79288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79300 = 1;\n                while (slt32(skip_threads_79300, 32)) {\n                    bool thread_active_79301 = sle32(skip_threads_79300, local_tid_79234 - squot32(local_tid_79234, 32) * 32) && ltid_in_bounds_79299;\n                    \n                    if (thread_active_79301) {\n                        // read operands\n                        {\n                            eta_p_79285 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79300)];\n                            eta_p_79286 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79300))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79301) {\n                            int64_t lifted_lambda_res_79289 = add64(eta_p_79285, eta_p_79287);\n                            int64_t defunc_0_op_res_79290 = add64(eta_p_79286, eta_p_79288);\n                            \n                            eta_p_7928", "5 = lifted_lambda_res_79289;\n                            eta_p_79286 = defunc_0_op_res_79290;\n                        }\n                    }\n                    if (sle32(wave_sizze_79236, skip_threads_79300)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79301) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79285;\n                            eta_p_79287 = eta_p_79285;\n                            ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79286;\n                            eta_p_79288 = eta_p_79286;\n                        }\n                    }\n                    if (sle32(wave_sizze_79236, skip_threads_79300)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79300 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 31 && ltid_in_bounds_79299) {\n                    ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(squot32(local_tid_79234, 32))] = eta_p_79285;\n                    ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(squot32(local_tid_79234, 32))] = eta_p_79286;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79302;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299) {\n       ", "                 eta_p_79295 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                        eta_p_79296 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                        if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                            eta_p_79293 = eta_p_79295;\n                            eta_p_79294 = eta_p_79296;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79302 = 1;\n                    while (slt32(skip_threads_79302, 32)) {\n                        bool thread_active_79303 = sle32(skip_threads_79302, local_tid_79234 - squot32(local_tid_79234, 32) * 32) && (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299);\n                        \n                        if (thread_active_79303) {\n                            // read operands\n                            {\n                                eta_p_79293 = ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79302)];\n                                eta_p_79294 = ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79302))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79303) {\n                                int64_t lifted_lambda_res_79297 = add64(eta_p_79293, eta_p_79295);\n                                int64_t defunc_0_op_res_79298 = add64(eta_p_79294, eta_p_79296);\n                                \n                                eta_p_79293 = lifted_lambda_res_79297;\n                                eta_p_79294 = defunc_0_op_res_79298;\n                 ",
                                    "           }\n                        }\n                        if (sle32(wave_sizze_79236, skip_threads_79302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79303) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79293;\n                                eta_p_79295 = eta_p_79293;\n                                ((volatile __local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79294;\n                                eta_p_79296 = eta_p_79294;\n                            }\n                        }\n                        if (sle32(wave_sizze_79236, skip_threads_79302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79302 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79304 = squot32(local_tid_79234, 32) == 0 || !ltid_in_bounds_79299;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79304) {\n                        eta_p_79287 = eta_p_79285;\n                        eta_p_79288 = eta_p_79286;\n                        eta_p_79285 = ((__local int64_t *) local_mem_79243)[sext_i32_i64(squot32(local_tid_79234, 32)) - (int64_t) 1];\n                        eta_p_79286 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_79234, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79304) {\n                        int64_t lifted_lambda_res_79289 =", " add64(eta_p_79285, eta_p_79287);\n                        int64_t defunc_0_op_res_79290 = add64(eta_p_79286, eta_p_79288);\n                        \n                        eta_p_79285 = lifted_lambda_res_79289;\n                        eta_p_79286 = defunc_0_op_res_79290;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79304) {\n                        ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79285;\n                        ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79286;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79234, 32) == 0 && ltid_in_bounds_79299) {\n                    ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = eta_p_79287;\n                    ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79234 == 0) {\n                acc_79291 = ((__local int64_t *) local_mem_79243)[segscan_tblock_sizze_73356 - (int64_t) 1];\n                acc_79292 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (segscan_tblock_sizze_73356 - (int64_t) 1)];\n            } else {\n                acc_79291 = ((__local int64_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - (int64_t) 1];\n                acc_79292 = ((__local int64_t *) local_mem_79243)[squot64(byte_offsets_79239, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79305 = (int64_t) 0;\n        prefix_79306", " = (int64_t) 0;\n        block_new_sgm_79307 = sgm_idx_79258 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79307 && local_tid_79234 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256] = acc_79291;\n                ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256] = acc_79292;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 2;\n                acc_79291 = (int64_t) 0;\n                acc_79292 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79307 && slt32(local_tid_79234, wave_sizze_79236)) {\n                if (local_tid_79234 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79223)[dynamic_id_79256] = acc_79291;\n                    ((volatile __global int64_t *) aggregates_mem_79227)[dynamic_id_79256] = acc_79292;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 1;\n                    \n                    int8_t tmp_79308 = ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79243)[(int64_t) 0] = tmp_79308;\n                }\n                mem_fence_local();\n                \n                int8_t status_79309 = ((__local int8_t *) local_mem_79243)[(int64_t) 0];\n                \n                if (status_79309 == (int8_t) 2) {\n                    if (local_tid_79234 == 0) {\n                        prefix_79305 = ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256 - (int64_t) 1];\n                        prefix_79306 = ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79310 = sext_i64_i32(dynamic_id_7",
                                    "9256 - sext_i32_i64(wave_sizze_79236));\n                    \n                    while (slt32(wave_sizze_79236 * -1, readOffset_79310)) {\n                        int32_t read_i_79311 = readOffset_79310 + local_tid_79234;\n                        int64_t aggr_79312 = (int64_t) 0;\n                        int64_t aggr_79313 = (int64_t) 0;\n                        int8_t flag_79314 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79311)) {\n                            flag_79314 = ((volatile __global int8_t *) status_flags_mem_79221)[sext_i32_i64(read_i_79311)];\n                            if (flag_79314 == (int8_t) 2) {\n                                aggr_79312 = ((volatile __global int64_t *) incprefixes_mem_79225)[sext_i32_i64(read_i_79311)];\n                                aggr_79313 = ((volatile __global int64_t *) incprefixes_mem_79229)[sext_i32_i64(read_i_79311)];\n                            } else if (flag_79314 == (int8_t) 1) {\n                                aggr_79312 = ((volatile __global int64_t *) aggregates_mem_79223)[sext_i32_i64(read_i_79311)];\n                                aggr_79313 = ((volatile __global int64_t *) aggregates_mem_79227)[sext_i32_i64(read_i_79311)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)] = aggr_79312;\n                        ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = aggr_79313;\n                        ((__local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = flag_79314;\n                        flag_79314 = ((__local int8_t *) local_mem_79243)[sext_i32_i64(wave_sizze_79236) - (int64_t) 1];\n                        if (slt8(flag_79314, (int8_t) 2)) {\n                            int8_t flg_x_79321;\n                            int8_t flg_y_79322;\n                            int64_t eta_p_79315;\n    ", "                        int64_t eta_p_79316;\n                            int64_t eta_p_79317;\n                            int64_t eta_p_79318;\n                            int32_t skip_threads_79323;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79322 = ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)];\n                                eta_p_79317 = ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)];\n                                eta_p_79318 = ((volatile __local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)];\n                                if ((local_tid_79234 - squot32(local_tid_79234, 32) * 32) == 0) {\n                                    eta_p_79315 = eta_p_79317;\n                                    eta_p_79316 = eta_p_79318;\n                                    flg_x_79321 = flg_y_79322;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79323 = 1;\n                                while (slt32(skip_threads_79323, 32)) {\n                                    if (sle32(skip_threads_79323, local_tid_79234 - squot32(local_tid_79234, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79321 = ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323)];\n                                            eta_p_79315 = ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323))];\n                                            eta_p_79316 = ((volatile __local int64", "_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + (sext_i32_i64(local_tid_79234) - sext_i32_i64(skip_threads_79323))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79322 == (int8_t) 2 || flg_y_79322 == (int8_t) 0) {\n                                                flg_x_79321 = flg_y_79322;\n                                                eta_p_79315 = eta_p_79317;\n                                                eta_p_79316 = eta_p_79318;\n                                            } else {\n                                                int64_t lifted_lambda_res_79319 = add64(eta_p_79315, eta_p_79317);\n                                                int64_t defunc_0_op_res_79320 = add64(eta_p_79316, eta_p_79318);\n                                                \n                                                eta_p_79315 = lifted_lambda_res_79319;\n                                                eta_p_79316 = defunc_0_op_res_79320;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79243)[sext_i32_i64(local_tid_79234)] = flg_x_79321;\n                                            flg_y_79322 = flg_x_79321;\n                                            ((volatile __local int64_t *) local_mem_79243)[(int64_t) 4 + sext_i32_i64(local_tid_79234)] = eta_p_79315;\n                                            eta_p_79317 = eta_p_79315;\n                                            ((volatile __local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + sext_i32_i64(local_tid_79234)] = eta_p_79316;\n                                            eta_p_79318 = eta_p_79316;\n             ",
                                    "                           }\n                                    }\n                                    skip_threads_79323 *= 2;\n                                }\n                            }\n                        }\n                        flag_79314 = ((__local int8_t *) local_mem_79243)[sext_i32_i64(wave_sizze_79236) - (int64_t) 1];\n                        aggr_79312 = ((__local int64_t *) local_mem_79243)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79236) - (int64_t) 1)];\n                        aggr_79313 = ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8) + (sext_i32_i64(wave_sizze_79236) - (int64_t) 1)];\n                        if (flag_79314 == (int8_t) 2) {\n                            readOffset_79310 = wave_sizze_79236 * -1;\n                        } else if (flag_79314 == (int8_t) 1) {\n                            readOffset_79310 -= wave_sizze_79236;\n                        }\n                        if (slt8((int8_t) 0, flag_79314)) {\n                            int64_t eta_p_79324 = aggr_79312;\n                            int64_t eta_p_79325 = aggr_79313;\n                            int64_t eta_p_79326 = prefix_79305;\n                            int64_t eta_p_79327 = prefix_79306;\n                            int64_t lifted_lambda_res_79328 = add64(eta_p_79324, eta_p_79326);\n                            int64_t defunc_0_op_res_79329 = add64(eta_p_79325, eta_p_79327);\n                            \n                            prefix_79305 = lifted_lambda_res_79328;\n                            prefix_79306 = defunc_0_op_res_79329;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79234 == 0) {\n                    if (boundary_79259 == sext_i64_i32(segscan_tblock_sizze_73356 * chunk_sizze_79218)) {\n                        int64_t eta_p_79330 = prefix_79305;\n                        int64_t eta_p_79331 = prefix_79306;\n                        int64", "_t eta_p_79332 = acc_79291;\n                        int64_t eta_p_79333 = acc_79292;\n                        int64_t lifted_lambda_res_79334 = add64(eta_p_79330, eta_p_79332);\n                        int64_t defunc_0_op_res_79335 = add64(eta_p_79331, eta_p_79333);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79225)[dynamic_id_79256] = lifted_lambda_res_79334;\n                        ((volatile __global int64_t *) incprefixes_mem_79229)[dynamic_id_79256] = defunc_0_op_res_79335;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79221)[dynamic_id_79256] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79243)[(int64_t) 4] = prefix_79305;\n                    ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8)] = prefix_79306;\n                    acc_79291 = (int64_t) 0;\n                    acc_79292 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79256 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79305 = ((__local int64_t *) local_mem_79243)[(int64_t) 4];\n                prefix_79306 = ((__local int64_t *) local_mem_79243)[squot64(warp_byte_offset_79241, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79336;\n            int64_t eta_p_79338;\n            int64_t eta_p_79342 = prefix_79305;\n            int64_t eta_p_79344 = acc_79291;\n            int64_t eta_p_79337;\n            int64_t eta_p_79339;\n            int64_t eta_p_79343 = prefix_79306;\n            int64_t eta_p_79345 = acc_79292;\n            \n            if (slt32(local_tid_79234 * chunk_sizze_32b_79238, boundary_79259) && !block_new_sgm_79307) {\n                int64_t lifted_lambda_res_79346 = add64(eta_p_79342, eta_p_79344);\n                int64_t defunc_0", "_op_res_79347 = add64(eta_p_79343, eta_p_79345);\n                \n                eta_p_79336 = lifted_lambda_res_79346;\n                eta_p_79337 = defunc_0_op_res_79347;\n            } else {\n                eta_p_79336 = acc_79291;\n                eta_p_79337 = acc_79292;\n            }\n            \n            int32_t stopping_point_79348 = segsizze_compact_79260 - srem32(local_tid_79234 * chunk_sizze_32b_79238 - 1 + segsizze_compact_79260 - boundary_79259, segsizze_compact_79260);\n            \n            for (int64_t i_79349 = 0; i_79349 < chunk_sizze_79218; i_79349++) {\n                if (slt32(sext_i64_i32(i_79349), stopping_point_79348 - 1)) {\n                    eta_p_79338 = private_mem_79261[i_79349];\n                    eta_p_79339 = private_mem_79263[i_79349];\n                    \n                    int64_t lifted_lambda_res_79340 = add64(eta_p_79336, eta_p_79338);\n                    int64_t defunc_0_op_res_79341 = add64(eta_p_79337, eta_p_79339);\n                    \n                    private_mem_79261[i_79349] = lifted_lambda_res_79340;\n                    private_mem_79263[i_79349] = defunc_0_op_res_79341;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79350 = 0; i_79350 < chunk_sizze_79218; i_79350++) {\n                int64_t sharedIdx_79351 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79350;\n                int64_t tmp_79352 = private_mem_79261[i_79350];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79351] = tmp_79352;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79353 = 0; i_79353 < chunk_sizze_79218; i_79353++) {\n                int64_t flat_idx_79354 = thd_offset_79265 + i_79353 * segscan_tblock_sizze_73356;\n                int64_t slice_79355 = m_67844;\n                int64_t gtid_73360 = flat_idx_79354;\n                int64_t remnant_7935",
                                    "6 = flat_idx_79354 - gtid_73360;\n                \n                if (slt64(flat_idx_79354, m_67844)) {\n                    int64_t tmp_79357 = ((__local int64_t *) local_mem_79243)[flat_idx_79354 - block_offset_79257];\n                    \n                    ((__global int64_t *) mem_78113)[gtid_73360] = tmp_79357;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79358 = 0; i_79358 < chunk_sizze_79218; i_79358++) {\n                int64_t sharedIdx_79359 = sext_i32_i64(local_tid_79234) * chunk_sizze_79218 + i_79358;\n                int64_t tmp_79360 = private_mem_79263[i_79358];\n                \n                ((__local int64_t *) local_mem_79243)[sharedIdx_79359] = tmp_79360;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79361 = 0; i_79361 < chunk_sizze_79218; i_79361++) {\n                int64_t flat_idx_79362 = thd_offset_79265 + i_79361 * segscan_tblock_sizze_73356;\n                int64_t slice_79363 = m_67844;\n                int64_t gtid_73360 = flat_idx_79362;\n                int64_t remnant_79364 = flat_idx_79362 - gtid_73360;\n                \n                if (slt64(flat_idx_79362, m_67844)) {\n                    int64_t tmp_79365 = ((__local int64_t *) local_mem_79243)[flat_idx_79362 - block_offset_79257];\n                    \n                    ((__global int64_t *) mem_78115)[gtid_73360] = tmp_79365;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_73356\n    #undef chunk_sizze_79218\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78724_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78724(__global int *global_failure, int64_t gt_rhs_66981, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77633)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78726;\n    int32_t tblock_sizze_78729;\n    int32_t wave_sizze_78728;\n    int32_t bloc", "k_id_78727;\n    int32_t global_tid_78725;\n    int64_t tid_78724;\n    int16_t x_77524;\n    \n    local_tid_78726 = get_local_id(0);\n    tblock_sizze_78729 = get_local_size(0);\n    wave_sizze_78728 = LOCKSTEP_WIDTH;\n    block_id_78727 = get_tblock_id(0);\n    global_tid_78725 = block_id_78727 * tblock_sizze_78729 + local_tid_78726;\n    tid_78724 = sext_i32_i64(global_tid_78725);\n    x_77524 = ((__global int16_t *) tR_mem_77625)[gt_rhs_66981];\n    ((__global int16_t *) mem_77633)[(int64_t) 0] = x_77524;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78756_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78756(__global int *global_failure, int64_t tS_start_66998, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77634, __global unsigned char *mem_77641, __global unsigned char *mem_77642)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78758;\n    int32_t tblock_sizze_78761;\n    int32_t wave_sizze_78760;\n    int32_t block_id_78759;\n    int32_t global_tid_78757;\n    int64_t tid_78756;\n    int16_t gt_lhs_77528;\n    int16_t gt_rhs_77530;\n    bool defunc_0_gt_res_77532;\n    \n    local_tid_78758 = get_local_id(0);\n    tblock_sizze_78761 = get_local_size(0);\n    wave_sizze_78760 = LOCKSTEP_WIDTH;\n    block_id_78759 = get_tblock_id(0);\n    global_tid_78757 = block_id_78759 * tblock_sizze_78761 + local_tid_78758;\n    tid_78756 = sext_i32_i64(global_tid_78757);\n    gt_lhs_77528 = ((__global int16_t *) tS_mem_77626)[tS_start_66998];\n    gt_rhs_77530 = ((__global int16_t *) ext_mem_77634)[(int64_t) 0];\n    defunc_0_gt_res_77532 = slt16(gt_rhs_77530, gt_lhs_77528);\n    ((__global int16_t *) mem_77641)[(int64_t) 0] = gt_lhs_77528;\n    ((__global bool *) mem_77642)[(int64_t) 0] = defunc_0_gt_res_77532;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78762_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78762(__global int *global_failure, int64_t i_p_m_t_s_67004, __global unsigned char *tS_mem_77626, __", "global unsigned char *mem_77908)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78764;\n    int32_t tblock_sizze_78767;\n    int32_t wave_sizze_78766;\n    int32_t block_id_78765;\n    int32_t global_tid_78763;\n    int64_t tid_78762;\n    int16_t x_77534;\n    \n    local_tid_78764 = get_local_id(0);\n    tblock_sizze_78767 = get_local_size(0);\n    wave_sizze_78766 = LOCKSTEP_WIDTH;\n    block_id_78765 = get_tblock_id(0);\n    global_tid_78763 = block_id_78765 * tblock_sizze_78767 + local_tid_78764;\n    tid_78762 = sext_i32_i64(global_tid_78763);\n    x_77534 = ((__global int16_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    ((__global int16_t *) mem_77908)[(int64_t) 0] = x_77534;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78778_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78778(__global int *global_failure, int64_t start_68558, int64_t i_p_m_t_s_68564, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77916, __global unsigned char *mem_77917)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78780;\n    int32_t tblock_sizze_78783;\n    int32_t wave_sizze_78782;\n    int32_t block_id_78781;\n    int32_t global_tid_78779;\n    int64_t tid_78778;\n    int16_t r_max_77538;\n    int16_t r_min_77541;\n    \n    local_tid_78780 = get_local_id(0);\n    tblock_sizze_78783 = get_local_size(0);\n    wave_sizze_78782 = LOCKSTEP_WIDTH;\n    block_id_78781 = get_tblock_id(0);\n    global_tid_78779 = block_id_78781 * tblock_sizze_78783 + local_tid_78780;\n    tid_78778 = sext_i32_i64(global_tid_78779);\n    r_max_77538 = ((__global int16_t *) tR_mem_77625)[i_p_m_t_s_68564];\n    r_min_77541 = ((__global int16_t *) tR_mem_77625)[start_68558];\n    ((__global int16_t *) mem_77916)[(int64_t) 0] = r_max_77538;\n    ((__global int16_t *) mem_77917)[(int64_t) 0] = r_min_77541;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78784_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78784(__global int *global_fa",
                                    "ilure, __global unsigned char *mem_77917, __global unsigned char *ext_mem_77918, __global unsigned char *mem_77920)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78786;\n    int32_t tblock_sizze_78789;\n    int32_t wave_sizze_78788;\n    int32_t block_id_78787;\n    int32_t global_tid_78785;\n    int64_t tid_78784;\n    int16_t s_max_77543;\n    int16_t r_min_77544;\n    bool defunc_0_gt_res_77545;\n    \n    local_tid_78786 = get_local_id(0);\n    tblock_sizze_78789 = get_local_size(0);\n    wave_sizze_78788 = LOCKSTEP_WIDTH;\n    block_id_78787 = get_tblock_id(0);\n    global_tid_78785 = block_id_78787 * tblock_sizze_78789 + local_tid_78786;\n    tid_78784 = sext_i32_i64(global_tid_78785);\n    s_max_77543 = ((__global int16_t *) ext_mem_77918)[(int64_t) 0];\n    r_min_77544 = ((__global int16_t *) mem_77917)[(int64_t) 0];\n    defunc_0_gt_res_77545 = slt16(s_max_77543, r_min_77544);\n    ((__global bool *) mem_77920)[(int64_t) 0] = defunc_0_gt_res_77545;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78790_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78790(__global int *global_failure, __global unsigned char *mem_77916, __global unsigned char *ext_mem_77919, __global unsigned char *mem_77921)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78792;\n    int32_t tblock_sizze_78795;\n    int32_t wave_sizze_78794;\n    int32_t block_id_78793;\n    int32_t global_tid_78791;\n    int64_t tid_78790;\n    int16_t r_max_77548;\n    int16_t s_min_77549;\n    bool defunc_0_gt_res_77550;\n    \n    local_tid_78792 = get_local_id(0);\n    tblock_sizze_78795 = get_local_size(0);\n    wave_sizze_78794 = LOCKSTEP_WIDTH;\n    block_id_78793 = get_tblock_id(0);\n    global_tid_78791 = block_id_78793 * tblock_sizze_78795 + local_tid_78792;\n    tid_78790 = sext_i32_i64(global_tid_78791);\n    r_max_77548 = ((__global int16_t *) mem_77916)[(int64_t) 0];\n    s_min_77549 = ((__global int16_t *) ext_mem_77919)[(int64_t) 0];\n    defunc_0_gt_re", "s_77550 = slt16(r_max_77548, s_min_77549);\n    ((__global bool *) mem_77921)[(int64_t) 0] = defunc_0_gt_res_77550;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78849_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78849(__global int *global_failure, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77648)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78851;\n    int32_t tblock_sizze_78854;\n    int32_t wave_sizze_78853;\n    int32_t block_id_78852;\n    int32_t global_tid_78850;\n    int64_t tid_78849;\n    int16_t x_77552;\n    \n    local_tid_78851 = get_local_id(0);\n    tblock_sizze_78854 = get_local_size(0);\n    wave_sizze_78853 = LOCKSTEP_WIDTH;\n    block_id_78852 = get_tblock_id(0);\n    global_tid_78850 = block_id_78852 * tblock_sizze_78854 + local_tid_78851;\n    tid_78849 = sext_i32_i64(global_tid_78850);\n    x_77552 = ((__global int16_t *) tR_mem_77625)[(int64_t) 0];\n    ((__global int16_t *) mem_77648)[(int64_t) 0] = x_77552;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78855_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78855(__global int *global_failure, __global unsigned char *mem_77641, __global unsigned char *ext_mem_77649, __global unsigned char *mem_77650)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78857;\n    int32_t tblock_sizze_78860;\n    int32_t wave_sizze_78859;\n    int32_t block_id_78858;\n    int32_t global_tid_78856;\n    int64_t tid_78855;\n    int16_t leq_lhs_77556;\n    int16_t gt_lhs_77557;\n    bool defunc_0_leq_res_77558;\n    \n    local_tid_78857 = get_local_id(0);\n    tblock_sizze_78860 = get_local_size(0);\n    wave_sizze_78859 = LOCKSTEP_WIDTH;\n    block_id_78858 = get_tblock_id(0);\n    global_tid_78856 = block_id_78858 * tblock_sizze_78860 + local_tid_78857;\n    tid_78855 = sext_i32_i64(global_tid_78856);\n    leq_lhs_77556 = ((__global int16_t *) ext_mem_77649)[(int64_t) 0];\n    gt_lhs_77557 = ((__global int16_t *) mem_77641", ")[(int64_t) 0];\n    defunc_0_leq_res_77558 = sle16(leq_lhs_77556, gt_lhs_77557);\n    ((__global bool *) mem_77650)[(int64_t) 0] = defunc_0_leq_res_77558;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78861_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78861(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_39348, unsigned char y_67146_bits, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77641, __global unsigned char *mem_77650, __global unsigned char *mem_77652)\n{\n    bool y_67146 = y_67146_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78863;\n    int32_t tblock_sizze_78866;\n    int32_t wave_sizze_78865;\n    int32_t block_id_78864;\n    int32_t global_tid_78862;\n    int64_t tid_78861;\n    bool defunc_0_leq_res_77560;\n    int16_t x_77565;\n    \n    local_tid_78863 = get_local_id(0);\n    tblock_sizze_78866 = get_local_size(0);\n    wave_sizze_78865 = LOCKSTEP_WIDTH;\n    block_id_78864 = get_tblock_id(0);\n    global_tid_78862 = block_id_78864 * tblock_sizze_78866 + local_tid_78863;\n    tid_78861 = sext_i32_i64(global_tid_78862);\n    defunc_0_leq_res_77560 = ((__global bool *) mem_77650)[(int64_t) 0];\n    if (defunc_0_leq_res_77560) {\n        bool index_certs_77561;\n        int16_t lowest_t_res_77562;\n        \n        if (!y_67146) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 138) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_39348;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_77562 = ((__global int16_t *) tR_mem_77625)[(int64_t) 0];\n        x_77565 = lowest_t_res_77562;\n    } else {\n        int16_t gt_lhs_77564;\n        bool index_certs_77563;\n        \n        gt_lhs_77564 = ((__global int16_t *) mem_77641)[(int64_t) 0];\n        if (!y_67146) {\n       ",
                                    "     {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 139) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_39348;\n                    ;\n                }\n                return;\n            }\n        }\n        x_77565 = gt_lhs_77564;\n    }\n    ((__global int16_t *) mem_77652)[(int64_t) 0] = x_77565;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78923_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78923(__global int *global_failure, int64_t slice_68069, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77700)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78925;\n    int32_t tblock_sizze_78928;\n    int32_t wave_sizze_78927;\n    int32_t block_id_78926;\n    int32_t global_tid_78924;\n    int64_t tid_78923;\n    int16_t x_77570;\n    \n    local_tid_78925 = get_local_id(0);\n    tblock_sizze_78928 = get_local_size(0);\n    wave_sizze_78927 = LOCKSTEP_WIDTH;\n    block_id_78926 = get_tblock_id(0);\n    global_tid_78924 = block_id_78926 * tblock_sizze_78928 + local_tid_78925;\n    tid_78923 = sext_i32_i64(global_tid_78924);\n    x_77570 = ((__global int16_t *) tS_mem_77626)[slice_68069];\n    ((__global int16_t *) mem_77700)[(int64_t) 0] = x_77570;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78929_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78929(__global int *global_failure, int64_t slice_68867, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77703)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78931;\n    int32_t tblock_sizze_78934;\n    int32_t wave_sizze_78933;\n    int32_t block_id_78932;\n    int32_t global_tid_78930;\n    int64_t tid_78929;\n    int16_t x_77574;\n    \n    local_tid_78931 = get_local_id(0);\n    tblock_sizze_78934 = get_local_size(0);\n    wave_sizze_78933 = LOCKSTEP_WIDTH;\n    block_id_78932 = get_tblock_id(0);\n    global_tid", "_78930 = block_id_78932 * tblock_sizze_78934 + local_tid_78931;\n    tid_78929 = sext_i32_i64(global_tid_78930);\n    x_77574 = ((__global int16_t *) tS_mem_77626)[slice_68867];\n    ((__global int16_t *) mem_77703)[(int64_t) 0] = x_77574;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78945_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78945(__global int *global_failure, int64_t slice_67712, int64_t slice_67721, __global unsigned char *tR_mem_77625, __global unsigned char *mem_77711, __global unsigned char *mem_77712)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78947;\n    int32_t tblock_sizze_78950;\n    int32_t wave_sizze_78949;\n    int32_t block_id_78948;\n    int32_t global_tid_78946;\n    int64_t tid_78945;\n    int16_t r_max_77578;\n    int16_t r_min_77581;\n    \n    local_tid_78947 = get_local_id(0);\n    tblock_sizze_78950 = get_local_size(0);\n    wave_sizze_78949 = LOCKSTEP_WIDTH;\n    block_id_78948 = get_tblock_id(0);\n    global_tid_78946 = block_id_78948 * tblock_sizze_78950 + local_tid_78947;\n    tid_78945 = sext_i32_i64(global_tid_78946);\n    r_max_77578 = ((__global int16_t *) tR_mem_77625)[slice_67721];\n    r_min_77581 = ((__global int16_t *) tR_mem_77625)[slice_67712];\n    ((__global int16_t *) mem_77711)[(int64_t) 0] = r_max_77578;\n    ((__global int16_t *) mem_77712)[(int64_t) 0] = r_min_77581;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78951_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78951(__global int *global_failure, __global unsigned char *mem_77712, __global unsigned char *ext_mem_77713, __global unsigned char *mem_77715)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78953;\n    int32_t tblock_sizze_78956;\n    int32_t wave_sizze_78955;\n    int32_t block_id_78954;\n    int32_t global_tid_78952;\n    int64_t tid_78951;\n    int16_t s_max_77583;\n    int16_t r_min_77584;\n    bool defunc_0_gt_res_77585;\n    \n    local_tid_78953 = get_local_id(0);\n    ", "tblock_sizze_78956 = get_local_size(0);\n    wave_sizze_78955 = LOCKSTEP_WIDTH;\n    block_id_78954 = get_tblock_id(0);\n    global_tid_78952 = block_id_78954 * tblock_sizze_78956 + local_tid_78953;\n    tid_78951 = sext_i32_i64(global_tid_78952);\n    s_max_77583 = ((__global int16_t *) ext_mem_77713)[(int64_t) 0];\n    r_min_77584 = ((__global int16_t *) mem_77712)[(int64_t) 0];\n    defunc_0_gt_res_77585 = slt16(s_max_77583, r_min_77584);\n    ((__global bool *) mem_77715)[(int64_t) 0] = defunc_0_gt_res_77585;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_78957_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_78957(__global int *global_failure, __global unsigned char *mem_77711, __global unsigned char *ext_mem_77714, __global unsigned char *mem_77716)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78959;\n    int32_t tblock_sizze_78962;\n    int32_t wave_sizze_78961;\n    int32_t block_id_78960;\n    int32_t global_tid_78958;\n    int64_t tid_78957;\n    int16_t r_max_77588;\n    int16_t s_min_77589;\n    bool defunc_0_gt_res_77590;\n    \n    local_tid_78959 = get_local_id(0);\n    tblock_sizze_78962 = get_local_size(0);\n    wave_sizze_78961 = LOCKSTEP_WIDTH;\n    block_id_78960 = get_tblock_id(0);\n    global_tid_78958 = block_id_78960 * tblock_sizze_78962 + local_tid_78959;\n    tid_78957 = sext_i32_i64(global_tid_78958);\n    r_max_77588 = ((__global int16_t *) mem_77711)[(int64_t) 0];\n    s_min_77589 = ((__global int16_t *) ext_mem_77714)[(int64_t) 0];\n    defunc_0_gt_res_77590 = slt16(r_max_77588, s_min_77589);\n    ((__global bool *) mem_77716)[(int64_t) 0] = defunc_0_gt_res_77590;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_79070_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_79070(__global int *global_failure, int64_t gt_rhs_66981, int64_t i_p_m_t_s_67004, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_78084)\n{\n    if (*global_failure >= 0)\n        ",
                                    "return;\n    \n    int32_t local_tid_79072;\n    int32_t tblock_sizze_79075;\n    int32_t wave_sizze_79074;\n    int32_t block_id_79073;\n    int32_t global_tid_79071;\n    int64_t tid_79070;\n    int16_t leq_lhs_77592;\n    int16_t leq_rhs_77594;\n    bool defunc_0_leq_res_77598;\n    \n    local_tid_79072 = get_local_id(0);\n    tblock_sizze_79075 = get_local_size(0);\n    wave_sizze_79074 = LOCKSTEP_WIDTH;\n    block_id_79073 = get_tblock_id(0);\n    global_tid_79071 = block_id_79073 * tblock_sizze_79075 + local_tid_79072;\n    tid_79070 = sext_i32_i64(global_tid_79071);\n    leq_lhs_77592 = ((__global int16_t *) tS_mem_77626)[i_p_m_t_s_67004];\n    leq_rhs_77594 = ((__global int16_t *) tR_mem_77625)[gt_rhs_66981];\n    defunc_0_leq_res_77598 = sle16(leq_lhs_77592, leq_rhs_77594);\n    ((__global bool *) mem_78084)[(int64_t) 0] = defunc_0_leq_res_77598;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_79395_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_79395(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78120, __global unsigned char *mem_78122)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79397;\n    int32_t tblock_sizze_79400;\n    int32_t wave_sizze_79399;\n    int32_t block_id_79398;\n    int32_t global_tid_79396;\n    int64_t tid_79395;\n    int64_t x_77600;\n    \n    local_tid_79397 = get_local_id(0);\n    tblock_sizze_79400 = get_local_size(0);\n    wave_sizze_79399 = LOCKSTEP_WIDTH;\n    block_id_79398 = get_tblock_id(0);\n    global_tid_79396 = block_id_79398 * tblock_sizze_79400 + local_tid_79397;\n    tid_79395 = sext_i32_i64(global_tid_79396);\n    x_77600 = ((__global int64_t *) mem_78120)[m_67854];\n    ((__global int64_t *) mem_78122)[(int64_t) 0] = x_77600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_79401_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_79401(__global int *global_failure, int64_t m_67854, __global unsigned char *mem_78103, __global unsigned char *mem_78125)\n{\n    ", "if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79403;\n    int32_t tblock_sizze_79406;\n    int32_t wave_sizze_79405;\n    int32_t block_id_79404;\n    int32_t global_tid_79402;\n    int64_t tid_79401;\n    int64_t x_77604;\n    \n    local_tid_79403 = get_local_id(0);\n    tblock_sizze_79406 = get_local_size(0);\n    wave_sizze_79405 = LOCKSTEP_WIDTH;\n    block_id_79404 = get_tblock_id(0);\n    global_tid_79402 = block_id_79404 * tblock_sizze_79406 + local_tid_79403;\n    tid_79401 = sext_i32_i64(global_tid_79402);\n    x_77604 = ((__global int64_t *) mem_78103)[m_67854];\n    ((__global int64_t *) mem_78125)[(int64_t) 0] = x_77604;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_79407_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_79407(__global int *global_failure, __global unsigned char *ext_mem_78123, __global unsigned char *ext_mem_78126, __global unsigned char *mem_78132)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79409;\n    int32_t tblock_sizze_79412;\n    int32_t wave_sizze_79411;\n    int32_t block_id_79410;\n    int32_t global_tid_79408;\n    int64_t tid_79407;\n    int64_t zp_lhs_77608;\n    int64_t n_pairs_t_res_77609;\n    int64_t n_pairs_t_res_77610;\n    \n    local_tid_79409 = get_local_id(0);\n    tblock_sizze_79412 = get_local_size(0);\n    wave_sizze_79411 = LOCKSTEP_WIDTH;\n    block_id_79410 = get_tblock_id(0);\n    global_tid_79408 = block_id_79410 * tblock_sizze_79412 + local_tid_79409;\n    tid_79407 = sext_i32_i64(global_tid_79408);\n    zp_lhs_77608 = ((__global int64_t *) ext_mem_78123)[(int64_t) 0];\n    n_pairs_t_res_77609 = ((__global int64_t *) ext_mem_78126)[(int64_t) 0];\n    n_pairs_t_res_77610 = add64(zp_lhs_77608, n_pairs_t_res_77609);\n    ((__global int64_t *) mem_78132)[(int64_t) 0] = n_pairs_t_res_77610;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_79454_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_79454(__global int *global_failure, int64_t loopres_68028, _", "_global unsigned char *mem_param_78166, __global unsigned char *mem_param_78169, __global unsigned char *mem_param_78172, __global unsigned char *mem_78179, __global unsigned char *mem_78180, __global unsigned char *mem_78181)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79456;\n    int32_t tblock_sizze_79459;\n    int32_t wave_sizze_79458;\n    int32_t block_id_79457;\n    int32_t global_tid_79455;\n    int64_t tid_79454;\n    int16_t loopres_77612;\n    int64_t loopres_77614;\n    int64_t loopres_77616;\n    \n    local_tid_79456 = get_local_id(0);\n    tblock_sizze_79459 = get_local_size(0);\n    wave_sizze_79458 = LOCKSTEP_WIDTH;\n    block_id_79457 = get_tblock_id(0);\n    global_tid_79455 = block_id_79457 * tblock_sizze_79459 + local_tid_79456;\n    tid_79454 = sext_i32_i64(global_tid_79455);\n    loopres_77612 = ((__global int16_t *) mem_param_78166)[loopres_68028];\n    loopres_77614 = ((__global int64_t *) mem_param_78169)[loopres_68028];\n    loopres_77616 = ((__global int64_t *) mem_param_78172)[loopres_68028];\n    ((__global int16_t *) mem_78179)[(int64_t) 0] = loopres_77612;\n    ((__global int64_t *) mem_78180)[(int64_t) 0] = loopres_77614;\n    ((__global int64_t *) mem_78181)[(int64_t) 0] = loopres_77616;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_shortzireplicate_79461(int64_t loopres_68029, int64_t replicate_n_79460, int64_t virt_num_tblocks_79466, int64_t num_tblocks_79467, __global unsigned char *mem_78179, __global unsigned char *mem_78183)\n{\n    int32_t replicate_ltid_79462;\n    int32_t tblock_sizze_79464;\n    int32_t replicate_gid_79463;\n    int32_t replicate_gtid_79461;\n    int32_t phys_tblock_id_79468;\n    int32_t iterations_79469;\n    \n    replicate_ltid_79462 = get_local_id(0);\n    tblock_sizze_79464 = get_local_size(0);\n    replicate_gid_79463 = get_tblock_id(0);\n    replicate_gtid_79461 = replicate_gid_79463 * tblock_sizze_79464 + replicate_ltid_79462;\n    phys_tblock_id_79468 = get_tblock_id(0);\n    iterations",
                                    "_79469 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79466) - phys_tblock_id_79468, sext_i64_i32(num_tblocks_79467));\n    for (int32_t i_79470 = 0; i_79470 < iterations_79469; i_79470++) {\n        int32_t virt_tblock_id_79471;\n        int64_t global_tid_79472;\n        int64_t slice_79475;\n        int64_t slice_79476;\n        int64_t rep_i_79473;\n        int64_t remnant_79477;\n        int64_t rep_i_79474;\n        int64_t remnant_79478;\n        \n        virt_tblock_id_79471 = phys_tblock_id_79468 + i_79470 * sext_i64_i32(num_tblocks_79467);\n        global_tid_79472 = sext_i32_i64(virt_tblock_id_79471) * sext_i32_i64(tblock_sizze_79464) + sext_i32_i64(replicate_ltid_79462);\n        slice_79475 = (int64_t) 1;\n        slice_79476 = loopres_68029 * slice_79475;\n        rep_i_79473 = squot64(global_tid_79472, slice_79475);\n        remnant_79477 = global_tid_79472 - rep_i_79473 * slice_79475;\n        rep_i_79474 = remnant_79477;\n        remnant_79478 = remnant_79477 - rep_i_79474;\n        if (slt64(global_tid_79472, replicate_n_79460)) {\n            int16_t tmp_79479 = ((__global int16_t *) mem_78179)[rep_i_79474];\n            \n            ((__global int16_t *) mem_78183)[rep_i_79473 + rep_i_79474] = tmp_79479;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_shortzireplicate_79481(int64_t loopres_68029, int64_t replicate_n_79480, int64_t virt_num_tblocks_79486, int64_t num_tblocks_79487, __global unsigned char *mem_78180, __global unsigned char *mem_78185)\n{\n    int32_t replicate_ltid_79482;\n    int32_t tblock_sizze_79484;\n    int32_t replicate_gid_79483;\n    int32_t replicate_gtid_79481;\n    int32_t phys_tblock_id_79488;\n    int32_t iterations_79489;\n    \n    replicate_ltid_79482 = get_local_id(0);\n    tblock_sizze_79484 = get_local_size(0);\n    replicate_gid_79483 = get_tblock_id(0);\n    replicate_gtid_79481 = replicate_gid_79483 * tblock_sizze_79484 + replicate_ltid_79482;\n    phys_tbloc", "k_id_79488 = get_tblock_id(0);\n    iterations_79489 = sdiv_up32(sext_i64_i32(virt_num_tblocks_79486) - phys_tblock_id_79488, sext_i64_i32(num_tblocks_79487));\n    for (int32_t i_79490 = 0; i_79490 < iterations_79489; i_79490++) {\n        int32_t virt_tblock_id_79491;\n        int64_t global_tid_79492;\n        int64_t slice_79495;\n        int64_t slice_79496;\n        int64_t rep_i_79493;\n        int64_t remnant_79497;\n        int64_t rep_i_79494;\n        int64_t remnant_79498;\n        \n        virt_tblock_id_79491 = phys_tblock_id_79488 + i_79490 * sext_i64_i32(num_tblocks_79487);\n        global_tid_79492 = sext_i32_i64(virt_tblock_id_79491) * sext_i32_i64(tblock_sizze_79484) + sext_i32_i64(replicate_ltid_79482);\n        slice_79495 = (int64_t) 1;\n        slice_79496 = loopres_68029 * slice_79495;\n        rep_i_79493 = squot64(global_tid_79492, slice_79495);\n        remnant_79497 = global_tid_79492 - rep_i_79493 * slice_79495;\n        rep_i_79494 = remnant_79497;\n        remnant_79498 = remnant_79497 - rep_i_79494;\n        if (slt64(global_tid_79492, replicate_n_79480)) {\n            int64_t tmp_79499 = ((__global int64_t *) mem_78180)[rep_i_79494];\n            \n            ((__global int64_t *) mem_78185)[rep_i_79493 + rep_i_79494] = tmp_79499;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_69883_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_69883(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_39348, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t max_res_67171, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, int64_t zt_rhs_67177, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77653, __global unsigned char *mem_77662, __global unsigned char *mem_77664)\n{\n    #define segm", "ap_tblock_sizze_69878 (inner_SMJ_shortzisegmap_69883zisegmap_tblock_sizze_69878)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78873;\n    int32_t tblock_sizze_78876;\n    int32_t wave_sizze_78875;\n    int32_t block_id_78874;\n    int32_t global_tid_78872;\n    int64_t phys_tid_69883;\n    int64_t global_tid_78877;\n    int64_t slice_78878;\n    int64_t gtid_69882;\n    int64_t remnant_78879;\n    \n    local_tid_78873 = get_local_id(0);\n    tblock_sizze_78876 = get_local_size(0);\n    wave_sizze_78875 = LOCKSTEP_WIDTH;\n    block_id_78874 = get_tblock_id(0);\n    global_tid_78872 = block_id_78874 * tblock_sizze_78876 + local_tid_78873;\n    phys_tid_69883 = sext_i32_i64(global_tid_78872);\n    global_tid_78877 = sext_i32_i64(block_id_78874) * segmap_tblock_sizze_69878 + sext_i32_i64(local_tid_78873);\n    slice_78878 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;\n    gtid_69882 = global_tid_78877;\n    remnant_78879 = global_tid_78877 - gtid_69882;\n    if (slt64(gtid_69882, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172)) {\n        int16_t lowest_77569;\n        int64_t index_primexp_76055;\n        int64_t zs_lhs_69885;\n        int64_t index_69886;\n        bool cond_69887;\n        int64_t loop_over_69888;\n        int64_t loop_over_69889;\n        int64_t loop_over_69891;\n        bool defunc_0_f_res_69894;\n        int64_t defunc_0_f_res_69895;\n        int64_t defunc_0_f_res_69896;\n        int64_t defunc_0_f_res_69897;\n        bool loop_while_69898;\n        int64_t p_69899;\n        int64_t p_69900;\n        int64_t p_69901;\n        \n        lowest_77569 = ((__global int16_t *) ext_mem_77653)[(int64_t) 0];\n        index_primexp_76055 = add64(max_res_67171, gtid_69882);\n        zs_lhs_69885 = mul64(zt_rhs_67177, index_primexp_76055);\n        index_69886 = sdiv64(zs_lhs_69885, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n        cond_69887 = slt64(nR_39348, index_69886);\n        if (cond_69887) {\n            l",
                                    "oop_over_69888 = nR_39348;\n        } else {\n            loop_over_69888 = index_69886;\n        }\n        if (cond_69887) {\n            int64_t loop_over_t_res_69890 = sub64(index_69886, nR_39348);\n            \n            loop_over_69889 = loop_over_t_res_69890;\n        } else {\n            loop_over_69889 = (int64_t) 0;\n        }\n        if (cond_69887) {\n            int64_t zm_lhs_69892;\n            int64_t loop_over_t_res_69893;\n            \n            zm_lhs_69892 = sub64(index_69886, nR_39348);\n            loop_over_t_res_69893 = sub64(zm_lhs_69892, (int64_t) 1);\n            loop_over_69891 = loop_over_t_res_69893;\n        } else {\n            loop_over_69891 = (int64_t) 0;\n        }\n        loop_while_69898 = 1;\n        p_69899 = loop_over_69891;\n        p_69900 = loop_over_69888;\n        p_69901 = loop_over_69889;\n        while (loop_while_69898) {\n            int64_t zs_lhs_69902;\n            int64_t offset_69903;\n            int64_t ai_69904;\n            int64_t max_arg1_69905;\n            int64_t max_res_69906;\n            bool cond_69907;\n            int16_t b_prev_69908;\n            bool cond_69916;\n            int64_t loopres_69917;\n            int64_t loopres_69918;\n            int64_t loopres_69919;\n            bool loopres_69920;\n            bool loop_while_tmp_78880;\n            int64_t p_tmp_78881;\n            int64_t p_tmp_78882;\n            int64_t p_tmp_78883;\n            \n            zs_lhs_69902 = sub64(p_69900, p_69899);\n            offset_69903 = sdiv64(zs_lhs_69902, (int64_t) 2);\n            ai_69904 = sub64(p_69900, offset_69903);\n            max_arg1_69905 = add64(p_69901, offset_69903);\n            max_res_69906 = smax64((int64_t) 0, max_arg1_69905);\n            cond_69907 = slt64((int64_t) 0, max_res_69906);\n            if (cond_69907) {\n                int64_t tmp_69909;\n                bool x_69910;\n                bool y_69911;\n                bool bounds_check_69912;\n                bool index_certs_69913;\n                int64_t s", "lice_69914;\n                int16_t b_prev_t_res_69915;\n                \n                tmp_69909 = sub64(max_res_69906, (int64_t) 1);\n                x_69910 = sle64((int64_t) 0, tmp_69909);\n                y_69911 = slt64(tmp_69909, nR_39348);\n                bounds_check_69912 = x_69910 && y_69911;\n                if (!bounds_check_69912) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 140) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_69909;\n                            global_failure_args[1] = (int64_t) nR_39348;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_69914 = tS_start_66998 + tmp_69909;\n                b_prev_t_res_69915 = ((__global int16_t *) tS_mem_77626)[slice_69914];\n                b_prev_69908 = b_prev_t_res_69915;\n            } else {\n                b_prev_69908 = lowest_77569;\n            }\n            cond_69916 = sle64(ai_69904, (int64_t) 0);\n            if (cond_69916) {\n                loopres_69917 = p_69899;\n                loopres_69918 = (int64_t) 0;\n                loopres_69919 = max_res_69906;\n                loopres_69920 = 0;\n            } else {\n                bool cond_69921;\n                int64_t loopres_f_res_69922;\n                int64_t loopres_f_res_69923;\n                int64_t loopres_f_res_69924;\n                bool loopres_f_res_69925;\n                \n                cond_69921 = sle64(nR_39348, max_res_69906);\n                if (cond_69921) {\n                    int64_t min_arg1_69926;\n                    int64_t min_res_69927;\n                    bool x_69928;\n                    bool y_69929;\n                    bool bounds_check_69930;\n                    bool index_certs_69931;\n                    bool x_69934;\n                    bool y_69935;\n                    bool bounds_check_69936;\n                    bool index_certs_69", "937;\n                    int64_t slice_69932;\n                    int16_t leq_lhs_69933;\n                    int16_t leq_rhs_69938;\n                    bool defunc_0_leq_res_69939;\n                    int64_t loopres_f_res_t_res_69940;\n                    bool x_69941;\n                    int64_t loopres_f_res_t_res_69942;\n                    \n                    min_arg1_69926 = sub64(nR_39348, (int64_t) 1);\n                    min_res_69927 = smin64(ai_69904, min_arg1_69926);\n                    x_69928 = sle64((int64_t) 0, min_arg1_69926);\n                    y_69929 = slt64(min_arg1_69926, nR_39348);\n                    bounds_check_69930 = x_69928 && y_69929;\n                    if (!bounds_check_69930) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 141) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_69926;\n                                global_failure_args[1] = (int64_t) nR_39348;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_69934 = sle64((int64_t) 0, min_res_69927);\n                    y_69935 = slt64(min_res_69927, nR_39348);\n                    bounds_check_69936 = x_69934 && y_69935;\n                    if (!bounds_check_69936) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 142) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_69927;\n                                global_failure_args[1] = (int64_t) nR_39348;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_69932 = tS_start_66998 + min_arg1_69926;\n                    leq_lhs_69933 = ((__global int16_t *) tS_mem_77626)[slice_69932];\n                    leq_rhs_69938 = ((__g",
                                    "lobal int16_t *) tR_mem_77625)[min_res_69927];\n                    defunc_0_leq_res_69939 = sle16(leq_lhs_69933, leq_rhs_69938);\n                    if (defunc_0_leq_res_69939) {\n                        loopres_f_res_t_res_69940 = ai_69904;\n                    } else {\n                        loopres_f_res_t_res_69940 = p_69900;\n                    }\n                    x_69941 = !defunc_0_leq_res_69939;\n                    if (defunc_0_leq_res_69939) {\n                        loopres_f_res_t_res_69942 = nR_39348;\n                    } else {\n                        int64_t tmp_69943 = sub64(min_arg1_69926, offset_69903);\n                        \n                        loopres_f_res_t_res_69942 = tmp_69943;\n                    }\n                    loopres_f_res_69922 = p_69899;\n                    loopres_f_res_69923 = loopres_f_res_t_res_69940;\n                    loopres_f_res_69924 = loopres_f_res_t_res_69942;\n                    loopres_f_res_69925 = x_69941;\n                } else {\n                    bool cond_69944;\n                    int64_t loopres_f_res_f_res_69945;\n                    int64_t loopres_f_res_f_res_69946;\n                    int64_t loopres_f_res_f_res_69947;\n                    bool loopres_f_res_f_res_69948;\n                    \n                    cond_69944 = sle64(nR_39348, ai_69904);\n                    if (cond_69944) {\n                        int64_t min_arg1_69949;\n                        int64_t min_res_69950;\n                        bool x_69951;\n                        bool y_69952;\n                        bool bounds_check_69953;\n                        bool index_certs_69954;\n                        bool x_69956;\n                        bool y_69957;\n                        bool bounds_check_69958;\n                        bool index_certs_69959;\n                        int16_t leq_lhs_69955;\n                        int64_t slice_69960;\n                        int16_t leq_rhs_69961;\n                        bool defunc_0_leq_", "res_69962;\n                        int64_t loopres_f_res_f_res_t_res_69963;\n                        bool x_69964;\n                        int64_t loopres_f_res_f_res_t_res_69965;\n                        \n                        min_arg1_69949 = sub64(nR_39348, (int64_t) 1);\n                        min_res_69950 = smin64(max_res_69906, min_arg1_69949);\n                        x_69951 = sle64((int64_t) 0, min_arg1_69949);\n                        y_69952 = slt64(min_arg1_69949, nR_39348);\n                        bounds_check_69953 = x_69951 && y_69952;\n                        if (!bounds_check_69953) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 143) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_69949;\n                                    global_failure_args[1] = (int64_t) nR_39348;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_69956 = sle64((int64_t) 0, min_res_69950);\n                        y_69957 = slt64(min_res_69950, nR_39348);\n                        bounds_check_69958 = x_69956 && y_69957;\n                        if (!bounds_check_69958) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 144) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_69950;\n                                    global_failure_args[1] = (int64_t) nR_39348;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_69955 = ((__global int16_t *) tR_mem_77625)[min_arg1_69949];\n                        slice_69960 = tS_start_66998 + min_res_69950;\n                        leq_rhs_69961 = ((__global int16", "_t *) tS_mem_77626)[slice_69960];\n                        defunc_0_leq_res_69962 = sle16(leq_lhs_69955, leq_rhs_69961);\n                        if (defunc_0_leq_res_69962) {\n                            loopres_f_res_f_res_t_res_69963 = max_res_69906;\n                        } else {\n                            loopres_f_res_f_res_t_res_69963 = p_69901;\n                        }\n                        x_69964 = !defunc_0_leq_res_69962;\n                        if (defunc_0_leq_res_69962) {\n                            loopres_f_res_f_res_t_res_69965 = nR_39348;\n                        } else {\n                            loopres_f_res_f_res_t_res_69965 = min_arg1_69949;\n                        }\n                        loopres_f_res_f_res_69945 = p_69899;\n                        loopres_f_res_f_res_69946 = loopres_f_res_f_res_t_res_69965;\n                        loopres_f_res_f_res_69947 = loopres_f_res_f_res_t_res_69963;\n                        loopres_f_res_f_res_69948 = x_69964;\n                    } else {\n                        bool cond_69966;\n                        int64_t loopres_f_res_f_res_f_res_69967;\n                        int64_t loopres_f_res_f_res_f_res_69968;\n                        int64_t loopres_f_res_f_res_f_res_69969;\n                        bool loopres_f_res_f_res_f_res_69970;\n                        \n                        cond_69966 = sle64(p_69900, p_69899);\n                        if (cond_69966) {\n                            bool cond_69971;\n                            int64_t ai_69972;\n                            bool x_69985;\n                            bool y_69986;\n                            bool bounds_check_69987;\n                            bool index_certs_69988;\n                            int16_t b_prev_69974;\n                            int16_t gt_lhs_69989;\n                            bool defunc_0_gt_res_69990;\n                            int64_t defunc_0_partFunc_sequential_search_res_69991;\n                            in",
                                    "t64_t defunc_0_partFunc_sequential_search_res_69992;\n                            \n                            cond_69971 = slt64(ai_69904, nR_39348);\n                            if (cond_69971) {\n                                ai_69972 = ai_69904;\n                            } else {\n                                int64_t ai_f_res_69973 = sub64(nR_39348, (int64_t) 1);\n                                \n                                ai_69972 = ai_f_res_69973;\n                            }\n                            x_69985 = sle64((int64_t) 0, ai_69972);\n                            y_69986 = slt64(ai_69972, nR_39348);\n                            bounds_check_69987 = x_69985 && y_69986;\n                            if (!bounds_check_69987) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 145) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_69972;\n                                        global_failure_args[1] = (int64_t) nR_39348;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_69907) {\n                                int64_t tmp_69975;\n                                bool x_69976;\n                                bool y_69977;\n                                bool bounds_check_69978;\n                                bool index_certs_69979;\n                                int64_t slice_69980;\n                                int16_t b_prev_t_res_69981;\n                                \n                                tmp_69975 = sub64(max_res_69906, (int64_t) 1);\n                                x_69976 = sle64((int64_t) 0, tmp_69975);\n                                y_69977 = slt64(tmp_69975, nR_39348);\n                                bounds_check_69978 = x_69976 && y_69977;\n             ", "                   if (!bounds_check_69978) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 146) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_69975;\n                                            global_failure_args[1] = (int64_t) nR_39348;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_69980 = tS_start_66998 + tmp_69975;\n                                b_prev_t_res_69981 = ((__global int16_t *) tS_mem_77626)[slice_69980];\n                                b_prev_69974 = b_prev_t_res_69981;\n                            } else {\n                                bool y_69982;\n                                bool index_certs_69983;\n                                int16_t b_prev_f_res_69984;\n                                \n                                y_69982 = slt64((int64_t) 0, nR_39348);\n                                if (!y_69982) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 147) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_39348;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_69984 = ((__global int16_t *) tS_mem_77626)[tS_start_66998];\n                                b_prev_69974 = b_prev_f_res_69984;\n                            }\n                            gt_lhs_69989 = ((__global int16_t *) tR_mem_77625)[ai_69972];\n     ", "                       defunc_0_gt_res_69990 = slt16(b_prev_69974, gt_lhs_69989);\n                            if (defunc_0_gt_res_69990) {\n                                int64_t zl_rhs_69993;\n                                bool loop_cond_69994;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_69995;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_69996;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_69997;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_69998;\n                                bool loop_while_69999;\n                                int64_t p_70000;\n                                int64_t p_70001;\n                                int64_t p_70002;\n                                \n                                zl_rhs_69993 = sub64(nR_39348, max_res_69906);\n                                loop_cond_69994 = slt64((int64_t) 0, zl_rhs_69993);\n                                loop_while_69999 = loop_cond_69994;\n                                p_70000 = ai_69972;\n                                p_70001 = max_res_69906;\n                                p_70002 = (int64_t) 0;\n                                while (loop_while_69999) {\n                                    int64_t i_a_70003;\n                                    int64_t i_b_70004;\n                                    int64_t leq_lhs_70005;\n                                    bool x_70006;\n                                    bool y_70007;\n                                    bool bounds_check_70008;\n                                    bool index_certs_70009;\n                                    bool x_70011;\n                                    bool y_70012;\n                                    bool bounds_check_70013;\n                                    bool index_certs_70014;\n                                    int16_t leq_lhs_70010;\n                         ",
                                    "           int64_t slice_70015;\n                                    int16_t leq_rhs_70016;\n                                    bool defunc_0_leq_res_70017;\n                                    int64_t loopres_70018;\n                                    int64_t loopres_70019;\n                                    int64_t loopres_70020;\n                                    bool loop_cond_70022;\n                                    bool loop_while_tmp_78884;\n                                    int64_t p_tmp_78885;\n                                    int64_t p_tmp_78886;\n                                    int64_t p_tmp_78887;\n                                    \n                                    i_a_70003 = sub64(ai_69972, p_70002);\n                                    i_b_70004 = add64(max_res_69906, p_70002);\n                                    leq_lhs_70005 = sub64(i_a_70003, (int64_t) 1);\n                                    x_70006 = sle64((int64_t) 0, leq_lhs_70005);\n                                    y_70007 = slt64(leq_lhs_70005, nR_39348);\n                                    bounds_check_70008 = x_70006 && y_70007;\n                                    if (!bounds_check_70008) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 148) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_70005;\n                                                global_failure_args[1] = (int64_t) nR_39348;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_70011 = sle64((int64_t) 0, i_b_70004);\n                                    y_70012 = slt64(i_b_70004, nR_39348);\n                                    bounds_check_70013 = x_70011 && y_70012;\n      ", "                              if (!bounds_check_70013) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 149) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_70004;\n                                                global_failure_args[1] = (int64_t) nR_39348;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_70010 = ((__global int16_t *) tR_mem_77625)[leq_lhs_70005];\n                                    slice_70015 = tS_start_66998 + i_b_70004;\n                                    leq_rhs_70016 = ((__global int16_t *) tS_mem_77626)[slice_70015];\n                                    defunc_0_leq_res_70017 = sle16(leq_lhs_70010, leq_rhs_70016);\n                                    if (defunc_0_leq_res_70017) {\n                                        loopres_70018 = i_a_70003;\n                                    } else {\n                                        loopres_70018 = ai_69972;\n                                    }\n                                    if (defunc_0_leq_res_70017) {\n                                        loopres_70019 = i_b_70004;\n                                    } else {\n                                        loopres_70019 = max_res_69906;\n                                    }\n                                    if (defunc_0_leq_res_70017) {\n                                        loopres_70020 = zl_rhs_69993;\n                                    } else {\n                                        int64_t tmp_70021 = add64((int64_t) 1, p_70002);\n                                        \n                                        loopres_70020 = tmp_70021;\n                                    }\n           ", "                         loop_cond_70022 = slt64(loopres_70020, zl_rhs_69993);\n                                    loop_while_tmp_78884 = loop_cond_70022;\n                                    p_tmp_78885 = loopres_70018;\n                                    p_tmp_78886 = loopres_70019;\n                                    p_tmp_78887 = loopres_70020;\n                                    loop_while_69999 = loop_while_tmp_78884;\n                                    p_70000 = p_tmp_78885;\n                                    p_70001 = p_tmp_78886;\n                                    p_70002 = p_tmp_78887;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_69995 = loop_while_69999;\n                                defunc_0_partFunc_sequential_search_res_t_res_69996 = p_70000;\n                                defunc_0_partFunc_sequential_search_res_t_res_69997 = p_70001;\n                                defunc_0_partFunc_sequential_search_res_t_res_69998 = p_70002;\n                                defunc_0_partFunc_sequential_search_res_69991 = defunc_0_partFunc_sequential_search_res_t_res_69996;\n                                defunc_0_partFunc_sequential_search_res_69992 = defunc_0_partFunc_sequential_search_res_t_res_69997;\n                            } else {\n                                int64_t zl_rhs_70023;\n                                bool loop_cond_70024;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_70025;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70026;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70027;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70028;\n                                bool loop_while_70029;\n                                int64_t p_70030;\n                                int64_t p_70031;\n                                int64_t ",
                                    "p_70032;\n                                \n                                zl_rhs_70023 = sub64(max_res_69906, (int64_t) 1);\n                                loop_cond_70024 = slt64((int64_t) 0, zl_rhs_70023);\n                                loop_while_70029 = loop_cond_70024;\n                                p_70030 = ai_69972;\n                                p_70031 = max_res_69906;\n                                p_70032 = (int64_t) 0;\n                                while (loop_while_70029) {\n                                    int64_t zp_lhs_70033;\n                                    int64_t hi_a_70034;\n                                    bool cond_70035;\n                                    int64_t i_a_70036;\n                                    int64_t zm_lhs_70038;\n                                    int64_t i_b_70039;\n                                    bool x_70040;\n                                    bool y_70041;\n                                    bool bounds_check_70042;\n                                    bool index_certs_70043;\n                                    bool x_70045;\n                                    bool y_70046;\n                                    bool bounds_check_70047;\n                                    bool index_certs_70048;\n                                    int16_t gt_lhs_70044;\n                                    int64_t slice_70049;\n                                    int16_t gt_rhs_70050;\n                                    bool defunc_0_gt_res_70051;\n                                    int64_t loopres_70052;\n                                    int64_t loopres_70053;\n                                    int64_t loopres_70054;\n                                    bool loop_cond_70056;\n                                    bool loop_while_tmp_78888;\n                                    int64_t p_tmp_78889;\n                                    int64_t p_tmp_78890;\n                                    int64_t p_tmp_78891;\n                  ", "                  \n                                    zp_lhs_70033 = add64(ai_69972, p_70032);\n                                    hi_a_70034 = add64((int64_t) 1, zp_lhs_70033);\n                                    cond_70035 = slt64(hi_a_70034, nR_39348);\n                                    if (cond_70035) {\n                                        i_a_70036 = hi_a_70034;\n                                    } else {\n                                        int64_t i_a_f_res_70037 = sub64(nR_39348, (int64_t) 1);\n                                        \n                                        i_a_70036 = i_a_f_res_70037;\n                                    }\n                                    zm_lhs_70038 = sub64(max_res_69906, p_70032);\n                                    i_b_70039 = sub64(zm_lhs_70038, (int64_t) 1);\n                                    x_70040 = sle64((int64_t) 0, i_a_70036);\n                                    y_70041 = slt64(i_a_70036, nR_39348);\n                                    bounds_check_70042 = x_70040 && y_70041;\n                                    if (!bounds_check_70042) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 150) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_70036;\n                                                global_failure_args[1] = (int64_t) nR_39348;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_70045 = sle64((int64_t) 0, i_b_70039);\n                                    y_70046 = slt64(i_b_70039, nR_39348);\n                                    bounds_check_70047 = x_70045 && y_70046;\n                                    if (!bounds_check_70047) {\n                         ", "               {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 151) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_70039;\n                                                global_failure_args[1] = (int64_t) nR_39348;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_70044 = ((__global int16_t *) tR_mem_77625)[i_a_70036];\n                                    slice_70049 = tS_start_66998 + i_b_70039;\n                                    gt_rhs_70050 = ((__global int16_t *) tS_mem_77626)[slice_70049];\n                                    defunc_0_gt_res_70051 = slt16(gt_rhs_70050, gt_lhs_70044);\n                                    if (defunc_0_gt_res_70051) {\n                                        loopres_70052 = i_a_70036;\n                                    } else {\n                                        loopres_70052 = ai_69972;\n                                    }\n                                    if (defunc_0_gt_res_70051) {\n                                        loopres_70053 = zm_lhs_70038;\n                                    } else {\n                                        loopres_70053 = max_res_69906;\n                                    }\n                                    if (defunc_0_gt_res_70051) {\n                                        loopres_70054 = zl_rhs_70023;\n                                    } else {\n                                        int64_t tmp_70055 = add64((int64_t) 1, p_70032);\n                                        \n                                        loopres_70054 = tmp_70055;\n                                    }\n                                    loop_cond_70056 = slt64(loopres_70054, zl_rhs_70023);\n            ",
                                    "                        loop_while_tmp_78888 = loop_cond_70056;\n                                    p_tmp_78889 = loopres_70052;\n                                    p_tmp_78890 = loopres_70053;\n                                    p_tmp_78891 = loopres_70054;\n                                    loop_while_70029 = loop_while_tmp_78888;\n                                    p_70030 = p_tmp_78889;\n                                    p_70031 = p_tmp_78890;\n                                    p_70032 = p_tmp_78891;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_70025 = loop_while_70029;\n                                defunc_0_partFunc_sequential_search_res_f_res_70026 = p_70030;\n                                defunc_0_partFunc_sequential_search_res_f_res_70027 = p_70031;\n                                defunc_0_partFunc_sequential_search_res_f_res_70028 = p_70032;\n                                defunc_0_partFunc_sequential_search_res_69991 = defunc_0_partFunc_sequential_search_res_f_res_70026;\n                                defunc_0_partFunc_sequential_search_res_69992 = defunc_0_partFunc_sequential_search_res_f_res_70027;\n                            }\n                            loopres_f_res_f_res_f_res_69967 = p_69899;\n                            loopres_f_res_f_res_f_res_69968 = defunc_0_partFunc_sequential_search_res_69991;\n                            loopres_f_res_f_res_f_res_69969 = defunc_0_partFunc_sequential_search_res_69992;\n                            loopres_f_res_f_res_f_res_69970 = 0;\n                        } else {\n                            bool x_70057;\n                            bool y_70058;\n                            bool bounds_check_70059;\n                            bool index_certs_70060;\n                            int16_t gt_lhs_70061;\n                            bool defunc_0_gt_res_70062;\n                            int64_t loopres_f_res_f_res_f_res_f_res_70063;\n           ", "                 int64_t loopres_f_res_f_res_f_res_f_res_70064;\n                            int64_t loopres_f_res_f_res_f_res_f_res_70065;\n                            bool loopres_f_res_f_res_f_res_f_res_70066;\n                            \n                            x_70057 = sle64((int64_t) 0, ai_69904);\n                            y_70058 = slt64(ai_69904, nR_39348);\n                            bounds_check_70059 = x_70057 && y_70058;\n                            if (!bounds_check_70059) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 152) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_69904;\n                                        global_failure_args[1] = (int64_t) nR_39348;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_70061 = ((__global int16_t *) tR_mem_77625)[ai_69904];\n                            defunc_0_gt_res_70062 = slt16(b_prev_69908, gt_lhs_70061);\n                            if (defunc_0_gt_res_70062) {\n                                int64_t leq_lhs_70067;\n                                bool x_70068;\n                                bool y_70069;\n                                bool bounds_check_70070;\n                                bool index_certs_70071;\n                                bool x_70073;\n                                bool y_70074;\n                                bool bounds_check_70075;\n                                bool index_certs_70076;\n                                int16_t leq_lhs_70072;\n                                int64_t slice_70077;\n                                int16_t leq_rhs_70078;\n                                bool defunc_0_leq_res_70079;\n                                bool x_70080;\n                                int64_t lo", "opres_f_res_f_res_f_res_f_res_t_res_70081;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_70082;\n                                \n                                leq_lhs_70067 = sub64(ai_69904, (int64_t) 1);\n                                x_70068 = sle64((int64_t) 0, leq_lhs_70067);\n                                y_70069 = slt64(leq_lhs_70067, nR_39348);\n                                bounds_check_70070 = x_70068 && y_70069;\n                                if (!bounds_check_70070) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 153) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_70067;\n                                            global_failure_args[1] = (int64_t) nR_39348;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_70073 = sle64((int64_t) 0, max_res_69906);\n                                y_70074 = slt64(max_res_69906, nR_39348);\n                                bounds_check_70075 = x_70073 && y_70074;\n                                if (!bounds_check_70075) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 154) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_69906;\n                                            global_failure_args[1] = (int64_t) nR_39348;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_70072 = ((__global int16_t *) tR_mem_77625)[leq_lhs_70067];\n                             ",
                                    "   slice_70077 = tS_start_66998 + max_res_69906;\n                                leq_rhs_70078 = ((__global int16_t *) tS_mem_77626)[slice_70077];\n                                defunc_0_leq_res_70079 = sle16(leq_lhs_70072, leq_rhs_70078);\n                                x_70080 = !defunc_0_leq_res_70079;\n                                if (defunc_0_leq_res_70079) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70081 = ai_69904;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70081 = leq_lhs_70067;\n                                }\n                                if (defunc_0_leq_res_70079) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70082 = max_res_69906;\n                                } else {\n                                    int64_t tmp_70083 = add64((int64_t) 1, max_res_69906);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_70082 = tmp_70083;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_70063 = p_69899;\n                                loopres_f_res_f_res_f_res_f_res_70064 = loopres_f_res_f_res_f_res_f_res_t_res_70081;\n                                loopres_f_res_f_res_f_res_f_res_70065 = loopres_f_res_f_res_f_res_f_res_t_res_70082;\n                                loopres_f_res_f_res_f_res_f_res_70066 = x_70080;\n                            } else {\n                                int64_t tmp_70084 = add64((int64_t) 1, ai_69904);\n                                \n                                loopres_f_res_f_res_f_res_f_res_70063 = tmp_70084;\n                                loopres_f_res_f_res_f_res_f_res_70064 = p_69900;\n                                loopres_f_res_f_res_f_res_f_res_70065 = p_69901;\n                                loopres_f_res_f_res_f_res_f_res_70066 = 1;\n                            }\n             ", "               loopres_f_res_f_res_f_res_69967 = loopres_f_res_f_res_f_res_f_res_70063;\n                            loopres_f_res_f_res_f_res_69968 = loopres_f_res_f_res_f_res_f_res_70064;\n                            loopres_f_res_f_res_f_res_69969 = loopres_f_res_f_res_f_res_f_res_70065;\n                            loopres_f_res_f_res_f_res_69970 = loopres_f_res_f_res_f_res_f_res_70066;\n                        }\n                        loopres_f_res_f_res_69945 = loopres_f_res_f_res_f_res_69967;\n                        loopres_f_res_f_res_69946 = loopres_f_res_f_res_f_res_69968;\n                        loopres_f_res_f_res_69947 = loopres_f_res_f_res_f_res_69969;\n                        loopres_f_res_f_res_69948 = loopres_f_res_f_res_f_res_69970;\n                    }\n                    loopres_f_res_69922 = loopres_f_res_f_res_69945;\n                    loopres_f_res_69923 = loopres_f_res_f_res_69946;\n                    loopres_f_res_69924 = loopres_f_res_f_res_69947;\n                    loopres_f_res_69925 = loopres_f_res_f_res_69948;\n                }\n                loopres_69917 = loopres_f_res_69922;\n                loopres_69918 = loopres_f_res_69923;\n                loopres_69919 = loopres_f_res_69924;\n                loopres_69920 = loopres_f_res_69925;\n            }\n            loop_while_tmp_78880 = loopres_69920;\n            p_tmp_78881 = loopres_69917;\n            p_tmp_78882 = loopres_69918;\n            p_tmp_78883 = loopres_69919;\n            loop_while_69898 = loop_while_tmp_78880;\n            p_69899 = p_tmp_78881;\n            p_69900 = p_tmp_78882;\n            p_69901 = p_tmp_78883;\n        }\n        defunc_0_f_res_69894 = loop_while_69898;\n        defunc_0_f_res_69895 = p_69899;\n        defunc_0_f_res_69896 = p_69900;\n        defunc_0_f_res_69897 = p_69901;\n        ((__global int64_t *) mem_77662)[gtid_69882] = defunc_0_f_res_69896;\n        ((__global int64_t *) mem_77664)[gtid_69882] = defunc_0_f_res_69897;\n    }\n    \n  error_0:\n    return;\n   ", " #undef segmap_tblock_sizze_69878\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70257_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70257(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_39348, int64_t gt_rhs_66981, int64_t tS_start_66998, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, int64_t zeze_rhs_67414, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *mem_77644, __global unsigned char *mem_77646, __global unsigned char *mem_77680, __global unsigned char *mem_77682)\n{\n    #define segmap_tblock_sizze_70252 (inner_SMJ_shortzisegmap_70257zisegmap_tblock_sizze_70252)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78896;\n    int32_t tblock_sizze_78899;\n    int32_t wave_sizze_78898;\n    int32_t block_id_78897;\n    int32_t global_tid_78895;\n    int64_t phys_tid_70257;\n    int64_t global_tid_78900;\n    int64_t slice_78901;\n    int64_t gtid_70256;\n    int64_t remnant_78902;\n    \n    local_tid_78896 = get_local_id(0);\n    tblock_sizze_78899 = get_local_size(0);\n    wave_sizze_78898 = LOCKSTEP_WIDTH;\n    block_id_78897 = get_tblock_id(0);\n    global_tid_78895 = block_id_78897 * tblock_sizze_78899 + local_tid_78896;\n    phys_tid_70257 = sext_i32_i64(global_tid_78895);\n    global_tid_78900 = sext_i32_i64(block_id_78897) * segmap_tblock_sizze_70252 + sext_i32_i64(local_tid_78896);\n    slice_78901 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n    gtid_70256 = global_tid_78900;\n    remnant_78902 = global_tid_78900 - gtid_70256;\n    if (slt64(gtid_70256, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140)) {\n        int64_t eta_p_70259;\n        int64_t min_res_70260;\n        bool x_70261;\n        bool y_70262;\n        bool bounds_check_70263;\n        bool index_certs_70264;\n        bool cond_70266;\n        int64_t ri_next_70267;\n        int64_t max_arg1_70274;\n        int64_t max",
                                    "_res_70275;\n        bool x_70276;\n        bool y_70277;\n        bool bounds_check_70278;\n        bool index_certs_70279;\n        int16_t r_min_70265;\n        int16_t r_max_70280;\n        bool defunc_0_f_res_70281;\n        int64_t defunc_0_f_res_70282;\n        bool loop_while_70283;\n        int64_t fm_70284;\n        bool defunc_0_f_res_70350;\n        int64_t defunc_0_f_res_70351;\n        bool loop_while_70352;\n        int64_t lm_70353;\n        \n        eta_p_70259 = ((__global int64_t *) mem_77644)[gtid_70256];\n        min_res_70260 = smin64(gt_rhs_66981, eta_p_70259);\n        x_70261 = sle64((int64_t) 0, min_res_70260);\n        y_70262 = slt64(min_res_70260, nR_39348);\n        bounds_check_70263 = x_70261 && y_70262;\n        if (!bounds_check_70263) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 155) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_70260;\n                    global_failure_args[1] = (int64_t) nR_39348;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_70266 = gtid_70256 == zeze_rhs_67414;\n        if (cond_70266) {\n            ri_next_70267 = nR_39348;\n        } else {\n            int64_t tmp_70268;\n            bool x_70269;\n            bool y_70270;\n            bool bounds_check_70271;\n            bool index_certs_70272;\n            int64_t ri_next_f_res_70273;\n            \n            tmp_70268 = add64((int64_t) 1, gtid_70256);\n            x_70269 = sle64((int64_t) 0, tmp_70268);\n            y_70270 = slt64(tmp_70268, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_70271 = x_70269 && y_70270;\n            if (!bounds_check_70271) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 156) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_70268;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz2", "0UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_70273 = ((__global int64_t *) mem_77644)[tmp_70268];\n            ri_next_70267 = ri_next_f_res_70273;\n        }\n        max_arg1_70274 = sub64(ri_next_70267, (int64_t) 1);\n        max_res_70275 = smax64((int64_t) 0, max_arg1_70274);\n        x_70276 = sle64((int64_t) 0, max_res_70275);\n        y_70277 = slt64(max_res_70275, nR_39348);\n        bounds_check_70278 = x_70276 && y_70277;\n        if (!bounds_check_70278) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 157) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_70275;\n                    global_failure_args[1] = (int64_t) nR_39348;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_70265 = ((__global int16_t *) tR_mem_77625)[min_res_70260];\n        r_max_70280 = ((__global int16_t *) tR_mem_77625)[max_res_70275];\n        loop_while_70283 = 1;\n        fm_70284 = gtid_70256;\n        while (loop_while_70283) {\n            bool x_70285;\n            bool y_70286;\n            bool bounds_check_70287;\n            bool index_certs_70288;\n            int64_t loopres_70289;\n            int64_t min_res_70290;\n            bool x_70291;\n            bool y_70292;\n            bool bounds_check_70293;\n            bool index_certs_70294;\n            bool cond_70297;\n            int64_t si_next_70298;\n            int64_t max_arg1_70305;\n            int64_t max_res_70306;\n            bool x_70307;\n            bool y_70308;\n            bool bounds_check_70309;\n            bool index_certs_70310;\n            int64_t min_res_70313;\n            bool x_70314;\n            bool y_70315;\n            bool bounds_check_70316;\n            bool index_certs_70317;\n            int64_t max_arg1_70320;\n            int64_t max_res_70321;\n            bool x_70322;\n            bool ", "y_70323;\n            bool bounds_check_70324;\n            bool index_certs_70325;\n            int64_t slice_70295;\n            int16_t s_min_70296;\n            int64_t slice_70311;\n            int64_t slice_70318;\n            int64_t slice_70326;\n            bool defunc_0_gt_res_70328;\n            bool loopres_70329;\n            int64_t loopres_70330;\n            bool loop_while_tmp_78903;\n            int64_t fm_tmp_78904;\n            \n            x_70285 = sle64((int64_t) 0, fm_70284);\n            y_70286 = slt64(fm_70284, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_70287 = x_70285 && y_70286;\n            if (!bounds_check_70287) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 158) == -1) {\n                        global_failure_args[0] = (int64_t) fm_70284;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_70289 = ((__global int64_t *) mem_77646)[fm_70284];\n            min_res_70290 = smin64(gt_rhs_66981, loopres_70289);\n            x_70291 = sle64((int64_t) 0, min_res_70290);\n            y_70292 = slt64(min_res_70290, nR_39348);\n            bounds_check_70293 = x_70291 && y_70292;\n            if (!bounds_check_70293) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 159) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70290;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_70297 = sle64(zeze_rhs_67414, fm_70284);\n            if (cond_70297) {\n                si_next_70298 = nR_39348;\n            } else {\n                int64_t tmp_70299;\n                bool x",
                                    "_70300;\n                bool y_70301;\n                bool bounds_check_70302;\n                bool index_certs_70303;\n                int64_t si_next_f_res_70304;\n                \n                tmp_70299 = add64((int64_t) 1, fm_70284);\n                x_70300 = sle64((int64_t) 0, tmp_70299);\n                y_70301 = slt64(tmp_70299, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n                bounds_check_70302 = x_70300 && y_70301;\n                if (!bounds_check_70302) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 160) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_70299;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_70304 = ((__global int64_t *) mem_77646)[tmp_70299];\n                si_next_70298 = si_next_f_res_70304;\n            }\n            max_arg1_70305 = sub64(si_next_70298, (int64_t) 1);\n            max_res_70306 = smax64(min_res_70290, max_arg1_70305);\n            x_70307 = sle64((int64_t) 0, max_res_70306);\n            y_70308 = slt64(max_res_70306, nR_39348);\n            bounds_check_70309 = x_70307 && y_70308;\n            if (!bounds_check_70309) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 161) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70306;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_70313 = smin64(zeze_rhs_67414, si_next_70298);\n            x_70314 = sle64((int64_t) 0, min_res_70313);\n            y_70315 = slt64(min_res_70313, nR_39348);\n            bounds_check_70316 =", " x_70314 && y_70315;\n            if (!bounds_check_70316) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 162) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70313;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_70320 = sub64(min_res_70290, (int64_t) 1);\n            max_res_70321 = smax64((int64_t) 0, max_arg1_70320);\n            x_70322 = sle64((int64_t) 0, max_res_70321);\n            y_70323 = slt64(max_res_70321, nR_39348);\n            bounds_check_70324 = x_70322 && y_70323;\n            if (!bounds_check_70324) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 163) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70321;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_70295 = tS_start_66998 + min_res_70290;\n            s_min_70296 = ((__global int16_t *) tS_mem_77626)[slice_70295];\n            slice_70311 = tS_start_66998 + max_res_70306;\n            slice_70318 = tS_start_66998 + min_res_70313;\n            slice_70326 = tS_start_66998 + max_res_70321;\n            defunc_0_gt_res_70328 = slt16(s_min_70296, r_min_70265);\n            if (defunc_0_gt_res_70328) {\n                int16_t s_max_70312;\n                bool defunc_0_leq_res_70331;\n                bool loopres_t_res_70332;\n                int64_t loopres_t_res_70333;\n                \n                s_max_70312 = ((__global int16_t *) tS_mem_77626)[slice_70311];\n                defunc_0_leq_res_70331 = sle16(r_min_70265, s_max_70312);\n                if (defunc_0_leq_res_70331) {\n                    loopres_t_res_70332 = 0;\n                    loopres_t_res_70333 = fm_70284;\n ", "               } else {\n                    int16_t s_nextMin_70319;\n                    bool defunc_0_leq_res_70334;\n                    int64_t zgze_lhs_70335;\n                    bool tmp_f_res_70336;\n                    bool x_70337;\n                    bool y_70338;\n                    bool tmp_70339;\n                    bool loopres_t_res_f_res_70340;\n                    \n                    s_nextMin_70319 = ((__global int16_t *) tS_mem_77626)[slice_70318];\n                    defunc_0_leq_res_70334 = sle16(r_min_70265, s_nextMin_70319);\n                    zgze_lhs_70335 = add64((int64_t) 1, fm_70284);\n                    tmp_f_res_70336 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zgze_lhs_70335);\n                    x_70337 = !defunc_0_leq_res_70334;\n                    y_70338 = tmp_f_res_70336 && x_70337;\n                    tmp_70339 = defunc_0_leq_res_70334 || y_70338;\n                    loopres_t_res_f_res_70340 = !tmp_70339;\n                    loopres_t_res_70332 = loopres_t_res_f_res_70340;\n                    loopres_t_res_70333 = zgze_lhs_70335;\n                }\n                loopres_70329 = loopres_t_res_70332;\n                loopres_70330 = loopres_t_res_70333;\n            } else {\n                int16_t s_prevMax_70327;\n                bool defunc_0_leq_res_70341;\n                int64_t zlze_lhs_70342;\n                bool tmp_f_res_70343;\n                bool x_70344;\n                bool y_70345;\n                bool tmp_70346;\n                int64_t max_res_70347;\n                bool loopres_f_res_70348;\n                \n                s_prevMax_70327 = ((__global int16_t *) tS_mem_77626)[slice_70326];\n                defunc_0_leq_res_70341 = sle16(s_prevMax_70327, r_min_70265);\n                zlze_lhs_70342 = sub64(fm_70284, (int64_t) 1);\n                tmp_f_res_70343 = sle64(zlze_lhs_70342, (int64_t) 0);\n                x_70344 = !defunc_0_leq_res_70341;\n                y_70345 = tmp_f_res_7034",
                                    "3 && x_70344;\n                tmp_70346 = defunc_0_leq_res_70341 || y_70345;\n                max_res_70347 = smax64((int64_t) 0, zlze_lhs_70342);\n                loopres_f_res_70348 = !tmp_70346;\n                loopres_70329 = loopres_f_res_70348;\n                loopres_70330 = max_res_70347;\n            }\n            loop_while_tmp_78903 = loopres_70329;\n            fm_tmp_78904 = loopres_70330;\n            loop_while_70283 = loop_while_tmp_78903;\n            fm_70284 = fm_tmp_78904;\n        }\n        defunc_0_f_res_70281 = loop_while_70283;\n        defunc_0_f_res_70282 = fm_70284;\n        loop_while_70352 = 1;\n        lm_70353 = gtid_70256;\n        while (loop_while_70352) {\n            bool x_70354;\n            bool y_70355;\n            bool bounds_check_70356;\n            bool index_certs_70357;\n            int64_t loopres_70358;\n            int64_t min_res_70359;\n            bool x_70360;\n            bool y_70361;\n            bool bounds_check_70362;\n            bool index_certs_70363;\n            bool cond_70366;\n            int64_t si_next_70367;\n            int64_t max_arg1_70374;\n            int64_t max_res_70375;\n            bool x_70376;\n            bool y_70377;\n            bool bounds_check_70378;\n            bool index_certs_70379;\n            int64_t min_res_70382;\n            bool x_70383;\n            bool y_70384;\n            bool bounds_check_70385;\n            bool index_certs_70386;\n            int64_t max_arg1_70389;\n            int64_t max_res_70390;\n            bool x_70391;\n            bool y_70392;\n            bool bounds_check_70393;\n            bool index_certs_70394;\n            int64_t slice_70364;\n            int64_t slice_70380;\n            int16_t s_max_70381;\n            int64_t slice_70387;\n            int64_t slice_70395;\n            bool defunc_0_gt_res_70397;\n            bool loopres_70398;\n            int64_t loopres_70399;\n            bool loop_cond_t_res_70414;\n            bool x_70415;\n            bool loop_while_tmp_78905;", "\n            int64_t lm_tmp_78906;\n            \n            x_70354 = sle64((int64_t) 0, lm_70353);\n            y_70355 = slt64(lm_70353, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            bounds_check_70356 = x_70354 && y_70355;\n            if (!bounds_check_70356) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 164) == -1) {\n                        global_failure_args[0] = (int64_t) lm_70353;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_70358 = ((__global int64_t *) mem_77646)[lm_70353];\n            min_res_70359 = smin64(gt_rhs_66981, loopres_70358);\n            x_70360 = sle64((int64_t) 0, min_res_70359);\n            y_70361 = slt64(min_res_70359, nR_39348);\n            bounds_check_70362 = x_70360 && y_70361;\n            if (!bounds_check_70362) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 165) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70359;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_70366 = sle64(zeze_rhs_67414, lm_70353);\n            if (cond_70366) {\n                si_next_70367 = nR_39348;\n            } else {\n                int64_t tmp_70368;\n                bool x_70369;\n                bool y_70370;\n                bool bounds_check_70371;\n                bool index_certs_70372;\n                int64_t si_next_f_res_70373;\n                \n                tmp_70368 = add64((int64_t) 1, lm_70353);\n                x_70369 = sle64((int64_t) 0, tmp_70368);\n                y_70370 = slt64(tmp_70368, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindo", "wsz7dUzg_67140);\n                bounds_check_70371 = x_70369 && y_70370;\n                if (!bounds_check_70371) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 166) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_70368;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_70373 = ((__global int64_t *) mem_77646)[tmp_70368];\n                si_next_70367 = si_next_f_res_70373;\n            }\n            max_arg1_70374 = sub64(si_next_70367, (int64_t) 1);\n            max_res_70375 = smax64(min_res_70359, max_arg1_70374);\n            x_70376 = sle64((int64_t) 0, max_res_70375);\n            y_70377 = slt64(max_res_70375, nR_39348);\n            bounds_check_70378 = x_70376 && y_70377;\n            if (!bounds_check_70378) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 167) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70375;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_70382 = smin64(zeze_rhs_67414, si_next_70367);\n            x_70383 = sle64((int64_t) 0, min_res_70382);\n            y_70384 = slt64(min_res_70382, nR_39348);\n            bounds_check_70385 = x_70383 && y_70384;\n            if (!bounds_check_70385) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 168) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70382;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n           ",
                                    "     }\n            }\n            max_arg1_70389 = sub64(min_res_70359, (int64_t) 1);\n            max_res_70390 = smax64((int64_t) 0, max_arg1_70389);\n            x_70391 = sle64((int64_t) 0, max_res_70390);\n            y_70392 = slt64(max_res_70390, nR_39348);\n            bounds_check_70393 = x_70391 && y_70392;\n            if (!bounds_check_70393) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 169) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70390;\n                        global_failure_args[1] = (int64_t) nR_39348;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_70364 = tS_start_66998 + min_res_70359;\n            slice_70380 = tS_start_66998 + max_res_70375;\n            s_max_70381 = ((__global int16_t *) tS_mem_77626)[slice_70380];\n            slice_70387 = tS_start_66998 + min_res_70382;\n            slice_70395 = tS_start_66998 + max_res_70390;\n            defunc_0_gt_res_70397 = slt16(r_max_70280, s_max_70381);\n            if (defunc_0_gt_res_70397) {\n                int16_t s_min_70365;\n                bool defunc_0_leq_res_70400;\n                bool loopres_t_res_70401;\n                int64_t loopres_t_res_70402;\n                \n                s_min_70365 = ((__global int16_t *) tS_mem_77626)[slice_70364];\n                defunc_0_leq_res_70400 = sle16(s_min_70365, r_max_70280);\n                if (defunc_0_leq_res_70400) {\n                    loopres_t_res_70401 = 0;\n                    loopres_t_res_70402 = lm_70353;\n                } else {\n                    int16_t s_prevMax_70396;\n                    bool defunc_0_leq_res_70403;\n                    int64_t zlze_lhs_70404;\n                    bool tmp_f_res_70405;\n                    bool x_70406;\n                    bool y_70407;\n                    bool tmp_70408;\n                    int64_t max_res_70409;\n                    bool loopres_t_res_f_", "res_70410;\n                    \n                    s_prevMax_70396 = ((__global int16_t *) tS_mem_77626)[slice_70395];\n                    defunc_0_leq_res_70403 = sle16(s_prevMax_70396, r_max_70280);\n                    zlze_lhs_70404 = sub64(lm_70353, (int64_t) 1);\n                    tmp_f_res_70405 = sle64(zlze_lhs_70404, (int64_t) 0);\n                    x_70406 = !defunc_0_leq_res_70403;\n                    y_70407 = tmp_f_res_70405 && x_70406;\n                    tmp_70408 = defunc_0_leq_res_70403 || y_70407;\n                    max_res_70409 = smax64((int64_t) 0, zlze_lhs_70404);\n                    loopres_t_res_f_res_70410 = !tmp_70408;\n                    loopres_t_res_70401 = loopres_t_res_f_res_70410;\n                    loopres_t_res_70402 = max_res_70409;\n                }\n                loopres_70398 = loopres_t_res_70401;\n                loopres_70399 = loopres_t_res_70402;\n            } else {\n                int16_t s_nextMin_70388;\n                bool defunc_0_leq_res_70411;\n                int64_t tmp_70412;\n                bool loopres_f_res_70413;\n                \n                s_nextMin_70388 = ((__global int16_t *) tS_mem_77626)[slice_70387];\n                defunc_0_leq_res_70411 = sle16(r_max_70280, s_nextMin_70388);\n                tmp_70412 = add64((int64_t) 1, lm_70353);\n                loopres_f_res_70413 = !defunc_0_leq_res_70411;\n                loopres_70398 = loopres_f_res_70413;\n                loopres_70399 = tmp_70412;\n            }\n            loop_cond_t_res_70414 = slt64(loopres_70399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);\n            x_70415 = loopres_70398 && loop_cond_t_res_70414;\n            loop_while_tmp_78905 = x_70415;\n            lm_tmp_78906 = loopres_70399;\n            loop_while_70352 = loop_while_tmp_78905;\n            lm_70353 = lm_tmp_78906;\n        }\n        defunc_0_f_res_70350 = loop_while_70352;\n        defunc_0_f_res_70351 = lm_70353;\n        ((__global int64_t *) mem_7", "7680)[gtid_70256] = defunc_0_f_res_70282;\n        ((__global int64_t *) mem_77682)[gtid_70256] = defunc_0_f_res_70351;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70252\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70609_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70609(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77861, int64_t ext_77862, __global unsigned char *mem_param_77698, __global unsigned char *ext_mem_77865, __global unsigned char *mem_77869)\n{\n    #define segmap_tblock_sizze_70605 (inner_SMJ_shortzisegmap_70609zisegmap_tblock_sizze_70605)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79018;\n    int32_t tblock_sizze_79021;\n    int32_t wave_sizze_79020;\n    int32_t block_id_79019;\n    int32_t global_tid_79017;\n    int64_t phys_tid_70609;\n    int64_t global_tid_79022;\n    int64_t slice_79023;\n    int64_t gtid_70608;\n    int64_t remnant_79024;\n    \n    local_tid_79018 = get_local_id(0);\n    tblock_sizze_79021 = get_local_size(0);\n    wave_sizze_79020 = LOCKSTEP_WIDTH;\n    block_id_79019 = get_tblock_id(0);\n    global_tid_79017 = block_id_79019 * tblock_sizze_79021 + local_tid_79018;\n    phys_tid_70609 = sext_i32_i64(global_tid_79017);\n    global_tid_79022 = sext_i32_i64(block_id_79019) * segmap_tblock_sizze_70605 + sext_i32_i64(local_tid_79018);\n    slice_79023 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_70608 = global_tid_79022;\n    remnant_79024 = global_tid_79022 - gtid_70608;\n    if (slt64(gtid_70608, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_70610;\n        bool cond_70612;\n        int64_t lifted_lambda_res_70613;\n        \n        eta_p_70610 = ((__global int64_t *) mem_param_77698)[gtid_70608];\n        cond_70612 = slt64(eta_p_70610, (int64_t) 0);\n        if (cond_70612) {\n            int64_t eta_p_70611 = ((__global int64_t *) ext_mem_77865)[ext_77862 + gtid_70608 * ext_77861];\n            \n            lifted_lamb",
                                    "da_res_70613 = eta_p_70611;\n        } else {\n            lifted_lambda_res_70613 = eta_p_70610;\n        }\n        ((__global int64_t *) mem_77869)[gtid_70608] = lifted_lambda_res_70613;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70605\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70630_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70630(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ext_77863, int64_t ext_77864, __global unsigned char *mem_param_77695, __global unsigned char *ext_mem_77866, __global unsigned char *mem_77872)\n{\n    #define segmap_tblock_sizze_70626 (inner_SMJ_shortzisegmap_70630zisegmap_tblock_sizze_70626)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79027;\n    int32_t tblock_sizze_79030;\n    int32_t wave_sizze_79029;\n    int32_t block_id_79028;\n    int32_t global_tid_79026;\n    int64_t phys_tid_70630;\n    int64_t global_tid_79031;\n    int64_t slice_79032;\n    int64_t gtid_70629;\n    int64_t remnant_79033;\n    \n    local_tid_79027 = get_local_id(0);\n    tblock_sizze_79030 = get_local_size(0);\n    wave_sizze_79029 = LOCKSTEP_WIDTH;\n    block_id_79028 = get_tblock_id(0);\n    global_tid_79026 = block_id_79028 * tblock_sizze_79030 + local_tid_79027;\n    phys_tid_70630 = sext_i32_i64(global_tid_79026);\n    global_tid_79031 = sext_i32_i64(block_id_79028) * segmap_tblock_sizze_70626 + sext_i32_i64(local_tid_79027);\n    slice_79032 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_70629 = global_tid_79031;\n    remnant_79033 = global_tid_79031 - gtid_70629;\n    if (slt64(gtid_70629, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t eta_p_70631;\n        int64_t eta_p_70632;\n        int64_t defunc_0_f_res_70633;\n        \n        eta_p_70631 = ((__global int64_t *) mem_param_77695)[gtid_70629];\n        eta_p_70632 = ((__global int64_t *) ext_mem_77866)[ext_77864 + gtid_70629 * ext_77863];\n        defunc_0_f_res_70633 = add64(eta_p_70631, eta_p_7063", "2);\n        ((__global int64_t *) mem_77872)[gtid_70629] = defunc_0_f_res_70633;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70626\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70651_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70651(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77686, int64_t ctx_param_ext_77687, __global unsigned char *mem_param_77688, __global unsigned char *ext_mem_77877, __global unsigned char *mem_77881)\n{\n    #define segmap_tblock_sizze_70647 (inner_SMJ_shortzisegmap_70651zisegmap_tblock_sizze_70647)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79036;\n    int32_t tblock_sizze_79039;\n    int32_t wave_sizze_79038;\n    int32_t block_id_79037;\n    int32_t global_tid_79035;\n    int64_t phys_tid_70651;\n    int64_t global_tid_79040;\n    int64_t slice_79041;\n    int64_t gtid_70650;\n    int64_t remnant_79042;\n    \n    local_tid_79036 = get_local_id(0);\n    tblock_sizze_79039 = get_local_size(0);\n    wave_sizze_79038 = LOCKSTEP_WIDTH;\n    block_id_79037 = get_tblock_id(0);\n    global_tid_79035 = block_id_79037 * tblock_sizze_79039 + local_tid_79036;\n    phys_tid_70651 = sext_i32_i64(global_tid_79035);\n    global_tid_79040 = sext_i32_i64(block_id_79037) * segmap_tblock_sizze_70647 + sext_i32_i64(local_tid_79036);\n    slice_79041 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_70650 = global_tid_79040;\n    remnant_79042 = global_tid_79040 - gtid_70650;\n    if (slt64(gtid_70650, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76049;\n        int64_t eta_p_70652;\n        bool cond_70654;\n        int64_t lifted_lambda_res_70655;\n        \n        slice_76049 = loopres_f_res_f_res_67593 + gtid_70650;\n        eta_p_70652 = ((__global int64_t *) mem_param_77688)[ctx_param_ext_77686 + slice_76049 * ctx_param_ext_77687];\n        cond_70654 = slt64(eta_p_70652, (int64_t) 0);\n        if (cond_", "70654) {\n            int64_t eta_p_70653 = ((__global int64_t *) ext_mem_77877)[gtid_70650];\n            \n            lifted_lambda_res_70655 = eta_p_70653;\n        } else {\n            lifted_lambda_res_70655 = eta_p_70652;\n        }\n        ((__global int64_t *) mem_77881)[gtid_70650] = lifted_lambda_res_70655;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70647\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70672_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70672(__global int *global_failure, int64_t loopres_f_res_f_res_67593, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, int64_t ctx_param_ext_77683, int64_t ctx_param_ext_77684, __global unsigned char *mem_param_77685, __global unsigned char *ext_mem_77878, __global unsigned char *mem_77884)\n{\n    #define segmap_tblock_sizze_70668 (inner_SMJ_shortzisegmap_70672zisegmap_tblock_sizze_70668)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79045;\n    int32_t tblock_sizze_79048;\n    int32_t wave_sizze_79047;\n    int32_t block_id_79046;\n    int32_t global_tid_79044;\n    int64_t phys_tid_70672;\n    int64_t global_tid_79049;\n    int64_t slice_79050;\n    int64_t gtid_70671;\n    int64_t remnant_79051;\n    \n    local_tid_79045 = get_local_id(0);\n    tblock_sizze_79048 = get_local_size(0);\n    wave_sizze_79047 = LOCKSTEP_WIDTH;\n    block_id_79046 = get_tblock_id(0);\n    global_tid_79044 = block_id_79046 * tblock_sizze_79048 + local_tid_79045;\n    phys_tid_70672 = sext_i32_i64(global_tid_79044);\n    global_tid_79049 = sext_i32_i64(block_id_79046) * segmap_tblock_sizze_70668 + sext_i32_i64(local_tid_79045);\n    slice_79050 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;\n    gtid_70671 = global_tid_79049;\n    remnant_79051 = global_tid_79049 - gtid_70671;\n    if (slt64(gtid_70671, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608)) {\n        int64_t slice_76048;\n        int64_t eta_p_70673;\n        int64_t eta_p_70674;\n        int64_t defunc_0_f_res_70675;\n        \n        slice_760",
                                    "48 = loopres_f_res_f_res_67593 + gtid_70671;\n        eta_p_70673 = ((__global int64_t *) mem_param_77685)[ctx_param_ext_77683 + slice_76048 * ctx_param_ext_77684];\n        eta_p_70674 = ((__global int64_t *) ext_mem_77878)[gtid_70671];\n        defunc_0_f_res_70675 = add64(eta_p_70673, eta_p_70674);\n        ((__global int64_t *) mem_77884)[gtid_70671] = defunc_0_f_res_70675;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70668\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70693_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70693(__global int *global_failure, int64_t nR_39348, int64_t ext_78072, int64_t ext_78073, __global unsigned char *mem_param_77640, __global unsigned char *ext_mem_78074, __global unsigned char *mem_78080)\n{\n    #define segmap_tblock_sizze_70689 (inner_SMJ_shortzisegmap_70693zisegmap_tblock_sizze_70689)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79054;\n    int32_t tblock_sizze_79057;\n    int32_t wave_sizze_79056;\n    int32_t block_id_79055;\n    int32_t global_tid_79053;\n    int64_t phys_tid_70693;\n    int64_t global_tid_79058;\n    int64_t slice_79059;\n    int64_t gtid_70692;\n    int64_t remnant_79060;\n    \n    local_tid_79054 = get_local_id(0);\n    tblock_sizze_79057 = get_local_size(0);\n    wave_sizze_79056 = LOCKSTEP_WIDTH;\n    block_id_79055 = get_tblock_id(0);\n    global_tid_79053 = block_id_79055 * tblock_sizze_79057 + local_tid_79054;\n    phys_tid_70693 = sext_i32_i64(global_tid_79053);\n    global_tid_79058 = sext_i32_i64(block_id_79055) * segmap_tblock_sizze_70689 + sext_i32_i64(local_tid_79054);\n    slice_79059 = nR_39348;\n    gtid_70692 = global_tid_79058;\n    remnant_79060 = global_tid_79058 - gtid_70692;\n    if (slt64(gtid_70692, nR_39348)) {\n        int64_t eta_p_70694;\n        bool cond_70696;\n        int64_t lifted_lambda_res_70697;\n        \n        eta_p_70694 = ((__global int64_t *) mem_param_77640)[gtid_70692];\n        cond_70696 = slt64(eta_p_70694, (int64_t) 0);\n        if (cond_70696)", " {\n            int64_t eta_p_70695 = ((__global int64_t *) ext_mem_78074)[ext_78073 + gtid_70692 * ext_78072];\n            \n            lifted_lambda_res_70697 = eta_p_70695;\n        } else {\n            lifted_lambda_res_70697 = eta_p_70694;\n        }\n        ((__global int64_t *) mem_78080)[gtid_70692] = lifted_lambda_res_70697;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70689\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70714_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70714(__global int *global_failure, int64_t nR_39348, int64_t ext_78075, int64_t ext_78076, __global unsigned char *mem_param_77637, __global unsigned char *ext_mem_78077, __global unsigned char *mem_78083)\n{\n    #define segmap_tblock_sizze_70710 (inner_SMJ_shortzisegmap_70714zisegmap_tblock_sizze_70710)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79063;\n    int32_t tblock_sizze_79066;\n    int32_t wave_sizze_79065;\n    int32_t block_id_79064;\n    int32_t global_tid_79062;\n    int64_t phys_tid_70714;\n    int64_t global_tid_79067;\n    int64_t slice_79068;\n    int64_t gtid_70713;\n    int64_t remnant_79069;\n    \n    local_tid_79063 = get_local_id(0);\n    tblock_sizze_79066 = get_local_size(0);\n    wave_sizze_79065 = LOCKSTEP_WIDTH;\n    block_id_79064 = get_tblock_id(0);\n    global_tid_79062 = block_id_79064 * tblock_sizze_79066 + local_tid_79063;\n    phys_tid_70714 = sext_i32_i64(global_tid_79062);\n    global_tid_79067 = sext_i32_i64(block_id_79064) * segmap_tblock_sizze_70710 + sext_i32_i64(local_tid_79063);\n    slice_79068 = nR_39348;\n    gtid_70713 = global_tid_79067;\n    remnant_79069 = global_tid_79067 - gtid_70713;\n    if (slt64(gtid_70713, nR_39348)) {\n        int64_t eta_p_70715;\n        int64_t eta_p_70716;\n        int64_t defunc_0_f_res_70717;\n        \n        eta_p_70715 = ((__global int64_t *) mem_param_77637)[gtid_70713];\n        eta_p_70716 = ((__global int64_t *) ext_mem_78077)[ext_78076 + gtid_70713 * ext_78075];\n        defunc_0_f_res_7", "0717 = add64(eta_p_70715, eta_p_70716);\n        ((__global int64_t *) mem_78083)[gtid_70713] = defunc_0_f_res_70717;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70710\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70727_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70727(__global int *global_failure, int64_t nR_39348, int64_t m_67844, int64_t num_tblocks_70732, int32_t virt_num_tblocks_79220, __global unsigned char *tR_mem_77625, __global unsigned char *ext_mem_77627, __global unsigned char *ext_mem_78095, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *mem_78103, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109)\n{\n    #define segmap_tblock_sizze_70730 (inner_SMJ_shortzisegmap_70727zisegmap_tblock_sizze_70730)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79222;\n    int32_t tblock_sizze_79225;\n    int32_t wave_sizze_79224;\n    int32_t block_id_79223;\n    int32_t global_tid_79221;\n    int64_t phys_tid_70727;\n    int32_t phys_tblock_id_79226;\n    int32_t iterations_79227;\n    \n    local_tid_79222 = get_local_id(0);\n    tblock_sizze_79225 = get_local_size(0);\n    wave_sizze_79224 = LOCKSTEP_WIDTH;\n    block_id_79223 = get_tblock_id(0);\n    global_tid_79221 = block_id_79223 * tblock_sizze_79225 + local_tid_79222;\n    phys_tid_70727 = sext_i32_i64(global_tid_79221);\n    phys_tblock_id_79226 = get_tblock_id(0);\n    iterations_79227 = sdiv_up32(virt_num_tblocks_79220 - phys_tblock_id_79226, sext_i64_i32(num_tblocks_70732));\n    for (int32_t i_79228 = 0; i_79228 < iterations_79227; i_79228++) {\n        int32_t virt_tblock_id_79229;\n        int64_t global_tid_79230;\n        int64_t slice_79231;\n        int64_t write_i_70726;\n        int64_t remnant_79232;\n        \n        virt_tblock_id_79229 = phys_tblock_id_79226 + i_79228 * sext_i64_i32(num_tblocks_70732);\n        global_tid_79230 = sext_i32_",
                                    "i64(virt_tblock_id_79229) * segmap_tblock_sizze_70730 + sext_i32_i64(local_tid_79222);\n        slice_79231 = nR_39348;\n        write_i_70726 = global_tid_79230;\n        remnant_79232 = global_tid_79230 - write_i_70726;\n        if (slt64(write_i_70726, nR_39348)) {\n            int64_t eta_p_68109;\n            int16_t write_value_68111;\n            int64_t write_value_68112;\n            int64_t write_value_68113;\n            int64_t write_value_68114;\n            bool cond_68115;\n            int64_t lifted_lambda_res_68116;\n            \n            eta_p_68109 = ((__global int64_t *) mem_78101)[write_i_70726];\n            write_value_68111 = ((__global int16_t *) tR_mem_77625)[write_i_70726];\n            write_value_68112 = ((__global int64_t *) ext_mem_77627)[write_i_70726];\n            write_value_68113 = ((__global int64_t *) ext_mem_78095)[write_i_70726];\n            write_value_68114 = ((__global int64_t *) ext_mem_78096)[write_i_70726];\n            cond_68115 = eta_p_68109 == (int64_t) 1;\n            if (cond_68115) {\n                int64_t eta_p_68110;\n                int64_t lifted_lambda_res_t_res_68890;\n                \n                eta_p_68110 = ((__global int64_t *) mem_78099)[write_i_70726];\n                lifted_lambda_res_t_res_68890 = sub64(eta_p_68110, (int64_t) 1);\n                lifted_lambda_res_68116 = lifted_lambda_res_t_res_68890;\n            } else {\n                lifted_lambda_res_68116 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int16_t *) mem_78109)[lifted_lambda_res_68116] = write_value_68111;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78107)[lifted_lambda_res_68116] = write_value_68112;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_678", "44)) {\n                ((__global int64_t *) mem_78105)[lifted_lambda_res_68116] = write_value_68113;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68116) && slt64(lifted_lambda_res_68116, m_67844)) {\n                ((__global int64_t *) mem_78103)[lifted_lambda_res_68116] = write_value_68114;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_70730\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70761_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70761(__global int *global_failure, int64_t m_67844, __global unsigned char *mem_78113, __global unsigned char *mem_78120)\n{\n    #define segmap_tblock_sizze_70757 (inner_SMJ_shortzisegmap_70761zisegmap_tblock_sizze_70757)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79388;\n    int32_t tblock_sizze_79391;\n    int32_t wave_sizze_79390;\n    int32_t block_id_79389;\n    int32_t global_tid_79387;\n    int64_t phys_tid_70761;\n    int64_t global_tid_79392;\n    int64_t slice_79393;\n    int64_t gtid_70760;\n    int64_t remnant_79394;\n    \n    local_tid_79388 = get_local_id(0);\n    tblock_sizze_79391 = get_local_size(0);\n    wave_sizze_79390 = LOCKSTEP_WIDTH;\n    block_id_79389 = get_tblock_id(0);\n    global_tid_79387 = block_id_79389 * tblock_sizze_79391 + local_tid_79388;\n    phys_tid_70761 = sext_i32_i64(global_tid_79387);\n    global_tid_79392 = sext_i32_i64(block_id_79389) * segmap_tblock_sizze_70757 + sext_i32_i64(local_tid_79388);\n    slice_79393 = m_67844;\n    gtid_70760 = global_tid_79392;\n    remnant_79394 = global_tid_79392 - gtid_70760;\n    if (slt64(gtid_70760, m_67844)) {\n        int64_t zv_lhs_70763;\n        int64_t tmp_70764;\n        bool cond_70766;\n        int64_t lifted_lambda_res_70767;\n        \n        zv_lhs_70763 = add64((int64_t) -1, gtid_70760);\n        tmp_70764 = smod64(zv_lhs_70763, m_67844);\n        cond_70766 = gtid_70760 == (int64_t) 0;\n        if (cond_70766) {\n   ", "         lifted_lambda_res_70767 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_70765 = ((__global int64_t *) mem_78113)[tmp_70764];\n            \n            lifted_lambda_res_70767 = lifted_lambda_res_70765;\n        }\n        ((__global int64_t *) mem_78120)[gtid_70760] = lifted_lambda_res_70767;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70757\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70769_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70769(__global int *global_failure, int64_t m_67844, int64_t lower_bound_67927, int64_t min_res_67929, int64_t j_m_i_67930, int64_t num_tblocks_70774, int32_t virt_num_tblocks_79433, __global unsigned char *mem_78105, __global unsigned char *mem_78107, __global unsigned char *mem_78109, __global unsigned char *mem_78120, __global unsigned char *mem_78149, __global unsigned char *mem_78151, __global unsigned char *mem_78153)\n{\n    #define segmap_tblock_sizze_70772 (inner_SMJ_shortzisegmap_70769zisegmap_tblock_sizze_70772)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79435;\n    int32_t tblock_sizze_79438;\n    int32_t wave_sizze_79437;\n    int32_t block_id_79436;\n    int32_t global_tid_79434;\n    int64_t phys_tid_70769;\n    int32_t phys_tblock_id_79439;\n    int32_t iterations_79440;\n    \n    local_tid_79435 = get_local_id(0);\n    tblock_sizze_79438 = get_local_size(0);\n    wave_sizze_79437 = LOCKSTEP_WIDTH;\n    block_id_79436 = get_tblock_id(0);\n    global_tid_79434 = block_id_79436 * tblock_sizze_79438 + local_tid_79435;\n    phys_tid_70769 = sext_i32_i64(global_tid_79434);\n    phys_tblock_id_79439 = get_tblock_id(0);\n    iterations_79440 = sdiv_up32(virt_num_tblocks_79433 - phys_tblock_id_79439, sext_i64_i32(num_tblocks_70774));\n    for (int32_t i_79441 = 0; i_79441 < iterations_79440; i_79441++) {\n        int32_t virt_tblock_id_79442;\n        int64_t global_tid_79443;\n        int64_t slice_79444;\n        int64_t write_i_70768;\n        int64_t remnant_79445;\n    ",
                                    "    \n        virt_tblock_id_79442 = phys_tblock_id_79439 + i_79441 * sext_i64_i32(num_tblocks_70774);\n        global_tid_79443 = sext_i32_i64(virt_tblock_id_79442) * segmap_tblock_sizze_70772 + sext_i32_i64(local_tid_79435);\n        slice_79444 = m_67844;\n        write_i_70768 = global_tid_79443;\n        remnant_79445 = global_tid_79443 - write_i_70768;\n        if (slt64(write_i_70768, m_67844)) {\n            int64_t eta_p_68502;\n            int16_t write_value_68503;\n            int64_t write_value_68504;\n            int64_t write_value_68505;\n            bool cond_68506;\n            bool cond_t_res_68507;\n            bool x_68508;\n            int64_t lifted_lambda_res_68509;\n            \n            eta_p_68502 = ((__global int64_t *) mem_78120)[write_i_70768];\n            write_value_68503 = ((__global int16_t *) mem_78109)[write_i_70768];\n            write_value_68504 = ((__global int64_t *) mem_78107)[write_i_70768];\n            write_value_68505 = ((__global int64_t *) mem_78105)[write_i_70768];\n            cond_68506 = sle64(lower_bound_67927, eta_p_68502);\n            cond_t_res_68507 = slt64(eta_p_68502, min_res_67929);\n            x_68508 = cond_68506 && cond_t_res_68507;\n            if (x_68508) {\n                int64_t lifted_lambda_res_t_res_68893 = sub64(eta_p_68502, lower_bound_67927);\n                \n                lifted_lambda_res_68509 = lifted_lambda_res_t_res_68893;\n            } else {\n                lifted_lambda_res_68509 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int16_t *) mem_78149)[lifted_lambda_res_68509] = write_value_68503;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509) && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78151)[lifted_lambda_res_68509] = write_value_68504;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68509", ") && slt64(lifted_lambda_res_68509, j_m_i_67930)) {\n                ((__global int64_t *) mem_78153)[lifted_lambda_res_68509] = write_value_68505;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_70772\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70777_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70777(__global int *global_failure, int64_t m_67844, int64_t m_67984, int64_t num_tblocks_70782, int32_t virt_num_tblocks_79415, __global unsigned char *mem_78103, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *mem_78120, __global unsigned char *mem_78128, __global unsigned char *mem_78130)\n{\n    #define segmap_tblock_sizze_70780 (inner_SMJ_shortzisegmap_70777zisegmap_tblock_sizze_70780)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79417;\n    int32_t tblock_sizze_79420;\n    int32_t wave_sizze_79419;\n    int32_t block_id_79418;\n    int32_t global_tid_79416;\n    int64_t phys_tid_70777;\n    int32_t phys_tblock_id_79421;\n    int32_t iterations_79422;\n    \n    local_tid_79417 = get_local_id(0);\n    tblock_sizze_79420 = get_local_size(0);\n    wave_sizze_79419 = LOCKSTEP_WIDTH;\n    block_id_79418 = get_tblock_id(0);\n    global_tid_79416 = block_id_79418 * tblock_sizze_79420 + local_tid_79417;\n    phys_tid_70777 = sext_i32_i64(global_tid_79416);\n    phys_tblock_id_79421 = get_tblock_id(0);\n    iterations_79422 = sdiv_up32(virt_num_tblocks_79415 - phys_tblock_id_79421, sext_i64_i32(num_tblocks_70782));\n    for (int32_t i_79423 = 0; i_79423 < iterations_79422; i_79423++) {\n        int32_t virt_tblock_id_79424;\n        int64_t global_tid_79425;\n        int64_t slice_79426;\n        int64_t write_i_70776;\n        int64_t remnant_79427;\n        \n        virt_tblock_id_79424 = phys_tblock_id_79421 + i_79423 * sext_i64_i32(num_tblocks_70782);\n        global_tid_79425 = sext_i32_i64(virt_tblock_id_79424) * segmap_tblock", "_sizze_70780 + sext_i32_i64(local_tid_79417);\n        slice_79426 = m_67844;\n        write_i_70776 = global_tid_79425;\n        remnant_79427 = global_tid_79425 - write_i_70776;\n        if (slt64(write_i_70776, m_67844)) {\n            int64_t eta_p_68086;\n            int64_t write_value_68088;\n            int64_t write_value_68089;\n            bool cond_68090;\n            int64_t lifted_lambda_res_68091;\n            \n            eta_p_68086 = ((__global int64_t *) mem_78117)[write_i_70776];\n            write_value_68088 = ((__global int64_t *) mem_78120)[write_i_70776];\n            write_value_68089 = ((__global int64_t *) mem_78103)[write_i_70776];\n            cond_68090 = eta_p_68086 == (int64_t) 1;\n            if (cond_68090) {\n                int64_t eta_p_68087;\n                int64_t lifted_lambda_res_t_res_68898;\n                \n                eta_p_68087 = ((__global int64_t *) mem_78115)[write_i_70776];\n                lifted_lambda_res_t_res_68898 = sub64(eta_p_68087, (int64_t) 1);\n                lifted_lambda_res_68091 = lifted_lambda_res_t_res_68898;\n            } else {\n                lifted_lambda_res_68091 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78130)[lifted_lambda_res_68091] = write_value_68088;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_68091) && slt64(lifted_lambda_res_68091, m_67984)) {\n                ((__global int64_t *) mem_78128)[lifted_lambda_res_68091] = write_value_68089;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_70780\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_70799_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_70799(__global int *global_failure, int64_t loopres_68028, int64_t loopres_68029, __global unsigned char *mem_78178, __global unsigned char *mem_78181)\n{\n    #de",
                                    "fine segmap_tblock_sizze_70795 (inner_SMJ_shortzisegmap_70799zisegmap_tblock_sizze_70795)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79502;\n    int32_t tblock_sizze_79505;\n    int32_t wave_sizze_79504;\n    int32_t block_id_79503;\n    int32_t global_tid_79501;\n    int64_t phys_tid_70799;\n    int64_t global_tid_79506;\n    int64_t slice_79507;\n    int64_t gtid_70798;\n    int64_t remnant_79508;\n    \n    local_tid_79502 = get_local_id(0);\n    tblock_sizze_79505 = get_local_size(0);\n    wave_sizze_79504 = LOCKSTEP_WIDTH;\n    block_id_79503 = get_tblock_id(0);\n    global_tid_79501 = block_id_79503 * tblock_sizze_79505 + local_tid_79502;\n    phys_tid_70799 = sext_i32_i64(global_tid_79501);\n    global_tid_79506 = sext_i32_i64(block_id_79503) * segmap_tblock_sizze_70795 + sext_i32_i64(local_tid_79502);\n    slice_79507 = loopres_68029;\n    gtid_70798 = global_tid_79506;\n    remnant_79508 = global_tid_79506 - gtid_70798;\n    if (slt64(gtid_70798, loopres_68029)) {\n        int64_t loopres_77620;\n        int64_t tmp_70801;\n        \n        loopres_77620 = ((__global int64_t *) mem_78181)[(int64_t) 0];\n        tmp_70801 = add64(gtid_70798, loopres_77620);\n        ((__global int64_t *) mem_78178)[loopres_68028 + gtid_70798] = tmp_70801;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70795\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_76057_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_76057(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76060, int64_t num_whole_tiles_76075, int64_t residual_input_76299, unsigned char cond_76300_bits, int64_t binop_x_76316, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_78045, __global unsigned char *mem_78047)\n{\n    bool cond_76300 = cond_76300_bits;\n    \n    #define til", "e_sizze_76059 (inner_SMJ_shortzisegmap_intrablock_76057zitile_sizze_76059)\n    #define bytes_78007 (inner_SMJ_shortzisegmap_intrablock_76057zibytes_78007)\n    #define bytes_78009 (inner_SMJ_shortzisegmap_intrablock_76057zibytes_78009)\n    \n    volatile __local unsigned char *color_78690_backing_2 = &shared_mem[0];\n    const int64_t color_78690_backing_2_offset = 0 + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78689_backing_1 = &shared_mem[color_78690_backing_2_offset];\n    const int64_t color_78689_backing_1_offset = color_78690_backing_2_offset + (bytes_78009 + srem64((int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78688_backing_0 = &shared_mem[color_78689_backing_1_offset];\n    const int64_t color_78688_backing_0_offset = color_78689_backing_1_offset + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78799;\n    int32_t tblock_sizze_78802;\n    int32_t wave_sizze_78801;\n    int32_t block_id_78800;\n    int32_t global_tid_78798;\n    int64_t gid_flat_76057;\n    int64_t slice_78804;\n    int64_t ltid_pre_78803;\n    int64_t remnant_78805;\n    int64_t slice_78806;\n    int64_t gid_76056;\n    int64_t remnant_78807;\n    __local unsigned char *color_78688;\n    __local unsigned char *color_78689;\n    __local unsigned char *color_78690;\n    int64_t binop_x_76067;\n    int16_t mem_77991[1];\n    int64_t ltid_flat_76062;\n    int64_t ltid_76061;\n    int64_t gtid_76068;\n    bool cond_76069;\n    int16_t pre_76070;\n    int64_t mem_77995[1];\n    int16_t mem_77999[1];\n    int64_t mem_78003[1];\n    int64_t ltid_flat_76077;\n    int64_t ltid_76076;\n    int64_t gtid_76087;\n    bool cond_76088;\n    int64_t neutral_76089;\n    int16_t neutral_76090;\n    int64_t ext_mem_78027[1];\n    int16_t ext_mem_78026[1];\n    int64_t ext_mem_78025[1];\n    int6", "4_t mem_param_78004[1];\n    int16_t mem_param_78005[1];\n    int64_t mem_param_78006[1];\n    int64_t mem_78037[1];\n    int64_t mem_78041[1];\n    int64_t ext_mem_78043[1];\n    int64_t ext_mem_78042[1];\n    \n    local_tid_78799 = get_local_id(0);\n    tblock_sizze_78802 = get_local_size(0);\n    wave_sizze_78801 = LOCKSTEP_WIDTH;\n    block_id_78800 = get_tblock_id(0);\n    global_tid_78798 = block_id_78800 * tblock_sizze_78802 + local_tid_78799;\n    gid_flat_76057 = sext_i32_i64(block_id_78800);\n    slice_78804 = tile_sizze_76059;\n    ltid_pre_78803 = sext_i32_i64(local_tid_78799);\n    remnant_78805 = sext_i32_i64(local_tid_78799) - ltid_pre_78803;\n    slice_78806 = ldim_76060;\n    gid_76056 = sext_i32_i64(block_id_78800);\n    remnant_78807 = sext_i32_i64(block_id_78800) - gid_76056;\n    color_78688 = (__local unsigned char *) color_78688_backing_0;\n    color_78689 = (__local unsigned char *) color_78689_backing_1;\n    color_78690 = (__local unsigned char *) color_78690_backing_2;\n    binop_x_76067 = gid_76056 * tile_sizze_76059;\n    ltid_flat_76062 = sext_i32_i64(local_tid_78799);\n    ltid_76061 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76068 = ltid_76061 + binop_x_76067;\n    cond_76069 = slt64(gtid_76068, min_res_68560);\n    if (cond_76069) {\n        int64_t slice_76071;\n        int16_t eta_p_76072;\n        \n        slice_76071 = start_68558 + gtid_76068;\n        eta_p_76072 = ((__global int16_t *) tR_mem_77625)[slice_76071];\n        pre_76070 = eta_p_76072;\n    } else {\n        pre_76070 = (int16_t) 0;\n    }\n    mem_77991[(int64_t) 0] = pre_76070;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76077 = sext_i32_i64(local_tid_78799);\n    ltid_76076 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n    gtid_76087 = binop_x_76067 + ltid_76076;\n    cond_76088 = slt64(gtid_76087, min_res_68560);\n    if (cond_76088) {\n        neutral_76089 = (int64_t) -1;\n    } else {\n        neutral_76089 = (int64_t) 0;\n    }\n    if (cond_76088) {\n        int16_t eta_p_76092 = mem_",
                                    "77991[(int64_t) 0];\n        \n        neutral_76090 = eta_p_76092;\n    } else {\n        neutral_76090 = (int16_t) 0;\n    }\n    mem_77995[(int64_t) 0] = neutral_76089;\n    mem_77999[(int64_t) 0] = neutral_76090;\n    mem_78003[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_78004[i_3] = mem_77995[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_78005[i_4] = mem_77999[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_78006[i_5] = mem_78003[i_5];\n    for (int64_t tile_id_76102 = 0; tile_id_76102 < num_whole_tiles_76075; tile_id_76102++) {\n        int64_t binop_x_76201;\n        int64_t ltid_flat_76200;\n        int64_t ltid_76199;\n        int64_t j_76202;\n        bool cond_76206;\n        int64_t pre1d_76209;\n        int64_t pre1d_76207;\n        int16_t pre1d_76208;\n        int64_t mem_78016[1];\n        int16_t mem_78020[1];\n        int64_t mem_78024[1];\n        int64_t ltid_flat_76220;\n        int64_t ltid_76219;\n        int64_t gtid_76222;\n        int64_t acc_76224;\n        int16_t acc_76225;\n        int64_t acc_76226;\n        bool cond_76227;\n        int64_t acc_76228;\n        int16_t acc_76229;\n        int64_t acc_76230;\n        int64_t mem_param_tmp_78808[1];\n        int16_t mem_param_tmp_78809[1];\n        int64_t mem_param_tmp_78810[1];\n        \n        binop_x_76201 = tile_sizze_76059 * tile_id_76102;\n        ltid_flat_76200 = sext_i32_i64(local_tid_78799);\n        ltid_76199 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76202 = ltid_76199 + binop_x_76201;\n        cond_76206 = slt64(j_76202, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76209 = btoi_bool_i64(cond_76206);\n        if (cond_76206) {\n            int64_t tile_elem_76210;\n            int64_t slice_77479;\n            int16_t tile_elem_76211;\n            \n            tile_elem_76210 = ((__global int64_t *) ext_mem_77925)[j_76202];\n           ", " slice_77479 = tS_start_66998 + j_76202;\n            tile_elem_76211 = ((__global int16_t *) tS_mem_77626)[slice_77479];\n            pre1d_76207 = tile_elem_76210;\n            pre1d_76208 = tile_elem_76211;\n        } else {\n            pre1d_76207 = (int64_t) 0;\n            pre1d_76208 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76199] = pre1d_76207;\n        ((__local int16_t *) color_78689)[ltid_76199] = pre1d_76208;\n        ((__local int64_t *) color_78688)[ltid_76199] = pre1d_76209;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76220 = sext_i32_i64(local_tid_78799);\n        ltid_76219 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76222 = binop_x_76067 + ltid_76219;\n        acc_76224 = mem_param_78004[(int64_t) 0];\n        acc_76225 = mem_param_78005[(int64_t) 0];\n        acc_76226 = mem_param_78006[(int64_t) 0];\n        cond_76227 = slt64(gtid_76222, min_res_68560);\n        if (cond_76227) {\n            int16_t eta_p_76223;\n            int64_t x_76231;\n            int16_t x_76232;\n            int64_t x_76233;\n            int64_t redout_77492;\n            int16_t redout_77493;\n            int64_t redout_77494;\n            \n            eta_p_76223 = mem_77991[(int64_t) 0];\n            redout_77492 = acc_76224;\n            redout_77493 = acc_76225;\n            redout_77494 = acc_76226;\n            for (int64_t i_77495 = 0; i_77495 < tile_sizze_76059; i_77495++) {\n                int64_t x_76234;\n                int16_t x_76235;\n                bool defunc_0_neq_res_76243;\n                bool defunc_0_neq_res_76244;\n                bool cond_f_res_76245;\n                bool y_76246;\n                bool cond_76247;\n                bool defunc_0_neq_res_76248;\n                bool defunc_0_neq_res_76249;\n                bool cond_t_res_f_res_76250;\n                bool y_76251;\n                bool cond_t_res_76252;\n                bool x_76253;\n                int64_t defunc_0_op_res_76254;\n                int16_t ", "defunc_0_op_res_76255;\n                int64_t defunc_0_op_res_76256;\n                int64_t redout_tmp_78814;\n                int16_t redout_tmp_78815;\n                int64_t redout_tmp_78816;\n                \n                x_76234 = ((__local int64_t *) color_78690)[i_77495];\n                x_76235 = ((__local int16_t *) color_78689)[i_77495];\n                defunc_0_neq_res_76243 = redout_77493 == eta_p_76223;\n                defunc_0_neq_res_76244 = !defunc_0_neq_res_76243;\n                cond_f_res_76245 = slt64(redout_77492, (int64_t) 0);\n                y_76246 = defunc_0_neq_res_76243 && cond_f_res_76245;\n                cond_76247 = defunc_0_neq_res_76244 || y_76246;\n                defunc_0_neq_res_76248 = x_76235 == eta_p_76223;\n                defunc_0_neq_res_76249 = !defunc_0_neq_res_76248;\n                cond_t_res_f_res_76250 = slt64(x_76234, (int64_t) 0);\n                y_76251 = defunc_0_neq_res_76248 && cond_t_res_f_res_76250;\n                cond_t_res_76252 = defunc_0_neq_res_76249 || y_76251;\n                x_76253 = cond_76247 && cond_t_res_76252;\n                if (x_76253) {\n                    defunc_0_op_res_76254 = (int64_t) -1;\n                    defunc_0_op_res_76255 = eta_p_76223;\n                    defunc_0_op_res_76256 = (int64_t) 0;\n                } else {\n                    int64_t x_76236;\n                    int64_t defunc_0_op_res_f_res_76257;\n                    int16_t defunc_0_op_res_f_res_76258;\n                    int64_t defunc_0_op_res_f_res_76259;\n                    \n                    x_76236 = ((__local int64_t *) color_78688)[i_77495];\n                    if (cond_76247) {\n                        defunc_0_op_res_f_res_76257 = x_76234;\n                        defunc_0_op_res_f_res_76258 = x_76235;\n                        defunc_0_op_res_f_res_76259 = x_76236;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_76260;\n                        int64_t defunc_0_op_res_f",
                                    "_res_f_res_76261;\n                        int64_t defunc_0_op_res_f_res_f_res_76262;\n                        \n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76260 = redout_77493;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76260 = eta_p_76223;\n                        }\n                        if (cond_t_res_76252) {\n                            defunc_0_op_res_f_res_f_res_76261 = redout_77492;\n                            defunc_0_op_res_f_res_f_res_76262 = redout_77494;\n                        } else {\n                            int64_t min_res_76263;\n                            int64_t tmp_76264;\n                            \n                            min_res_76263 = smin64(x_76234, redout_77492);\n                            tmp_76264 = add64(x_76236, redout_77494);\n                            defunc_0_op_res_f_res_f_res_76261 = min_res_76263;\n                            defunc_0_op_res_f_res_f_res_76262 = tmp_76264;\n                        }\n                        defunc_0_op_res_f_res_76257 = defunc_0_op_res_f_res_f_res_76261;\n                        defunc_0_op_res_f_res_76258 = defunc_0_op_res_f_res_f_res_76260;\n                        defunc_0_op_res_f_res_76259 = defunc_0_op_res_f_res_f_res_76262;\n                    }\n                    defunc_0_op_res_76254 = defunc_0_op_res_f_res_76257;\n                    defunc_0_op_res_76255 = defunc_0_op_res_f_res_76258;\n                    defunc_0_op_res_76256 = defunc_0_op_res_f_res_76259;\n                }\n                redout_tmp_78814 = defunc_0_op_res_76254;\n                redout_tmp_78815 = defunc_0_op_res_76255;\n                redout_tmp_78816 = defunc_0_op_res_76256;\n                redout_77492 = redout_tmp_78814;\n                redout_77493 = redout_tmp_78815;\n                redout_77494 = redout_tmp_78816;\n            }\n            x_76231 = redout_77492;\n            x_76232 = redout_77493;\n      ", "      x_76233 = redout_77494;\n            acc_76228 = x_76231;\n            acc_76229 = x_76232;\n            acc_76230 = x_76233;\n        } else {\n            acc_76228 = acc_76224;\n            acc_76229 = acc_76225;\n            acc_76230 = acc_76226;\n        }\n        mem_78016[(int64_t) 0] = acc_76228;\n        mem_78020[(int64_t) 0] = acc_76229;\n        mem_78024[(int64_t) 0] = acc_76230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78808[i_6] = mem_78016[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78809[i_7] = mem_78020[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78810[i_8] = mem_78024[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_78004[i_9] = mem_param_tmp_78808[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_78005[i_10] = mem_param_tmp_78809[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_78006[i_11] = mem_param_tmp_78810[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_78027[i_12] = mem_param_78004[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_78026[i_13] = mem_param_78005[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_78025[i_14] = mem_param_78006[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76300) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_78043[i_15] = ext_mem_78027[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_78042[i_16] = ext_mem_78025[i_16];\n    } else {\n        int64_t ltid_flat_76302;\n        int64_t ltid_76301;\n        int64_t j_76317;\n        bool cond_76321;\n        int64_t pre1d_76324;\n        int64_t pre1d_76322;\n        int16_t pre1d_76323;\n        int64_t ltid_flat_76338;\n        int64_t ltid_76337;\n        int64_t gtid_76351;\n        int64_t acc_76353;\n        int64_t acc_76355;\n        bool cond", "_76356;\n        int64_t acc_76357;\n        int64_t acc_76359;\n        \n        ltid_flat_76302 = sext_i32_i64(local_tid_78799);\n        ltid_76301 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        j_76317 = ltid_76301 + binop_x_76316;\n        cond_76321 = slt64(j_76317, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76324 = btoi_bool_i64(cond_76321);\n        if (cond_76321) {\n            int64_t tile_elem_76325;\n            int64_t slice_77478;\n            int16_t tile_elem_76326;\n            \n            tile_elem_76325 = ((__global int64_t *) ext_mem_77925)[j_76317];\n            slice_77478 = tS_start_66998 + j_76317;\n            tile_elem_76326 = ((__global int16_t *) tS_mem_77626)[slice_77478];\n            pre1d_76322 = tile_elem_76325;\n            pre1d_76323 = tile_elem_76326;\n        } else {\n            pre1d_76322 = (int64_t) 0;\n            pre1d_76323 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78690)[ltid_76301] = pre1d_76322;\n        ((__local int16_t *) color_78689)[ltid_76301] = pre1d_76323;\n        ((__local int64_t *) color_78688)[ltid_76301] = pre1d_76324;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76338 = sext_i32_i64(local_tid_78799);\n        ltid_76337 = sext_i32_i64(sext_i64_i32(ltid_pre_78803));\n        gtid_76351 = binop_x_76067 + ltid_76337;\n        acc_76353 = ext_mem_78027[(int64_t) 0];\n        acc_76355 = ext_mem_78025[(int64_t) 0];\n        cond_76356 = slt64(gtid_76351, min_res_68560);\n        if (cond_76356) {\n            int16_t eta_p_76352;\n            int16_t acc_76354;\n            int64_t x_76360;\n            int16_t x_76361;\n            int64_t x_76362;\n            int64_t redout_77496;\n            int16_t redout_77497;\n            int64_t redout_77498;\n            \n            eta_p_76352 = mem_77991[(int64_t) 0];\n            acc_76354 = ext_mem_78026[(int64_t) 0];\n            redout_77496 = acc_76353;\n            redout_77497 = acc_76354;\n            redout_77498 = acc_76355;\n     ",
                                    "       for (int64_t i_77499 = 0; i_77499 < residual_input_76299; i_77499++) {\n                int64_t x_76363;\n                int16_t x_76364;\n                bool defunc_0_neq_res_76372;\n                bool defunc_0_neq_res_76373;\n                bool cond_f_res_76374;\n                bool y_76375;\n                bool cond_76376;\n                bool defunc_0_neq_res_76377;\n                bool defunc_0_neq_res_76378;\n                bool cond_t_res_f_res_76379;\n                bool y_76380;\n                bool cond_t_res_76381;\n                bool x_76382;\n                int64_t defunc_0_op_res_76383;\n                int16_t defunc_0_op_res_76384;\n                int64_t defunc_0_op_res_76385;\n                int64_t redout_tmp_78817;\n                int16_t redout_tmp_78818;\n                int64_t redout_tmp_78819;\n                \n                x_76363 = ((__local int64_t *) color_78690)[i_77499];\n                x_76364 = ((__local int16_t *) color_78689)[i_77499];\n                defunc_0_neq_res_76372 = redout_77497 == eta_p_76352;\n                defunc_0_neq_res_76373 = !defunc_0_neq_res_76372;\n                cond_f_res_76374 = slt64(redout_77496, (int64_t) 0);\n                y_76375 = defunc_0_neq_res_76372 && cond_f_res_76374;\n                cond_76376 = defunc_0_neq_res_76373 || y_76375;\n                defunc_0_neq_res_76377 = x_76364 == eta_p_76352;\n                defunc_0_neq_res_76378 = !defunc_0_neq_res_76377;\n                cond_t_res_f_res_76379 = slt64(x_76363, (int64_t) 0);\n                y_76380 = defunc_0_neq_res_76377 && cond_t_res_f_res_76379;\n                cond_t_res_76381 = defunc_0_neq_res_76378 || y_76380;\n                x_76382 = cond_76376 && cond_t_res_76381;\n                if (x_76382) {\n                    defunc_0_op_res_76383 = (int64_t) -1;\n                    defunc_0_op_res_76384 = eta_p_76352;\n                    defunc_0_op_res_76385 = (int64_t) 0;\n                } else {\n                    int64_t x_7636", "5;\n                    int64_t defunc_0_op_res_f_res_76386;\n                    int16_t defunc_0_op_res_f_res_76387;\n                    int64_t defunc_0_op_res_f_res_76388;\n                    \n                    x_76365 = ((__local int64_t *) color_78688)[i_77499];\n                    if (cond_76376) {\n                        defunc_0_op_res_f_res_76386 = x_76363;\n                        defunc_0_op_res_f_res_76387 = x_76364;\n                        defunc_0_op_res_f_res_76388 = x_76365;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_76389;\n                        int64_t defunc_0_op_res_f_res_f_res_76390;\n                        int64_t defunc_0_op_res_f_res_f_res_76391;\n                        \n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76389 = redout_77497;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76389 = eta_p_76352;\n                        }\n                        if (cond_t_res_76381) {\n                            defunc_0_op_res_f_res_f_res_76390 = redout_77496;\n                            defunc_0_op_res_f_res_f_res_76391 = redout_77498;\n                        } else {\n                            int64_t min_res_76392;\n                            int64_t tmp_76393;\n                            \n                            min_res_76392 = smin64(x_76363, redout_77496);\n                            tmp_76393 = add64(x_76365, redout_77498);\n                            defunc_0_op_res_f_res_f_res_76390 = min_res_76392;\n                            defunc_0_op_res_f_res_f_res_76391 = tmp_76393;\n                        }\n                        defunc_0_op_res_f_res_76386 = defunc_0_op_res_f_res_f_res_76390;\n                        defunc_0_op_res_f_res_76387 = defunc_0_op_res_f_res_f_res_76389;\n                        defunc_0_op_res_f_res_76388 = defunc_0_op_res_f_res_f_res_76391;\n                    }\n         ", "           defunc_0_op_res_76383 = defunc_0_op_res_f_res_76386;\n                    defunc_0_op_res_76384 = defunc_0_op_res_f_res_76387;\n                    defunc_0_op_res_76385 = defunc_0_op_res_f_res_76388;\n                }\n                redout_tmp_78817 = defunc_0_op_res_76383;\n                redout_tmp_78818 = defunc_0_op_res_76384;\n                redout_tmp_78819 = defunc_0_op_res_76385;\n                redout_77496 = redout_tmp_78817;\n                redout_77497 = redout_tmp_78818;\n                redout_77498 = redout_tmp_78819;\n            }\n            x_76360 = redout_77496;\n            x_76361 = redout_77497;\n            x_76362 = redout_77498;\n            acc_76357 = x_76360;\n            acc_76359 = x_76362;\n        } else {\n            acc_76357 = acc_76353;\n            acc_76359 = acc_76355;\n        }\n        mem_78037[(int64_t) 0] = acc_76357;\n        mem_78041[(int64_t) 0] = acc_76359;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_78043[i_17] = mem_78037[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_78042[i_18] = mem_78041[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78820 = ext_mem_78043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78045)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78820;\n    }\n    if (slt64(sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800), min_res_68560)) {\n        int64_t tmp_78821 = ext_mem_78042[(int64_t) 0];\n        \n        ((__global int64_t *) mem_78047)[sext_i32_i64(local_tid_78799) + tile_sizze_76059 * sext_i32_i64(block_id_78800)] = tmp_78821;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76059\n    #undef bytes_78007\n    #undef bytes_78009\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_76412_dim1, 1, 1)\nvoid inner_SMJ_sho",
                                    "rtzisegmap_intrablock_76412(__global int *global_failure, int64_t tS_start_66998, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, int64_t start_68558, int64_t min_res_68560, int64_t ldim_76415, int64_t num_whole_tiles_76430, int64_t residual_input_76654, unsigned char cond_76655_bits, int64_t binop_x_76671, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77925, __global unsigned char *mem_77984, __global unsigned char *mem_77986)\n{\n    bool cond_76655 = cond_76655_bits;\n    \n    #define tile_sizze_76414 (inner_SMJ_shortzisegmap_intrablock_76412zitile_sizze_76414)\n    #define bytes_77946 (inner_SMJ_shortzisegmap_intrablock_76412zibytes_77946)\n    #define bytes_77948 (inner_SMJ_shortzisegmap_intrablock_76412zibytes_77948)\n    \n    volatile __local unsigned char *color_78693_backing_2 = &shared_mem[0];\n    const int64_t color_78693_backing_2_offset = 0 + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78692_backing_1 = &shared_mem[color_78693_backing_2_offset];\n    const int64_t color_78692_backing_1_offset = color_78693_backing_2_offset + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78691_backing_0 = &shared_mem[color_78692_backing_1_offset];\n    const int64_t color_78691_backing_0_offset = color_78692_backing_1_offset + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78825;\n    int32_t tblock_sizze_78828;\n    int32_t wave_sizze_78827;\n    int32_t block_id_78826;\n    int32_t global_tid_78824;\n    int64_t gid_flat_76412;\n    int64_t slice_78830;\n    int64_t ltid_pre_78829;\n    int64_t remnant_78831;\n    int64_t slice_78832;\n    int64_t gid_76411;\n    int64_t remnant_78833;\n    __local unsigned char *color_78691;\n    __local unsign", "ed char *color_78692;\n    __local unsigned char *color_78693;\n    int64_t binop_x_76422;\n    int16_t mem_77930[1];\n    int64_t ltid_flat_76417;\n    int64_t ltid_76416;\n    int64_t gtid_76423;\n    bool cond_76424;\n    int16_t pre_76425;\n    int64_t mem_77934[1];\n    int16_t mem_77938[1];\n    int64_t mem_77942[1];\n    int64_t ltid_flat_76432;\n    int64_t ltid_76431;\n    int64_t gtid_76442;\n    bool cond_76443;\n    int64_t neutral_76444;\n    int16_t neutral_76445;\n    int64_t ext_mem_77966[1];\n    int16_t ext_mem_77965[1];\n    int64_t ext_mem_77964[1];\n    int64_t mem_param_77943[1];\n    int16_t mem_param_77944[1];\n    int64_t mem_param_77945[1];\n    int64_t mem_77976[1];\n    int64_t mem_77980[1];\n    int64_t ext_mem_77982[1];\n    int64_t ext_mem_77981[1];\n    \n    local_tid_78825 = get_local_id(0);\n    tblock_sizze_78828 = get_local_size(0);\n    wave_sizze_78827 = LOCKSTEP_WIDTH;\n    block_id_78826 = get_tblock_id(0);\n    global_tid_78824 = block_id_78826 * tblock_sizze_78828 + local_tid_78825;\n    gid_flat_76412 = sext_i32_i64(block_id_78826);\n    slice_78830 = tile_sizze_76414;\n    ltid_pre_78829 = sext_i32_i64(local_tid_78825);\n    remnant_78831 = sext_i32_i64(local_tid_78825) - ltid_pre_78829;\n    slice_78832 = ldim_76415;\n    gid_76411 = sext_i32_i64(block_id_78826);\n    remnant_78833 = sext_i32_i64(block_id_78826) - gid_76411;\n    color_78691 = (__local unsigned char *) color_78691_backing_0;\n    color_78692 = (__local unsigned char *) color_78692_backing_1;\n    color_78693 = (__local unsigned char *) color_78693_backing_2;\n    binop_x_76422 = gid_76411 * tile_sizze_76414;\n    ltid_flat_76417 = sext_i32_i64(local_tid_78825);\n    ltid_76416 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76423 = ltid_76416 + binop_x_76422;\n    cond_76424 = slt64(gtid_76423, min_res_68560);\n    if (cond_76424) {\n        int64_t slice_76426;\n        int16_t eta_p_76427;\n        \n        slice_76426 = start_68558 + gtid_76423;\n        eta_p_76427 = ((__global int16_t *) tR_me", "m_77625)[slice_76426];\n        pre_76425 = eta_p_76427;\n    } else {\n        pre_76425 = (int16_t) 0;\n    }\n    mem_77930[(int64_t) 0] = pre_76425;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76432 = sext_i32_i64(local_tid_78825);\n    ltid_76431 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n    gtid_76442 = binop_x_76422 + ltid_76431;\n    cond_76443 = slt64(gtid_76442, min_res_68560);\n    if (cond_76443) {\n        neutral_76444 = (int64_t) -1;\n    } else {\n        neutral_76444 = (int64_t) 0;\n    }\n    if (cond_76443) {\n        int16_t eta_p_76447 = mem_77930[(int64_t) 0];\n        \n        neutral_76445 = eta_p_76447;\n    } else {\n        neutral_76445 = (int16_t) 0;\n    }\n    mem_77934[(int64_t) 0] = neutral_76444;\n    mem_77938[(int64_t) 0] = neutral_76445;\n    mem_77942[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77943[i_3] = mem_77934[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77944[i_4] = mem_77938[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77945[i_5] = mem_77942[i_5];\n    for (int64_t tile_id_76457 = 0; tile_id_76457 < num_whole_tiles_76430; tile_id_76457++) {\n        int64_t binop_x_76556;\n        int64_t ltid_flat_76555;\n        int64_t ltid_76554;\n        int64_t j_76557;\n        bool cond_76561;\n        int64_t pre1d_76564;\n        int64_t pre1d_76562;\n        int16_t pre1d_76563;\n        int64_t mem_77955[1];\n        int16_t mem_77959[1];\n        int64_t mem_77963[1];\n        int64_t ltid_flat_76575;\n        int64_t ltid_76574;\n        int64_t gtid_76577;\n        int64_t acc_76579;\n        int16_t acc_76580;\n        int64_t acc_76581;\n        bool cond_76582;\n        int64_t acc_76583;\n        int16_t acc_76584;\n        int64_t acc_76585;\n        int64_t mem_param_tmp_78834[1];\n        int16_t mem_param_tmp_78835[1];\n        int64_t mem_param_tmp_78836[1];\n        \n        binop_x_76556 = tile_si",
                                    "zze_76414 * tile_id_76457;\n        ltid_flat_76555 = sext_i32_i64(local_tid_78825);\n        ltid_76554 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76557 = ltid_76554 + binop_x_76556;\n        cond_76561 = slt64(j_76557, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76564 = btoi_bool_i64(cond_76561);\n        if (cond_76561) {\n            int64_t tile_elem_76565;\n            int64_t slice_77483;\n            int16_t tile_elem_76566;\n            \n            tile_elem_76565 = ((__global int64_t *) ext_mem_77925)[j_76557];\n            slice_77483 = tS_start_66998 + j_76557;\n            tile_elem_76566 = ((__global int16_t *) tS_mem_77626)[slice_77483];\n            pre1d_76562 = tile_elem_76565;\n            pre1d_76563 = tile_elem_76566;\n        } else {\n            pre1d_76562 = (int64_t) 0;\n            pre1d_76563 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76554] = pre1d_76562;\n        ((__local int16_t *) color_78692)[ltid_76554] = pre1d_76563;\n        ((__local int64_t *) color_78691)[ltid_76554] = pre1d_76564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76575 = sext_i32_i64(local_tid_78825);\n        ltid_76574 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76577 = binop_x_76422 + ltid_76574;\n        acc_76579 = mem_param_77943[(int64_t) 0];\n        acc_76580 = mem_param_77944[(int64_t) 0];\n        acc_76581 = mem_param_77945[(int64_t) 0];\n        cond_76582 = slt64(gtid_76577, min_res_68560);\n        if (cond_76582) {\n            int16_t eta_p_76578;\n            int64_t x_76586;\n            int16_t x_76587;\n            int64_t x_76588;\n            int64_t redout_77500;\n            int16_t redout_77501;\n            int64_t redout_77502;\n            \n            eta_p_76578 = mem_77930[(int64_t) 0];\n            redout_77500 = acc_76579;\n            redout_77501 = acc_76580;\n            redout_77502 = acc_76581;\n            for (int64_t i_77503 = 0; i_77503 < tile_sizze_76414; i_77503++) {", "\n                int64_t x_76589;\n                int16_t x_76590;\n                bool defunc_0_neq_res_76598;\n                bool defunc_0_neq_res_76599;\n                bool cond_f_res_76600;\n                bool y_76601;\n                bool cond_76602;\n                bool defunc_0_neq_res_76603;\n                bool defunc_0_neq_res_76604;\n                bool cond_t_res_f_res_76605;\n                bool y_76606;\n                bool cond_t_res_76607;\n                bool x_76608;\n                int64_t defunc_0_op_res_76609;\n                int16_t defunc_0_op_res_76610;\n                int64_t defunc_0_op_res_76611;\n                int64_t redout_tmp_78840;\n                int16_t redout_tmp_78841;\n                int64_t redout_tmp_78842;\n                \n                x_76589 = ((__local int64_t *) color_78693)[i_77503];\n                x_76590 = ((__local int16_t *) color_78692)[i_77503];\n                defunc_0_neq_res_76598 = redout_77501 == eta_p_76578;\n                defunc_0_neq_res_76599 = !defunc_0_neq_res_76598;\n                cond_f_res_76600 = slt64(redout_77500, (int64_t) 0);\n                y_76601 = defunc_0_neq_res_76598 && cond_f_res_76600;\n                cond_76602 = defunc_0_neq_res_76599 || y_76601;\n                defunc_0_neq_res_76603 = x_76590 == eta_p_76578;\n                defunc_0_neq_res_76604 = !defunc_0_neq_res_76603;\n                cond_t_res_f_res_76605 = slt64(x_76589, (int64_t) 0);\n                y_76606 = defunc_0_neq_res_76603 && cond_t_res_f_res_76605;\n                cond_t_res_76607 = defunc_0_neq_res_76604 || y_76606;\n                x_76608 = cond_76602 && cond_t_res_76607;\n                if (x_76608) {\n                    defunc_0_op_res_76609 = (int64_t) -1;\n                    defunc_0_op_res_76610 = eta_p_76578;\n                    defunc_0_op_res_76611 = (int64_t) 0;\n                } else {\n                    int64_t x_76591;\n                    int64_t defunc_0_op_res_f_res_76612;\n                 ", "   int16_t defunc_0_op_res_f_res_76613;\n                    int64_t defunc_0_op_res_f_res_76614;\n                    \n                    x_76591 = ((__local int64_t *) color_78691)[i_77503];\n                    if (cond_76602) {\n                        defunc_0_op_res_f_res_76612 = x_76589;\n                        defunc_0_op_res_f_res_76613 = x_76590;\n                        defunc_0_op_res_f_res_76614 = x_76591;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_76615;\n                        int64_t defunc_0_op_res_f_res_f_res_76616;\n                        int64_t defunc_0_op_res_f_res_f_res_76617;\n                        \n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76615 = redout_77501;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76615 = eta_p_76578;\n                        }\n                        if (cond_t_res_76607) {\n                            defunc_0_op_res_f_res_f_res_76616 = redout_77500;\n                            defunc_0_op_res_f_res_f_res_76617 = redout_77502;\n                        } else {\n                            int64_t min_res_76618;\n                            int64_t tmp_76619;\n                            \n                            min_res_76618 = smin64(x_76589, redout_77500);\n                            tmp_76619 = add64(x_76591, redout_77502);\n                            defunc_0_op_res_f_res_f_res_76616 = min_res_76618;\n                            defunc_0_op_res_f_res_f_res_76617 = tmp_76619;\n                        }\n                        defunc_0_op_res_f_res_76612 = defunc_0_op_res_f_res_f_res_76616;\n                        defunc_0_op_res_f_res_76613 = defunc_0_op_res_f_res_f_res_76615;\n                        defunc_0_op_res_f_res_76614 = defunc_0_op_res_f_res_f_res_76617;\n                    }\n                    defunc_0_op_res_76609 = defunc_0_op_res_f_res_76612;\n             ",
                                    "       defunc_0_op_res_76610 = defunc_0_op_res_f_res_76613;\n                    defunc_0_op_res_76611 = defunc_0_op_res_f_res_76614;\n                }\n                redout_tmp_78840 = defunc_0_op_res_76609;\n                redout_tmp_78841 = defunc_0_op_res_76610;\n                redout_tmp_78842 = defunc_0_op_res_76611;\n                redout_77500 = redout_tmp_78840;\n                redout_77501 = redout_tmp_78841;\n                redout_77502 = redout_tmp_78842;\n            }\n            x_76586 = redout_77500;\n            x_76587 = redout_77501;\n            x_76588 = redout_77502;\n            acc_76583 = x_76586;\n            acc_76584 = x_76587;\n            acc_76585 = x_76588;\n        } else {\n            acc_76583 = acc_76579;\n            acc_76584 = acc_76580;\n            acc_76585 = acc_76581;\n        }\n        mem_77955[(int64_t) 0] = acc_76583;\n        mem_77959[(int64_t) 0] = acc_76584;\n        mem_77963[(int64_t) 0] = acc_76585;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78834[i_6] = mem_77955[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78835[i_7] = mem_77959[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78836[i_8] = mem_77963[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77943[i_9] = mem_param_tmp_78834[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77944[i_10] = mem_param_tmp_78835[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77945[i_11] = mem_param_tmp_78836[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77966[i_12] = mem_param_77943[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77965[i_13] = mem_param_77944[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77964[i_14] = mem_param_77945[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_76655) {\n        for (in", "t32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77982[i_15] = ext_mem_77966[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77981[i_16] = ext_mem_77964[i_16];\n    } else {\n        int64_t ltid_flat_76657;\n        int64_t ltid_76656;\n        int64_t j_76672;\n        bool cond_76676;\n        int64_t pre1d_76679;\n        int64_t pre1d_76677;\n        int16_t pre1d_76678;\n        int64_t ltid_flat_76693;\n        int64_t ltid_76692;\n        int64_t gtid_76706;\n        int64_t acc_76708;\n        int64_t acc_76710;\n        bool cond_76711;\n        int64_t acc_76712;\n        int64_t acc_76714;\n        \n        ltid_flat_76657 = sext_i32_i64(local_tid_78825);\n        ltid_76656 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        j_76672 = ltid_76656 + binop_x_76671;\n        cond_76676 = slt64(j_76672, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);\n        pre1d_76679 = btoi_bool_i64(cond_76676);\n        if (cond_76676) {\n            int64_t tile_elem_76680;\n            int64_t slice_77482;\n            int16_t tile_elem_76681;\n            \n            tile_elem_76680 = ((__global int64_t *) ext_mem_77925)[j_76672];\n            slice_77482 = tS_start_66998 + j_76672;\n            tile_elem_76681 = ((__global int16_t *) tS_mem_77626)[slice_77482];\n            pre1d_76677 = tile_elem_76680;\n            pre1d_76678 = tile_elem_76681;\n        } else {\n            pre1d_76677 = (int64_t) 0;\n            pre1d_76678 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78693)[ltid_76656] = pre1d_76677;\n        ((__local int16_t *) color_78692)[ltid_76656] = pre1d_76678;\n        ((__local int64_t *) color_78691)[ltid_76656] = pre1d_76679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76693 = sext_i32_i64(local_tid_78825);\n        ltid_76692 = sext_i32_i64(sext_i64_i32(ltid_pre_78829));\n        gtid_76706 = binop_x_76422 + ltid_76692;\n        acc_76708 = ext_mem_77966[(int64_t) 0];\n        acc_76710 = ext_mem_77964[(int64_t) 0];\n    ", "    cond_76711 = slt64(gtid_76706, min_res_68560);\n        if (cond_76711) {\n            int16_t eta_p_76707;\n            int16_t acc_76709;\n            int64_t x_76715;\n            int16_t x_76716;\n            int64_t x_76717;\n            int64_t redout_77504;\n            int16_t redout_77505;\n            int64_t redout_77506;\n            \n            eta_p_76707 = mem_77930[(int64_t) 0];\n            acc_76709 = ext_mem_77965[(int64_t) 0];\n            redout_77504 = acc_76708;\n            redout_77505 = acc_76709;\n            redout_77506 = acc_76710;\n            for (int64_t i_77507 = 0; i_77507 < residual_input_76654; i_77507++) {\n                int64_t x_76718;\n                int16_t x_76719;\n                bool defunc_0_neq_res_76727;\n                bool defunc_0_neq_res_76728;\n                bool cond_f_res_76729;\n                bool y_76730;\n                bool cond_76731;\n                bool defunc_0_neq_res_76732;\n                bool defunc_0_neq_res_76733;\n                bool cond_t_res_f_res_76734;\n                bool y_76735;\n                bool cond_t_res_76736;\n                bool x_76737;\n                int64_t defunc_0_op_res_76738;\n                int16_t defunc_0_op_res_76739;\n                int64_t defunc_0_op_res_76740;\n                int64_t redout_tmp_78843;\n                int16_t redout_tmp_78844;\n                int64_t redout_tmp_78845;\n                \n                x_76718 = ((__local int64_t *) color_78693)[i_77507];\n                x_76719 = ((__local int16_t *) color_78692)[i_77507];\n                defunc_0_neq_res_76727 = redout_77505 == eta_p_76707;\n                defunc_0_neq_res_76728 = !defunc_0_neq_res_76727;\n                cond_f_res_76729 = slt64(redout_77504, (int64_t) 0);\n                y_76730 = defunc_0_neq_res_76727 && cond_f_res_76729;\n                cond_76731 = defunc_0_neq_res_76728 || y_76730;\n                defunc_0_neq_res_76732 = x_76719 == eta_p_76707;\n                defunc_0_neq_res_76733",
                                    " = !defunc_0_neq_res_76732;\n                cond_t_res_f_res_76734 = slt64(x_76718, (int64_t) 0);\n                y_76735 = defunc_0_neq_res_76732 && cond_t_res_f_res_76734;\n                cond_t_res_76736 = defunc_0_neq_res_76733 || y_76735;\n                x_76737 = cond_76731 && cond_t_res_76736;\n                if (x_76737) {\n                    defunc_0_op_res_76738 = (int64_t) -1;\n                    defunc_0_op_res_76739 = eta_p_76707;\n                    defunc_0_op_res_76740 = (int64_t) 0;\n                } else {\n                    int64_t x_76720;\n                    int64_t defunc_0_op_res_f_res_76741;\n                    int16_t defunc_0_op_res_f_res_76742;\n                    int64_t defunc_0_op_res_f_res_76743;\n                    \n                    x_76720 = ((__local int64_t *) color_78691)[i_77507];\n                    if (cond_76731) {\n                        defunc_0_op_res_f_res_76741 = x_76718;\n                        defunc_0_op_res_f_res_76742 = x_76719;\n                        defunc_0_op_res_f_res_76743 = x_76720;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_76744;\n                        int64_t defunc_0_op_res_f_res_f_res_76745;\n                        int64_t defunc_0_op_res_f_res_f_res_76746;\n                        \n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76744 = redout_77505;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76744 = eta_p_76707;\n                        }\n                        if (cond_t_res_76736) {\n                            defunc_0_op_res_f_res_f_res_76745 = redout_77504;\n                            defunc_0_op_res_f_res_f_res_76746 = redout_77506;\n                        } else {\n                            int64_t min_res_76747;\n                            int64_t tmp_76748;\n                            \n                            min_res_76747 = smin64(x_76718,", " redout_77504);\n                            tmp_76748 = add64(x_76720, redout_77506);\n                            defunc_0_op_res_f_res_f_res_76745 = min_res_76747;\n                            defunc_0_op_res_f_res_f_res_76746 = tmp_76748;\n                        }\n                        defunc_0_op_res_f_res_76741 = defunc_0_op_res_f_res_f_res_76745;\n                        defunc_0_op_res_f_res_76742 = defunc_0_op_res_f_res_f_res_76744;\n                        defunc_0_op_res_f_res_76743 = defunc_0_op_res_f_res_f_res_76746;\n                    }\n                    defunc_0_op_res_76738 = defunc_0_op_res_f_res_76741;\n                    defunc_0_op_res_76739 = defunc_0_op_res_f_res_76742;\n                    defunc_0_op_res_76740 = defunc_0_op_res_f_res_76743;\n                }\n                redout_tmp_78843 = defunc_0_op_res_76738;\n                redout_tmp_78844 = defunc_0_op_res_76739;\n                redout_tmp_78845 = defunc_0_op_res_76740;\n                redout_77504 = redout_tmp_78843;\n                redout_77505 = redout_tmp_78844;\n                redout_77506 = redout_tmp_78845;\n            }\n            x_76715 = redout_77504;\n            x_76716 = redout_77505;\n            x_76717 = redout_77506;\n            acc_76712 = x_76715;\n            acc_76714 = x_76717;\n        } else {\n            acc_76712 = acc_76708;\n            acc_76714 = acc_76710;\n        }\n        mem_77976[(int64_t) 0] = acc_76712;\n        mem_77980[(int64_t) 0] = acc_76714;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77982[i_17] = mem_77976[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77981[i_18] = mem_77980[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78846 = ext_mem_77982[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77984)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * ", "sext_i32_i64(block_id_78826)] = tmp_78846;\n    }\n    if (slt64(sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826), min_res_68560)) {\n        int64_t tmp_78847 = ext_mem_77981[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77986)[sext_i32_i64(local_tid_78825) + tile_sizze_76414 * sext_i32_i64(block_id_78826)] = tmp_78847;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76414\n    #undef bytes_77946\n    #undef bytes_77948\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_76767_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_76767(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_76770, int64_t num_whole_tiles_76785, int64_t residual_input_77009, unsigned char cond_77010_bits, int64_t binop_x_77026, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77840, __global unsigned char *mem_77842)\n{\n    bool cond_77010 = cond_77010_bits;\n    \n    #define tile_sizze_76769 (inner_SMJ_shortzisegmap_intrablock_76767zitile_sizze_76769)\n    #define bytes_77802 (inner_SMJ_shortzisegmap_intrablock_76767zibytes_77802)\n    #define bytes_77804 (inner_SMJ_shortzisegmap_intrablock_76767zibytes_77804)\n    \n    volatile __local unsigned char *color_78696_backing_2 = &shared_mem[0];\n    const int64_t color_78696_backing_2_offset = 0 + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78695_backing_1 = &shared_mem[color_78696_backing_2_offset];\n    const int64_t color_78695_backing_1_offset = color_78696_backing_2_offset + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78694_backing_0 = &shared_mem[color_78695_backing_1_offset];\n    const int64_t color_78694_backing_0_offset = color_78695_backing_1_offset + (bytes",
                                    "_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78966;\n    int32_t tblock_sizze_78969;\n    int32_t wave_sizze_78968;\n    int32_t block_id_78967;\n    int32_t global_tid_78965;\n    int64_t gid_flat_76767;\n    int64_t slice_78971;\n    int64_t ltid_pre_78970;\n    int64_t remnant_78972;\n    int64_t slice_78973;\n    int64_t gid_76766;\n    int64_t remnant_78974;\n    __local unsigned char *color_78694;\n    __local unsigned char *color_78695;\n    __local unsigned char *color_78696;\n    int64_t binop_x_76777;\n    int16_t mem_77786[1];\n    int64_t ltid_flat_76772;\n    int64_t ltid_76771;\n    int64_t gtid_76778;\n    bool cond_76779;\n    int16_t pre_76780;\n    int64_t mem_77790[1];\n    int16_t mem_77794[1];\n    int64_t mem_77798[1];\n    int64_t ltid_flat_76787;\n    int64_t ltid_76786;\n    int64_t gtid_76797;\n    bool cond_76798;\n    int64_t neutral_76799;\n    int16_t neutral_76800;\n    int64_t ext_mem_77822[1];\n    int16_t ext_mem_77821[1];\n    int64_t ext_mem_77820[1];\n    int64_t mem_param_77799[1];\n    int16_t mem_param_77800[1];\n    int64_t mem_param_77801[1];\n    int64_t mem_77832[1];\n    int64_t mem_77836[1];\n    int64_t ext_mem_77838[1];\n    int64_t ext_mem_77837[1];\n    \n    local_tid_78966 = get_local_id(0);\n    tblock_sizze_78969 = get_local_size(0);\n    wave_sizze_78968 = LOCKSTEP_WIDTH;\n    block_id_78967 = get_tblock_id(0);\n    global_tid_78965 = block_id_78967 * tblock_sizze_78969 + local_tid_78966;\n    gid_flat_76767 = sext_i32_i64(block_id_78967);\n    slice_78971 = tile_sizze_76769;\n    ltid_pre_78970 = sext_i32_i64(local_tid_78966);\n    remnant_78972 = sext_i32_i64(local_tid_78966) - ltid_pre_78970;\n    slice_78973 = ldim_76770;\n    gid_76766 = sext_i32_i64(block_id_78967);\n    remnant_78974 = sext_i32_i64(block_id_78967) - gid_76766;\n    color_78694 = (__local unsigned char *) color_78694_backing_0;\n    color_78695 = (__local unsigned char *) color_78695", "_backing_1;\n    color_78696 = (__local unsigned char *) color_78696_backing_2;\n    binop_x_76777 = gid_76766 * tile_sizze_76769;\n    ltid_flat_76772 = sext_i32_i64(local_tid_78966);\n    ltid_76771 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76778 = ltid_76771 + binop_x_76777;\n    cond_76779 = slt64(gtid_76778, min_res_67698);\n    if (cond_76779) {\n        int64_t slice_76781;\n        int16_t eta_p_76782;\n        \n        slice_76781 = slice_67712 + gtid_76778;\n        eta_p_76782 = ((__global int16_t *) tR_mem_77625)[slice_76781];\n        pre_76780 = eta_p_76782;\n    } else {\n        pre_76780 = (int16_t) 0;\n    }\n    mem_77786[(int64_t) 0] = pre_76780;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_76787 = sext_i32_i64(local_tid_78966);\n    ltid_76786 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n    gtid_76797 = binop_x_76777 + ltid_76786;\n    cond_76798 = slt64(gtid_76797, min_res_67698);\n    if (cond_76798) {\n        neutral_76799 = (int64_t) -1;\n    } else {\n        neutral_76799 = (int64_t) 0;\n    }\n    if (cond_76798) {\n        int16_t eta_p_76802 = mem_77786[(int64_t) 0];\n        \n        neutral_76800 = eta_p_76802;\n    } else {\n        neutral_76800 = (int16_t) 0;\n    }\n    mem_77790[(int64_t) 0] = neutral_76799;\n    mem_77794[(int64_t) 0] = neutral_76800;\n    mem_77798[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77799[i_3] = mem_77790[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_77800[i_4] = mem_77794[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77801[i_5] = mem_77798[i_5];\n    for (int64_t tile_id_76812 = 0; tile_id_76812 < num_whole_tiles_76785; tile_id_76812++) {\n        int64_t binop_x_76911;\n        int64_t ltid_flat_76910;\n        int64_t ltid_76909;\n        int64_t j_76912;\n        bool cond_76916;\n        int64_t pre1d_76919;\n        int64_t pre1d_76917;\n        int16_t pre1d_76918;\n ", "       int64_t mem_77811[1];\n        int16_t mem_77815[1];\n        int64_t mem_77819[1];\n        int64_t ltid_flat_76930;\n        int64_t ltid_76929;\n        int64_t gtid_76932;\n        int64_t acc_76934;\n        int16_t acc_76935;\n        int64_t acc_76936;\n        bool cond_76937;\n        int64_t acc_76938;\n        int16_t acc_76939;\n        int64_t acc_76940;\n        int64_t mem_param_tmp_78975[1];\n        int16_t mem_param_tmp_78976[1];\n        int64_t mem_param_tmp_78977[1];\n        \n        binop_x_76911 = tile_sizze_76769 * tile_id_76812;\n        ltid_flat_76910 = sext_i32_i64(local_tid_78966);\n        ltid_76909 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_76912 = ltid_76909 + binop_x_76911;\n        cond_76916 = slt64(j_76912, j_m_i_67660);\n        pre1d_76919 = btoi_bool_i64(cond_76916);\n        if (cond_76916) {\n            int64_t tile_elem_76920;\n            int64_t slice_77487;\n            int16_t tile_elem_76921;\n            \n            tile_elem_76920 = ((__global int64_t *) ext_mem_77720)[j_76912];\n            slice_77487 = slice_68069 + j_76912;\n            tile_elem_76921 = ((__global int16_t *) tS_mem_77626)[slice_77487];\n            pre1d_76917 = tile_elem_76920;\n            pre1d_76918 = tile_elem_76921;\n        } else {\n            pre1d_76917 = (int64_t) 0;\n            pre1d_76918 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_76909] = pre1d_76917;\n        ((__local int16_t *) color_78695)[ltid_76909] = pre1d_76918;\n        ((__local int64_t *) color_78694)[ltid_76909] = pre1d_76919;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_76930 = sext_i32_i64(local_tid_78966);\n        ltid_76929 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_76932 = binop_x_76777 + ltid_76929;\n        acc_76934 = mem_param_77799[(int64_t) 0];\n        acc_76935 = mem_param_77800[(int64_t) 0];\n        acc_76936 = mem_param_77801[(int64_t) 0];\n        cond_76937 = slt64(gtid_76932, min_res_67698);\n        if (cond_",
                                    "76937) {\n            int16_t eta_p_76933;\n            int64_t x_76941;\n            int16_t x_76942;\n            int64_t x_76943;\n            int64_t redout_77508;\n            int16_t redout_77509;\n            int64_t redout_77510;\n            \n            eta_p_76933 = mem_77786[(int64_t) 0];\n            redout_77508 = acc_76934;\n            redout_77509 = acc_76935;\n            redout_77510 = acc_76936;\n            for (int64_t i_77511 = 0; i_77511 < tile_sizze_76769; i_77511++) {\n                int64_t x_76944;\n                int16_t x_76945;\n                bool defunc_0_neq_res_76953;\n                bool defunc_0_neq_res_76954;\n                bool cond_f_res_76955;\n                bool y_76956;\n                bool cond_76957;\n                bool defunc_0_neq_res_76958;\n                bool defunc_0_neq_res_76959;\n                bool cond_t_res_f_res_76960;\n                bool y_76961;\n                bool cond_t_res_76962;\n                bool x_76963;\n                int64_t defunc_0_op_res_76964;\n                int16_t defunc_0_op_res_76965;\n                int64_t defunc_0_op_res_76966;\n                int64_t redout_tmp_78981;\n                int16_t redout_tmp_78982;\n                int64_t redout_tmp_78983;\n                \n                x_76944 = ((__local int64_t *) color_78696)[i_77511];\n                x_76945 = ((__local int16_t *) color_78695)[i_77511];\n                defunc_0_neq_res_76953 = redout_77509 == eta_p_76933;\n                defunc_0_neq_res_76954 = !defunc_0_neq_res_76953;\n                cond_f_res_76955 = slt64(redout_77508, (int64_t) 0);\n                y_76956 = defunc_0_neq_res_76953 && cond_f_res_76955;\n                cond_76957 = defunc_0_neq_res_76954 || y_76956;\n                defunc_0_neq_res_76958 = x_76945 == eta_p_76933;\n                defunc_0_neq_res_76959 = !defunc_0_neq_res_76958;\n                cond_t_res_f_res_76960 = slt64(x_76944, (int64_t) 0);\n                y_76961 = defunc_0_neq_res_76958 && cond_", "t_res_f_res_76960;\n                cond_t_res_76962 = defunc_0_neq_res_76959 || y_76961;\n                x_76963 = cond_76957 && cond_t_res_76962;\n                if (x_76963) {\n                    defunc_0_op_res_76964 = (int64_t) -1;\n                    defunc_0_op_res_76965 = eta_p_76933;\n                    defunc_0_op_res_76966 = (int64_t) 0;\n                } else {\n                    int64_t x_76946;\n                    int64_t defunc_0_op_res_f_res_76967;\n                    int16_t defunc_0_op_res_f_res_76968;\n                    int64_t defunc_0_op_res_f_res_76969;\n                    \n                    x_76946 = ((__local int64_t *) color_78694)[i_77511];\n                    if (cond_76957) {\n                        defunc_0_op_res_f_res_76967 = x_76944;\n                        defunc_0_op_res_f_res_76968 = x_76945;\n                        defunc_0_op_res_f_res_76969 = x_76946;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_76970;\n                        int64_t defunc_0_op_res_f_res_f_res_76971;\n                        int64_t defunc_0_op_res_f_res_f_res_76972;\n                        \n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76970 = redout_77509;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_76970 = eta_p_76933;\n                        }\n                        if (cond_t_res_76962) {\n                            defunc_0_op_res_f_res_f_res_76971 = redout_77508;\n                            defunc_0_op_res_f_res_f_res_76972 = redout_77510;\n                        } else {\n                            int64_t min_res_76973;\n                            int64_t tmp_76974;\n                            \n                            min_res_76973 = smin64(x_76944, redout_77508);\n                            tmp_76974 = add64(x_76946, redout_77510);\n                            defunc_0_op_res_f_res_f_res_76971 = min_r", "es_76973;\n                            defunc_0_op_res_f_res_f_res_76972 = tmp_76974;\n                        }\n                        defunc_0_op_res_f_res_76967 = defunc_0_op_res_f_res_f_res_76971;\n                        defunc_0_op_res_f_res_76968 = defunc_0_op_res_f_res_f_res_76970;\n                        defunc_0_op_res_f_res_76969 = defunc_0_op_res_f_res_f_res_76972;\n                    }\n                    defunc_0_op_res_76964 = defunc_0_op_res_f_res_76967;\n                    defunc_0_op_res_76965 = defunc_0_op_res_f_res_76968;\n                    defunc_0_op_res_76966 = defunc_0_op_res_f_res_76969;\n                }\n                redout_tmp_78981 = defunc_0_op_res_76964;\n                redout_tmp_78982 = defunc_0_op_res_76965;\n                redout_tmp_78983 = defunc_0_op_res_76966;\n                redout_77508 = redout_tmp_78981;\n                redout_77509 = redout_tmp_78982;\n                redout_77510 = redout_tmp_78983;\n            }\n            x_76941 = redout_77508;\n            x_76942 = redout_77509;\n            x_76943 = redout_77510;\n            acc_76938 = x_76941;\n            acc_76939 = x_76942;\n            acc_76940 = x_76943;\n        } else {\n            acc_76938 = acc_76934;\n            acc_76939 = acc_76935;\n            acc_76940 = acc_76936;\n        }\n        mem_77811[(int64_t) 0] = acc_76938;\n        mem_77815[(int64_t) 0] = acc_76939;\n        mem_77819[(int64_t) 0] = acc_76940;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_78975[i_6] = mem_77811[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_78976[i_7] = mem_77815[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_78977[i_8] = mem_77819[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77799[i_9] = mem_param_tmp_78975[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77800[i_10] = mem_param_tmp_78976[i_10",
                                    "];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77801[i_11] = mem_param_tmp_78977[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77822[i_12] = mem_param_77799[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77821[i_13] = mem_param_77800[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77820[i_14] = mem_param_77801[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77010) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77838[i_15] = ext_mem_77822[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77837[i_16] = ext_mem_77820[i_16];\n    } else {\n        int64_t ltid_flat_77012;\n        int64_t ltid_77011;\n        int64_t j_77027;\n        bool cond_77031;\n        int64_t pre1d_77034;\n        int64_t pre1d_77032;\n        int16_t pre1d_77033;\n        int64_t ltid_flat_77048;\n        int64_t ltid_77047;\n        int64_t gtid_77061;\n        int64_t acc_77063;\n        int64_t acc_77065;\n        bool cond_77066;\n        int64_t acc_77067;\n        int64_t acc_77069;\n        \n        ltid_flat_77012 = sext_i32_i64(local_tid_78966);\n        ltid_77011 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        j_77027 = ltid_77011 + binop_x_77026;\n        cond_77031 = slt64(j_77027, j_m_i_67660);\n        pre1d_77034 = btoi_bool_i64(cond_77031);\n        if (cond_77031) {\n            int64_t tile_elem_77035;\n            int64_t slice_77486;\n            int16_t tile_elem_77036;\n            \n            tile_elem_77035 = ((__global int64_t *) ext_mem_77720)[j_77027];\n            slice_77486 = slice_68069 + j_77027;\n            tile_elem_77036 = ((__global int16_t *) tS_mem_77626)[slice_77486];\n            pre1d_77032 = tile_elem_77035;\n            pre1d_77033 = tile_elem_77036;\n        } else {\n            pre1d_77032 = (int64_t) 0;\n            pre1d_77033 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78696)[ltid_77011] = pre1d_77032;\n", "        ((__local int16_t *) color_78695)[ltid_77011] = pre1d_77033;\n        ((__local int64_t *) color_78694)[ltid_77011] = pre1d_77034;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77048 = sext_i32_i64(local_tid_78966);\n        ltid_77047 = sext_i32_i64(sext_i64_i32(ltid_pre_78970));\n        gtid_77061 = binop_x_76777 + ltid_77047;\n        acc_77063 = ext_mem_77822[(int64_t) 0];\n        acc_77065 = ext_mem_77820[(int64_t) 0];\n        cond_77066 = slt64(gtid_77061, min_res_67698);\n        if (cond_77066) {\n            int16_t eta_p_77062;\n            int16_t acc_77064;\n            int64_t x_77070;\n            int16_t x_77071;\n            int64_t x_77072;\n            int64_t redout_77512;\n            int16_t redout_77513;\n            int64_t redout_77514;\n            \n            eta_p_77062 = mem_77786[(int64_t) 0];\n            acc_77064 = ext_mem_77821[(int64_t) 0];\n            redout_77512 = acc_77063;\n            redout_77513 = acc_77064;\n            redout_77514 = acc_77065;\n            for (int64_t i_77515 = 0; i_77515 < residual_input_77009; i_77515++) {\n                int64_t x_77073;\n                int16_t x_77074;\n                bool defunc_0_neq_res_77082;\n                bool defunc_0_neq_res_77083;\n                bool cond_f_res_77084;\n                bool y_77085;\n                bool cond_77086;\n                bool defunc_0_neq_res_77087;\n                bool defunc_0_neq_res_77088;\n                bool cond_t_res_f_res_77089;\n                bool y_77090;\n                bool cond_t_res_77091;\n                bool x_77092;\n                int64_t defunc_0_op_res_77093;\n                int16_t defunc_0_op_res_77094;\n                int64_t defunc_0_op_res_77095;\n                int64_t redout_tmp_78984;\n                int16_t redout_tmp_78985;\n                int64_t redout_tmp_78986;\n                \n                x_77073 = ((__local int64_t *) color_78696)[i_77515];\n                x_77074 = ((__local int16_t *) color_78695)[i_775", "15];\n                defunc_0_neq_res_77082 = redout_77513 == eta_p_77062;\n                defunc_0_neq_res_77083 = !defunc_0_neq_res_77082;\n                cond_f_res_77084 = slt64(redout_77512, (int64_t) 0);\n                y_77085 = defunc_0_neq_res_77082 && cond_f_res_77084;\n                cond_77086 = defunc_0_neq_res_77083 || y_77085;\n                defunc_0_neq_res_77087 = x_77074 == eta_p_77062;\n                defunc_0_neq_res_77088 = !defunc_0_neq_res_77087;\n                cond_t_res_f_res_77089 = slt64(x_77073, (int64_t) 0);\n                y_77090 = defunc_0_neq_res_77087 && cond_t_res_f_res_77089;\n                cond_t_res_77091 = defunc_0_neq_res_77088 || y_77090;\n                x_77092 = cond_77086 && cond_t_res_77091;\n                if (x_77092) {\n                    defunc_0_op_res_77093 = (int64_t) -1;\n                    defunc_0_op_res_77094 = eta_p_77062;\n                    defunc_0_op_res_77095 = (int64_t) 0;\n                } else {\n                    int64_t x_77075;\n                    int64_t defunc_0_op_res_f_res_77096;\n                    int16_t defunc_0_op_res_f_res_77097;\n                    int64_t defunc_0_op_res_f_res_77098;\n                    \n                    x_77075 = ((__local int64_t *) color_78694)[i_77515];\n                    if (cond_77086) {\n                        defunc_0_op_res_f_res_77096 = x_77073;\n                        defunc_0_op_res_f_res_77097 = x_77074;\n                        defunc_0_op_res_f_res_77098 = x_77075;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_77099;\n                        int64_t defunc_0_op_res_f_res_f_res_77100;\n                        int64_t defunc_0_op_res_f_res_f_res_77101;\n                        \n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77099 = redout_77513;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77099 = eta_p_77062;\n  ",
                                    "                      }\n                        if (cond_t_res_77091) {\n                            defunc_0_op_res_f_res_f_res_77100 = redout_77512;\n                            defunc_0_op_res_f_res_f_res_77101 = redout_77514;\n                        } else {\n                            int64_t min_res_77102;\n                            int64_t tmp_77103;\n                            \n                            min_res_77102 = smin64(x_77073, redout_77512);\n                            tmp_77103 = add64(x_77075, redout_77514);\n                            defunc_0_op_res_f_res_f_res_77100 = min_res_77102;\n                            defunc_0_op_res_f_res_f_res_77101 = tmp_77103;\n                        }\n                        defunc_0_op_res_f_res_77096 = defunc_0_op_res_f_res_f_res_77100;\n                        defunc_0_op_res_f_res_77097 = defunc_0_op_res_f_res_f_res_77099;\n                        defunc_0_op_res_f_res_77098 = defunc_0_op_res_f_res_f_res_77101;\n                    }\n                    defunc_0_op_res_77093 = defunc_0_op_res_f_res_77096;\n                    defunc_0_op_res_77094 = defunc_0_op_res_f_res_77097;\n                    defunc_0_op_res_77095 = defunc_0_op_res_f_res_77098;\n                }\n                redout_tmp_78984 = defunc_0_op_res_77093;\n                redout_tmp_78985 = defunc_0_op_res_77094;\n                redout_tmp_78986 = defunc_0_op_res_77095;\n                redout_77512 = redout_tmp_78984;\n                redout_77513 = redout_tmp_78985;\n                redout_77514 = redout_tmp_78986;\n            }\n            x_77070 = redout_77512;\n            x_77071 = redout_77513;\n            x_77072 = redout_77514;\n            acc_77067 = x_77070;\n            acc_77069 = x_77072;\n        } else {\n            acc_77067 = acc_77063;\n            acc_77069 = acc_77065;\n        }\n        mem_77832[(int64_t) 0] = acc_77067;\n        mem_77836[(int64_t) 0] = acc_77069;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0", "; i_17 < 1; i_17++)\n            ext_mem_77838[i_17] = mem_77832[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77837[i_18] = mem_77836[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78987 = ext_mem_77838[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77840)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78987;\n    }\n    if (slt64(sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967), min_res_67698)) {\n        int64_t tmp_78988 = ext_mem_77837[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77842)[sext_i32_i64(local_tid_78966) + tile_sizze_76769 * sext_i32_i64(block_id_78967)] = tmp_78988;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_76769\n    #undef bytes_77802\n    #undef bytes_77804\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_77122_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_77122(__global int *global_failure, int64_t j_m_i_67660, int64_t min_res_67698, int64_t slice_67712, int64_t slice_68069, int64_t ldim_77125, int64_t num_whole_tiles_77140, int64_t residual_input_77364, unsigned char cond_77365_bits, int64_t binop_x_77381, __global unsigned char *tR_mem_77625, __global unsigned char *tS_mem_77626, __global unsigned char *ext_mem_77720, __global unsigned char *mem_77779, __global unsigned char *mem_77781)\n{\n    bool cond_77365 = cond_77365_bits;\n    \n    #define tile_sizze_77124 (inner_SMJ_shortzisegmap_intrablock_77122zitile_sizze_77124)\n    #define bytes_77741 (inner_SMJ_shortzisegmap_intrablock_77122zibytes_77741)\n    #define bytes_77743 (inner_SMJ_shortzisegmap_intrablock_77122zibytes_77743)\n    \n    volatile __local unsigned char *color_78699_backing_2 = &shared_mem[0];\n    const int64_t color_78699_backing_2_offset = 0 + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    volati", "le __local unsigned char *color_78698_backing_1 = &shared_mem[color_78699_backing_2_offset];\n    const int64_t color_78698_backing_1_offset = color_78699_backing_2_offset + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_78697_backing_0 = &shared_mem[color_78698_backing_1_offset];\n    const int64_t color_78697_backing_0_offset = color_78698_backing_1_offset + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78992;\n    int32_t tblock_sizze_78995;\n    int32_t wave_sizze_78994;\n    int32_t block_id_78993;\n    int32_t global_tid_78991;\n    int64_t gid_flat_77122;\n    int64_t slice_78997;\n    int64_t ltid_pre_78996;\n    int64_t remnant_78998;\n    int64_t slice_78999;\n    int64_t gid_77121;\n    int64_t remnant_79000;\n    __local unsigned char *color_78697;\n    __local unsigned char *color_78698;\n    __local unsigned char *color_78699;\n    int64_t binop_x_77132;\n    int16_t mem_77725[1];\n    int64_t ltid_flat_77127;\n    int64_t ltid_77126;\n    int64_t gtid_77133;\n    bool cond_77134;\n    int16_t pre_77135;\n    int64_t mem_77729[1];\n    int16_t mem_77733[1];\n    int64_t mem_77737[1];\n    int64_t ltid_flat_77142;\n    int64_t ltid_77141;\n    int64_t gtid_77152;\n    bool cond_77153;\n    int64_t neutral_77154;\n    int16_t neutral_77155;\n    int64_t ext_mem_77761[1];\n    int16_t ext_mem_77760[1];\n    int64_t ext_mem_77759[1];\n    int64_t mem_param_77738[1];\n    int16_t mem_param_77739[1];\n    int64_t mem_param_77740[1];\n    int64_t mem_77771[1];\n    int64_t mem_77775[1];\n    int64_t ext_mem_77777[1];\n    int64_t ext_mem_77776[1];\n    \n    local_tid_78992 = get_local_id(0);\n    tblock_sizze_78995 = get_local_size(0);\n    wave_sizze_78994 = LOCKSTEP_WIDTH;\n    block_id_78993 = get_tblock_id(0);\n    global_tid_78991 = block_id_78993 * tblock_sizze_78995 + local_tid_78992;\n    gid_flat_77122 =",
                                    " sext_i32_i64(block_id_78993);\n    slice_78997 = tile_sizze_77124;\n    ltid_pre_78996 = sext_i32_i64(local_tid_78992);\n    remnant_78998 = sext_i32_i64(local_tid_78992) - ltid_pre_78996;\n    slice_78999 = ldim_77125;\n    gid_77121 = sext_i32_i64(block_id_78993);\n    remnant_79000 = sext_i32_i64(block_id_78993) - gid_77121;\n    color_78697 = (__local unsigned char *) color_78697_backing_0;\n    color_78698 = (__local unsigned char *) color_78698_backing_1;\n    color_78699 = (__local unsigned char *) color_78699_backing_2;\n    binop_x_77132 = gid_77121 * tile_sizze_77124;\n    ltid_flat_77127 = sext_i32_i64(local_tid_78992);\n    ltid_77126 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77133 = ltid_77126 + binop_x_77132;\n    cond_77134 = slt64(gtid_77133, min_res_67698);\n    if (cond_77134) {\n        int64_t slice_77136;\n        int16_t eta_p_77137;\n        \n        slice_77136 = slice_67712 + gtid_77133;\n        eta_p_77137 = ((__global int16_t *) tR_mem_77625)[slice_77136];\n        pre_77135 = eta_p_77137;\n    } else {\n        pre_77135 = (int16_t) 0;\n    }\n    mem_77725[(int64_t) 0] = pre_77135;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_77142 = sext_i32_i64(local_tid_78992);\n    ltid_77141 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n    gtid_77152 = binop_x_77132 + ltid_77141;\n    cond_77153 = slt64(gtid_77152, min_res_67698);\n    if (cond_77153) {\n        neutral_77154 = (int64_t) -1;\n    } else {\n        neutral_77154 = (int64_t) 0;\n    }\n    if (cond_77153) {\n        int16_t eta_p_77157 = mem_77725[(int64_t) 0];\n        \n        neutral_77155 = eta_p_77157;\n    } else {\n        neutral_77155 = (int16_t) 0;\n    }\n    mem_77729[(int64_t) 0] = neutral_77154;\n    mem_77733[(int64_t) 0] = neutral_77155;\n    mem_77737[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_77738[i_3] = mem_77729[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_p", "aram_77739[i_4] = mem_77733[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_77740[i_5] = mem_77737[i_5];\n    for (int64_t tile_id_77167 = 0; tile_id_77167 < num_whole_tiles_77140; tile_id_77167++) {\n        int64_t binop_x_77266;\n        int64_t ltid_flat_77265;\n        int64_t ltid_77264;\n        int64_t j_77267;\n        bool cond_77271;\n        int64_t pre1d_77274;\n        int64_t pre1d_77272;\n        int16_t pre1d_77273;\n        int64_t mem_77750[1];\n        int16_t mem_77754[1];\n        int64_t mem_77758[1];\n        int64_t ltid_flat_77285;\n        int64_t ltid_77284;\n        int64_t gtid_77287;\n        int64_t acc_77289;\n        int16_t acc_77290;\n        int64_t acc_77291;\n        bool cond_77292;\n        int64_t acc_77293;\n        int16_t acc_77294;\n        int64_t acc_77295;\n        int64_t mem_param_tmp_79001[1];\n        int16_t mem_param_tmp_79002[1];\n        int64_t mem_param_tmp_79003[1];\n        \n        binop_x_77266 = tile_sizze_77124 * tile_id_77167;\n        ltid_flat_77265 = sext_i32_i64(local_tid_78992);\n        ltid_77264 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77267 = ltid_77264 + binop_x_77266;\n        cond_77271 = slt64(j_77267, j_m_i_67660);\n        pre1d_77274 = btoi_bool_i64(cond_77271);\n        if (cond_77271) {\n            int64_t tile_elem_77275;\n            int64_t slice_77491;\n            int16_t tile_elem_77276;\n            \n            tile_elem_77275 = ((__global int64_t *) ext_mem_77720)[j_77267];\n            slice_77491 = slice_68069 + j_77267;\n            tile_elem_77276 = ((__global int16_t *) tS_mem_77626)[slice_77491];\n            pre1d_77272 = tile_elem_77275;\n            pre1d_77273 = tile_elem_77276;\n        } else {\n            pre1d_77272 = (int64_t) 0;\n            pre1d_77273 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77264] = pre1d_77272;\n        ((__local int16_t *) color_78698)[ltid_77264] = pre1d_77273;\n        ((__local int64_t *) color_78697)[ltid_77264]", " = pre1d_77274;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77285 = sext_i32_i64(local_tid_78992);\n        ltid_77284 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77287 = binop_x_77132 + ltid_77284;\n        acc_77289 = mem_param_77738[(int64_t) 0];\n        acc_77290 = mem_param_77739[(int64_t) 0];\n        acc_77291 = mem_param_77740[(int64_t) 0];\n        cond_77292 = slt64(gtid_77287, min_res_67698);\n        if (cond_77292) {\n            int16_t eta_p_77288;\n            int64_t x_77296;\n            int16_t x_77297;\n            int64_t x_77298;\n            int64_t redout_77516;\n            int16_t redout_77517;\n            int64_t redout_77518;\n            \n            eta_p_77288 = mem_77725[(int64_t) 0];\n            redout_77516 = acc_77289;\n            redout_77517 = acc_77290;\n            redout_77518 = acc_77291;\n            for (int64_t i_77519 = 0; i_77519 < tile_sizze_77124; i_77519++) {\n                int64_t x_77299;\n                int16_t x_77300;\n                bool defunc_0_neq_res_77308;\n                bool defunc_0_neq_res_77309;\n                bool cond_f_res_77310;\n                bool y_77311;\n                bool cond_77312;\n                bool defunc_0_neq_res_77313;\n                bool defunc_0_neq_res_77314;\n                bool cond_t_res_f_res_77315;\n                bool y_77316;\n                bool cond_t_res_77317;\n                bool x_77318;\n                int64_t defunc_0_op_res_77319;\n                int16_t defunc_0_op_res_77320;\n                int64_t defunc_0_op_res_77321;\n                int64_t redout_tmp_79007;\n                int16_t redout_tmp_79008;\n                int64_t redout_tmp_79009;\n                \n                x_77299 = ((__local int64_t *) color_78699)[i_77519];\n                x_77300 = ((__local int16_t *) color_78698)[i_77519];\n                defunc_0_neq_res_77308 = redout_77517 == eta_p_77288;\n                defunc_0_neq_res_77309 = !defunc_0_neq_res_77308;\n              ",
                                    "  cond_f_res_77310 = slt64(redout_77516, (int64_t) 0);\n                y_77311 = defunc_0_neq_res_77308 && cond_f_res_77310;\n                cond_77312 = defunc_0_neq_res_77309 || y_77311;\n                defunc_0_neq_res_77313 = x_77300 == eta_p_77288;\n                defunc_0_neq_res_77314 = !defunc_0_neq_res_77313;\n                cond_t_res_f_res_77315 = slt64(x_77299, (int64_t) 0);\n                y_77316 = defunc_0_neq_res_77313 && cond_t_res_f_res_77315;\n                cond_t_res_77317 = defunc_0_neq_res_77314 || y_77316;\n                x_77318 = cond_77312 && cond_t_res_77317;\n                if (x_77318) {\n                    defunc_0_op_res_77319 = (int64_t) -1;\n                    defunc_0_op_res_77320 = eta_p_77288;\n                    defunc_0_op_res_77321 = (int64_t) 0;\n                } else {\n                    int64_t x_77301;\n                    int64_t defunc_0_op_res_f_res_77322;\n                    int16_t defunc_0_op_res_f_res_77323;\n                    int64_t defunc_0_op_res_f_res_77324;\n                    \n                    x_77301 = ((__local int64_t *) color_78697)[i_77519];\n                    if (cond_77312) {\n                        defunc_0_op_res_f_res_77322 = x_77299;\n                        defunc_0_op_res_f_res_77323 = x_77300;\n                        defunc_0_op_res_f_res_77324 = x_77301;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_77325;\n                        int64_t defunc_0_op_res_f_res_f_res_77326;\n                        int64_t defunc_0_op_res_f_res_f_res_77327;\n                        \n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77325 = redout_77517;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77325 = eta_p_77288;\n                        }\n                        if (cond_t_res_77317) {\n                            defunc_0_op_res_f_res_f_res_77326 = redout_77516;\n     ", "                       defunc_0_op_res_f_res_f_res_77327 = redout_77518;\n                        } else {\n                            int64_t min_res_77328;\n                            int64_t tmp_77329;\n                            \n                            min_res_77328 = smin64(x_77299, redout_77516);\n                            tmp_77329 = add64(x_77301, redout_77518);\n                            defunc_0_op_res_f_res_f_res_77326 = min_res_77328;\n                            defunc_0_op_res_f_res_f_res_77327 = tmp_77329;\n                        }\n                        defunc_0_op_res_f_res_77322 = defunc_0_op_res_f_res_f_res_77326;\n                        defunc_0_op_res_f_res_77323 = defunc_0_op_res_f_res_f_res_77325;\n                        defunc_0_op_res_f_res_77324 = defunc_0_op_res_f_res_f_res_77327;\n                    }\n                    defunc_0_op_res_77319 = defunc_0_op_res_f_res_77322;\n                    defunc_0_op_res_77320 = defunc_0_op_res_f_res_77323;\n                    defunc_0_op_res_77321 = defunc_0_op_res_f_res_77324;\n                }\n                redout_tmp_79007 = defunc_0_op_res_77319;\n                redout_tmp_79008 = defunc_0_op_res_77320;\n                redout_tmp_79009 = defunc_0_op_res_77321;\n                redout_77516 = redout_tmp_79007;\n                redout_77517 = redout_tmp_79008;\n                redout_77518 = redout_tmp_79009;\n            }\n            x_77296 = redout_77516;\n            x_77297 = redout_77517;\n            x_77298 = redout_77518;\n            acc_77293 = x_77296;\n            acc_77294 = x_77297;\n            acc_77295 = x_77298;\n        } else {\n            acc_77293 = acc_77289;\n            acc_77294 = acc_77290;\n            acc_77295 = acc_77291;\n        }\n        mem_77750[(int64_t) 0] = acc_77293;\n        mem_77754[(int64_t) 0] = acc_77294;\n        mem_77758[(int64_t) 0] = acc_77295;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_", "79001[i_6] = mem_77750[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_79002[i_7] = mem_77754[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_79003[i_8] = mem_77758[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_77738[i_9] = mem_param_tmp_79001[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_77739[i_10] = mem_param_tmp_79002[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_77740[i_11] = mem_param_tmp_79003[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_77761[i_12] = mem_param_77738[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_77760[i_13] = mem_param_77739[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_77759[i_14] = mem_param_77740[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_77365) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_77777[i_15] = ext_mem_77761[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_77776[i_16] = ext_mem_77759[i_16];\n    } else {\n        int64_t ltid_flat_77367;\n        int64_t ltid_77366;\n        int64_t j_77382;\n        bool cond_77386;\n        int64_t pre1d_77389;\n        int64_t pre1d_77387;\n        int16_t pre1d_77388;\n        int64_t ltid_flat_77403;\n        int64_t ltid_77402;\n        int64_t gtid_77416;\n        int64_t acc_77418;\n        int64_t acc_77420;\n        bool cond_77421;\n        int64_t acc_77422;\n        int64_t acc_77424;\n        \n        ltid_flat_77367 = sext_i32_i64(local_tid_78992);\n        ltid_77366 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        j_77382 = ltid_77366 + binop_x_77381;\n        cond_77386 = slt64(j_77382, j_m_i_67660);\n        pre1d_77389 = btoi_bool_i64(cond_77386);\n        if (cond_77386) {\n            int64_t tile_elem_77390;\n            int64_t slice_77490;\n            int16_t tile_elem_77391;\n            \n            tile_el",
                                    "em_77390 = ((__global int64_t *) ext_mem_77720)[j_77382];\n            slice_77490 = slice_68069 + j_77382;\n            tile_elem_77391 = ((__global int16_t *) tS_mem_77626)[slice_77490];\n            pre1d_77387 = tile_elem_77390;\n            pre1d_77388 = tile_elem_77391;\n        } else {\n            pre1d_77387 = (int64_t) 0;\n            pre1d_77388 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_78699)[ltid_77366] = pre1d_77387;\n        ((__local int16_t *) color_78698)[ltid_77366] = pre1d_77388;\n        ((__local int64_t *) color_78697)[ltid_77366] = pre1d_77389;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_77403 = sext_i32_i64(local_tid_78992);\n        ltid_77402 = sext_i32_i64(sext_i64_i32(ltid_pre_78996));\n        gtid_77416 = binop_x_77132 + ltid_77402;\n        acc_77418 = ext_mem_77761[(int64_t) 0];\n        acc_77420 = ext_mem_77759[(int64_t) 0];\n        cond_77421 = slt64(gtid_77416, min_res_67698);\n        if (cond_77421) {\n            int16_t eta_p_77417;\n            int16_t acc_77419;\n            int64_t x_77425;\n            int16_t x_77426;\n            int64_t x_77427;\n            int64_t redout_77520;\n            int16_t redout_77521;\n            int64_t redout_77522;\n            \n            eta_p_77417 = mem_77725[(int64_t) 0];\n            acc_77419 = ext_mem_77760[(int64_t) 0];\n            redout_77520 = acc_77418;\n            redout_77521 = acc_77419;\n            redout_77522 = acc_77420;\n            for (int64_t i_77523 = 0; i_77523 < residual_input_77364; i_77523++) {\n                int64_t x_77428;\n                int16_t x_77429;\n                bool defunc_0_neq_res_77437;\n                bool defunc_0_neq_res_77438;\n                bool cond_f_res_77439;\n                bool y_77440;\n                bool cond_77441;\n                bool defunc_0_neq_res_77442;\n                bool defunc_0_neq_res_77443;\n                bool cond_t_res_f_res_77444;\n                bool y_77445;\n                bool cond_t_res_77446;\n  ", "              bool x_77447;\n                int64_t defunc_0_op_res_77448;\n                int16_t defunc_0_op_res_77449;\n                int64_t defunc_0_op_res_77450;\n                int64_t redout_tmp_79010;\n                int16_t redout_tmp_79011;\n                int64_t redout_tmp_79012;\n                \n                x_77428 = ((__local int64_t *) color_78699)[i_77523];\n                x_77429 = ((__local int16_t *) color_78698)[i_77523];\n                defunc_0_neq_res_77437 = redout_77521 == eta_p_77417;\n                defunc_0_neq_res_77438 = !defunc_0_neq_res_77437;\n                cond_f_res_77439 = slt64(redout_77520, (int64_t) 0);\n                y_77440 = defunc_0_neq_res_77437 && cond_f_res_77439;\n                cond_77441 = defunc_0_neq_res_77438 || y_77440;\n                defunc_0_neq_res_77442 = x_77429 == eta_p_77417;\n                defunc_0_neq_res_77443 = !defunc_0_neq_res_77442;\n                cond_t_res_f_res_77444 = slt64(x_77428, (int64_t) 0);\n                y_77445 = defunc_0_neq_res_77442 && cond_t_res_f_res_77444;\n                cond_t_res_77446 = defunc_0_neq_res_77443 || y_77445;\n                x_77447 = cond_77441 && cond_t_res_77446;\n                if (x_77447) {\n                    defunc_0_op_res_77448 = (int64_t) -1;\n                    defunc_0_op_res_77449 = eta_p_77417;\n                    defunc_0_op_res_77450 = (int64_t) 0;\n                } else {\n                    int64_t x_77430;\n                    int64_t defunc_0_op_res_f_res_77451;\n                    int16_t defunc_0_op_res_f_res_77452;\n                    int64_t defunc_0_op_res_f_res_77453;\n                    \n                    x_77430 = ((__local int64_t *) color_78697)[i_77523];\n                    if (cond_77441) {\n                        defunc_0_op_res_f_res_77451 = x_77428;\n                        defunc_0_op_res_f_res_77452 = x_77429;\n                        defunc_0_op_res_f_res_77453 = x_77430;\n                    } else {\n                 ", "       int16_t defunc_0_op_res_f_res_f_res_77454;\n                        int64_t defunc_0_op_res_f_res_f_res_77455;\n                        int64_t defunc_0_op_res_f_res_f_res_77456;\n                        \n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77454 = redout_77521;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_77454 = eta_p_77417;\n                        }\n                        if (cond_t_res_77446) {\n                            defunc_0_op_res_f_res_f_res_77455 = redout_77520;\n                            defunc_0_op_res_f_res_f_res_77456 = redout_77522;\n                        } else {\n                            int64_t min_res_77457;\n                            int64_t tmp_77458;\n                            \n                            min_res_77457 = smin64(x_77428, redout_77520);\n                            tmp_77458 = add64(x_77430, redout_77522);\n                            defunc_0_op_res_f_res_f_res_77455 = min_res_77457;\n                            defunc_0_op_res_f_res_f_res_77456 = tmp_77458;\n                        }\n                        defunc_0_op_res_f_res_77451 = defunc_0_op_res_f_res_f_res_77455;\n                        defunc_0_op_res_f_res_77452 = defunc_0_op_res_f_res_f_res_77454;\n                        defunc_0_op_res_f_res_77453 = defunc_0_op_res_f_res_f_res_77456;\n                    }\n                    defunc_0_op_res_77448 = defunc_0_op_res_f_res_77451;\n                    defunc_0_op_res_77449 = defunc_0_op_res_f_res_77452;\n                    defunc_0_op_res_77450 = defunc_0_op_res_f_res_77453;\n                }\n                redout_tmp_79010 = defunc_0_op_res_77448;\n                redout_tmp_79011 = defunc_0_op_res_77449;\n                redout_tmp_79012 = defunc_0_op_res_77450;\n                redout_77520 = redout_tmp_79010;\n                redout_77521 = redout_tmp_79011;\n                redout_77522 = redout_tmp_",
                                    "79012;\n            }\n            x_77425 = redout_77520;\n            x_77426 = redout_77521;\n            x_77427 = redout_77522;\n            acc_77422 = x_77425;\n            acc_77424 = x_77427;\n        } else {\n            acc_77422 = acc_77418;\n            acc_77424 = acc_77420;\n        }\n        mem_77771[(int64_t) 0] = acc_77422;\n        mem_77775[(int64_t) 0] = acc_77424;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_77777[i_17] = mem_77771[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_77776[i_18] = mem_77775[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79013 = ext_mem_77777[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77779)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79013;\n    }\n    if (slt64(sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993), min_res_67698)) {\n        int64_t tmp_79014 = ext_mem_77776[(int64_t) 0];\n        \n        ((__global int64_t *) mem_77781)[sext_i32_i64(local_tid_78992) + tile_sizze_77124 * sext_i32_i64(block_id_78993)] = tmp_79014;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_77124\n    #undef bytes_77741\n    #undef bytes_77743\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegscan_70725_dim1, 1, 1)\nvoid inner_SMJ_shortzisegscan_70725(__global int *global_failure, int64_t nR_39348, int64_t num_tblocks_70722, int64_t num_virt_blocks_79082, int64_t num_virt_threads_79083, __global unsigned char *ext_mem_78096, __global unsigned char *mem_78099, __global unsigned char *mem_78101, __global unsigned char *status_flags_mem_79084, __global unsigned char *aggregates_mem_79106, __global unsigned char *incprefixes_mem_79108, __global unsigned char *global_dynid_mem_79110)\n{\n    #define segscan_tblock_sizze_70720 (inner_SMJ_shortzisegscan_70725zisegscan_tblock_sizze_707", "20)\n    #define chunk_sizze_79081 (inner_SMJ_shortzisegscan_70725zichunk_sizze_79081)\n    \n    volatile __local unsigned char *local_mem_79140_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79140_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_70720), chunk_sizze_79081 * segscan_tblock_sizze_70720 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_70720), chunk_sizze_79081 * segscan_tblock_sizze_70720 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79133;\n    int32_t tblock_sizze_79136;\n    int32_t wave_sizze_79135;\n    int32_t block_id_79134;\n    int32_t global_tid_79132;\n    int64_t phys_tid_70725;\n    int32_t chunk_sizze_32b_79137;\n    int64_t byte_offsets_79138;\n    int64_t warp_byte_offset_79139;\n    __local unsigned char *local_mem_79140;\n    int64_t trans_arr_len_79141;\n    int64_t phys_block_id_79147;\n    int64_t virtloop_bound_79148;\n    \n    local_tid_79133 = get_local_id(0);\n    tblock_sizze_79136 = get_local_size(0);\n    wave_sizze_79135 = LOCKSTEP_WIDTH;\n    block_id_79134 = get_tblock_id(0);\n    global_tid_79132 = block_id_79134 * tblock_sizze_79136 + local_tid_79133;\n    phys_tid_70725 = sext_i32_i64(global_tid_79132);\n    chunk_sizze_32b_79137 = sext_i64_i32(chunk_sizze_79081);\n    byte_offsets_79138 = segscan_tblock_sizze_70720 * (int64_t) 8;\n    warp_byte_offset_79139 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79140 = (__local unsigned char *) local_mem_79140_backing_0;\n    trans_arr_len_79141 = chunk_sizze_79081 * segscan_tblock_sizze_70720;\n    phys_block_id_79147 = get_tblock_id(0);\n    virtloop_bound_79148 = sdiv_up64(num_virt_blocks_79082 - phys_block_id_79147, num_tblocks_70722);\n    for (int64_t virtloop_i_79149 = 0; virtloop_i_79149 < virtloop_bound_79148; virtloop_i_79149++) {\n        int64_t dynamic_id_79150;\n        int64_t ", "block_offset_79151;\n        int64_t sgm_idx_79152;\n        int32_t boundary_79153;\n        int32_t segsizze_compact_79154;\n        int64_t private_mem_79155[chunk_sizze_79081];\n        int64_t thd_offset_79157;\n        int64_t acc_79173;\n        int64_t prefix_79183;\n        bool block_new_sgm_79184;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79133 == 0) {\n                dynamic_id_79150 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79110)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 0] = dynamic_id_79150;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79150 == num_virt_blocks_79082 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79110)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79150 = ((__local int32_t *) local_mem_79140)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79151 = dynamic_id_79150 * chunk_sizze_79081 * segscan_tblock_sizze_70720;\n        sgm_idx_79152 = smod64(block_offset_79151, nR_39348);\n        boundary_79153 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_70720, nR_39348 - sgm_idx_79152));\n        segsizze_compact_79154 = sext_i64_i32(smin64(chunk_sizze_79081 * segscan_tblock_sizze_70720, nR_39348));\n        thd_offset_79157 = block_offset_79151 + sext_i32_i64(local_tid_79133);\n        // Load and map\n        {\n            for (int64_t i_79158 = 0; i_79158 < chunk_sizze_79081; i_79158++) {\n                int64_t virt_tid_79159 = thd_offset_79157 + i_79158 * segscan_tblock_sizze_70720;\n                int64_t slice_79160 = nR_39348;\n                int64_t gtid_70724 = virt_tid",
                                    "_79159;\n                int64_t remnant_79161 = virt_tid_79159 - gtid_70724;\n                \n                if (slt64(virt_tid_79159, nR_39348)) {\n                    int64_t eta_p_68120 = ((__global int64_t *) ext_mem_78096)[gtid_70724];\n                    bool lifted_lambda_res_68121 = slt64((int64_t) 0, eta_p_68120);\n                    int64_t defunc_0_f_res_68122 = btoi_bool_i64(lifted_lambda_res_68121);\n                    \n                    ((__global int64_t *) mem_78101)[gtid_70724] = defunc_0_f_res_68122;\n                    private_mem_79155[i_79158] = defunc_0_f_res_68122;\n                } else {\n                    private_mem_79155[i_79158] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79162 = 0; i_79162 < chunk_sizze_79081; i_79162++) {\n                int64_t sharedIdx_79163 = sext_i32_i64(local_tid_79133) + i_79162 * segscan_tblock_sizze_70720;\n                int64_t tmp_79164 = private_mem_79155[i_79162];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79163] = tmp_79164;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79165 = 0; i_79165 < chunk_sizze_79081; i_79165++) {\n                int64_t sharedIdx_79166 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79165;\n                int64_t tmp_79167 = ((__local int64_t *) local_mem_79140)[sharedIdx_79166];\n                \n                private_mem_79155[i_79165] = tmp_79167;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79168 = 0; i_79168 < chunk_sizze_79081 - (int64_t) 1; i_79168++) {\n                int64_t eta_p_67831;\n                int64_t eta_p_67832;\n                \n                eta_p_67831 = private_mem_79155[i_79168];\n                eta_p_67832 = private_mem_79155[i_79168 + (int64_t) 1];\n              ", "  \n                int64_t defunc_0_op_res_67833 = add64(eta_p_67831, eta_p_67832);\n                \n                private_mem_79155[i_79168 + (int64_t) 1] = defunc_0_op_res_67833;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79169 = private_mem_79155[chunk_sizze_79081 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = tmp_79169;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79170;\n            int64_t eta_p_79171;\n            int64_t eta_p_79174;\n            int64_t eta_p_79175;\n            bool ltid_in_bounds_79177 = slt64(sext_i32_i64(local_tid_79133), num_virt_threads_79083);\n            int32_t skip_threads_79178;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79177) {\n                    eta_p_79171 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                    if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                        eta_p_79170 = eta_p_79171;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79178 = 1;\n                while (slt32(skip_threads_79178, 32)) {\n                    bool thread_active_79179 = sle32(skip_threads_79178, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && ltid_in_bounds_79177;\n                    \n                    if (thread_active_79179) {\n                        // read operands\n                        {\n                            eta_p_79170 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79178)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (t", "hread_active_79179) {\n                            int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                            \n                            eta_p_79170 = defunc_0_op_res_79172;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79179) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79170;\n                            eta_p_79171 = eta_p_79170;\n                        }\n                    }\n                    if (sle32(wave_sizze_79135, skip_threads_79178)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79178 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 31 && ltid_in_bounds_79177) {\n                    ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32))] = eta_p_79170;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79180;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                        eta_p_79175 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                        if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                            eta_p_79174 = eta_p_79175;\n                  ",
                                    "      }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79180 = 1;\n                    while (slt32(skip_threads_79180, 32)) {\n                        bool thread_active_79181 = sle32(skip_threads_79180, local_tid_79133 - squot32(local_tid_79133, 32) * 32) && (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177);\n                        \n                        if (thread_active_79181) {\n                            // read operands\n                            {\n                                eta_p_79174 = ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79180)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79181) {\n                                int64_t defunc_0_op_res_79176 = add64(eta_p_79174, eta_p_79175);\n                                \n                                eta_p_79174 = defunc_0_op_res_79176;\n                            }\n                        }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79181) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79174;\n                                eta_p_79175 = eta_p_79174;\n                            }\n                        }\n                        if (sle32(wave_sizze_79135, skip_threads_79180)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79180 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENC", "E);\n            \n            bool no_carry_in_79182 = squot32(local_tid_79133, 32) == 0 || !ltid_in_bounds_79177;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_79182) {\n                        eta_p_79171 = eta_p_79170;\n                        eta_p_79170 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(squot32(local_tid_79133, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79182) {\n                        int64_t defunc_0_op_res_79172 = add64(eta_p_79170, eta_p_79171);\n                        \n                        eta_p_79170 = defunc_0_op_res_79172;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79182) {\n                        ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79170;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79133, 32) == 0 && ltid_in_bounds_79177) {\n                    ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = eta_p_79171;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_79133 == 0) {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[segscan_tblock_sizze_70720 - (int64_t) 1];\n            } else {\n                acc_79173 = ((__local int64_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79183 = (int64_t) 0;\n        block_new_sgm_79184 = sgm_idx_79152 == (int64_t) 0;\n        // Perform lookback\n        {\n      ", "      if (block_new_sgm_79184 && local_tid_79133 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = acc_79173;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                acc_79173 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79184 && slt32(local_tid_79133, wave_sizze_79135)) {\n                if (local_tid_79133 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79106)[dynamic_id_79150] = acc_79173;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 1;\n                    \n                    int8_t tmp_79185 = ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_79140)[(int64_t) 0] = tmp_79185;\n                }\n                mem_fence_local();\n                \n                int8_t status_79186 = ((__local int8_t *) local_mem_79140)[(int64_t) 0];\n                \n                if (status_79186 == (int8_t) 2) {\n                    if (local_tid_79133 == 0) {\n                        prefix_79183 = ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79187 = sext_i64_i32(dynamic_id_79150 - sext_i32_i64(wave_sizze_79135));\n                    \n                    while (slt32(wave_sizze_79135 * -1, readOffset_79187)) {\n                        int32_t read_i_79188 = readOffset_79187 + local_tid_79133;\n                        int64_t aggr_79189 = (int64_t) 0;\n                        int8_t flag_79190 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79188)) {\n                            flag_79190 = ((volatile __global int8_t *) status_",
                                    "flags_mem_79084)[sext_i32_i64(read_i_79188)];\n                            if (flag_79190 == (int8_t) 2) {\n                                aggr_79189 = ((volatile __global int64_t *) incprefixes_mem_79108)[sext_i32_i64(read_i_79188)];\n                            } else if (flag_79190 == (int8_t) 1) {\n                                aggr_79189 = ((volatile __global int64_t *) aggregates_mem_79106)[sext_i32_i64(read_i_79188)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = aggr_79189;\n                        ((__local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flag_79190;\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        if (slt8(flag_79190, (int8_t) 2)) {\n                            int8_t flg_x_79194;\n                            int8_t flg_y_79195;\n                            int64_t eta_p_79191;\n                            int64_t eta_p_79192;\n                            int32_t skip_threads_79196;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79195 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)];\n                                eta_p_79192 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)];\n                                if ((local_tid_79133 - squot32(local_tid_79133, 32) * 32) == 0) {\n                                    eta_p_79191 = eta_p_79192;\n                                    flg_x_79194 = flg_y_79195;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79196 = 1;\n                          ", "      while (slt32(skip_threads_79196, 32)) {\n                                    if (sle32(skip_threads_79196, local_tid_79133 - squot32(local_tid_79133, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79194 = ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196)];\n                                            eta_p_79191 = ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(local_tid_79133) - sext_i32_i64(skip_threads_79196))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79195 == (int8_t) 2 || flg_y_79195 == (int8_t) 0) {\n                                                flg_x_79194 = flg_y_79195;\n                                                eta_p_79191 = eta_p_79192;\n                                            } else {\n                                                int64_t defunc_0_op_res_79193 = add64(eta_p_79191, eta_p_79192);\n                                                \n                                                eta_p_79191 = defunc_0_op_res_79193;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_79140)[sext_i32_i64(local_tid_79133)] = flg_x_79194;\n                                            flg_y_79195 = flg_x_79194;\n                                            ((volatile __local int64_t *) local_mem_79140)[(int64_t) 4 + sext_i32_i64(local_tid_79133)] = eta_p_79191;\n                                            eta_p_79192 = eta_p_79191;\n                                        }\n                ", "                    }\n                                    skip_threads_79196 *= 2;\n                                }\n                            }\n                        }\n                        flag_79190 = ((__local int8_t *) local_mem_79140)[sext_i32_i64(wave_sizze_79135) - (int64_t) 1];\n                        aggr_79189 = ((__local int64_t *) local_mem_79140)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79135) - (int64_t) 1)];\n                        if (flag_79190 == (int8_t) 2) {\n                            readOffset_79187 = wave_sizze_79135 * -1;\n                        } else if (flag_79190 == (int8_t) 1) {\n                            readOffset_79187 -= wave_sizze_79135;\n                        }\n                        if (slt8((int8_t) 0, flag_79190)) {\n                            int64_t eta_p_79197 = aggr_79189;\n                            int64_t eta_p_79198 = prefix_79183;\n                            int64_t defunc_0_op_res_79199 = add64(eta_p_79197, eta_p_79198);\n                            \n                            prefix_79183 = defunc_0_op_res_79199;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79133 == 0) {\n                    if (boundary_79153 == sext_i64_i32(segscan_tblock_sizze_70720 * chunk_sizze_79081)) {\n                        int64_t eta_p_79200 = prefix_79183;\n                        int64_t eta_p_79201 = acc_79173;\n                        int64_t defunc_0_op_res_79202 = add64(eta_p_79200, eta_p_79201);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79108)[dynamic_id_79150] = defunc_0_op_res_79202;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79084)[dynamic_id_79150] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79140)[(int64_t) 4] = prefix_79183;\n                    acc_79173 = (int64_",
                                    "t) 0;\n                }\n            }\n            if (!(dynamic_id_79150 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79183 = ((__local int64_t *) local_mem_79140)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79203;\n            int64_t eta_p_79204;\n            int64_t eta_p_79206 = prefix_79183;\n            int64_t eta_p_79207 = acc_79173;\n            \n            if (slt32(local_tid_79133 * chunk_sizze_32b_79137, boundary_79153) && !block_new_sgm_79184) {\n                int64_t defunc_0_op_res_79208 = add64(eta_p_79206, eta_p_79207);\n                \n                eta_p_79203 = defunc_0_op_res_79208;\n            } else {\n                eta_p_79203 = acc_79173;\n            }\n            \n            int32_t stopping_point_79209 = segsizze_compact_79154 - srem32(local_tid_79133 * chunk_sizze_32b_79137 - 1 + segsizze_compact_79154 - boundary_79153, segsizze_compact_79154);\n            \n            for (int64_t i_79210 = 0; i_79210 < chunk_sizze_79081; i_79210++) {\n                if (slt32(sext_i64_i32(i_79210), stopping_point_79209 - 1)) {\n                    eta_p_79204 = private_mem_79155[i_79210];\n                    \n                    int64_t defunc_0_op_res_79205 = add64(eta_p_79203, eta_p_79204);\n                    \n                    private_mem_79155[i_79210] = defunc_0_op_res_79205;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_79211 = 0; i_79211 < chunk_sizze_79081; i_79211++) {\n                int64_t sharedIdx_79212 = sext_i32_i64(local_tid_79133) * chunk_sizze_79081 + i_79211;\n                int64_t tmp_79213 = private_mem_79155[i_79211];\n                \n                ((__local int64_t *) local_mem_79140)[sharedIdx_79212] = tmp_79213;\n            }\n            barrier(CLK_LOCAL_MEM_", "FENCE);\n            for (int64_t i_79214 = 0; i_79214 < chunk_sizze_79081; i_79214++) {\n                int64_t flat_idx_79215 = thd_offset_79157 + i_79214 * segscan_tblock_sizze_70720;\n                int64_t slice_79216 = nR_39348;\n                int64_t gtid_70724 = flat_idx_79215;\n                int64_t remnant_79217 = flat_idx_79215 - gtid_70724;\n                \n                if (slt64(flat_idx_79215, nR_39348)) {\n                    int64_t tmp_79218 = ((__local int64_t *) local_mem_79140)[flat_idx_79215 - block_offset_79151];\n                    \n                    ((__global int64_t *) mem_78099)[gtid_70724] = tmp_79218;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_70720\n    #undef chunk_sizze_79081\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegscan_70741_dim1, 1, 1)\nvoid inner_SMJ_shortzisegscan_70741(__global int *global_failure, int64_t m_67844, int64_t num_tblocks_70738, int64_t num_virt_blocks_79239, int64_t num_virt_threads_79240, __global unsigned char *mem_78103, __global unsigned char *mem_78113, __global unsigned char *mem_78115, __global unsigned char *mem_78117, __global unsigned char *status_flags_mem_79241, __global unsigned char *aggregates_mem_79243, __global unsigned char *incprefixes_mem_79245, __global unsigned char *aggregates_mem_79247, __global unsigned char *incprefixes_mem_79249, __global unsigned char *global_dynid_mem_79251)\n{\n    #define segscan_tblock_sizze_70736 (inner_SMJ_shortzisegscan_70741zisegscan_tblock_sizze_70736)\n    #define chunk_sizze_79238 (inner_SMJ_shortzisegscan_70741zichunk_sizze_79238)\n    \n    volatile __local unsigned char *local_mem_79263_backing_0 = &shared_mem[0];\n    const int64_t local_mem_79263_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70736, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70736), smax64(chunk_sizze_79238 * segs", "can_tblock_sizze_70736 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70736, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70736), smax64(chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_79254;\n    int32_t tblock_sizze_79257;\n    int32_t wave_sizze_79256;\n    int32_t block_id_79255;\n    int32_t global_tid_79253;\n    int64_t phys_tid_70741;\n    int32_t chunk_sizze_32b_79258;\n    int64_t byte_offsets_79259;\n    int64_t byte_offsets_79260;\n    int64_t warp_byte_offset_79261;\n    int64_t warp_byte_offset_79262;\n    __local unsigned char *local_mem_79263;\n    int64_t trans_arr_len_79264;\n    int64_t phys_block_id_79273;\n    int64_t virtloop_bound_79274;\n    \n    local_tid_79254 = get_local_id(0);\n    tblock_sizze_79257 = get_local_size(0);\n    wave_sizze_79256 = LOCKSTEP_WIDTH;\n    block_id_79255 = get_tblock_id(0);\n    global_tid_79253 = block_id_79255 * tblock_sizze_79257 + local_tid_79254;\n    phys_tid_70741 = sext_i32_i64(global_tid_79253);\n    chunk_sizze_32b_79258 = sext_i64_i32(chunk_sizze_79238);\n    byte_offsets_79259 = segscan_tblock_sizze_70736 * (int64_t) 8;\n    byte_offsets_79260 = sdiv_up64(byte_offsets_79259, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_70736 * (int64_t) 8;\n    warp_byte_offset_79261 = (int64_t) 288;\n    warp_byte_offset_79262 = sdiv_up64(warp_byte_offset_79261, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_79263 = (__local unsigned char *) local_mem_79263_backing_0;\n    trans_arr_len_79264 = chunk_sizze_79238 * segscan_tblock_sizze_70736;\n    phys_block_id_79273 = get_tblock_id(0);\n    virtloop_bound_79274 = sdiv_up64(num_virt_blocks_79239 - phy",
                                    "s_block_id_79273, num_tblocks_70738);\n    for (int64_t virtloop_i_79275 = 0; virtloop_i_79275 < virtloop_bound_79274; virtloop_i_79275++) {\n        int64_t dynamic_id_79276;\n        int64_t block_offset_79277;\n        int64_t sgm_idx_79278;\n        int32_t boundary_79279;\n        int32_t segsizze_compact_79280;\n        int64_t private_mem_79281[chunk_sizze_79238];\n        int64_t private_mem_79283[chunk_sizze_79238];\n        int64_t thd_offset_79285;\n        int64_t acc_79311;\n        int64_t acc_79312;\n        int64_t prefix_79325;\n        int64_t prefix_79326;\n        bool block_new_sgm_79327;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_79254 == 0) {\n                dynamic_id_79276 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_79251)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 0] = dynamic_id_79276;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_79276 == num_virt_blocks_79239 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_79251)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_79276 = ((__local int32_t *) local_mem_79263)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_79277 = dynamic_id_79276 * chunk_sizze_79238 * segscan_tblock_sizze_70736;\n        sgm_idx_79278 = smod64(block_offset_79277, m_67844);\n        boundary_79279 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_70736, m_67844 - sgm_idx_79278));\n        segsizze_compact_79280 = sext_i64_i32(smin64(chunk_sizze_79238 * segscan_tblock_sizze_70736, m_67844));\n        thd_offset_79285 = block_offset_79277 + sext_i32_i64(local_tid_79254);\n       ", " // Load and map\n        {\n            for (int64_t i_79286 = 0; i_79286 < chunk_sizze_79238; i_79286++) {\n                int64_t virt_tid_79287 = thd_offset_79285 + i_79286 * segscan_tblock_sizze_70736;\n                int64_t slice_79288 = m_67844;\n                int64_t gtid_70740 = virt_tid_79287;\n                int64_t remnant_79289 = virt_tid_79287 - gtid_70740;\n                \n                if (slt64(virt_tid_79287, m_67844)) {\n                    int64_t x_68125 = ((__global int64_t *) mem_78103)[gtid_70740];\n                    bool lifted_lambda_res_68127 = slt64((int64_t) 1, x_68125);\n                    int64_t defunc_0_f_res_68128 = btoi_bool_i64(lifted_lambda_res_68127);\n                    \n                    ((__global int64_t *) mem_78117)[gtid_70740] = defunc_0_f_res_68128;\n                    private_mem_79281[i_79286] = x_68125;\n                    private_mem_79283[i_79286] = defunc_0_f_res_68128;\n                } else {\n                    private_mem_79281[i_79286] = (int64_t) 0;\n                    private_mem_79283[i_79286] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_79290 = 0; i_79290 < chunk_sizze_79238; i_79290++) {\n                int64_t sharedIdx_79291 = sext_i32_i64(local_tid_79254) + i_79290 * segscan_tblock_sizze_70736;\n                int64_t tmp_79292 = private_mem_79281[i_79290];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79291] = tmp_79292;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79293 = 0; i_79293 < chunk_sizze_79238; i_79293++) {\n                int64_t sharedIdx_79294 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79293;\n                int64_t tmp_79295 = ((__local int64_t *) local_mem_79263)[sharedIdx_79294];\n                \n                private_mem_79281[i_79293] = tmp_79295;\n            }\n            ba", "rrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79296 = 0; i_79296 < chunk_sizze_79238; i_79296++) {\n                int64_t sharedIdx_79297 = sext_i32_i64(local_tid_79254) + i_79296 * segscan_tblock_sizze_70736;\n                int64_t tmp_79298 = private_mem_79283[i_79296];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79297] = tmp_79298;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79299 = 0; i_79299 < chunk_sizze_79238; i_79299++) {\n                int64_t sharedIdx_79300 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79299;\n                int64_t tmp_79301 = ((__local int64_t *) local_mem_79263)[sharedIdx_79300];\n                \n                private_mem_79283[i_79299] = tmp_79301;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_79302 = 0; i_79302 < chunk_sizze_79238 - (int64_t) 1; i_79302++) {\n                int64_t eta_p_67881;\n                int64_t eta_p_67882;\n                \n                eta_p_67881 = private_mem_79281[i_79302];\n                eta_p_67882 = private_mem_79281[i_79302 + (int64_t) 1];\n                \n                int64_t eta_p_67974;\n                int64_t eta_p_67975;\n                \n                eta_p_67974 = private_mem_79283[i_79302];\n                eta_p_67975 = private_mem_79283[i_79302 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_67883 = add64(eta_p_67881, eta_p_67882);\n                int64_t defunc_0_op_res_67976 = add64(eta_p_67974, eta_p_67975);\n                \n                private_mem_79281[i_79302 + (int64_t) 1] = lifted_lambda_res_67883;\n                private_mem_79283[i_79302 + (int64_t) 1] = defunc_0_op_res_67976;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_79303 = private_mem_79281[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__",
                                    "local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = tmp_79303;\n            \n            int64_t tmp_79304 = private_mem_79283[chunk_sizze_79238 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = tmp_79304;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_79305;\n            int64_t eta_p_79306;\n            int64_t eta_p_79307;\n            int64_t eta_p_79308;\n            int64_t eta_p_79313;\n            int64_t eta_p_79314;\n            int64_t eta_p_79315;\n            int64_t eta_p_79316;\n            bool ltid_in_bounds_79319 = slt64(sext_i32_i64(local_tid_79254), num_virt_threads_79240);\n            int32_t skip_threads_79320;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_79319) {\n                    eta_p_79307 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                    eta_p_79308 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                    if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                        eta_p_79305 = eta_p_79307;\n                        eta_p_79306 = eta_p_79308;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_79320 = 1;\n                while (slt32(skip_threads_79320, 32)) {\n                    bool thread_active_79321 = sle32(skip_threads_79320, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && ltid_in_bounds_79319;\n                    \n                    if (thread_active_79321) {\n                        // read operands\n                        {\n                            eta_p_79305 = ((volatile __local int64_t *) local_mem_79", "263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320)];\n                            eta_p_79306 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79320))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_79321) {\n                            int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                            int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                            \n                            eta_p_79305 = lifted_lambda_res_79309;\n                            eta_p_79306 = defunc_0_op_res_79310;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_79321) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                            eta_p_79307 = eta_p_79305;\n                            ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                            eta_p_79308 = eta_p_79306;\n                        }\n                    }\n                    if (sle32(wave_sizze_79256, skip_threads_79320)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_79320 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 31 && ltid_in_bounds_79319) {\n      ", "              ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79305;\n                    ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(squot32(local_tid_79254, 32))] = eta_p_79306;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_79322;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                        eta_p_79315 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                        eta_p_79316 = ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                        if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                            eta_p_79313 = eta_p_79315;\n                            eta_p_79314 = eta_p_79316;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_79322 = 1;\n                    while (slt32(skip_threads_79322, 32)) {\n                        bool thread_active_79323 = sle32(skip_threads_79322, local_tid_79254 - squot32(local_tid_79254, 32) * 32) && (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319);\n                        \n                        if (thread_active_79323) {\n                            // read operands\n                            {\n                                eta_p_79313 = ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322)];\n                                eta_p_79314 = ((volatile __local int64_t *) local_m",
                                    "em_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79322))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_79323) {\n                                int64_t lifted_lambda_res_79317 = add64(eta_p_79313, eta_p_79315);\n                                int64_t defunc_0_op_res_79318 = add64(eta_p_79314, eta_p_79316);\n                                \n                                eta_p_79313 = lifted_lambda_res_79317;\n                                eta_p_79314 = defunc_0_op_res_79318;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_79323) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79313;\n                                eta_p_79315 = eta_p_79313;\n                                ((volatile __local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79314;\n                                eta_p_79316 = eta_p_79314;\n                            }\n                        }\n                        if (sle32(wave_sizze_79256, skip_threads_79322)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_79322 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_79324 = squot32(local_tid_79254, 32) == 0 || !ltid_in_bounds_79319;\n            \n            // carry-in for every block except the first\n            {\n                // rea", "d operands\n                {\n                    if (!no_carry_in_79324) {\n                        eta_p_79307 = eta_p_79305;\n                        eta_p_79308 = eta_p_79306;\n                        eta_p_79305 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1];\n                        eta_p_79306 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_79254, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_79324) {\n                        int64_t lifted_lambda_res_79309 = add64(eta_p_79305, eta_p_79307);\n                        int64_t defunc_0_op_res_79310 = add64(eta_p_79306, eta_p_79308);\n                        \n                        eta_p_79305 = lifted_lambda_res_79309;\n                        eta_p_79306 = defunc_0_op_res_79310;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_79324) {\n                        ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79305;\n                        ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79306;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_79254, 32) == 0 && ltid_in_bounds_79319) {\n                    ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = eta_p_79307;\n                    ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79308;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid", "_79254 == 0) {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[segscan_tblock_sizze_70736 - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (segscan_tblock_sizze_70736 - (int64_t) 1)];\n            } else {\n                acc_79311 = ((__local int64_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - (int64_t) 1];\n                acc_79312 = ((__local int64_t *) local_mem_79263)[squot64(byte_offsets_79259, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_79325 = (int64_t) 0;\n        prefix_79326 = (int64_t) 0;\n        block_new_sgm_79327 = sgm_idx_79278 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_79327 && local_tid_79254 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = acc_79311;\n                ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276] = acc_79312;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                acc_79311 = (int64_t) 0;\n                acc_79312 = (int64_t) 0;\n            }\n            if (!block_new_sgm_79327 && slt32(local_tid_79254, wave_sizze_79256)) {\n                if (local_tid_79254 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_79243)[dynamic_id_79276] = acc_79311;\n                    ((volatile __global int64_t *) aggregates_mem_79247)[dynamic_id_79276] = acc_79312;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 1;\n                    \n                    int8_t tmp_79328 = ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *",
                                    ") local_mem_79263)[(int64_t) 0] = tmp_79328;\n                }\n                mem_fence_local();\n                \n                int8_t status_79329 = ((__local int8_t *) local_mem_79263)[(int64_t) 0];\n                \n                if (status_79329 == (int8_t) 2) {\n                    if (local_tid_79254 == 0) {\n                        prefix_79325 = ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276 - (int64_t) 1];\n                        prefix_79326 = ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_79330 = sext_i64_i32(dynamic_id_79276 - sext_i32_i64(wave_sizze_79256));\n                    \n                    while (slt32(wave_sizze_79256 * -1, readOffset_79330)) {\n                        int32_t read_i_79331 = readOffset_79330 + local_tid_79254;\n                        int64_t aggr_79332 = (int64_t) 0;\n                        int64_t aggr_79333 = (int64_t) 0;\n                        int8_t flag_79334 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_79331)) {\n                            flag_79334 = ((volatile __global int8_t *) status_flags_mem_79241)[sext_i32_i64(read_i_79331)];\n                            if (flag_79334 == (int8_t) 2) {\n                                aggr_79332 = ((volatile __global int64_t *) incprefixes_mem_79245)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) incprefixes_mem_79249)[sext_i32_i64(read_i_79331)];\n                            } else if (flag_79334 == (int8_t) 1) {\n                                aggr_79332 = ((volatile __global int64_t *) aggregates_mem_79243)[sext_i32_i64(read_i_79331)];\n                                aggr_79333 = ((volatile __global int64_t *) aggregates_mem_79247)[sext_i32_i64(read_i_79331)];\n                            }\n                        }\n                     ", "   ((__local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = aggr_79332;\n                        ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = aggr_79333;\n                        ((__local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flag_79334;\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze_79256) - (int64_t) 1];\n                        if (slt8(flag_79334, (int8_t) 2)) {\n                            int8_t flg_x_79341;\n                            int8_t flg_y_79342;\n                            int64_t eta_p_79335;\n                            int64_t eta_p_79336;\n                            int64_t eta_p_79337;\n                            int64_t eta_p_79338;\n                            int32_t skip_threads_79343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_79342 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)];\n                                eta_p_79337 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)];\n                                eta_p_79338 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)];\n                                if ((local_tid_79254 - squot32(local_tid_79254, 32) * 32) == 0) {\n                                    eta_p_79335 = eta_p_79337;\n                                    eta_p_79336 = eta_p_79338;\n                                    flg_x_79341 = flg_y_79342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_79343 = 1;\n                                while (slt32", "(skip_threads_79343, 32)) {\n                                    if (sle32(skip_threads_79343, local_tid_79254 - squot32(local_tid_79254, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_79341 = ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343)];\n                                            eta_p_79335 = ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                            eta_p_79336 = ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(local_tid_79254) - sext_i32_i64(skip_threads_79343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_79342 == (int8_t) 2 || flg_y_79342 == (int8_t) 0) {\n                                                flg_x_79341 = flg_y_79342;\n                                                eta_p_79335 = eta_p_79337;\n                                                eta_p_79336 = eta_p_79338;\n                                            } else {\n                                                int64_t lifted_lambda_res_79339 = add64(eta_p_79335, eta_p_79337);\n                                                int64_t defunc_0_op_res_79340 = add64(eta_p_79336, eta_p_79338);\n                                                \n                                                eta_p_79335 = lifted_lambda_res_79339;\n                                                eta_p_79336 = defunc_0_op_res_79340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n       ",
                                    "                                     ((volatile __local int8_t *) local_mem_79263)[sext_i32_i64(local_tid_79254)] = flg_x_79341;\n                                            flg_y_79342 = flg_x_79341;\n                                            ((volatile __local int64_t *) local_mem_79263)[(int64_t) 4 + sext_i32_i64(local_tid_79254)] = eta_p_79335;\n                                            eta_p_79337 = eta_p_79335;\n                                            ((volatile __local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + sext_i32_i64(local_tid_79254)] = eta_p_79336;\n                                            eta_p_79338 = eta_p_79336;\n                                        }\n                                    }\n                                    skip_threads_79343 *= 2;\n                                }\n                            }\n                        }\n                        flag_79334 = ((__local int8_t *) local_mem_79263)[sext_i32_i64(wave_sizze_79256) - (int64_t) 1];\n                        aggr_79332 = ((__local int64_t *) local_mem_79263)[(int64_t) 4 + (sext_i32_i64(wave_sizze_79256) - (int64_t) 1)];\n                        aggr_79333 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8) + (sext_i32_i64(wave_sizze_79256) - (int64_t) 1)];\n                        if (flag_79334 == (int8_t) 2) {\n                            readOffset_79330 = wave_sizze_79256 * -1;\n                        } else if (flag_79334 == (int8_t) 1) {\n                            readOffset_79330 -= wave_sizze_79256;\n                        }\n                        if (slt8((int8_t) 0, flag_79334)) {\n                            int64_t eta_p_79344 = aggr_79332;\n                            int64_t eta_p_79345 = aggr_79333;\n                            int64_t eta_p_79346 = prefix_79325;\n                            int64_t eta_p_79347 = prefix_79326;\n                            int64_t lifted_lambda_res_79348 = add64(e", "ta_p_79344, eta_p_79346);\n                            int64_t defunc_0_op_res_79349 = add64(eta_p_79345, eta_p_79347);\n                            \n                            prefix_79325 = lifted_lambda_res_79348;\n                            prefix_79326 = defunc_0_op_res_79349;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_79254 == 0) {\n                    if (boundary_79279 == sext_i64_i32(segscan_tblock_sizze_70736 * chunk_sizze_79238)) {\n                        int64_t eta_p_79350 = prefix_79325;\n                        int64_t eta_p_79351 = prefix_79326;\n                        int64_t eta_p_79352 = acc_79311;\n                        int64_t eta_p_79353 = acc_79312;\n                        int64_t lifted_lambda_res_79354 = add64(eta_p_79350, eta_p_79352);\n                        int64_t defunc_0_op_res_79355 = add64(eta_p_79351, eta_p_79353);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_79245)[dynamic_id_79276] = lifted_lambda_res_79354;\n                        ((volatile __global int64_t *) incprefixes_mem_79249)[dynamic_id_79276] = defunc_0_op_res_79355;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_79241)[dynamic_id_79276] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_79263)[(int64_t) 4] = prefix_79325;\n                    ((__local int64_t *) local_mem_79263)[squot64(warp_byte_offset_79261, (int64_t) 8)] = prefix_79326;\n                    acc_79311 = (int64_t) 0;\n                    acc_79312 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_79276 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_79325 = ((__local int64_t *) local_mem_79263)[(int64_t) 4];\n                prefix_79326 = ((__local int64_t *) local_mem_79263)[squot64(warp_byte_o", "ffset_79261, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_79356;\n            int64_t eta_p_79358;\n            int64_t eta_p_79362 = prefix_79325;\n            int64_t eta_p_79364 = acc_79311;\n            int64_t eta_p_79357;\n            int64_t eta_p_79359;\n            int64_t eta_p_79363 = prefix_79326;\n            int64_t eta_p_79365 = acc_79312;\n            \n            if (slt32(local_tid_79254 * chunk_sizze_32b_79258, boundary_79279) && !block_new_sgm_79327) {\n                int64_t lifted_lambda_res_79366 = add64(eta_p_79362, eta_p_79364);\n                int64_t defunc_0_op_res_79367 = add64(eta_p_79363, eta_p_79365);\n                \n                eta_p_79356 = lifted_lambda_res_79366;\n                eta_p_79357 = defunc_0_op_res_79367;\n            } else {\n                eta_p_79356 = acc_79311;\n                eta_p_79357 = acc_79312;\n            }\n            \n            int32_t stopping_point_79368 = segsizze_compact_79280 - srem32(local_tid_79254 * chunk_sizze_32b_79258 - 1 + segsizze_compact_79280 - boundary_79279, segsizze_compact_79280);\n            \n            for (int64_t i_79369 = 0; i_79369 < chunk_sizze_79238; i_79369++) {\n                if (slt32(sext_i64_i32(i_79369), stopping_point_79368 - 1)) {\n                    eta_p_79358 = private_mem_79281[i_79369];\n                    eta_p_79359 = private_mem_79283[i_79369];\n                    \n                    int64_t lifted_lambda_res_79360 = add64(eta_p_79356, eta_p_79358);\n                    int64_t defunc_0_op_res_79361 = add64(eta_p_79357, eta_p_79359);\n                    \n                    private_mem_79281[i_79369] = lifted_lambda_res_79360;\n                    private_mem_79283[i_79369] = defunc_0_op_res_79361;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_7",
                                    "9370 = 0; i_79370 < chunk_sizze_79238; i_79370++) {\n                int64_t sharedIdx_79371 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79370;\n                int64_t tmp_79372 = private_mem_79281[i_79370];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79371] = tmp_79372;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79373 = 0; i_79373 < chunk_sizze_79238; i_79373++) {\n                int64_t flat_idx_79374 = thd_offset_79285 + i_79373 * segscan_tblock_sizze_70736;\n                int64_t slice_79375 = m_67844;\n                int64_t gtid_70740 = flat_idx_79374;\n                int64_t remnant_79376 = flat_idx_79374 - gtid_70740;\n                \n                if (slt64(flat_idx_79374, m_67844)) {\n                    int64_t tmp_79377 = ((__local int64_t *) local_mem_79263)[flat_idx_79374 - block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78113)[gtid_70740] = tmp_79377;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79378 = 0; i_79378 < chunk_sizze_79238; i_79378++) {\n                int64_t sharedIdx_79379 = sext_i32_i64(local_tid_79254) * chunk_sizze_79238 + i_79378;\n                int64_t tmp_79380 = private_mem_79283[i_79378];\n                \n                ((__local int64_t *) local_mem_79263)[sharedIdx_79379] = tmp_79380;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_79381 = 0; i_79381 < chunk_sizze_79238; i_79381++) {\n                int64_t flat_idx_79382 = thd_offset_79285 + i_79381 * segscan_tblock_sizze_70736;\n                int64_t slice_79383 = m_67844;\n                int64_t gtid_70740 = flat_idx_79382;\n                int64_t remnant_79384 = flat_idx_79382 - gtid_70740;\n                \n                if (slt64(flat_idx_79382, m_67844)) {\n                    int64_t tmp_79385 = ((__local int64_t *) local_mem_79263)[flat_idx_79382 - ", "block_offset_79277];\n                    \n                    ((__global int64_t *) mem_78115)[gtid_70740] = tmp_79385;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_70736\n    #undef chunk_sizze_79238\n}\nFUTHARK_KERNEL_SIZED(max_idxzisegred_nonseg_68931_dim1, 1, 1)\nvoid max_idxzisegred_nonseg_68931(__global int *global_failure, int64_t nz2080U_62616, int64_t num_tblocks_68926, int64_t num_threads_78727, __global unsigned char *eta_p_mem_77625, __global unsigned char *mem_77627, __global unsigned char *counters_mem_78703, __global unsigned char *segred_tmp_mem_78725)\n{\n    #define segred_tblock_sizze_68924 (max_idxzisegred_nonseg_68931zisegred_tblock_sizze_68924)\n    #define chunk_sizze_78702 (max_idxzisegred_nonseg_68931zichunk_sizze_78702)\n    \n    volatile __local unsigned char *sync_arr_mem_78735_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_78735_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_78733_backing_0 = &shared_mem[sync_arr_mem_78735_backing_1_offset];\n    const int64_t red_arr_i64_mem_78733_backing_0_offset = sync_arr_mem_78735_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_68924 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_68924, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78729;\n    int32_t tblock_sizze_78732;\n    int32_t wave_sizze_78731;\n    int32_t block_id_78730;\n    int32_t global_tid_78728;\n    int64_t phys_tid_68931;\n    __local unsigned char *red_arr_i64_mem_78733;\n    __local unsigned char *sync_arr_mem_78735;\n    int64_t dummy_68929;\n    int64_t gtid_68930;\n    int64_t q_78737;\n    int64_t eta_p_block_res_acc_78738;\n    int64_t eta_p_63503;\n    int64_t eta_p_63504;\n    int64_t tblock_id_in_segment_78742;\n    int64_t block_base_offset_78743;\n    int32_t offset_78746;\n    int32_t skip_waves_78747;\n    int64_t eta", "_p_78739;\n    int64_t eta_p_78740;\n    int32_t old_counter_78748;\n    bool is_last_block_78749;\n    \n    local_tid_78729 = get_local_id(0);\n    tblock_sizze_78732 = get_local_size(0);\n    wave_sizze_78731 = LOCKSTEP_WIDTH;\n    block_id_78730 = get_tblock_id(0);\n    global_tid_78728 = block_id_78730 * tblock_sizze_78732 + local_tid_78729;\n    phys_tid_68931 = sext_i32_i64(global_tid_78728);\n    red_arr_i64_mem_78733 = (__local unsigned char *) red_arr_i64_mem_78733_backing_0;\n    sync_arr_mem_78735 = (__local unsigned char *) sync_arr_mem_78735_backing_1;\n    dummy_68929 = (int64_t) 0;\n    gtid_68930 = (int64_t) 0;\n    q_78737 = sdiv_up64(nz2080U_62616, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_68924 * num_tblocks_68926)) * chunk_sizze_78702);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_78738 = (int64_t) -9223372036854775808;\n    }\n    tblock_id_in_segment_78742 = squot64(phys_tid_68931, segred_tblock_sizze_68924);\n    block_base_offset_78743 = tblock_id_in_segment_78742 * q_78737 * segred_tblock_sizze_68924;\n    for (int64_t i_78744 = 0; i_78744 < q_78737; i_78744++) {\n        int64_t block_offset_78745 = block_base_offset_78743 + i_78744 * segred_tblock_sizze_68924;\n        \n        gtid_68930 = phys_tid_68931 + num_threads_78727 * i_78744;\n        if (slt64(gtid_68930, nz2080U_62616)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_63502 = ((__global int64_t *) eta_p_mem_77625)[gtid_68930];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_63503 = eta_p_block_res_acc_78738;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_63504 = x_63502;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t max_res_63505 = smax64(eta_p_6",
                                    "3503, eta_p_63504);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_78738 = max_res_63505;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_block_res_acc_78738;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_78747 = 1;\n    offset_78746 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_78729, sext_i64_i32(segred_tblock_sizze_68924))) {\n            eta_p_78739 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n        }\n    }\n    offset_78746 = 1;\n    while (slt32(offset_78746, wave_sizze_78731)) {\n        if (slt32(local_tid_78729 + offset_78746, sext_i64_i32(segred_tblock_sizze_68924)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) & (2 * offset_78746 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_78740 = ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_78741 = smax64(eta_p_78739, eta_p_78740);\n                \n                eta_p_78739 = max_res_78741;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n            }\n        }\n        offset_78746 *= 2;\n    }\n    while (slt32(skip_waves_78747, squot32(sext_i64_i32(segred_tblock_sizze_68924) + wave_sizze_78731 - 1, wave_sizze_78731))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_78746 = skip_waves_78747 * wave_siz", "ze_78731;\n        if (slt32(local_tid_78729 + offset_78746, sext_i64_i32(segred_tblock_sizze_68924)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) == 0 && (squot32(local_tid_78729, wave_sizze_78731) & (2 * skip_waves_78747 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_78740 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_78741 = smax64(eta_p_78739, eta_p_78740);\n                \n                eta_p_78739 = max_res_78741;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n            }\n        }\n        skip_waves_78747 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_78729) == (int64_t) 0) {\n            eta_p_block_res_acc_78738 = eta_p_78739;\n        } else {\n            eta_p_block_res_acc_78738 = (int64_t) -9223372036854775808;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_78729 == 0) {\n            ((__global int64_t *) segred_tmp_mem_78725)[sext_i32_i64(block_id_78730)] = eta_p_block_res_acc_78738;\n            mem_fence_global();\n            old_counter_78748 = atomic_add_i32_global(&((volatile __global int *) counters_mem_78703)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_78735)[(int64_t) 0] = old_counter_78748 == sext_i64_i32(num_tblocks_68926 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_78749 = ((__local bool *) sync_arr_mem_78735)[(int64_t) 0];\n    if (is_last_block_78749) {\n        if (local_tid_78729 == 0) {\n            old_counter_78748 ", "= atomic_add_i32_global(&((volatile __global int *) counters_mem_78703)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_68926));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_78750 = sdiv_up64(num_tblocks_68926, segred_tblock_sizze_68924);\n            \n            eta_p_63503 = (int64_t) -9223372036854775808;\n            for (int64_t i_78751 = 0; i_78751 < read_per_thread_78750; i_78751++) {\n                int64_t block_res_id_78752 = sext_i32_i64(local_tid_78729) * read_per_thread_78750 + i_78751;\n                int64_t index_of_block_res_78753 = block_res_id_78752;\n                \n                if (slt64(block_res_id_78752, num_tblocks_68926)) {\n                    eta_p_63504 = ((__global int64_t *) segred_tmp_mem_78725)[index_of_block_res_78753];\n                    \n                    int64_t max_res_63505 = smax64(eta_p_63503, eta_p_63504);\n                    \n                    eta_p_63503 = max_res_63505;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_63503;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_78754;\n            int32_t skip_waves_78755 = 1;\n            int64_t eta_p_78739;\n            int64_t eta_p_78740;\n            \n            offset_78754 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_78729, sext_i64_i32(segred_tblock_sizze_68924))) {\n                    eta_p_78739 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                }\n            }\n            offset_78754 = 1;\n            while (slt32(offset_78754, wave_sizze_78731)) {\n                if (slt32(local_tid_78729 + offset_78754, sext_i64_i32(segred_tblock_sizze_68924)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78",
                                    "731) & (2 * offset_78754 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_78740 = ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_78741 = smax64(eta_p_78739, eta_p_78740);\n                        \n                        eta_p_78739 = max_res_78741;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n                    }\n                }\n                offset_78754 *= 2;\n            }\n            while (slt32(skip_waves_78755, squot32(sext_i64_i32(segred_tblock_sizze_68924) + wave_sizze_78731 - 1, wave_sizze_78731))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_78754 = skip_waves_78755 * wave_sizze_78731;\n                if (slt32(local_tid_78729 + offset_78754, sext_i64_i32(segred_tblock_sizze_68924)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) == 0 && (squot32(local_tid_78729, wave_sizze_78731) & (2 * skip_waves_78755 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_78740 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_78741 = smax64(eta_p_78739, eta_p_78740);\n                        \n                        eta_p_78739 = max_res_78741;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n                    }", "\n                }\n                skip_waves_78755 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_78729 == 0) {\n                    ((__global int64_t *) mem_77627)[(int64_t) 0] = eta_p_78739;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_68924\n    #undef chunk_sizze_78702\n}\nFUTHARK_KERNEL_SIZED(min_idxzisegred_nonseg_68921_dim1, 1, 1)\nvoid min_idxzisegred_nonseg_68921(__global int *global_failure, int64_t nz2080U_62579, int64_t num_tblocks_68916, int64_t num_threads_78727, __global unsigned char *eta_p_mem_77625, __global unsigned char *mem_77627, __global unsigned char *counters_mem_78703, __global unsigned char *segred_tmp_mem_78725)\n{\n    #define segred_tblock_sizze_68914 (min_idxzisegred_nonseg_68921zisegred_tblock_sizze_68914)\n    #define chunk_sizze_78702 (min_idxzisegred_nonseg_68921zichunk_sizze_78702)\n    \n    volatile __local unsigned char *sync_arr_mem_78735_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_78735_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_78733_backing_0 = &shared_mem[sync_arr_mem_78735_backing_1_offset];\n    const int64_t red_arr_i64_mem_78733_backing_0_offset = sync_arr_mem_78735_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_68914 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_68914, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_78729;\n    int32_t tblock_sizze_78732;\n    int32_t wave_sizze_78731;\n    int32_t block_id_78730;\n    int32_t global_tid_78728;\n    int64_t phys_tid_68921;\n    __local unsigned char *red_arr_i64_mem_78733;\n    __local unsigned char *sync_arr_mem_78735;\n    int64_t dummy_68919;\n    int64_t gtid_68920;\n    int64_t q_78737;\n    int64_t eta_p_block_res_acc_78738;\n    int64_t eta_p_63503;\n    int64_t eta_p_63504;\n  ", "  int64_t tblock_id_in_segment_78742;\n    int64_t block_base_offset_78743;\n    int32_t offset_78746;\n    int32_t skip_waves_78747;\n    int64_t eta_p_78739;\n    int64_t eta_p_78740;\n    int32_t old_counter_78748;\n    bool is_last_block_78749;\n    \n    local_tid_78729 = get_local_id(0);\n    tblock_sizze_78732 = get_local_size(0);\n    wave_sizze_78731 = LOCKSTEP_WIDTH;\n    block_id_78730 = get_tblock_id(0);\n    global_tid_78728 = block_id_78730 * tblock_sizze_78732 + local_tid_78729;\n    phys_tid_68921 = sext_i32_i64(global_tid_78728);\n    red_arr_i64_mem_78733 = (__local unsigned char *) red_arr_i64_mem_78733_backing_0;\n    sync_arr_mem_78735 = (__local unsigned char *) sync_arr_mem_78735_backing_1;\n    dummy_68919 = (int64_t) 0;\n    gtid_68920 = (int64_t) 0;\n    q_78737 = sdiv_up64(nz2080U_62579, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_68914 * num_tblocks_68916)) * chunk_sizze_78702);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_78738 = (int64_t) 9223372036854775807;\n    }\n    tblock_id_in_segment_78742 = squot64(phys_tid_68921, segred_tblock_sizze_68914);\n    block_base_offset_78743 = tblock_id_in_segment_78742 * q_78737 * segred_tblock_sizze_68914;\n    for (int64_t i_78744 = 0; i_78744 < q_78737; i_78744++) {\n        int64_t block_offset_78745 = block_base_offset_78743 + i_78744 * segred_tblock_sizze_68914;\n        \n        gtid_68920 = phys_tid_68921 + num_threads_78727 * i_78744;\n        if (slt64(gtid_68920, nz2080U_62579)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_63502 = ((__global int64_t *) eta_p_mem_77625)[gtid_68920];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_63503 = eta_p_block_res_acc_78738;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_63504 = x_63502;\n            ",
                                    "        }\n                    // apply reduction operator(s)\n                    {\n                        int64_t min_res_63505 = smin64(eta_p_63503, eta_p_63504);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_78738 = min_res_63505;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_block_res_acc_78738;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_78747 = 1;\n    offset_78746 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_78729, sext_i64_i32(segred_tblock_sizze_68914))) {\n            eta_p_78739 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n        }\n    }\n    offset_78746 = 1;\n    while (slt32(offset_78746, wave_sizze_78731)) {\n        if (slt32(local_tid_78729 + offset_78746, sext_i64_i32(segred_tblock_sizze_68914)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) & (2 * offset_78746 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_78740 = ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n            }\n            // apply reduction operation\n            {\n                int64_t min_res_78741 = smin64(eta_p_78739, eta_p_78740);\n                \n                eta_p_78739 = min_res_78741;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n            }\n        }\n        offset_78746 *= 2;\n    }\n    while (slt32(skip_waves_78747, squot32(sext_i64_i32(segred_tblock_si", "zze_68914) + wave_sizze_78731 - 1, wave_sizze_78731))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_78746 = skip_waves_78747 * wave_sizze_78731;\n        if (slt32(local_tid_78729 + offset_78746, sext_i64_i32(segred_tblock_sizze_68914)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) == 0 && (squot32(local_tid_78729, wave_sizze_78731) & (2 * skip_waves_78747 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_78740 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78746)];\n            }\n            // apply reduction operation\n            {\n                int64_t min_res_78741 = smin64(eta_p_78739, eta_p_78740);\n                \n                eta_p_78739 = min_res_78741;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n            }\n        }\n        skip_waves_78747 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_78729) == (int64_t) 0) {\n            eta_p_block_res_acc_78738 = eta_p_78739;\n        } else {\n            eta_p_block_res_acc_78738 = (int64_t) 9223372036854775807;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_78729 == 0) {\n            ((__global int64_t *) segred_tmp_mem_78725)[sext_i32_i64(block_id_78730)] = eta_p_block_res_acc_78738;\n            mem_fence_global();\n            old_counter_78748 = atomic_add_i32_global(&((volatile __global int *) counters_mem_78703)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_78735)[(int64_t) 0] = old_counter_78748 == sext_i64_i32(num_tblocks_68916 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_78749 = ((__l", "ocal bool *) sync_arr_mem_78735)[(int64_t) 0];\n    if (is_last_block_78749) {\n        if (local_tid_78729 == 0) {\n            old_counter_78748 = atomic_add_i32_global(&((volatile __global int *) counters_mem_78703)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_68916));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_78750 = sdiv_up64(num_tblocks_68916, segred_tblock_sizze_68914);\n            \n            eta_p_63503 = (int64_t) 9223372036854775807;\n            for (int64_t i_78751 = 0; i_78751 < read_per_thread_78750; i_78751++) {\n                int64_t block_res_id_78752 = sext_i32_i64(local_tid_78729) * read_per_thread_78750 + i_78751;\n                int64_t index_of_block_res_78753 = block_res_id_78752;\n                \n                if (slt64(block_res_id_78752, num_tblocks_68916)) {\n                    eta_p_63504 = ((__global int64_t *) segred_tmp_mem_78725)[index_of_block_res_78753];\n                    \n                    int64_t min_res_63505 = smin64(eta_p_63503, eta_p_63504);\n                    \n                    eta_p_63503 = min_res_63505;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_63503;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_78754;\n            int32_t skip_waves_78755 = 1;\n            int64_t eta_p_78739;\n            int64_t eta_p_78740;\n            \n            offset_78754 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_78729, sext_i64_i32(segred_tblock_sizze_68914))) {\n                    eta_p_78739 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                }\n            }\n            offset_78754 = 1;\n            while (slt32(offset_78754, wave_sizze_78731)) {\n                if (slt32(local_tid_7",
                                    "8729 + offset_78754, sext_i64_i32(segred_tblock_sizze_68914)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) & (2 * offset_78754 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_78740 = ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t min_res_78741 = smin64(eta_p_78739, eta_p_78740);\n                        \n                        eta_p_78739 = min_res_78741;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n                    }\n                }\n                offset_78754 *= 2;\n            }\n            while (slt32(skip_waves_78755, squot32(sext_i64_i32(segred_tblock_sizze_68914) + wave_sizze_78731 - 1, wave_sizze_78731))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_78754 = skip_waves_78755 * wave_sizze_78731;\n                if (slt32(local_tid_78729 + offset_78754, sext_i64_i32(segred_tblock_sizze_68914)) && ((local_tid_78729 - squot32(local_tid_78729, wave_sizze_78731) * wave_sizze_78731) == 0 && (squot32(local_tid_78729, wave_sizze_78731) & (2 * skip_waves_78755 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_78740 = ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729 + offset_78754)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t min_res_78741 = smin64(eta_p_78739, eta_p_78740);\n                        \n                        eta_p_78739 = min_res_78741;\n                    }\n                    // write result of operation\n              ", "      {\n                        ((__local int64_t *) red_arr_i64_mem_78733)[sext_i32_i64(local_tid_78729)] = eta_p_78739;\n                    }\n                }\n                skip_waves_78755 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_78729 == 0) {\n                    ((__global int64_t *) mem_77627)[(int64_t) 0] = eta_p_78739;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_68914\n    #undef chunk_sizze_78702\n}\n", NULL};
// Start of gpu_prototypes.h

// Constants used for transpositions.  In principle these should be configurable.
#define TR_BLOCK_DIM 16
#define TR_TILE_DIM (TR_BLOCK_DIM*2)
#define TR_ELEMS_PER_THREAD 8

// Config stuff included in every GPU backend.
struct gpu_config {
  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_cache;
  size_t default_shared_memory;
  size_t default_registers;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;
};

// The following are dummy sizes that mean the concrete defaults
// will be set during initialisation via hardware-inspection-based
// heuristics.
struct gpu_config gpu_config_initial = {
  0
};

// Must be defined by the user.
static int gpu_macros(struct futhark_context *ctx, char*** names, int64_t** values);

static void gpu_init_log(struct futhark_context *ctx);
struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);
static int gpu_free_all(struct futhark_context *ctx);

// End of gpu_prototypes.h

// Start of backends/cuda.h.

// Forward declarations.
// Invoked by setup_opencl() after the platform and device has been
// found, but before the program is loaded.  Its intended use is to
// tune constants based on the selected platform and device.
static void set_tuning_params(struct futhark_context* ctx);
static char* get_failure_msg(int failure_idx, int64_t args[]);

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_FATAL(x) nvrtc_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_NONFATAL(x) nvrtc_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
// Take care not to override an existing error.
#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                               \
      if (!ctx->error) {                        \
        ctx->error = serror;                    \
      } else {                                  \
        free(serror);                           \
      }                                         \
      return bad;                               \
    }                                           \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
                                          const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
                                       const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed_fatal(nvrtcResult res, const char *call,
                                           const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* nvrtc_api_succeed_nonfatal(nvrtcResult res, const char *call,
                                        const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    return msgprintf("%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char* cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  char* program;
  int num_nvrtc_opts;
  char* *nvrtc_opts;

  char* preferred_device;
  int preferred_device_num;

  int unified_memory;

  char* dump_ptx_to;
  char* load_ptx_from;

  struct gpu_config gpu;
};

static void backend_context_config_setup(struct futhark_context_config *cfg) {
  cfg->num_nvrtc_opts = 0;
  cfg->nvrtc_opts = (char**) malloc(sizeof(char*));
  cfg->nvrtc_opts[0] = NULL;

  cfg->program = strconcat(gpu_program);

  cfg->preferred_device_num = 0;
  cfg->preferred_device = strdup("");

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->unified_memory = 2;

  cfg->gpu = gpu_config_initial;
  cfg->gpu.default_block_size = 256;
  cfg->gpu.default_tile_size = 32;
  cfg->gpu.default_reg_tile_size = 2;
  cfg->gpu.default_threshold = 32*1024;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  for (int i = 0; i < cfg->num_nvrtc_opts; i++) {
    free(cfg->nvrtc_opts[i]);
  }
  free(cfg->nvrtc_opts);
  free(cfg->dump_ptx_to);
  free(cfg->load_ptx_from);
  free(cfg->preferred_device);
  free(cfg->program);
}

void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt) {
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = strdup(opt);
  cfg->num_nvrtc_opts++;
  cfg->nvrtc_opts = (char **) realloc(cfg->nvrtc_opts, (cfg->num_nvrtc_opts + 1) * sizeof(char *));
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}

void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  free(cfg->preferred_device);
  cfg->preferred_device = strdup(s);
  cfg->preferred_device_num = x;
}

const char* futhark_context_config_get_program(struct futhark_context_config *cfg) {
  return cfg->program;
}

void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s) {
  free(cfg->program);
  cfg->program = strdup(s);
}

void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *path) {
  free(cfg->dump_ptx_to);
  cfg->dump_ptx_to = strdup(path);
}

void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *path) {
  free(cfg->load_ptx_from);
  cfg->load_ptx_from = strdup(path);
}

void futhark_context_config_set_unified_memory(struct futhark_context_config* cfg, int flag) {
  cfg->unified_memory = flag;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  const char *name;
};

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
  // Uniform fields above.

  CUdeviceptr global_failure;
  CUdeviceptr global_failure_args;
  struct tuning_params tuning_params;
  // True if a potentially failing kernel has been enqueued.
  int32_t failure_is_an_option;
  int total_runs;
  long int total_runtime;
  int64_t peak_mem_usage_device;
  int64_t cur_mem_usage_device;

  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;
  CUstream stream;

  struct free_list gpu_free_list;

  size_t max_thread_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;
  size_t max_registers;
  size_t max_cache;

  size_t lockstep_width;

  struct builtin_kernels* kernels;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static int cuda_device_setup(struct futhark_context *ctx) {
  struct futhark_context_config *cfg = ctx->cfg;
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best = 0, cc_minor_best = 0;
  int cc_major = 0, cc_minor = 0;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (cfg->logging) {
      fprintf(ctx->log, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
              i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (cfg->logging) {
        fprintf(ctx->log, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, cfg->preferred_device) != NULL &&
        num_device_matches++ == cfg->preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (cfg->logging) {
    fprintf(ctx->log, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  static struct {
    int major;
    int minor;
    const char *arch_str;
  } const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" },
    { 8, 6, "compute_80" },
    { 8, 7, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  int num_archs = sizeof(x)/sizeof(x[0]);
  for (int i = 0; i < num_archs; i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static void cuda_nvrtc_mk_build_options(struct futhark_context *ctx, const char *extra_opts[],
                                        char*** opts_out, size_t *n_opts) {
  int arch_set = 0, num_extra_opts;
  struct futhark_context_config *cfg = ctx->cfg;

  char** macro_names;
  int64_t* macro_vals;
  int num_macros = gpu_macros(ctx, &macro_names, &macro_vals);

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t i = 0, n_opts_alloc = 20 + num_macros + num_extra_opts + cfg->num_tuning_params;
  char **opts = (char**) malloc(n_opts_alloc * sizeof(char *));
  if (!arch_set) {
    opts[i++] = strdup("-arch");
    opts[i++] = strdup(cuda_nvrtc_get_arch(ctx->dev));
  }
  opts[i++] = strdup("-default-device");
  if (cfg->debugging) {
    opts[i++] = strdup("-G");
    opts[i++] = strdup("-lineinfo");
  } else {
    opts[i++] = strdup("--disable-warnings");
  }
  opts[i++] = msgprintf("-D%s=%d",
                        "max_thread_block_size",
                        (int)ctx->max_thread_block_size);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_shared_memory",
                        (int)ctx->max_shared_memory);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_registers",
                        (int)ctx->max_registers);

  for (int j = 0; j < num_macros; j++) {
    opts[i++] = msgprintf("-D%s=%zu", macro_names[j], macro_vals[j]);
  }

  for (int j = 0; j < cfg->num_tuning_params; j++) {
    opts[i++] = msgprintf("-D%s=%zu", cfg->tuning_param_vars[j],
                          cfg->tuning_params[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_thread_block_size);

  // Time for the best lines of the code in the entire compiler.
  if (getenv("CUDA_HOME") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_HOME"));
  }
  if (getenv("CUDA_ROOT") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_ROOT"));
  }
  if (getenv("CUDA_PATH") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_PATH"));
  }
  opts[i++] = msgprintf("-I/usr/local/cuda/include");
  opts[i++] = msgprintf("-I/usr/include");

  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = strdup(extra_opts[j]);
  }

  opts[i++] = msgprintf("-DTR_BLOCK_DIM=%d", TR_BLOCK_DIM);
  opts[i++] = msgprintf("-DTR_TILE_DIM=%d", TR_TILE_DIM);
  opts[i++] = msgprintf("-DTR_ELEMS_PER_THREAD=%d", TR_ELEMS_PER_THREAD);

  free(macro_names);
  free(macro_vals);

  *n_opts = i;
  *opts_out = opts;
}

static char* cuda_nvrtc_build(const char *src, const char *opts[], size_t n_opts,
                              char **ptx) {
  nvrtcProgram prog;
  char *problem = NULL;

  problem = NVRTC_SUCCEED_NONFATAL(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));

  if (problem) {
    return problem;
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        problem = msgprintf("NVRTC compilation failed.\n\n%s\n", log);
      } else {
        problem = msgprintf("Could not retrieve compilation log\n");
      }
      free(log);
    }
    return problem;
  }

  size_t ptx_size;
  NVRTC_SUCCEED_FATAL(nvrtcGetPTXSize(prog, &ptx_size));
  *ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED_FATAL(nvrtcGetPTX(prog, *ptx));

  NVRTC_SUCCEED_FATAL(nvrtcDestroyProgram(&prog));

  return NULL;
}

static void cuda_load_ptx_from_cache(struct futhark_context_config *cfg,
                                     const char *src,
                                     const char *opts[], size_t n_opts,
                                     struct cache_hash *h, const char *cache_fname,
                                     char **ptx) {
  if (cfg->logging) {
    fprintf(stderr, "Restoring cache from from %s...\n", cache_fname);
  }
  cache_hash_init(h);
  for (size_t i = 0; i < n_opts; i++) {
    cache_hash(h, opts[i], strlen(opts[i]));
  }
  cache_hash(h, src, strlen(src));
  size_t ptxsize;
  errno = 0;
  if (cache_restore(cache_fname, h, (unsigned char**)ptx, &ptxsize) != 0) {
    if (cfg->logging) {
      fprintf(stderr, "Failed to restore cache (errno: %s)\n", strerror(errno));
    }
  }
}

static void cuda_size_setup(struct futhark_context *ctx)
{
  struct futhark_context_config *cfg = ctx->cfg;
  if (cfg->gpu.default_block_size > ctx->max_thread_block_size) {
    if (cfg->gpu.default_block_size_changed) {
      fprintf(stderr,
              "Note: Device limits default block size to %zu (down from %zu).\n",
              ctx->max_thread_block_size, cfg->gpu.default_block_size);
    }
    cfg->gpu.default_block_size = ctx->max_thread_block_size;
  }
  if (cfg->gpu.default_grid_size > ctx->max_grid_size) {
    if (cfg->gpu.default_grid_size_changed) {
      fprintf(stderr,
              "Note: Device limits default grid size to %zu (down from %zu).\n",
              ctx->max_grid_size, cfg->gpu.default_grid_size);
    }
    cfg->gpu.default_grid_size = ctx->max_grid_size;
  }
  if (cfg->gpu.default_tile_size > ctx->max_tile_size) {
    if (cfg->gpu.default_tile_size_changed) {
      fprintf(stderr,
              "Note: Device limits default tile size to %zu (down from %zu).\n",
              ctx->max_tile_size, cfg->gpu.default_tile_size);
    }
    cfg->gpu.default_tile_size = ctx->max_tile_size;
  }

  if (!cfg->gpu.default_grid_size_changed) {
    cfg->gpu.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / cfg->gpu.default_block_size;
  }

  for (int i = 0; i < cfg->num_tuning_params; i++) {
    const char *size_class = cfg->tuning_param_classes[i];
    int64_t *size_value = &cfg->tuning_params[i];
    const char* size_name = cfg->tuning_param_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "thread_block_size") == size_class) {
      max_value = ctx->max_thread_block_size;
      default_value = cfg->gpu.default_block_size;
    } else if (strstr(size_class, "grid_size") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = cfg->gpu.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = cfg->gpu.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = cfg->gpu.default_reg_tile_size;
    } else if (strstr(size_class, "shared_memory") == size_class) {
      max_value = ctx->max_shared_memory;
      default_value = ctx->max_shared_memory;
    } else if (strstr(size_class, "cache") == size_class) {
      max_value = ctx->max_cache;
      default_value = ctx->max_cache;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = cfg->gpu.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static char* cuda_module_setup(struct futhark_context *ctx,
                               const char *src,
                               const char *extra_opts[],
                               const char* cache_fname) {
  char *ptx = NULL;
  struct futhark_context_config *cfg = ctx->cfg;

  if (cfg->load_ptx_from) {
    ptx = slurp_file(cfg->load_ptx_from, NULL);
  }

  char **opts;
  size_t n_opts;
  cuda_nvrtc_mk_build_options(ctx, extra_opts, &opts, &n_opts);

  if (cfg->logging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  struct cache_hash h;
  int loaded_ptx_from_cache = 0;
  if (cache_fname != NULL) {
    cuda_load_ptx_from_cache(cfg, src, (const char**)opts, n_opts, &h, cache_fname, &ptx);

    if (ptx != NULL) {
      if (cfg->logging) {
        fprintf(stderr, "Restored PTX from cache; now loading module...\n");
      }
      if (cuModuleLoadData(&ctx->module, ptx) == CUDA_SUCCESS) {
        if (cfg->logging) {
          fprintf(stderr, "Success!\n");
        }
        loaded_ptx_from_cache = 1;
      } else {
        if (cfg->logging) {
          fprintf(stderr, "Failed!\n");
        }
        free(ptx);
        ptx = NULL;
      }
    }
  }

  if (ptx == NULL) {
    char* problem = cuda_nvrtc_build(src, (const char**)opts, n_opts, &ptx);
    if (problem != NULL) {
      return problem;
    }
  }

  if (cfg->dump_ptx_to != NULL) {
    dump_file(cfg->dump_ptx_to, ptx, strlen(ptx));
  }

  if (!loaded_ptx_from_cache) {
    CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));
  }

  if (cache_fname != NULL && !loaded_ptx_from_cache) {
    if (cfg->logging) {
      fprintf(stderr, "Caching PTX in %s...\n", cache_fname);
    }
    errno = 0;
    if (cache_store(cache_fname, &h, (const unsigned char*)ptx, strlen(ptx)) != 0) {
      fprintf(stderr, "Failed to cache PTX: %s\n", strerror(errno));
    }
  }

  for (size_t i = 0; i < n_opts; i++) {
    free((char *)opts[i]);
  }
  free(opts);
  free(ptx);

  return NULL;
}

struct cuda_event {
  cudaEvent_t start;
  cudaEvent_t end;
};

static struct cuda_event* cuda_event_new(struct futhark_context* ctx) {
  if (ctx->profiling && !ctx->profiling_paused) {
    struct cuda_event* e = malloc(sizeof(struct cuda_event));
    cudaEventCreate(&e->start);
    cudaEventCreate(&e->end);
    return e;
  } else {
    return NULL;
  }
}

static int cuda_event_report(struct str_builder* sb, struct cuda_event* e) {
  float ms;
  CUresult err;
  if ((err = cuEventElapsedTime(&ms, e->start, e->end)) != CUDA_SUCCESS) {
    return err;
  }

  // CUDA provides milisecond resolution, but we want microseconds.
  str_builder(sb, ",\"duration\":%f", ms*1000);

  if ((err = cuEventDestroy(e->start)) != CUDA_SUCCESS) {
    return 1;
  }

  if ((err = cuEventDestroy(e->end)) != CUDA_SUCCESS) {
    return 1;
  }

  free(e);

  return 0;
}

int futhark_context_sync(struct futhark_context* ctx) {
  CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cu_ctx));
  CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
  if (ctx->failure_is_an_option) {
    // Check for any delayed error.
    int32_t failure_idx;
    CUDA_SUCCEED_OR_RETURN(
                           cuMemcpyDtoH(&failure_idx,
                                        ctx->global_failure,
                                        sizeof(int32_t)));
    ctx->failure_is_an_option = 0;

    if (failure_idx >= 0) {
      // We have to clear global_failure so that the next entry point
      // is not considered a failure from the start.
      int32_t no_failure = -1;
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyHtoD(ctx->global_failure,
                                          &no_failure,
                                          sizeof(int32_t)));

      int64_t args[max_failure_args+1];
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyDtoH(&args,
                                          ctx->global_failure_args,
                                          sizeof(args)));

      ctx->error = get_failure_msg(failure_idx, args);

      return FUTHARK_PROGRAM_ERROR;
    }
  }

  CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cu_ctx));
  return 0;
}

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);

int backend_context_setup(struct futhark_context* ctx) {
  ctx->failure_is_an_option = 0;
  ctx->total_runs = 0;
  ctx->total_runtime = 0;
  ctx->peak_mem_usage_device = 0;
  ctx->cur_mem_usage_device = 0;
  ctx->kernels = NULL;

  CUDA_SUCCEED_FATAL(cuInit(0));
  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->gpu_free_list);

  if (ctx->cfg->unified_memory == 2) {
    ctx->cfg->unified_memory = device_query(ctx->dev, MANAGED_MEMORY);
  }

  if (ctx->cfg->logging) {
    if (ctx->cfg->unified_memory) {
      fprintf(ctx->log, "Using managed memory\n");
    } else {
      fprintf(ctx->log, "Using unmanaged memory\n");
    }
  }

  ctx->max_thread_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_thread_block_size);
  ctx->max_threshold = 1U<<31; // No limit.
  ctx->max_bespoke = 1U<<31; // No limit.

  if (ctx->cfg->gpu.default_registers != 0) {
    ctx->max_registers = ctx->cfg->gpu.default_registers;
  } else {
    ctx->max_registers = device_query(ctx->dev, MAX_REGISTERS_PER_BLOCK);
  }

  if (ctx->cfg->gpu.default_shared_memory != 0) {
    ctx->max_shared_memory = ctx->cfg->gpu.default_shared_memory;
  } else {
    // MAX_SHARED_MEMORY_PER_BLOCK gives bogus numbers (48KiB); probably
    // for backwards compatibility.  Add _OPTIN and you seem to get the
    // right number.
    ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK_OPTIN);
#if CUDART_VERSION >= 12000
    ctx->max_shared_memory -= device_query(ctx->dev, RESERVED_SHARED_MEMORY_PER_BLOCK);
#endif
  }

  if (ctx->cfg->gpu.default_cache != 0) {
    ctx->max_cache = ctx->cfg->gpu.default_cache;
  } else {
    ctx->max_cache = device_query(ctx->dev, L2_CACHE_SIZE);
  }

  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);
  CUDA_SUCCEED_FATAL(cuStreamCreate(&ctx->stream, CU_STREAM_DEFAULT));
  cuda_size_setup(ctx);

  gpu_init_log(ctx);

  ctx->error = cuda_module_setup(ctx,
                                 ctx->cfg->program,
                                 (const char**)ctx->cfg->nvrtc_opts,
                                 ctx->cfg->cache_fname);

  if (ctx->error != NULL) {
    futhark_panic(1, "During CUDA initialisation:\n%s\n", ctx->error);
  }

  int32_t no_error = -1;
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
  CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error, sizeof(no_error)));
  // The +1 is to avoid zero-byte allocations.
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t)*(max_failure_args+1)));

  if ((ctx->kernels = init_builtin_kernels(ctx)) == NULL) {
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  if (ctx->kernels != NULL) {
    free_builtin_kernels(ctx, ctx->kernels);
    cuMemFree(ctx->global_failure);
    cuMemFree(ctx->global_failure_args);
    CUDA_SUCCEED_FATAL(gpu_free_all(ctx));
    CUDA_SUCCEED_FATAL(cuStreamDestroy(ctx->stream));
    CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
    CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
  }
  free_list_destroy(&ctx->gpu_free_list);
}

// GPU ABSTRACTION LAYER

// Types.

typedef CUfunction gpu_kernel;
typedef CUdeviceptr gpu_mem;

static void gpu_create_kernel(struct futhark_context *ctx,
                              gpu_kernel* kernel,
                              const char* name) {
  if (ctx->debugging) {
    fprintf(ctx->log, "Creating kernel %s.\n", name);
  }
  CUDA_SUCCEED_FATAL(cuModuleGetFunction(kernel, ctx->module, name));
  // Unless the below is set, the kernel is limited to 48KiB of memory.
  CUDA_SUCCEED_FATAL(cuFuncSetAttribute(*kernel,
                                        cudaFuncAttributeMaxDynamicSharedMemorySize,
                                        ctx->max_shared_memory));
}

static void gpu_free_kernel(struct futhark_context *ctx,
                            gpu_kernel kernel) {
  (void)ctx;
  (void)kernel;
}

static int gpu_scalar_to_device(struct futhark_context* ctx,
                                gpu_mem dst, size_t offset, size_t size,
                                void *src) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(dst + offset, src, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_scalar_from_device(struct futhark_context* ctx,
                                  void *dst,
                                  gpu_mem src, size_t offset, size_t size) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_from_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(dst, src + offset, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_memcpy(struct futhark_context* ctx,
                      gpu_mem dst, int64_t dst_offset,
                      gpu_mem src, int64_t src_offset,
                      int64_t nbytes) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_dev_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyAsync(dst+dst_offset, src+src_offset, nbytes, ctx->stream));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_host2gpu(struct futhark_context* ctx, bool sync,
                           gpu_mem dst, int64_t dst_offset,
                           const unsigned char* src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_host_to_dev",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoD(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoDAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_gpu2host(struct futhark_context* ctx, bool sync,
                           unsigned char* dst, int64_t dst_offset,
                           gpu_mem src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_dev_to_host",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoH(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoHAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
    if (sync &&
        ctx->failure_is_an_option &&
        futhark_context_sync(ctx) != 0) {
      return 1;
    }
  }
  return FUTHARK_SUCCESS;
}

static int gpu_launch_kernel(struct futhark_context* ctx,
                             gpu_kernel kernel, const char *name,
                             const int32_t grid[3],
                             const int32_t block[3],
                             unsigned int shared_mem_bytes,
                             int num_args,
                             void* args[num_args],
                             size_t args_sizes[num_args]) {
  (void) args_sizes;

  if (shared_mem_bytes > ctx->max_shared_memory) {
    set_error(ctx, msgprintf("Kernel %s with %d bytes of memory exceeds device limit of %d\n",
                             name, shared_mem_bytes, (int)ctx->max_shared_memory));
    return 1;
  }

  int64_t time_start = 0, time_end = 0;
  if (ctx->debugging) {
    time_start = get_wall_time();
  }

  struct cuda_event *event = cuda_event_new(ctx);

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    add_event(ctx,
              name,
              msgprintf("Kernel %s with\n"
                        "  grid=(%d,%d,%d)\n"
                        "  block=(%d,%d,%d)\n"
                        "  shared memory=%d",
                        name,
                        grid[0], grid[1], grid[2],
                        block[0], block[1], block[2],
                        shared_mem_bytes),
              event,
              (event_report_fn)cuda_event_report);
  }

  CUDA_SUCCEED_OR_RETURN
    (cuLaunchKernel(kernel,
                    grid[0], grid[1], grid[2],
                    block[0], block[1], block[2],
                    shared_mem_bytes, ctx->stream,
                    args, NULL));

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }

  if (ctx->debugging) {
    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
    time_end = get_wall_time();
    long int time_diff = time_end - time_start;
    fprintf(ctx->log, "  runtime: %ldus\n", time_diff);
  }
  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return FUTHARK_SUCCESS;
}

static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out) {
  CUresult res;
  if (ctx->cfg->unified_memory) {
    res = cuMemAllocManaged(mem_out, size, CU_MEM_ATTACH_GLOBAL);
  } else {
    res = cuMemAlloc(mem_out, size);
  }

  if (res == CUDA_ERROR_OUT_OF_MEMORY) {
    return FUTHARK_OUT_OF_MEMORY;
  }

  CUDA_SUCCEED_OR_RETURN(res);
  return FUTHARK_SUCCESS;
}

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem) {
  (void)ctx;
  CUDA_SUCCEED_OR_RETURN(cuMemFree(mem));
  return FUTHARK_SUCCESS;
}

// End of backends/cuda.h.

// Start of gpu.h

// Generic functions that use our tiny GPU abstraction layer.  The
// entire context must be defined before this header is included.  In
// particular we expect the following functions to be available:

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem);
static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out);
int gpu_launch_kernel(struct futhark_context* ctx,
                      gpu_kernel kernel, const char *name,
                      const int32_t grid[3],
                      const int32_t block[3],
                      unsigned int shared_mem_bytes,
                      int num_args,
                      void* args[num_args],
                      size_t args_sizes[num_args]);
int gpu_memcpy(struct futhark_context* ctx,
               gpu_mem dst, int64_t dst_offset,
               gpu_mem src, int64_t src_offset,
               int64_t nbytes);
int gpu_scalar_from_device(struct futhark_context* ctx,
                           void *dst,
                           gpu_mem src, size_t offset, size_t size);
int gpu_scalar_to_device(struct futhark_context* ctx,
                         gpu_mem dst, size_t offset, size_t size,
                         void *src);
void gpu_create_kernel(struct futhark_context *ctx,
                       gpu_kernel* kernel,
                       const char* name);

static void gpu_init_log(struct futhark_context *ctx) {
  if (ctx->cfg->logging) {
    fprintf(ctx->log, "Default block size: %ld\n", (long)ctx->cfg->gpu.default_block_size);
    fprintf(ctx->log, "Default grid size: %ld\n", (long)ctx->cfg->gpu.default_grid_size);
    fprintf(ctx->log, "Default tile size: %ld\n", (long)ctx->cfg->gpu.default_tile_size);
    fprintf(ctx->log, "Default register tile size: %ld\n", (long)ctx->cfg->gpu.default_reg_tile_size);
    fprintf(ctx->log, "Default cache: %ld\n", (long)ctx->cfg->gpu.default_cache);
    fprintf(ctx->log, "Default registers: %ld\n", (long)ctx->cfg->gpu.default_registers);
    fprintf(ctx->log, "Default threshold: %ld\n", (long)ctx->cfg->gpu.default_threshold);
    fprintf(ctx->log, "Max thread block size: %ld\n", (long)ctx->max_thread_block_size);
    fprintf(ctx->log, "Max grid size: %ld\n", (long)ctx->max_grid_size);
    fprintf(ctx->log, "Max tile size: %ld\n", (long)ctx->max_tile_size);
    fprintf(ctx->log, "Max threshold: %ld\n", (long)ctx->max_threshold);
    fprintf(ctx->log, "Max shared memory: %ld\n", (long)ctx->max_shared_memory);
    fprintf(ctx->log, "Max registers: %ld\n", (long)ctx->max_registers);
    fprintf(ctx->log, "Max cache: %ld\n", (long)ctx->max_cache);
    fprintf(ctx->log, "Lockstep width: %ld\n", (long)ctx->lockstep_width);
  }
}

// Generic GPU command line options.

void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_block_size = size;
  cfg->gpu.default_block_size_changed = 1;
}

void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size) {
  futhark_context_config_set_default_thread_block_size(cfg, size);
}

void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int num) {
  cfg->gpu.default_grid_size = num;
  cfg->gpu.default_grid_size_changed = 1;
}

void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int num) {
  futhark_context_config_set_default_grid_size(cfg, num);
}

void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_tile_size = size;
  cfg->gpu.default_tile_size_changed = 1;
}

void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_reg_tile_size = size;
}

void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_cache = size;
}

void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_registers = size;
}

void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_threshold = size;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t new_value) {
  for (int i = 0; i < cfg->num_tuning_params; i++) {
    if (strcmp(param_name, cfg->tuning_param_names[i]) == 0) {
      cfg->tuning_params[i] = new_value;
      return 0;
    }
  }
  if (strcmp(param_name, "default_thread_block_size") == 0 ||
      strcmp(param_name, "default_group_size") == 0) {
    cfg->gpu.default_block_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_grid_size") == 0 ||
      strcmp(param_name, "default_num_groups") == 0) {
    cfg->gpu.default_grid_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_threshold") == 0) {
    cfg->gpu.default_threshold = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_tile_size") == 0) {
    cfg->gpu.default_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_reg_tile_size") == 0) {
    cfg->gpu.default_reg_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_cache") == 0) {
    cfg->gpu.default_cache = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_shared_memory") == 0) {
    cfg->gpu.default_shared_memory = new_value;
    return 0;
  }

  return 1;
}

// End of GPU command line optiopns.

// Max number of thead blocks we allow along the second or third
// dimension for transpositions.
#define MAX_TR_THREAD_BLOCKS 65535

struct builtin_kernels {
  // We have a lot of ways to transpose arrays.
  gpu_kernel map_transpose_1b;
  gpu_kernel map_transpose_1b_low_height;
  gpu_kernel map_transpose_1b_low_width;
  gpu_kernel map_transpose_1b_small;
  gpu_kernel map_transpose_1b_large;
  gpu_kernel map_transpose_2b;
  gpu_kernel map_transpose_2b_low_height;
  gpu_kernel map_transpose_2b_low_width;
  gpu_kernel map_transpose_2b_small;
  gpu_kernel map_transpose_2b_large;
  gpu_kernel map_transpose_4b;
  gpu_kernel map_transpose_4b_low_height;
  gpu_kernel map_transpose_4b_low_width;
  gpu_kernel map_transpose_4b_small;
  gpu_kernel map_transpose_4b_large;
  gpu_kernel map_transpose_8b;
  gpu_kernel map_transpose_8b_low_height;
  gpu_kernel map_transpose_8b_low_width;
  gpu_kernel map_transpose_8b_small;
  gpu_kernel map_transpose_8b_large;

  // And a few ways of copying.
  gpu_kernel lmad_copy_1b;
  gpu_kernel lmad_copy_2b;
  gpu_kernel lmad_copy_4b;
  gpu_kernel lmad_copy_8b;
};

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx) {
  struct builtin_kernels *kernels = malloc(sizeof(struct builtin_kernels));
  gpu_create_kernel(ctx, &kernels->map_transpose_1b, "map_transpose_1b");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_large, "map_transpose_1b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_height, "map_transpose_1b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_width, "map_transpose_1b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_small, "map_transpose_1b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_2b, "map_transpose_2b");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_large, "map_transpose_2b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_height, "map_transpose_2b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_width, "map_transpose_2b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_small, "map_transpose_2b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_4b, "map_transpose_4b");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_large, "map_transpose_4b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_height, "map_transpose_4b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_width, "map_transpose_4b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_small, "map_transpose_4b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_8b, "map_transpose_8b");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_large, "map_transpose_8b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_height, "map_transpose_8b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_width, "map_transpose_8b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_small, "map_transpose_8b_small");

  gpu_create_kernel(ctx, &kernels->lmad_copy_1b, "lmad_copy_1b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_2b, "lmad_copy_2b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_4b, "lmad_copy_4b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_8b, "lmad_copy_8b");

  return kernels;
}

void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels) {
  gpu_free_kernel(ctx, kernels->map_transpose_1b);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_2b);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_4b);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_8b);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_small);

  gpu_free_kernel(ctx, kernels->lmad_copy_1b);
  gpu_free_kernel(ctx, kernels->lmad_copy_2b);
  gpu_free_kernel(ctx, kernels->lmad_copy_4b);
  gpu_free_kernel(ctx, kernels->lmad_copy_8b);

  free(kernels);
}

static int gpu_alloc(struct futhark_context *ctx, FILE *log,
                     size_t min_size, const char *tag,
                     gpu_mem *mem_out, size_t *size_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  gpu_mem* memptr;
  if (free_list_find(&ctx->gpu_free_list, min_size, tag, size_out, (fl_mem*)&memptr) == 0) {
    // Successfully found a free block.  Is it big enough?
    if (*size_out >= min_size) {
      if (ctx->cfg->debugging) {
        fprintf(log, "No need to allocate: Found a block in the free list.\n");
      }
      *mem_out = *memptr;
      free(memptr);
      return FUTHARK_SUCCESS;
    } else {
      if (ctx->cfg->debugging) {
        fprintf(log, "Found a free block, but it was too small.\n");
      }
      int error = gpu_free_actual(ctx, *memptr);
      free(memptr);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    }
  }

  *size_out = min_size;

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg->debugging) {
    fprintf(log, "Actually allocating the desired block.\n");
  }

  int error = gpu_alloc_actual(ctx, min_size, mem_out);

  while (error == FUTHARK_OUT_OF_MEMORY) {
    if (ctx->cfg->debugging) {
      fprintf(log, "Out of GPU memory: releasing entry from the free list...\n");
    }
    gpu_mem* memptr;
    if (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
      gpu_mem mem = *memptr;
      free(memptr);
      error = gpu_free_actual(ctx, mem);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = gpu_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int gpu_free(struct futhark_context *ctx,
                    gpu_mem mem, size_t size, const char *tag) {
  gpu_mem* memptr = malloc(sizeof(gpu_mem));
  *memptr = mem;
  free_list_insert(&ctx->gpu_free_list, size, (fl_mem)memptr, tag);
  return FUTHARK_SUCCESS;
}

static int gpu_free_all(struct futhark_context *ctx) {
  free_list_pack(&ctx->gpu_free_list);
  gpu_mem* memptr;
  while (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
    gpu_mem mem = *memptr;
    free(memptr);
    int error = gpu_free_actual(ctx, mem);
    if (error != FUTHARK_SUCCESS) {
      return error;
    }
  }

  return FUTHARK_SUCCESS;
}

static int gpu_map_transpose(struct futhark_context* ctx,
                             gpu_kernel kernel_default,
                             gpu_kernel kernel_low_height,
                             gpu_kernel kernel_low_width,
                             gpu_kernel kernel_small,
                             gpu_kernel kernel_large,
                             const char *name, size_t elem_size,
                             gpu_mem dst, int64_t dst_offset,
                             gpu_mem src, int64_t src_offset,
                             int64_t k, int64_t n, int64_t m) {
  int64_t mulx = TR_BLOCK_DIM / n;
  int64_t muly = TR_BLOCK_DIM / m;
  int32_t mulx32 = mulx;
  int32_t muly32 = muly;
  int32_t k32 = k;
  int32_t n32 = n;
  int32_t m32 = m;

  gpu_kernel kernel = kernel_default;
  int32_t grid[3];
  int32_t block[3];

  void* args[11];
  size_t args_sizes[11] = {
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t)
  };

  args[0] = &dst;
  args[1] = &dst_offset;
  args[2] = &src;
  args[3] = &src_offset;
  args[7] = &mulx;
  args[8] = &muly;

  if (dst_offset + k * n * m <= 2147483647L &&
      src_offset + k * n * m <= 2147483647L) {
    if (m <= TR_BLOCK_DIM/2 && n <= TR_BLOCK_DIM/2) {
      if (ctx->logging) { fprintf(ctx->log, "Using small kernel\n"); }
      kernel = kernel_small;
      grid[0] = ((k * n * m) + (TR_BLOCK_DIM*TR_BLOCK_DIM) - 1) / (TR_BLOCK_DIM*TR_BLOCK_DIM);
      grid[1] = 1;
      grid[2] = 1;
      block[0] = TR_BLOCK_DIM*TR_BLOCK_DIM;
      block[1] = 1;
      block[2] = 1;
    } else if (m <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < n) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-width kernel\n"); }
      kernel = kernel_low_width;
      int64_t x_elems = m;
      int64_t y_elems = (n + muly - 1) / muly;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else if (n <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < m) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-height kernel\n"); }
      kernel = kernel_low_height;
      int64_t x_elems = (m + mulx - 1) / mulx;
      int64_t y_elems = n;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else {
      if (ctx->logging) { fprintf(ctx->log, "Using default kernel\n"); }
      kernel = kernel_default;
      grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[2] = k;
      block[0] = TR_TILE_DIM;
      block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
      block[2] = 1;
    }
    args[4] = &k32;
    args[5] = &m32;
    args[6] = &n32;
    args[7] = &mulx32;
    args[8] = &muly32;
  } else {
    if (ctx->logging) { fprintf(ctx->log, "Using large kernel\n"); }
    kernel = kernel_large;
    grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[2] = k;
    block[0] = TR_TILE_DIM;
    block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
    block[2] = 1;
    args[4] = &k;
    args[5] = &m;
    args[6] = &n;
    args[7] = &mulx;
    args[8] = &muly;
    args_sizes[4] = sizeof(int64_t);
    args_sizes[5] = sizeof(int64_t);
    args_sizes[6] = sizeof(int64_t);
    args_sizes[7] = sizeof(int64_t);
    args_sizes[8] = sizeof(int64_t);
  }

  // Cap the number of thead blocks we launch and figure out how many
  // repeats we need alongside each dimension.
  int32_t repeat_1 = grid[1] / MAX_TR_THREAD_BLOCKS;
  int32_t repeat_2 = grid[2] / MAX_TR_THREAD_BLOCKS;
  grid[1] = repeat_1 > 0 ? MAX_TR_THREAD_BLOCKS : grid[1];
  grid[2] = repeat_2 > 0 ? MAX_TR_THREAD_BLOCKS : grid[2];
  args[9] = &repeat_1;
  args[10] = &repeat_2;
  args_sizes[9] = sizeof(repeat_1);
  args_sizes[10] = sizeof(repeat_2);

  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return gpu_launch_kernel(ctx, kernel, name, grid, block,
                           TR_TILE_DIM*(TR_TILE_DIM+1)*elem_size,
                           sizeof(args)/sizeof(args[0]), args, args_sizes);
}

#define GEN_MAP_TRANSPOSE_GPU2GPU(NAME, ELEM_TYPE)                      \
  static int map_transpose_gpu2gpu_##NAME                               \
  (struct futhark_context* ctx,                                         \
   gpu_mem dst, int64_t dst_offset,                                     \
   gpu_mem src, int64_t src_offset,                                     \
   int64_t k, int64_t m, int64_t n)                                     \
  {                                                                     \
    return                                                              \
      gpu_map_transpose                                                 \
      (ctx,                                                             \
       ctx->kernels->map_transpose_##NAME,                              \
       ctx->kernels->map_transpose_##NAME##_low_height,                 \
       ctx->kernels->map_transpose_##NAME##_low_width,                  \
       ctx->kernels->map_transpose_##NAME##_small,                      \
       ctx->kernels->map_transpose_##NAME##_large,                      \
       "map_transpose_" #NAME, sizeof(ELEM_TYPE),                       \
       dst, dst_offset, src, src_offset,                                \
       k, n, m);                                                        \
  }

static int gpu_lmad_copy(struct futhark_context* ctx,
                         gpu_kernel kernel, int r,
                         gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                         gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                         int64_t shape[r]) {
  if (r > 8) {
    set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy array of greater than rank 8.\n"));
    return 1;
  }

  int64_t n = 1;
  for (int i = 0; i < r; i++) { n *= shape[i]; }

  void* args[6+(8*3)];
  size_t args_sizes[6+(8*3)];

  args[0] = &dst;
  args_sizes[0] = sizeof(gpu_mem);
  args[1] = &dst_offset;
  args_sizes[1] = sizeof(dst_offset);
  args[2] = &src;
  args_sizes[2] = sizeof(gpu_mem);
  args[3] = &src_offset;
  args_sizes[3] = sizeof(src_offset);
  args[4] = &n;
  args_sizes[4] = sizeof(n);
  args[5] = &r;
  args_sizes[5] = sizeof(r);

  int64_t zero = 0;

  for (int i = 0; i < 8; i++) {
    args_sizes[6+i*3] = sizeof(int64_t);
    args_sizes[6+i*3+1] = sizeof(int64_t);
    args_sizes[6+i*3+2] = sizeof(int64_t);
    if (i < r) {
      args[6+i*3] = &shape[i];
      args[6+i*3+1] = &dst_strides[i];
      args[6+i*3+2] = &src_strides[i];
    } else {
      args[6+i*3] = &zero;
      args[6+i*3+1] = &zero;
      args[6+i*3+2] = &zero;
    }
  }
  const size_t w = 256; // XXX: hardcoded thread block size.

  return gpu_launch_kernel(ctx, kernel, "copy_lmad_dev_to_dev",
                           (const int32_t[3]) {(n+w-1)/w,1,1},
                           (const int32_t[3]) {w,1,1},
                           0, 6+(8*3), args, args_sizes);
}

#define GEN_LMAD_COPY_ELEMENTS_GPU2GPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return gpu_lmad_copy(ctx, ctx->kernels->lmad_copy_##NAME, r,        \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \

#define GEN_LMAD_COPY_GPU2GPU(NAME, ELEM_TYPE)                          \
  static int lmad_copy_gpu2gpu_##NAME                                   \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "GPU to GPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return FUTHARK_SUCCESS; }                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                       r, dst_strides, src_strides, shape)) {           \
      log_transpose(ctx, k, n, m);                                      \
      return map_transpose_gpu2gpu_##NAME                               \
        (ctx, dst, dst_offset, src, src_offset, k, n, m);               \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}        \
      return gpu_memcpy(ctx,                                            \
                        dst, dst_offset*sizeof(ELEM_TYPE),              \
                        src, src_offset*sizeof(ELEM_TYPE),              \
                        size * sizeof(ELEM_TYPE));                      \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}     \
      return lmad_copy_elements_gpu2gpu_##NAME                          \
        (ctx, r,                                                        \
         dst, dst_offset, dst_strides,                                  \
         src, src_offset, src_strides,                                  \
         shape);                                                        \
    }                                                                   \
  }

static int
lmad_copy_elements_host2gpu(struct futhark_context *ctx, size_t elem_size,
                            int r,
                            gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                            unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                            int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from host to GPU.\n"));
  return 1;
}

static int
lmad_copy_elements_gpu2host (struct futhark_context *ctx, size_t elem_size,
                             int r,
                             unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                             gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                             int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from GPU to host.\n"));
  return 1;
}

#define GEN_LMAD_COPY_ELEMENTS_HOSTGPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return (ctx, ctx->kernels->lmad_copy_##NAME, r,                     \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \


static int lmad_copy_host2gpu(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                              unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_host2gpu(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_host2gpu
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

static int lmad_copy_gpu2host(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                              gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_gpu2host(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_gpu2host
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

GEN_MAP_TRANSPOSE_GPU2GPU(1b, uint8_t)
GEN_MAP_TRANSPOSE_GPU2GPU(2b, uint16_t)
GEN_MAP_TRANSPOSE_GPU2GPU(4b, uint32_t)
GEN_MAP_TRANSPOSE_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_GPU2GPU(8b, uint64_t)

// End of gpu.h

static int gpu_macros(struct futhark_context *ctx, char ***names_out, int64_t **values_out)
{
    int num_macros = 373;
    char **names = malloc(num_macros * sizeof(char *));
    int64_t *values = malloc(num_macros * sizeof(int64_t));
    
    {
        names[0] = "min_idxzisegred_nonseg_68921_dim1";
        values[0] = *ctx->tuning_params.min_idxzisegred_tblock_sizze_68913;
    }
    {
        names[1] = "min_idxzisegred_nonseg_68921zisegred_tblock_sizze_68914";
        values[1] = *ctx->tuning_params.min_idxzisegred_tblock_sizze_68913;
    }
    {
        names[2] = "min_idxzisegred_nonseg_68921zichunk_sizze_78702";
        values[2] = (int64_t) 1;
    }
    {
        names[3] = "max_idxzisegred_nonseg_68931_dim1";
        values[3] = *ctx->tuning_params.max_idxzisegred_tblock_sizze_68923;
    }
    {
        names[4] = "max_idxzisegred_nonseg_68931zisegred_tblock_sizze_68924";
        values[4] = *ctx->tuning_params.max_idxzisegred_tblock_sizze_68923;
    }
    {
        names[5] = "max_idxzisegred_nonseg_68931zichunk_sizze_78702";
        values[5] = (int64_t) 1;
    }
    {
        names[6] = "inner_SMJ_shortzisegmap_70799_dim1";
        values[6] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70787;
    }
    {
        names[7] = "inner_SMJ_shortzisegmap_70799zisegmap_tblock_sizze_70795";
        values[7] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70787;
    }
    {
        names[8] = "inner_SMJ_shortzigpuseq_79454_dim1";
        values[8] = (int64_t) 1;
    }
    {
        names[9] = "inner_SMJ_shortzisegmap_70769_dim1";
        values[9] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70771;
    }
    {
        names[10] = "inner_SMJ_shortzisegmap_70769zisegmap_tblock_sizze_70772";
        values[10] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70771;
    }
    {
        names[11] = "inner_SMJ_shortzisegmap_70777_dim1";
        values[11] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70779;
    }
    {
        names[12] = "inner_SMJ_shortzisegmap_70777zisegmap_tblock_sizze_70780";
        values[12] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70779;
    }
    {
        names[13] = "inner_SMJ_shortzigpuseq_79407_dim1";
        values[13] = (int64_t) 1;
    }
    {
        names[14] = "inner_SMJ_shortzigpuseq_79401_dim1";
        values[14] = (int64_t) 1;
    }
    {
        names[15] = "inner_SMJ_shortzigpuseq_79395_dim1";
        values[15] = (int64_t) 1;
    }
    {
        names[16] = "inner_SMJ_shortzisegmap_70761_dim1";
        values[16] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70745;
    }
    {
        names[17] = "inner_SMJ_shortzisegmap_70761zisegmap_tblock_sizze_70757";
        values[17] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70745;
    }
    {
        names[18] = "inner_SMJ_shortzisegscan_70741_dim1";
        values[18] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70735;
    }
    {
        names[19] = "inner_SMJ_shortzisegscan_70741zisegscan_tblock_sizze_70736";
        values[19] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70735;
    }
    {
        names[20] = "inner_SMJ_shortzisegscan_70741zichunk_sizze_79238";
        values[20] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[21] = "inner_SMJ_shortzisegmap_70727_dim1";
        values[21] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70729;
    }
    {
        names[22] = "inner_SMJ_shortzisegmap_70727zisegmap_tblock_sizze_70730";
        values[22] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70729;
    }
    {
        names[23] = "inner_SMJ_shortzisegscan_70725_dim1";
        values[23] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70719;
    }
    {
        names[24] = "inner_SMJ_shortzisegscan_70725zisegscan_tblock_sizze_70720";
        values[24] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70719;
    }
    {
        names[25] = "inner_SMJ_shortzisegscan_70725zichunk_sizze_79081";
        values[25] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[26] = "inner_SMJ_shortzigpuseq_79070_dim1";
        values[26] = (int64_t) 1;
    }
    {
        names[27] = "inner_SMJ_shortzisegmap_70714_dim1";
        values[27] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70701;
    }
    {
        names[28] = "inner_SMJ_shortzisegmap_70714zisegmap_tblock_sizze_70710";
        values[28] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70701;
    }
    {
        names[29] = "inner_SMJ_shortzisegmap_70693_dim1";
        values[29] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70679;
    }
    {
        names[30] = "inner_SMJ_shortzisegmap_70693zisegmap_tblock_sizze_70689";
        values[30] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70679;
    }
    {
        names[31] = "inner_SMJ_shortzisegmap_70672_dim1";
        values[31] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70659;
    }
    {
        names[32] = "inner_SMJ_shortzisegmap_70672zisegmap_tblock_sizze_70668";
        values[32] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70659;
    }
    {
        names[33] = "inner_SMJ_shortzisegmap_70651_dim1";
        values[33] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70637;
    }
    {
        names[34] = "inner_SMJ_shortzisegmap_70651zisegmap_tblock_sizze_70647";
        values[34] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70637;
    }
    {
        names[35] = "inner_SMJ_shortzisegmap_70630_dim1";
        values[35] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70617;
    }
    {
        names[36] = "inner_SMJ_shortzisegmap_70630zisegmap_tblock_sizze_70626";
        values[36] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70617;
    }
    {
        names[37] = "inner_SMJ_shortzisegmap_70609_dim1";
        values[37] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70595;
    }
    {
        names[38] = "inner_SMJ_shortzisegmap_70609zisegmap_tblock_sizze_70605";
        values[38] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70595;
    }
    {
        names[39] = "inner_SMJ_shortzisegmap_intrablock_77122_dim1";
        values[39] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123;
    }
    {
        names[40] = "inner_SMJ_shortzisegmap_intrablock_77122zitile_sizze_77124";
        values[40] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123;
    }
    {
        names[41] = "inner_SMJ_shortzisegmap_intrablock_77122zibytes_77741";
        values[41] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123;
    }
    {
        names[42] = "inner_SMJ_shortzisegmap_intrablock_77122zibytes_77743";
        values[42] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123;
    }
    {
        names[43] = "inner_SMJ_shortzisegmap_intrablock_76767_dim1";
        values[43] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768;
    }
    {
        names[44] = "inner_SMJ_shortzisegmap_intrablock_76767zitile_sizze_76769";
        values[44] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768;
    }
    {
        names[45] = "inner_SMJ_shortzisegmap_intrablock_76767zibytes_77802";
        values[45] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768;
    }
    {
        names[46] = "inner_SMJ_shortzisegmap_intrablock_76767zibytes_77804";
        values[46] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768;
    }
    {
        names[47] = "inner_SMJ_shortzigpuseq_78957_dim1";
        values[47] = (int64_t) 1;
    }
    {
        names[48] = "inner_SMJ_shortzigpuseq_78951_dim1";
        values[48] = (int64_t) 1;
    }
    {
        names[49] = "inner_SMJ_shortzigpuseq_78945_dim1";
        values[49] = (int64_t) 1;
    }
    {
        names[50] = "inner_SMJ_shortzigpuseq_78929_dim1";
        values[50] = (int64_t) 1;
    }
    {
        names[51] = "inner_SMJ_shortzigpuseq_78923_dim1";
        values[51] = (int64_t) 1;
    }
    {
        names[52] = "inner_SMJ_shortzisegmap_70257_dim1";
        values[52] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70088;
    }
    {
        names[53] = "inner_SMJ_shortzisegmap_70257zisegmap_tblock_sizze_70252";
        values[53] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70088;
    }
    {
        names[54] = "inner_SMJ_shortzisegmap_69883_dim1";
        values[54] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_69671;
    }
    {
        names[55] = "inner_SMJ_shortzisegmap_69883zisegmap_tblock_sizze_69878";
        values[55] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_69671;
    }
    {
        names[56] = "inner_SMJ_shortzigpuseq_78861_dim1";
        values[56] = (int64_t) 1;
    }
    {
        names[57] = "inner_SMJ_shortzigpuseq_78855_dim1";
        values[57] = (int64_t) 1;
    }
    {
        names[58] = "inner_SMJ_shortzigpuseq_78849_dim1";
        values[58] = (int64_t) 1;
    }
    {
        names[59] = "inner_SMJ_shortzisegmap_intrablock_76412_dim1";
        values[59] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413;
    }
    {
        names[60] = "inner_SMJ_shortzisegmap_intrablock_76412zitile_sizze_76414";
        values[60] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413;
    }
    {
        names[61] = "inner_SMJ_shortzisegmap_intrablock_76412zibytes_77946";
        values[61] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413;
    }
    {
        names[62] = "inner_SMJ_shortzisegmap_intrablock_76412zibytes_77948";
        values[62] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413;
    }
    {
        names[63] = "inner_SMJ_shortzisegmap_intrablock_76057_dim1";
        values[63] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058;
    }
    {
        names[64] = "inner_SMJ_shortzisegmap_intrablock_76057zitile_sizze_76059";
        values[64] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058;
    }
    {
        names[65] = "inner_SMJ_shortzisegmap_intrablock_76057zibytes_78007";
        values[65] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058;
    }
    {
        names[66] = "inner_SMJ_shortzisegmap_intrablock_76057zibytes_78009";
        values[66] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058;
    }
    {
        names[67] = "inner_SMJ_shortzigpuseq_78790_dim1";
        values[67] = (int64_t) 1;
    }
    {
        names[68] = "inner_SMJ_shortzigpuseq_78784_dim1";
        values[68] = (int64_t) 1;
    }
    {
        names[69] = "inner_SMJ_shortzigpuseq_78778_dim1";
        values[69] = (int64_t) 1;
    }
    {
        names[70] = "inner_SMJ_shortzigpuseq_78762_dim1";
        values[70] = (int64_t) 1;
    }
    {
        names[71] = "inner_SMJ_shortzigpuseq_78756_dim1";
        values[71] = (int64_t) 1;
    }
    {
        names[72] = "inner_SMJ_shortzigpuseq_78724_dim1";
        values[72] = (int64_t) 1;
    }
    {
        names[73] = "inner_SMJ_longzisegmap_73419_dim1";
        values[73] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73407;
    }
    {
        names[74] = "inner_SMJ_longzisegmap_73419zisegmap_tblock_sizze_73415";
        values[74] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73407;
    }
    {
        names[75] = "inner_SMJ_longzigpuseq_79434_dim1";
        values[75] = (int64_t) 1;
    }
    {
        names[76] = "inner_SMJ_longzisegmap_73389_dim1";
        values[76] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73391;
    }
    {
        names[77] = "inner_SMJ_longzisegmap_73389zisegmap_tblock_sizze_73392";
        values[77] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73391;
    }
    {
        names[78] = "inner_SMJ_longzisegmap_73397_dim1";
        values[78] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73399;
    }
    {
        names[79] = "inner_SMJ_longzisegmap_73397zisegmap_tblock_sizze_73400";
        values[79] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73399;
    }
    {
        names[80] = "inner_SMJ_longzigpuseq_79387_dim1";
        values[80] = (int64_t) 1;
    }
    {
        names[81] = "inner_SMJ_longzigpuseq_79381_dim1";
        values[81] = (int64_t) 1;
    }
    {
        names[82] = "inner_SMJ_longzigpuseq_79375_dim1";
        values[82] = (int64_t) 1;
    }
    {
        names[83] = "inner_SMJ_longzisegmap_73381_dim1";
        values[83] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73365;
    }
    {
        names[84] = "inner_SMJ_longzisegmap_73381zisegmap_tblock_sizze_73377";
        values[84] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73365;
    }
    {
        names[85] = "inner_SMJ_longzisegscan_73361_dim1";
        values[85] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73355;
    }
    {
        names[86] = "inner_SMJ_longzisegscan_73361zisegscan_tblock_sizze_73356";
        values[86] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73355;
    }
    {
        names[87] = "inner_SMJ_longzisegscan_73361zichunk_sizze_79218";
        values[87] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[88] = "inner_SMJ_longzisegmap_73347_dim1";
        values[88] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73349;
    }
    {
        names[89] = "inner_SMJ_longzisegmap_73347zisegmap_tblock_sizze_73350";
        values[89] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73349;
    }
    {
        names[90] = "inner_SMJ_longzisegscan_73345_dim1";
        values[90] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73339;
    }
    {
        names[91] = "inner_SMJ_longzisegscan_73345zisegscan_tblock_sizze_73340";
        values[91] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73339;
    }
    {
        names[92] = "inner_SMJ_longzisegscan_73345zichunk_sizze_79061";
        values[92] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[93] = "inner_SMJ_longzigpuseq_79050_dim1";
        values[93] = (int64_t) 1;
    }
    {
        names[94] = "inner_SMJ_longzisegmap_73334_dim1";
        values[94] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73321;
    }
    {
        names[95] = "inner_SMJ_longzisegmap_73334zisegmap_tblock_sizze_73330";
        values[95] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73321;
    }
    {
        names[96] = "inner_SMJ_longzisegmap_73313_dim1";
        values[96] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73299;
    }
    {
        names[97] = "inner_SMJ_longzisegmap_73313zisegmap_tblock_sizze_73309";
        values[97] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73299;
    }
    {
        names[98] = "inner_SMJ_longzisegmap_73292_dim1";
        values[98] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73279;
    }
    {
        names[99] = "inner_SMJ_longzisegmap_73292zisegmap_tblock_sizze_73288";
        values[99] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73279;
    }
    {
        names[100] = "inner_SMJ_longzisegmap_73271_dim1";
        values[100] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73257;
    }
    {
        names[101] = "inner_SMJ_longzisegmap_73271zisegmap_tblock_sizze_73267";
        values[101] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73257;
    }
    {
        names[102] = "inner_SMJ_longzisegmap_73250_dim1";
        values[102] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73237;
    }
    {
        names[103] = "inner_SMJ_longzisegmap_73250zisegmap_tblock_sizze_73246";
        values[103] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73237;
    }
    {
        names[104] = "inner_SMJ_longzisegmap_73229_dim1";
        values[104] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73215;
    }
    {
        names[105] = "inner_SMJ_longzisegmap_73229zisegmap_tblock_sizze_73225";
        values[105] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73215;
    }
    {
        names[106] = "inner_SMJ_longzisegmap_intrablock_77122_dim1";
        values[106] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_77123;
    }
    {
        names[107] = "inner_SMJ_longzisegmap_intrablock_77122zitile_sizze_77124";
        values[107] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_77123;
    }
    {
        names[108] = "inner_SMJ_longzisegmap_intrablock_77122zibytes_77741";
        values[108] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_77123;
    }
    {
        names[109] = "inner_SMJ_longzisegmap_intrablock_76767_dim1";
        values[109] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76768;
    }
    {
        names[110] = "inner_SMJ_longzisegmap_intrablock_76767zitile_sizze_76769";
        values[110] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76768;
    }
    {
        names[111] = "inner_SMJ_longzisegmap_intrablock_76767zibytes_77802";
        values[111] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_76768;
    }
    {
        names[112] = "inner_SMJ_longzigpuseq_78937_dim1";
        values[112] = (int64_t) 1;
    }
    {
        names[113] = "inner_SMJ_longzigpuseq_78931_dim1";
        values[113] = (int64_t) 1;
    }
    {
        names[114] = "inner_SMJ_longzigpuseq_78925_dim1";
        values[114] = (int64_t) 1;
    }
    {
        names[115] = "inner_SMJ_longzigpuseq_78909_dim1";
        values[115] = (int64_t) 1;
    }
    {
        names[116] = "inner_SMJ_longzigpuseq_78903_dim1";
        values[116] = (int64_t) 1;
    }
    {
        names[117] = "inner_SMJ_longzisegmap_72877_dim1";
        values[117] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72708;
    }
    {
        names[118] = "inner_SMJ_longzisegmap_72877zisegmap_tblock_sizze_72872";
        values[118] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72708;
    }
    {
        names[119] = "inner_SMJ_longzisegmap_72503_dim1";
        values[119] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72291;
    }
    {
        names[120] = "inner_SMJ_longzisegmap_72503zisegmap_tblock_sizze_72498";
        values[120] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72291;
    }
    {
        names[121] = "inner_SMJ_longzigpuseq_78841_dim1";
        values[121] = (int64_t) 1;
    }
    {
        names[122] = "inner_SMJ_longzigpuseq_78835_dim1";
        values[122] = (int64_t) 1;
    }
    {
        names[123] = "inner_SMJ_longzigpuseq_78829_dim1";
        values[123] = (int64_t) 1;
    }
    {
        names[124] = "inner_SMJ_longzisegmap_intrablock_76412_dim1";
        values[124] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76413;
    }
    {
        names[125] = "inner_SMJ_longzisegmap_intrablock_76412zitile_sizze_76414";
        values[125] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76413;
    }
    {
        names[126] = "inner_SMJ_longzisegmap_intrablock_76412zibytes_77946";
        values[126] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_76413;
    }
    {
        names[127] = "inner_SMJ_longzisegmap_intrablock_76057_dim1";
        values[127] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76058;
    }
    {
        names[128] = "inner_SMJ_longzisegmap_intrablock_76057zitile_sizze_76059";
        values[128] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76058;
    }
    {
        names[129] = "inner_SMJ_longzisegmap_intrablock_76057zibytes_78007";
        values[129] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_76058;
    }
    {
        names[130] = "inner_SMJ_longzigpuseq_78770_dim1";
        values[130] = (int64_t) 1;
    }
    {
        names[131] = "inner_SMJ_longzigpuseq_78764_dim1";
        values[131] = (int64_t) 1;
    }
    {
        names[132] = "inner_SMJ_longzigpuseq_78758_dim1";
        values[132] = (int64_t) 1;
    }
    {
        names[133] = "inner_SMJ_longzigpuseq_78742_dim1";
        values[133] = (int64_t) 1;
    }
    {
        names[134] = "inner_SMJ_longzigpuseq_78736_dim1";
        values[134] = (int64_t) 1;
    }
    {
        names[135] = "inner_SMJ_longzigpuseq_78724_dim1";
        values[135] = (int64_t) 1;
    }
    {
        names[136] = "inner_SMJ_intzisegmap_72109_dim1";
        values[136] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72097;
    }
    {
        names[137] = "inner_SMJ_intzisegmap_72109zisegmap_tblock_sizze_72105";
        values[137] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72097;
    }
    {
        names[138] = "inner_SMJ_intzigpuseq_79434_dim1";
        values[138] = (int64_t) 1;
    }
    {
        names[139] = "inner_SMJ_intzisegmap_72079_dim1";
        values[139] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72081;
    }
    {
        names[140] = "inner_SMJ_intzisegmap_72079zisegmap_tblock_sizze_72082";
        values[140] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72081;
    }
    {
        names[141] = "inner_SMJ_intzisegmap_72087_dim1";
        values[141] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72089;
    }
    {
        names[142] = "inner_SMJ_intzisegmap_72087zisegmap_tblock_sizze_72090";
        values[142] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72089;
    }
    {
        names[143] = "inner_SMJ_intzigpuseq_79387_dim1";
        values[143] = (int64_t) 1;
    }
    {
        names[144] = "inner_SMJ_intzigpuseq_79381_dim1";
        values[144] = (int64_t) 1;
    }
    {
        names[145] = "inner_SMJ_intzigpuseq_79375_dim1";
        values[145] = (int64_t) 1;
    }
    {
        names[146] = "inner_SMJ_intzisegmap_72071_dim1";
        values[146] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72055;
    }
    {
        names[147] = "inner_SMJ_intzisegmap_72071zisegmap_tblock_sizze_72067";
        values[147] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72055;
    }
    {
        names[148] = "inner_SMJ_intzisegscan_72051_dim1";
        values[148] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72045;
    }
    {
        names[149] = "inner_SMJ_intzisegscan_72051zisegscan_tblock_sizze_72046";
        values[149] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72045;
    }
    {
        names[150] = "inner_SMJ_intzisegscan_72051zichunk_sizze_79218";
        values[150] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[151] = "inner_SMJ_intzisegmap_72037_dim1";
        values[151] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72039;
    }
    {
        names[152] = "inner_SMJ_intzisegmap_72037zisegmap_tblock_sizze_72040";
        values[152] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72039;
    }
    {
        names[153] = "inner_SMJ_intzisegscan_72035_dim1";
        values[153] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72029;
    }
    {
        names[154] = "inner_SMJ_intzisegscan_72035zisegscan_tblock_sizze_72030";
        values[154] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72029;
    }
    {
        names[155] = "inner_SMJ_intzisegscan_72035zichunk_sizze_79081";
        values[155] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[156] = "inner_SMJ_intzigpuseq_79070_dim1";
        values[156] = (int64_t) 1;
    }
    {
        names[157] = "inner_SMJ_intzisegmap_72024_dim1";
        values[157] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72011;
    }
    {
        names[158] = "inner_SMJ_intzisegmap_72024zisegmap_tblock_sizze_72020";
        values[158] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72011;
    }
    {
        names[159] = "inner_SMJ_intzisegmap_72003_dim1";
        values[159] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71989;
    }
    {
        names[160] = "inner_SMJ_intzisegmap_72003zisegmap_tblock_sizze_71999";
        values[160] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71989;
    }
    {
        names[161] = "inner_SMJ_intzisegmap_71982_dim1";
        values[161] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71969;
    }
    {
        names[162] = "inner_SMJ_intzisegmap_71982zisegmap_tblock_sizze_71978";
        values[162] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71969;
    }
    {
        names[163] = "inner_SMJ_intzisegmap_71961_dim1";
        values[163] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71947;
    }
    {
        names[164] = "inner_SMJ_intzisegmap_71961zisegmap_tblock_sizze_71957";
        values[164] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71947;
    }
    {
        names[165] = "inner_SMJ_intzisegmap_71940_dim1";
        values[165] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71927;
    }
    {
        names[166] = "inner_SMJ_intzisegmap_71940zisegmap_tblock_sizze_71936";
        values[166] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71927;
    }
    {
        names[167] = "inner_SMJ_intzisegmap_71919_dim1";
        values[167] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71905;
    }
    {
        names[168] = "inner_SMJ_intzisegmap_71919zisegmap_tblock_sizze_71915";
        values[168] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71905;
    }
    {
        names[169] = "inner_SMJ_intzisegmap_intrablock_77122_dim1";
        values[169] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123;
    }
    {
        names[170] = "inner_SMJ_intzisegmap_intrablock_77122zitile_sizze_77124";
        values[170] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123;
    }
    {
        names[171] = "inner_SMJ_intzisegmap_intrablock_77122zibytes_77741";
        values[171] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123;
    }
    {
        names[172] = "inner_SMJ_intzisegmap_intrablock_77122zibytes_77743";
        values[172] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123;
    }
    {
        names[173] = "inner_SMJ_intzisegmap_intrablock_76767_dim1";
        values[173] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768;
    }
    {
        names[174] = "inner_SMJ_intzisegmap_intrablock_76767zitile_sizze_76769";
        values[174] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768;
    }
    {
        names[175] = "inner_SMJ_intzisegmap_intrablock_76767zibytes_77802";
        values[175] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768;
    }
    {
        names[176] = "inner_SMJ_intzisegmap_intrablock_76767zibytes_77804";
        values[176] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768;
    }
    {
        names[177] = "inner_SMJ_intzigpuseq_78957_dim1";
        values[177] = (int64_t) 1;
    }
    {
        names[178] = "inner_SMJ_intzigpuseq_78951_dim1";
        values[178] = (int64_t) 1;
    }
    {
        names[179] = "inner_SMJ_intzigpuseq_78945_dim1";
        values[179] = (int64_t) 1;
    }
    {
        names[180] = "inner_SMJ_intzigpuseq_78929_dim1";
        values[180] = (int64_t) 1;
    }
    {
        names[181] = "inner_SMJ_intzigpuseq_78923_dim1";
        values[181] = (int64_t) 1;
    }
    {
        names[182] = "inner_SMJ_intzisegmap_71567_dim1";
        values[182] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71398;
    }
    {
        names[183] = "inner_SMJ_intzisegmap_71567zisegmap_tblock_sizze_71562";
        values[183] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71398;
    }
    {
        names[184] = "inner_SMJ_intzisegmap_71193_dim1";
        values[184] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_70981;
    }
    {
        names[185] = "inner_SMJ_intzisegmap_71193zisegmap_tblock_sizze_71188";
        values[185] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_70981;
    }
    {
        names[186] = "inner_SMJ_intzigpuseq_78861_dim1";
        values[186] = (int64_t) 1;
    }
    {
        names[187] = "inner_SMJ_intzigpuseq_78855_dim1";
        values[187] = (int64_t) 1;
    }
    {
        names[188] = "inner_SMJ_intzigpuseq_78849_dim1";
        values[188] = (int64_t) 1;
    }
    {
        names[189] = "inner_SMJ_intzisegmap_intrablock_76412_dim1";
        values[189] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413;
    }
    {
        names[190] = "inner_SMJ_intzisegmap_intrablock_76412zitile_sizze_76414";
        values[190] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413;
    }
    {
        names[191] = "inner_SMJ_intzisegmap_intrablock_76412zibytes_77946";
        values[191] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413;
    }
    {
        names[192] = "inner_SMJ_intzisegmap_intrablock_76412zibytes_77948";
        values[192] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413;
    }
    {
        names[193] = "inner_SMJ_intzisegmap_intrablock_76057_dim1";
        values[193] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058;
    }
    {
        names[194] = "inner_SMJ_intzisegmap_intrablock_76057zitile_sizze_76059";
        values[194] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058;
    }
    {
        names[195] = "inner_SMJ_intzisegmap_intrablock_76057zibytes_78007";
        values[195] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058;
    }
    {
        names[196] = "inner_SMJ_intzisegmap_intrablock_76057zibytes_78009";
        values[196] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058;
    }
    {
        names[197] = "inner_SMJ_intzigpuseq_78790_dim1";
        values[197] = (int64_t) 1;
    }
    {
        names[198] = "inner_SMJ_intzigpuseq_78784_dim1";
        values[198] = (int64_t) 1;
    }
    {
        names[199] = "inner_SMJ_intzigpuseq_78778_dim1";
        values[199] = (int64_t) 1;
    }
    {
        names[200] = "inner_SMJ_intzigpuseq_78762_dim1";
        values[200] = (int64_t) 1;
    }
    {
        names[201] = "inner_SMJ_intzigpuseq_78756_dim1";
        values[201] = (int64_t) 1;
    }
    {
        names[202] = "inner_SMJ_intzigpuseq_78724_dim1";
        values[202] = (int64_t) 1;
    }
    {
        names[203] = "inner_SMJ_floatzisegmap_74729_dim1";
        values[203] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74717;
    }
    {
        names[204] = "inner_SMJ_floatzisegmap_74729zisegmap_tblock_sizze_74725";
        values[204] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74717;
    }
    {
        names[205] = "inner_SMJ_floatzigpuseq_79454_dim1";
        values[205] = (int64_t) 1;
    }
    {
        names[206] = "inner_SMJ_floatzisegmap_74699_dim1";
        values[206] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74701;
    }
    {
        names[207] = "inner_SMJ_floatzisegmap_74699zisegmap_tblock_sizze_74702";
        values[207] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74701;
    }
    {
        names[208] = "inner_SMJ_floatzisegmap_74707_dim1";
        values[208] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74709;
    }
    {
        names[209] = "inner_SMJ_floatzisegmap_74707zisegmap_tblock_sizze_74710";
        values[209] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74709;
    }
    {
        names[210] = "inner_SMJ_floatzigpuseq_79407_dim1";
        values[210] = (int64_t) 1;
    }
    {
        names[211] = "inner_SMJ_floatzigpuseq_79401_dim1";
        values[211] = (int64_t) 1;
    }
    {
        names[212] = "inner_SMJ_floatzigpuseq_79395_dim1";
        values[212] = (int64_t) 1;
    }
    {
        names[213] = "inner_SMJ_floatzisegmap_74691_dim1";
        values[213] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74675;
    }
    {
        names[214] = "inner_SMJ_floatzisegmap_74691zisegmap_tblock_sizze_74687";
        values[214] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74675;
    }
    {
        names[215] = "inner_SMJ_floatzisegscan_74671_dim1";
        values[215] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74665;
    }
    {
        names[216] = "inner_SMJ_floatzisegscan_74671zisegscan_tblock_sizze_74666";
        values[216] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74665;
    }
    {
        names[217] = "inner_SMJ_floatzisegscan_74671zichunk_sizze_79238";
        values[217] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[218] = "inner_SMJ_floatzisegmap_74657_dim1";
        values[218] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74659;
    }
    {
        names[219] = "inner_SMJ_floatzisegmap_74657zisegmap_tblock_sizze_74660";
        values[219] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74659;
    }
    {
        names[220] = "inner_SMJ_floatzisegscan_74655_dim1";
        values[220] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74649;
    }
    {
        names[221] = "inner_SMJ_floatzisegscan_74655zisegscan_tblock_sizze_74650";
        values[221] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74649;
    }
    {
        names[222] = "inner_SMJ_floatzisegscan_74655zichunk_sizze_79081";
        values[222] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[223] = "inner_SMJ_floatzigpuseq_79070_dim1";
        values[223] = (int64_t) 1;
    }
    {
        names[224] = "inner_SMJ_floatzisegmap_74644_dim1";
        values[224] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74631;
    }
    {
        names[225] = "inner_SMJ_floatzisegmap_74644zisegmap_tblock_sizze_74640";
        values[225] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74631;
    }
    {
        names[226] = "inner_SMJ_floatzisegmap_74623_dim1";
        values[226] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74609;
    }
    {
        names[227] = "inner_SMJ_floatzisegmap_74623zisegmap_tblock_sizze_74619";
        values[227] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74609;
    }
    {
        names[228] = "inner_SMJ_floatzisegmap_74602_dim1";
        values[228] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74589;
    }
    {
        names[229] = "inner_SMJ_floatzisegmap_74602zisegmap_tblock_sizze_74598";
        values[229] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74589;
    }
    {
        names[230] = "inner_SMJ_floatzisegmap_74581_dim1";
        values[230] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74567;
    }
    {
        names[231] = "inner_SMJ_floatzisegmap_74581zisegmap_tblock_sizze_74577";
        values[231] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74567;
    }
    {
        names[232] = "inner_SMJ_floatzisegmap_74560_dim1";
        values[232] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74547;
    }
    {
        names[233] = "inner_SMJ_floatzisegmap_74560zisegmap_tblock_sizze_74556";
        values[233] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74547;
    }
    {
        names[234] = "inner_SMJ_floatzisegmap_74539_dim1";
        values[234] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74525;
    }
    {
        names[235] = "inner_SMJ_floatzisegmap_74539zisegmap_tblock_sizze_74535";
        values[235] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74525;
    }
    {
        names[236] = "inner_SMJ_floatzisegmap_intrablock_77122_dim1";
        values[236] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123;
    }
    {
        names[237] = "inner_SMJ_floatzisegmap_intrablock_77122zitile_sizze_77124";
        values[237] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123;
    }
    {
        names[238] = "inner_SMJ_floatzisegmap_intrablock_77122zibytes_77741";
        values[238] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123;
    }
    {
        names[239] = "inner_SMJ_floatzisegmap_intrablock_77122zibytes_77743";
        values[239] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123;
    }
    {
        names[240] = "inner_SMJ_floatzisegmap_intrablock_76767_dim1";
        values[240] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768;
    }
    {
        names[241] = "inner_SMJ_floatzisegmap_intrablock_76767zitile_sizze_76769";
        values[241] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768;
    }
    {
        names[242] = "inner_SMJ_floatzisegmap_intrablock_76767zibytes_77802";
        values[242] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768;
    }
    {
        names[243] = "inner_SMJ_floatzisegmap_intrablock_76767zibytes_77804";
        values[243] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768;
    }
    {
        names[244] = "inner_SMJ_floatzigpuseq_78957_dim1";
        values[244] = (int64_t) 1;
    }
    {
        names[245] = "inner_SMJ_floatzigpuseq_78951_dim1";
        values[245] = (int64_t) 1;
    }
    {
        names[246] = "inner_SMJ_floatzigpuseq_78945_dim1";
        values[246] = (int64_t) 1;
    }
    {
        names[247] = "inner_SMJ_floatzigpuseq_78929_dim1";
        values[247] = (int64_t) 1;
    }
    {
        names[248] = "inner_SMJ_floatzigpuseq_78923_dim1";
        values[248] = (int64_t) 1;
    }
    {
        names[249] = "inner_SMJ_floatzisegmap_74187_dim1";
        values[249] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74018;
    }
    {
        names[250] = "inner_SMJ_floatzisegmap_74187zisegmap_tblock_sizze_74182";
        values[250] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74018;
    }
    {
        names[251] = "inner_SMJ_floatzisegmap_73813_dim1";
        values[251] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_73601;
    }
    {
        names[252] = "inner_SMJ_floatzisegmap_73813zisegmap_tblock_sizze_73808";
        values[252] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_73601;
    }
    {
        names[253] = "inner_SMJ_floatzigpuseq_78861_dim1";
        values[253] = (int64_t) 1;
    }
    {
        names[254] = "inner_SMJ_floatzigpuseq_78855_dim1";
        values[254] = (int64_t) 1;
    }
    {
        names[255] = "inner_SMJ_floatzigpuseq_78849_dim1";
        values[255] = (int64_t) 1;
    }
    {
        names[256] = "inner_SMJ_floatzisegmap_intrablock_76412_dim1";
        values[256] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413;
    }
    {
        names[257] = "inner_SMJ_floatzisegmap_intrablock_76412zitile_sizze_76414";
        values[257] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413;
    }
    {
        names[258] = "inner_SMJ_floatzisegmap_intrablock_76412zibytes_77946";
        values[258] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413;
    }
    {
        names[259] = "inner_SMJ_floatzisegmap_intrablock_76412zibytes_77948";
        values[259] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413;
    }
    {
        names[260] = "inner_SMJ_floatzisegmap_intrablock_76057_dim1";
        values[260] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058;
    }
    {
        names[261] = "inner_SMJ_floatzisegmap_intrablock_76057zitile_sizze_76059";
        values[261] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058;
    }
    {
        names[262] = "inner_SMJ_floatzisegmap_intrablock_76057zibytes_78007";
        values[262] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058;
    }
    {
        names[263] = "inner_SMJ_floatzisegmap_intrablock_76057zibytes_78009";
        values[263] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058;
    }
    {
        names[264] = "inner_SMJ_floatzigpuseq_78790_dim1";
        values[264] = (int64_t) 1;
    }
    {
        names[265] = "inner_SMJ_floatzigpuseq_78784_dim1";
        values[265] = (int64_t) 1;
    }
    {
        names[266] = "inner_SMJ_floatzigpuseq_78778_dim1";
        values[266] = (int64_t) 1;
    }
    {
        names[267] = "inner_SMJ_floatzigpuseq_78762_dim1";
        values[267] = (int64_t) 1;
    }
    {
        names[268] = "inner_SMJ_floatzigpuseq_78756_dim1";
        values[268] = (int64_t) 1;
    }
    {
        names[269] = "inner_SMJ_floatzigpuseq_78724_dim1";
        values[269] = (int64_t) 1;
    }
    {
        names[270] = "inner_SMJ_doublezisegmap_76039_dim1";
        values[270] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76027;
    }
    {
        names[271] = "inner_SMJ_doublezisegmap_76039zisegmap_tblock_sizze_76035";
        values[271] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76027;
    }
    {
        names[272] = "inner_SMJ_doublezigpuseq_79454_dim1";
        values[272] = (int64_t) 1;
    }
    {
        names[273] = "inner_SMJ_doublezisegmap_76009_dim1";
        values[273] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76011;
    }
    {
        names[274] = "inner_SMJ_doublezisegmap_76009zisegmap_tblock_sizze_76012";
        values[274] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76011;
    }
    {
        names[275] = "inner_SMJ_doublezisegmap_76017_dim1";
        values[275] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76019;
    }
    {
        names[276] = "inner_SMJ_doublezisegmap_76017zisegmap_tblock_sizze_76020";
        values[276] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76019;
    }
    {
        names[277] = "inner_SMJ_doublezigpuseq_79407_dim1";
        values[277] = (int64_t) 1;
    }
    {
        names[278] = "inner_SMJ_doublezigpuseq_79401_dim1";
        values[278] = (int64_t) 1;
    }
    {
        names[279] = "inner_SMJ_doublezigpuseq_79395_dim1";
        values[279] = (int64_t) 1;
    }
    {
        names[280] = "inner_SMJ_doublezisegmap_76001_dim1";
        values[280] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75985;
    }
    {
        names[281] = "inner_SMJ_doublezisegmap_76001zisegmap_tblock_sizze_75997";
        values[281] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75985;
    }
    {
        names[282] = "inner_SMJ_doublezisegscan_75981_dim1";
        values[282] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75975;
    }
    {
        names[283] = "inner_SMJ_doublezisegscan_75981zisegscan_tblock_sizze_75976";
        values[283] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75975;
    }
    {
        names[284] = "inner_SMJ_doublezisegscan_75981zichunk_sizze_79238";
        values[284] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[285] = "inner_SMJ_doublezisegmap_75967_dim1";
        values[285] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75969;
    }
    {
        names[286] = "inner_SMJ_doublezisegmap_75967zisegmap_tblock_sizze_75970";
        values[286] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75969;
    }
    {
        names[287] = "inner_SMJ_doublezisegscan_75965_dim1";
        values[287] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75959;
    }
    {
        names[288] = "inner_SMJ_doublezisegscan_75965zisegscan_tblock_sizze_75960";
        values[288] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75959;
    }
    {
        names[289] = "inner_SMJ_doublezisegscan_75965zichunk_sizze_79081";
        values[289] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[290] = "inner_SMJ_doublezigpuseq_79070_dim1";
        values[290] = (int64_t) 1;
    }
    {
        names[291] = "inner_SMJ_doublezisegmap_75954_dim1";
        values[291] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75941;
    }
    {
        names[292] = "inner_SMJ_doublezisegmap_75954zisegmap_tblock_sizze_75950";
        values[292] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75941;
    }
    {
        names[293] = "inner_SMJ_doublezisegmap_75933_dim1";
        values[293] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75919;
    }
    {
        names[294] = "inner_SMJ_doublezisegmap_75933zisegmap_tblock_sizze_75929";
        values[294] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75919;
    }
    {
        names[295] = "inner_SMJ_doublezisegmap_75912_dim1";
        values[295] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75899;
    }
    {
        names[296] = "inner_SMJ_doublezisegmap_75912zisegmap_tblock_sizze_75908";
        values[296] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75899;
    }
    {
        names[297] = "inner_SMJ_doublezisegmap_75891_dim1";
        values[297] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75877;
    }
    {
        names[298] = "inner_SMJ_doublezisegmap_75891zisegmap_tblock_sizze_75887";
        values[298] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75877;
    }
    {
        names[299] = "inner_SMJ_doublezisegmap_75870_dim1";
        values[299] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75857;
    }
    {
        names[300] = "inner_SMJ_doublezisegmap_75870zisegmap_tblock_sizze_75866";
        values[300] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75857;
    }
    {
        names[301] = "inner_SMJ_doublezisegmap_75849_dim1";
        values[301] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75835;
    }
    {
        names[302] = "inner_SMJ_doublezisegmap_75849zisegmap_tblock_sizze_75845";
        values[302] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75835;
    }
    {
        names[303] = "inner_SMJ_doublezisegmap_intrablock_77122_dim1";
        values[303] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123;
    }
    {
        names[304] = "inner_SMJ_doublezisegmap_intrablock_77122zitile_sizze_77124";
        values[304] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123;
    }
    {
        names[305] = "inner_SMJ_doublezisegmap_intrablock_77122zibytes_77741";
        values[305] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123;
    }
    {
        names[306] = "inner_SMJ_doublezisegmap_intrablock_76767_dim1";
        values[306] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768;
    }
    {
        names[307] = "inner_SMJ_doublezisegmap_intrablock_76767zitile_sizze_76769";
        values[307] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768;
    }
    {
        names[308] = "inner_SMJ_doublezisegmap_intrablock_76767zibytes_77802";
        values[308] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768;
    }
    {
        names[309] = "inner_SMJ_doublezigpuseq_78957_dim1";
        values[309] = (int64_t) 1;
    }
    {
        names[310] = "inner_SMJ_doublezigpuseq_78951_dim1";
        values[310] = (int64_t) 1;
    }
    {
        names[311] = "inner_SMJ_doublezigpuseq_78945_dim1";
        values[311] = (int64_t) 1;
    }
    {
        names[312] = "inner_SMJ_doublezigpuseq_78929_dim1";
        values[312] = (int64_t) 1;
    }
    {
        names[313] = "inner_SMJ_doublezigpuseq_78923_dim1";
        values[313] = (int64_t) 1;
    }
    {
        names[314] = "inner_SMJ_doublezisegmap_75497_dim1";
        values[314] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75328;
    }
    {
        names[315] = "inner_SMJ_doublezisegmap_75497zisegmap_tblock_sizze_75492";
        values[315] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75328;
    }
    {
        names[316] = "inner_SMJ_doublezisegmap_75123_dim1";
        values[316] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_74911;
    }
    {
        names[317] = "inner_SMJ_doublezisegmap_75123zisegmap_tblock_sizze_75118";
        values[317] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_74911;
    }
    {
        names[318] = "inner_SMJ_doublezigpuseq_78861_dim1";
        values[318] = (int64_t) 1;
    }
    {
        names[319] = "inner_SMJ_doublezigpuseq_78855_dim1";
        values[319] = (int64_t) 1;
    }
    {
        names[320] = "inner_SMJ_doublezigpuseq_78849_dim1";
        values[320] = (int64_t) 1;
    }
    {
        names[321] = "inner_SMJ_doublezisegmap_intrablock_76412_dim1";
        values[321] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413;
    }
    {
        names[322] = "inner_SMJ_doublezisegmap_intrablock_76412zitile_sizze_76414";
        values[322] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413;
    }
    {
        names[323] = "inner_SMJ_doublezisegmap_intrablock_76412zibytes_77946";
        values[323] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413;
    }
    {
        names[324] = "inner_SMJ_doublezisegmap_intrablock_76057_dim1";
        values[324] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058;
    }
    {
        names[325] = "inner_SMJ_doublezisegmap_intrablock_76057zitile_sizze_76059";
        values[325] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058;
    }
    {
        names[326] = "inner_SMJ_doublezisegmap_intrablock_76057zibytes_78007";
        values[326] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058;
    }
    {
        names[327] = "inner_SMJ_doublezigpuseq_78790_dim1";
        values[327] = (int64_t) 1;
    }
    {
        names[328] = "inner_SMJ_doublezigpuseq_78784_dim1";
        values[328] = (int64_t) 1;
    }
    {
        names[329] = "inner_SMJ_doublezigpuseq_78778_dim1";
        values[329] = (int64_t) 1;
    }
    {
        names[330] = "inner_SMJ_doublezigpuseq_78762_dim1";
        values[330] = (int64_t) 1;
    }
    {
        names[331] = "inner_SMJ_doublezigpuseq_78756_dim1";
        values[331] = (int64_t) 1;
    }
    {
        names[332] = "inner_SMJ_doublezigpuseq_78724_dim1";
        values[332] = (int64_t) 1;
    }
    {
        names[333] = "gather_payloads_short_GFURzisegmap_69255_dim1";
        values[333] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69233;
    }
    {
        names[334] = "gather_payloads_short_GFURzisegmap_69255zisegmap_tblock_sizze_69251";
        values[334] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69233;
    }
    {
        names[335] = "gather_payloads_short_GFURzisegmap_69227_dim1";
        values[335] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69215;
    }
    {
        names[336] = "gather_payloads_short_GFURzisegmap_69227zisegmap_tblock_sizze_69223";
        values[336] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69215;
    }
    {
        names[337] = "gather_payloads_shortzisegmap_68975_dim1";
        values[337] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68953;
    }
    {
        names[338] = "gather_payloads_shortzisegmap_68975zisegmap_tblock_sizze_68971";
        values[338] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68953;
    }
    {
        names[339] = "gather_payloads_shortzisegmap_68947_dim1";
        values[339] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68935;
    }
    {
        names[340] = "gather_payloads_shortzisegmap_68947zisegmap_tblock_sizze_68943";
        values[340] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68935;
    }
    {
        names[341] = "gather_payloads_long_GFURzisegmap_69367_dim1";
        values[341] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69345;
    }
    {
        names[342] = "gather_payloads_long_GFURzisegmap_69367zisegmap_tblock_sizze_69363";
        values[342] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69345;
    }
    {
        names[343] = "gather_payloads_long_GFURzisegmap_69339_dim1";
        values[343] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69327;
    }
    {
        names[344] = "gather_payloads_long_GFURzisegmap_69339zisegmap_tblock_sizze_69335";
        values[344] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69327;
    }
    {
        names[345] = "gather_payloads_longzisegmap_69087_dim1";
        values[345] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69065;
    }
    {
        names[346] = "gather_payloads_longzisegmap_69087zisegmap_tblock_sizze_69083";
        values[346] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69065;
    }
    {
        names[347] = "gather_payloads_longzisegmap_69059_dim1";
        values[347] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69047;
    }
    {
        names[348] = "gather_payloads_longzisegmap_69059zisegmap_tblock_sizze_69055";
        values[348] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69047;
    }
    {
        names[349] = "gather_payloads_int_GFURzisegmap_69311_dim1";
        values[349] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69289;
    }
    {
        names[350] = "gather_payloads_int_GFURzisegmap_69311zisegmap_tblock_sizze_69307";
        values[350] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69289;
    }
    {
        names[351] = "gather_payloads_int_GFURzisegmap_69283_dim1";
        values[351] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69271;
    }
    {
        names[352] = "gather_payloads_int_GFURzisegmap_69283zisegmap_tblock_sizze_69279";
        values[352] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69271;
    }
    {
        names[353] = "gather_payloads_intzisegmap_69031_dim1";
        values[353] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_69009;
    }
    {
        names[354] = "gather_payloads_intzisegmap_69031zisegmap_tblock_sizze_69027";
        values[354] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_69009;
    }
    {
        names[355] = "gather_payloads_intzisegmap_69003_dim1";
        values[355] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_68991;
    }
    {
        names[356] = "gather_payloads_intzisegmap_69003zisegmap_tblock_sizze_68999";
        values[356] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_68991;
    }
    {
        names[357] = "gather_payloads_float_GFURzisegmap_69423_dim1";
        values[357] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69401;
    }
    {
        names[358] = "gather_payloads_float_GFURzisegmap_69423zisegmap_tblock_sizze_69419";
        values[358] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69401;
    }
    {
        names[359] = "gather_payloads_float_GFURzisegmap_69395_dim1";
        values[359] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69383;
    }
    {
        names[360] = "gather_payloads_float_GFURzisegmap_69395zisegmap_tblock_sizze_69391";
        values[360] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69383;
    }
    {
        names[361] = "gather_payloads_floatzisegmap_69143_dim1";
        values[361] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69121;
    }
    {
        names[362] = "gather_payloads_floatzisegmap_69143zisegmap_tblock_sizze_69139";
        values[362] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69121;
    }
    {
        names[363] = "gather_payloads_floatzisegmap_69115_dim1";
        values[363] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69103;
    }
    {
        names[364] = "gather_payloads_floatzisegmap_69115zisegmap_tblock_sizze_69111";
        values[364] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69103;
    }
    {
        names[365] = "gather_payloads_double_GFURzisegmap_69479_dim1";
        values[365] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69457;
    }
    {
        names[366] = "gather_payloads_double_GFURzisegmap_69479zisegmap_tblock_sizze_69475";
        values[366] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69457;
    }
    {
        names[367] = "gather_payloads_double_GFURzisegmap_69451_dim1";
        values[367] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69439;
    }
    {
        names[368] = "gather_payloads_double_GFURzisegmap_69451zisegmap_tblock_sizze_69447";
        values[368] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69439;
    }
    {
        names[369] = "gather_payloads_doublezisegmap_69199_dim1";
        values[369] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69177;
    }
    {
        names[370] = "gather_payloads_doublezisegmap_69199zisegmap_tblock_sizze_69195";
        values[370] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69177;
    }
    {
        names[371] = "gather_payloads_doublezisegmap_69171_dim1";
        values[371] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69159;
    }
    {
        names[372] = "gather_payloads_doublezisegmap_69171zisegmap_tblock_sizze_69167";
        values[372] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69159;
    }
    *names_out = names;
    *values_out = values;
    return num_macros;
}
static char *get_failure_msg(int failure_idx, int64_t args[])
{
    (void) args;
    switch (failure_idx) {
        
      case 0:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:431:5-41\n   #4  ftSMJ.fut:430:1-431:41\n", args[0], args[1]);
            break;
        }
        
      case 1:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:459:5-50\n   #4  ftSMJ.fut:458:1-459:50\n", args[0], args[1]);
            break;
        }
        
      case 2:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:428:5-41\n   #4  ftSMJ.fut:427:1-428:41\n", args[0], args[1]);
            break;
        }
        
      case 3:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:456:5-50\n   #4  ftSMJ.fut:455:1-456:50\n", args[0], args[1]);
            break;
        }
        
      case 4:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:422:5-41\n   #4  ftSMJ.fut:421:1-422:41\n", args[0], args[1]);
            break;
        }
        
      case 5:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:450:5-50\n   #4  ftSMJ.fut:449:1-450:50\n", args[0], args[1]);
            break;
        }
        
      case 6:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:425:5-41\n   #4  ftSMJ.fut:424:1-425:41\n", args[0], args[1]);
            break;
        }
        
      case 7:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:453:5-50\n   #4  ftSMJ.fut:452:1-453:50\n", args[0], args[1]);
            break;
        }
        
      case 8:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:419:5-41\n   #4  ftSMJ.fut:418:1-419:41\n", args[0], args[1]);
            break;
        }
        
      case 9:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:447:5-50\n   #4  ftSMJ.fut:446:1-447:50\n", args[0], args[1]);
            break;
        }
        
      case 10:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:44-49\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 11:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:55-60\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 12:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:303:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 13:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 14:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 15:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 16:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 17:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:255:8-14\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 18:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:31-39\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 19:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:45-50\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 20:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:15-24\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 21:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:31-38\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 22:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:15-22\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 23:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:28-35\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:403:133-136\n   #5  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 24:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:329:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 25:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 26:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 27:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 28:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 29:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:129:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 30:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 31:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 32:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 33:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 34:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 35:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:139:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 36:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 37:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 38:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 39:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 40:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 41:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:155:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n", args[0], args[1]);
            break;
        }
        
      case 42:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:44-49\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 43:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:55-60\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 44:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:303:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 45:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 46:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 47:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 48:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 49:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:255:8-14\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 50:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:31-39\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 51:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:45-50\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 52:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:15-24\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 53:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:31-38\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 54:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:15-22\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 55:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:28-35\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:390:133-136\n   #5  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 56:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:329:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 57:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 58:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 59:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 60:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 61:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:129:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 62:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 63:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 64:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 65:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 66:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 67:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:139:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 68:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 69:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 70:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 71:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 72:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 73:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:155:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n", args[0], args[1]);
            break;
        }
        
      case 74:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:44-49\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 75:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:55-60\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 76:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:303:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 77:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 78:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 79:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 80:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 81:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:255:8-14\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 82:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:31-39\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 83:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:45-50\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 84:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:15-24\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 85:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:31-38\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 86:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:15-22\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 87:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:28-35\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:364:133-136\n   #5  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 88:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:329:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 89:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 90:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 91:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 92:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 93:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:129:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 94:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 95:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 96:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 97:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 98:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 99:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:139:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 100:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 101:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 102:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 103:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 104:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 105:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:155:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n", args[0], args[1]);
            break;
        }
        
      case 106:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:44-49\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 107:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:55-60\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 108:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:303:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 109:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 110:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 111:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 112:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 113:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:255:8-14\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 114:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:31-39\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 115:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:45-50\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 116:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:15-24\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 117:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:31-38\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 118:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:15-22\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 119:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:28-35\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:377:133-136\n   #5  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 120:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:329:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 121:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 122:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 123:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 124:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 125:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:129:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 126:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 127:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 128:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 129:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 130:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 131:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:139:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 132:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 133:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 134:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 135:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 136:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 137:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:155:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n", args[0], args[1]);
            break;
        }
        
      case 138:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:44-49\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 139:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:285:55-60\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 140:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:303:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 141:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 142:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:314:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 143:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 144:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:321:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 145:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:255:8-14\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 146:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:31-39\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 147:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:253:45-50\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 148:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:15-24\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 149:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:261:31-38\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 150:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:15-22\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 151:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:271:28-35\n   #1  ftsort.fut:325:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftsort.fut:290:8-350:8\n   #4  ftSMJ.fut:351:133-136\n   #5  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 152:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:329:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 153:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 154:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:330:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 155:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 156:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 157:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:129:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 158:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 159:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 160:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 161:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 162:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 163:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:139:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 164:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 165:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 166:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 167:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 168:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
        
      case 169:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:155:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:126:8-164:6\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n", args[0], args[1]);
            break;
        }
    }
    return strdup("Unknown error.  This is a compiler bug.");
}
struct program {
    int dummy;
    gpu_kernel builtinzhiota_i64ziiota_i64_78706;
    gpu_kernel builtinzhreplicate_f32zireplicate_78735;
    gpu_kernel builtinzhreplicate_f64zireplicate_78735;
    gpu_kernel builtinzhreplicate_i16zireplicate_78735;
    gpu_kernel builtinzhreplicate_i32zireplicate_79117;
    gpu_kernel builtinzhreplicate_i64zireplicate_78709;
    gpu_kernel builtinzhreplicate_i8zireplicate_79091;
    gpu_kernel gather_payloads_doublezisegmap_69171;
    gpu_kernel gather_payloads_doublezisegmap_69199;
    gpu_kernel gather_payloads_double_GFURzisegmap_69451;
    gpu_kernel gather_payloads_double_GFURzisegmap_69479;
    gpu_kernel gather_payloads_floatzisegmap_69115;
    gpu_kernel gather_payloads_floatzisegmap_69143;
    gpu_kernel gather_payloads_float_GFURzisegmap_69395;
    gpu_kernel gather_payloads_float_GFURzisegmap_69423;
    gpu_kernel gather_payloads_intzisegmap_69003;
    gpu_kernel gather_payloads_intzisegmap_69031;
    gpu_kernel gather_payloads_int_GFURzisegmap_69283;
    gpu_kernel gather_payloads_int_GFURzisegmap_69311;
    gpu_kernel gather_payloads_longzisegmap_69059;
    gpu_kernel gather_payloads_longzisegmap_69087;
    gpu_kernel gather_payloads_long_GFURzisegmap_69339;
    gpu_kernel gather_payloads_long_GFURzisegmap_69367;
    gpu_kernel gather_payloads_shortzisegmap_68947;
    gpu_kernel gather_payloads_shortzisegmap_68975;
    gpu_kernel gather_payloads_short_GFURzisegmap_69227;
    gpu_kernel gather_payloads_short_GFURzisegmap_69255;
    gpu_kernel inner_SMJ_doublezigpuseq_78724;
    gpu_kernel inner_SMJ_doublezigpuseq_78756;
    gpu_kernel inner_SMJ_doublezigpuseq_78762;
    gpu_kernel inner_SMJ_doublezigpuseq_78778;
    gpu_kernel inner_SMJ_doublezigpuseq_78784;
    gpu_kernel inner_SMJ_doublezigpuseq_78790;
    gpu_kernel inner_SMJ_doublezigpuseq_78849;
    gpu_kernel inner_SMJ_doublezigpuseq_78855;
    gpu_kernel inner_SMJ_doublezigpuseq_78861;
    gpu_kernel inner_SMJ_doublezigpuseq_78923;
    gpu_kernel inner_SMJ_doublezigpuseq_78929;
    gpu_kernel inner_SMJ_doublezigpuseq_78945;
    gpu_kernel inner_SMJ_doublezigpuseq_78951;
    gpu_kernel inner_SMJ_doublezigpuseq_78957;
    gpu_kernel inner_SMJ_doublezigpuseq_79070;
    gpu_kernel inner_SMJ_doublezigpuseq_79395;
    gpu_kernel inner_SMJ_doublezigpuseq_79401;
    gpu_kernel inner_SMJ_doublezigpuseq_79407;
    gpu_kernel inner_SMJ_doublezigpuseq_79454;
    gpu_kernel inner_SMJ_doublezireplicate_79461;
    gpu_kernel inner_SMJ_doublezireplicate_79481;
    gpu_kernel inner_SMJ_doublezisegmap_75123;
    gpu_kernel inner_SMJ_doublezisegmap_75497;
    gpu_kernel inner_SMJ_doublezisegmap_75849;
    gpu_kernel inner_SMJ_doublezisegmap_75870;
    gpu_kernel inner_SMJ_doublezisegmap_75891;
    gpu_kernel inner_SMJ_doublezisegmap_75912;
    gpu_kernel inner_SMJ_doublezisegmap_75933;
    gpu_kernel inner_SMJ_doublezisegmap_75954;
    gpu_kernel inner_SMJ_doublezisegmap_75967;
    gpu_kernel inner_SMJ_doublezisegmap_76001;
    gpu_kernel inner_SMJ_doublezisegmap_76009;
    gpu_kernel inner_SMJ_doublezisegmap_76017;
    gpu_kernel inner_SMJ_doublezisegmap_76039;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_76057;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_76412;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_76767;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_77122;
    gpu_kernel inner_SMJ_doublezisegscan_75965;
    gpu_kernel inner_SMJ_doublezisegscan_75981;
    gpu_kernel inner_SMJ_floatzigpuseq_78724;
    gpu_kernel inner_SMJ_floatzigpuseq_78756;
    gpu_kernel inner_SMJ_floatzigpuseq_78762;
    gpu_kernel inner_SMJ_floatzigpuseq_78778;
    gpu_kernel inner_SMJ_floatzigpuseq_78784;
    gpu_kernel inner_SMJ_floatzigpuseq_78790;
    gpu_kernel inner_SMJ_floatzigpuseq_78849;
    gpu_kernel inner_SMJ_floatzigpuseq_78855;
    gpu_kernel inner_SMJ_floatzigpuseq_78861;
    gpu_kernel inner_SMJ_floatzigpuseq_78923;
    gpu_kernel inner_SMJ_floatzigpuseq_78929;
    gpu_kernel inner_SMJ_floatzigpuseq_78945;
    gpu_kernel inner_SMJ_floatzigpuseq_78951;
    gpu_kernel inner_SMJ_floatzigpuseq_78957;
    gpu_kernel inner_SMJ_floatzigpuseq_79070;
    gpu_kernel inner_SMJ_floatzigpuseq_79395;
    gpu_kernel inner_SMJ_floatzigpuseq_79401;
    gpu_kernel inner_SMJ_floatzigpuseq_79407;
    gpu_kernel inner_SMJ_floatzigpuseq_79454;
    gpu_kernel inner_SMJ_floatzireplicate_79461;
    gpu_kernel inner_SMJ_floatzireplicate_79481;
    gpu_kernel inner_SMJ_floatzisegmap_73813;
    gpu_kernel inner_SMJ_floatzisegmap_74187;
    gpu_kernel inner_SMJ_floatzisegmap_74539;
    gpu_kernel inner_SMJ_floatzisegmap_74560;
    gpu_kernel inner_SMJ_floatzisegmap_74581;
    gpu_kernel inner_SMJ_floatzisegmap_74602;
    gpu_kernel inner_SMJ_floatzisegmap_74623;
    gpu_kernel inner_SMJ_floatzisegmap_74644;
    gpu_kernel inner_SMJ_floatzisegmap_74657;
    gpu_kernel inner_SMJ_floatzisegmap_74691;
    gpu_kernel inner_SMJ_floatzisegmap_74699;
    gpu_kernel inner_SMJ_floatzisegmap_74707;
    gpu_kernel inner_SMJ_floatzisegmap_74729;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_76057;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_76412;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_76767;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_77122;
    gpu_kernel inner_SMJ_floatzisegscan_74655;
    gpu_kernel inner_SMJ_floatzisegscan_74671;
    gpu_kernel inner_SMJ_intzigpuseq_78724;
    gpu_kernel inner_SMJ_intzigpuseq_78756;
    gpu_kernel inner_SMJ_intzigpuseq_78762;
    gpu_kernel inner_SMJ_intzigpuseq_78778;
    gpu_kernel inner_SMJ_intzigpuseq_78784;
    gpu_kernel inner_SMJ_intzigpuseq_78790;
    gpu_kernel inner_SMJ_intzigpuseq_78849;
    gpu_kernel inner_SMJ_intzigpuseq_78855;
    gpu_kernel inner_SMJ_intzigpuseq_78861;
    gpu_kernel inner_SMJ_intzigpuseq_78923;
    gpu_kernel inner_SMJ_intzigpuseq_78929;
    gpu_kernel inner_SMJ_intzigpuseq_78945;
    gpu_kernel inner_SMJ_intzigpuseq_78951;
    gpu_kernel inner_SMJ_intzigpuseq_78957;
    gpu_kernel inner_SMJ_intzigpuseq_79070;
    gpu_kernel inner_SMJ_intzigpuseq_79375;
    gpu_kernel inner_SMJ_intzigpuseq_79381;
    gpu_kernel inner_SMJ_intzigpuseq_79387;
    gpu_kernel inner_SMJ_intzigpuseq_79434;
    gpu_kernel inner_SMJ_intzireplicate_79441;
    gpu_kernel inner_SMJ_intzireplicate_79461;
    gpu_kernel inner_SMJ_intzisegmap_71193;
    gpu_kernel inner_SMJ_intzisegmap_71567;
    gpu_kernel inner_SMJ_intzisegmap_71919;
    gpu_kernel inner_SMJ_intzisegmap_71940;
    gpu_kernel inner_SMJ_intzisegmap_71961;
    gpu_kernel inner_SMJ_intzisegmap_71982;
    gpu_kernel inner_SMJ_intzisegmap_72003;
    gpu_kernel inner_SMJ_intzisegmap_72024;
    gpu_kernel inner_SMJ_intzisegmap_72037;
    gpu_kernel inner_SMJ_intzisegmap_72071;
    gpu_kernel inner_SMJ_intzisegmap_72079;
    gpu_kernel inner_SMJ_intzisegmap_72087;
    gpu_kernel inner_SMJ_intzisegmap_72109;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_76057;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_76412;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_76767;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_77122;
    gpu_kernel inner_SMJ_intzisegscan_72035;
    gpu_kernel inner_SMJ_intzisegscan_72051;
    gpu_kernel inner_SMJ_longzigpuseq_78724;
    gpu_kernel inner_SMJ_longzigpuseq_78736;
    gpu_kernel inner_SMJ_longzigpuseq_78742;
    gpu_kernel inner_SMJ_longzigpuseq_78758;
    gpu_kernel inner_SMJ_longzigpuseq_78764;
    gpu_kernel inner_SMJ_longzigpuseq_78770;
    gpu_kernel inner_SMJ_longzigpuseq_78829;
    gpu_kernel inner_SMJ_longzigpuseq_78835;
    gpu_kernel inner_SMJ_longzigpuseq_78841;
    gpu_kernel inner_SMJ_longzigpuseq_78903;
    gpu_kernel inner_SMJ_longzigpuseq_78909;
    gpu_kernel inner_SMJ_longzigpuseq_78925;
    gpu_kernel inner_SMJ_longzigpuseq_78931;
    gpu_kernel inner_SMJ_longzigpuseq_78937;
    gpu_kernel inner_SMJ_longzigpuseq_79050;
    gpu_kernel inner_SMJ_longzigpuseq_79375;
    gpu_kernel inner_SMJ_longzigpuseq_79381;
    gpu_kernel inner_SMJ_longzigpuseq_79387;
    gpu_kernel inner_SMJ_longzigpuseq_79434;
    gpu_kernel inner_SMJ_longzireplicate_79441;
    gpu_kernel inner_SMJ_longzireplicate_79461;
    gpu_kernel inner_SMJ_longzisegmap_72503;
    gpu_kernel inner_SMJ_longzisegmap_72877;
    gpu_kernel inner_SMJ_longzisegmap_73229;
    gpu_kernel inner_SMJ_longzisegmap_73250;
    gpu_kernel inner_SMJ_longzisegmap_73271;
    gpu_kernel inner_SMJ_longzisegmap_73292;
    gpu_kernel inner_SMJ_longzisegmap_73313;
    gpu_kernel inner_SMJ_longzisegmap_73334;
    gpu_kernel inner_SMJ_longzisegmap_73347;
    gpu_kernel inner_SMJ_longzisegmap_73381;
    gpu_kernel inner_SMJ_longzisegmap_73389;
    gpu_kernel inner_SMJ_longzisegmap_73397;
    gpu_kernel inner_SMJ_longzisegmap_73419;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_76057;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_76412;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_76767;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_77122;
    gpu_kernel inner_SMJ_longzisegscan_73345;
    gpu_kernel inner_SMJ_longzisegscan_73361;
    gpu_kernel inner_SMJ_shortzigpuseq_78724;
    gpu_kernel inner_SMJ_shortzigpuseq_78756;
    gpu_kernel inner_SMJ_shortzigpuseq_78762;
    gpu_kernel inner_SMJ_shortzigpuseq_78778;
    gpu_kernel inner_SMJ_shortzigpuseq_78784;
    gpu_kernel inner_SMJ_shortzigpuseq_78790;
    gpu_kernel inner_SMJ_shortzigpuseq_78849;
    gpu_kernel inner_SMJ_shortzigpuseq_78855;
    gpu_kernel inner_SMJ_shortzigpuseq_78861;
    gpu_kernel inner_SMJ_shortzigpuseq_78923;
    gpu_kernel inner_SMJ_shortzigpuseq_78929;
    gpu_kernel inner_SMJ_shortzigpuseq_78945;
    gpu_kernel inner_SMJ_shortzigpuseq_78951;
    gpu_kernel inner_SMJ_shortzigpuseq_78957;
    gpu_kernel inner_SMJ_shortzigpuseq_79070;
    gpu_kernel inner_SMJ_shortzigpuseq_79395;
    gpu_kernel inner_SMJ_shortzigpuseq_79401;
    gpu_kernel inner_SMJ_shortzigpuseq_79407;
    gpu_kernel inner_SMJ_shortzigpuseq_79454;
    gpu_kernel inner_SMJ_shortzireplicate_79461;
    gpu_kernel inner_SMJ_shortzireplicate_79481;
    gpu_kernel inner_SMJ_shortzisegmap_69883;
    gpu_kernel inner_SMJ_shortzisegmap_70257;
    gpu_kernel inner_SMJ_shortzisegmap_70609;
    gpu_kernel inner_SMJ_shortzisegmap_70630;
    gpu_kernel inner_SMJ_shortzisegmap_70651;
    gpu_kernel inner_SMJ_shortzisegmap_70672;
    gpu_kernel inner_SMJ_shortzisegmap_70693;
    gpu_kernel inner_SMJ_shortzisegmap_70714;
    gpu_kernel inner_SMJ_shortzisegmap_70727;
    gpu_kernel inner_SMJ_shortzisegmap_70761;
    gpu_kernel inner_SMJ_shortzisegmap_70769;
    gpu_kernel inner_SMJ_shortzisegmap_70777;
    gpu_kernel inner_SMJ_shortzisegmap_70799;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_76057;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_76412;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_76767;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_77122;
    gpu_kernel inner_SMJ_shortzisegscan_70725;
    gpu_kernel inner_SMJ_shortzisegscan_70741;
    gpu_kernel max_idxzisegred_nonseg_68931;
    gpu_kernel min_idxzisegred_nonseg_68921;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    gpu_create_kernel(ctx, &ctx->program->builtinzhiota_i64ziiota_i64_78706, "builtinzhiota_i64ziiota_i64_78706");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f32zireplicate_78735, "builtinzhreplicate_f32zireplicate_78735");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f64zireplicate_78735, "builtinzhreplicate_f64zireplicate_78735");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i16zireplicate_78735, "builtinzhreplicate_i16zireplicate_78735");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i32zireplicate_79117, "builtinzhreplicate_i32zireplicate_79117");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i64zireplicate_78709, "builtinzhreplicate_i64zireplicate_78709");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i8zireplicate_79091, "builtinzhreplicate_i8zireplicate_79091");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_doublezisegmap_69171, "gather_payloads_doublezisegmap_69171");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_doublezisegmap_69199, "gather_payloads_doublezisegmap_69199");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_double_GFURzisegmap_69451, "gather_payloads_double_GFURzisegmap_69451");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_double_GFURzisegmap_69479, "gather_payloads_double_GFURzisegmap_69479");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_floatzisegmap_69115, "gather_payloads_floatzisegmap_69115");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_floatzisegmap_69143, "gather_payloads_floatzisegmap_69143");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_float_GFURzisegmap_69395, "gather_payloads_float_GFURzisegmap_69395");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_float_GFURzisegmap_69423, "gather_payloads_float_GFURzisegmap_69423");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_intzisegmap_69003, "gather_payloads_intzisegmap_69003");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_intzisegmap_69031, "gather_payloads_intzisegmap_69031");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_int_GFURzisegmap_69283, "gather_payloads_int_GFURzisegmap_69283");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_int_GFURzisegmap_69311, "gather_payloads_int_GFURzisegmap_69311");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_longzisegmap_69059, "gather_payloads_longzisegmap_69059");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_longzisegmap_69087, "gather_payloads_longzisegmap_69087");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_long_GFURzisegmap_69339, "gather_payloads_long_GFURzisegmap_69339");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_long_GFURzisegmap_69367, "gather_payloads_long_GFURzisegmap_69367");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_shortzisegmap_68947, "gather_payloads_shortzisegmap_68947");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_shortzisegmap_68975, "gather_payloads_shortzisegmap_68975");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_short_GFURzisegmap_69227, "gather_payloads_short_GFURzisegmap_69227");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_short_GFURzisegmap_69255, "gather_payloads_short_GFURzisegmap_69255");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78724, "inner_SMJ_doublezigpuseq_78724");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78756, "inner_SMJ_doublezigpuseq_78756");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78762, "inner_SMJ_doublezigpuseq_78762");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78778, "inner_SMJ_doublezigpuseq_78778");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78784, "inner_SMJ_doublezigpuseq_78784");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78790, "inner_SMJ_doublezigpuseq_78790");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78849, "inner_SMJ_doublezigpuseq_78849");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78855, "inner_SMJ_doublezigpuseq_78855");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78861, "inner_SMJ_doublezigpuseq_78861");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78923, "inner_SMJ_doublezigpuseq_78923");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78929, "inner_SMJ_doublezigpuseq_78929");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78945, "inner_SMJ_doublezigpuseq_78945");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78951, "inner_SMJ_doublezigpuseq_78951");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_78957, "inner_SMJ_doublezigpuseq_78957");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_79070, "inner_SMJ_doublezigpuseq_79070");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_79395, "inner_SMJ_doublezigpuseq_79395");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_79401, "inner_SMJ_doublezigpuseq_79401");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_79407, "inner_SMJ_doublezigpuseq_79407");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_79454, "inner_SMJ_doublezigpuseq_79454");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezireplicate_79461, "inner_SMJ_doublezireplicate_79461");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezireplicate_79481, "inner_SMJ_doublezireplicate_79481");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75123, "inner_SMJ_doublezisegmap_75123");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75497, "inner_SMJ_doublezisegmap_75497");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75849, "inner_SMJ_doublezisegmap_75849");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75870, "inner_SMJ_doublezisegmap_75870");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75891, "inner_SMJ_doublezisegmap_75891");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75912, "inner_SMJ_doublezisegmap_75912");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75933, "inner_SMJ_doublezisegmap_75933");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75954, "inner_SMJ_doublezisegmap_75954");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_75967, "inner_SMJ_doublezisegmap_75967");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_76001, "inner_SMJ_doublezisegmap_76001");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_76009, "inner_SMJ_doublezisegmap_76009");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_76017, "inner_SMJ_doublezisegmap_76017");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_76039, "inner_SMJ_doublezisegmap_76039");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_76057, "inner_SMJ_doublezisegmap_intrablock_76057");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_76412, "inner_SMJ_doublezisegmap_intrablock_76412");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_76767, "inner_SMJ_doublezisegmap_intrablock_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_77122, "inner_SMJ_doublezisegmap_intrablock_77122");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegscan_75965, "inner_SMJ_doublezisegscan_75965");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegscan_75981, "inner_SMJ_doublezisegscan_75981");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78724, "inner_SMJ_floatzigpuseq_78724");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78756, "inner_SMJ_floatzigpuseq_78756");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78762, "inner_SMJ_floatzigpuseq_78762");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78778, "inner_SMJ_floatzigpuseq_78778");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78784, "inner_SMJ_floatzigpuseq_78784");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78790, "inner_SMJ_floatzigpuseq_78790");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78849, "inner_SMJ_floatzigpuseq_78849");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78855, "inner_SMJ_floatzigpuseq_78855");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78861, "inner_SMJ_floatzigpuseq_78861");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78923, "inner_SMJ_floatzigpuseq_78923");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78929, "inner_SMJ_floatzigpuseq_78929");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78945, "inner_SMJ_floatzigpuseq_78945");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78951, "inner_SMJ_floatzigpuseq_78951");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_78957, "inner_SMJ_floatzigpuseq_78957");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_79070, "inner_SMJ_floatzigpuseq_79070");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_79395, "inner_SMJ_floatzigpuseq_79395");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_79401, "inner_SMJ_floatzigpuseq_79401");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_79407, "inner_SMJ_floatzigpuseq_79407");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_79454, "inner_SMJ_floatzigpuseq_79454");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzireplicate_79461, "inner_SMJ_floatzireplicate_79461");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzireplicate_79481, "inner_SMJ_floatzireplicate_79481");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_73813, "inner_SMJ_floatzisegmap_73813");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74187, "inner_SMJ_floatzisegmap_74187");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74539, "inner_SMJ_floatzisegmap_74539");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74560, "inner_SMJ_floatzisegmap_74560");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74581, "inner_SMJ_floatzisegmap_74581");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74602, "inner_SMJ_floatzisegmap_74602");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74623, "inner_SMJ_floatzisegmap_74623");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74644, "inner_SMJ_floatzisegmap_74644");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74657, "inner_SMJ_floatzisegmap_74657");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74691, "inner_SMJ_floatzisegmap_74691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74699, "inner_SMJ_floatzisegmap_74699");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74707, "inner_SMJ_floatzisegmap_74707");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_74729, "inner_SMJ_floatzisegmap_74729");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_76057, "inner_SMJ_floatzisegmap_intrablock_76057");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_76412, "inner_SMJ_floatzisegmap_intrablock_76412");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_76767, "inner_SMJ_floatzisegmap_intrablock_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_77122, "inner_SMJ_floatzisegmap_intrablock_77122");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegscan_74655, "inner_SMJ_floatzisegscan_74655");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegscan_74671, "inner_SMJ_floatzisegscan_74671");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78724, "inner_SMJ_intzigpuseq_78724");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78756, "inner_SMJ_intzigpuseq_78756");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78762, "inner_SMJ_intzigpuseq_78762");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78778, "inner_SMJ_intzigpuseq_78778");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78784, "inner_SMJ_intzigpuseq_78784");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78790, "inner_SMJ_intzigpuseq_78790");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78849, "inner_SMJ_intzigpuseq_78849");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78855, "inner_SMJ_intzigpuseq_78855");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78861, "inner_SMJ_intzigpuseq_78861");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78923, "inner_SMJ_intzigpuseq_78923");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78929, "inner_SMJ_intzigpuseq_78929");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78945, "inner_SMJ_intzigpuseq_78945");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78951, "inner_SMJ_intzigpuseq_78951");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_78957, "inner_SMJ_intzigpuseq_78957");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_79070, "inner_SMJ_intzigpuseq_79070");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_79375, "inner_SMJ_intzigpuseq_79375");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_79381, "inner_SMJ_intzigpuseq_79381");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_79387, "inner_SMJ_intzigpuseq_79387");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_79434, "inner_SMJ_intzigpuseq_79434");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzireplicate_79441, "inner_SMJ_intzireplicate_79441");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzireplicate_79461, "inner_SMJ_intzireplicate_79461");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71193, "inner_SMJ_intzisegmap_71193");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71567, "inner_SMJ_intzisegmap_71567");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71919, "inner_SMJ_intzisegmap_71919");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71940, "inner_SMJ_intzisegmap_71940");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71961, "inner_SMJ_intzisegmap_71961");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_71982, "inner_SMJ_intzisegmap_71982");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72003, "inner_SMJ_intzisegmap_72003");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72024, "inner_SMJ_intzisegmap_72024");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72037, "inner_SMJ_intzisegmap_72037");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72071, "inner_SMJ_intzisegmap_72071");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72079, "inner_SMJ_intzisegmap_72079");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72087, "inner_SMJ_intzisegmap_72087");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_72109, "inner_SMJ_intzisegmap_72109");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_76057, "inner_SMJ_intzisegmap_intrablock_76057");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_76412, "inner_SMJ_intzisegmap_intrablock_76412");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_76767, "inner_SMJ_intzisegmap_intrablock_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_77122, "inner_SMJ_intzisegmap_intrablock_77122");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegscan_72035, "inner_SMJ_intzisegscan_72035");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegscan_72051, "inner_SMJ_intzisegscan_72051");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78724, "inner_SMJ_longzigpuseq_78724");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78736, "inner_SMJ_longzigpuseq_78736");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78742, "inner_SMJ_longzigpuseq_78742");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78758, "inner_SMJ_longzigpuseq_78758");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78764, "inner_SMJ_longzigpuseq_78764");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78770, "inner_SMJ_longzigpuseq_78770");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78829, "inner_SMJ_longzigpuseq_78829");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78835, "inner_SMJ_longzigpuseq_78835");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78841, "inner_SMJ_longzigpuseq_78841");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78903, "inner_SMJ_longzigpuseq_78903");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78909, "inner_SMJ_longzigpuseq_78909");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78925, "inner_SMJ_longzigpuseq_78925");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78931, "inner_SMJ_longzigpuseq_78931");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_78937, "inner_SMJ_longzigpuseq_78937");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_79050, "inner_SMJ_longzigpuseq_79050");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_79375, "inner_SMJ_longzigpuseq_79375");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_79381, "inner_SMJ_longzigpuseq_79381");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_79387, "inner_SMJ_longzigpuseq_79387");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_79434, "inner_SMJ_longzigpuseq_79434");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzireplicate_79441, "inner_SMJ_longzireplicate_79441");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzireplicate_79461, "inner_SMJ_longzireplicate_79461");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_72503, "inner_SMJ_longzisegmap_72503");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_72877, "inner_SMJ_longzisegmap_72877");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73229, "inner_SMJ_longzisegmap_73229");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73250, "inner_SMJ_longzisegmap_73250");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73271, "inner_SMJ_longzisegmap_73271");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73292, "inner_SMJ_longzisegmap_73292");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73313, "inner_SMJ_longzisegmap_73313");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73334, "inner_SMJ_longzisegmap_73334");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73347, "inner_SMJ_longzisegmap_73347");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73381, "inner_SMJ_longzisegmap_73381");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73389, "inner_SMJ_longzisegmap_73389");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73397, "inner_SMJ_longzisegmap_73397");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_73419, "inner_SMJ_longzisegmap_73419");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_76057, "inner_SMJ_longzisegmap_intrablock_76057");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_76412, "inner_SMJ_longzisegmap_intrablock_76412");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_76767, "inner_SMJ_longzisegmap_intrablock_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_77122, "inner_SMJ_longzisegmap_intrablock_77122");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegscan_73345, "inner_SMJ_longzisegscan_73345");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegscan_73361, "inner_SMJ_longzisegscan_73361");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78724, "inner_SMJ_shortzigpuseq_78724");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78756, "inner_SMJ_shortzigpuseq_78756");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78762, "inner_SMJ_shortzigpuseq_78762");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78778, "inner_SMJ_shortzigpuseq_78778");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78784, "inner_SMJ_shortzigpuseq_78784");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78790, "inner_SMJ_shortzigpuseq_78790");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78849, "inner_SMJ_shortzigpuseq_78849");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78855, "inner_SMJ_shortzigpuseq_78855");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78861, "inner_SMJ_shortzigpuseq_78861");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78923, "inner_SMJ_shortzigpuseq_78923");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78929, "inner_SMJ_shortzigpuseq_78929");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78945, "inner_SMJ_shortzigpuseq_78945");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78951, "inner_SMJ_shortzigpuseq_78951");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_78957, "inner_SMJ_shortzigpuseq_78957");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_79070, "inner_SMJ_shortzigpuseq_79070");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_79395, "inner_SMJ_shortzigpuseq_79395");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_79401, "inner_SMJ_shortzigpuseq_79401");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_79407, "inner_SMJ_shortzigpuseq_79407");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_79454, "inner_SMJ_shortzigpuseq_79454");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzireplicate_79461, "inner_SMJ_shortzireplicate_79461");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzireplicate_79481, "inner_SMJ_shortzireplicate_79481");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_69883, "inner_SMJ_shortzisegmap_69883");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70257, "inner_SMJ_shortzisegmap_70257");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70609, "inner_SMJ_shortzisegmap_70609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70630, "inner_SMJ_shortzisegmap_70630");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70651, "inner_SMJ_shortzisegmap_70651");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70672, "inner_SMJ_shortzisegmap_70672");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70693, "inner_SMJ_shortzisegmap_70693");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70714, "inner_SMJ_shortzisegmap_70714");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70727, "inner_SMJ_shortzisegmap_70727");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70761, "inner_SMJ_shortzisegmap_70761");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70769, "inner_SMJ_shortzisegmap_70769");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70777, "inner_SMJ_shortzisegmap_70777");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_70799, "inner_SMJ_shortzisegmap_70799");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_76057, "inner_SMJ_shortzisegmap_intrablock_76057");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_76412, "inner_SMJ_shortzisegmap_intrablock_76412");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_76767, "inner_SMJ_shortzisegmap_intrablock_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_77122, "inner_SMJ_shortzisegmap_intrablock_77122");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegscan_70725, "inner_SMJ_shortzisegscan_70725");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegscan_70741, "inner_SMJ_shortzisegscan_70741");
    gpu_create_kernel(ctx, &ctx->program->max_idxzisegred_nonseg_68931, "max_idxzisegred_nonseg_68931");
    gpu_create_kernel(ctx, &ctx->program->min_idxzisegred_nonseg_68921, "min_idxzisegred_nonseg_68921");
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    gpu_free_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_78706);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_78735);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_78735);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_78735);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_79117);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_78709);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_79091);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_69171);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_69199);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_69451);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_69479);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_69115);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_69143);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_69395);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_69423);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_intzisegmap_69003);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_intzisegmap_69031);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_69283);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_69311);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_longzisegmap_69059);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_longzisegmap_69087);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_69339);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_69367);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_68947);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_68975);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_69227);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_69255);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78724);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78756);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78762);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78778);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78784);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78790);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78849);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78855);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78861);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78923);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78929);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78945);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78951);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78957);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79070);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79395);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79401);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79407);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79454);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_79461);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_79481);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75123);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75497);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75849);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75870);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75891);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75912);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75933);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75954);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75967);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76001);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76009);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76017);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76039);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76057);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76412);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_77122);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_75965);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_75981);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78724);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78756);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78762);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78778);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78784);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78790);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78849);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78855);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78861);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78923);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78929);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78945);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78951);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78957);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79070);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79395);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79401);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79407);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79454);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_79461);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_79481);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_73813);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74187);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74539);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74560);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74581);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74602);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74623);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74644);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74657);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74699);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74707);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74729);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76057);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76412);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_77122);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_74655);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_74671);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78724);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78756);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78762);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78778);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78784);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78790);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78849);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78855);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78861);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78923);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78929);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78945);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78951);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78957);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79070);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79375);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79381);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79387);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79434);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_79441);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_79461);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71193);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71567);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71919);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71940);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71961);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71982);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72003);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72024);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72037);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72071);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72079);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72087);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72109);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76057);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76412);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_77122);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_72035);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_72051);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78724);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78736);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78742);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78758);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78764);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78770);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78829);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78835);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78841);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78903);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78909);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78925);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78931);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78937);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79050);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79375);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79381);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79387);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79434);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_79441);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_79461);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_72503);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_72877);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73229);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73250);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73271);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73292);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73313);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73334);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73347);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73381);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73389);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73397);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73419);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76057);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76412);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_77122);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_73345);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_73361);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78724);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78756);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78762);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78778);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78784);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78790);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78849);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78855);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78861);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78923);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78929);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78945);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78951);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78957);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79070);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79395);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79401);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79407);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79454);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_79461);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_79481);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_69883);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70257);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70630);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70651);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70672);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70693);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70714);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70727);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70761);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70769);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70777);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70799);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76057);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76412);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_77122);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_70725);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_70741);
    gpu_free_kernel(ctx, ctx->program->max_idxzisegred_nonseg_68931);
    gpu_free_kernel(ctx, ctx->program->min_idxzisegred_nonseg_68921);
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
    ctx->tuning_params.builtinzhiota_i64zitblock_sizze_78710 = &ctx->cfg->tuning_params[0];
    ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_78739 = &ctx->cfg->tuning_params[1];
    ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_78739 = &ctx->cfg->tuning_params[2];
    ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_78739 = &ctx->cfg->tuning_params[3];
    ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_79121 = &ctx->cfg->tuning_params[4];
    ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_78713 = &ctx->cfg->tuning_params[5];
    ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_79095 = &ctx->cfg->tuning_params[6];
    ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69159 = &ctx->cfg->tuning_params[7];
    ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69177 = &ctx->cfg->tuning_params[8];
    ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69439 = &ctx->cfg->tuning_params[9];
    ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69457 = &ctx->cfg->tuning_params[10];
    ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69103 = &ctx->cfg->tuning_params[11];
    ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69121 = &ctx->cfg->tuning_params[12];
    ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69383 = &ctx->cfg->tuning_params[13];
    ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69401 = &ctx->cfg->tuning_params[14];
    ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_68991 = &ctx->cfg->tuning_params[15];
    ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_69009 = &ctx->cfg->tuning_params[16];
    ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69271 = &ctx->cfg->tuning_params[17];
    ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69289 = &ctx->cfg->tuning_params[18];
    ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69047 = &ctx->cfg->tuning_params[19];
    ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69065 = &ctx->cfg->tuning_params[20];
    ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69327 = &ctx->cfg->tuning_params[21];
    ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69345 = &ctx->cfg->tuning_params[22];
    ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68935 = &ctx->cfg->tuning_params[23];
    ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68953 = &ctx->cfg->tuning_params[24];
    ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69215 = &ctx->cfg->tuning_params[25];
    ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69233 = &ctx->cfg->tuning_params[26];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_75971 = &ctx->cfg->tuning_params[27];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_76013 = &ctx->cfg->tuning_params[28];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_76021 = &ctx->cfg->tuning_params[29];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_74911 = &ctx->cfg->tuning_params[30];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75328 = &ctx->cfg->tuning_params[31];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75835 = &ctx->cfg->tuning_params[32];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75857 = &ctx->cfg->tuning_params[33];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75877 = &ctx->cfg->tuning_params[34];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75899 = &ctx->cfg->tuning_params[35];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75919 = &ctx->cfg->tuning_params[36];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75941 = &ctx->cfg->tuning_params[37];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75969 = &ctx->cfg->tuning_params[38];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75985 = &ctx->cfg->tuning_params[39];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76011 = &ctx->cfg->tuning_params[40];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76019 = &ctx->cfg->tuning_params[41];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76027 = &ctx->cfg->tuning_params[42];
    ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_75961 = &ctx->cfg->tuning_params[43];
    ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_75977 = &ctx->cfg->tuning_params[44];
    ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75959 = &ctx->cfg->tuning_params[45];
    ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75975 = &ctx->cfg->tuning_params[46];
    ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_0 = &ctx->cfg->tuning_params[47];
    ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_1 = &ctx->cfg->tuning_params[48];
    ctx->tuning_params.inner_SMJ_doublezitblock_sizze_79465 = &ctx->cfg->tuning_params[49];
    ctx->tuning_params.inner_SMJ_doublezitblock_sizze_79485 = &ctx->cfg->tuning_params[50];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058 = &ctx->cfg->tuning_params[51];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413 = &ctx->cfg->tuning_params[52];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768 = &ctx->cfg->tuning_params[53];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123 = &ctx->cfg->tuning_params[54];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74661 = &ctx->cfg->tuning_params[55];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74703 = &ctx->cfg->tuning_params[56];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74711 = &ctx->cfg->tuning_params[57];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_73601 = &ctx->cfg->tuning_params[58];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74018 = &ctx->cfg->tuning_params[59];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74525 = &ctx->cfg->tuning_params[60];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74547 = &ctx->cfg->tuning_params[61];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74567 = &ctx->cfg->tuning_params[62];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74589 = &ctx->cfg->tuning_params[63];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74609 = &ctx->cfg->tuning_params[64];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74631 = &ctx->cfg->tuning_params[65];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74659 = &ctx->cfg->tuning_params[66];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74675 = &ctx->cfg->tuning_params[67];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74701 = &ctx->cfg->tuning_params[68];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74709 = &ctx->cfg->tuning_params[69];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74717 = &ctx->cfg->tuning_params[70];
    ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_74651 = &ctx->cfg->tuning_params[71];
    ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_74667 = &ctx->cfg->tuning_params[72];
    ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74649 = &ctx->cfg->tuning_params[73];
    ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74665 = &ctx->cfg->tuning_params[74];
    ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_0 = &ctx->cfg->tuning_params[75];
    ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_1 = &ctx->cfg->tuning_params[76];
    ctx->tuning_params.inner_SMJ_floatzitblock_sizze_79465 = &ctx->cfg->tuning_params[77];
    ctx->tuning_params.inner_SMJ_floatzitblock_sizze_79485 = &ctx->cfg->tuning_params[78];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058 = &ctx->cfg->tuning_params[79];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413 = &ctx->cfg->tuning_params[80];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768 = &ctx->cfg->tuning_params[81];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123 = &ctx->cfg->tuning_params[82];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72041 = &ctx->cfg->tuning_params[83];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72083 = &ctx->cfg->tuning_params[84];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72091 = &ctx->cfg->tuning_params[85];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_70981 = &ctx->cfg->tuning_params[86];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71398 = &ctx->cfg->tuning_params[87];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71905 = &ctx->cfg->tuning_params[88];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71927 = &ctx->cfg->tuning_params[89];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71947 = &ctx->cfg->tuning_params[90];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71969 = &ctx->cfg->tuning_params[91];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71989 = &ctx->cfg->tuning_params[92];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72011 = &ctx->cfg->tuning_params[93];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72039 = &ctx->cfg->tuning_params[94];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72055 = &ctx->cfg->tuning_params[95];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72081 = &ctx->cfg->tuning_params[96];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72089 = &ctx->cfg->tuning_params[97];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72097 = &ctx->cfg->tuning_params[98];
    ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_72031 = &ctx->cfg->tuning_params[99];
    ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_72047 = &ctx->cfg->tuning_params[100];
    ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72029 = &ctx->cfg->tuning_params[101];
    ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72045 = &ctx->cfg->tuning_params[102];
    ctx->tuning_params.inner_SMJ_intzisuff_outer_par_0 = &ctx->cfg->tuning_params[103];
    ctx->tuning_params.inner_SMJ_intzisuff_outer_par_1 = &ctx->cfg->tuning_params[104];
    ctx->tuning_params.inner_SMJ_intzitblock_sizze_79445 = &ctx->cfg->tuning_params[105];
    ctx->tuning_params.inner_SMJ_intzitblock_sizze_79465 = &ctx->cfg->tuning_params[106];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_76058 = &ctx->cfg->tuning_params[107];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_76413 = &ctx->cfg->tuning_params[108];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_76768 = &ctx->cfg->tuning_params[109];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_77123 = &ctx->cfg->tuning_params[110];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73351 = &ctx->cfg->tuning_params[111];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73393 = &ctx->cfg->tuning_params[112];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73401 = &ctx->cfg->tuning_params[113];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72291 = &ctx->cfg->tuning_params[114];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72708 = &ctx->cfg->tuning_params[115];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73215 = &ctx->cfg->tuning_params[116];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73237 = &ctx->cfg->tuning_params[117];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73257 = &ctx->cfg->tuning_params[118];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73279 = &ctx->cfg->tuning_params[119];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73299 = &ctx->cfg->tuning_params[120];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73321 = &ctx->cfg->tuning_params[121];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73349 = &ctx->cfg->tuning_params[122];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73365 = &ctx->cfg->tuning_params[123];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73391 = &ctx->cfg->tuning_params[124];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73399 = &ctx->cfg->tuning_params[125];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73407 = &ctx->cfg->tuning_params[126];
    ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_73341 = &ctx->cfg->tuning_params[127];
    ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_73357 = &ctx->cfg->tuning_params[128];
    ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73339 = &ctx->cfg->tuning_params[129];
    ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73355 = &ctx->cfg->tuning_params[130];
    ctx->tuning_params.inner_SMJ_longzisuff_outer_par_0 = &ctx->cfg->tuning_params[131];
    ctx->tuning_params.inner_SMJ_longzisuff_outer_par_1 = &ctx->cfg->tuning_params[132];
    ctx->tuning_params.inner_SMJ_longzitblock_sizze_79445 = &ctx->cfg->tuning_params[133];
    ctx->tuning_params.inner_SMJ_longzitblock_sizze_79465 = &ctx->cfg->tuning_params[134];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_76058 = &ctx->cfg->tuning_params[135];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_76413 = &ctx->cfg->tuning_params[136];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_76768 = &ctx->cfg->tuning_params[137];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_77123 = &ctx->cfg->tuning_params[138];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70731 = &ctx->cfg->tuning_params[139];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70773 = &ctx->cfg->tuning_params[140];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70781 = &ctx->cfg->tuning_params[141];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_69671 = &ctx->cfg->tuning_params[142];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70088 = &ctx->cfg->tuning_params[143];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70595 = &ctx->cfg->tuning_params[144];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70617 = &ctx->cfg->tuning_params[145];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70637 = &ctx->cfg->tuning_params[146];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70659 = &ctx->cfg->tuning_params[147];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70679 = &ctx->cfg->tuning_params[148];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70701 = &ctx->cfg->tuning_params[149];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70729 = &ctx->cfg->tuning_params[150];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70745 = &ctx->cfg->tuning_params[151];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70771 = &ctx->cfg->tuning_params[152];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70779 = &ctx->cfg->tuning_params[153];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70787 = &ctx->cfg->tuning_params[154];
    ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_70721 = &ctx->cfg->tuning_params[155];
    ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_70737 = &ctx->cfg->tuning_params[156];
    ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70719 = &ctx->cfg->tuning_params[157];
    ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70735 = &ctx->cfg->tuning_params[158];
    ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_0 = &ctx->cfg->tuning_params[159];
    ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_1 = &ctx->cfg->tuning_params[160];
    ctx->tuning_params.inner_SMJ_shortzitblock_sizze_79465 = &ctx->cfg->tuning_params[161];
    ctx->tuning_params.inner_SMJ_shortzitblock_sizze_79485 = &ctx->cfg->tuning_params[162];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058 = &ctx->cfg->tuning_params[163];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413 = &ctx->cfg->tuning_params[164];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768 = &ctx->cfg->tuning_params[165];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123 = &ctx->cfg->tuning_params[166];
    ctx->tuning_params.max_idxzisegred_num_tblocks_68925 = &ctx->cfg->tuning_params[167];
    ctx->tuning_params.max_idxzisegred_tblock_sizze_68923 = &ctx->cfg->tuning_params[168];
    ctx->tuning_params.min_idxzisegred_num_tblocks_68915 = &ctx->cfg->tuning_params[169];
    ctx->tuning_params.min_idxzisegred_tblock_sizze_68913 = &ctx->cfg->tuning_params[170];
}
int memblock_unref_device(struct futhark_context *ctx, struct memblock_device *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            (void) gpu_free(ctx, block->mem, block->size, desc);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc_device(struct futhark_context *ctx, struct memblock_device *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "space 'device'", ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "space 'device'", (long long) ctx->cur_mem_usage_device);
    (void) gpu_alloc(ctx, ctx->log, (size_t) size, desc, &block->mem, (size_t *) &size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_device + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_device = new_usage;
        if (new_usage > ctx->peak_mem_usage_device) {
            ctx->peak_mem_usage_device = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "space 'device'", (long long) size, (long long) ctx->cur_mem_usage_device, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set_device(struct futhark_context *ctx, struct memblock_device *lhs, struct memblock_device *rhs, const char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"space 'device'\": %lld", (long long) ctx->peak_mem_usage_device);
    str_builder_char(&builder, ',');
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        gpu_free_all(ctx);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_78701, int64_t n_78702, int64_t x_78703, int64_t s_78704);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, float val_78732);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, double val_78732);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, int16_t val_78732);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_79112, int64_t num_elems_79113, int32_t val_79114);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_78704, int64_t num_elems_78705, int64_t val_78706);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_79086, int64_t num_elems_79087, int8_t val_79088);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_79509, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_61033, int64_t dz2083U_61034, int64_t incr_61035, int64_t psizze_61036);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79510, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_62540, int64_t n_62541, int64_t incr_62542, int64_t psizze_62543);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_79511, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60693, int64_t dz2083U_60694, int64_t incr_60695, int64_t psizze_60696);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79512, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_62239, int64_t n_62240, int64_t incr_62241, int64_t psizze_62242);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_79513, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60044, int64_t dz2083U_60045, int64_t incr_60046, int64_t psizze_60047);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79514, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61637, int64_t n_61638, int64_t incr_61639, int64_t psizze_61640);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_79515, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60353, int64_t dz2083U_60354, int64_t incr_60355, int64_t psizze_60356);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79516, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61938, int64_t n_61939, int64_t incr_61940, int64_t psizze_61941);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_79517, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_59732, int64_t dz2083U_59733, int64_t incr_59734, int64_t psizze_59735);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79518, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61336, int64_t n_61337, int64_t incr_61338, int64_t psizze_61339);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_79519, struct memblock_device *mem_out_p_79520, struct memblock_device *mem_out_p_79521, int64_t *out_prim_out_79522, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_59382, int64_t nS_59383, int64_t offset_R_59386, int64_t offset_S_59387, int64_t partitionsPerWindow_59388, int64_t numberOfWindows_59389, int64_t extParallelism_59390, int64_t scatter_psizze_59391);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_79540, struct memblock_device *mem_out_p_79541, struct memblock_device *mem_out_p_79542, int64_t *out_prim_out_79543, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_54353, int64_t nS_54354, int64_t offset_R_54357, int64_t offset_S_54358, int64_t partitionsPerWindow_54359, int64_t numberOfWindows_54360, int64_t extParallelism_54361, int64_t scatter_psizze_54362);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_79561, struct memblock_device *mem_out_p_79562, struct memblock_device *mem_out_p_79563, int64_t *out_prim_out_79564, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_44377, int64_t nS_44378, int64_t offset_R_44381, int64_t offset_S_44382, int64_t partitionsPerWindow_44383, int64_t numberOfWindows_44384, int64_t extParallelism_44385, int64_t scatter_psizze_44386);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_79582, struct memblock_device *mem_out_p_79583, struct memblock_device *mem_out_p_79584, int64_t *out_prim_out_79585, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_49324, int64_t nS_49325, int64_t offset_R_49328, int64_t offset_S_49329, int64_t partitionsPerWindow_49330, int64_t numberOfWindows_49331, int64_t extParallelism_49332, int64_t scatter_psizze_49333);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_79603, struct memblock_device *mem_out_p_79604, struct memblock_device *mem_out_p_79605, int64_t *out_prim_out_79606, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_39348, int64_t nS_39349, int64_t offset_R_39352, int64_t offset_S_39353, int64_t partitionsPerWindow_39354, int64_t numberOfWindows_39355, int64_t extParallelism_39356, int64_t scatter_psizze_39357);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_79624, struct memblock_device eta_p_mem_77625, int64_t nz2080U_62616);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_79626, struct memblock_device eta_p_mem_77625, int64_t nz2080U_62579);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_10056(struct futhark_context *ctx, struct memblock_device *mem_out_p_79628, struct memblock_device xs_mem_77625, int64_t n_54395, int64_t incr_54396);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9601(struct futhark_context *ctx, struct memblock_device *mem_out_p_79629, struct memblock_device xs_mem_77625, int64_t n_34021, int64_t incr_34022);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9745(struct futhark_context *ctx, struct memblock_device *mem_out_p_79630, struct memblock_device xs_mem_77625, int64_t n_39390, int64_t incr_39391);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9850(struct futhark_context *ctx, struct memblock_device *mem_out_p_79631, struct memblock_device xs_mem_77625, int64_t n_44410, int64_t incr_44411);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9949(struct futhark_context *ctx, struct memblock_device *mem_out_p_79632, struct memblock_device xs_mem_77625, int64_t n_49366, int64_t incr_49367);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define counters_mem_78703 (ctx->constants->counters_mem_78703)
    #define global_dynid_mem_79090 (ctx->constants->global_dynid_mem_79090)
    #define global_dynid_mem_79110 (ctx->constants->global_dynid_mem_79110)
    #define global_dynid_mem_79231 (ctx->constants->global_dynid_mem_79231)
    #define global_dynid_mem_79251 (ctx->constants->global_dynid_mem_79251)
    counters_mem_78703.references = NULL;
    global_dynid_mem_79090.references = NULL;
    global_dynid_mem_79110.references = NULL;
    global_dynid_mem_79231.references = NULL;
    global_dynid_mem_79251.references = NULL;
    if (memblock_alloc_device(ctx, &counters_mem_78703, (int64_t) 80, "counters_mem_78703")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_78703, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_78703, (int64_t) 80, "counters_mem_78703")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_78703, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79110, (int64_t) 4, "global_dynid_mem_79110")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79110, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79251, (int64_t) 4, "global_dynid_mem_79251")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79251, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79110, (int64_t) 4, "global_dynid_mem_79110")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79110, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79231, (int64_t) 4, "global_dynid_mem_79231")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79231, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79090, (int64_t) 4, "global_dynid_mem_79090")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79090, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79231, (int64_t) 4, "global_dynid_mem_79231")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79231, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79110, (int64_t) 4, "global_dynid_mem_79110")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79110, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79251, (int64_t) 4, "global_dynid_mem_79251")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79251, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79110, (int64_t) 4, "global_dynid_mem_79110")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79110, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_79251, (int64_t) 4, "global_dynid_mem_79251")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_79251, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    #undef counters_mem_78703
    #undef global_dynid_mem_79090
    #undef global_dynid_mem_79110
    #undef global_dynid_mem_79231
    #undef global_dynid_mem_79251
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_78703, "ctx->constants->counters_mem_78703") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_79090, "ctx->constants->global_dynid_mem_79090") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_79110, "ctx->constants->global_dynid_mem_79110") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_79231, "ctx->constants->global_dynid_mem_79231") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_79251, "ctx->constants->global_dynid_mem_79251") != 0)
        return 1;
    return 0;
}
static int gpu_kernel_builtinzhiota_i64ziiota_i64_78706(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_78706, "builtin#iota_i64.iota_i64_78706", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f32zireplicate_78735(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, float arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_78735, "builtin#replicate_f32.replicate_78735", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f64zireplicate_78735(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_78735, "builtin#replicate_f64.replicate_78735", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i16zireplicate_78735(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int16_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_78735, "builtin#replicate_i16.replicate_78735", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i32zireplicate_79117(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int32_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_79117, "builtin#replicate_i32.replicate_79117", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i64zireplicate_78709(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_78709, "builtin#replicate_i64.replicate_78709", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i8zireplicate_79091(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_79091, "builtin#replicate_i8.replicate_79091", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_doublezisegmap_69171(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_69171, "gather_payloads_double.segmap_69171", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_doublezisegmap_69199(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_69199, "gather_payloads_double.segmap_69199", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_double_GFURzisegmap_69451(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_69451, "gather_payloads_double_GFUR.segmap_69451", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_double_GFURzisegmap_69479(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_69479, "gather_payloads_double_GFUR.segmap_69479", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_floatzisegmap_69115(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_69115, "gather_payloads_float.segmap_69115", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_floatzisegmap_69143(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_69143, "gather_payloads_float.segmap_69143", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_float_GFURzisegmap_69395(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_69395, "gather_payloads_float_GFUR.segmap_69395", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_float_GFURzisegmap_69423(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_69423, "gather_payloads_float_GFUR.segmap_69423", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_intzisegmap_69003(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_intzisegmap_69003, "gather_payloads_int.segmap_69003", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_intzisegmap_69031(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_intzisegmap_69031, "gather_payloads_int.segmap_69031", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_int_GFURzisegmap_69283(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_69283, "gather_payloads_int_GFUR.segmap_69283", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_int_GFURzisegmap_69311(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_69311, "gather_payloads_int_GFUR.segmap_69311", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_longzisegmap_69059(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_longzisegmap_69059, "gather_payloads_long.segmap_69059", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_longzisegmap_69087(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_longzisegmap_69087, "gather_payloads_long.segmap_69087", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_long_GFURzisegmap_69339(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_69339, "gather_payloads_long_GFUR.segmap_69339", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_long_GFURzisegmap_69367(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_69367, "gather_payloads_long_GFUR.segmap_69367", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_shortzisegmap_68947(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_68947, "gather_payloads_short.segmap_68947", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_shortzisegmap_68975(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_68975, "gather_payloads_short.segmap_68975", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_short_GFURzisegmap_69227(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_69227, "gather_payloads_short_GFUR.segmap_69227", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_short_GFURzisegmap_69255(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_69255, "gather_payloads_short_GFUR.segmap_69255", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78724(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78724, "inner_SMJ_double.gpuseq_78724", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78756(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78756, "inner_SMJ_double.gpuseq_78756", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78762(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78762, "inner_SMJ_double.gpuseq_78762", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78778(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78778, "inner_SMJ_double.gpuseq_78778", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78784(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78784, "inner_SMJ_double.gpuseq_78784", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78790, "inner_SMJ_double.gpuseq_78790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76057(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76057, "inner_SMJ_double.segmap_intrablock_76057", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76412(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76412, "inner_SMJ_double.segmap_intrablock_76412", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78849(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78849, "inner_SMJ_double.gpuseq_78849", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78855(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78855, "inner_SMJ_double.gpuseq_78855", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78861(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78861, "inner_SMJ_double.gpuseq_78861", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75123(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75123, "inner_SMJ_double.segmap_75123", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75497(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75497, "inner_SMJ_double.segmap_75497", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78923(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78923, "inner_SMJ_double.gpuseq_78923", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78929, "inner_SMJ_double.gpuseq_78929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78945(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78945, "inner_SMJ_double.gpuseq_78945", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78951(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78951, "inner_SMJ_double.gpuseq_78951", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_78957(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_78957, "inner_SMJ_double.gpuseq_78957", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_76767, "inner_SMJ_double.segmap_intrablock_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_77122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_77122, "inner_SMJ_double.segmap_intrablock_77122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75849(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75849, "inner_SMJ_double.segmap_75849", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75870(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75870, "inner_SMJ_double.segmap_75870", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75891(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75891, "inner_SMJ_double.segmap_75891", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75912(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75912, "inner_SMJ_double.segmap_75912", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75933(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75933, "inner_SMJ_double.segmap_75933", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75954(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75954, "inner_SMJ_double.segmap_75954", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_79070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79070, "inner_SMJ_double.gpuseq_79070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegscan_75965(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_75965, "inner_SMJ_double.segscan_75965", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_75967(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_75967, "inner_SMJ_double.segmap_75967", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegscan_75981(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_75981, "inner_SMJ_double.segscan_75981", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_76001(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76001, "inner_SMJ_double.segmap_76001", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_79395(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79395, "inner_SMJ_double.gpuseq_79395", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_79401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79401, "inner_SMJ_double.gpuseq_79401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_79407(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79407, "inner_SMJ_double.gpuseq_79407", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_76017(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76017, "inner_SMJ_double.segmap_76017", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_76009(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76009, "inner_SMJ_double.segmap_76009", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_79454(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_79454, "inner_SMJ_double.gpuseq_79454", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezireplicate_79461(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_79461, "inner_SMJ_double.replicate_79461", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezireplicate_79481(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_79481, "inner_SMJ_double.replicate_79481", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_76039(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_76039, "inner_SMJ_double.segmap_76039", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78724(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78724, "inner_SMJ_float.gpuseq_78724", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78756(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78756, "inner_SMJ_float.gpuseq_78756", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78762(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78762, "inner_SMJ_float.gpuseq_78762", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78778(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78778, "inner_SMJ_float.gpuseq_78778", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78784(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78784, "inner_SMJ_float.gpuseq_78784", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78790, "inner_SMJ_float.gpuseq_78790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76057(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76057, "inner_SMJ_float.segmap_intrablock_76057", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76412(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76412, "inner_SMJ_float.segmap_intrablock_76412", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78849(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78849, "inner_SMJ_float.gpuseq_78849", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78855(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78855, "inner_SMJ_float.gpuseq_78855", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78861(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78861, "inner_SMJ_float.gpuseq_78861", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_73813(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_73813, "inner_SMJ_float.segmap_73813", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74187(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74187, "inner_SMJ_float.segmap_74187", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78923(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78923, "inner_SMJ_float.gpuseq_78923", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78929, "inner_SMJ_float.gpuseq_78929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78945(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78945, "inner_SMJ_float.gpuseq_78945", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78951(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78951, "inner_SMJ_float.gpuseq_78951", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_78957(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_78957, "inner_SMJ_float.gpuseq_78957", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_76767, "inner_SMJ_float.segmap_intrablock_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_77122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_77122, "inner_SMJ_float.segmap_intrablock_77122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74539(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74539, "inner_SMJ_float.segmap_74539", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74560(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74560, "inner_SMJ_float.segmap_74560", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74581(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74581, "inner_SMJ_float.segmap_74581", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74602(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74602, "inner_SMJ_float.segmap_74602", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74623(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74623, "inner_SMJ_float.segmap_74623", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74644(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74644, "inner_SMJ_float.segmap_74644", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_79070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79070, "inner_SMJ_float.gpuseq_79070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegscan_74655(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_74655, "inner_SMJ_float.segscan_74655", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74657(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74657, "inner_SMJ_float.segmap_74657", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegscan_74671(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_74671, "inner_SMJ_float.segscan_74671", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74691, "inner_SMJ_float.segmap_74691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_79395(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79395, "inner_SMJ_float.gpuseq_79395", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_79401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79401, "inner_SMJ_float.gpuseq_79401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_79407(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79407, "inner_SMJ_float.gpuseq_79407", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74707(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74707, "inner_SMJ_float.segmap_74707", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74699(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74699, "inner_SMJ_float.segmap_74699", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_79454(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_79454, "inner_SMJ_float.gpuseq_79454", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzireplicate_79461(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_79461, "inner_SMJ_float.replicate_79461", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzireplicate_79481(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_79481, "inner_SMJ_float.replicate_79481", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_74729(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_74729, "inner_SMJ_float.segmap_74729", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78724(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78724, "inner_SMJ_int.gpuseq_78724", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78756(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78756, "inner_SMJ_int.gpuseq_78756", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78762(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78762, "inner_SMJ_int.gpuseq_78762", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78778(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78778, "inner_SMJ_int.gpuseq_78778", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78784(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78784, "inner_SMJ_int.gpuseq_78784", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78790, "inner_SMJ_int.gpuseq_78790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_76057(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76057, "inner_SMJ_int.segmap_intrablock_76057", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_76412(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76412, "inner_SMJ_int.segmap_intrablock_76412", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78849(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78849, "inner_SMJ_int.gpuseq_78849", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78855(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78855, "inner_SMJ_int.gpuseq_78855", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78861(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78861, "inner_SMJ_int.gpuseq_78861", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71193(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71193, "inner_SMJ_int.segmap_71193", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71567(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71567, "inner_SMJ_int.segmap_71567", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78923(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78923, "inner_SMJ_int.gpuseq_78923", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78929, "inner_SMJ_int.gpuseq_78929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78945(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78945, "inner_SMJ_int.gpuseq_78945", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78951(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78951, "inner_SMJ_int.gpuseq_78951", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_78957(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_78957, "inner_SMJ_int.gpuseq_78957", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_76767, "inner_SMJ_int.segmap_intrablock_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_77122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_77122, "inner_SMJ_int.segmap_intrablock_77122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71919(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71919, "inner_SMJ_int.segmap_71919", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71940(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71940, "inner_SMJ_int.segmap_71940", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71961(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71961, "inner_SMJ_int.segmap_71961", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_71982(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_71982, "inner_SMJ_int.segmap_71982", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72003(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72003, "inner_SMJ_int.segmap_72003", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72024(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72024, "inner_SMJ_int.segmap_72024", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_79070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79070, "inner_SMJ_int.gpuseq_79070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegscan_72035(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_72035, "inner_SMJ_int.segscan_72035", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72037(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72037, "inner_SMJ_int.segmap_72037", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegscan_72051(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_72051, "inner_SMJ_int.segscan_72051", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72071(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72071, "inner_SMJ_int.segmap_72071", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_79375(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79375, "inner_SMJ_int.gpuseq_79375", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_79381(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79381, "inner_SMJ_int.gpuseq_79381", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_79387(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79387, "inner_SMJ_int.gpuseq_79387", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72087(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72087, "inner_SMJ_int.segmap_72087", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72079(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72079, "inner_SMJ_int.segmap_72079", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_79434(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_79434, "inner_SMJ_int.gpuseq_79434", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzireplicate_79441(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_79441, "inner_SMJ_int.replicate_79441", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzireplicate_79461(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_79461, "inner_SMJ_int.replicate_79461", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_72109(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_72109, "inner_SMJ_int.segmap_72109", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78724(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78724, "inner_SMJ_long.gpuseq_78724", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78736(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78736, "inner_SMJ_long.gpuseq_78736", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78742(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78742, "inner_SMJ_long.gpuseq_78742", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78758(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78758, "inner_SMJ_long.gpuseq_78758", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78764(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78764, "inner_SMJ_long.gpuseq_78764", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78770(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78770, "inner_SMJ_long.gpuseq_78770", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_76057(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76057, "inner_SMJ_long.segmap_intrablock_76057", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_76412(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76412, "inner_SMJ_long.segmap_intrablock_76412", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78829(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78829, "inner_SMJ_long.gpuseq_78829", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78835(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78835, "inner_SMJ_long.gpuseq_78835", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78841(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78841, "inner_SMJ_long.gpuseq_78841", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_72503(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_72503, "inner_SMJ_long.segmap_72503", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_72877(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_72877, "inner_SMJ_long.segmap_72877", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78903(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78903, "inner_SMJ_long.gpuseq_78903", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78909(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78909, "inner_SMJ_long.gpuseq_78909", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78925(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78925, "inner_SMJ_long.gpuseq_78925", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78931(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78931, "inner_SMJ_long.gpuseq_78931", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_78937(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_78937, "inner_SMJ_long.gpuseq_78937", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_76767, "inner_SMJ_long.segmap_intrablock_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_77122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_77122, "inner_SMJ_long.segmap_intrablock_77122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73229(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73229, "inner_SMJ_long.segmap_73229", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73250(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73250, "inner_SMJ_long.segmap_73250", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73271(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73271, "inner_SMJ_long.segmap_73271", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73292(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73292, "inner_SMJ_long.segmap_73292", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73313(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73313, "inner_SMJ_long.segmap_73313", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73334(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73334, "inner_SMJ_long.segmap_73334", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_79050(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79050, "inner_SMJ_long.gpuseq_79050", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegscan_73345(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_73345, "inner_SMJ_long.segscan_73345", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73347(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73347, "inner_SMJ_long.segmap_73347", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegscan_73361(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_73361, "inner_SMJ_long.segscan_73361", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73381(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73381, "inner_SMJ_long.segmap_73381", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_79375(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79375, "inner_SMJ_long.gpuseq_79375", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_79381(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79381, "inner_SMJ_long.gpuseq_79381", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_79387(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79387, "inner_SMJ_long.gpuseq_79387", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73397(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73397, "inner_SMJ_long.segmap_73397", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73389(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73389, "inner_SMJ_long.segmap_73389", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_79434(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_79434, "inner_SMJ_long.gpuseq_79434", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzireplicate_79441(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_79441, "inner_SMJ_long.replicate_79441", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzireplicate_79461(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_79461, "inner_SMJ_long.replicate_79461", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_73419(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_73419, "inner_SMJ_long.segmap_73419", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78724(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78724, "inner_SMJ_short.gpuseq_78724", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78756(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78756, "inner_SMJ_short.gpuseq_78756", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78762(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78762, "inner_SMJ_short.gpuseq_78762", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78778(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78778, "inner_SMJ_short.gpuseq_78778", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78784(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78784, "inner_SMJ_short.gpuseq_78784", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78790, "inner_SMJ_short.gpuseq_78790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76057(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76057, "inner_SMJ_short.segmap_intrablock_76057", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76412(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76412, "inner_SMJ_short.segmap_intrablock_76412", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78849(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78849, "inner_SMJ_short.gpuseq_78849", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78855(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78855, "inner_SMJ_short.gpuseq_78855", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78861(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78861, "inner_SMJ_short.gpuseq_78861", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_69883(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_69883, "inner_SMJ_short.segmap_69883", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70257(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70257, "inner_SMJ_short.segmap_70257", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78923(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78923, "inner_SMJ_short.gpuseq_78923", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78929, "inner_SMJ_short.gpuseq_78929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78945(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78945, "inner_SMJ_short.gpuseq_78945", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78951(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78951, "inner_SMJ_short.gpuseq_78951", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_78957(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_78957, "inner_SMJ_short.gpuseq_78957", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_76767, "inner_SMJ_short.segmap_intrablock_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_77122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_77122, "inner_SMJ_short.segmap_intrablock_77122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70609, "inner_SMJ_short.segmap_70609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70630(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70630, "inner_SMJ_short.segmap_70630", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70651(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70651, "inner_SMJ_short.segmap_70651", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70672(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70672, "inner_SMJ_short.segmap_70672", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70693(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70693, "inner_SMJ_short.segmap_70693", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70714(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70714, "inner_SMJ_short.segmap_70714", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_79070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79070, "inner_SMJ_short.gpuseq_79070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegscan_70725(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_70725, "inner_SMJ_short.segscan_70725", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70727(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70727, "inner_SMJ_short.segmap_70727", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegscan_70741(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_70741, "inner_SMJ_short.segscan_70741", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70761(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70761, "inner_SMJ_short.segmap_70761", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_79395(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79395, "inner_SMJ_short.gpuseq_79395", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_79401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79401, "inner_SMJ_short.gpuseq_79401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_79407(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79407, "inner_SMJ_short.gpuseq_79407", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70777(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70777, "inner_SMJ_short.segmap_70777", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70769(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70769, "inner_SMJ_short.segmap_70769", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_79454(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_79454, "inner_SMJ_short.gpuseq_79454", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzireplicate_79461(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_79461, "inner_SMJ_short.replicate_79461", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzireplicate_79481(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_79481, "inner_SMJ_short.replicate_79481", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_70799(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_70799, "inner_SMJ_short.segmap_70799", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_max_idxzisegred_nonseg_68931(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->max_idxzisegred_nonseg_68931, "max_idx.segred_nonseg_68931", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_min_idxzisegred_nonseg_68921(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->min_idxzisegred_nonseg_68921, "min_idx.segred_nonseg_68921", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
struct futhark_i16_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 2 * (i0 * 1), 2);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_78701, int64_t n_78702, int64_t x_78703, int64_t s_78704)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t tblock_sizze_78710;
    
    tblock_sizze_78710 = *ctx->tuning_params.builtinzhiota_i64zitblock_sizze_78710;
    
    int64_t virt_num_tblocks_78711 = sdiv_up64(n_78702, tblock_sizze_78710);
    int64_t num_tblocks_78712 = smin64(virt_num_tblocks_78711, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhiota_i64ziiota_i64_78706(ctx, num_tblocks_78712, 1, 1, tblock_sizze_78710, 1, 1, (int64_t) 0, n_78702, x_78703, s_78704, virt_num_tblocks_78711, num_tblocks_78712, mem_78701.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, float val_78732)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_78734 = num_elems_78731;
    int64_t tblock_sizze_78739;
    
    tblock_sizze_78739 = *ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_78739;
    
    int64_t virt_num_tblocks_78740 = sdiv_up64(replicate_n_78734, tblock_sizze_78739);
    int64_t num_tblocks_78741 = smin64(virt_num_tblocks_78740, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f32zireplicate_78735(ctx, num_tblocks_78741, 1, 1, tblock_sizze_78739, 1, 1, (int64_t) 0, num_elems_78731, val_78732, replicate_n_78734, virt_num_tblocks_78740, num_tblocks_78741, mem_78730.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, double val_78732)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_78734 = num_elems_78731;
    int64_t tblock_sizze_78739;
    
    tblock_sizze_78739 = *ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_78739;
    
    int64_t virt_num_tblocks_78740 = sdiv_up64(replicate_n_78734, tblock_sizze_78739);
    int64_t num_tblocks_78741 = smin64(virt_num_tblocks_78740, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f64zireplicate_78735(ctx, num_tblocks_78741, 1, 1, tblock_sizze_78739, 1, 1, (int64_t) 0, num_elems_78731, val_78732, replicate_n_78734, virt_num_tblocks_78740, num_tblocks_78741, mem_78730.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_78730, int64_t num_elems_78731, int16_t val_78732)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_78734 = num_elems_78731;
    int64_t tblock_sizze_78739;
    
    tblock_sizze_78739 = *ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_78739;
    
    int64_t virt_num_tblocks_78740 = sdiv_up64(replicate_n_78734, tblock_sizze_78739);
    int64_t num_tblocks_78741 = smin64(virt_num_tblocks_78740, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i16zireplicate_78735(ctx, num_tblocks_78741, 1, 1, tblock_sizze_78739, 1, 1, (int64_t) 0, num_elems_78731, val_78732, replicate_n_78734, virt_num_tblocks_78740, num_tblocks_78741, mem_78730.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_79112, int64_t num_elems_79113, int32_t val_79114)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_79116 = num_elems_79113;
    int64_t tblock_sizze_79121;
    
    tblock_sizze_79121 = *ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_79121;
    
    int64_t virt_num_tblocks_79122 = sdiv_up64(replicate_n_79116, tblock_sizze_79121);
    int64_t num_tblocks_79123 = smin64(virt_num_tblocks_79122, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i32zireplicate_79117(ctx, num_tblocks_79123, 1, 1, tblock_sizze_79121, 1, 1, (int64_t) 0, num_elems_79113, val_79114, replicate_n_79116, virt_num_tblocks_79122, num_tblocks_79123, mem_79112.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_78704, int64_t num_elems_78705, int64_t val_78706)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_78708 = num_elems_78705;
    int64_t tblock_sizze_78713;
    
    tblock_sizze_78713 = *ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_78713;
    
    int64_t virt_num_tblocks_78714 = sdiv_up64(replicate_n_78708, tblock_sizze_78713);
    int64_t num_tblocks_78715 = smin64(virt_num_tblocks_78714, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i64zireplicate_78709(ctx, num_tblocks_78715, 1, 1, tblock_sizze_78713, 1, 1, (int64_t) 0, num_elems_78705, val_78706, replicate_n_78708, virt_num_tblocks_78714, num_tblocks_78715, mem_78704.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_79086, int64_t num_elems_79087, int8_t val_79088)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t replicate_n_79090 = num_elems_79087;
    int64_t tblock_sizze_79095;
    
    tblock_sizze_79095 = *ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_79095;
    
    int64_t virt_num_tblocks_79096 = sdiv_up64(replicate_n_79090, tblock_sizze_79095);
    int64_t num_tblocks_79097 = smin64(virt_num_tblocks_79096, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i8zireplicate_79091(ctx, num_tblocks_79097, 1, 1, tblock_sizze_79095, 1, 1, (int64_t) 0, num_elems_79087, val_79088, replicate_n_79090, virt_num_tblocks_79096, num_tblocks_79097, mem_79086.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_79509, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_61033, int64_t dz2083U_61034, int64_t incr_61035, int64_t psizze_61036)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77639;
    
    mem_77639.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device mem_param_77634;
    
    mem_param_77634.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device ext_mem_77648;
    
    ext_mem_77648.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77628 = (int64_t) 8 * niz2084U_61033;
    bool zzero_63760 = psizze_61036 == (int64_t) 0;
    bool nonzzero_63761 = !zzero_63760;
    bool nonzzero_cert_63762;
    
    if (!nonzzero_63761) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:431:5-41\n   #2  ftSMJ.fut:430:1-431:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_69167;
    
    segmap_tblock_sizze_69167 = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69159;
    
    int64_t segmap_usable_groups_69168 = sdiv_up64(niz2084U_61033, segmap_tblock_sizze_69167);
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(niz2084U_61033, segmap_tblock_sizze_69167));
    
    {
        err = gpu_kernel_gather_payloads_doublezisegmap_69171(ctx, segmap_usable_groups_69168, 1, 1, *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69159, 1, 1, (int64_t) 0, niz2084U_61033, incr_61035, is_mem_77625.mem, mem_77629.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63758 = add64(dz2083U_61034, psizze_61036);
    int64_t zs_lhs_63759 = sub64(zm_lhs_63758, (int64_t) 1);
    int64_t m_63763 = sdiv64(zs_lhs_63759, psizze_61036);
    
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_77631, niz2084U_61033, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_63765 = slt64((int64_t) 0, m_63763);
    int64_t segmap_tblock_sizze_69195;
    
    segmap_tblock_sizze_69195 = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69177;
    
    int64_t segmap_usable_groups_69196 = sdiv_up_safe64(niz2084U_61033, segmap_tblock_sizze_69195);
    bool partitioned_gather_res_63766;
    int64_t partitioned_gather_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77634, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_61036, p_63773);
        int64_t min_arg1_63775 = add64(psizze_61036, lower_bound_63774);
        int64_t min_res_63776 = smin64(dz2083U_61034, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, dz2083U_61034);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) dz2083U_61034, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:431:5-41\n   #2  ftSMJ.fut:430:1-431:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77639, bytes_77628, "mem_77639")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77634.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_61033})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77642, bytes_77628, "mem_77642")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78736 = sext_i64_i32(sdiv_up64(niz2084U_61033, segmap_tblock_sizze_69195));
        
        {
            err = gpu_kernel_gather_payloads_doublezisegmap_69199(ctx, segmap_usable_groups_69196, 1, 1, *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_69177, 1, 1, (int64_t) 0, niz2084U_61033, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77626.mem, mem_param_77634.mem, mem_param_77637.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63763);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &mem_77642, "mem_77642") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_63805;
        int64_t p_tmp_78735 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77634, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78732;
        p_63773 = p_tmp_78735;
    }
    if (memblock_set_device(ctx, &ext_mem_77648, &mem_param_77634, "mem_param_77634") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    partitioned_gather_res_63766 = loop_while_63770;
    partitioned_gather_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77650, bytes_77628, "mem_77650")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_61033})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77650, "mem_77650") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79509, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77634, "mem_param_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77648, "ext_mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79510, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_62540, int64_t n_62541, int64_t incr_62542, int64_t psizze_62543)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77649;
    
    mem_77649.references = NULL;
    
    struct memblock_device mem_param_tmp_78711;
    
    mem_param_tmp_78711.references = NULL;
    
    struct memblock_device mem_param_tmp_78710;
    
    mem_param_tmp_78710.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77638;
    
    mem_77638.references = NULL;
    
    struct memblock_device mem_param_77636;
    
    mem_param_77636.references = NULL;
    
    struct memblock_device mem_param_77633;
    
    mem_param_77633.references = NULL;
    
    struct memblock_device ext_mem_77646;
    
    ext_mem_77646.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device mem_77630;
    
    mem_77630.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77629 = (int64_t) 8 * ni_62540;
    bool zzero_63761 = psizze_62543 == (int64_t) 0;
    bool nonzzero_63762 = !zzero_63761;
    bool nonzzero_cert_63763;
    
    if (!nonzzero_63762) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:459:5-50\n   #2  ftSMJ.fut:458:1-459:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_69447;
    
    segmap_tblock_sizze_69447 = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69439;
    
    int64_t segmap_usable_groups_69448 = sdiv_up64(ni_62540, segmap_tblock_sizze_69447);
    
    if (memblock_alloc_device(ctx, &mem_77630, bytes_77629, "mem_77630")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(ni_62540, segmap_tblock_sizze_69447));
    
    {
        err = gpu_kernel_gather_payloads_double_GFURzisegmap_69451(ctx, segmap_usable_groups_69448, 1, 1, *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69439, 1, 1, (int64_t) 0, ni_62540, incr_62542, is_mem_77626.mem, mem_77630.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63759 = add64(n_62541, psizze_62543);
    int64_t zs_lhs_63760 = sub64(zm_lhs_63759, (int64_t) 1);
    int64_t m_63764 = sdiv64(zs_lhs_63760, psizze_62543);
    bool loop_cond_63765 = slt64((int64_t) 0, m_63764);
    int64_t segmap_tblock_sizze_69475;
    
    segmap_tblock_sizze_69475 = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69457;
    
    int64_t segmap_usable_groups_69476 = sdiv_up_safe64(ni_62540, segmap_tblock_sizze_69475);
    bool partitioned_gather_over_array_res_63766;
    int64_t partitioned_gather_over_array_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77633, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77636, &preVals_mem_77625, "preVals_mem_77625") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_62543, p_63773);
        int64_t min_arg1_63775 = add64(psizze_62543, lower_bound_63774);
        int64_t min_res_63776 = smin64(n_62541, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, n_62541);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) n_62541, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:459:5-50\n   #2  ftSMJ.fut:458:1-459:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77638, bytes_77629, "mem_77638")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_62540})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77641, bytes_77629, "mem_77641")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78716 = sext_i64_i32(sdiv_up64(ni_62540, segmap_tblock_sizze_69475));
        
        {
            err = gpu_kernel_gather_payloads_double_GFURzisegmap_69479(ctx, segmap_usable_groups_69476, 1, 1, *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_69457, 1, 1, (int64_t) 0, ni_62540, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77627.mem, mem_param_77633.mem, mem_param_77636.mem, mem_77641.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63764);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78710, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78711, &mem_77641, "mem_77641") != 0)
            return 1;
        
        bool loop_while_tmp_78712 = loop_cond_63805;
        int64_t p_tmp_78715 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77633, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77636, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78712;
        p_63773 = p_tmp_78715;
    }
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77633, "mem_param_77633") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77646, &mem_param_77636, "mem_param_77636") != 0)
        return 1;
    partitioned_gather_over_array_res_63766 = loop_while_63770;
    partitioned_gather_over_array_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77649, bytes_77629, "mem_77649")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77646.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_62540})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77649, "mem_77649") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79510, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77649, "mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77636, "mem_param_77636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77633, "mem_param_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_79511, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60693, int64_t dz2083U_60694, int64_t incr_60695, int64_t psizze_60696)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77639;
    
    mem_77639.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device mem_param_77634;
    
    mem_param_77634.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device ext_mem_77648;
    
    ext_mem_77648.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77628 = (int64_t) 8 * niz2084U_60693;
    bool zzero_63760 = psizze_60696 == (int64_t) 0;
    bool nonzzero_63761 = !zzero_63760;
    bool nonzzero_cert_63762;
    
    if (!nonzzero_63761) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:428:5-41\n   #2  ftSMJ.fut:427:1-428:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77630 = (int64_t) 4 * niz2084U_60693;
    int64_t segmap_tblock_sizze_69111;
    
    segmap_tblock_sizze_69111 = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69103;
    
    int64_t segmap_usable_groups_69112 = sdiv_up64(niz2084U_60693, segmap_tblock_sizze_69111);
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(niz2084U_60693, segmap_tblock_sizze_69111));
    
    {
        err = gpu_kernel_gather_payloads_floatzisegmap_69115(ctx, segmap_usable_groups_69112, 1, 1, *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69103, 1, 1, (int64_t) 0, niz2084U_60693, incr_60695, is_mem_77625.mem, mem_77629.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63758 = add64(dz2083U_60694, psizze_60696);
    int64_t zs_lhs_63759 = sub64(zm_lhs_63758, (int64_t) 1);
    int64_t m_63763 = sdiv64(zs_lhs_63759, psizze_60696);
    
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77630, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_77631, niz2084U_60693, 0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_63765 = slt64((int64_t) 0, m_63763);
    int64_t segmap_tblock_sizze_69139;
    
    segmap_tblock_sizze_69139 = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69121;
    
    int64_t segmap_usable_groups_69140 = sdiv_up_safe64(niz2084U_60693, segmap_tblock_sizze_69139);
    bool partitioned_gather_res_63766;
    int64_t partitioned_gather_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77634, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_60696, p_63773);
        int64_t min_arg1_63775 = add64(psizze_60696, lower_bound_63774);
        int64_t min_res_63776 = smin64(dz2083U_60694, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, dz2083U_60694);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) dz2083U_60694, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:428:5-41\n   #2  ftSMJ.fut:427:1-428:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77639, bytes_77628, "mem_77639")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77634.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60693})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77642, bytes_77630, "mem_77642")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78736 = sext_i64_i32(sdiv_up64(niz2084U_60693, segmap_tblock_sizze_69139));
        
        {
            err = gpu_kernel_gather_payloads_floatzisegmap_69143(ctx, segmap_usable_groups_69140, 1, 1, *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_69121, 1, 1, (int64_t) 0, niz2084U_60693, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77626.mem, mem_param_77634.mem, mem_param_77637.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63763);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &mem_77642, "mem_77642") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_63805;
        int64_t p_tmp_78735 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77634, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78732;
        p_63773 = p_tmp_78735;
    }
    if (memblock_set_device(ctx, &ext_mem_77648, &mem_param_77634, "mem_param_77634") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    partitioned_gather_res_63766 = loop_while_63770;
    partitioned_gather_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77650, bytes_77630, "mem_77650")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60693})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77650, "mem_77650") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79511, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77634, "mem_param_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77648, "ext_mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79512, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_62239, int64_t n_62240, int64_t incr_62241, int64_t psizze_62242)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77649;
    
    mem_77649.references = NULL;
    
    struct memblock_device mem_param_tmp_78711;
    
    mem_param_tmp_78711.references = NULL;
    
    struct memblock_device mem_param_tmp_78710;
    
    mem_param_tmp_78710.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77638;
    
    mem_77638.references = NULL;
    
    struct memblock_device mem_param_77636;
    
    mem_param_77636.references = NULL;
    
    struct memblock_device mem_param_77633;
    
    mem_param_77633.references = NULL;
    
    struct memblock_device ext_mem_77646;
    
    ext_mem_77646.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device mem_77630;
    
    mem_77630.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77629 = (int64_t) 8 * ni_62239;
    bool zzero_63761 = psizze_62242 == (int64_t) 0;
    bool nonzzero_63762 = !zzero_63761;
    bool nonzzero_cert_63763;
    
    if (!nonzzero_63762) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:456:5-50\n   #2  ftSMJ.fut:455:1-456:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77640 = (int64_t) 4 * ni_62239;
    int64_t segmap_tblock_sizze_69391;
    
    segmap_tblock_sizze_69391 = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69383;
    
    int64_t segmap_usable_groups_69392 = sdiv_up64(ni_62239, segmap_tblock_sizze_69391);
    
    if (memblock_alloc_device(ctx, &mem_77630, bytes_77629, "mem_77630")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(ni_62239, segmap_tblock_sizze_69391));
    
    {
        err = gpu_kernel_gather_payloads_float_GFURzisegmap_69395(ctx, segmap_usable_groups_69392, 1, 1, *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69383, 1, 1, (int64_t) 0, ni_62239, incr_62241, is_mem_77626.mem, mem_77630.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63759 = add64(n_62240, psizze_62242);
    int64_t zs_lhs_63760 = sub64(zm_lhs_63759, (int64_t) 1);
    int64_t m_63764 = sdiv64(zs_lhs_63760, psizze_62242);
    bool loop_cond_63765 = slt64((int64_t) 0, m_63764);
    int64_t segmap_tblock_sizze_69419;
    
    segmap_tblock_sizze_69419 = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69401;
    
    int64_t segmap_usable_groups_69420 = sdiv_up_safe64(ni_62239, segmap_tblock_sizze_69419);
    bool partitioned_gather_over_array_res_63766;
    int64_t partitioned_gather_over_array_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77633, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77636, &preVals_mem_77625, "preVals_mem_77625") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_62242, p_63773);
        int64_t min_arg1_63775 = add64(psizze_62242, lower_bound_63774);
        int64_t min_res_63776 = smin64(n_62240, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, n_62240);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) n_62240, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:456:5-50\n   #2  ftSMJ.fut:455:1-456:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77638, bytes_77629, "mem_77638")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_62239})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77641, bytes_77640, "mem_77641")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78716 = sext_i64_i32(sdiv_up64(ni_62239, segmap_tblock_sizze_69419));
        
        {
            err = gpu_kernel_gather_payloads_float_GFURzisegmap_69423(ctx, segmap_usable_groups_69420, 1, 1, *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_69401, 1, 1, (int64_t) 0, ni_62239, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77627.mem, mem_param_77633.mem, mem_param_77636.mem, mem_77641.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63764);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78710, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78711, &mem_77641, "mem_77641") != 0)
            return 1;
        
        bool loop_while_tmp_78712 = loop_cond_63805;
        int64_t p_tmp_78715 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77633, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77636, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78712;
        p_63773 = p_tmp_78715;
    }
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77633, "mem_param_77633") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77646, &mem_param_77636, "mem_param_77636") != 0)
        return 1;
    partitioned_gather_over_array_res_63766 = loop_while_63770;
    partitioned_gather_over_array_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77649, bytes_77640, "mem_77649")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77646.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_62239})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77649, "mem_77649") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79512, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77649, "mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77636, "mem_param_77636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77633, "mem_param_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_79513, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60044, int64_t dz2083U_60045, int64_t incr_60046, int64_t psizze_60047)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77639;
    
    mem_77639.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device mem_param_77634;
    
    mem_param_77634.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device ext_mem_77648;
    
    ext_mem_77648.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77628 = (int64_t) 8 * niz2084U_60044;
    bool zzero_63760 = psizze_60047 == (int64_t) 0;
    bool nonzzero_63761 = !zzero_63760;
    bool nonzzero_cert_63762;
    
    if (!nonzzero_63761) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:422:5-41\n   #2  ftSMJ.fut:421:1-422:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77630 = (int64_t) 4 * niz2084U_60044;
    int64_t segmap_tblock_sizze_68999;
    
    segmap_tblock_sizze_68999 = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_68991;
    
    int64_t segmap_usable_groups_69000 = sdiv_up64(niz2084U_60044, segmap_tblock_sizze_68999);
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(niz2084U_60044, segmap_tblock_sizze_68999));
    
    {
        err = gpu_kernel_gather_payloads_intzisegmap_69003(ctx, segmap_usable_groups_69000, 1, 1, *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_68991, 1, 1, (int64_t) 0, niz2084U_60044, incr_60046, is_mem_77625.mem, mem_77629.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63758 = add64(dz2083U_60045, psizze_60047);
    int64_t zs_lhs_63759 = sub64(zm_lhs_63758, (int64_t) 1);
    int64_t m_63763 = sdiv64(zs_lhs_63759, psizze_60047);
    
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77630, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, mem_77631, niz2084U_60044, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_63765 = slt64((int64_t) 0, m_63763);
    int64_t segmap_tblock_sizze_69027;
    
    segmap_tblock_sizze_69027 = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_69009;
    
    int64_t segmap_usable_groups_69028 = sdiv_up_safe64(niz2084U_60044, segmap_tblock_sizze_69027);
    bool partitioned_gather_res_63766;
    int64_t partitioned_gather_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77634, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_60047, p_63773);
        int64_t min_arg1_63775 = add64(psizze_60047, lower_bound_63774);
        int64_t min_res_63776 = smin64(dz2083U_60045, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, dz2083U_60045);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) dz2083U_60045, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:422:5-41\n   #2  ftSMJ.fut:421:1-422:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77639, bytes_77628, "mem_77639")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77634.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60044})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77642, bytes_77630, "mem_77642")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78736 = sext_i64_i32(sdiv_up64(niz2084U_60044, segmap_tblock_sizze_69027));
        
        {
            err = gpu_kernel_gather_payloads_intzisegmap_69031(ctx, segmap_usable_groups_69028, 1, 1, *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_69009, 1, 1, (int64_t) 0, niz2084U_60044, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77626.mem, mem_param_77634.mem, mem_param_77637.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63763);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &mem_77642, "mem_77642") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_63805;
        int64_t p_tmp_78735 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77634, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78732;
        p_63773 = p_tmp_78735;
    }
    if (memblock_set_device(ctx, &ext_mem_77648, &mem_param_77634, "mem_param_77634") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    partitioned_gather_res_63766 = loop_while_63770;
    partitioned_gather_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77650, bytes_77630, "mem_77650")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60044})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77650, "mem_77650") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79513, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77634, "mem_param_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77648, "ext_mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79514, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61637, int64_t n_61638, int64_t incr_61639, int64_t psizze_61640)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77649;
    
    mem_77649.references = NULL;
    
    struct memblock_device mem_param_tmp_78711;
    
    mem_param_tmp_78711.references = NULL;
    
    struct memblock_device mem_param_tmp_78710;
    
    mem_param_tmp_78710.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77638;
    
    mem_77638.references = NULL;
    
    struct memblock_device mem_param_77636;
    
    mem_param_77636.references = NULL;
    
    struct memblock_device mem_param_77633;
    
    mem_param_77633.references = NULL;
    
    struct memblock_device ext_mem_77646;
    
    ext_mem_77646.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device mem_77630;
    
    mem_77630.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77629 = (int64_t) 8 * ni_61637;
    bool zzero_63761 = psizze_61640 == (int64_t) 0;
    bool nonzzero_63762 = !zzero_63761;
    bool nonzzero_cert_63763;
    
    if (!nonzzero_63762) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:450:5-50\n   #2  ftSMJ.fut:449:1-450:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77640 = (int64_t) 4 * ni_61637;
    int64_t segmap_tblock_sizze_69279;
    
    segmap_tblock_sizze_69279 = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69271;
    
    int64_t segmap_usable_groups_69280 = sdiv_up64(ni_61637, segmap_tblock_sizze_69279);
    
    if (memblock_alloc_device(ctx, &mem_77630, bytes_77629, "mem_77630")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(ni_61637, segmap_tblock_sizze_69279));
    
    {
        err = gpu_kernel_gather_payloads_int_GFURzisegmap_69283(ctx, segmap_usable_groups_69280, 1, 1, *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69271, 1, 1, (int64_t) 0, ni_61637, incr_61639, is_mem_77626.mem, mem_77630.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63759 = add64(n_61638, psizze_61640);
    int64_t zs_lhs_63760 = sub64(zm_lhs_63759, (int64_t) 1);
    int64_t m_63764 = sdiv64(zs_lhs_63760, psizze_61640);
    bool loop_cond_63765 = slt64((int64_t) 0, m_63764);
    int64_t segmap_tblock_sizze_69307;
    
    segmap_tblock_sizze_69307 = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69289;
    
    int64_t segmap_usable_groups_69308 = sdiv_up_safe64(ni_61637, segmap_tblock_sizze_69307);
    bool partitioned_gather_over_array_res_63766;
    int64_t partitioned_gather_over_array_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77633, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77636, &preVals_mem_77625, "preVals_mem_77625") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_61640, p_63773);
        int64_t min_arg1_63775 = add64(psizze_61640, lower_bound_63774);
        int64_t min_res_63776 = smin64(n_61638, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, n_61638);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) n_61638, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:450:5-50\n   #2  ftSMJ.fut:449:1-450:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77638, bytes_77629, "mem_77638")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61637})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77641, bytes_77640, "mem_77641")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78716 = sext_i64_i32(sdiv_up64(ni_61637, segmap_tblock_sizze_69307));
        
        {
            err = gpu_kernel_gather_payloads_int_GFURzisegmap_69311(ctx, segmap_usable_groups_69308, 1, 1, *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_69289, 1, 1, (int64_t) 0, ni_61637, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77627.mem, mem_param_77633.mem, mem_param_77636.mem, mem_77641.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63764);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78710, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78711, &mem_77641, "mem_77641") != 0)
            return 1;
        
        bool loop_while_tmp_78712 = loop_cond_63805;
        int64_t p_tmp_78715 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77633, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77636, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78712;
        p_63773 = p_tmp_78715;
    }
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77633, "mem_param_77633") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77646, &mem_param_77636, "mem_param_77636") != 0)
        return 1;
    partitioned_gather_over_array_res_63766 = loop_while_63770;
    partitioned_gather_over_array_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77649, bytes_77640, "mem_77649")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77646.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61637})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77649, "mem_77649") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79514, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77649, "mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77636, "mem_param_77636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77633, "mem_param_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_79515, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_60353, int64_t dz2083U_60354, int64_t incr_60355, int64_t psizze_60356)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77639;
    
    mem_77639.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device mem_param_77634;
    
    mem_param_77634.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device ext_mem_77648;
    
    ext_mem_77648.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77628 = (int64_t) 8 * niz2084U_60353;
    bool zzero_63760 = psizze_60356 == (int64_t) 0;
    bool nonzzero_63761 = !zzero_63760;
    bool nonzzero_cert_63762;
    
    if (!nonzzero_63761) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:425:5-41\n   #2  ftSMJ.fut:424:1-425:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_69055;
    
    segmap_tblock_sizze_69055 = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69047;
    
    int64_t segmap_usable_groups_69056 = sdiv_up64(niz2084U_60353, segmap_tblock_sizze_69055);
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(niz2084U_60353, segmap_tblock_sizze_69055));
    
    {
        err = gpu_kernel_gather_payloads_longzisegmap_69059(ctx, segmap_usable_groups_69056, 1, 1, *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69047, 1, 1, (int64_t) 0, niz2084U_60353, incr_60355, is_mem_77625.mem, mem_77629.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63758 = add64(dz2083U_60354, psizze_60356);
    int64_t zs_lhs_63759 = sub64(zm_lhs_63758, (int64_t) 1);
    int64_t m_63763 = sdiv64(zs_lhs_63759, psizze_60356);
    
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, niz2084U_60353, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_63765 = slt64((int64_t) 0, m_63763);
    int64_t segmap_tblock_sizze_69083;
    
    segmap_tblock_sizze_69083 = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69065;
    
    int64_t segmap_usable_groups_69084 = sdiv_up_safe64(niz2084U_60353, segmap_tblock_sizze_69083);
    bool partitioned_gather_res_63766;
    int64_t partitioned_gather_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77634, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_60356, p_63773);
        int64_t min_arg1_63775 = add64(psizze_60356, lower_bound_63774);
        int64_t min_res_63776 = smin64(dz2083U_60354, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, dz2083U_60354);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) dz2083U_60354, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:425:5-41\n   #2  ftSMJ.fut:424:1-425:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77639, bytes_77628, "mem_77639")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77634.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60353})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77642, bytes_77628, "mem_77642")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78736 = sext_i64_i32(sdiv_up64(niz2084U_60353, segmap_tblock_sizze_69083));
        
        {
            err = gpu_kernel_gather_payloads_longzisegmap_69087(ctx, segmap_usable_groups_69084, 1, 1, *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_69065, 1, 1, (int64_t) 0, niz2084U_60353, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77626.mem, mem_param_77634.mem, mem_param_77637.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63763);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &mem_77642, "mem_77642") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_63805;
        int64_t p_tmp_78735 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77634, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78732;
        p_63773 = p_tmp_78735;
    }
    if (memblock_set_device(ctx, &ext_mem_77648, &mem_param_77634, "mem_param_77634") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    partitioned_gather_res_63766 = loop_while_63770;
    partitioned_gather_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77650, bytes_77628, "mem_77650")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_60353})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77650, "mem_77650") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79515, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77634, "mem_param_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77648, "ext_mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79516, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61938, int64_t n_61939, int64_t incr_61940, int64_t psizze_61941)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77649;
    
    mem_77649.references = NULL;
    
    struct memblock_device mem_param_tmp_78711;
    
    mem_param_tmp_78711.references = NULL;
    
    struct memblock_device mem_param_tmp_78710;
    
    mem_param_tmp_78710.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77638;
    
    mem_77638.references = NULL;
    
    struct memblock_device mem_param_77636;
    
    mem_param_77636.references = NULL;
    
    struct memblock_device mem_param_77633;
    
    mem_param_77633.references = NULL;
    
    struct memblock_device ext_mem_77646;
    
    ext_mem_77646.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device mem_77630;
    
    mem_77630.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77629 = (int64_t) 8 * ni_61938;
    bool zzero_63761 = psizze_61941 == (int64_t) 0;
    bool nonzzero_63762 = !zzero_63761;
    bool nonzzero_cert_63763;
    
    if (!nonzzero_63762) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:453:5-50\n   #2  ftSMJ.fut:452:1-453:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_69335;
    
    segmap_tblock_sizze_69335 = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69327;
    
    int64_t segmap_usable_groups_69336 = sdiv_up64(ni_61938, segmap_tblock_sizze_69335);
    
    if (memblock_alloc_device(ctx, &mem_77630, bytes_77629, "mem_77630")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(ni_61938, segmap_tblock_sizze_69335));
    
    {
        err = gpu_kernel_gather_payloads_long_GFURzisegmap_69339(ctx, segmap_usable_groups_69336, 1, 1, *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69327, 1, 1, (int64_t) 0, ni_61938, incr_61940, is_mem_77626.mem, mem_77630.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63759 = add64(n_61939, psizze_61941);
    int64_t zs_lhs_63760 = sub64(zm_lhs_63759, (int64_t) 1);
    int64_t m_63764 = sdiv64(zs_lhs_63760, psizze_61941);
    bool loop_cond_63765 = slt64((int64_t) 0, m_63764);
    int64_t segmap_tblock_sizze_69363;
    
    segmap_tblock_sizze_69363 = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69345;
    
    int64_t segmap_usable_groups_69364 = sdiv_up_safe64(ni_61938, segmap_tblock_sizze_69363);
    bool partitioned_gather_over_array_res_63766;
    int64_t partitioned_gather_over_array_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77633, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77636, &preVals_mem_77625, "preVals_mem_77625") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_61941, p_63773);
        int64_t min_arg1_63775 = add64(psizze_61941, lower_bound_63774);
        int64_t min_res_63776 = smin64(n_61939, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, n_61939);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) n_61939, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:453:5-50\n   #2  ftSMJ.fut:452:1-453:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77638, bytes_77629, "mem_77638")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61938})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77641, bytes_77629, "mem_77641")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78716 = sext_i64_i32(sdiv_up64(ni_61938, segmap_tblock_sizze_69363));
        
        {
            err = gpu_kernel_gather_payloads_long_GFURzisegmap_69367(ctx, segmap_usable_groups_69364, 1, 1, *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_69345, 1, 1, (int64_t) 0, ni_61938, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77627.mem, mem_param_77633.mem, mem_param_77636.mem, mem_77641.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63764);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78710, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78711, &mem_77641, "mem_77641") != 0)
            return 1;
        
        bool loop_while_tmp_78712 = loop_cond_63805;
        int64_t p_tmp_78715 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77633, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77636, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78712;
        p_63773 = p_tmp_78715;
    }
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77633, "mem_param_77633") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77646, &mem_param_77636, "mem_param_77636") != 0)
        return 1;
    partitioned_gather_over_array_res_63766 = loop_while_63770;
    partitioned_gather_over_array_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77649, bytes_77629, "mem_77649")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77646.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61938})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77649, "mem_77649") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79516, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77649, "mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77636, "mem_param_77636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77633, "mem_param_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_79517, struct memblock_device is_mem_77625, struct memblock_device ys_mem_77626, int64_t niz2084U_59732, int64_t dz2083U_59733, int64_t incr_59734, int64_t psizze_59735)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77639;
    
    mem_77639.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device mem_param_77634;
    
    mem_param_77634.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device ext_mem_77648;
    
    ext_mem_77648.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77628 = (int64_t) 8 * niz2084U_59732;
    bool zzero_63760 = psizze_59735 == (int64_t) 0;
    bool nonzzero_63761 = !zzero_63760;
    bool nonzzero_cert_63762;
    
    if (!nonzzero_63761) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:419:5-41\n   #2  ftSMJ.fut:418:1-419:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77630 = (int64_t) 2 * niz2084U_59732;
    int64_t segmap_tblock_sizze_68943;
    
    segmap_tblock_sizze_68943 = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68935;
    
    int64_t segmap_usable_groups_68944 = sdiv_up64(niz2084U_59732, segmap_tblock_sizze_68943);
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(niz2084U_59732, segmap_tblock_sizze_68943));
    
    {
        err = gpu_kernel_gather_payloads_shortzisegmap_68947(ctx, segmap_usable_groups_68944, 1, 1, *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68935, 1, 1, (int64_t) 0, niz2084U_59732, incr_59734, is_mem_77625.mem, mem_77629.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63758 = add64(dz2083U_59733, psizze_59735);
    int64_t zs_lhs_63759 = sub64(zm_lhs_63758, (int64_t) 1);
    int64_t m_63763 = sdiv64(zs_lhs_63759, psizze_59735);
    
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77630, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i16(ctx, mem_77631, niz2084U_59732, (int16_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_63765 = slt64((int64_t) 0, m_63763);
    int64_t segmap_tblock_sizze_68971;
    
    segmap_tblock_sizze_68971 = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68953;
    
    int64_t segmap_usable_groups_68972 = sdiv_up_safe64(niz2084U_59732, segmap_tblock_sizze_68971);
    bool partitioned_gather_res_63766;
    int64_t partitioned_gather_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77634, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_59735, p_63773);
        int64_t min_arg1_63775 = add64(psizze_59735, lower_bound_63774);
        int64_t min_res_63776 = smin64(dz2083U_59733, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, dz2083U_59733);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) dz2083U_59733, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:419:5-41\n   #2  ftSMJ.fut:418:1-419:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77639, bytes_77628, "mem_77639")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77634.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_59732})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77642, bytes_77630, "mem_77642")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78736 = sext_i64_i32(sdiv_up64(niz2084U_59732, segmap_tblock_sizze_68971));
        
        {
            err = gpu_kernel_gather_payloads_shortzisegmap_68975(ctx, segmap_usable_groups_68972, 1, 1, *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_68953, 1, 1, (int64_t) 0, niz2084U_59732, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77626.mem, mem_param_77634.mem, mem_param_77637.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63763);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &mem_77642, "mem_77642") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_63805;
        int64_t p_tmp_78735 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77634, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78732;
        p_63773 = p_tmp_78735;
    }
    if (memblock_set_device(ctx, &ext_mem_77648, &mem_param_77634, "mem_param_77634") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    partitioned_gather_res_63766 = loop_while_63770;
    partitioned_gather_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77650, bytes_77630, "mem_77650")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_77650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_59732})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77650, "mem_77650") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79517, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77639, "mem_77639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77634, "mem_param_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77648, "ext_mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_79518, struct memblock_device preVals_mem_77625, struct memblock_device is_mem_77626, struct memblock_device ys_mem_77627, int64_t ni_61336, int64_t n_61337, int64_t incr_61338, int64_t psizze_61339)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77649;
    
    mem_77649.references = NULL;
    
    struct memblock_device mem_param_tmp_78711;
    
    mem_param_tmp_78711.references = NULL;
    
    struct memblock_device mem_param_tmp_78710;
    
    mem_param_tmp_78710.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77638;
    
    mem_77638.references = NULL;
    
    struct memblock_device mem_param_77636;
    
    mem_param_77636.references = NULL;
    
    struct memblock_device mem_param_77633;
    
    mem_param_77633.references = NULL;
    
    struct memblock_device ext_mem_77646;
    
    ext_mem_77646.references = NULL;
    
    struct memblock_device ext_mem_77647;
    
    ext_mem_77647.references = NULL;
    
    struct memblock_device mem_77630;
    
    mem_77630.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t bytes_77629 = (int64_t) 8 * ni_61336;
    bool zzero_63761 = psizze_61339 == (int64_t) 0;
    bool nonzzero_63762 = !zzero_63761;
    bool nonzzero_cert_63763;
    
    if (!nonzzero_63762) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:447:5-50\n   #2  ftSMJ.fut:446:1-447:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77640 = (int64_t) 2 * ni_61336;
    int64_t segmap_tblock_sizze_69223;
    
    segmap_tblock_sizze_69223 = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69215;
    
    int64_t segmap_usable_groups_69224 = sdiv_up64(ni_61336, segmap_tblock_sizze_69223);
    
    if (memblock_alloc_device(ctx, &mem_77630, bytes_77629, "mem_77630")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_78701 = sext_i64_i32(sdiv_up64(ni_61336, segmap_tblock_sizze_69223));
    
    {
        err = gpu_kernel_gather_payloads_short_GFURzisegmap_69227(ctx, segmap_usable_groups_69224, 1, 1, *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69215, 1, 1, (int64_t) 0, ni_61336, incr_61338, is_mem_77626.mem, mem_77630.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_63759 = add64(n_61337, psizze_61339);
    int64_t zs_lhs_63760 = sub64(zm_lhs_63759, (int64_t) 1);
    int64_t m_63764 = sdiv64(zs_lhs_63760, psizze_61339);
    bool loop_cond_63765 = slt64((int64_t) 0, m_63764);
    int64_t segmap_tblock_sizze_69251;
    
    segmap_tblock_sizze_69251 = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69233;
    
    int64_t segmap_usable_groups_69252 = sdiv_up_safe64(ni_61336, segmap_tblock_sizze_69251);
    bool partitioned_gather_over_array_res_63766;
    int64_t partitioned_gather_over_array_res_63769;
    bool loop_while_63770;
    int64_t p_63773;
    
    if (memblock_set_device(ctx, &mem_param_77633, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77636, &preVals_mem_77625, "preVals_mem_77625") != 0)
        return 1;
    loop_while_63770 = loop_cond_63765;
    p_63773 = (int64_t) 0;
    while (loop_while_63770) {
        int64_t lower_bound_63774 = mul64(psizze_61339, p_63773);
        int64_t min_arg1_63775 = add64(psizze_61339, lower_bound_63774);
        int64_t min_res_63776 = smin64(n_61337, min_arg1_63775);
        int64_t j_m_i_63777 = sub64(min_res_63776, lower_bound_63774);
        bool empty_slice_63778 = j_m_i_63777 == (int64_t) 0;
        int64_t m_63779 = sub64(j_m_i_63777, (int64_t) 1);
        int64_t i_p_m_t_s_63780 = add64(lower_bound_63774, m_63779);
        bool zzero_leq_i_p_m_t_s_63781 = sle64((int64_t) 0, i_p_m_t_s_63780);
        bool i_p_m_t_s_leq_w_63782 = slt64(i_p_m_t_s_63780, n_61337);
        bool zzero_lte_i_63783 = sle64((int64_t) 0, lower_bound_63774);
        bool i_lte_j_63784 = sle64(lower_bound_63774, min_res_63776);
        bool y_63785 = i_p_m_t_s_leq_w_63782 && zzero_lte_i_63783;
        bool y_63786 = zzero_leq_i_p_m_t_s_63781 && y_63785;
        bool forwards_ok_63787 = i_lte_j_63784 && y_63786;
        bool ok_or_empty_63788 = empty_slice_63778 || forwards_ok_63787;
        bool index_certs_63789;
        
        if (!ok_or_empty_63788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_63774, ":", (long long) min_res_63776, "] out of bounds for array of shape [", (long long) n_61337, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:447:5-50\n   #2  ftSMJ.fut:446:1-447:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_77638, bytes_77629, "mem_77638")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61336})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_77641, bytes_77640, "mem_77641")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_78716 = sext_i64_i32(sdiv_up64(ni_61336, segmap_tblock_sizze_69251));
        
        {
            err = gpu_kernel_gather_payloads_short_GFURzisegmap_69255(ctx, segmap_usable_groups_69252, 1, 1, *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_69233, 1, 1, (int64_t) 0, ni_61336, lower_bound_63774, min_res_63776, j_m_i_63777, ys_mem_77627.mem, mem_param_77633.mem, mem_param_77636.mem, mem_77641.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_63804 = add64((int64_t) 1, p_63773);
        bool loop_cond_63805 = slt64(tmp_63804, m_63764);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78710, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78711, &mem_77641, "mem_77641") != 0)
            return 1;
        
        bool loop_while_tmp_78712 = loop_cond_63805;
        int64_t p_tmp_78715 = tmp_63804;
        
        if (memblock_set_device(ctx, &mem_param_77633, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77636, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        loop_while_63770 = loop_while_tmp_78712;
        p_63773 = p_tmp_78715;
    }
    if (memblock_set_device(ctx, &ext_mem_77647, &mem_param_77633, "mem_param_77633") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_77646, &mem_param_77636, "mem_param_77636") != 0)
        return 1;
    partitioned_gather_over_array_res_63766 = loop_while_63770;
    partitioned_gather_over_array_res_63769 = p_63773;
    if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_77649, bytes_77640, "mem_77649")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_77649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77646.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_61336})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77649, "mem_77649") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79518, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77649, "mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78711, "mem_param_tmp_78711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78710, "mem_param_tmp_78710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77638, "mem_77638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77636, "mem_param_77636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77633, "mem_param_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77646, "ext_mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77647, "ext_mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77630, "mem_77630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_79519, struct memblock_device *mem_out_p_79520, struct memblock_device *mem_out_p_79521, int64_t *out_prim_out_79522, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_59382, int64_t nS_59383, int64_t offset_R_59386, int64_t offset_S_59387, int64_t partitionsPerWindow_59388, int64_t numberOfWindows_59389, int64_t extParallelism_59390, int64_t scatter_psizze_59391)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_78203;
    
    mem_78203.references = NULL;
    
    struct memblock_device mem_78201;
    
    mem_78201.references = NULL;
    
    struct memblock_device mem_78199;
    
    mem_78199.references = NULL;
    
    struct memblock_device mem_param_tmp_79448;
    
    mem_param_tmp_79448.references = NULL;
    
    struct memblock_device mem_param_tmp_79447;
    
    mem_param_tmp_79447.references = NULL;
    
    struct memblock_device mem_param_tmp_79446;
    
    mem_param_tmp_79446.references = NULL;
    
    struct memblock_device mem_78185;
    
    mem_78185.references = NULL;
    
    struct memblock_device mem_78183;
    
    mem_78183.references = NULL;
    
    struct memblock_device mem_78178;
    
    mem_78178.references = NULL;
    
    struct memblock_device mem_78176;
    
    mem_78176.references = NULL;
    
    struct memblock_device mem_78174;
    
    mem_78174.references = NULL;
    
    struct memblock_device mem_param_78172;
    
    mem_param_78172.references = NULL;
    
    struct memblock_device mem_param_78169;
    
    mem_param_78169.references = NULL;
    
    struct memblock_device mem_param_78166;
    
    mem_param_78166.references = NULL;
    
    struct memblock_device ext_mem_78195;
    
    ext_mem_78195.references = NULL;
    
    struct memblock_device ext_mem_78196;
    
    ext_mem_78196.references = NULL;
    
    struct memblock_device ext_mem_78197;
    
    ext_mem_78197.references = NULL;
    
    struct memblock_device mem_78181;
    
    mem_78181.references = NULL;
    
    struct memblock_device mem_78180;
    
    mem_78180.references = NULL;
    
    struct memblock_device mem_78179;
    
    mem_78179.references = NULL;
    
    struct memblock_device mem_78153;
    
    mem_78153.references = NULL;
    
    struct memblock_device mem_78151;
    
    mem_78151.references = NULL;
    
    struct memblock_device mem_78149;
    
    mem_78149.references = NULL;
    
    struct memblock_device mem_78138;
    
    mem_78138.references = NULL;
    
    struct memblock_device mem_78136;
    
    mem_78136.references = NULL;
    
    struct memblock_device mem_78134;
    
    mem_78134.references = NULL;
    
    struct memblock_device mem_78130;
    
    mem_78130.references = NULL;
    
    struct memblock_device mem_78128;
    
    mem_78128.references = NULL;
    
    struct memblock_device mem_78132;
    
    mem_78132.references = NULL;
    
    struct memblock_device mem_78124;
    
    mem_78124.references = NULL;
    
    struct memblock_device mem_78125;
    
    mem_78125.references = NULL;
    
    struct memblock_device ext_mem_78126;
    
    ext_mem_78126.references = NULL;
    
    struct memblock_device mem_78121;
    
    mem_78121.references = NULL;
    
    struct memblock_device mem_78122;
    
    mem_78122.references = NULL;
    
    struct memblock_device ext_mem_78123;
    
    ext_mem_78123.references = NULL;
    
    struct memblock_device mem_78120;
    
    mem_78120.references = NULL;
    
    struct memblock_device incprefixes_mem_79249;
    
    incprefixes_mem_79249.references = NULL;
    
    struct memblock_device aggregates_mem_79247;
    
    aggregates_mem_79247.references = NULL;
    
    struct memblock_device incprefixes_mem_79245;
    
    incprefixes_mem_79245.references = NULL;
    
    struct memblock_device aggregates_mem_79243;
    
    aggregates_mem_79243.references = NULL;
    
    struct memblock_device status_flags_mem_79241;
    
    status_flags_mem_79241.references = NULL;
    
    struct memblock_device mem_78117;
    
    mem_78117.references = NULL;
    
    struct memblock_device mem_78115;
    
    mem_78115.references = NULL;
    
    struct memblock_device mem_78113;
    
    mem_78113.references = NULL;
    
    struct memblock_device mem_78109;
    
    mem_78109.references = NULL;
    
    struct memblock_device mem_78107;
    
    mem_78107.references = NULL;
    
    struct memblock_device mem_78105;
    
    mem_78105.references = NULL;
    
    struct memblock_device mem_78103;
    
    mem_78103.references = NULL;
    
    struct memblock_device incprefixes_mem_79108;
    
    incprefixes_mem_79108.references = NULL;
    
    struct memblock_device aggregates_mem_79106;
    
    aggregates_mem_79106.references = NULL;
    
    struct memblock_device status_flags_mem_79084;
    
    status_flags_mem_79084.references = NULL;
    
    struct memblock_device mem_78101;
    
    mem_78101.references = NULL;
    
    struct memblock_device mem_78099;
    
    mem_78099.references = NULL;
    
    struct memblock_device mem_param_tmp_78751;
    
    mem_param_tmp_78751.references = NULL;
    
    struct memblock_device mem_param_tmp_78750;
    
    mem_param_tmp_78750.references = NULL;
    
    struct memblock_device mem_78084;
    
    mem_78084.references = NULL;
    
    struct memblock_device mem_78083;
    
    mem_78083.references = NULL;
    
    struct memblock_device mem_78080;
    
    mem_78080.references = NULL;
    
    struct memblock_device mem_param_tmp_78908;
    
    mem_param_tmp_78908.references = NULL;
    
    struct memblock_device mem_param_tmp_78907;
    
    mem_param_tmp_78907.references = NULL;
    
    struct memblock_device mem_77888;
    
    mem_77888.references = NULL;
    
    struct memblock_device mem_77886;
    
    mem_77886.references = NULL;
    
    struct memblock_device mem_77884;
    
    mem_77884.references = NULL;
    
    struct memblock_device mem_77881;
    
    mem_77881.references = NULL;
    
    struct memblock_device mem_param_tmp_78918;
    
    mem_param_tmp_78918.references = NULL;
    
    struct memblock_device mem_param_tmp_78917;
    
    mem_param_tmp_78917.references = NULL;
    
    struct memblock_device mem_77872;
    
    mem_77872.references = NULL;
    
    struct memblock_device mem_77869;
    
    mem_77869.references = NULL;
    
    struct memblock_device mem_param_tmp_78936;
    
    mem_param_tmp_78936.references = NULL;
    
    struct memblock_device mem_param_tmp_78935;
    
    mem_param_tmp_78935.references = NULL;
    
    struct memblock_device mem_77848;
    
    mem_77848.references = NULL;
    
    struct memblock_device mem_77846;
    
    mem_77846.references = NULL;
    
    struct memblock_device mem_77781;
    
    mem_77781.references = NULL;
    
    struct memblock_device mem_77779;
    
    mem_77779.references = NULL;
    
    struct memblock_device mem_77842;
    
    mem_77842.references = NULL;
    
    struct memblock_device mem_77840;
    
    mem_77840.references = NULL;
    
    struct memblock_device ext_mem_77843;
    
    ext_mem_77843.references = NULL;
    
    struct memblock_device ext_mem_77844;
    
    ext_mem_77844.references = NULL;
    
    struct memblock_device ext_mem_77720;
    
    ext_mem_77720.references = NULL;
    
    struct memblock_device mem_77718;
    
    mem_77718.references = NULL;
    
    struct memblock_device ext_mem_77851;
    
    ext_mem_77851.references = NULL;
    
    struct memblock_device ext_mem_77854;
    
    ext_mem_77854.references = NULL;
    
    struct memblock_device mem_77716;
    
    mem_77716.references = NULL;
    
    struct memblock_device ext_mem_77857;
    
    ext_mem_77857.references = NULL;
    
    struct memblock_device ext_mem_77860;
    
    ext_mem_77860.references = NULL;
    
    struct memblock_device ext_mem_77714;
    
    ext_mem_77714.references = NULL;
    
    struct memblock_device ext_mem_77713;
    
    ext_mem_77713.references = NULL;
    
    struct memblock_device mem_param_77710;
    
    mem_param_77710.references = NULL;
    
    struct memblock_device mem_param_77707;
    
    mem_param_77707.references = NULL;
    
    struct memblock_device ext_mem_77865;
    
    ext_mem_77865.references = NULL;
    
    struct memblock_device ext_mem_77866;
    
    ext_mem_77866.references = NULL;
    
    struct memblock_device mem_77702;
    
    mem_77702.references = NULL;
    
    struct memblock_device mem_77703;
    
    mem_77703.references = NULL;
    
    struct memblock_device ext_mem_77704;
    
    ext_mem_77704.references = NULL;
    
    struct memblock_device mem_77699;
    
    mem_77699.references = NULL;
    
    struct memblock_device mem_77700;
    
    mem_77700.references = NULL;
    
    struct memblock_device ext_mem_77701;
    
    ext_mem_77701.references = NULL;
    
    struct memblock_device mem_param_77698;
    
    mem_param_77698.references = NULL;
    
    struct memblock_device mem_param_77695;
    
    mem_param_77695.references = NULL;
    
    struct memblock_device ext_mem_77877;
    
    ext_mem_77877.references = NULL;
    
    struct memblock_device ext_mem_77878;
    
    ext_mem_77878.references = NULL;
    
    struct memblock_device mem_77715;
    
    mem_77715.references = NULL;
    
    struct memblock_device mem_77712;
    
    mem_77712.references = NULL;
    
    struct memblock_device mem_77711;
    
    mem_77711.references = NULL;
    
    struct memblock_device mem_77692;
    
    mem_77692.references = NULL;
    
    struct memblock_device mem_77690;
    
    mem_77690.references = NULL;
    
    struct memblock_device ext_mem_77891;
    
    ext_mem_77891.references = NULL;
    
    struct memblock_device ext_mem_77894;
    
    ext_mem_77894.references = NULL;
    
    struct memblock_device ext_mem_77897;
    
    ext_mem_77897.references = NULL;
    
    struct memblock_device ext_mem_77900;
    
    ext_mem_77900.references = NULL;
    
    struct memblock_device mem_param_77688;
    
    mem_param_77688.references = NULL;
    
    struct memblock_device mem_param_77685;
    
    mem_param_77685.references = NULL;
    
    struct memblock_device ext_mem_77905;
    
    ext_mem_77905.references = NULL;
    
    struct memblock_device ext_mem_77906;
    
    ext_mem_77906.references = NULL;
    
    struct memblock_device mem_77682;
    
    mem_77682.references = NULL;
    
    struct memblock_device mem_77680;
    
    mem_77680.references = NULL;
    
    struct memblock_device mem_77667;
    
    mem_77667.references = NULL;
    
    struct memblock_device mem_77669;
    
    mem_77669.references = NULL;
    
    struct memblock_device ext_mem_77670;
    
    ext_mem_77670.references = NULL;
    
    struct memblock_device ext_mem_77671;
    
    ext_mem_77671.references = NULL;
    
    struct memblock_device mem_77664;
    
    mem_77664.references = NULL;
    
    struct memblock_device mem_77662;
    
    mem_77662.references = NULL;
    
    struct memblock_device mem_77651;
    
    mem_77651.references = NULL;
    
    struct memblock_device mem_77652;
    
    mem_77652.references = NULL;
    
    struct memblock_device ext_mem_77653;
    
    ext_mem_77653.references = NULL;
    
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_77647;
    
    mem_77647.references = NULL;
    
    struct memblock_device mem_77648;
    
    mem_77648.references = NULL;
    
    struct memblock_device ext_mem_77649;
    
    ext_mem_77649.references = NULL;
    
    struct memblock_device mem_77646;
    
    mem_77646.references = NULL;
    
    struct memblock_device mem_77644;
    
    mem_77644.references = NULL;
    
    struct memblock_device mem_param_tmp_78769;
    
    mem_param_tmp_78769.references = NULL;
    
    struct memblock_device mem_param_tmp_78768;
    
    mem_param_tmp_78768.references = NULL;
    
    struct memblock_device mem_78053;
    
    mem_78053.references = NULL;
    
    struct memblock_device mem_78051;
    
    mem_78051.references = NULL;
    
    struct memblock_device mem_77986;
    
    mem_77986.references = NULL;
    
    struct memblock_device mem_77984;
    
    mem_77984.references = NULL;
    
    struct memblock_device mem_78047;
    
    mem_78047.references = NULL;
    
    struct memblock_device mem_78045;
    
    mem_78045.references = NULL;
    
    struct memblock_device ext_mem_78048;
    
    ext_mem_78048.references = NULL;
    
    struct memblock_device ext_mem_78049;
    
    ext_mem_78049.references = NULL;
    
    struct memblock_device ext_mem_77925;
    
    ext_mem_77925.references = NULL;
    
    struct memblock_device mem_77923;
    
    mem_77923.references = NULL;
    
    struct memblock_device ext_mem_78056;
    
    ext_mem_78056.references = NULL;
    
    struct memblock_device ext_mem_78059;
    
    ext_mem_78059.references = NULL;
    
    struct memblock_device mem_77921;
    
    mem_77921.references = NULL;
    
    struct memblock_device ext_mem_78062;
    
    ext_mem_78062.references = NULL;
    
    struct memblock_device ext_mem_78065;
    
    ext_mem_78065.references = NULL;
    
    struct memblock_device ext_mem_77919;
    
    ext_mem_77919.references = NULL;
    
    struct memblock_device ext_mem_77918;
    
    ext_mem_77918.references = NULL;
    
    struct memblock_device mem_param_77915;
    
    mem_param_77915.references = NULL;
    
    struct memblock_device mem_param_77912;
    
    mem_param_77912.references = NULL;
    
    struct memblock_device ext_mem_78070;
    
    ext_mem_78070.references = NULL;
    
    struct memblock_device ext_mem_78071;
    
    ext_mem_78071.references = NULL;
    
    struct memblock_device mem_77920;
    
    mem_77920.references = NULL;
    
    struct memblock_device mem_77917;
    
    mem_77917.references = NULL;
    
    struct memblock_device mem_77916;
    
    mem_77916.references = NULL;
    
    struct memblock_device mem_77907;
    
    mem_77907.references = NULL;
    
    struct memblock_device mem_77908;
    
    mem_77908.references = NULL;
    
    struct memblock_device ext_mem_77909;
    
    ext_mem_77909.references = NULL;
    
    struct memblock_device ext_mem_78074;
    
    ext_mem_78074.references = NULL;
    
    struct memblock_device ext_mem_78077;
    
    ext_mem_78077.references = NULL;
    
    struct memblock_device ext_mem_78087;
    
    ext_mem_78087.references = NULL;
    
    struct memblock_device ext_mem_78090;
    
    ext_mem_78090.references = NULL;
    
    struct memblock_device mem_param_77640;
    
    mem_param_77640.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device ext_mem_78095;
    
    ext_mem_78095.references = NULL;
    
    struct memblock_device ext_mem_78096;
    
    ext_mem_78096.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77632;
    
    mem_77632.references = NULL;
    
    struct memblock_device mem_77633;
    
    mem_77633.references = NULL;
    
    struct memblock_device ext_mem_77634;
    
    ext_mem_77634.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device ext_mem_77627;
    
    ext_mem_77627.references = NULL;
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78703;
    int64_t zm_lhs_66970 = add64(nR_59382, nS_59383);
    int64_t zs_lhs_66971 = sub64(zm_lhs_66970, (int64_t) 1);
    bool zzero_66972 = nR_59382 == (int64_t) 0;
    bool nonzzero_66973 = !zzero_66972;
    bool nonzzero_cert_66974;
    
    if (!nonzzero_66973) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:232:26-29\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_66975 = sdiv64(zs_lhs_66971, nR_59382);
    
    if (futrts_indicesWithIncrement_10056(ctx, &ext_mem_77627, tR_mem_77625, nR_59382, offset_R_59386) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_77628 = (int64_t) 8 * nR_59382;
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77629, nR_59382, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, nR_59382, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_66980 = slt64((int64_t) 0, numIter_66975);
    int64_t gt_rhs_66981 = sub64(nR_59382, (int64_t) 1);
    bool x_66982 = sle64((int64_t) 0, gt_rhs_66981);
    bool y_66983 = slt64(gt_rhs_66981, nR_59382);
    bool bounds_check_66984 = x_66982 && y_66983;
    bool loop_not_taken_66985 = !loop_cond_66980;
    bool protect_assert_disj_66986 = bounds_check_66984 || loop_not_taken_66985;
    bool index_certs_66987;
    
    if (!protect_assert_disj_66986) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftSMJ.fut:239:25-33\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_66980) {
        if (memblock_alloc_device(ctx, &mem_77633, (int64_t) 8, "mem_77633")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_78724(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, tR_mem_77625.mem, mem_77633.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77633, "mem_77633") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_77632, (int64_t) 8, "mem_77632")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_77632, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77632, "mem_77632") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_77641, (int64_t) 8, "mem_77641")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77642, (int64_t) 1, "mem_77642")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_66990;
    int64_t defunc_0_mergeJoin_res_66991;
    bool loop_while_66994;
    int64_t p_66995;
    
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77640, &mem_77629, "mem_77629") != 0)
        return 1;
    loop_while_66994 = loop_cond_66980;
    p_66995 = (int64_t) 0;
    while (loop_while_66994) {
        int64_t tS_start_66998 = mul64(nR_59382, p_66995);
        int64_t min_arg1_66999 = add64(nR_59382, tS_start_66998);
        int64_t min_res_67000 = smin64(nS_59383, min_arg1_66999);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 = sub64(min_res_67000, tS_start_66998);
        bool empty_slice_67002 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 == (int64_t) 0;
        int64_t m_67003 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, (int64_t) 1);
        int64_t i_p_m_t_s_67004 = add64(tS_start_66998, m_67003);
        bool zzero_leq_i_p_m_t_s_67005 = sle64((int64_t) 0, i_p_m_t_s_67004);
        bool i_p_m_t_s_leq_w_67006 = slt64(i_p_m_t_s_67004, nS_59383);
        bool zzero_lte_i_67007 = sle64((int64_t) 0, tS_start_66998);
        bool i_lte_j_67008 = sle64(tS_start_66998, min_res_67000);
        bool y_67009 = i_p_m_t_s_leq_w_67006 && zzero_lte_i_67007;
        bool y_67010 = zzero_leq_i_p_m_t_s_67005 && y_67009;
        bool forwards_ok_67011 = i_lte_j_67008 && y_67010;
        bool ok_or_empty_67012 = empty_slice_67002 || forwards_ok_67011;
        bool index_certs_67013;
        
        if (!ok_or_empty_67012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_66998, ":", (long long) min_res_67000, "] out of bounds for array of shape [", (long long) nS_59383, "].", "-> #0  ftSMJ.fut:238:16-35\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_67015 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
        bool index_certs_67016;
        
        if (!y_67015) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:239:12-19\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_78756(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_66998, tS_mem_77626.mem, ext_mem_77634.mem, mem_77641.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_79523;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79523, mem_77642.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_67018 = read_res_79523;
        int64_t loopres_67019;
        
        if (defunc_0_gt_res_67018) {
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_param_77637, "mem_param_77637") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_param_77640, "mem_param_77640") != 0)
                return 1;
            loopres_67019 = numIter_66975;
        } else {
            bool cond_67022 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, nR_59382);
            bool dim_match_67136 = nR_59382 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            bool protect_assert_disj_78305 = cond_67022 || dim_match_67136;
            bool empty_or_match_cert_67137;
            
            if (!protect_assert_disj_78305) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "] cannot match shape of type `[", (long long) nR_59382, "]f64`.", "-> #0  ftSMJ.fut:247:18-31\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_67143 = slt64((int64_t) 0, numberOfWindows_59389);
            bool y_67146 = slt64((int64_t) 0, nR_59382);
            bool loop_not_taken_67147 = !loop_cond_67143;
            bool protect_assert_disj_67148 = y_67146 || loop_not_taken_67147;
            bool protect_assert_disj_78307 = cond_67022 || protect_assert_disj_67148;
            bool index_certs_67149;
            
            if (!protect_assert_disj_78307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftsort.fut:285:20-25\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_68532 = add64(nR_59382, extParallelism_59390);
            int64_t zs_lhs_68533 = sub64(zm_lhs_68532, (int64_t) 1);
            bool zzero_68534 = extParallelism_59390 == (int64_t) 0;
            bool nonzzero_68535 = !zzero_68534;
            bool loop_not_taken_78248 = !cond_67022;
            bool protect_assert_disj_78249 = nonzzero_68535 || loop_not_taken_78248;
            bool nonzzero_cert_68536;
            
            if (!protect_assert_disj_78249) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_68537 = sdiv_safe64(zs_lhs_68533, extParallelism_59390);
            bool loop_cond_68538 = slt64((int64_t) 0, numIter_68537);
            bool loop_not_taken_68539 = !y_67015;
            bool loop_not_taken_68540 = !loop_cond_68538;
            bool x_68541 = sle64((int64_t) 0, m_67003);
            bool y_68542 = slt64(m_67003, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
            bool bounds_check_68544 = x_68541 && y_68542;
            bool protect_assert_disj_68545 = loop_not_taken_68539 || bounds_check_68544;
            bool protect_assert_disj_68546 = loop_not_taken_68540 || protect_assert_disj_68545;
            bool protect_assert_disj_78251 = protect_assert_disj_68546 || loop_not_taken_78248;
            bool index_certs_68547;
            
            if (!protect_assert_disj_78251) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67817;
            
            if (!bounds_check_68544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:258:23-44\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67819;
            
            if (!bounds_check_66984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftSMJ.fut:258:51-59\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 = mul64(partitionsPerWindow_59388, numberOfWindows_59389);
            int64_t join_chunks_arg3_67139 = add64(offset_S_59387, tS_start_66998);
            int64_t bytes_77643 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
            bool empty_slice_67144 = partitionsPerWindow_59388 == (int64_t) 0;
            int64_t m_67145 = sub64(partitionsPerWindow_59388, (int64_t) 1);
            int64_t segmap_tblock_sizze_75118;
            
            segmap_tblock_sizze_75118 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_74911;
            
            int64_t zeze_rhs_67414 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, (int64_t) 1);
            int64_t segmap_tblock_sizze_75492;
            
            segmap_tblock_sizze_75492 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75328;
            
            int64_t segmap_usable_groups_75493 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_75492);
            bool loop_cond_67569 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
            bool protect_cond_conj_68543 = y_67015 && loop_cond_68538;
            int64_t bytes_77922 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            int64_t ext_78076;
            int64_t ext_78075;
            int64_t ext_78073;
            int64_t ext_78072;
            
            if (cond_67022) {
                if (protect_cond_conj_68543) {
                    if (memblock_alloc_device(ctx, &mem_77908, (int64_t) 8, "mem_77908")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78762(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_67004, tS_mem_77626.mem, mem_77908.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77908, "mem_77908") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77907, (int64_t) 8, "mem_77907")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_77907, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77907, "mem_77907") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77916, (int64_t) 8, "mem_77916")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77917, (int64_t) 8, "mem_77917")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77920, (int64_t) 1, "mem_77920")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_78069;
                int64_t ext_78068;
                int64_t ext_78067;
                int64_t ext_78066;
                bool defunc_0_find_joinTuples_res_68550;
                int64_t defunc_0_find_joinTuples_res_68551;
                bool loop_while_68554;
                int64_t p_68555;
                int64_t ctx_param_ext_77910;
                int64_t ctx_param_ext_77911;
                int64_t ctx_param_ext_77913;
                int64_t ctx_param_ext_77914;
                
                if (memblock_set_device(ctx, &mem_param_77912, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77915, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77910 = (int64_t) 0;
                ctx_param_ext_77911 = (int64_t) 1;
                ctx_param_ext_77913 = (int64_t) 0;
                ctx_param_ext_77914 = (int64_t) 1;
                loop_while_68554 = loop_cond_68538;
                p_68555 = (int64_t) 0;
                while (loop_while_68554) {
                    int64_t start_68558 = mul64(extParallelism_59390, p_68555);
                    int64_t min_arg1_68559 = sub64(nR_59382, start_68558);
                    int64_t min_res_68560 = smin64(extParallelism_59390, min_arg1_68559);
                    int64_t iter_R_68561 = add64(start_68558, min_res_68560);
                    bool empty_slice_68562 = min_res_68560 == (int64_t) 0;
                    int64_t m_68563 = sub64(min_res_68560, (int64_t) 1);
                    int64_t i_p_m_t_s_68564 = add64(start_68558, m_68563);
                    bool zzero_leq_i_p_m_t_s_68565 = sle64((int64_t) 0, i_p_m_t_s_68564);
                    bool i_p_m_t_s_leq_w_68566 = slt64(i_p_m_t_s_68564, nR_59382);
                    bool zzero_lte_i_68567 = sle64((int64_t) 0, start_68558);
                    bool i_lte_j_68568 = sle64(start_68558, iter_R_68561);
                    bool y_68569 = i_p_m_t_s_leq_w_68566 && zzero_lte_i_68567;
                    bool y_68570 = zzero_leq_i_p_m_t_s_68565 && y_68569;
                    bool forwards_ok_68571 = i_lte_j_68568 && y_68570;
                    bool ok_or_empty_68572 = empty_slice_68562 || forwards_ok_68571;
                    bool index_certs_68573;
                    
                    if (!ok_or_empty_68572) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_68558, ":", (long long) iter_R_68561, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68574 = slt64(m_68563, min_res_68560);
                    bool x_68575 = sle64((int64_t) 0, m_68563);
                    bool bounds_check_68576 = y_68574 && x_68575;
                    bool index_certs_68577;
                    
                    if (!bounds_check_68576) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_68563, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68580 = slt64((int64_t) 0, min_res_68560);
                    bool index_certs_68581;
                    
                    if (!y_68580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78778(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_68558, i_p_m_t_s_68564, tR_mem_77625.mem, mem_77916.mem, mem_77917.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77918, &ext_mem_77909, "ext_mem_77909") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77918, &mem_77916, "mem_77916") != 0)
                        return 1;
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77919, &mem_77641, "mem_77641") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77919, &mem_77917, "mem_77917") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78784(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77917.mem, ext_mem_77918.mem, mem_77920.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
                        return 1;
                    
                    bool read_res_79524;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79524, mem_77920.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_68583 = read_res_79524;
                    int64_t ext_78064;
                    int64_t ext_78063;
                    int64_t ext_78061;
                    int64_t ext_78060;
                    int64_t loopres_68585;
                    
                    if (defunc_0_gt_res_68583) {
                        if (memblock_set_device(ctx, &ext_mem_78065, &mem_param_77912, "mem_param_77912") != 0)
                            return 1;
                        ext_78064 = ctx_param_ext_77910;
                        ext_78063 = ctx_param_ext_77911;
                        if (memblock_set_device(ctx, &ext_mem_78062, &mem_param_77915, "mem_param_77915") != 0)
                            return 1;
                        ext_78061 = ctx_param_ext_77913;
                        ext_78060 = ctx_param_ext_77914;
                        loopres_68585 = numIter_68537;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77921, (int64_t) 1, "mem_77921")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_doublezigpuseq_78790(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77916.mem, ext_mem_77919.mem, mem_77921.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_79525;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79525, mem_77921.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_68589 = read_res_79525;
                        
                        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
                            return 1;
                        
                        int64_t ext_78058;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78058 = ctx_param_ext_77910;
                        } else {
                            ext_78058 = (int64_t) 0;
                        }
                        
                        int64_t ext_78057;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78057 = ctx_param_ext_77911;
                        } else {
                            ext_78057 = (int64_t) 1;
                        }
                        
                        int64_t ext_78055;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78055 = ctx_param_ext_77913;
                        } else {
                            ext_78055 = (int64_t) 0;
                        }
                        
                        int64_t ext_78054;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78054 = ctx_param_ext_77914;
                        } else {
                            ext_78054 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_68590;
                        
                        if (defunc_0_gt_res_68589) {
                            int64_t tmp_68594 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_param_77912, "mem_param_77912") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_param_77915, "mem_param_77915") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68594;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_77923, bytes_77922, "mem_77923")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, tS_start_66998, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_10056(ctx, &ext_mem_77925, mem_77923, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, join_chunks_arg3_67139) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
                                return 1;
                            
                            bool suff_outer_par_74733;
                            
                            suff_outer_par_74733 = *ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_0 <= min_res_68560;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_double.suff_outer_par_0", (long) min_res_68560, suff_outer_par_74733 ? "true" : "false");
                            
                            int64_t tile_sizze_76414;
                            
                            tile_sizze_76414 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413;
                            
                            int64_t tile_sizze_76059;
                            
                            tile_sizze_76059 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058;
                            
                            int64_t num_whole_tiles_76430 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            int64_t residual_input_76654 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            bool cond_76655 = residual_input_76654 == (int64_t) 0;
                            int64_t binop_x_76671 = tile_sizze_76414 * num_whole_tiles_76430;
                            int64_t bytes_77983 = (int64_t) 8 * min_res_68560;
                            int64_t bytes_77946 = (int64_t) 8 * tile_sizze_76414;
                            int64_t num_whole_tiles_76075 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            int64_t residual_input_76299 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            bool cond_76300 = residual_input_76299 == (int64_t) 0;
                            int64_t binop_x_76316 = tile_sizze_76059 * num_whole_tiles_76075;
                            int64_t bytes_78007 = (int64_t) 8 * tile_sizze_76059;
                            int64_t shared_memory_capacity_78848;
                            
                            shared_memory_capacity_78848 = ctx->max_shared_memory;
                            if (suff_outer_par_74733 && sle64(sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78848)) {
                                int64_t ldim_76060 = sdiv_up64(min_res_68560, tile_sizze_76059);
                                
                                if (memblock_alloc_device(ctx, &mem_78045, bytes_77983, "mem_78045")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_78047, bytes_77983, "mem_78047")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78796 = sext_i64_i32(sdiv_up64(tile_sizze_76059, tile_sizze_76059));
                                int32_t virt_num_tblocks_78797 = sext_i64_i32(ldim_76060);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76057(ctx, ldim_76060, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76058, 1, 1, bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76060, num_whole_tiles_76075, residual_input_76299, cond_76300, binop_x_76316, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_78045.mem, mem_78047.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_78045, "mem_78045") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_78047, "mem_78047") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_76415 = sdiv_up64(min_res_68560, tile_sizze_76414);
                                
                                if (memblock_alloc_device(ctx, &mem_77984, bytes_77983, "mem_77984")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_77986, bytes_77983, "mem_77986")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78822 = sext_i64_i32(sdiv_up64(tile_sizze_76414, tile_sizze_76414));
                                int32_t virt_num_tblocks_78823 = sext_i64_i32(ldim_76415);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76412(ctx, ldim_76415, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76413, 1, 1, bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76415, num_whole_tiles_76430, residual_input_76654, cond_76655, binop_x_76671, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_77984.mem, mem_77986.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_77984, "mem_77984") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_77986, "mem_77986") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78051, bytes_77628, "mem_78051")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77915.mem, ctx_param_ext_77913, (int64_t []) {ctx_param_ext_77914}, (int64_t []) {nR_59382})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78049.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78053, bytes_77628, "mem_78053")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77912.mem, ctx_param_ext_77910, (int64_t []) {ctx_param_ext_77911}, (int64_t []) {nR_59382})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
                                return 1;
                            
                            int64_t tmp_68646 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_78053, "mem_78053") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_78051, "mem_78051") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68646;
                        }
                        if (memblock_set_device(ctx, &ext_mem_78065, &ext_mem_78059, "ext_mem_78059") != 0)
                            return 1;
                        ext_78064 = ext_78058;
                        ext_78063 = ext_78057;
                        if (memblock_set_device(ctx, &ext_mem_78062, &ext_mem_78056, "ext_mem_78056") != 0)
                            return 1;
                        ext_78061 = ext_78055;
                        ext_78060 = ext_78054;
                        loopres_68585 = loopres_f_res_68590;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
                        return 1;
                    
                    bool loop_cond_68647 = slt64(loopres_68585, numIter_68537);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78768, &ext_mem_78065, "ext_mem_78065") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78769, &ext_mem_78062, "ext_mem_78062") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78770 = ext_78064;
                    int64_t ctx_param_ext_tmp_78771 = ext_78063;
                    int64_t ctx_param_ext_tmp_78772 = ext_78061;
                    int64_t ctx_param_ext_tmp_78773 = ext_78060;
                    bool loop_while_tmp_78774 = loop_cond_68647;
                    int64_t p_tmp_78775 = loopres_68585;
                    
                    if (memblock_set_device(ctx, &mem_param_77912, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77915, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
                        return 1;
                    ctx_param_ext_77910 = ctx_param_ext_tmp_78770;
                    ctx_param_ext_77911 = ctx_param_ext_tmp_78771;
                    ctx_param_ext_77913 = ctx_param_ext_tmp_78772;
                    ctx_param_ext_77914 = ctx_param_ext_tmp_78773;
                    loop_while_68554 = loop_while_tmp_78774;
                    p_68555 = p_tmp_78775;
                }
                if (memblock_set_device(ctx, &ext_mem_78071, &mem_param_77912, "mem_param_77912") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78070, &mem_param_77915, "mem_param_77915") != 0)
                    return 1;
                ext_78069 = ctx_param_ext_77910;
                ext_78068 = ctx_param_ext_77911;
                ext_78067 = ctx_param_ext_77913;
                ext_78066 = ctx_param_ext_77914;
                defunc_0_find_joinTuples_res_68550 = loop_while_68554;
                defunc_0_find_joinTuples_res_68551 = p_68555;
                if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_78071, "ext_mem_78071") != 0)
                    return 1;
                ext_78076 = ext_78069;
                ext_78075 = ext_78068;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_78070, "ext_mem_78070") != 0)
                    return 1;
                ext_78073 = ext_78067;
                ext_78072 = ext_78066;
            } else {
                if (memblock_alloc_device(ctx, &mem_77644, bytes_77643, "mem_77644")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77644, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_59382) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77646, bytes_77643, "mem_77646")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77646, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_59382) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77648, (int64_t) 8, "mem_77648")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78849(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_77625.mem, mem_77648.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77648, "mem_77648") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77647, (int64_t) 8, "mem_77647")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_77647, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77647, "mem_77647") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77650, (int64_t) 1, "mem_77650")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_doublezigpuseq_78855(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77641.mem, ext_mem_77649.mem, mem_77650.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
                    return 1;
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77652, (int64_t) 8, "mem_77652")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78861(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_59382, y_67146, tR_mem_77625.mem, mem_77641.mem, mem_77650.mem, mem_77652.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77652, "mem_77652") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77651, (int64_t) 8, "mem_77651")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_77651, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77651, "mem_77651") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_67161;
                int64_t defunc_0_windowed_partitionFunc_res_67162;
                bool loop_while_67165;
                int64_t p_67166;
                
                loop_while_67165 = loop_cond_67143;
                p_67166 = (int64_t) 0;
                while (loop_while_67165) {
                    int64_t start_67169 = mul64(partitionsPerWindow_59388, p_67166);
                    int64_t end_67170 = add64(partitionsPerWindow_59388, start_67169);
                    int64_t max_res_67171 = smax64((int64_t) 1, start_67169);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172 = sub64(end_67170, max_res_67171);
                    bool bounds_invalid_upwards_67173 = slt64(end_67170, max_res_67171);
                    bool valid_67174 = !bounds_invalid_upwards_67173;
                    bool range_valid_c_67175;
                    
                    if (!valid_67174) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_67171, "..<", (long long) end_67170, " is invalid.", "-> #0  ftsort.fut:288:43-68\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_67178 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 == (int64_t) 0;
                    bool nonzzero_67179 = !zzero_67178;
                    bool nonzzero_cert_67180;
                    
                    if (!nonzzero_67179) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:291:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_77661 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool cond_67381 = slt64((int64_t) 0, start_67169);
                    int64_t conc_tmp_67382 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    int64_t ret_67383;
                    
                    if (cond_67381) {
                        ret_67383 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    } else {
                        ret_67383 = conc_tmp_67382;
                    }
                    
                    bool eq_x_y_67391 = partitionsPerWindow_59388 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool eq_x_zz_67392 = partitionsPerWindow_59388 == conc_tmp_67382;
                    bool p_and_eq_x_y_67393 = cond_67381 && eq_x_y_67391;
                    bool not_p_67394 = !cond_67381;
                    bool p_and_eq_x_y_67395 = eq_x_zz_67392 && not_p_67394;
                    bool dim_match_67396 = p_and_eq_x_y_67393 || p_and_eq_x_y_67395;
                    bool empty_or_match_cert_67397;
                    
                    if (!dim_match_67396) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_67383, "] cannot match shape of type `[", (long long) partitionsPerWindow_59388, "](i64, i64)`.", "-> #0  ftsort.fut:352:5-357:49\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_67399 = add64(m_67145, start_67169);
                    bool zzero_leq_i_p_m_t_s_67400 = sle64((int64_t) 0, i_p_m_t_s_67399);
                    bool i_p_m_t_s_leq_w_67401 = slt64(i_p_m_t_s_67399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool zzero_lte_i_67402 = sle64((int64_t) 0, start_67169);
                    bool i_lte_j_67403 = sle64(start_67169, end_67170);
                    bool y_67404 = i_p_m_t_s_leq_w_67401 && zzero_lte_i_67402;
                    bool y_67405 = zzero_leq_i_p_m_t_s_67400 && y_67404;
                    bool forwards_ok_67406 = i_lte_j_67403 && y_67405;
                    bool ok_or_empty_67407 = empty_slice_67144 || forwards_ok_67406;
                    bool index_certs_67408;
                    
                    if (!ok_or_empty_67407) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67169, ":", (long long) end_67170, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:109:37-74\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_67177 = add64(nR_59382, nR_59382);
                    int64_t segmap_usable_groups_75119 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_75118);
                    
                    if (memblock_alloc_device(ctx, &mem_77662, bytes_77661, "mem_77662")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_77664, bytes_77661, "mem_77664")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_78871 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_75118));
                    
                    {
                        err = gpu_kernel_inner_SMJ_doublezisegmap_75123(ctx, segmap_usable_groups_75119, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_74911, 1, 1, (int64_t) 0, nR_59382, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, max_res_67171, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, zt_rhs_67177, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77653.mem, mem_77662.mem, mem_77664.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_77666 = (int64_t) 8 * ret_67383;
                    
                    if (cond_67381) {
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77662, "mem_77662") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77664, "mem_77664") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77669, bytes_77666, "mem_77669")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_77669, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_77667, bytes_77666, "mem_77667")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_78892 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77662.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        
                        int64_t tmp_offs_78893 = (int64_t) 0;
                        
                        if (!(tmp_offs_78893 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_78893 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77664.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78893 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77667, "mem_77667") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77669, "mem_77669") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
                        return 1;
                    
                    int64_t tmp_67398 = add64((int64_t) 1, p_67166);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77644.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77671.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77646.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77670.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
                        return 1;
                    
                    bool loop_cond_67411 = slt64(tmp_67398, numberOfWindows_59389);
                    bool loop_while_tmp_78867 = loop_cond_67411;
                    int64_t p_tmp_78868 = tmp_67398;
                    
                    loop_while_67165 = loop_while_tmp_78867;
                    p_67166 = p_tmp_78868;
                }
                defunc_0_windowed_partitionFunc_res_67161 = loop_while_67165;
                defunc_0_windowed_partitionFunc_res_67162 = p_67166;
                if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_77680, bytes_77643, "mem_77680")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77682, bytes_77643, "mem_77682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_78894 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_75492));
                
                {
                    err = gpu_kernel_inner_SMJ_doublezisegmap_75497(ctx, segmap_usable_groups_75493, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75328, 1, 1, (int64_t) 0, nR_59382, gt_rhs_66981, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zeze_rhs_67414, tR_mem_77625.mem, tS_mem_77626.mem, mem_77644.mem, mem_77646.mem, mem_77680.mem, mem_77682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_77904;
                int64_t ext_77903;
                int64_t ext_77902;
                int64_t ext_77901;
                bool defunc_0_join_chunks_res_67570;
                int64_t defunc_0_join_chunks_res_67571;
                bool loop_while_67574;
                int64_t p_67575;
                int64_t ctx_param_ext_77683;
                int64_t ctx_param_ext_77684;
                int64_t ctx_param_ext_77686;
                int64_t ctx_param_ext_77687;
                
                if (memblock_set_device(ctx, &mem_param_77685, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77688, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77683 = (int64_t) 0;
                ctx_param_ext_77684 = (int64_t) 1;
                ctx_param_ext_77686 = (int64_t) 0;
                ctx_param_ext_77687 = (int64_t) 1;
                loop_while_67574 = loop_cond_67569;
                p_67575 = (int64_t) 0;
                while (loop_while_67574) {
                    bool x_67578 = sle64((int64_t) 0, p_67575);
                    bool y_67579 = slt64(p_67575, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67580 = x_67578 && y_67579;
                    bool index_certs_67581;
                    
                    if (!bounds_check_67580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:187:22-34\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_79526;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79526, mem_77680.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67582 = read_res_79526;
                    int64_t read_res_79527;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79527, mem_77682.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67583 = read_res_79527;
                    int64_t min_res_67584 = smin64(zeze_rhs_67414, loopres_67583);
                    bool cond_67585 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, loopres_67582);
                    bool cond_67589 = slt64(min_res_67584, (int64_t) 0);
                    bool protect_assert_disj_67591 = bounds_check_67580 || cond_67589;
                    bool protect_assert_disj_78297 = cond_67585 || protect_assert_disj_67591;
                    bool index_certs_67592;
                    
                    if (!protect_assert_disj_78297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:191:19-32\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_67595 = add64((int64_t) 1, p_67575);
                    bool cond_67596 = zeze_lhs_67595 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    bool x_67598 = sle64((int64_t) 0, zeze_lhs_67595);
                    bool y_67599 = slt64(zeze_lhs_67595, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67600 = x_67598 && y_67599;
                    bool protect_assert_disj_67601 = cond_67596 || bounds_check_67600;
                    bool protect_assert_disj_67602 = cond_67589 || protect_assert_disj_67601;
                    bool protect_assert_disj_78300 = cond_67585 || protect_assert_disj_67602;
                    bool index_certs_67603;
                    
                    if (!protect_assert_disj_78300) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67595, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:192:49-64\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_78294 = !cond_67585;
                    bool x_67590 = !cond_67589;
                    bool protect_cond_conj_78298 = x_67590 && x_78294;
                    int64_t loopres_f_res_f_res_67593;
                    
                    if (protect_cond_conj_78298) {
                        int64_t read_res_79528;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79528, mem_77644.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68863 = read_res_79528;
                        
                        loopres_f_res_f_res_67593 = x_68863;
                    } else {
                        loopres_f_res_f_res_67593 = (int64_t) 0;
                    }
                    
                    bool x_67597 = !cond_67596;
                    bool protect_cond_conj_67604 = x_67590 && x_67597;
                    bool protect_cond_conj_78301 = protect_cond_conj_67604 && x_78294;
                    int64_t r_end_f_res_67605;
                    
                    if (protect_cond_conj_78301) {
                        int64_t read_res_79529;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79529, mem_77644.mem, zeze_lhs_67595 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68864 = read_res_79529;
                        
                        r_end_f_res_67605 = x_68864;
                    } else {
                        r_end_f_res_67605 = (int64_t) 0;
                    }
                    
                    int64_t r_end_67607;
                    
                    if (cond_67596) {
                        r_end_67607 = nR_59382;
                    } else {
                        r_end_67607 = r_end_f_res_67605;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 = sub64(r_end_67607, loopres_f_res_f_res_67593);
                    int64_t ext_77893;
                    
                    if (cond_67589) {
                        ext_77893 = ctx_param_ext_77683;
                    } else {
                        ext_77893 = (int64_t) 0;
                    }
                    
                    int64_t ext_77892;
                    
                    if (cond_67589) {
                        ext_77892 = ctx_param_ext_77684;
                    } else {
                        ext_77892 = (int64_t) 1;
                    }
                    
                    int64_t ext_77890;
                    
                    if (cond_67589) {
                        ext_77890 = ctx_param_ext_77686;
                    } else {
                        ext_77890 = (int64_t) 0;
                    }
                    
                    int64_t ext_77889;
                    
                    if (cond_67589) {
                        ext_77889 = ctx_param_ext_77687;
                    } else {
                        ext_77889 = (int64_t) 1;
                    }
                    
                    int64_t bytes_77689 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;
                    int64_t ext_77899;
                    
                    if (cond_67585) {
                        ext_77899 = ctx_param_ext_77683;
                    } else {
                        ext_77899 = ext_77893;
                    }
                    
                    int64_t ext_77898;
                    
                    if (cond_67585) {
                        ext_77898 = ctx_param_ext_77684;
                    } else {
                        ext_77898 = ext_77892;
                    }
                    
                    int64_t ext_77896;
                    
                    if (cond_67585) {
                        ext_77896 = ctx_param_ext_77686;
                    } else {
                        ext_77896 = ext_77890;
                    }
                    
                    int64_t ext_77895;
                    
                    if (cond_67585) {
                        ext_77895 = ctx_param_ext_77687;
                    } else {
                        ext_77895 = ext_77889;
                    }
                    
                    int64_t loopres_67586;
                    
                    if (cond_67585) {
                        loopres_67586 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    } else {
                        loopres_67586 = zeze_lhs_67595;
                    }
                    if (cond_67585) {
                        if (memblock_set_device(ctx, &ext_mem_77900, &mem_param_77685, "mem_param_77685") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &mem_param_77688, "mem_param_77688") != 0)
                            return 1;
                    } else {
                        if (cond_67589) {
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_param_77685, "mem_param_77685") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_param_77688, "mem_param_77688") != 0)
                                return 1;
                        } else {
                            bool empty_slice_67611 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 == (int64_t) 0;
                            int64_t m_67612 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 1);
                            int64_t i_p_m_t_s_67613 = add64(loopres_f_res_f_res_67593, m_67612);
                            bool zzero_leq_i_p_m_t_s_67614 = sle64((int64_t) 0, i_p_m_t_s_67613);
                            bool i_p_m_t_s_leq_w_67615 = slt64(i_p_m_t_s_67613, nR_59382);
                            bool zzero_lte_i_67616 = sle64((int64_t) 0, loopres_f_res_f_res_67593);
                            bool i_lte_j_67617 = sle64(loopres_f_res_f_res_67593, r_end_67607);
                            bool y_67618 = i_p_m_t_s_leq_w_67615 && zzero_lte_i_67616;
                            bool y_67619 = zzero_leq_i_p_m_t_s_67614 && y_67618;
                            bool forwards_ok_67620 = i_lte_j_67617 && y_67619;
                            bool ok_or_empty_67621 = empty_slice_67611 || forwards_ok_67620;
                            bool index_certs_67622;
                            
                            if (!ok_or_empty_67621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_67593, ":", (long long) r_end_67607, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftSMJ.fut:193:16-33\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_67625 = sle64(loopres_67582, min_res_67584);
                            bool loop_not_taken_67630 = !loop_cond_67625;
                            bool protect_assert_disj_67631 = loop_not_taken_67630 || nonzzero_68535;
                            bool nonzzero_cert_67632;
                            
                            if (!protect_assert_disj_67631) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77690, bytes_77689, "mem_77690")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77692, bytes_77689, "mem_77692")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77692, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_67626 = add64(extParallelism_59390, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                            int64_t zs_lhs_67627 = sub64(zm_lhs_67626, (int64_t) 1);
                            int64_t numIter_67633 = sdiv_safe64(zs_lhs_67627, extParallelism_59390);
                            bool loop_cond_67634 = slt64((int64_t) 0, numIter_67633);
                            bool loop_not_taken_67635 = !loop_cond_67634;
                            int64_t segmap_tblock_sizze_75845;
                            
                            segmap_tblock_sizze_75845 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75835;
                            
                            int64_t segmap_usable_groups_75846 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75845);
                            int64_t segmap_tblock_sizze_75866;
                            
                            segmap_tblock_sizze_75866 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75857;
                            
                            int64_t segmap_usable_groups_75867 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75866);
                            
                            if (memblock_alloc_device(ctx, &mem_77711, (int64_t) 8, "mem_77711")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77712, (int64_t) 8, "mem_77712")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77715, (int64_t) 1, "mem_77715")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_67636;
                            int64_t loopres_f_res_f_res_67637;
                            bool loop_while_67640;
                            int64_t dp_67641;
                            
                            if (memblock_set_device(ctx, &mem_param_77695, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_77698, &mem_77690, "mem_77690") != 0)
                                return 1;
                            loop_while_67640 = loop_cond_67625;
                            dp_67641 = loopres_67582;
                            while (loop_while_67640) {
                                bool x_67644 = sle64((int64_t) 0, dp_67641);
                                bool y_67645 = slt64(dp_67641, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67646 = x_67644 && y_67645;
                                bool index_certs_67647;
                                
                                if (!bounds_check_67646) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_67641, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:197:21-38\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_79530;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_79530, mem_77646.mem, dp_67641 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_67648 = read_res_79530;
                                int64_t zeze_lhs_67649 = add64((int64_t) 1, dp_67641);
                                bool cond_67650 = zeze_lhs_67649 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                                bool x_67651 = !cond_67650;
                                bool x_67652 = sle64((int64_t) 0, zeze_lhs_67649);
                                bool y_67653 = slt64(zeze_lhs_67649, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67654 = x_67652 && y_67653;
                                bool protect_assert_disj_67655 = cond_67650 || bounds_check_67654;
                                bool index_certs_67656;
                                
                                if (!protect_assert_disj_67655) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67649, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:198:55-74\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_67657;
                                
                                if (x_67651) {
                                    int64_t read_res_79531;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79531, mem_77646.mem, zeze_lhs_67649 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_68865 = read_res_79531;
                                    
                                    s_end_f_res_67657 = x_68865;
                                } else {
                                    s_end_f_res_67657 = (int64_t) 0;
                                }
                                
                                int64_t s_end_67659;
                                
                                if (cond_67650) {
                                    s_end_67659 = nR_59382;
                                } else {
                                    s_end_67659 = s_end_f_res_67657;
                                }
                                
                                int64_t j_m_i_67660 = sub64(s_end_67659, loopres_67648);
                                bool empty_slice_67661 = j_m_i_67660 == (int64_t) 0;
                                int64_t m_67662 = sub64(j_m_i_67660, (int64_t) 1);
                                int64_t i_p_m_t_s_67663 = add64(loopres_67648, m_67662);
                                bool zzero_leq_i_p_m_t_s_67664 = sle64((int64_t) 0, i_p_m_t_s_67663);
                                bool i_p_m_t_s_leq_w_67665 = slt64(i_p_m_t_s_67663, nR_59382);
                                bool zzero_lte_i_67666 = sle64((int64_t) 0, loopres_67648);
                                bool i_lte_j_67667 = sle64(loopres_67648, s_end_67659);
                                bool y_67668 = i_p_m_t_s_leq_w_67665 && zzero_lte_i_67666;
                                bool y_67669 = zzero_leq_i_p_m_t_s_67664 && y_67668;
                                bool forwards_ok_67670 = i_lte_j_67667 && y_67669;
                                bool ok_or_empty_67671 = empty_slice_67661 || forwards_ok_67670;
                                bool index_certs_67672;
                                
                                if (!ok_or_empty_67671) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_67648, ":", (long long) s_end_67659, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  ftSMJ.fut:199:18-35\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_67675 = slt64((int64_t) 0, j_m_i_67660);
                                bool loop_not_taken_67676 = !cond_67675;
                                bool x_67677 = sle64((int64_t) 0, m_67662);
                                bool y_67678 = slt64(m_67662, j_m_i_67660);
                                bool bounds_check_67682 = x_67677 && y_67678;
                                bool protect_assert_disj_67683 = loop_not_taken_67676 || bounds_check_67682;
                                bool protect_assert_disj_67684 = loop_not_taken_67635 || protect_assert_disj_67683;
                                bool index_certs_67685;
                                
                                if (!protect_assert_disj_67684) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67662, "] out of bounds for array of shape [", (long long) j_m_i_67660, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_68069 = tS_start_66998 + loopres_67648;
                                int64_t find_joinTuples_arg3_67674 = add64(join_chunks_arg3_67139, loopres_67648);
                                bool protect_cond_conj_67679 = loop_cond_67634 && cond_67675;
                                
                                if (protect_cond_conj_67679) {
                                    if (memblock_alloc_device(ctx, &mem_77700, (int64_t) 8, "mem_77700")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78923(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68069, tS_mem_77626.mem, mem_77700.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77700, "mem_77700") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77699, (int64_t) 8, "mem_77699")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f64(ctx, mem_77699, (int64_t) 1, 0.0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77699, "mem_77699") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_67679) {
                                    int64_t slice_68867 = tS_start_66998 + i_p_m_t_s_67663;
                                    
                                    if (memblock_alloc_device(ctx, &mem_77703, (int64_t) 8, "mem_77703")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78929(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68867, tS_mem_77626.mem, mem_77703.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77703, "mem_77703") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77702, (int64_t) 8, "mem_77702")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f64(ctx, mem_77702, (int64_t) 1, 0.0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77702, "mem_77702") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_77717 = (int64_t) 8 * j_m_i_67660;
                                int64_t ext_77864;
                                int64_t ext_77863;
                                int64_t ext_77862;
                                int64_t ext_77861;
                                bool defunc_0_find_joinTuples_res_67688;
                                int64_t defunc_0_find_joinTuples_res_67689;
                                bool loop_while_67692;
                                int64_t p_67693;
                                int64_t ctx_param_ext_77705;
                                int64_t ctx_param_ext_77706;
                                int64_t ctx_param_ext_77708;
                                int64_t ctx_param_ext_77709;
                                
                                if (memblock_set_device(ctx, &mem_param_77707, &mem_77692, "mem_77692") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77710, &mem_77690, "mem_77690") != 0)
                                    return 1;
                                ctx_param_ext_77705 = (int64_t) 0;
                                ctx_param_ext_77706 = (int64_t) 1;
                                ctx_param_ext_77708 = (int64_t) 0;
                                ctx_param_ext_77709 = (int64_t) 1;
                                loop_while_67692 = loop_cond_67634;
                                p_67693 = (int64_t) 0;
                                while (loop_while_67692) {
                                    int64_t start_67696 = mul64(extParallelism_59390, p_67693);
                                    int64_t min_arg1_67697 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, start_67696);
                                    int64_t min_res_67698 = smin64(extParallelism_59390, min_arg1_67697);
                                    int64_t iter_R_67699 = add64(start_67696, min_res_67698);
                                    bool empty_slice_67700 = min_res_67698 == (int64_t) 0;
                                    int64_t m_67701 = sub64(min_res_67698, (int64_t) 1);
                                    int64_t i_p_m_t_s_67702 = add64(start_67696, m_67701);
                                    bool zzero_leq_i_p_m_t_s_67703 = sle64((int64_t) 0, i_p_m_t_s_67702);
                                    bool i_p_m_t_s_leq_w_67704 = slt64(i_p_m_t_s_67702, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                                    bool zzero_lte_i_67705 = sle64((int64_t) 0, start_67696);
                                    bool i_lte_j_67706 = sle64(start_67696, iter_R_67699);
                                    bool y_67707 = i_p_m_t_s_leq_w_67704 && zzero_lte_i_67705;
                                    bool y_67708 = zzero_leq_i_p_m_t_s_67703 && y_67707;
                                    bool forwards_ok_67709 = i_lte_j_67706 && y_67708;
                                    bool ok_or_empty_67710 = empty_slice_67700 || forwards_ok_67709;
                                    bool index_certs_67711;
                                    
                                    if (!ok_or_empty_67710) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67696, ":", (long long) iter_R_67699, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67718 = slt64(m_67701, min_res_67698);
                                    bool x_67717 = sle64((int64_t) 0, m_67701);
                                    bool bounds_check_67719 = x_67717 && y_67718;
                                    bool index_certs_67720;
                                    
                                    if (!bounds_check_67719) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67701, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67714 = slt64((int64_t) 0, min_res_67698);
                                    bool index_certs_67715;
                                    
                                    if (!y_67714) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:403:133-136\n   #2  ftSMJ.fut:392:1-403:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_67712 = loopres_f_res_f_res_67593 + start_67696;
                                    int64_t slice_67721 = loopres_f_res_f_res_67593 + i_p_m_t_s_67702;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78945(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_67712, slice_67721, tR_mem_77625.mem, mem_77711.mem, mem_77712.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77713, &ext_mem_77704, "ext_mem_77704") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77713, &mem_77711, "mem_77711") != 0)
                                        return 1;
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77714, &ext_mem_77701, "ext_mem_77701") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77714, &mem_77712, "mem_77712") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_78951(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77712.mem, ext_mem_77713.mem, mem_77715.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
                                        return 1;
                                    
                                    bool read_res_79532;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79532, mem_77715.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_67725 = read_res_79532;
                                    int64_t ext_77859;
                                    int64_t ext_77858;
                                    int64_t ext_77856;
                                    int64_t ext_77855;
                                    int64_t loopres_67726;
                                    
                                    if (defunc_0_gt_res_67725) {
                                        if (memblock_set_device(ctx, &ext_mem_77860, &mem_param_77707, "mem_param_77707") != 0)
                                            return 1;
                                        ext_77859 = ctx_param_ext_77705;
                                        ext_77858 = ctx_param_ext_77706;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &mem_param_77710, "mem_param_77710") != 0)
                                            return 1;
                                        ext_77856 = ctx_param_ext_77708;
                                        ext_77855 = ctx_param_ext_77709;
                                        loopres_67726 = numIter_67633;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_77716, (int64_t) 1, "mem_77716")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_doublezigpuseq_78957(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77711.mem, ext_mem_77714.mem, mem_77716.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_79533;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_79533, mem_77716.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_67729 = read_res_79533;
                                        
                                        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
                                            return 1;
                                        
                                        int64_t ext_77853;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77853 = ctx_param_ext_77705;
                                        } else {
                                            ext_77853 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77852;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77852 = ctx_param_ext_77706;
                                        } else {
                                            ext_77852 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_77850;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77850 = ctx_param_ext_77708;
                                        } else {
                                            ext_77850 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77849;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77849 = ctx_param_ext_77709;
                                        } else {
                                            ext_77849 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_67730;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            int64_t tmp_68871 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_param_77707, "mem_param_77707") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_param_77710, "mem_param_77710") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_68871;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_77718, bytes_77717, "mem_77718")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77718.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, slice_68069, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67660})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_10056(ctx, &ext_mem_77720, mem_77718, j_m_i_67660, find_joinTuples_arg3_67674) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_75657;
                                            
                                            suff_outer_par_75657 = *ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_1 <= min_res_67698;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_double.suff_outer_par_1", (long) min_res_67698, suff_outer_par_75657 ? "true" : "false");
                                            
                                            int64_t tile_sizze_77124;
                                            
                                            tile_sizze_77124 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123;
                                            
                                            int64_t tile_sizze_76769;
                                            
                                            tile_sizze_76769 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768;
                                            
                                            int64_t num_whole_tiles_77140 = squot_safe64(j_m_i_67660, tile_sizze_77124);
                                            int64_t residual_input_77364 = srem_safe64(j_m_i_67660, tile_sizze_77124);
                                            bool cond_77365 = residual_input_77364 == (int64_t) 0;
                                            int64_t binop_x_77381 = tile_sizze_77124 * num_whole_tiles_77140;
                                            int64_t bytes_77778 = (int64_t) 8 * min_res_67698;
                                            int64_t bytes_77741 = (int64_t) 8 * tile_sizze_77124;
                                            int64_t num_whole_tiles_76785 = squot_safe64(j_m_i_67660, tile_sizze_76769);
                                            int64_t residual_input_77009 = srem_safe64(j_m_i_67660, tile_sizze_76769);
                                            bool cond_77010 = residual_input_77009 == (int64_t) 0;
                                            int64_t binop_x_77026 = tile_sizze_76769 * num_whole_tiles_76785;
                                            int64_t bytes_77802 = (int64_t) 8 * tile_sizze_76769;
                                            int64_t shared_memory_capacity_79015;
                                            
                                            shared_memory_capacity_79015 = ctx->max_shared_memory;
                                            if (suff_outer_par_75657 && sle64(sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_79015)) {
                                                int64_t ldim_76770 = sdiv_up64(min_res_67698, tile_sizze_76769);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77840, bytes_77778, "mem_77840")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77842, bytes_77778, "mem_77842")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78963 = sext_i64_i32(sdiv_up64(tile_sizze_76769, tile_sizze_76769));
                                                int32_t virt_num_tblocks_78964 = sext_i64_i32(ldim_76770);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_76767(ctx, ldim_76770, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_76768, 1, 1, bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_76770, num_whole_tiles_76785, residual_input_77009, cond_77010, binop_x_77026, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77840.mem, mem_77842.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77840, "mem_77840") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77842, "mem_77842") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_77125 = sdiv_up64(min_res_67698, tile_sizze_77124);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77779, bytes_77778, "mem_77779")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77781, bytes_77778, "mem_77781")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78989 = sext_i64_i32(sdiv_up64(tile_sizze_77124, tile_sizze_77124));
                                                int32_t virt_num_tblocks_78990 = sext_i64_i32(ldim_77125);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_77122(ctx, ldim_77125, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_77123, 1, 1, bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_77125, num_whole_tiles_77140, residual_input_77364, cond_77365, binop_x_77381, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77779.mem, mem_77781.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77779, "mem_77779") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77781, "mem_77781") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77846, bytes_77689, "mem_77846")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77710.mem, ctx_param_ext_77708, (int64_t []) {ctx_param_ext_77709}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77848, bytes_77689, "mem_77848")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77707.mem, ctx_param_ext_77705, (int64_t []) {ctx_param_ext_77706}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77843.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
                                                return 1;
                                            
                                            int64_t tmp_67777 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_77848, "mem_77848") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_77846, "mem_77846") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_67777;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_77860, &ext_mem_77854, "ext_mem_77854") != 0)
                                            return 1;
                                        ext_77859 = ext_77853;
                                        ext_77858 = ext_77852;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &ext_mem_77851, "ext_mem_77851") != 0)
                                            return 1;
                                        ext_77856 = ext_77850;
                                        ext_77855 = ext_77849;
                                        loopres_67726 = loopres_f_res_67730;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
                                        return 1;
                                    
                                    bool loop_cond_67778 = slt64(loopres_67726, numIter_67633);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_78935, &ext_mem_77860, "ext_mem_77860") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_78936, &ext_mem_77857, "ext_mem_77857") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_78937 = ext_77859;
                                    int64_t ctx_param_ext_tmp_78938 = ext_77858;
                                    int64_t ctx_param_ext_tmp_78939 = ext_77856;
                                    int64_t ctx_param_ext_tmp_78940 = ext_77855;
                                    bool loop_while_tmp_78941 = loop_cond_67778;
                                    int64_t p_tmp_78942 = loopres_67726;
                                    
                                    if (memblock_set_device(ctx, &mem_param_77707, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_77710, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
                                        return 1;
                                    ctx_param_ext_77705 = ctx_param_ext_tmp_78937;
                                    ctx_param_ext_77706 = ctx_param_ext_tmp_78938;
                                    ctx_param_ext_77708 = ctx_param_ext_tmp_78939;
                                    ctx_param_ext_77709 = ctx_param_ext_tmp_78940;
                                    loop_while_67692 = loop_while_tmp_78941;
                                    p_67693 = p_tmp_78942;
                                }
                                if (memblock_set_device(ctx, &ext_mem_77866, &mem_param_77707, "mem_param_77707") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_77865, &mem_param_77710, "mem_param_77710") != 0)
                                    return 1;
                                ext_77864 = ctx_param_ext_77705;
                                ext_77863 = ctx_param_ext_77706;
                                ext_77862 = ctx_param_ext_77708;
                                ext_77861 = ctx_param_ext_77709;
                                defunc_0_find_joinTuples_res_67688 = loop_while_67692;
                                defunc_0_find_joinTuples_res_67689 = p_67693;
                                if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77869, bytes_77689, "mem_77869")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79016 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75845));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_75849(ctx, segmap_usable_groups_75846, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75835, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77861, ext_77862, mem_param_77698.mem, ext_mem_77865.mem, mem_77869.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77872, bytes_77689, "mem_77872")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79025 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75866));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_75870(ctx, segmap_usable_groups_75867, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75857, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77863, ext_77864, mem_param_77695.mem, ext_mem_77866.mem, mem_77872.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
                                    return 1;
                                
                                bool loop_cond_67788 = sle64(zeze_lhs_67649, min_res_67584);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_78917, &mem_77872, "mem_77872") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_78918, &mem_77869, "mem_77869") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_78919 = loop_cond_67788;
                                int64_t dp_tmp_78920 = zeze_lhs_67649;
                                
                                if (memblock_set_device(ctx, &mem_param_77695, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77698, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
                                    return 1;
                                loop_while_67640 = loop_while_tmp_78919;
                                dp_67641 = dp_tmp_78920;
                            }
                            if (memblock_set_device(ctx, &ext_mem_77878, &mem_param_77695, "mem_param_77695") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77877, &mem_param_77698, "mem_param_77698") != 0)
                                return 1;
                            loopres_f_res_f_res_67636 = loop_while_67640;
                            loopres_f_res_f_res_67637 = dp_67641;
                            if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_75887;
                            
                            segmap_tblock_sizze_75887 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75877;
                            
                            int64_t segmap_usable_groups_75888 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75887);
                            
                            if (memblock_alloc_device(ctx, &mem_77881, bytes_77689, "mem_77881")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79034 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75887));
                            
                            {
                                err = gpu_kernel_inner_SMJ_doublezisegmap_75891(ctx, segmap_usable_groups_75888, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75877, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77686, ctx_param_ext_77687, mem_param_77688.mem, ext_mem_77877.mem, mem_77881.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_75908;
                            
                            segmap_tblock_sizze_75908 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75899;
                            
                            int64_t segmap_usable_groups_75909 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75908);
                            
                            if (memblock_alloc_device(ctx, &mem_77884, bytes_77689, "mem_77884")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79043 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_75908));
                            
                            {
                                err = gpu_kernel_inner_SMJ_doublezisegmap_75912(ctx, segmap_usable_groups_75909, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75899, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77683, ctx_param_ext_77684, mem_param_77685.mem, ext_mem_77878.mem, mem_77884.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77886, bytes_77628, "mem_77886")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77688.mem, ctx_param_ext_77686, (int64_t []) {ctx_param_ext_77687}, (int64_t []) {nR_59382})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77881.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77888, bytes_77628, "mem_77888")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77685.mem, ctx_param_ext_77683, (int64_t []) {ctx_param_ext_77684}, (int64_t []) {nR_59382})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77884.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_77888, "mem_77888") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_77886, "mem_77886") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_77900, &ext_mem_77894, "ext_mem_77894") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &ext_mem_77891, "ext_mem_77891") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_67804 = slt64(loopres_67586, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78907, &ext_mem_77900, "ext_mem_77900") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78908, &ext_mem_77897, "ext_mem_77897") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78909 = ext_77899;
                    int64_t ctx_param_ext_tmp_78910 = ext_77898;
                    int64_t ctx_param_ext_tmp_78911 = ext_77896;
                    int64_t ctx_param_ext_tmp_78912 = ext_77895;
                    bool loop_while_tmp_78913 = loop_cond_67804;
                    int64_t p_tmp_78914 = loopres_67586;
                    
                    if (memblock_set_device(ctx, &mem_param_77685, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77688, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
                        return 1;
                    ctx_param_ext_77683 = ctx_param_ext_tmp_78909;
                    ctx_param_ext_77684 = ctx_param_ext_tmp_78910;
                    ctx_param_ext_77686 = ctx_param_ext_tmp_78911;
                    ctx_param_ext_77687 = ctx_param_ext_tmp_78912;
                    loop_while_67574 = loop_while_tmp_78913;
                    p_67575 = p_tmp_78914;
                }
                if (memblock_set_device(ctx, &ext_mem_77906, &mem_param_77685, "mem_param_77685") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_77905, &mem_param_77688, "mem_param_77688") != 0)
                    return 1;
                ext_77904 = ctx_param_ext_77683;
                ext_77903 = ctx_param_ext_77684;
                ext_77902 = ctx_param_ext_77686;
                ext_77901 = ctx_param_ext_77687;
                defunc_0_join_chunks_res_67570 = loop_while_67574;
                defunc_0_join_chunks_res_67571 = p_67575;
                if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_77906, "ext_mem_77906") != 0)
                    return 1;
                ext_78076 = ext_77904;
                ext_78075 = ext_77903;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_77905, "ext_mem_77905") != 0)
                    return 1;
                ext_78073 = ext_77902;
                ext_78072 = ext_77901;
            }
            
            int64_t segmap_tblock_sizze_75929;
            
            segmap_tblock_sizze_75929 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75919;
            
            int64_t segmap_usable_groups_75930 = sdiv_up64(nR_59382, segmap_tblock_sizze_75929);
            
            if (memblock_alloc_device(ctx, &mem_78080, bytes_77628, "mem_78080")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79052 = sext_i64_i32(sdiv_up64(nR_59382, segmap_tblock_sizze_75929));
            
            {
                err = gpu_kernel_inner_SMJ_doublezisegmap_75933(ctx, segmap_usable_groups_75930, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75919, 1, 1, (int64_t) 0, nR_59382, ext_78072, ext_78073, mem_param_77640.mem, ext_mem_78074.mem, mem_78080.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_75950;
            
            segmap_tblock_sizze_75950 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75941;
            
            int64_t segmap_usable_groups_75951 = sdiv_up64(nR_59382, segmap_tblock_sizze_75950);
            
            if (memblock_alloc_device(ctx, &mem_78083, bytes_77628, "mem_78083")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79061 = sext_i64_i32(sdiv_up64(nR_59382, segmap_tblock_sizze_75950));
            
            {
                err = gpu_kernel_inner_SMJ_doublezisegmap_75954(ctx, segmap_usable_groups_75951, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75941, 1, 1, (int64_t) 0, nR_59382, ext_78075, ext_78076, mem_param_77637.mem, ext_mem_78077.mem, mem_78083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_78084, (int64_t) 1, "mem_78084")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_doublezigpuseq_79070(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, i_p_m_t_s_67004, tR_mem_77625.mem, tS_mem_77626.mem, mem_78084.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_79534;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_79534, mem_78084.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_67821 = read_res_79534;
            
            if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
                return 1;
            
            int64_t nextIter_67822;
            
            if (defunc_0_leq_res_67821) {
                int64_t nextIter_t_res_68886 = add64((int64_t) 1, p_66995);
                
                nextIter_67822 = nextIter_t_res_68886;
            } else {
                nextIter_67822 = numIter_66975;
            }
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_78083, "mem_78083") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_78080, "mem_78080") != 0)
                return 1;
            loopres_67019 = nextIter_67822;
        }
        
        bool loop_cond_67824 = slt64(loopres_67019, numIter_66975);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78750, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78751, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        
        bool loop_while_tmp_78752 = loop_cond_67824;
        int64_t p_tmp_78753 = loopres_67019;
        
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77640, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        loop_while_66994 = loop_while_tmp_78752;
        p_66995 = p_tmp_78753;
    }
    if (memblock_set_device(ctx, &ext_mem_78096, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78095, &mem_param_77640, "mem_param_77640") != 0)
        return 1;
    defunc_0_mergeJoin_res_66990 = loop_while_66994;
    defunc_0_mergeJoin_res_66991 = p_66995;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_75960;
    
    segscan_tblock_sizze_75960 = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75959;
    
    int64_t num_tblocks_75962;
    int64_t max_num_tblocks_79076;
    
    max_num_tblocks_79076 = *ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_75961;
    num_tblocks_75962 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_59382, segscan_tblock_sizze_75960), max_num_tblocks_79076)));
    if (memblock_alloc_device(ctx, &mem_78099, bytes_77628, "mem_78099")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78101, bytes_77628, "mem_78101")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_59382)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79077;
        
        shared_memory_79077 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79078;
        
        thread_block_sizze_79078 = ctx->max_thread_block_size;
        
        int64_t registers_79079;
        
        registers_79079 = ctx->max_registers;
        
        int64_t thread_block_sizze_79080;
        
        thread_block_sizze_79080 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79081 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79077, thread_block_sizze_79078), (int64_t) 8), squot64(squot64(registers_79079, thread_block_sizze_79080) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79082 = sdiv_up64(nR_59382, segscan_tblock_sizze_75960 * chunk_sizze_79081);
        int64_t num_virt_threads_79083 = num_virt_blocks_79082 * segscan_tblock_sizze_75960;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79081, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79084, num_virt_blocks_79082, "status_flags_mem_79084")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79084, num_virt_blocks_79082, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79106, (int64_t) 8 * num_virt_blocks_79082, "aggregates_mem_79106")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79108, (int64_t) 8 * num_virt_blocks_79082, "incprefixes_mem_79108")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezisegscan_75965(ctx, num_tblocks_75962, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75959, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75960), chunk_sizze_79081 * segscan_tblock_sizze_75960 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75960), chunk_sizze_79081 * segscan_tblock_sizze_75960 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_59382, num_tblocks_75962, num_virt_blocks_79082, num_virt_threads_79083, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, status_flags_mem_79084.mem, aggregates_mem_79106.mem, incprefixes_mem_79108.mem, global_dynid_mem_79110.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_67840 = zzero_66972 || bounds_check_66984;
    bool index_certs_67841;
    
    if (!protect_assert_disj_67840) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67842;
    
    if (nonzzero_66973) {
        int64_t read_res_79535;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79535, mem_78099.mem, gt_rhs_66981 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68889 = read_res_79535;
        
        m_f_res_67842 = x_68889;
    } else {
        m_f_res_67842 = (int64_t) 0;
    }
    
    int64_t m_67844;
    
    if (zzero_66972) {
        m_67844 = (int64_t) 0;
    } else {
        m_67844 = m_f_res_67842;
    }
    
    int64_t m_67854 = sub64(m_67844, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67856 = slt64(m_67854, nR_59382);
    bool zzero_leq_i_p_m_t_s_67855 = sle64((int64_t) 0, m_67854);
    bool y_67858 = zzero_leq_i_p_m_t_s_67855 && i_p_m_t_s_leq_w_67856;
    bool i_lte_j_67857 = sle64((int64_t) 0, m_67844);
    bool forwards_ok_67859 = i_lte_j_67857 && y_67858;
    bool eq_x_zz_67851 = (int64_t) 0 == m_f_res_67842;
    bool p_and_eq_x_y_67852 = nonzzero_66973 && eq_x_zz_67851;
    bool empty_slice_67853 = zzero_66972 || p_and_eq_x_y_67852;
    bool ok_or_empty_67860 = empty_slice_67853 || forwards_ok_67859;
    bool index_certs_67861;
    
    if (!ok_or_empty_67860) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67844, "] out of bounds for array of shape [", (long long) nR_59382, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78102 = (int64_t) 8 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78103, bytes_78102, "mem_78103")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78096.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78105, bytes_78102, "mem_78105")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78095.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78107, bytes_78102, "mem_78107")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78107.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78109, bytes_78102, "mem_78109")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78109.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_77625.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_75970;
    
    segmap_tblock_sizze_75970 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75969;
    
    int64_t num_tblocks_75972;
    int64_t max_num_tblocks_79219;
    
    max_num_tblocks_79219 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_75971;
    num_tblocks_75972 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_59382, segmap_tblock_sizze_75970), max_num_tblocks_79219)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79220 = sext_i64_i32(sdiv_up64(nR_59382, segmap_tblock_sizze_75970));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_75967(ctx, num_tblocks_75972, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75969, 1, 1, (int64_t) 0, nR_59382, m_67844, num_tblocks_75972, virt_num_tblocks_79220, tR_mem_77625.mem, ext_mem_77627.mem, ext_mem_78095.mem, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, mem_78103.mem, mem_78105.mem, mem_78107.mem, mem_78109.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_75976;
    
    segscan_tblock_sizze_75976 = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75975;
    
    int64_t num_tblocks_75978;
    int64_t max_num_tblocks_79233;
    
    max_num_tblocks_79233 = *ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_75977;
    num_tblocks_75978 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segscan_tblock_sizze_75976), max_num_tblocks_79233)));
    if (memblock_alloc_device(ctx, &mem_78113, bytes_78102, "mem_78113")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78115, bytes_78102, "mem_78115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78117, bytes_78102, "mem_78117")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_67844)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79234;
        
        shared_memory_79234 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79235;
        
        thread_block_sizze_79235 = ctx->max_thread_block_size;
        
        int64_t registers_79236;
        
        registers_79236 = ctx->max_registers;
        
        int64_t thread_block_sizze_79237;
        
        thread_block_sizze_79237 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79238 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79234, thread_block_sizze_79235), (int64_t) 8), squot64(squot64(registers_79236, thread_block_sizze_79237) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79239 = sdiv_up64(m_67844, segscan_tblock_sizze_75976 * chunk_sizze_79238);
        int64_t num_virt_threads_79240 = num_virt_blocks_79239 * segscan_tblock_sizze_75976;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79238, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79241, num_virt_blocks_79239, "status_flags_mem_79241")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79241, num_virt_blocks_79239, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79243, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79243")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79245, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79245")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79247, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79247")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79249, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79249")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezisegscan_75981(ctx, num_tblocks_75978, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_75975, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75976, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75976), smax64(chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75976, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75976), smax64(chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_75976 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_67844, num_tblocks_75978, num_virt_blocks_79239, num_virt_threads_79240, mem_78103.mem, mem_78113.mem, mem_78115.mem, mem_78117.mem, status_flags_mem_79241.mem, aggregates_mem_79243.mem, incprefixes_mem_79245.mem, aggregates_mem_79247.mem, incprefixes_mem_79249.mem, global_dynid_mem_79251.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_75997;
    
    segmap_tblock_sizze_75997 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75985;
    
    int64_t segmap_usable_groups_75998 = sdiv_up64(m_67844, segmap_tblock_sizze_75997);
    
    if (memblock_alloc_device(ctx, &mem_78120, bytes_78102, "mem_78120")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79386 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_75997));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_76001(ctx, segmap_usable_groups_75998, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_75985, 1, 1, (int64_t) 0, m_67844, mem_78113.mem, mem_78120.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
        return 1;
    
    bool cond_67895 = slt64((int64_t) 0, m_67844);
    bool y_67896 = slt64(m_67854, m_67844);
    bool bounds_check_67897 = zzero_leq_i_p_m_t_s_67855 && y_67896;
    bool loop_not_taken_67898 = !cond_67895;
    bool protect_assert_disj_67899 = bounds_check_67897 || loop_not_taken_67898;
    bool index_certs_67900;
    
    if (!protect_assert_disj_67899) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  ftSMJ.fut:285:10-41\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78122, (int64_t) 8, "mem_78122")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_79395(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78120.mem, mem_78122.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78122, "mem_78122") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78121, (int64_t) 8, "mem_78121")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78121, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78121, "mem_78121") != 0)
            return 1;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78125, (int64_t) 8, "mem_78125")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_79401(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78103.mem, mem_78125.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78125, "mem_78125") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78124, (int64_t) 8, "mem_78124")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78124, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78124, "mem_78124") != 0)
            return 1;
    }
    
    bool zzero_67912 = scatter_psizze_59391 == (int64_t) 0;
    bool nonzzero_67913 = !zzero_67912;
    bool nonzzero_cert_67914;
    
    if (!nonzzero_67913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_67979 = !empty_slice_67853;
    bool protect_assert_disj_67980 = empty_slice_67853 || bounds_check_67897;
    bool index_certs_67981;
    
    if (!protect_assert_disj_67980) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67982;
    
    if (x_67979) {
        int64_t read_res_79536;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79536, mem_78115.mem, m_67854 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68897 = read_res_79536;
        
        m_f_res_67982 = x_68897;
    } else {
        m_f_res_67982 = (int64_t) 0;
    }
    
    int64_t m_67984;
    
    if (empty_slice_67853) {
        m_67984 = (int64_t) 0;
    } else {
        m_67984 = m_f_res_67982;
    }
    
    int64_t m_67994 = sub64(m_67984, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67996 = slt64(m_67994, m_67844);
    bool zzero_leq_i_p_m_t_s_67995 = sle64((int64_t) 0, m_67994);
    bool y_67998 = zzero_leq_i_p_m_t_s_67995 && i_p_m_t_s_leq_w_67996;
    bool i_lte_j_67997 = sle64((int64_t) 0, m_67984);
    bool forwards_ok_67999 = i_lte_j_67997 && y_67998;
    bool eq_x_zz_67991 = (int64_t) 0 == m_f_res_67982;
    bool p_and_eq_x_y_67992 = x_67979 && eq_x_zz_67991;
    bool empty_slice_67993 = empty_slice_67853 || p_and_eq_x_y_67992;
    bool ok_or_empty_68000 = empty_slice_67993 || forwards_ok_67999;
    bool index_certs_68001;
    
    if (!ok_or_empty_68000) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67984, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:403:133-136\n   #4  ftSMJ.fut:392:1-403:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78127 = (int64_t) 8 * m_67984;
    
    if (memblock_alloc_device(ctx, &mem_78132, (int64_t) 8, "mem_78132")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_doublezigpuseq_79407(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_78123.mem, ext_mem_78126.mem, mem_78132.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
        return 1;
    
    int64_t n_pairs_t_res_67905;
    
    if (cond_67895) {
        int64_t read_res_79537;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79537, mem_78132.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_77623 = read_res_79537;
        
        n_pairs_t_res_67905 = x_77623;
    } else {
        n_pairs_t_res_67905 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
        return 1;
    
    int64_t n_pairs_67906;
    
    if (cond_67895) {
        n_pairs_67906 = n_pairs_t_res_67905;
    } else {
        n_pairs_67906 = (int64_t) 0;
    }
    
    int64_t bytes_78133 = (int64_t) 8 * n_pairs_67906;
    int64_t segmap_tblock_sizze_76012;
    
    segmap_tblock_sizze_76012 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76011;
    
    int64_t num_tblocks_76014;
    int64_t max_num_tblocks_79413;
    
    max_num_tblocks_79413 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_76013;
    num_tblocks_76014 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_76012), max_num_tblocks_79413)));
    if (memblock_alloc_device(ctx, &mem_78128, bytes_78127, "mem_78128")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78128.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78130, bytes_78127, "mem_78130")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78130.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78120.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_76020;
    
    segmap_tblock_sizze_76020 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76019;
    
    int64_t num_tblocks_76022;
    int64_t max_num_tblocks_79414;
    
    max_num_tblocks_79414 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_76021;
    num_tblocks_76022 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_76020), max_num_tblocks_79414)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79415 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_76020));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_76017(ctx, num_tblocks_76022, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76019, 1, 1, (int64_t) 0, m_67844, m_67984, num_tblocks_76022, virt_num_tblocks_79415, mem_78103.mem, mem_78115.mem, mem_78117.mem, mem_78120.mem, mem_78128.mem, mem_78130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
        return 1;
    
    bool cond_68011 = slt64((int64_t) 0, m_67984);
    int64_t segmap_tblock_sizze_76035;
    
    segmap_tblock_sizze_76035 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76027;
    if (memblock_alloc_device(ctx, &mem_78134, bytes_78133, "mem_78134")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_78134, n_pairs_67906, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78136, bytes_78133, "mem_78136")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78136, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78138, bytes_78133, "mem_78138")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78138, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_67910 = add64(scatter_psizze_59391, n_pairs_67906);
    int64_t zs_lhs_67911 = sub64(zm_lhs_67910, (int64_t) 1);
    int64_t m_67915 = sdiv64(zs_lhs_67911, scatter_psizze_59391);
    bool loop_cond_67916 = slt64((int64_t) 0, m_67915);
    bool partitioned_scatter_res_67917;
    int64_t partitioned_scatter_res_67921;
    bool loop_while_67922;
    int64_t p_67926;
    
    loop_while_67922 = loop_cond_67916;
    p_67926 = (int64_t) 0;
    while (loop_while_67922) {
        int64_t lower_bound_67927 = mul64(scatter_psizze_59391, p_67926);
        int64_t min_arg1_67928 = add64(scatter_psizze_59391, lower_bound_67927);
        int64_t min_res_67929 = smin64(n_pairs_67906, min_arg1_67928);
        int64_t j_m_i_67930 = sub64(min_res_67929, lower_bound_67927);
        bool empty_slice_67931 = j_m_i_67930 == (int64_t) 0;
        int64_t m_67932 = sub64(j_m_i_67930, (int64_t) 1);
        int64_t i_p_m_t_s_67933 = add64(lower_bound_67927, m_67932);
        bool zzero_leq_i_p_m_t_s_67934 = sle64((int64_t) 0, i_p_m_t_s_67933);
        bool i_p_m_t_s_leq_w_67935 = slt64(i_p_m_t_s_67933, n_pairs_67906);
        bool zzero_lte_i_67936 = sle64((int64_t) 0, lower_bound_67927);
        bool i_lte_j_67937 = sle64(lower_bound_67927, min_res_67929);
        bool y_67938 = i_p_m_t_s_leq_w_67935 && zzero_lte_i_67936;
        bool y_67939 = zzero_leq_i_p_m_t_s_67934 && y_67938;
        bool forwards_ok_67940 = i_lte_j_67937 && y_67939;
        bool ok_or_empty_67941 = empty_slice_67931 || forwards_ok_67940;
        bool index_certs_67942;
        
        if (!ok_or_empty_67941) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_67927, ":", (long long) min_res_67929, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78148 = (int64_t) 8 * j_m_i_67930;
        
        if (memblock_alloc_device(ctx, &mem_78149, bytes_78148, "mem_78149")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78134.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78151, bytes_78148, "mem_78151")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78136.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78153, bytes_78148, "mem_78153")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78138.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79433 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_76012));
        
        {
            err = gpu_kernel_inner_SMJ_doublezisegmap_76009(ctx, num_tblocks_76014, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76011, 1, 1, (int64_t) 0, m_67844, lower_bound_67927, min_res_67929, j_m_i_67930, num_tblocks_76014, virt_num_tblocks_79433, mem_78105.mem, mem_78107.mem, mem_78109.mem, mem_78120.mem, mem_78149.mem, mem_78151.mem, mem_78153.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_67956 = add64((int64_t) 1, p_67926);
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78134.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78136.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78138.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        
        bool loop_cond_67967 = slt64(tmp_67956, m_67915);
        bool loop_while_tmp_79428 = loop_cond_67967;
        int64_t p_tmp_79432 = tmp_67956;
        
        loop_while_67922 = loop_while_tmp_79428;
        p_67926 = p_tmp_79432;
    }
    partitioned_scatter_res_67917 = loop_while_67922;
    partitioned_scatter_res_67921 = p_67926;
    if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
        return 1;
    
    bool loop_cond_t_res_68012 = slt64(m_67844, n_pairs_67906);
    bool x_68013 = cond_68011 && loop_cond_t_res_68012;
    
    if (memblock_alloc_device(ctx, &mem_78179, (int64_t) 8, "mem_78179")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78180, (int64_t) 8, "mem_78180")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78181, (int64_t) 8, "mem_78181")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_68014;
    int64_t joinTups_to_joinPairs_InnerJoin_res_68018;
    bool loop_while_68019;
    int64_t p_68023;
    
    if (memblock_set_device(ctx, &mem_param_78166, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78169, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78172, &mem_78138, "mem_78138") != 0)
        return 1;
    loop_while_68019 = x_68013;
    p_68023 = (int64_t) 0;
    while (loop_while_68019) {
        bool x_68024 = sle64((int64_t) 0, p_68023);
        bool y_68025 = slt64(p_68023, m_67984);
        bool bounds_check_68026 = x_68024 && y_68025;
        bool index_certs_68027;
        
        if (!bounds_check_68026) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_68023, "] out of bounds for array of shape [", (long long) m_67984, "].", "-> #0  ftSMJ.fut:300:13-42\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_79538;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79538, mem_78130.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68028 = read_res_79538;
        int64_t read_res_79539;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79539, mem_78128.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68029 = read_res_79539;
        bool x_68030 = sle64((int64_t) 0, loopres_68028);
        bool y_68031 = slt64(loopres_68028, n_pairs_67906);
        bool bounds_check_68032 = x_68030 && y_68031;
        bool index_certs_68033;
        
        if (!bounds_check_68032) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:302:52-61\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_68044 = add64(loopres_68028, loopres_68029);
        bool empty_slice_68048 = loopres_68029 == (int64_t) 0;
        int64_t m_68049 = sub64(loopres_68029, (int64_t) 1);
        int64_t i_p_m_t_s_68050 = add64(loopres_68028, m_68049);
        bool zzero_leq_i_p_m_t_s_68051 = sle64((int64_t) 0, i_p_m_t_s_68050);
        bool i_p_m_t_s_leq_w_68052 = slt64(i_p_m_t_s_68050, n_pairs_67906);
        bool i_lte_j_68053 = sle64(loopres_68028, tmp_68044);
        bool y_68054 = x_68030 && i_p_m_t_s_leq_w_68052;
        bool y_68055 = zzero_leq_i_p_m_t_s_68051 && y_68054;
        bool forwards_ok_68056 = i_lte_j_68053 && y_68055;
        bool ok_or_empty_68057 = empty_slice_68048 || forwards_ok_68056;
        bool index_certs_68058;
        
        if (!ok_or_empty_68057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, ":", (long long) tmp_68044, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:306:14-55\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:403:133-136\n   #3  ftSMJ.fut:392:1-403:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78182 = (int64_t) 8 * loopres_68029;
        int64_t segmap_usable_groups_76036 = sdiv_up64(loopres_68029, segmap_tblock_sizze_76035);
        int64_t tmp_68043 = add64((int64_t) 1, p_68023);
        
        if (memblock_alloc_device(ctx, &mem_78174, bytes_78133, "mem_78174")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78174.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78176, bytes_78133, "mem_78176")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78178, bytes_78133, "mem_78178")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78172.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        
        bool cond_68062 = slt64(tmp_68043, m_67984);
        bool x_68063 = loop_cond_t_res_68012 && cond_68062;
        
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_79454(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_68028, mem_param_78166.mem, mem_param_78169.mem, mem_param_78172.mem, mem_78179.mem, mem_78180.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78183, bytes_78182, "mem_78183")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79460 = loopres_68029;
        int64_t tblock_sizze_79465;
        
        tblock_sizze_79465 = *ctx->tuning_params.inner_SMJ_doublezitblock_sizze_79465;
        
        int64_t virt_num_tblocks_79466 = sdiv_up64(replicate_n_79460, tblock_sizze_79465);
        int64_t num_tblocks_79467 = smin64(virt_num_tblocks_79466, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_doublezireplicate_79461(ctx, num_tblocks_79467, 1, 1, tblock_sizze_79465, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79460, virt_num_tblocks_79466, num_tblocks_79467, mem_78179.mem, mem_78183.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78185, bytes_78182, "mem_78185")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79480 = loopres_68029;
        int64_t tblock_sizze_79485;
        
        tblock_sizze_79485 = *ctx->tuning_params.inner_SMJ_doublezitblock_sizze_79485;
        
        int64_t virt_num_tblocks_79486 = sdiv_up64(replicate_n_79480, tblock_sizze_79485);
        int64_t num_tblocks_79487 = smin64(virt_num_tblocks_79486, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_doublezireplicate_79481(ctx, num_tblocks_79487, 1, 1, tblock_sizze_79485, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79480, virt_num_tblocks_79486, num_tblocks_79487, mem_78180.mem, mem_78185.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79500 = sext_i64_i32(sdiv_up64(loopres_68029, segmap_tblock_sizze_76035));
        
        {
            err = gpu_kernel_inner_SMJ_doublezisegmap_76039(ctx, segmap_usable_groups_76036, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_76027, 1, 1, (int64_t) 0, loopres_68028, loopres_68029, mem_78178.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78174.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78185.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79446, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79447, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79448, &mem_78178, "mem_78178") != 0)
            return 1;
        
        bool loop_while_tmp_79449 = x_68063;
        int64_t p_tmp_79453 = tmp_68043;
        
        if (memblock_set_device(ctx, &mem_param_78166, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78169, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78172, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        loop_while_68019 = loop_while_tmp_79449;
        p_68023 = p_tmp_79453;
    }
    if (memblock_set_device(ctx, &ext_mem_78197, &mem_param_78166, "mem_param_78166") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78196, &mem_param_78169, "mem_param_78169") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78195, &mem_param_78172, "mem_param_78172") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_68014 = loop_while_68019;
    joinTups_to_joinPairs_InnerJoin_res_68018 = p_68023;
    if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78199, bytes_78133, "mem_78199")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78197.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78201, bytes_78133, "mem_78201")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78201.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78203, bytes_78133, "mem_78203")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_78201, "mem_78201") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78701, &mem_78203, "mem_78203") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78702, &mem_78199, "mem_78199") != 0)
        return 1;
    prim_out_78703 = n_pairs_67906;
    if (memblock_set_device(ctx, &*mem_out_p_79519, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79520, &mem_out_78701, "mem_out_78701") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79521, &mem_out_78702, "mem_out_78702") != 0)
        return 1;
    *out_prim_out_79522 = prim_out_78703;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_78203, "mem_78203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78201, "mem_78201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78199, "mem_78199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78178, "mem_78178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78172, "mem_param_78172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78169, "mem_param_78169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78166, "mem_param_78166") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78124, "mem_78124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78125, "mem_78125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78121, "mem_78121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78122, "mem_78122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79249, "incprefixes_mem_79249") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79247, "aggregates_mem_79247") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79245, "incprefixes_mem_79245") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79243, "aggregates_mem_79243") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79241, "status_flags_mem_79241") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79108, "incprefixes_mem_79108") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79106, "aggregates_mem_79106") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79084, "status_flags_mem_79084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78083, "mem_78083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78080, "mem_78080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77888, "mem_77888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77886, "mem_77886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77872, "mem_77872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77869, "mem_77869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77848, "mem_77848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77846, "mem_77846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77781, "mem_77781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77779, "mem_77779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77842, "mem_77842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77840, "mem_77840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77851, "ext_mem_77851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77854, "ext_mem_77854") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77857, "ext_mem_77857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77860, "ext_mem_77860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77710, "mem_param_77710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77707, "mem_param_77707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77702, "mem_77702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77703, "mem_77703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77699, "mem_77699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77700, "mem_77700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77698, "mem_param_77698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77695, "mem_param_77695") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77891, "ext_mem_77891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77894, "ext_mem_77894") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77897, "ext_mem_77897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77900, "ext_mem_77900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77688, "mem_param_77688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77685, "mem_param_77685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77905, "ext_mem_77905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77906, "ext_mem_77906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77667, "mem_77667") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77669, "mem_77669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77651, "mem_77651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77652, "mem_77652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77647, "mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77648, "mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78053, "mem_78053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78051, "mem_78051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77986, "mem_77986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77984, "mem_77984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78047, "mem_78047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78045, "mem_78045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78056, "ext_mem_78056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78059, "ext_mem_78059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78062, "ext_mem_78062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78065, "ext_mem_78065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77915, "mem_param_77915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77912, "mem_param_77912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78070, "ext_mem_78070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78071, "ext_mem_78071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77907, "mem_77907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77908, "mem_77908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77640, "mem_param_77640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77632, "mem_77632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77633, "mem_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78702, "mem_out_78702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78701, "mem_out_78701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_79540, struct memblock_device *mem_out_p_79541, struct memblock_device *mem_out_p_79542, int64_t *out_prim_out_79543, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_54353, int64_t nS_54354, int64_t offset_R_54357, int64_t offset_S_54358, int64_t partitionsPerWindow_54359, int64_t numberOfWindows_54360, int64_t extParallelism_54361, int64_t scatter_psizze_54362)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_78203;
    
    mem_78203.references = NULL;
    
    struct memblock_device mem_78201;
    
    mem_78201.references = NULL;
    
    struct memblock_device mem_78199;
    
    mem_78199.references = NULL;
    
    struct memblock_device mem_param_tmp_79448;
    
    mem_param_tmp_79448.references = NULL;
    
    struct memblock_device mem_param_tmp_79447;
    
    mem_param_tmp_79447.references = NULL;
    
    struct memblock_device mem_param_tmp_79446;
    
    mem_param_tmp_79446.references = NULL;
    
    struct memblock_device mem_78185;
    
    mem_78185.references = NULL;
    
    struct memblock_device mem_78183;
    
    mem_78183.references = NULL;
    
    struct memblock_device mem_78178;
    
    mem_78178.references = NULL;
    
    struct memblock_device mem_78176;
    
    mem_78176.references = NULL;
    
    struct memblock_device mem_78174;
    
    mem_78174.references = NULL;
    
    struct memblock_device mem_param_78172;
    
    mem_param_78172.references = NULL;
    
    struct memblock_device mem_param_78169;
    
    mem_param_78169.references = NULL;
    
    struct memblock_device mem_param_78166;
    
    mem_param_78166.references = NULL;
    
    struct memblock_device ext_mem_78195;
    
    ext_mem_78195.references = NULL;
    
    struct memblock_device ext_mem_78196;
    
    ext_mem_78196.references = NULL;
    
    struct memblock_device ext_mem_78197;
    
    ext_mem_78197.references = NULL;
    
    struct memblock_device mem_78181;
    
    mem_78181.references = NULL;
    
    struct memblock_device mem_78180;
    
    mem_78180.references = NULL;
    
    struct memblock_device mem_78179;
    
    mem_78179.references = NULL;
    
    struct memblock_device mem_78153;
    
    mem_78153.references = NULL;
    
    struct memblock_device mem_78151;
    
    mem_78151.references = NULL;
    
    struct memblock_device mem_78149;
    
    mem_78149.references = NULL;
    
    struct memblock_device mem_78138;
    
    mem_78138.references = NULL;
    
    struct memblock_device mem_78136;
    
    mem_78136.references = NULL;
    
    struct memblock_device mem_78134;
    
    mem_78134.references = NULL;
    
    struct memblock_device mem_78130;
    
    mem_78130.references = NULL;
    
    struct memblock_device mem_78128;
    
    mem_78128.references = NULL;
    
    struct memblock_device mem_78132;
    
    mem_78132.references = NULL;
    
    struct memblock_device mem_78124;
    
    mem_78124.references = NULL;
    
    struct memblock_device mem_78125;
    
    mem_78125.references = NULL;
    
    struct memblock_device ext_mem_78126;
    
    ext_mem_78126.references = NULL;
    
    struct memblock_device mem_78121;
    
    mem_78121.references = NULL;
    
    struct memblock_device mem_78122;
    
    mem_78122.references = NULL;
    
    struct memblock_device ext_mem_78123;
    
    ext_mem_78123.references = NULL;
    
    struct memblock_device mem_78120;
    
    mem_78120.references = NULL;
    
    struct memblock_device incprefixes_mem_79249;
    
    incprefixes_mem_79249.references = NULL;
    
    struct memblock_device aggregates_mem_79247;
    
    aggregates_mem_79247.references = NULL;
    
    struct memblock_device incprefixes_mem_79245;
    
    incprefixes_mem_79245.references = NULL;
    
    struct memblock_device aggregates_mem_79243;
    
    aggregates_mem_79243.references = NULL;
    
    struct memblock_device status_flags_mem_79241;
    
    status_flags_mem_79241.references = NULL;
    
    struct memblock_device mem_78117;
    
    mem_78117.references = NULL;
    
    struct memblock_device mem_78115;
    
    mem_78115.references = NULL;
    
    struct memblock_device mem_78113;
    
    mem_78113.references = NULL;
    
    struct memblock_device mem_78109;
    
    mem_78109.references = NULL;
    
    struct memblock_device mem_78107;
    
    mem_78107.references = NULL;
    
    struct memblock_device mem_78105;
    
    mem_78105.references = NULL;
    
    struct memblock_device mem_78103;
    
    mem_78103.references = NULL;
    
    struct memblock_device incprefixes_mem_79108;
    
    incprefixes_mem_79108.references = NULL;
    
    struct memblock_device aggregates_mem_79106;
    
    aggregates_mem_79106.references = NULL;
    
    struct memblock_device status_flags_mem_79084;
    
    status_flags_mem_79084.references = NULL;
    
    struct memblock_device mem_78101;
    
    mem_78101.references = NULL;
    
    struct memblock_device mem_78099;
    
    mem_78099.references = NULL;
    
    struct memblock_device mem_param_tmp_78751;
    
    mem_param_tmp_78751.references = NULL;
    
    struct memblock_device mem_param_tmp_78750;
    
    mem_param_tmp_78750.references = NULL;
    
    struct memblock_device mem_78084;
    
    mem_78084.references = NULL;
    
    struct memblock_device mem_78083;
    
    mem_78083.references = NULL;
    
    struct memblock_device mem_78080;
    
    mem_78080.references = NULL;
    
    struct memblock_device mem_param_tmp_78908;
    
    mem_param_tmp_78908.references = NULL;
    
    struct memblock_device mem_param_tmp_78907;
    
    mem_param_tmp_78907.references = NULL;
    
    struct memblock_device mem_77888;
    
    mem_77888.references = NULL;
    
    struct memblock_device mem_77886;
    
    mem_77886.references = NULL;
    
    struct memblock_device mem_77884;
    
    mem_77884.references = NULL;
    
    struct memblock_device mem_77881;
    
    mem_77881.references = NULL;
    
    struct memblock_device mem_param_tmp_78918;
    
    mem_param_tmp_78918.references = NULL;
    
    struct memblock_device mem_param_tmp_78917;
    
    mem_param_tmp_78917.references = NULL;
    
    struct memblock_device mem_77872;
    
    mem_77872.references = NULL;
    
    struct memblock_device mem_77869;
    
    mem_77869.references = NULL;
    
    struct memblock_device mem_param_tmp_78936;
    
    mem_param_tmp_78936.references = NULL;
    
    struct memblock_device mem_param_tmp_78935;
    
    mem_param_tmp_78935.references = NULL;
    
    struct memblock_device mem_77848;
    
    mem_77848.references = NULL;
    
    struct memblock_device mem_77846;
    
    mem_77846.references = NULL;
    
    struct memblock_device mem_77781;
    
    mem_77781.references = NULL;
    
    struct memblock_device mem_77779;
    
    mem_77779.references = NULL;
    
    struct memblock_device mem_77842;
    
    mem_77842.references = NULL;
    
    struct memblock_device mem_77840;
    
    mem_77840.references = NULL;
    
    struct memblock_device ext_mem_77843;
    
    ext_mem_77843.references = NULL;
    
    struct memblock_device ext_mem_77844;
    
    ext_mem_77844.references = NULL;
    
    struct memblock_device ext_mem_77720;
    
    ext_mem_77720.references = NULL;
    
    struct memblock_device mem_77718;
    
    mem_77718.references = NULL;
    
    struct memblock_device ext_mem_77851;
    
    ext_mem_77851.references = NULL;
    
    struct memblock_device ext_mem_77854;
    
    ext_mem_77854.references = NULL;
    
    struct memblock_device mem_77716;
    
    mem_77716.references = NULL;
    
    struct memblock_device ext_mem_77857;
    
    ext_mem_77857.references = NULL;
    
    struct memblock_device ext_mem_77860;
    
    ext_mem_77860.references = NULL;
    
    struct memblock_device ext_mem_77714;
    
    ext_mem_77714.references = NULL;
    
    struct memblock_device ext_mem_77713;
    
    ext_mem_77713.references = NULL;
    
    struct memblock_device mem_param_77710;
    
    mem_param_77710.references = NULL;
    
    struct memblock_device mem_param_77707;
    
    mem_param_77707.references = NULL;
    
    struct memblock_device ext_mem_77865;
    
    ext_mem_77865.references = NULL;
    
    struct memblock_device ext_mem_77866;
    
    ext_mem_77866.references = NULL;
    
    struct memblock_device mem_77702;
    
    mem_77702.references = NULL;
    
    struct memblock_device mem_77703;
    
    mem_77703.references = NULL;
    
    struct memblock_device ext_mem_77704;
    
    ext_mem_77704.references = NULL;
    
    struct memblock_device mem_77699;
    
    mem_77699.references = NULL;
    
    struct memblock_device mem_77700;
    
    mem_77700.references = NULL;
    
    struct memblock_device ext_mem_77701;
    
    ext_mem_77701.references = NULL;
    
    struct memblock_device mem_param_77698;
    
    mem_param_77698.references = NULL;
    
    struct memblock_device mem_param_77695;
    
    mem_param_77695.references = NULL;
    
    struct memblock_device ext_mem_77877;
    
    ext_mem_77877.references = NULL;
    
    struct memblock_device ext_mem_77878;
    
    ext_mem_77878.references = NULL;
    
    struct memblock_device mem_77715;
    
    mem_77715.references = NULL;
    
    struct memblock_device mem_77712;
    
    mem_77712.references = NULL;
    
    struct memblock_device mem_77711;
    
    mem_77711.references = NULL;
    
    struct memblock_device mem_77692;
    
    mem_77692.references = NULL;
    
    struct memblock_device mem_77690;
    
    mem_77690.references = NULL;
    
    struct memblock_device ext_mem_77891;
    
    ext_mem_77891.references = NULL;
    
    struct memblock_device ext_mem_77894;
    
    ext_mem_77894.references = NULL;
    
    struct memblock_device ext_mem_77897;
    
    ext_mem_77897.references = NULL;
    
    struct memblock_device ext_mem_77900;
    
    ext_mem_77900.references = NULL;
    
    struct memblock_device mem_param_77688;
    
    mem_param_77688.references = NULL;
    
    struct memblock_device mem_param_77685;
    
    mem_param_77685.references = NULL;
    
    struct memblock_device ext_mem_77905;
    
    ext_mem_77905.references = NULL;
    
    struct memblock_device ext_mem_77906;
    
    ext_mem_77906.references = NULL;
    
    struct memblock_device mem_77682;
    
    mem_77682.references = NULL;
    
    struct memblock_device mem_77680;
    
    mem_77680.references = NULL;
    
    struct memblock_device mem_77667;
    
    mem_77667.references = NULL;
    
    struct memblock_device mem_77669;
    
    mem_77669.references = NULL;
    
    struct memblock_device ext_mem_77670;
    
    ext_mem_77670.references = NULL;
    
    struct memblock_device ext_mem_77671;
    
    ext_mem_77671.references = NULL;
    
    struct memblock_device mem_77664;
    
    mem_77664.references = NULL;
    
    struct memblock_device mem_77662;
    
    mem_77662.references = NULL;
    
    struct memblock_device mem_77651;
    
    mem_77651.references = NULL;
    
    struct memblock_device mem_77652;
    
    mem_77652.references = NULL;
    
    struct memblock_device ext_mem_77653;
    
    ext_mem_77653.references = NULL;
    
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_77647;
    
    mem_77647.references = NULL;
    
    struct memblock_device mem_77648;
    
    mem_77648.references = NULL;
    
    struct memblock_device ext_mem_77649;
    
    ext_mem_77649.references = NULL;
    
    struct memblock_device mem_77646;
    
    mem_77646.references = NULL;
    
    struct memblock_device mem_77644;
    
    mem_77644.references = NULL;
    
    struct memblock_device mem_param_tmp_78769;
    
    mem_param_tmp_78769.references = NULL;
    
    struct memblock_device mem_param_tmp_78768;
    
    mem_param_tmp_78768.references = NULL;
    
    struct memblock_device mem_78053;
    
    mem_78053.references = NULL;
    
    struct memblock_device mem_78051;
    
    mem_78051.references = NULL;
    
    struct memblock_device mem_77986;
    
    mem_77986.references = NULL;
    
    struct memblock_device mem_77984;
    
    mem_77984.references = NULL;
    
    struct memblock_device mem_78047;
    
    mem_78047.references = NULL;
    
    struct memblock_device mem_78045;
    
    mem_78045.references = NULL;
    
    struct memblock_device ext_mem_78048;
    
    ext_mem_78048.references = NULL;
    
    struct memblock_device ext_mem_78049;
    
    ext_mem_78049.references = NULL;
    
    struct memblock_device ext_mem_77925;
    
    ext_mem_77925.references = NULL;
    
    struct memblock_device mem_77923;
    
    mem_77923.references = NULL;
    
    struct memblock_device ext_mem_78056;
    
    ext_mem_78056.references = NULL;
    
    struct memblock_device ext_mem_78059;
    
    ext_mem_78059.references = NULL;
    
    struct memblock_device mem_77921;
    
    mem_77921.references = NULL;
    
    struct memblock_device ext_mem_78062;
    
    ext_mem_78062.references = NULL;
    
    struct memblock_device ext_mem_78065;
    
    ext_mem_78065.references = NULL;
    
    struct memblock_device ext_mem_77919;
    
    ext_mem_77919.references = NULL;
    
    struct memblock_device ext_mem_77918;
    
    ext_mem_77918.references = NULL;
    
    struct memblock_device mem_param_77915;
    
    mem_param_77915.references = NULL;
    
    struct memblock_device mem_param_77912;
    
    mem_param_77912.references = NULL;
    
    struct memblock_device ext_mem_78070;
    
    ext_mem_78070.references = NULL;
    
    struct memblock_device ext_mem_78071;
    
    ext_mem_78071.references = NULL;
    
    struct memblock_device mem_77920;
    
    mem_77920.references = NULL;
    
    struct memblock_device mem_77917;
    
    mem_77917.references = NULL;
    
    struct memblock_device mem_77916;
    
    mem_77916.references = NULL;
    
    struct memblock_device mem_77907;
    
    mem_77907.references = NULL;
    
    struct memblock_device mem_77908;
    
    mem_77908.references = NULL;
    
    struct memblock_device ext_mem_77909;
    
    ext_mem_77909.references = NULL;
    
    struct memblock_device ext_mem_78074;
    
    ext_mem_78074.references = NULL;
    
    struct memblock_device ext_mem_78077;
    
    ext_mem_78077.references = NULL;
    
    struct memblock_device ext_mem_78087;
    
    ext_mem_78087.references = NULL;
    
    struct memblock_device ext_mem_78090;
    
    ext_mem_78090.references = NULL;
    
    struct memblock_device mem_param_77640;
    
    mem_param_77640.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device ext_mem_78095;
    
    ext_mem_78095.references = NULL;
    
    struct memblock_device ext_mem_78096;
    
    ext_mem_78096.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77632;
    
    mem_77632.references = NULL;
    
    struct memblock_device mem_77633;
    
    mem_77633.references = NULL;
    
    struct memblock_device ext_mem_77634;
    
    ext_mem_77634.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device ext_mem_77627;
    
    ext_mem_77627.references = NULL;
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78703;
    int64_t zm_lhs_66970 = add64(nR_54353, nS_54354);
    int64_t zs_lhs_66971 = sub64(zm_lhs_66970, (int64_t) 1);
    bool zzero_66972 = nR_54353 == (int64_t) 0;
    bool nonzzero_66973 = !zzero_66972;
    bool nonzzero_cert_66974;
    
    if (!nonzzero_66973) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:232:26-29\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_66975 = sdiv64(zs_lhs_66971, nR_54353);
    
    if (futrts_indicesWithIncrement_9949(ctx, &ext_mem_77627, tR_mem_77625, nR_54353, offset_R_54357) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_77628 = (int64_t) 8 * nR_54353;
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77629, nR_54353, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, nR_54353, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_66980 = slt64((int64_t) 0, numIter_66975);
    int64_t gt_rhs_66981 = sub64(nR_54353, (int64_t) 1);
    bool x_66982 = sle64((int64_t) 0, gt_rhs_66981);
    bool y_66983 = slt64(gt_rhs_66981, nR_54353);
    bool bounds_check_66984 = x_66982 && y_66983;
    bool loop_not_taken_66985 = !loop_cond_66980;
    bool protect_assert_disj_66986 = bounds_check_66984 || loop_not_taken_66985;
    bool index_certs_66987;
    
    if (!protect_assert_disj_66986) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftSMJ.fut:239:25-33\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_66980) {
        if (memblock_alloc_device(ctx, &mem_77633, (int64_t) 4, "mem_77633")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_78724(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, tR_mem_77625.mem, mem_77633.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77633, "mem_77633") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_77632, (int64_t) 4, "mem_77632")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_77632, (int64_t) 1, 0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77632, "mem_77632") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_77641, (int64_t) 4, "mem_77641")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77642, (int64_t) 1, "mem_77642")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_66990;
    int64_t defunc_0_mergeJoin_res_66991;
    bool loop_while_66994;
    int64_t p_66995;
    
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77640, &mem_77629, "mem_77629") != 0)
        return 1;
    loop_while_66994 = loop_cond_66980;
    p_66995 = (int64_t) 0;
    while (loop_while_66994) {
        int64_t tS_start_66998 = mul64(nR_54353, p_66995);
        int64_t min_arg1_66999 = add64(nR_54353, tS_start_66998);
        int64_t min_res_67000 = smin64(nS_54354, min_arg1_66999);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 = sub64(min_res_67000, tS_start_66998);
        bool empty_slice_67002 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 == (int64_t) 0;
        int64_t m_67003 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, (int64_t) 1);
        int64_t i_p_m_t_s_67004 = add64(tS_start_66998, m_67003);
        bool zzero_leq_i_p_m_t_s_67005 = sle64((int64_t) 0, i_p_m_t_s_67004);
        bool i_p_m_t_s_leq_w_67006 = slt64(i_p_m_t_s_67004, nS_54354);
        bool zzero_lte_i_67007 = sle64((int64_t) 0, tS_start_66998);
        bool i_lte_j_67008 = sle64(tS_start_66998, min_res_67000);
        bool y_67009 = i_p_m_t_s_leq_w_67006 && zzero_lte_i_67007;
        bool y_67010 = zzero_leq_i_p_m_t_s_67005 && y_67009;
        bool forwards_ok_67011 = i_lte_j_67008 && y_67010;
        bool ok_or_empty_67012 = empty_slice_67002 || forwards_ok_67011;
        bool index_certs_67013;
        
        if (!ok_or_empty_67012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_66998, ":", (long long) min_res_67000, "] out of bounds for array of shape [", (long long) nS_54354, "].", "-> #0  ftSMJ.fut:238:16-35\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_67015 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
        bool index_certs_67016;
        
        if (!y_67015) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:239:12-19\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_78756(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_66998, tS_mem_77626.mem, ext_mem_77634.mem, mem_77641.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_79544;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79544, mem_77642.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_67018 = read_res_79544;
        int64_t loopres_67019;
        
        if (defunc_0_gt_res_67018) {
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_param_77637, "mem_param_77637") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_param_77640, "mem_param_77640") != 0)
                return 1;
            loopres_67019 = numIter_66975;
        } else {
            bool cond_67022 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, nR_54353);
            bool dim_match_67136 = nR_54353 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            bool protect_assert_disj_78305 = cond_67022 || dim_match_67136;
            bool empty_or_match_cert_67137;
            
            if (!protect_assert_disj_78305) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "] cannot match shape of type `[", (long long) nR_54353, "]f32`.", "-> #0  ftSMJ.fut:247:18-31\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_67143 = slt64((int64_t) 0, numberOfWindows_54360);
            bool y_67146 = slt64((int64_t) 0, nR_54353);
            bool loop_not_taken_67147 = !loop_cond_67143;
            bool protect_assert_disj_67148 = y_67146 || loop_not_taken_67147;
            bool protect_assert_disj_78307 = cond_67022 || protect_assert_disj_67148;
            bool index_certs_67149;
            
            if (!protect_assert_disj_78307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftsort.fut:285:20-25\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_68532 = add64(nR_54353, extParallelism_54361);
            int64_t zs_lhs_68533 = sub64(zm_lhs_68532, (int64_t) 1);
            bool zzero_68534 = extParallelism_54361 == (int64_t) 0;
            bool nonzzero_68535 = !zzero_68534;
            bool loop_not_taken_78248 = !cond_67022;
            bool protect_assert_disj_78249 = nonzzero_68535 || loop_not_taken_78248;
            bool nonzzero_cert_68536;
            
            if (!protect_assert_disj_78249) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_68537 = sdiv_safe64(zs_lhs_68533, extParallelism_54361);
            bool loop_cond_68538 = slt64((int64_t) 0, numIter_68537);
            bool loop_not_taken_68539 = !y_67015;
            bool loop_not_taken_68540 = !loop_cond_68538;
            bool x_68541 = sle64((int64_t) 0, m_67003);
            bool y_68542 = slt64(m_67003, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
            bool bounds_check_68544 = x_68541 && y_68542;
            bool protect_assert_disj_68545 = loop_not_taken_68539 || bounds_check_68544;
            bool protect_assert_disj_68546 = loop_not_taken_68540 || protect_assert_disj_68545;
            bool protect_assert_disj_78251 = protect_assert_disj_68546 || loop_not_taken_78248;
            bool index_certs_68547;
            
            if (!protect_assert_disj_78251) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67817;
            
            if (!bounds_check_68544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:258:23-44\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67819;
            
            if (!bounds_check_66984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftSMJ.fut:258:51-59\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 = mul64(partitionsPerWindow_54359, numberOfWindows_54360);
            int64_t join_chunks_arg3_67139 = add64(offset_S_54358, tS_start_66998);
            int64_t bytes_77643 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
            bool empty_slice_67144 = partitionsPerWindow_54359 == (int64_t) 0;
            int64_t m_67145 = sub64(partitionsPerWindow_54359, (int64_t) 1);
            int64_t segmap_tblock_sizze_73808;
            
            segmap_tblock_sizze_73808 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_73601;
            
            int64_t zeze_rhs_67414 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, (int64_t) 1);
            int64_t segmap_tblock_sizze_74182;
            
            segmap_tblock_sizze_74182 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74018;
            
            int64_t segmap_usable_groups_74183 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_74182);
            bool loop_cond_67569 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
            bool protect_cond_conj_68543 = y_67015 && loop_cond_68538;
            int64_t bytes_77922 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            int64_t ext_78076;
            int64_t ext_78075;
            int64_t ext_78073;
            int64_t ext_78072;
            
            if (cond_67022) {
                if (protect_cond_conj_68543) {
                    if (memblock_alloc_device(ctx, &mem_77908, (int64_t) 4, "mem_77908")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78762(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_67004, tS_mem_77626.mem, mem_77908.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77908, "mem_77908") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77907, (int64_t) 4, "mem_77907")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_77907, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77907, "mem_77907") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77916, (int64_t) 4, "mem_77916")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77917, (int64_t) 4, "mem_77917")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77920, (int64_t) 1, "mem_77920")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_78069;
                int64_t ext_78068;
                int64_t ext_78067;
                int64_t ext_78066;
                bool defunc_0_find_joinTuples_res_68550;
                int64_t defunc_0_find_joinTuples_res_68551;
                bool loop_while_68554;
                int64_t p_68555;
                int64_t ctx_param_ext_77910;
                int64_t ctx_param_ext_77911;
                int64_t ctx_param_ext_77913;
                int64_t ctx_param_ext_77914;
                
                if (memblock_set_device(ctx, &mem_param_77912, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77915, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77910 = (int64_t) 0;
                ctx_param_ext_77911 = (int64_t) 1;
                ctx_param_ext_77913 = (int64_t) 0;
                ctx_param_ext_77914 = (int64_t) 1;
                loop_while_68554 = loop_cond_68538;
                p_68555 = (int64_t) 0;
                while (loop_while_68554) {
                    int64_t start_68558 = mul64(extParallelism_54361, p_68555);
                    int64_t min_arg1_68559 = sub64(nR_54353, start_68558);
                    int64_t min_res_68560 = smin64(extParallelism_54361, min_arg1_68559);
                    int64_t iter_R_68561 = add64(start_68558, min_res_68560);
                    bool empty_slice_68562 = min_res_68560 == (int64_t) 0;
                    int64_t m_68563 = sub64(min_res_68560, (int64_t) 1);
                    int64_t i_p_m_t_s_68564 = add64(start_68558, m_68563);
                    bool zzero_leq_i_p_m_t_s_68565 = sle64((int64_t) 0, i_p_m_t_s_68564);
                    bool i_p_m_t_s_leq_w_68566 = slt64(i_p_m_t_s_68564, nR_54353);
                    bool zzero_lte_i_68567 = sle64((int64_t) 0, start_68558);
                    bool i_lte_j_68568 = sle64(start_68558, iter_R_68561);
                    bool y_68569 = i_p_m_t_s_leq_w_68566 && zzero_lte_i_68567;
                    bool y_68570 = zzero_leq_i_p_m_t_s_68565 && y_68569;
                    bool forwards_ok_68571 = i_lte_j_68568 && y_68570;
                    bool ok_or_empty_68572 = empty_slice_68562 || forwards_ok_68571;
                    bool index_certs_68573;
                    
                    if (!ok_or_empty_68572) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_68558, ":", (long long) iter_R_68561, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68574 = slt64(m_68563, min_res_68560);
                    bool x_68575 = sle64((int64_t) 0, m_68563);
                    bool bounds_check_68576 = y_68574 && x_68575;
                    bool index_certs_68577;
                    
                    if (!bounds_check_68576) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_68563, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68580 = slt64((int64_t) 0, min_res_68560);
                    bool index_certs_68581;
                    
                    if (!y_68580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78778(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_68558, i_p_m_t_s_68564, tR_mem_77625.mem, mem_77916.mem, mem_77917.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77918, &ext_mem_77909, "ext_mem_77909") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77918, &mem_77916, "mem_77916") != 0)
                        return 1;
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77919, &mem_77641, "mem_77641") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77919, &mem_77917, "mem_77917") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78784(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77917.mem, ext_mem_77918.mem, mem_77920.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
                        return 1;
                    
                    bool read_res_79545;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79545, mem_77920.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_68583 = read_res_79545;
                    int64_t ext_78064;
                    int64_t ext_78063;
                    int64_t ext_78061;
                    int64_t ext_78060;
                    int64_t loopres_68585;
                    
                    if (defunc_0_gt_res_68583) {
                        if (memblock_set_device(ctx, &ext_mem_78065, &mem_param_77912, "mem_param_77912") != 0)
                            return 1;
                        ext_78064 = ctx_param_ext_77910;
                        ext_78063 = ctx_param_ext_77911;
                        if (memblock_set_device(ctx, &ext_mem_78062, &mem_param_77915, "mem_param_77915") != 0)
                            return 1;
                        ext_78061 = ctx_param_ext_77913;
                        ext_78060 = ctx_param_ext_77914;
                        loopres_68585 = numIter_68537;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77921, (int64_t) 1, "mem_77921")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_floatzigpuseq_78790(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77916.mem, ext_mem_77919.mem, mem_77921.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_79546;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79546, mem_77921.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_68589 = read_res_79546;
                        
                        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
                            return 1;
                        
                        int64_t ext_78058;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78058 = ctx_param_ext_77910;
                        } else {
                            ext_78058 = (int64_t) 0;
                        }
                        
                        int64_t ext_78057;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78057 = ctx_param_ext_77911;
                        } else {
                            ext_78057 = (int64_t) 1;
                        }
                        
                        int64_t ext_78055;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78055 = ctx_param_ext_77913;
                        } else {
                            ext_78055 = (int64_t) 0;
                        }
                        
                        int64_t ext_78054;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78054 = ctx_param_ext_77914;
                        } else {
                            ext_78054 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_68590;
                        
                        if (defunc_0_gt_res_68589) {
                            int64_t tmp_68594 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_param_77912, "mem_param_77912") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_param_77915, "mem_param_77915") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68594;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_77923, bytes_77922, "mem_77923")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, tS_start_66998, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_9949(ctx, &ext_mem_77925, mem_77923, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, join_chunks_arg3_67139) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
                                return 1;
                            
                            bool suff_outer_par_73423;
                            
                            suff_outer_par_73423 = *ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_0 <= min_res_68560;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_float.suff_outer_par_0", (long) min_res_68560, suff_outer_par_73423 ? "true" : "false");
                            
                            int64_t tile_sizze_76414;
                            
                            tile_sizze_76414 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413;
                            
                            int64_t tile_sizze_76059;
                            
                            tile_sizze_76059 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058;
                            
                            int64_t num_whole_tiles_76430 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            int64_t residual_input_76654 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            bool cond_76655 = residual_input_76654 == (int64_t) 0;
                            int64_t binop_x_76671 = tile_sizze_76414 * num_whole_tiles_76430;
                            int64_t bytes_77983 = (int64_t) 8 * min_res_68560;
                            int64_t bytes_77946 = (int64_t) 8 * tile_sizze_76414;
                            int64_t bytes_77948 = (int64_t) 4 * tile_sizze_76414;
                            int64_t num_whole_tiles_76075 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            int64_t residual_input_76299 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            bool cond_76300 = residual_input_76299 == (int64_t) 0;
                            int64_t binop_x_76316 = tile_sizze_76059 * num_whole_tiles_76075;
                            int64_t bytes_78007 = (int64_t) 8 * tile_sizze_76059;
                            int64_t bytes_78009 = (int64_t) 4 * tile_sizze_76059;
                            int64_t shared_memory_capacity_78848;
                            
                            shared_memory_capacity_78848 = ctx->max_shared_memory;
                            if (suff_outer_par_73423 && sle64(sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78009, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78848)) {
                                int64_t ldim_76060 = sdiv_up64(min_res_68560, tile_sizze_76059);
                                
                                if (memblock_alloc_device(ctx, &mem_78045, bytes_77983, "mem_78045")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_78047, bytes_77983, "mem_78047")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78796 = sext_i64_i32(sdiv_up64(tile_sizze_76059, tile_sizze_76059));
                                int32_t virt_num_tblocks_78797 = sext_i64_i32(ldim_76060);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76057(ctx, ldim_76060, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76058, 1, 1, bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8) + (bytes_78009 + srem64((int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8)) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76060, num_whole_tiles_76075, residual_input_76299, cond_76300, binop_x_76316, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_78045.mem, mem_78047.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_78045, "mem_78045") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_78047, "mem_78047") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_76415 = sdiv_up64(min_res_68560, tile_sizze_76414);
                                
                                if (memblock_alloc_device(ctx, &mem_77984, bytes_77983, "mem_77984")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_77986, bytes_77983, "mem_77986")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78822 = sext_i64_i32(sdiv_up64(tile_sizze_76414, tile_sizze_76414));
                                int32_t virt_num_tblocks_78823 = sext_i64_i32(ldim_76415);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76412(ctx, ldim_76415, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76413, 1, 1, bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8) + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8)) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76415, num_whole_tiles_76430, residual_input_76654, cond_76655, binop_x_76671, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_77984.mem, mem_77986.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_77984, "mem_77984") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_77986, "mem_77986") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78051, bytes_77628, "mem_78051")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77915.mem, ctx_param_ext_77913, (int64_t []) {ctx_param_ext_77914}, (int64_t []) {nR_54353})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78049.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78053, bytes_77628, "mem_78053")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77912.mem, ctx_param_ext_77910, (int64_t []) {ctx_param_ext_77911}, (int64_t []) {nR_54353})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
                                return 1;
                            
                            int64_t tmp_68646 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_78053, "mem_78053") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_78051, "mem_78051") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68646;
                        }
                        if (memblock_set_device(ctx, &ext_mem_78065, &ext_mem_78059, "ext_mem_78059") != 0)
                            return 1;
                        ext_78064 = ext_78058;
                        ext_78063 = ext_78057;
                        if (memblock_set_device(ctx, &ext_mem_78062, &ext_mem_78056, "ext_mem_78056") != 0)
                            return 1;
                        ext_78061 = ext_78055;
                        ext_78060 = ext_78054;
                        loopres_68585 = loopres_f_res_68590;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
                        return 1;
                    
                    bool loop_cond_68647 = slt64(loopres_68585, numIter_68537);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78768, &ext_mem_78065, "ext_mem_78065") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78769, &ext_mem_78062, "ext_mem_78062") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78770 = ext_78064;
                    int64_t ctx_param_ext_tmp_78771 = ext_78063;
                    int64_t ctx_param_ext_tmp_78772 = ext_78061;
                    int64_t ctx_param_ext_tmp_78773 = ext_78060;
                    bool loop_while_tmp_78774 = loop_cond_68647;
                    int64_t p_tmp_78775 = loopres_68585;
                    
                    if (memblock_set_device(ctx, &mem_param_77912, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77915, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
                        return 1;
                    ctx_param_ext_77910 = ctx_param_ext_tmp_78770;
                    ctx_param_ext_77911 = ctx_param_ext_tmp_78771;
                    ctx_param_ext_77913 = ctx_param_ext_tmp_78772;
                    ctx_param_ext_77914 = ctx_param_ext_tmp_78773;
                    loop_while_68554 = loop_while_tmp_78774;
                    p_68555 = p_tmp_78775;
                }
                if (memblock_set_device(ctx, &ext_mem_78071, &mem_param_77912, "mem_param_77912") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78070, &mem_param_77915, "mem_param_77915") != 0)
                    return 1;
                ext_78069 = ctx_param_ext_77910;
                ext_78068 = ctx_param_ext_77911;
                ext_78067 = ctx_param_ext_77913;
                ext_78066 = ctx_param_ext_77914;
                defunc_0_find_joinTuples_res_68550 = loop_while_68554;
                defunc_0_find_joinTuples_res_68551 = p_68555;
                if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_78071, "ext_mem_78071") != 0)
                    return 1;
                ext_78076 = ext_78069;
                ext_78075 = ext_78068;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_78070, "ext_mem_78070") != 0)
                    return 1;
                ext_78073 = ext_78067;
                ext_78072 = ext_78066;
            } else {
                if (memblock_alloc_device(ctx, &mem_77644, bytes_77643, "mem_77644")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77644, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_54353) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77646, bytes_77643, "mem_77646")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77646, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_54353) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77648, (int64_t) 4, "mem_77648")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78849(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_77625.mem, mem_77648.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77648, "mem_77648") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77647, (int64_t) 4, "mem_77647")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_77647, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77647, "mem_77647") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77650, (int64_t) 1, "mem_77650")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_floatzigpuseq_78855(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77641.mem, ext_mem_77649.mem, mem_77650.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
                    return 1;
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77652, (int64_t) 4, "mem_77652")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78861(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_54353, y_67146, tR_mem_77625.mem, mem_77641.mem, mem_77650.mem, mem_77652.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77652, "mem_77652") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77651, (int64_t) 4, "mem_77651")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_77651, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77651, "mem_77651") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_67161;
                int64_t defunc_0_windowed_partitionFunc_res_67162;
                bool loop_while_67165;
                int64_t p_67166;
                
                loop_while_67165 = loop_cond_67143;
                p_67166 = (int64_t) 0;
                while (loop_while_67165) {
                    int64_t start_67169 = mul64(partitionsPerWindow_54359, p_67166);
                    int64_t end_67170 = add64(partitionsPerWindow_54359, start_67169);
                    int64_t max_res_67171 = smax64((int64_t) 1, start_67169);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172 = sub64(end_67170, max_res_67171);
                    bool bounds_invalid_upwards_67173 = slt64(end_67170, max_res_67171);
                    bool valid_67174 = !bounds_invalid_upwards_67173;
                    bool range_valid_c_67175;
                    
                    if (!valid_67174) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_67171, "..<", (long long) end_67170, " is invalid.", "-> #0  ftsort.fut:288:43-68\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_67178 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 == (int64_t) 0;
                    bool nonzzero_67179 = !zzero_67178;
                    bool nonzzero_cert_67180;
                    
                    if (!nonzzero_67179) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:291:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_77661 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool cond_67381 = slt64((int64_t) 0, start_67169);
                    int64_t conc_tmp_67382 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    int64_t ret_67383;
                    
                    if (cond_67381) {
                        ret_67383 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    } else {
                        ret_67383 = conc_tmp_67382;
                    }
                    
                    bool eq_x_y_67391 = partitionsPerWindow_54359 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool eq_x_zz_67392 = partitionsPerWindow_54359 == conc_tmp_67382;
                    bool p_and_eq_x_y_67393 = cond_67381 && eq_x_y_67391;
                    bool not_p_67394 = !cond_67381;
                    bool p_and_eq_x_y_67395 = eq_x_zz_67392 && not_p_67394;
                    bool dim_match_67396 = p_and_eq_x_y_67393 || p_and_eq_x_y_67395;
                    bool empty_or_match_cert_67397;
                    
                    if (!dim_match_67396) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_67383, "] cannot match shape of type `[", (long long) partitionsPerWindow_54359, "](i64, i64)`.", "-> #0  ftsort.fut:352:5-357:49\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_67399 = add64(m_67145, start_67169);
                    bool zzero_leq_i_p_m_t_s_67400 = sle64((int64_t) 0, i_p_m_t_s_67399);
                    bool i_p_m_t_s_leq_w_67401 = slt64(i_p_m_t_s_67399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool zzero_lte_i_67402 = sle64((int64_t) 0, start_67169);
                    bool i_lte_j_67403 = sle64(start_67169, end_67170);
                    bool y_67404 = i_p_m_t_s_leq_w_67401 && zzero_lte_i_67402;
                    bool y_67405 = zzero_leq_i_p_m_t_s_67400 && y_67404;
                    bool forwards_ok_67406 = i_lte_j_67403 && y_67405;
                    bool ok_or_empty_67407 = empty_slice_67144 || forwards_ok_67406;
                    bool index_certs_67408;
                    
                    if (!ok_or_empty_67407) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67169, ":", (long long) end_67170, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:109:37-74\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_67177 = add64(nR_54353, nR_54353);
                    int64_t segmap_usable_groups_73809 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_73808);
                    
                    if (memblock_alloc_device(ctx, &mem_77662, bytes_77661, "mem_77662")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_77664, bytes_77661, "mem_77664")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_78871 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_73808));
                    
                    {
                        err = gpu_kernel_inner_SMJ_floatzisegmap_73813(ctx, segmap_usable_groups_73809, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_73601, 1, 1, (int64_t) 0, nR_54353, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, max_res_67171, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, zt_rhs_67177, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77653.mem, mem_77662.mem, mem_77664.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_77666 = (int64_t) 8 * ret_67383;
                    
                    if (cond_67381) {
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77662, "mem_77662") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77664, "mem_77664") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77669, bytes_77666, "mem_77669")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_77669, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_77667, bytes_77666, "mem_77667")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_78892 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77662.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        
                        int64_t tmp_offs_78893 = (int64_t) 0;
                        
                        if (!(tmp_offs_78893 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_78893 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77664.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78893 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77667, "mem_77667") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77669, "mem_77669") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
                        return 1;
                    
                    int64_t tmp_67398 = add64((int64_t) 1, p_67166);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77644.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77671.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77646.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77670.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
                        return 1;
                    
                    bool loop_cond_67411 = slt64(tmp_67398, numberOfWindows_54360);
                    bool loop_while_tmp_78867 = loop_cond_67411;
                    int64_t p_tmp_78868 = tmp_67398;
                    
                    loop_while_67165 = loop_while_tmp_78867;
                    p_67166 = p_tmp_78868;
                }
                defunc_0_windowed_partitionFunc_res_67161 = loop_while_67165;
                defunc_0_windowed_partitionFunc_res_67162 = p_67166;
                if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_77680, bytes_77643, "mem_77680")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77682, bytes_77643, "mem_77682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_78894 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_74182));
                
                {
                    err = gpu_kernel_inner_SMJ_floatzisegmap_74187(ctx, segmap_usable_groups_74183, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74018, 1, 1, (int64_t) 0, nR_54353, gt_rhs_66981, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zeze_rhs_67414, tR_mem_77625.mem, tS_mem_77626.mem, mem_77644.mem, mem_77646.mem, mem_77680.mem, mem_77682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_77904;
                int64_t ext_77903;
                int64_t ext_77902;
                int64_t ext_77901;
                bool defunc_0_join_chunks_res_67570;
                int64_t defunc_0_join_chunks_res_67571;
                bool loop_while_67574;
                int64_t p_67575;
                int64_t ctx_param_ext_77683;
                int64_t ctx_param_ext_77684;
                int64_t ctx_param_ext_77686;
                int64_t ctx_param_ext_77687;
                
                if (memblock_set_device(ctx, &mem_param_77685, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77688, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77683 = (int64_t) 0;
                ctx_param_ext_77684 = (int64_t) 1;
                ctx_param_ext_77686 = (int64_t) 0;
                ctx_param_ext_77687 = (int64_t) 1;
                loop_while_67574 = loop_cond_67569;
                p_67575 = (int64_t) 0;
                while (loop_while_67574) {
                    bool x_67578 = sle64((int64_t) 0, p_67575);
                    bool y_67579 = slt64(p_67575, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67580 = x_67578 && y_67579;
                    bool index_certs_67581;
                    
                    if (!bounds_check_67580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:187:22-34\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_79547;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79547, mem_77680.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67582 = read_res_79547;
                    int64_t read_res_79548;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79548, mem_77682.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67583 = read_res_79548;
                    int64_t min_res_67584 = smin64(zeze_rhs_67414, loopres_67583);
                    bool cond_67585 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, loopres_67582);
                    bool cond_67589 = slt64(min_res_67584, (int64_t) 0);
                    bool protect_assert_disj_67591 = bounds_check_67580 || cond_67589;
                    bool protect_assert_disj_78297 = cond_67585 || protect_assert_disj_67591;
                    bool index_certs_67592;
                    
                    if (!protect_assert_disj_78297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:191:19-32\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_67595 = add64((int64_t) 1, p_67575);
                    bool cond_67596 = zeze_lhs_67595 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    bool x_67598 = sle64((int64_t) 0, zeze_lhs_67595);
                    bool y_67599 = slt64(zeze_lhs_67595, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67600 = x_67598 && y_67599;
                    bool protect_assert_disj_67601 = cond_67596 || bounds_check_67600;
                    bool protect_assert_disj_67602 = cond_67589 || protect_assert_disj_67601;
                    bool protect_assert_disj_78300 = cond_67585 || protect_assert_disj_67602;
                    bool index_certs_67603;
                    
                    if (!protect_assert_disj_78300) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67595, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:192:49-64\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_78294 = !cond_67585;
                    bool x_67590 = !cond_67589;
                    bool protect_cond_conj_78298 = x_67590 && x_78294;
                    int64_t loopres_f_res_f_res_67593;
                    
                    if (protect_cond_conj_78298) {
                        int64_t read_res_79549;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79549, mem_77644.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68863 = read_res_79549;
                        
                        loopres_f_res_f_res_67593 = x_68863;
                    } else {
                        loopres_f_res_f_res_67593 = (int64_t) 0;
                    }
                    
                    bool x_67597 = !cond_67596;
                    bool protect_cond_conj_67604 = x_67590 && x_67597;
                    bool protect_cond_conj_78301 = protect_cond_conj_67604 && x_78294;
                    int64_t r_end_f_res_67605;
                    
                    if (protect_cond_conj_78301) {
                        int64_t read_res_79550;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79550, mem_77644.mem, zeze_lhs_67595 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68864 = read_res_79550;
                        
                        r_end_f_res_67605 = x_68864;
                    } else {
                        r_end_f_res_67605 = (int64_t) 0;
                    }
                    
                    int64_t r_end_67607;
                    
                    if (cond_67596) {
                        r_end_67607 = nR_54353;
                    } else {
                        r_end_67607 = r_end_f_res_67605;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 = sub64(r_end_67607, loopres_f_res_f_res_67593);
                    int64_t ext_77893;
                    
                    if (cond_67589) {
                        ext_77893 = ctx_param_ext_77683;
                    } else {
                        ext_77893 = (int64_t) 0;
                    }
                    
                    int64_t ext_77892;
                    
                    if (cond_67589) {
                        ext_77892 = ctx_param_ext_77684;
                    } else {
                        ext_77892 = (int64_t) 1;
                    }
                    
                    int64_t ext_77890;
                    
                    if (cond_67589) {
                        ext_77890 = ctx_param_ext_77686;
                    } else {
                        ext_77890 = (int64_t) 0;
                    }
                    
                    int64_t ext_77889;
                    
                    if (cond_67589) {
                        ext_77889 = ctx_param_ext_77687;
                    } else {
                        ext_77889 = (int64_t) 1;
                    }
                    
                    int64_t bytes_77689 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;
                    int64_t ext_77899;
                    
                    if (cond_67585) {
                        ext_77899 = ctx_param_ext_77683;
                    } else {
                        ext_77899 = ext_77893;
                    }
                    
                    int64_t ext_77898;
                    
                    if (cond_67585) {
                        ext_77898 = ctx_param_ext_77684;
                    } else {
                        ext_77898 = ext_77892;
                    }
                    
                    int64_t ext_77896;
                    
                    if (cond_67585) {
                        ext_77896 = ctx_param_ext_77686;
                    } else {
                        ext_77896 = ext_77890;
                    }
                    
                    int64_t ext_77895;
                    
                    if (cond_67585) {
                        ext_77895 = ctx_param_ext_77687;
                    } else {
                        ext_77895 = ext_77889;
                    }
                    
                    int64_t loopres_67586;
                    
                    if (cond_67585) {
                        loopres_67586 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    } else {
                        loopres_67586 = zeze_lhs_67595;
                    }
                    if (cond_67585) {
                        if (memblock_set_device(ctx, &ext_mem_77900, &mem_param_77685, "mem_param_77685") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &mem_param_77688, "mem_param_77688") != 0)
                            return 1;
                    } else {
                        if (cond_67589) {
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_param_77685, "mem_param_77685") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_param_77688, "mem_param_77688") != 0)
                                return 1;
                        } else {
                            bool empty_slice_67611 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 == (int64_t) 0;
                            int64_t m_67612 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 1);
                            int64_t i_p_m_t_s_67613 = add64(loopres_f_res_f_res_67593, m_67612);
                            bool zzero_leq_i_p_m_t_s_67614 = sle64((int64_t) 0, i_p_m_t_s_67613);
                            bool i_p_m_t_s_leq_w_67615 = slt64(i_p_m_t_s_67613, nR_54353);
                            bool zzero_lte_i_67616 = sle64((int64_t) 0, loopres_f_res_f_res_67593);
                            bool i_lte_j_67617 = sle64(loopres_f_res_f_res_67593, r_end_67607);
                            bool y_67618 = i_p_m_t_s_leq_w_67615 && zzero_lte_i_67616;
                            bool y_67619 = zzero_leq_i_p_m_t_s_67614 && y_67618;
                            bool forwards_ok_67620 = i_lte_j_67617 && y_67619;
                            bool ok_or_empty_67621 = empty_slice_67611 || forwards_ok_67620;
                            bool index_certs_67622;
                            
                            if (!ok_or_empty_67621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_67593, ":", (long long) r_end_67607, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftSMJ.fut:193:16-33\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_67625 = sle64(loopres_67582, min_res_67584);
                            bool loop_not_taken_67630 = !loop_cond_67625;
                            bool protect_assert_disj_67631 = loop_not_taken_67630 || nonzzero_68535;
                            bool nonzzero_cert_67632;
                            
                            if (!protect_assert_disj_67631) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77690, bytes_77689, "mem_77690")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77692, bytes_77689, "mem_77692")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77692, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_67626 = add64(extParallelism_54361, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                            int64_t zs_lhs_67627 = sub64(zm_lhs_67626, (int64_t) 1);
                            int64_t numIter_67633 = sdiv_safe64(zs_lhs_67627, extParallelism_54361);
                            bool loop_cond_67634 = slt64((int64_t) 0, numIter_67633);
                            bool loop_not_taken_67635 = !loop_cond_67634;
                            int64_t segmap_tblock_sizze_74535;
                            
                            segmap_tblock_sizze_74535 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74525;
                            
                            int64_t segmap_usable_groups_74536 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74535);
                            int64_t segmap_tblock_sizze_74556;
                            
                            segmap_tblock_sizze_74556 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74547;
                            
                            int64_t segmap_usable_groups_74557 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74556);
                            
                            if (memblock_alloc_device(ctx, &mem_77711, (int64_t) 4, "mem_77711")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77712, (int64_t) 4, "mem_77712")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77715, (int64_t) 1, "mem_77715")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_67636;
                            int64_t loopres_f_res_f_res_67637;
                            bool loop_while_67640;
                            int64_t dp_67641;
                            
                            if (memblock_set_device(ctx, &mem_param_77695, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_77698, &mem_77690, "mem_77690") != 0)
                                return 1;
                            loop_while_67640 = loop_cond_67625;
                            dp_67641 = loopres_67582;
                            while (loop_while_67640) {
                                bool x_67644 = sle64((int64_t) 0, dp_67641);
                                bool y_67645 = slt64(dp_67641, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67646 = x_67644 && y_67645;
                                bool index_certs_67647;
                                
                                if (!bounds_check_67646) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_67641, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:197:21-38\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_79551;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_79551, mem_77646.mem, dp_67641 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_67648 = read_res_79551;
                                int64_t zeze_lhs_67649 = add64((int64_t) 1, dp_67641);
                                bool cond_67650 = zeze_lhs_67649 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                                bool x_67651 = !cond_67650;
                                bool x_67652 = sle64((int64_t) 0, zeze_lhs_67649);
                                bool y_67653 = slt64(zeze_lhs_67649, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67654 = x_67652 && y_67653;
                                bool protect_assert_disj_67655 = cond_67650 || bounds_check_67654;
                                bool index_certs_67656;
                                
                                if (!protect_assert_disj_67655) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67649, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:198:55-74\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_67657;
                                
                                if (x_67651) {
                                    int64_t read_res_79552;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79552, mem_77646.mem, zeze_lhs_67649 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_68865 = read_res_79552;
                                    
                                    s_end_f_res_67657 = x_68865;
                                } else {
                                    s_end_f_res_67657 = (int64_t) 0;
                                }
                                
                                int64_t s_end_67659;
                                
                                if (cond_67650) {
                                    s_end_67659 = nR_54353;
                                } else {
                                    s_end_67659 = s_end_f_res_67657;
                                }
                                
                                int64_t j_m_i_67660 = sub64(s_end_67659, loopres_67648);
                                bool empty_slice_67661 = j_m_i_67660 == (int64_t) 0;
                                int64_t m_67662 = sub64(j_m_i_67660, (int64_t) 1);
                                int64_t i_p_m_t_s_67663 = add64(loopres_67648, m_67662);
                                bool zzero_leq_i_p_m_t_s_67664 = sle64((int64_t) 0, i_p_m_t_s_67663);
                                bool i_p_m_t_s_leq_w_67665 = slt64(i_p_m_t_s_67663, nR_54353);
                                bool zzero_lte_i_67666 = sle64((int64_t) 0, loopres_67648);
                                bool i_lte_j_67667 = sle64(loopres_67648, s_end_67659);
                                bool y_67668 = i_p_m_t_s_leq_w_67665 && zzero_lte_i_67666;
                                bool y_67669 = zzero_leq_i_p_m_t_s_67664 && y_67668;
                                bool forwards_ok_67670 = i_lte_j_67667 && y_67669;
                                bool ok_or_empty_67671 = empty_slice_67661 || forwards_ok_67670;
                                bool index_certs_67672;
                                
                                if (!ok_or_empty_67671) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_67648, ":", (long long) s_end_67659, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  ftSMJ.fut:199:18-35\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_67675 = slt64((int64_t) 0, j_m_i_67660);
                                bool loop_not_taken_67676 = !cond_67675;
                                bool x_67677 = sle64((int64_t) 0, m_67662);
                                bool y_67678 = slt64(m_67662, j_m_i_67660);
                                bool bounds_check_67682 = x_67677 && y_67678;
                                bool protect_assert_disj_67683 = loop_not_taken_67676 || bounds_check_67682;
                                bool protect_assert_disj_67684 = loop_not_taken_67635 || protect_assert_disj_67683;
                                bool index_certs_67685;
                                
                                if (!protect_assert_disj_67684) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67662, "] out of bounds for array of shape [", (long long) j_m_i_67660, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_68069 = tS_start_66998 + loopres_67648;
                                int64_t find_joinTuples_arg3_67674 = add64(join_chunks_arg3_67139, loopres_67648);
                                bool protect_cond_conj_67679 = loop_cond_67634 && cond_67675;
                                
                                if (protect_cond_conj_67679) {
                                    if (memblock_alloc_device(ctx, &mem_77700, (int64_t) 4, "mem_77700")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78923(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68069, tS_mem_77626.mem, mem_77700.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77700, "mem_77700") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77699, (int64_t) 4, "mem_77699")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f32(ctx, mem_77699, (int64_t) 1, 0.0F) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77699, "mem_77699") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_67679) {
                                    int64_t slice_68867 = tS_start_66998 + i_p_m_t_s_67663;
                                    
                                    if (memblock_alloc_device(ctx, &mem_77703, (int64_t) 4, "mem_77703")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78929(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68867, tS_mem_77626.mem, mem_77703.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77703, "mem_77703") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77702, (int64_t) 4, "mem_77702")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f32(ctx, mem_77702, (int64_t) 1, 0.0F) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77702, "mem_77702") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_77717 = (int64_t) 4 * j_m_i_67660;
                                int64_t ext_77864;
                                int64_t ext_77863;
                                int64_t ext_77862;
                                int64_t ext_77861;
                                bool defunc_0_find_joinTuples_res_67688;
                                int64_t defunc_0_find_joinTuples_res_67689;
                                bool loop_while_67692;
                                int64_t p_67693;
                                int64_t ctx_param_ext_77705;
                                int64_t ctx_param_ext_77706;
                                int64_t ctx_param_ext_77708;
                                int64_t ctx_param_ext_77709;
                                
                                if (memblock_set_device(ctx, &mem_param_77707, &mem_77692, "mem_77692") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77710, &mem_77690, "mem_77690") != 0)
                                    return 1;
                                ctx_param_ext_77705 = (int64_t) 0;
                                ctx_param_ext_77706 = (int64_t) 1;
                                ctx_param_ext_77708 = (int64_t) 0;
                                ctx_param_ext_77709 = (int64_t) 1;
                                loop_while_67692 = loop_cond_67634;
                                p_67693 = (int64_t) 0;
                                while (loop_while_67692) {
                                    int64_t start_67696 = mul64(extParallelism_54361, p_67693);
                                    int64_t min_arg1_67697 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, start_67696);
                                    int64_t min_res_67698 = smin64(extParallelism_54361, min_arg1_67697);
                                    int64_t iter_R_67699 = add64(start_67696, min_res_67698);
                                    bool empty_slice_67700 = min_res_67698 == (int64_t) 0;
                                    int64_t m_67701 = sub64(min_res_67698, (int64_t) 1);
                                    int64_t i_p_m_t_s_67702 = add64(start_67696, m_67701);
                                    bool zzero_leq_i_p_m_t_s_67703 = sle64((int64_t) 0, i_p_m_t_s_67702);
                                    bool i_p_m_t_s_leq_w_67704 = slt64(i_p_m_t_s_67702, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                                    bool zzero_lte_i_67705 = sle64((int64_t) 0, start_67696);
                                    bool i_lte_j_67706 = sle64(start_67696, iter_R_67699);
                                    bool y_67707 = i_p_m_t_s_leq_w_67704 && zzero_lte_i_67705;
                                    bool y_67708 = zzero_leq_i_p_m_t_s_67703 && y_67707;
                                    bool forwards_ok_67709 = i_lte_j_67706 && y_67708;
                                    bool ok_or_empty_67710 = empty_slice_67700 || forwards_ok_67709;
                                    bool index_certs_67711;
                                    
                                    if (!ok_or_empty_67710) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67696, ":", (long long) iter_R_67699, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67718 = slt64(m_67701, min_res_67698);
                                    bool x_67717 = sle64((int64_t) 0, m_67701);
                                    bool bounds_check_67719 = x_67717 && y_67718;
                                    bool index_certs_67720;
                                    
                                    if (!bounds_check_67719) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67701, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67714 = slt64((int64_t) 0, min_res_67698);
                                    bool index_certs_67715;
                                    
                                    if (!y_67714) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:390:133-136\n   #2  ftSMJ.fut:379:1-390:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_67712 = loopres_f_res_f_res_67593 + start_67696;
                                    int64_t slice_67721 = loopres_f_res_f_res_67593 + i_p_m_t_s_67702;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78945(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_67712, slice_67721, tR_mem_77625.mem, mem_77711.mem, mem_77712.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77713, &ext_mem_77704, "ext_mem_77704") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77713, &mem_77711, "mem_77711") != 0)
                                        return 1;
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77714, &ext_mem_77701, "ext_mem_77701") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77714, &mem_77712, "mem_77712") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_78951(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77712.mem, ext_mem_77713.mem, mem_77715.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
                                        return 1;
                                    
                                    bool read_res_79553;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79553, mem_77715.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_67725 = read_res_79553;
                                    int64_t ext_77859;
                                    int64_t ext_77858;
                                    int64_t ext_77856;
                                    int64_t ext_77855;
                                    int64_t loopres_67726;
                                    
                                    if (defunc_0_gt_res_67725) {
                                        if (memblock_set_device(ctx, &ext_mem_77860, &mem_param_77707, "mem_param_77707") != 0)
                                            return 1;
                                        ext_77859 = ctx_param_ext_77705;
                                        ext_77858 = ctx_param_ext_77706;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &mem_param_77710, "mem_param_77710") != 0)
                                            return 1;
                                        ext_77856 = ctx_param_ext_77708;
                                        ext_77855 = ctx_param_ext_77709;
                                        loopres_67726 = numIter_67633;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_77716, (int64_t) 1, "mem_77716")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_floatzigpuseq_78957(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77711.mem, ext_mem_77714.mem, mem_77716.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_79554;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_79554, mem_77716.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_67729 = read_res_79554;
                                        
                                        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
                                            return 1;
                                        
                                        int64_t ext_77853;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77853 = ctx_param_ext_77705;
                                        } else {
                                            ext_77853 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77852;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77852 = ctx_param_ext_77706;
                                        } else {
                                            ext_77852 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_77850;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77850 = ctx_param_ext_77708;
                                        } else {
                                            ext_77850 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77849;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77849 = ctx_param_ext_77709;
                                        } else {
                                            ext_77849 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_67730;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            int64_t tmp_68871 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_param_77707, "mem_param_77707") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_param_77710, "mem_param_77710") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_68871;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_77718, bytes_77717, "mem_77718")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77718.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, slice_68069, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67660})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_9949(ctx, &ext_mem_77720, mem_77718, j_m_i_67660, find_joinTuples_arg3_67674) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_74347;
                                            
                                            suff_outer_par_74347 = *ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_1 <= min_res_67698;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_float.suff_outer_par_1", (long) min_res_67698, suff_outer_par_74347 ? "true" : "false");
                                            
                                            int64_t tile_sizze_77124;
                                            
                                            tile_sizze_77124 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123;
                                            
                                            int64_t tile_sizze_76769;
                                            
                                            tile_sizze_76769 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768;
                                            
                                            int64_t num_whole_tiles_77140 = squot_safe64(j_m_i_67660, tile_sizze_77124);
                                            int64_t residual_input_77364 = srem_safe64(j_m_i_67660, tile_sizze_77124);
                                            bool cond_77365 = residual_input_77364 == (int64_t) 0;
                                            int64_t binop_x_77381 = tile_sizze_77124 * num_whole_tiles_77140;
                                            int64_t bytes_77778 = (int64_t) 8 * min_res_67698;
                                            int64_t bytes_77741 = (int64_t) 8 * tile_sizze_77124;
                                            int64_t bytes_77743 = (int64_t) 4 * tile_sizze_77124;
                                            int64_t num_whole_tiles_76785 = squot_safe64(j_m_i_67660, tile_sizze_76769);
                                            int64_t residual_input_77009 = srem_safe64(j_m_i_67660, tile_sizze_76769);
                                            bool cond_77010 = residual_input_77009 == (int64_t) 0;
                                            int64_t binop_x_77026 = tile_sizze_76769 * num_whole_tiles_76785;
                                            int64_t bytes_77802 = (int64_t) 8 * tile_sizze_76769;
                                            int64_t bytes_77804 = (int64_t) 4 * tile_sizze_76769;
                                            int64_t shared_memory_capacity_79015;
                                            
                                            shared_memory_capacity_79015 = ctx->max_shared_memory;
                                            if (suff_outer_par_74347 && sle64(sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77804, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_79015)) {
                                                int64_t ldim_76770 = sdiv_up64(min_res_67698, tile_sizze_76769);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77840, bytes_77778, "mem_77840")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77842, bytes_77778, "mem_77842")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78963 = sext_i64_i32(sdiv_up64(tile_sizze_76769, tile_sizze_76769));
                                                int32_t virt_num_tblocks_78964 = sext_i64_i32(ldim_76770);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_76767(ctx, ldim_76770, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_76768, 1, 1, bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8) + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8)) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_76770, num_whole_tiles_76785, residual_input_77009, cond_77010, binop_x_77026, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77840.mem, mem_77842.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77840, "mem_77840") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77842, "mem_77842") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_77125 = sdiv_up64(min_res_67698, tile_sizze_77124);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77779, bytes_77778, "mem_77779")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77781, bytes_77778, "mem_77781")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78989 = sext_i64_i32(sdiv_up64(tile_sizze_77124, tile_sizze_77124));
                                                int32_t virt_num_tblocks_78990 = sext_i64_i32(ldim_77125);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_77122(ctx, ldim_77125, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_77123, 1, 1, bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8) + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8)) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_77125, num_whole_tiles_77140, residual_input_77364, cond_77365, binop_x_77381, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77779.mem, mem_77781.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77779, "mem_77779") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77781, "mem_77781") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77846, bytes_77689, "mem_77846")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77710.mem, ctx_param_ext_77708, (int64_t []) {ctx_param_ext_77709}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77848, bytes_77689, "mem_77848")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77707.mem, ctx_param_ext_77705, (int64_t []) {ctx_param_ext_77706}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77843.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
                                                return 1;
                                            
                                            int64_t tmp_67777 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_77848, "mem_77848") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_77846, "mem_77846") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_67777;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_77860, &ext_mem_77854, "ext_mem_77854") != 0)
                                            return 1;
                                        ext_77859 = ext_77853;
                                        ext_77858 = ext_77852;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &ext_mem_77851, "ext_mem_77851") != 0)
                                            return 1;
                                        ext_77856 = ext_77850;
                                        ext_77855 = ext_77849;
                                        loopres_67726 = loopres_f_res_67730;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
                                        return 1;
                                    
                                    bool loop_cond_67778 = slt64(loopres_67726, numIter_67633);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_78935, &ext_mem_77860, "ext_mem_77860") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_78936, &ext_mem_77857, "ext_mem_77857") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_78937 = ext_77859;
                                    int64_t ctx_param_ext_tmp_78938 = ext_77858;
                                    int64_t ctx_param_ext_tmp_78939 = ext_77856;
                                    int64_t ctx_param_ext_tmp_78940 = ext_77855;
                                    bool loop_while_tmp_78941 = loop_cond_67778;
                                    int64_t p_tmp_78942 = loopres_67726;
                                    
                                    if (memblock_set_device(ctx, &mem_param_77707, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_77710, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
                                        return 1;
                                    ctx_param_ext_77705 = ctx_param_ext_tmp_78937;
                                    ctx_param_ext_77706 = ctx_param_ext_tmp_78938;
                                    ctx_param_ext_77708 = ctx_param_ext_tmp_78939;
                                    ctx_param_ext_77709 = ctx_param_ext_tmp_78940;
                                    loop_while_67692 = loop_while_tmp_78941;
                                    p_67693 = p_tmp_78942;
                                }
                                if (memblock_set_device(ctx, &ext_mem_77866, &mem_param_77707, "mem_param_77707") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_77865, &mem_param_77710, "mem_param_77710") != 0)
                                    return 1;
                                ext_77864 = ctx_param_ext_77705;
                                ext_77863 = ctx_param_ext_77706;
                                ext_77862 = ctx_param_ext_77708;
                                ext_77861 = ctx_param_ext_77709;
                                defunc_0_find_joinTuples_res_67688 = loop_while_67692;
                                defunc_0_find_joinTuples_res_67689 = p_67693;
                                if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77869, bytes_77689, "mem_77869")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79016 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74535));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_74539(ctx, segmap_usable_groups_74536, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74525, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77861, ext_77862, mem_param_77698.mem, ext_mem_77865.mem, mem_77869.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77872, bytes_77689, "mem_77872")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79025 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74556));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_74560(ctx, segmap_usable_groups_74557, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74547, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77863, ext_77864, mem_param_77695.mem, ext_mem_77866.mem, mem_77872.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
                                    return 1;
                                
                                bool loop_cond_67788 = sle64(zeze_lhs_67649, min_res_67584);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_78917, &mem_77872, "mem_77872") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_78918, &mem_77869, "mem_77869") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_78919 = loop_cond_67788;
                                int64_t dp_tmp_78920 = zeze_lhs_67649;
                                
                                if (memblock_set_device(ctx, &mem_param_77695, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77698, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
                                    return 1;
                                loop_while_67640 = loop_while_tmp_78919;
                                dp_67641 = dp_tmp_78920;
                            }
                            if (memblock_set_device(ctx, &ext_mem_77878, &mem_param_77695, "mem_param_77695") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77877, &mem_param_77698, "mem_param_77698") != 0)
                                return 1;
                            loopres_f_res_f_res_67636 = loop_while_67640;
                            loopres_f_res_f_res_67637 = dp_67641;
                            if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_74577;
                            
                            segmap_tblock_sizze_74577 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74567;
                            
                            int64_t segmap_usable_groups_74578 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74577);
                            
                            if (memblock_alloc_device(ctx, &mem_77881, bytes_77689, "mem_77881")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79034 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74577));
                            
                            {
                                err = gpu_kernel_inner_SMJ_floatzisegmap_74581(ctx, segmap_usable_groups_74578, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74567, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77686, ctx_param_ext_77687, mem_param_77688.mem, ext_mem_77877.mem, mem_77881.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_74598;
                            
                            segmap_tblock_sizze_74598 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74589;
                            
                            int64_t segmap_usable_groups_74599 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74598);
                            
                            if (memblock_alloc_device(ctx, &mem_77884, bytes_77689, "mem_77884")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79043 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_74598));
                            
                            {
                                err = gpu_kernel_inner_SMJ_floatzisegmap_74602(ctx, segmap_usable_groups_74599, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74589, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77683, ctx_param_ext_77684, mem_param_77685.mem, ext_mem_77878.mem, mem_77884.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77886, bytes_77628, "mem_77886")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77688.mem, ctx_param_ext_77686, (int64_t []) {ctx_param_ext_77687}, (int64_t []) {nR_54353})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77881.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77888, bytes_77628, "mem_77888")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77685.mem, ctx_param_ext_77683, (int64_t []) {ctx_param_ext_77684}, (int64_t []) {nR_54353})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77884.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_77888, "mem_77888") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_77886, "mem_77886") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_77900, &ext_mem_77894, "ext_mem_77894") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &ext_mem_77891, "ext_mem_77891") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_67804 = slt64(loopres_67586, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78907, &ext_mem_77900, "ext_mem_77900") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78908, &ext_mem_77897, "ext_mem_77897") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78909 = ext_77899;
                    int64_t ctx_param_ext_tmp_78910 = ext_77898;
                    int64_t ctx_param_ext_tmp_78911 = ext_77896;
                    int64_t ctx_param_ext_tmp_78912 = ext_77895;
                    bool loop_while_tmp_78913 = loop_cond_67804;
                    int64_t p_tmp_78914 = loopres_67586;
                    
                    if (memblock_set_device(ctx, &mem_param_77685, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77688, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
                        return 1;
                    ctx_param_ext_77683 = ctx_param_ext_tmp_78909;
                    ctx_param_ext_77684 = ctx_param_ext_tmp_78910;
                    ctx_param_ext_77686 = ctx_param_ext_tmp_78911;
                    ctx_param_ext_77687 = ctx_param_ext_tmp_78912;
                    loop_while_67574 = loop_while_tmp_78913;
                    p_67575 = p_tmp_78914;
                }
                if (memblock_set_device(ctx, &ext_mem_77906, &mem_param_77685, "mem_param_77685") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_77905, &mem_param_77688, "mem_param_77688") != 0)
                    return 1;
                ext_77904 = ctx_param_ext_77683;
                ext_77903 = ctx_param_ext_77684;
                ext_77902 = ctx_param_ext_77686;
                ext_77901 = ctx_param_ext_77687;
                defunc_0_join_chunks_res_67570 = loop_while_67574;
                defunc_0_join_chunks_res_67571 = p_67575;
                if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_77906, "ext_mem_77906") != 0)
                    return 1;
                ext_78076 = ext_77904;
                ext_78075 = ext_77903;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_77905, "ext_mem_77905") != 0)
                    return 1;
                ext_78073 = ext_77902;
                ext_78072 = ext_77901;
            }
            
            int64_t segmap_tblock_sizze_74619;
            
            segmap_tblock_sizze_74619 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74609;
            
            int64_t segmap_usable_groups_74620 = sdiv_up64(nR_54353, segmap_tblock_sizze_74619);
            
            if (memblock_alloc_device(ctx, &mem_78080, bytes_77628, "mem_78080")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79052 = sext_i64_i32(sdiv_up64(nR_54353, segmap_tblock_sizze_74619));
            
            {
                err = gpu_kernel_inner_SMJ_floatzisegmap_74623(ctx, segmap_usable_groups_74620, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74609, 1, 1, (int64_t) 0, nR_54353, ext_78072, ext_78073, mem_param_77640.mem, ext_mem_78074.mem, mem_78080.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_74640;
            
            segmap_tblock_sizze_74640 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74631;
            
            int64_t segmap_usable_groups_74641 = sdiv_up64(nR_54353, segmap_tblock_sizze_74640);
            
            if (memblock_alloc_device(ctx, &mem_78083, bytes_77628, "mem_78083")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79061 = sext_i64_i32(sdiv_up64(nR_54353, segmap_tblock_sizze_74640));
            
            {
                err = gpu_kernel_inner_SMJ_floatzisegmap_74644(ctx, segmap_usable_groups_74641, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74631, 1, 1, (int64_t) 0, nR_54353, ext_78075, ext_78076, mem_param_77637.mem, ext_mem_78077.mem, mem_78083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_78084, (int64_t) 1, "mem_78084")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_floatzigpuseq_79070(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, i_p_m_t_s_67004, tR_mem_77625.mem, tS_mem_77626.mem, mem_78084.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_79555;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_79555, mem_78084.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_67821 = read_res_79555;
            
            if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
                return 1;
            
            int64_t nextIter_67822;
            
            if (defunc_0_leq_res_67821) {
                int64_t nextIter_t_res_68886 = add64((int64_t) 1, p_66995);
                
                nextIter_67822 = nextIter_t_res_68886;
            } else {
                nextIter_67822 = numIter_66975;
            }
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_78083, "mem_78083") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_78080, "mem_78080") != 0)
                return 1;
            loopres_67019 = nextIter_67822;
        }
        
        bool loop_cond_67824 = slt64(loopres_67019, numIter_66975);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78750, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78751, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        
        bool loop_while_tmp_78752 = loop_cond_67824;
        int64_t p_tmp_78753 = loopres_67019;
        
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77640, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        loop_while_66994 = loop_while_tmp_78752;
        p_66995 = p_tmp_78753;
    }
    if (memblock_set_device(ctx, &ext_mem_78096, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78095, &mem_param_77640, "mem_param_77640") != 0)
        return 1;
    defunc_0_mergeJoin_res_66990 = loop_while_66994;
    defunc_0_mergeJoin_res_66991 = p_66995;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_74650;
    
    segscan_tblock_sizze_74650 = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74649;
    
    int64_t num_tblocks_74652;
    int64_t max_num_tblocks_79076;
    
    max_num_tblocks_79076 = *ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_74651;
    num_tblocks_74652 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_54353, segscan_tblock_sizze_74650), max_num_tblocks_79076)));
    if (memblock_alloc_device(ctx, &mem_78099, bytes_77628, "mem_78099")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78101, bytes_77628, "mem_78101")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_54353)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79077;
        
        shared_memory_79077 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79078;
        
        thread_block_sizze_79078 = ctx->max_thread_block_size;
        
        int64_t registers_79079;
        
        registers_79079 = ctx->max_registers;
        
        int64_t thread_block_sizze_79080;
        
        thread_block_sizze_79080 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79081 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79077, thread_block_sizze_79078), (int64_t) 8), squot64(squot64(registers_79079, thread_block_sizze_79080) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79082 = sdiv_up64(nR_54353, segscan_tblock_sizze_74650 * chunk_sizze_79081);
        int64_t num_virt_threads_79083 = num_virt_blocks_79082 * segscan_tblock_sizze_74650;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79081, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79084, num_virt_blocks_79082, "status_flags_mem_79084")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79084, num_virt_blocks_79082, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79106, (int64_t) 8 * num_virt_blocks_79082, "aggregates_mem_79106")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79108, (int64_t) 8 * num_virt_blocks_79082, "incprefixes_mem_79108")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzisegscan_74655(ctx, num_tblocks_74652, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74649, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74650), chunk_sizze_79081 * segscan_tblock_sizze_74650 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74650), chunk_sizze_79081 * segscan_tblock_sizze_74650 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_54353, num_tblocks_74652, num_virt_blocks_79082, num_virt_threads_79083, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, status_flags_mem_79084.mem, aggregates_mem_79106.mem, incprefixes_mem_79108.mem, global_dynid_mem_79110.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_67840 = zzero_66972 || bounds_check_66984;
    bool index_certs_67841;
    
    if (!protect_assert_disj_67840) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67842;
    
    if (nonzzero_66973) {
        int64_t read_res_79556;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79556, mem_78099.mem, gt_rhs_66981 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68889 = read_res_79556;
        
        m_f_res_67842 = x_68889;
    } else {
        m_f_res_67842 = (int64_t) 0;
    }
    
    int64_t m_67844;
    
    if (zzero_66972) {
        m_67844 = (int64_t) 0;
    } else {
        m_67844 = m_f_res_67842;
    }
    
    int64_t m_67854 = sub64(m_67844, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67856 = slt64(m_67854, nR_54353);
    bool zzero_leq_i_p_m_t_s_67855 = sle64((int64_t) 0, m_67854);
    bool y_67858 = zzero_leq_i_p_m_t_s_67855 && i_p_m_t_s_leq_w_67856;
    bool i_lte_j_67857 = sle64((int64_t) 0, m_67844);
    bool forwards_ok_67859 = i_lte_j_67857 && y_67858;
    bool eq_x_zz_67851 = (int64_t) 0 == m_f_res_67842;
    bool p_and_eq_x_y_67852 = nonzzero_66973 && eq_x_zz_67851;
    bool empty_slice_67853 = zzero_66972 || p_and_eq_x_y_67852;
    bool ok_or_empty_67860 = empty_slice_67853 || forwards_ok_67859;
    bool index_certs_67861;
    
    if (!ok_or_empty_67860) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67844, "] out of bounds for array of shape [", (long long) nR_54353, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78102 = (int64_t) 8 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78103, bytes_78102, "mem_78103")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78096.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78105, bytes_78102, "mem_78105")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78095.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78107, bytes_78102, "mem_78107")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78107.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t bytes_78108 = (int64_t) 4 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78109, bytes_78108, "mem_78109")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78109.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_77625.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_74660;
    
    segmap_tblock_sizze_74660 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74659;
    
    int64_t num_tblocks_74662;
    int64_t max_num_tblocks_79219;
    
    max_num_tblocks_79219 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74661;
    num_tblocks_74662 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_54353, segmap_tblock_sizze_74660), max_num_tblocks_79219)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79220 = sext_i64_i32(sdiv_up64(nR_54353, segmap_tblock_sizze_74660));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_74657(ctx, num_tblocks_74662, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74659, 1, 1, (int64_t) 0, nR_54353, m_67844, num_tblocks_74662, virt_num_tblocks_79220, tR_mem_77625.mem, ext_mem_77627.mem, ext_mem_78095.mem, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, mem_78103.mem, mem_78105.mem, mem_78107.mem, mem_78109.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_74666;
    
    segscan_tblock_sizze_74666 = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74665;
    
    int64_t num_tblocks_74668;
    int64_t max_num_tblocks_79233;
    
    max_num_tblocks_79233 = *ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_74667;
    num_tblocks_74668 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segscan_tblock_sizze_74666), max_num_tblocks_79233)));
    if (memblock_alloc_device(ctx, &mem_78113, bytes_78102, "mem_78113")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78115, bytes_78102, "mem_78115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78117, bytes_78102, "mem_78117")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_67844)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79234;
        
        shared_memory_79234 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79235;
        
        thread_block_sizze_79235 = ctx->max_thread_block_size;
        
        int64_t registers_79236;
        
        registers_79236 = ctx->max_registers;
        
        int64_t thread_block_sizze_79237;
        
        thread_block_sizze_79237 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79238 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79234, thread_block_sizze_79235), (int64_t) 8), squot64(squot64(registers_79236, thread_block_sizze_79237) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79239 = sdiv_up64(m_67844, segscan_tblock_sizze_74666 * chunk_sizze_79238);
        int64_t num_virt_threads_79240 = num_virt_blocks_79239 * segscan_tblock_sizze_74666;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79238, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79241, num_virt_blocks_79239, "status_flags_mem_79241")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79241, num_virt_blocks_79239, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79243, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79243")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79245, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79245")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79247, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79247")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79249, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79249")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzisegscan_74671(ctx, num_tblocks_74668, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_74665, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_74666, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_74666), smax64(chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_74666, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_74666), smax64(chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_74666 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_67844, num_tblocks_74668, num_virt_blocks_79239, num_virt_threads_79240, mem_78103.mem, mem_78113.mem, mem_78115.mem, mem_78117.mem, status_flags_mem_79241.mem, aggregates_mem_79243.mem, incprefixes_mem_79245.mem, aggregates_mem_79247.mem, incprefixes_mem_79249.mem, global_dynid_mem_79251.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_74687;
    
    segmap_tblock_sizze_74687 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74675;
    
    int64_t segmap_usable_groups_74688 = sdiv_up64(m_67844, segmap_tblock_sizze_74687);
    
    if (memblock_alloc_device(ctx, &mem_78120, bytes_78102, "mem_78120")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79386 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_74687));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_74691(ctx, segmap_usable_groups_74688, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74675, 1, 1, (int64_t) 0, m_67844, mem_78113.mem, mem_78120.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
        return 1;
    
    bool cond_67895 = slt64((int64_t) 0, m_67844);
    bool y_67896 = slt64(m_67854, m_67844);
    bool bounds_check_67897 = zzero_leq_i_p_m_t_s_67855 && y_67896;
    bool loop_not_taken_67898 = !cond_67895;
    bool protect_assert_disj_67899 = bounds_check_67897 || loop_not_taken_67898;
    bool index_certs_67900;
    
    if (!protect_assert_disj_67899) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  ftSMJ.fut:285:10-41\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78122, (int64_t) 8, "mem_78122")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_79395(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78120.mem, mem_78122.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78122, "mem_78122") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78121, (int64_t) 8, "mem_78121")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78121, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78121, "mem_78121") != 0)
            return 1;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78125, (int64_t) 8, "mem_78125")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_79401(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78103.mem, mem_78125.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78125, "mem_78125") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78124, (int64_t) 8, "mem_78124")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78124, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78124, "mem_78124") != 0)
            return 1;
    }
    
    bool zzero_67912 = scatter_psizze_54362 == (int64_t) 0;
    bool nonzzero_67913 = !zzero_67912;
    bool nonzzero_cert_67914;
    
    if (!nonzzero_67913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_67979 = !empty_slice_67853;
    bool protect_assert_disj_67980 = empty_slice_67853 || bounds_check_67897;
    bool index_certs_67981;
    
    if (!protect_assert_disj_67980) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67982;
    
    if (x_67979) {
        int64_t read_res_79557;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79557, mem_78115.mem, m_67854 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68897 = read_res_79557;
        
        m_f_res_67982 = x_68897;
    } else {
        m_f_res_67982 = (int64_t) 0;
    }
    
    int64_t m_67984;
    
    if (empty_slice_67853) {
        m_67984 = (int64_t) 0;
    } else {
        m_67984 = m_f_res_67982;
    }
    
    int64_t m_67994 = sub64(m_67984, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67996 = slt64(m_67994, m_67844);
    bool zzero_leq_i_p_m_t_s_67995 = sle64((int64_t) 0, m_67994);
    bool y_67998 = zzero_leq_i_p_m_t_s_67995 && i_p_m_t_s_leq_w_67996;
    bool i_lte_j_67997 = sle64((int64_t) 0, m_67984);
    bool forwards_ok_67999 = i_lte_j_67997 && y_67998;
    bool eq_x_zz_67991 = (int64_t) 0 == m_f_res_67982;
    bool p_and_eq_x_y_67992 = x_67979 && eq_x_zz_67991;
    bool empty_slice_67993 = empty_slice_67853 || p_and_eq_x_y_67992;
    bool ok_or_empty_68000 = empty_slice_67993 || forwards_ok_67999;
    bool index_certs_68001;
    
    if (!ok_or_empty_68000) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67984, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:390:133-136\n   #4  ftSMJ.fut:379:1-390:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78127 = (int64_t) 8 * m_67984;
    
    if (memblock_alloc_device(ctx, &mem_78132, (int64_t) 8, "mem_78132")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_floatzigpuseq_79407(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_78123.mem, ext_mem_78126.mem, mem_78132.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
        return 1;
    
    int64_t n_pairs_t_res_67905;
    
    if (cond_67895) {
        int64_t read_res_79558;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79558, mem_78132.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_77623 = read_res_79558;
        
        n_pairs_t_res_67905 = x_77623;
    } else {
        n_pairs_t_res_67905 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
        return 1;
    
    int64_t n_pairs_67906;
    
    if (cond_67895) {
        n_pairs_67906 = n_pairs_t_res_67905;
    } else {
        n_pairs_67906 = (int64_t) 0;
    }
    
    int64_t bytes_78133 = (int64_t) 4 * n_pairs_67906;
    int64_t bytes_78135 = (int64_t) 8 * n_pairs_67906;
    int64_t segmap_tblock_sizze_74702;
    
    segmap_tblock_sizze_74702 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74701;
    
    int64_t num_tblocks_74704;
    int64_t max_num_tblocks_79413;
    
    max_num_tblocks_79413 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74703;
    num_tblocks_74704 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_74702), max_num_tblocks_79413)));
    if (memblock_alloc_device(ctx, &mem_78128, bytes_78127, "mem_78128")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78128.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78130, bytes_78127, "mem_78130")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78130.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78120.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_74710;
    
    segmap_tblock_sizze_74710 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74709;
    
    int64_t num_tblocks_74712;
    int64_t max_num_tblocks_79414;
    
    max_num_tblocks_79414 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_74711;
    num_tblocks_74712 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_74710), max_num_tblocks_79414)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79415 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_74710));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_74707(ctx, num_tblocks_74712, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74709, 1, 1, (int64_t) 0, m_67844, m_67984, num_tblocks_74712, virt_num_tblocks_79415, mem_78103.mem, mem_78115.mem, mem_78117.mem, mem_78120.mem, mem_78128.mem, mem_78130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
        return 1;
    
    bool cond_68011 = slt64((int64_t) 0, m_67984);
    int64_t segmap_tblock_sizze_74725;
    
    segmap_tblock_sizze_74725 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74717;
    if (memblock_alloc_device(ctx, &mem_78134, bytes_78133, "mem_78134")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_78134, n_pairs_67906, 0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78136, bytes_78135, "mem_78136")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78136, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78138, bytes_78135, "mem_78138")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78138, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_67910 = add64(scatter_psizze_54362, n_pairs_67906);
    int64_t zs_lhs_67911 = sub64(zm_lhs_67910, (int64_t) 1);
    int64_t m_67915 = sdiv64(zs_lhs_67911, scatter_psizze_54362);
    bool loop_cond_67916 = slt64((int64_t) 0, m_67915);
    bool partitioned_scatter_res_67917;
    int64_t partitioned_scatter_res_67921;
    bool loop_while_67922;
    int64_t p_67926;
    
    loop_while_67922 = loop_cond_67916;
    p_67926 = (int64_t) 0;
    while (loop_while_67922) {
        int64_t lower_bound_67927 = mul64(scatter_psizze_54362, p_67926);
        int64_t min_arg1_67928 = add64(scatter_psizze_54362, lower_bound_67927);
        int64_t min_res_67929 = smin64(n_pairs_67906, min_arg1_67928);
        int64_t j_m_i_67930 = sub64(min_res_67929, lower_bound_67927);
        bool empty_slice_67931 = j_m_i_67930 == (int64_t) 0;
        int64_t m_67932 = sub64(j_m_i_67930, (int64_t) 1);
        int64_t i_p_m_t_s_67933 = add64(lower_bound_67927, m_67932);
        bool zzero_leq_i_p_m_t_s_67934 = sle64((int64_t) 0, i_p_m_t_s_67933);
        bool i_p_m_t_s_leq_w_67935 = slt64(i_p_m_t_s_67933, n_pairs_67906);
        bool zzero_lte_i_67936 = sle64((int64_t) 0, lower_bound_67927);
        bool i_lte_j_67937 = sle64(lower_bound_67927, min_res_67929);
        bool y_67938 = i_p_m_t_s_leq_w_67935 && zzero_lte_i_67936;
        bool y_67939 = zzero_leq_i_p_m_t_s_67934 && y_67938;
        bool forwards_ok_67940 = i_lte_j_67937 && y_67939;
        bool ok_or_empty_67941 = empty_slice_67931 || forwards_ok_67940;
        bool index_certs_67942;
        
        if (!ok_or_empty_67941) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_67927, ":", (long long) min_res_67929, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78148 = (int64_t) 4 * j_m_i_67930;
        int64_t bytes_78150 = (int64_t) 8 * j_m_i_67930;
        
        if (memblock_alloc_device(ctx, &mem_78149, bytes_78148, "mem_78149")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78134.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78151, bytes_78150, "mem_78151")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78136.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78153, bytes_78150, "mem_78153")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78138.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79433 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_74702));
        
        {
            err = gpu_kernel_inner_SMJ_floatzisegmap_74699(ctx, num_tblocks_74704, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74701, 1, 1, (int64_t) 0, m_67844, lower_bound_67927, min_res_67929, j_m_i_67930, num_tblocks_74704, virt_num_tblocks_79433, mem_78105.mem, mem_78107.mem, mem_78109.mem, mem_78120.mem, mem_78149.mem, mem_78151.mem, mem_78153.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_67956 = add64((int64_t) 1, p_67926);
        
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78134.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78136.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78138.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        
        bool loop_cond_67967 = slt64(tmp_67956, m_67915);
        bool loop_while_tmp_79428 = loop_cond_67967;
        int64_t p_tmp_79432 = tmp_67956;
        
        loop_while_67922 = loop_while_tmp_79428;
        p_67926 = p_tmp_79432;
    }
    partitioned_scatter_res_67917 = loop_while_67922;
    partitioned_scatter_res_67921 = p_67926;
    if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
        return 1;
    
    bool loop_cond_t_res_68012 = slt64(m_67844, n_pairs_67906);
    bool x_68013 = cond_68011 && loop_cond_t_res_68012;
    
    if (memblock_alloc_device(ctx, &mem_78179, (int64_t) 4, "mem_78179")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78180, (int64_t) 8, "mem_78180")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78181, (int64_t) 8, "mem_78181")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_68014;
    int64_t joinTups_to_joinPairs_InnerJoin_res_68018;
    bool loop_while_68019;
    int64_t p_68023;
    
    if (memblock_set_device(ctx, &mem_param_78166, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78169, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78172, &mem_78138, "mem_78138") != 0)
        return 1;
    loop_while_68019 = x_68013;
    p_68023 = (int64_t) 0;
    while (loop_while_68019) {
        bool x_68024 = sle64((int64_t) 0, p_68023);
        bool y_68025 = slt64(p_68023, m_67984);
        bool bounds_check_68026 = x_68024 && y_68025;
        bool index_certs_68027;
        
        if (!bounds_check_68026) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_68023, "] out of bounds for array of shape [", (long long) m_67984, "].", "-> #0  ftSMJ.fut:300:13-42\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_79559;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79559, mem_78130.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68028 = read_res_79559;
        int64_t read_res_79560;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79560, mem_78128.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68029 = read_res_79560;
        bool x_68030 = sle64((int64_t) 0, loopres_68028);
        bool y_68031 = slt64(loopres_68028, n_pairs_67906);
        bool bounds_check_68032 = x_68030 && y_68031;
        bool index_certs_68033;
        
        if (!bounds_check_68032) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:302:52-61\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_68044 = add64(loopres_68028, loopres_68029);
        bool empty_slice_68048 = loopres_68029 == (int64_t) 0;
        int64_t m_68049 = sub64(loopres_68029, (int64_t) 1);
        int64_t i_p_m_t_s_68050 = add64(loopres_68028, m_68049);
        bool zzero_leq_i_p_m_t_s_68051 = sle64((int64_t) 0, i_p_m_t_s_68050);
        bool i_p_m_t_s_leq_w_68052 = slt64(i_p_m_t_s_68050, n_pairs_67906);
        bool i_lte_j_68053 = sle64(loopres_68028, tmp_68044);
        bool y_68054 = x_68030 && i_p_m_t_s_leq_w_68052;
        bool y_68055 = zzero_leq_i_p_m_t_s_68051 && y_68054;
        bool forwards_ok_68056 = i_lte_j_68053 && y_68055;
        bool ok_or_empty_68057 = empty_slice_68048 || forwards_ok_68056;
        bool index_certs_68058;
        
        if (!ok_or_empty_68057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, ":", (long long) tmp_68044, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:306:14-55\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:390:133-136\n   #3  ftSMJ.fut:379:1-390:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78182 = (int64_t) 4 * loopres_68029;
        int64_t bytes_78184 = (int64_t) 8 * loopres_68029;
        int64_t segmap_usable_groups_74726 = sdiv_up64(loopres_68029, segmap_tblock_sizze_74725);
        int64_t tmp_68043 = add64((int64_t) 1, p_68023);
        
        if (memblock_alloc_device(ctx, &mem_78174, bytes_78133, "mem_78174")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78174.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78176, bytes_78135, "mem_78176")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78178, bytes_78135, "mem_78178")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78172.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        
        bool cond_68062 = slt64(tmp_68043, m_67984);
        bool x_68063 = loop_cond_t_res_68012 && cond_68062;
        
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_79454(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_68028, mem_param_78166.mem, mem_param_78169.mem, mem_param_78172.mem, mem_78179.mem, mem_78180.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78183, bytes_78182, "mem_78183")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79460 = loopres_68029;
        int64_t tblock_sizze_79465;
        
        tblock_sizze_79465 = *ctx->tuning_params.inner_SMJ_floatzitblock_sizze_79465;
        
        int64_t virt_num_tblocks_79466 = sdiv_up64(replicate_n_79460, tblock_sizze_79465);
        int64_t num_tblocks_79467 = smin64(virt_num_tblocks_79466, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_floatzireplicate_79461(ctx, num_tblocks_79467, 1, 1, tblock_sizze_79465, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79460, virt_num_tblocks_79466, num_tblocks_79467, mem_78179.mem, mem_78183.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78185, bytes_78184, "mem_78185")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79480 = loopres_68029;
        int64_t tblock_sizze_79485;
        
        tblock_sizze_79485 = *ctx->tuning_params.inner_SMJ_floatzitblock_sizze_79485;
        
        int64_t virt_num_tblocks_79486 = sdiv_up64(replicate_n_79480, tblock_sizze_79485);
        int64_t num_tblocks_79487 = smin64(virt_num_tblocks_79486, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_floatzireplicate_79481(ctx, num_tblocks_79487, 1, 1, tblock_sizze_79485, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79480, virt_num_tblocks_79486, num_tblocks_79487, mem_78180.mem, mem_78185.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79500 = sext_i64_i32(sdiv_up64(loopres_68029, segmap_tblock_sizze_74725));
        
        {
            err = gpu_kernel_inner_SMJ_floatzisegmap_74729(ctx, segmap_usable_groups_74726, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_74717, 1, 1, (int64_t) 0, loopres_68028, loopres_68029, mem_78178.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78174.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78185.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79446, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79447, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79448, &mem_78178, "mem_78178") != 0)
            return 1;
        
        bool loop_while_tmp_79449 = x_68063;
        int64_t p_tmp_79453 = tmp_68043;
        
        if (memblock_set_device(ctx, &mem_param_78166, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78169, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78172, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        loop_while_68019 = loop_while_tmp_79449;
        p_68023 = p_tmp_79453;
    }
    if (memblock_set_device(ctx, &ext_mem_78197, &mem_param_78166, "mem_param_78166") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78196, &mem_param_78169, "mem_param_78169") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78195, &mem_param_78172, "mem_param_78172") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_68014 = loop_while_68019;
    joinTups_to_joinPairs_InnerJoin_res_68018 = p_68023;
    if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78199, bytes_78133, "mem_78199")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78197.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78201, bytes_78135, "mem_78201")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78201.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78203, bytes_78135, "mem_78203")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_78201, "mem_78201") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78701, &mem_78203, "mem_78203") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78702, &mem_78199, "mem_78199") != 0)
        return 1;
    prim_out_78703 = n_pairs_67906;
    if (memblock_set_device(ctx, &*mem_out_p_79540, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79541, &mem_out_78701, "mem_out_78701") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79542, &mem_out_78702, "mem_out_78702") != 0)
        return 1;
    *out_prim_out_79543 = prim_out_78703;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_78203, "mem_78203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78201, "mem_78201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78199, "mem_78199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78178, "mem_78178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78172, "mem_param_78172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78169, "mem_param_78169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78166, "mem_param_78166") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78124, "mem_78124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78125, "mem_78125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78121, "mem_78121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78122, "mem_78122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79249, "incprefixes_mem_79249") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79247, "aggregates_mem_79247") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79245, "incprefixes_mem_79245") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79243, "aggregates_mem_79243") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79241, "status_flags_mem_79241") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79108, "incprefixes_mem_79108") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79106, "aggregates_mem_79106") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79084, "status_flags_mem_79084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78083, "mem_78083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78080, "mem_78080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77888, "mem_77888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77886, "mem_77886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77872, "mem_77872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77869, "mem_77869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77848, "mem_77848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77846, "mem_77846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77781, "mem_77781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77779, "mem_77779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77842, "mem_77842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77840, "mem_77840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77851, "ext_mem_77851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77854, "ext_mem_77854") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77857, "ext_mem_77857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77860, "ext_mem_77860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77710, "mem_param_77710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77707, "mem_param_77707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77702, "mem_77702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77703, "mem_77703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77699, "mem_77699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77700, "mem_77700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77698, "mem_param_77698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77695, "mem_param_77695") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77891, "ext_mem_77891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77894, "ext_mem_77894") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77897, "ext_mem_77897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77900, "ext_mem_77900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77688, "mem_param_77688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77685, "mem_param_77685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77905, "ext_mem_77905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77906, "ext_mem_77906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77667, "mem_77667") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77669, "mem_77669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77651, "mem_77651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77652, "mem_77652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77647, "mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77648, "mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78053, "mem_78053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78051, "mem_78051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77986, "mem_77986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77984, "mem_77984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78047, "mem_78047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78045, "mem_78045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78056, "ext_mem_78056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78059, "ext_mem_78059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78062, "ext_mem_78062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78065, "ext_mem_78065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77915, "mem_param_77915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77912, "mem_param_77912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78070, "ext_mem_78070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78071, "ext_mem_78071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77907, "mem_77907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77908, "mem_77908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77640, "mem_param_77640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77632, "mem_77632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77633, "mem_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78702, "mem_out_78702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78701, "mem_out_78701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_79561, struct memblock_device *mem_out_p_79562, struct memblock_device *mem_out_p_79563, int64_t *out_prim_out_79564, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_44377, int64_t nS_44378, int64_t offset_R_44381, int64_t offset_S_44382, int64_t partitionsPerWindow_44383, int64_t numberOfWindows_44384, int64_t extParallelism_44385, int64_t scatter_psizze_44386)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_78203;
    
    mem_78203.references = NULL;
    
    struct memblock_device mem_78201;
    
    mem_78201.references = NULL;
    
    struct memblock_device mem_78199;
    
    mem_78199.references = NULL;
    
    struct memblock_device mem_param_tmp_79428;
    
    mem_param_tmp_79428.references = NULL;
    
    struct memblock_device mem_param_tmp_79427;
    
    mem_param_tmp_79427.references = NULL;
    
    struct memblock_device mem_param_tmp_79426;
    
    mem_param_tmp_79426.references = NULL;
    
    struct memblock_device mem_78185;
    
    mem_78185.references = NULL;
    
    struct memblock_device mem_78183;
    
    mem_78183.references = NULL;
    
    struct memblock_device mem_78178;
    
    mem_78178.references = NULL;
    
    struct memblock_device mem_78176;
    
    mem_78176.references = NULL;
    
    struct memblock_device mem_78174;
    
    mem_78174.references = NULL;
    
    struct memblock_device mem_param_78172;
    
    mem_param_78172.references = NULL;
    
    struct memblock_device mem_param_78169;
    
    mem_param_78169.references = NULL;
    
    struct memblock_device mem_param_78166;
    
    mem_param_78166.references = NULL;
    
    struct memblock_device ext_mem_78195;
    
    ext_mem_78195.references = NULL;
    
    struct memblock_device ext_mem_78196;
    
    ext_mem_78196.references = NULL;
    
    struct memblock_device ext_mem_78197;
    
    ext_mem_78197.references = NULL;
    
    struct memblock_device mem_78181;
    
    mem_78181.references = NULL;
    
    struct memblock_device mem_78180;
    
    mem_78180.references = NULL;
    
    struct memblock_device mem_78179;
    
    mem_78179.references = NULL;
    
    struct memblock_device mem_78153;
    
    mem_78153.references = NULL;
    
    struct memblock_device mem_78151;
    
    mem_78151.references = NULL;
    
    struct memblock_device mem_78149;
    
    mem_78149.references = NULL;
    
    struct memblock_device mem_78138;
    
    mem_78138.references = NULL;
    
    struct memblock_device mem_78136;
    
    mem_78136.references = NULL;
    
    struct memblock_device mem_78134;
    
    mem_78134.references = NULL;
    
    struct memblock_device mem_78130;
    
    mem_78130.references = NULL;
    
    struct memblock_device mem_78128;
    
    mem_78128.references = NULL;
    
    struct memblock_device mem_78132;
    
    mem_78132.references = NULL;
    
    struct memblock_device mem_78124;
    
    mem_78124.references = NULL;
    
    struct memblock_device mem_78125;
    
    mem_78125.references = NULL;
    
    struct memblock_device ext_mem_78126;
    
    ext_mem_78126.references = NULL;
    
    struct memblock_device mem_78121;
    
    mem_78121.references = NULL;
    
    struct memblock_device mem_78122;
    
    mem_78122.references = NULL;
    
    struct memblock_device ext_mem_78123;
    
    ext_mem_78123.references = NULL;
    
    struct memblock_device mem_78120;
    
    mem_78120.references = NULL;
    
    struct memblock_device incprefixes_mem_79229;
    
    incprefixes_mem_79229.references = NULL;
    
    struct memblock_device aggregates_mem_79227;
    
    aggregates_mem_79227.references = NULL;
    
    struct memblock_device incprefixes_mem_79225;
    
    incprefixes_mem_79225.references = NULL;
    
    struct memblock_device aggregates_mem_79223;
    
    aggregates_mem_79223.references = NULL;
    
    struct memblock_device status_flags_mem_79221;
    
    status_flags_mem_79221.references = NULL;
    
    struct memblock_device mem_78117;
    
    mem_78117.references = NULL;
    
    struct memblock_device mem_78115;
    
    mem_78115.references = NULL;
    
    struct memblock_device mem_78113;
    
    mem_78113.references = NULL;
    
    struct memblock_device mem_78109;
    
    mem_78109.references = NULL;
    
    struct memblock_device mem_78107;
    
    mem_78107.references = NULL;
    
    struct memblock_device mem_78105;
    
    mem_78105.references = NULL;
    
    struct memblock_device mem_78103;
    
    mem_78103.references = NULL;
    
    struct memblock_device incprefixes_mem_79108;
    
    incprefixes_mem_79108.references = NULL;
    
    struct memblock_device aggregates_mem_79106;
    
    aggregates_mem_79106.references = NULL;
    
    struct memblock_device status_flags_mem_79084;
    
    status_flags_mem_79084.references = NULL;
    
    struct memblock_device mem_78101;
    
    mem_78101.references = NULL;
    
    struct memblock_device mem_78099;
    
    mem_78099.references = NULL;
    
    struct memblock_device mem_param_tmp_78751;
    
    mem_param_tmp_78751.references = NULL;
    
    struct memblock_device mem_param_tmp_78750;
    
    mem_param_tmp_78750.references = NULL;
    
    struct memblock_device mem_78084;
    
    mem_78084.references = NULL;
    
    struct memblock_device mem_78083;
    
    mem_78083.references = NULL;
    
    struct memblock_device mem_78080;
    
    mem_78080.references = NULL;
    
    struct memblock_device mem_param_tmp_78908;
    
    mem_param_tmp_78908.references = NULL;
    
    struct memblock_device mem_param_tmp_78907;
    
    mem_param_tmp_78907.references = NULL;
    
    struct memblock_device mem_77888;
    
    mem_77888.references = NULL;
    
    struct memblock_device mem_77886;
    
    mem_77886.references = NULL;
    
    struct memblock_device mem_77884;
    
    mem_77884.references = NULL;
    
    struct memblock_device mem_77881;
    
    mem_77881.references = NULL;
    
    struct memblock_device mem_param_tmp_78918;
    
    mem_param_tmp_78918.references = NULL;
    
    struct memblock_device mem_param_tmp_78917;
    
    mem_param_tmp_78917.references = NULL;
    
    struct memblock_device mem_77872;
    
    mem_77872.references = NULL;
    
    struct memblock_device mem_77869;
    
    mem_77869.references = NULL;
    
    struct memblock_device mem_param_tmp_78936;
    
    mem_param_tmp_78936.references = NULL;
    
    struct memblock_device mem_param_tmp_78935;
    
    mem_param_tmp_78935.references = NULL;
    
    struct memblock_device mem_77848;
    
    mem_77848.references = NULL;
    
    struct memblock_device mem_77846;
    
    mem_77846.references = NULL;
    
    struct memblock_device mem_77781;
    
    mem_77781.references = NULL;
    
    struct memblock_device mem_77779;
    
    mem_77779.references = NULL;
    
    struct memblock_device mem_77842;
    
    mem_77842.references = NULL;
    
    struct memblock_device mem_77840;
    
    mem_77840.references = NULL;
    
    struct memblock_device ext_mem_77843;
    
    ext_mem_77843.references = NULL;
    
    struct memblock_device ext_mem_77844;
    
    ext_mem_77844.references = NULL;
    
    struct memblock_device ext_mem_77720;
    
    ext_mem_77720.references = NULL;
    
    struct memblock_device mem_77718;
    
    mem_77718.references = NULL;
    
    struct memblock_device ext_mem_77851;
    
    ext_mem_77851.references = NULL;
    
    struct memblock_device ext_mem_77854;
    
    ext_mem_77854.references = NULL;
    
    struct memblock_device mem_77716;
    
    mem_77716.references = NULL;
    
    struct memblock_device ext_mem_77857;
    
    ext_mem_77857.references = NULL;
    
    struct memblock_device ext_mem_77860;
    
    ext_mem_77860.references = NULL;
    
    struct memblock_device ext_mem_77714;
    
    ext_mem_77714.references = NULL;
    
    struct memblock_device ext_mem_77713;
    
    ext_mem_77713.references = NULL;
    
    struct memblock_device mem_param_77710;
    
    mem_param_77710.references = NULL;
    
    struct memblock_device mem_param_77707;
    
    mem_param_77707.references = NULL;
    
    struct memblock_device ext_mem_77865;
    
    ext_mem_77865.references = NULL;
    
    struct memblock_device ext_mem_77866;
    
    ext_mem_77866.references = NULL;
    
    struct memblock_device mem_77702;
    
    mem_77702.references = NULL;
    
    struct memblock_device mem_77703;
    
    mem_77703.references = NULL;
    
    struct memblock_device ext_mem_77704;
    
    ext_mem_77704.references = NULL;
    
    struct memblock_device mem_77699;
    
    mem_77699.references = NULL;
    
    struct memblock_device mem_77700;
    
    mem_77700.references = NULL;
    
    struct memblock_device ext_mem_77701;
    
    ext_mem_77701.references = NULL;
    
    struct memblock_device mem_param_77698;
    
    mem_param_77698.references = NULL;
    
    struct memblock_device mem_param_77695;
    
    mem_param_77695.references = NULL;
    
    struct memblock_device ext_mem_77877;
    
    ext_mem_77877.references = NULL;
    
    struct memblock_device ext_mem_77878;
    
    ext_mem_77878.references = NULL;
    
    struct memblock_device mem_77715;
    
    mem_77715.references = NULL;
    
    struct memblock_device mem_77712;
    
    mem_77712.references = NULL;
    
    struct memblock_device mem_77711;
    
    mem_77711.references = NULL;
    
    struct memblock_device mem_77692;
    
    mem_77692.references = NULL;
    
    struct memblock_device mem_77690;
    
    mem_77690.references = NULL;
    
    struct memblock_device ext_mem_77891;
    
    ext_mem_77891.references = NULL;
    
    struct memblock_device ext_mem_77894;
    
    ext_mem_77894.references = NULL;
    
    struct memblock_device ext_mem_77897;
    
    ext_mem_77897.references = NULL;
    
    struct memblock_device ext_mem_77900;
    
    ext_mem_77900.references = NULL;
    
    struct memblock_device mem_param_77688;
    
    mem_param_77688.references = NULL;
    
    struct memblock_device mem_param_77685;
    
    mem_param_77685.references = NULL;
    
    struct memblock_device ext_mem_77905;
    
    ext_mem_77905.references = NULL;
    
    struct memblock_device ext_mem_77906;
    
    ext_mem_77906.references = NULL;
    
    struct memblock_device mem_77682;
    
    mem_77682.references = NULL;
    
    struct memblock_device mem_77680;
    
    mem_77680.references = NULL;
    
    struct memblock_device mem_77667;
    
    mem_77667.references = NULL;
    
    struct memblock_device mem_77669;
    
    mem_77669.references = NULL;
    
    struct memblock_device ext_mem_77670;
    
    ext_mem_77670.references = NULL;
    
    struct memblock_device ext_mem_77671;
    
    ext_mem_77671.references = NULL;
    
    struct memblock_device mem_77664;
    
    mem_77664.references = NULL;
    
    struct memblock_device mem_77662;
    
    mem_77662.references = NULL;
    
    struct memblock_device mem_77651;
    
    mem_77651.references = NULL;
    
    struct memblock_device mem_77652;
    
    mem_77652.references = NULL;
    
    struct memblock_device ext_mem_77653;
    
    ext_mem_77653.references = NULL;
    
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_77647;
    
    mem_77647.references = NULL;
    
    struct memblock_device mem_77648;
    
    mem_77648.references = NULL;
    
    struct memblock_device ext_mem_77649;
    
    ext_mem_77649.references = NULL;
    
    struct memblock_device mem_77646;
    
    mem_77646.references = NULL;
    
    struct memblock_device mem_77644;
    
    mem_77644.references = NULL;
    
    struct memblock_device mem_param_tmp_78769;
    
    mem_param_tmp_78769.references = NULL;
    
    struct memblock_device mem_param_tmp_78768;
    
    mem_param_tmp_78768.references = NULL;
    
    struct memblock_device mem_78053;
    
    mem_78053.references = NULL;
    
    struct memblock_device mem_78051;
    
    mem_78051.references = NULL;
    
    struct memblock_device mem_77986;
    
    mem_77986.references = NULL;
    
    struct memblock_device mem_77984;
    
    mem_77984.references = NULL;
    
    struct memblock_device mem_78047;
    
    mem_78047.references = NULL;
    
    struct memblock_device mem_78045;
    
    mem_78045.references = NULL;
    
    struct memblock_device ext_mem_78048;
    
    ext_mem_78048.references = NULL;
    
    struct memblock_device ext_mem_78049;
    
    ext_mem_78049.references = NULL;
    
    struct memblock_device ext_mem_77925;
    
    ext_mem_77925.references = NULL;
    
    struct memblock_device mem_77923;
    
    mem_77923.references = NULL;
    
    struct memblock_device ext_mem_78056;
    
    ext_mem_78056.references = NULL;
    
    struct memblock_device ext_mem_78059;
    
    ext_mem_78059.references = NULL;
    
    struct memblock_device mem_77921;
    
    mem_77921.references = NULL;
    
    struct memblock_device ext_mem_78062;
    
    ext_mem_78062.references = NULL;
    
    struct memblock_device ext_mem_78065;
    
    ext_mem_78065.references = NULL;
    
    struct memblock_device ext_mem_77919;
    
    ext_mem_77919.references = NULL;
    
    struct memblock_device ext_mem_77918;
    
    ext_mem_77918.references = NULL;
    
    struct memblock_device mem_param_77915;
    
    mem_param_77915.references = NULL;
    
    struct memblock_device mem_param_77912;
    
    mem_param_77912.references = NULL;
    
    struct memblock_device ext_mem_78070;
    
    ext_mem_78070.references = NULL;
    
    struct memblock_device ext_mem_78071;
    
    ext_mem_78071.references = NULL;
    
    struct memblock_device mem_77920;
    
    mem_77920.references = NULL;
    
    struct memblock_device mem_77917;
    
    mem_77917.references = NULL;
    
    struct memblock_device mem_77916;
    
    mem_77916.references = NULL;
    
    struct memblock_device mem_77907;
    
    mem_77907.references = NULL;
    
    struct memblock_device mem_77908;
    
    mem_77908.references = NULL;
    
    struct memblock_device ext_mem_77909;
    
    ext_mem_77909.references = NULL;
    
    struct memblock_device ext_mem_78074;
    
    ext_mem_78074.references = NULL;
    
    struct memblock_device ext_mem_78077;
    
    ext_mem_78077.references = NULL;
    
    struct memblock_device ext_mem_78087;
    
    ext_mem_78087.references = NULL;
    
    struct memblock_device ext_mem_78090;
    
    ext_mem_78090.references = NULL;
    
    struct memblock_device mem_param_77640;
    
    mem_param_77640.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device ext_mem_78095;
    
    ext_mem_78095.references = NULL;
    
    struct memblock_device ext_mem_78096;
    
    ext_mem_78096.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77632;
    
    mem_77632.references = NULL;
    
    struct memblock_device mem_77633;
    
    mem_77633.references = NULL;
    
    struct memblock_device ext_mem_77634;
    
    ext_mem_77634.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device ext_mem_77627;
    
    ext_mem_77627.references = NULL;
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78703;
    int64_t zm_lhs_66970 = add64(nR_44377, nS_44378);
    int64_t zs_lhs_66971 = sub64(zm_lhs_66970, (int64_t) 1);
    bool zzero_66972 = nR_44377 == (int64_t) 0;
    bool nonzzero_66973 = !zzero_66972;
    bool nonzzero_cert_66974;
    
    if (!nonzzero_66973) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:232:26-29\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_66975 = sdiv64(zs_lhs_66971, nR_44377);
    
    if (futrts_indicesWithIncrement_9745(ctx, &ext_mem_77627, tR_mem_77625, nR_44377, offset_R_44381) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_77628 = (int64_t) 8 * nR_44377;
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77629, nR_44377, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, nR_44377, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_66980 = slt64((int64_t) 0, numIter_66975);
    int64_t gt_rhs_66981 = sub64(nR_44377, (int64_t) 1);
    bool x_66982 = sle64((int64_t) 0, gt_rhs_66981);
    bool y_66983 = slt64(gt_rhs_66981, nR_44377);
    bool bounds_check_66984 = x_66982 && y_66983;
    bool loop_not_taken_66985 = !loop_cond_66980;
    bool protect_assert_disj_66986 = bounds_check_66984 || loop_not_taken_66985;
    bool index_certs_66987;
    
    if (!protect_assert_disj_66986) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftSMJ.fut:239:25-33\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_66980) {
        if (memblock_alloc_device(ctx, &mem_77633, (int64_t) 4, "mem_77633")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_78724(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, tR_mem_77625.mem, mem_77633.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77633, "mem_77633") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_77632, (int64_t) 4, "mem_77632")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i32(ctx, mem_77632, (int64_t) 1, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77632, "mem_77632") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_77641, (int64_t) 4, "mem_77641")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77642, (int64_t) 1, "mem_77642")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_66990;
    int64_t defunc_0_mergeJoin_res_66991;
    bool loop_while_66994;
    int64_t p_66995;
    
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77640, &mem_77629, "mem_77629") != 0)
        return 1;
    loop_while_66994 = loop_cond_66980;
    p_66995 = (int64_t) 0;
    while (loop_while_66994) {
        int64_t tS_start_66998 = mul64(nR_44377, p_66995);
        int64_t min_arg1_66999 = add64(nR_44377, tS_start_66998);
        int64_t min_res_67000 = smin64(nS_44378, min_arg1_66999);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 = sub64(min_res_67000, tS_start_66998);
        bool empty_slice_67002 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 == (int64_t) 0;
        int64_t m_67003 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, (int64_t) 1);
        int64_t i_p_m_t_s_67004 = add64(tS_start_66998, m_67003);
        bool zzero_leq_i_p_m_t_s_67005 = sle64((int64_t) 0, i_p_m_t_s_67004);
        bool i_p_m_t_s_leq_w_67006 = slt64(i_p_m_t_s_67004, nS_44378);
        bool zzero_lte_i_67007 = sle64((int64_t) 0, tS_start_66998);
        bool i_lte_j_67008 = sle64(tS_start_66998, min_res_67000);
        bool y_67009 = i_p_m_t_s_leq_w_67006 && zzero_lte_i_67007;
        bool y_67010 = zzero_leq_i_p_m_t_s_67005 && y_67009;
        bool forwards_ok_67011 = i_lte_j_67008 && y_67010;
        bool ok_or_empty_67012 = empty_slice_67002 || forwards_ok_67011;
        bool index_certs_67013;
        
        if (!ok_or_empty_67012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_66998, ":", (long long) min_res_67000, "] out of bounds for array of shape [", (long long) nS_44378, "].", "-> #0  ftSMJ.fut:238:16-35\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_67015 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
        bool index_certs_67016;
        
        if (!y_67015) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:239:12-19\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_78756(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_66998, tS_mem_77626.mem, ext_mem_77634.mem, mem_77641.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_79565;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79565, mem_77642.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_67018 = read_res_79565;
        int64_t loopres_67019;
        
        if (defunc_0_gt_res_67018) {
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_param_77637, "mem_param_77637") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_param_77640, "mem_param_77640") != 0)
                return 1;
            loopres_67019 = numIter_66975;
        } else {
            bool cond_67022 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, nR_44377);
            bool dim_match_67136 = nR_44377 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            bool protect_assert_disj_78305 = cond_67022 || dim_match_67136;
            bool empty_or_match_cert_67137;
            
            if (!protect_assert_disj_78305) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "] cannot match shape of type `[", (long long) nR_44377, "]i32`.", "-> #0  ftSMJ.fut:247:18-31\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_67143 = slt64((int64_t) 0, numberOfWindows_44384);
            bool y_67146 = slt64((int64_t) 0, nR_44377);
            bool loop_not_taken_67147 = !loop_cond_67143;
            bool protect_assert_disj_67148 = y_67146 || loop_not_taken_67147;
            bool protect_assert_disj_78307 = cond_67022 || protect_assert_disj_67148;
            bool index_certs_67149;
            
            if (!protect_assert_disj_78307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftsort.fut:285:20-25\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_68532 = add64(nR_44377, extParallelism_44385);
            int64_t zs_lhs_68533 = sub64(zm_lhs_68532, (int64_t) 1);
            bool zzero_68534 = extParallelism_44385 == (int64_t) 0;
            bool nonzzero_68535 = !zzero_68534;
            bool loop_not_taken_78248 = !cond_67022;
            bool protect_assert_disj_78249 = nonzzero_68535 || loop_not_taken_78248;
            bool nonzzero_cert_68536;
            
            if (!protect_assert_disj_78249) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_68537 = sdiv_safe64(zs_lhs_68533, extParallelism_44385);
            bool loop_cond_68538 = slt64((int64_t) 0, numIter_68537);
            bool loop_not_taken_68539 = !y_67015;
            bool loop_not_taken_68540 = !loop_cond_68538;
            bool x_68541 = sle64((int64_t) 0, m_67003);
            bool y_68542 = slt64(m_67003, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
            bool bounds_check_68544 = x_68541 && y_68542;
            bool protect_assert_disj_68545 = loop_not_taken_68539 || bounds_check_68544;
            bool protect_assert_disj_68546 = loop_not_taken_68540 || protect_assert_disj_68545;
            bool protect_assert_disj_78251 = protect_assert_disj_68546 || loop_not_taken_78248;
            bool index_certs_68547;
            
            if (!protect_assert_disj_78251) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67817;
            
            if (!bounds_check_68544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:258:23-44\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67819;
            
            if (!bounds_check_66984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftSMJ.fut:258:51-59\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 = mul64(partitionsPerWindow_44383, numberOfWindows_44384);
            int64_t join_chunks_arg3_67139 = add64(offset_S_44382, tS_start_66998);
            int64_t bytes_77643 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
            bool empty_slice_67144 = partitionsPerWindow_44383 == (int64_t) 0;
            int64_t m_67145 = sub64(partitionsPerWindow_44383, (int64_t) 1);
            int64_t segmap_tblock_sizze_71188;
            
            segmap_tblock_sizze_71188 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_70981;
            
            int64_t zeze_rhs_67414 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, (int64_t) 1);
            int64_t segmap_tblock_sizze_71562;
            
            segmap_tblock_sizze_71562 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71398;
            
            int64_t segmap_usable_groups_71563 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_71562);
            bool loop_cond_67569 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
            bool protect_cond_conj_68543 = y_67015 && loop_cond_68538;
            int64_t bytes_77922 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            int64_t ext_78076;
            int64_t ext_78075;
            int64_t ext_78073;
            int64_t ext_78072;
            
            if (cond_67022) {
                if (protect_cond_conj_68543) {
                    if (memblock_alloc_device(ctx, &mem_77908, (int64_t) 4, "mem_77908")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_78762(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_67004, tS_mem_77626.mem, mem_77908.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77908, "mem_77908") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77907, (int64_t) 4, "mem_77907")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_77907, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77907, "mem_77907") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77916, (int64_t) 4, "mem_77916")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77917, (int64_t) 4, "mem_77917")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77920, (int64_t) 1, "mem_77920")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_78069;
                int64_t ext_78068;
                int64_t ext_78067;
                int64_t ext_78066;
                bool defunc_0_find_joinTuples_res_68550;
                int64_t defunc_0_find_joinTuples_res_68551;
                bool loop_while_68554;
                int64_t p_68555;
                int64_t ctx_param_ext_77910;
                int64_t ctx_param_ext_77911;
                int64_t ctx_param_ext_77913;
                int64_t ctx_param_ext_77914;
                
                if (memblock_set_device(ctx, &mem_param_77912, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77915, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77910 = (int64_t) 0;
                ctx_param_ext_77911 = (int64_t) 1;
                ctx_param_ext_77913 = (int64_t) 0;
                ctx_param_ext_77914 = (int64_t) 1;
                loop_while_68554 = loop_cond_68538;
                p_68555 = (int64_t) 0;
                while (loop_while_68554) {
                    int64_t start_68558 = mul64(extParallelism_44385, p_68555);
                    int64_t min_arg1_68559 = sub64(nR_44377, start_68558);
                    int64_t min_res_68560 = smin64(extParallelism_44385, min_arg1_68559);
                    int64_t iter_R_68561 = add64(start_68558, min_res_68560);
                    bool empty_slice_68562 = min_res_68560 == (int64_t) 0;
                    int64_t m_68563 = sub64(min_res_68560, (int64_t) 1);
                    int64_t i_p_m_t_s_68564 = add64(start_68558, m_68563);
                    bool zzero_leq_i_p_m_t_s_68565 = sle64((int64_t) 0, i_p_m_t_s_68564);
                    bool i_p_m_t_s_leq_w_68566 = slt64(i_p_m_t_s_68564, nR_44377);
                    bool zzero_lte_i_68567 = sle64((int64_t) 0, start_68558);
                    bool i_lte_j_68568 = sle64(start_68558, iter_R_68561);
                    bool y_68569 = i_p_m_t_s_leq_w_68566 && zzero_lte_i_68567;
                    bool y_68570 = zzero_leq_i_p_m_t_s_68565 && y_68569;
                    bool forwards_ok_68571 = i_lte_j_68568 && y_68570;
                    bool ok_or_empty_68572 = empty_slice_68562 || forwards_ok_68571;
                    bool index_certs_68573;
                    
                    if (!ok_or_empty_68572) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_68558, ":", (long long) iter_R_68561, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68574 = slt64(m_68563, min_res_68560);
                    bool x_68575 = sle64((int64_t) 0, m_68563);
                    bool bounds_check_68576 = y_68574 && x_68575;
                    bool index_certs_68577;
                    
                    if (!bounds_check_68576) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_68563, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68580 = slt64((int64_t) 0, min_res_68560);
                    bool index_certs_68581;
                    
                    if (!y_68580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_78778(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_68558, i_p_m_t_s_68564, tR_mem_77625.mem, mem_77916.mem, mem_77917.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77918, &ext_mem_77909, "ext_mem_77909") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77918, &mem_77916, "mem_77916") != 0)
                        return 1;
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77919, &mem_77641, "mem_77641") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77919, &mem_77917, "mem_77917") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_78784(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77917.mem, ext_mem_77918.mem, mem_77920.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
                        return 1;
                    
                    bool read_res_79566;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79566, mem_77920.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_68583 = read_res_79566;
                    int64_t ext_78064;
                    int64_t ext_78063;
                    int64_t ext_78061;
                    int64_t ext_78060;
                    int64_t loopres_68585;
                    
                    if (defunc_0_gt_res_68583) {
                        if (memblock_set_device(ctx, &ext_mem_78065, &mem_param_77912, "mem_param_77912") != 0)
                            return 1;
                        ext_78064 = ctx_param_ext_77910;
                        ext_78063 = ctx_param_ext_77911;
                        if (memblock_set_device(ctx, &ext_mem_78062, &mem_param_77915, "mem_param_77915") != 0)
                            return 1;
                        ext_78061 = ctx_param_ext_77913;
                        ext_78060 = ctx_param_ext_77914;
                        loopres_68585 = numIter_68537;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77921, (int64_t) 1, "mem_77921")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_intzigpuseq_78790(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77916.mem, ext_mem_77919.mem, mem_77921.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_79567;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79567, mem_77921.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_68589 = read_res_79567;
                        
                        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
                            return 1;
                        
                        int64_t ext_78058;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78058 = ctx_param_ext_77910;
                        } else {
                            ext_78058 = (int64_t) 0;
                        }
                        
                        int64_t ext_78057;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78057 = ctx_param_ext_77911;
                        } else {
                            ext_78057 = (int64_t) 1;
                        }
                        
                        int64_t ext_78055;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78055 = ctx_param_ext_77913;
                        } else {
                            ext_78055 = (int64_t) 0;
                        }
                        
                        int64_t ext_78054;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78054 = ctx_param_ext_77914;
                        } else {
                            ext_78054 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_68590;
                        
                        if (defunc_0_gt_res_68589) {
                            int64_t tmp_68594 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_param_77912, "mem_param_77912") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_param_77915, "mem_param_77915") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68594;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_77923, bytes_77922, "mem_77923")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, tS_start_66998, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_9745(ctx, &ext_mem_77925, mem_77923, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, join_chunks_arg3_67139) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
                                return 1;
                            
                            bool suff_outer_par_70803;
                            
                            suff_outer_par_70803 = *ctx->tuning_params.inner_SMJ_intzisuff_outer_par_0 <= min_res_68560;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_int.suff_outer_par_0", (long) min_res_68560, suff_outer_par_70803 ? "true" : "false");
                            
                            int64_t tile_sizze_76414;
                            
                            tile_sizze_76414 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413;
                            
                            int64_t tile_sizze_76059;
                            
                            tile_sizze_76059 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058;
                            
                            int64_t num_whole_tiles_76430 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            int64_t residual_input_76654 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            bool cond_76655 = residual_input_76654 == (int64_t) 0;
                            int64_t binop_x_76671 = tile_sizze_76414 * num_whole_tiles_76430;
                            int64_t bytes_77983 = (int64_t) 8 * min_res_68560;
                            int64_t bytes_77946 = (int64_t) 8 * tile_sizze_76414;
                            int64_t bytes_77948 = (int64_t) 4 * tile_sizze_76414;
                            int64_t num_whole_tiles_76075 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            int64_t residual_input_76299 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            bool cond_76300 = residual_input_76299 == (int64_t) 0;
                            int64_t binop_x_76316 = tile_sizze_76059 * num_whole_tiles_76075;
                            int64_t bytes_78007 = (int64_t) 8 * tile_sizze_76059;
                            int64_t bytes_78009 = (int64_t) 4 * tile_sizze_76059;
                            int64_t shared_memory_capacity_78848;
                            
                            shared_memory_capacity_78848 = ctx->max_shared_memory;
                            if (suff_outer_par_70803 && sle64(sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78009, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78848)) {
                                int64_t ldim_76060 = sdiv_up64(min_res_68560, tile_sizze_76059);
                                
                                if (memblock_alloc_device(ctx, &mem_78045, bytes_77983, "mem_78045")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_78047, bytes_77983, "mem_78047")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78796 = sext_i64_i32(sdiv_up64(tile_sizze_76059, tile_sizze_76059));
                                int32_t virt_num_tblocks_78797 = sext_i64_i32(ldim_76060);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_76057(ctx, ldim_76060, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_76058, 1, 1, bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8) + (bytes_78009 + srem64((int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8)) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76060, num_whole_tiles_76075, residual_input_76299, cond_76300, binop_x_76316, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_78045.mem, mem_78047.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_78045, "mem_78045") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_78047, "mem_78047") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_76415 = sdiv_up64(min_res_68560, tile_sizze_76414);
                                
                                if (memblock_alloc_device(ctx, &mem_77984, bytes_77983, "mem_77984")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_77986, bytes_77983, "mem_77986")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78822 = sext_i64_i32(sdiv_up64(tile_sizze_76414, tile_sizze_76414));
                                int32_t virt_num_tblocks_78823 = sext_i64_i32(ldim_76415);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_76412(ctx, ldim_76415, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_76413, 1, 1, bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8) + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8)) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76415, num_whole_tiles_76430, residual_input_76654, cond_76655, binop_x_76671, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_77984.mem, mem_77986.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_77984, "mem_77984") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_77986, "mem_77986") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78051, bytes_77628, "mem_78051")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77915.mem, ctx_param_ext_77913, (int64_t []) {ctx_param_ext_77914}, (int64_t []) {nR_44377})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78049.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78053, bytes_77628, "mem_78053")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77912.mem, ctx_param_ext_77910, (int64_t []) {ctx_param_ext_77911}, (int64_t []) {nR_44377})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
                                return 1;
                            
                            int64_t tmp_68646 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_78053, "mem_78053") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_78051, "mem_78051") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68646;
                        }
                        if (memblock_set_device(ctx, &ext_mem_78065, &ext_mem_78059, "ext_mem_78059") != 0)
                            return 1;
                        ext_78064 = ext_78058;
                        ext_78063 = ext_78057;
                        if (memblock_set_device(ctx, &ext_mem_78062, &ext_mem_78056, "ext_mem_78056") != 0)
                            return 1;
                        ext_78061 = ext_78055;
                        ext_78060 = ext_78054;
                        loopres_68585 = loopres_f_res_68590;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
                        return 1;
                    
                    bool loop_cond_68647 = slt64(loopres_68585, numIter_68537);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78768, &ext_mem_78065, "ext_mem_78065") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78769, &ext_mem_78062, "ext_mem_78062") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78770 = ext_78064;
                    int64_t ctx_param_ext_tmp_78771 = ext_78063;
                    int64_t ctx_param_ext_tmp_78772 = ext_78061;
                    int64_t ctx_param_ext_tmp_78773 = ext_78060;
                    bool loop_while_tmp_78774 = loop_cond_68647;
                    int64_t p_tmp_78775 = loopres_68585;
                    
                    if (memblock_set_device(ctx, &mem_param_77912, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77915, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
                        return 1;
                    ctx_param_ext_77910 = ctx_param_ext_tmp_78770;
                    ctx_param_ext_77911 = ctx_param_ext_tmp_78771;
                    ctx_param_ext_77913 = ctx_param_ext_tmp_78772;
                    ctx_param_ext_77914 = ctx_param_ext_tmp_78773;
                    loop_while_68554 = loop_while_tmp_78774;
                    p_68555 = p_tmp_78775;
                }
                if (memblock_set_device(ctx, &ext_mem_78071, &mem_param_77912, "mem_param_77912") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78070, &mem_param_77915, "mem_param_77915") != 0)
                    return 1;
                ext_78069 = ctx_param_ext_77910;
                ext_78068 = ctx_param_ext_77911;
                ext_78067 = ctx_param_ext_77913;
                ext_78066 = ctx_param_ext_77914;
                defunc_0_find_joinTuples_res_68550 = loop_while_68554;
                defunc_0_find_joinTuples_res_68551 = p_68555;
                if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_78071, "ext_mem_78071") != 0)
                    return 1;
                ext_78076 = ext_78069;
                ext_78075 = ext_78068;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_78070, "ext_mem_78070") != 0)
                    return 1;
                ext_78073 = ext_78067;
                ext_78072 = ext_78066;
            } else {
                if (memblock_alloc_device(ctx, &mem_77644, bytes_77643, "mem_77644")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77644, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_44377) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77646, bytes_77643, "mem_77646")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77646, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_44377) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77648, (int64_t) 4, "mem_77648")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_78849(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_77625.mem, mem_77648.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77648, "mem_77648") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77647, (int64_t) 4, "mem_77647")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_77647, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77647, "mem_77647") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77650, (int64_t) 1, "mem_77650")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_intzigpuseq_78855(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77641.mem, ext_mem_77649.mem, mem_77650.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
                    return 1;
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77652, (int64_t) 4, "mem_77652")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_78861(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_44377, y_67146, tR_mem_77625.mem, mem_77641.mem, mem_77650.mem, mem_77652.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77652, "mem_77652") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77651, (int64_t) 4, "mem_77651")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_77651, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77651, "mem_77651") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_67161;
                int64_t defunc_0_windowed_partitionFunc_res_67162;
                bool loop_while_67165;
                int64_t p_67166;
                
                loop_while_67165 = loop_cond_67143;
                p_67166 = (int64_t) 0;
                while (loop_while_67165) {
                    int64_t start_67169 = mul64(partitionsPerWindow_44383, p_67166);
                    int64_t end_67170 = add64(partitionsPerWindow_44383, start_67169);
                    int64_t max_res_67171 = smax64((int64_t) 1, start_67169);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172 = sub64(end_67170, max_res_67171);
                    bool bounds_invalid_upwards_67173 = slt64(end_67170, max_res_67171);
                    bool valid_67174 = !bounds_invalid_upwards_67173;
                    bool range_valid_c_67175;
                    
                    if (!valid_67174) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_67171, "..<", (long long) end_67170, " is invalid.", "-> #0  ftsort.fut:288:43-68\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_67178 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 == (int64_t) 0;
                    bool nonzzero_67179 = !zzero_67178;
                    bool nonzzero_cert_67180;
                    
                    if (!nonzzero_67179) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:291:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_77661 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool cond_67381 = slt64((int64_t) 0, start_67169);
                    int64_t conc_tmp_67382 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    int64_t ret_67383;
                    
                    if (cond_67381) {
                        ret_67383 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    } else {
                        ret_67383 = conc_tmp_67382;
                    }
                    
                    bool eq_x_y_67391 = partitionsPerWindow_44383 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool eq_x_zz_67392 = partitionsPerWindow_44383 == conc_tmp_67382;
                    bool p_and_eq_x_y_67393 = cond_67381 && eq_x_y_67391;
                    bool not_p_67394 = !cond_67381;
                    bool p_and_eq_x_y_67395 = eq_x_zz_67392 && not_p_67394;
                    bool dim_match_67396 = p_and_eq_x_y_67393 || p_and_eq_x_y_67395;
                    bool empty_or_match_cert_67397;
                    
                    if (!dim_match_67396) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_67383, "] cannot match shape of type `[", (long long) partitionsPerWindow_44383, "](i64, i64)`.", "-> #0  ftsort.fut:352:5-357:49\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_67399 = add64(m_67145, start_67169);
                    bool zzero_leq_i_p_m_t_s_67400 = sle64((int64_t) 0, i_p_m_t_s_67399);
                    bool i_p_m_t_s_leq_w_67401 = slt64(i_p_m_t_s_67399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool zzero_lte_i_67402 = sle64((int64_t) 0, start_67169);
                    bool i_lte_j_67403 = sle64(start_67169, end_67170);
                    bool y_67404 = i_p_m_t_s_leq_w_67401 && zzero_lte_i_67402;
                    bool y_67405 = zzero_leq_i_p_m_t_s_67400 && y_67404;
                    bool forwards_ok_67406 = i_lte_j_67403 && y_67405;
                    bool ok_or_empty_67407 = empty_slice_67144 || forwards_ok_67406;
                    bool index_certs_67408;
                    
                    if (!ok_or_empty_67407) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67169, ":", (long long) end_67170, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:109:37-74\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_67177 = add64(nR_44377, nR_44377);
                    int64_t segmap_usable_groups_71189 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_71188);
                    
                    if (memblock_alloc_device(ctx, &mem_77662, bytes_77661, "mem_77662")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_77664, bytes_77661, "mem_77664")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_78871 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_71188));
                    
                    {
                        err = gpu_kernel_inner_SMJ_intzisegmap_71193(ctx, segmap_usable_groups_71189, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_70981, 1, 1, (int64_t) 0, nR_44377, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, max_res_67171, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, zt_rhs_67177, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77653.mem, mem_77662.mem, mem_77664.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_77666 = (int64_t) 8 * ret_67383;
                    
                    if (cond_67381) {
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77662, "mem_77662") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77664, "mem_77664") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77669, bytes_77666, "mem_77669")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_77669, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_77667, bytes_77666, "mem_77667")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_78892 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77662.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        
                        int64_t tmp_offs_78893 = (int64_t) 0;
                        
                        if (!(tmp_offs_78893 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_78893 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77664.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78893 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77667, "mem_77667") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77669, "mem_77669") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
                        return 1;
                    
                    int64_t tmp_67398 = add64((int64_t) 1, p_67166);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77644.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77671.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77646.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77670.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
                        return 1;
                    
                    bool loop_cond_67411 = slt64(tmp_67398, numberOfWindows_44384);
                    bool loop_while_tmp_78867 = loop_cond_67411;
                    int64_t p_tmp_78868 = tmp_67398;
                    
                    loop_while_67165 = loop_while_tmp_78867;
                    p_67166 = p_tmp_78868;
                }
                defunc_0_windowed_partitionFunc_res_67161 = loop_while_67165;
                defunc_0_windowed_partitionFunc_res_67162 = p_67166;
                if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_77680, bytes_77643, "mem_77680")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77682, bytes_77643, "mem_77682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_78894 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_71562));
                
                {
                    err = gpu_kernel_inner_SMJ_intzisegmap_71567(ctx, segmap_usable_groups_71563, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71398, 1, 1, (int64_t) 0, nR_44377, gt_rhs_66981, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zeze_rhs_67414, tR_mem_77625.mem, tS_mem_77626.mem, mem_77644.mem, mem_77646.mem, mem_77680.mem, mem_77682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_77904;
                int64_t ext_77903;
                int64_t ext_77902;
                int64_t ext_77901;
                bool defunc_0_join_chunks_res_67570;
                int64_t defunc_0_join_chunks_res_67571;
                bool loop_while_67574;
                int64_t p_67575;
                int64_t ctx_param_ext_77683;
                int64_t ctx_param_ext_77684;
                int64_t ctx_param_ext_77686;
                int64_t ctx_param_ext_77687;
                
                if (memblock_set_device(ctx, &mem_param_77685, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77688, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77683 = (int64_t) 0;
                ctx_param_ext_77684 = (int64_t) 1;
                ctx_param_ext_77686 = (int64_t) 0;
                ctx_param_ext_77687 = (int64_t) 1;
                loop_while_67574 = loop_cond_67569;
                p_67575 = (int64_t) 0;
                while (loop_while_67574) {
                    bool x_67578 = sle64((int64_t) 0, p_67575);
                    bool y_67579 = slt64(p_67575, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67580 = x_67578 && y_67579;
                    bool index_certs_67581;
                    
                    if (!bounds_check_67580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:187:22-34\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_79568;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79568, mem_77680.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67582 = read_res_79568;
                    int64_t read_res_79569;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79569, mem_77682.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67583 = read_res_79569;
                    int64_t min_res_67584 = smin64(zeze_rhs_67414, loopres_67583);
                    bool cond_67585 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, loopres_67582);
                    bool cond_67589 = slt64(min_res_67584, (int64_t) 0);
                    bool protect_assert_disj_67591 = bounds_check_67580 || cond_67589;
                    bool protect_assert_disj_78297 = cond_67585 || protect_assert_disj_67591;
                    bool index_certs_67592;
                    
                    if (!protect_assert_disj_78297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:191:19-32\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_67595 = add64((int64_t) 1, p_67575);
                    bool cond_67596 = zeze_lhs_67595 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    bool x_67598 = sle64((int64_t) 0, zeze_lhs_67595);
                    bool y_67599 = slt64(zeze_lhs_67595, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67600 = x_67598 && y_67599;
                    bool protect_assert_disj_67601 = cond_67596 || bounds_check_67600;
                    bool protect_assert_disj_67602 = cond_67589 || protect_assert_disj_67601;
                    bool protect_assert_disj_78300 = cond_67585 || protect_assert_disj_67602;
                    bool index_certs_67603;
                    
                    if (!protect_assert_disj_78300) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67595, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:192:49-64\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_78294 = !cond_67585;
                    bool x_67590 = !cond_67589;
                    bool protect_cond_conj_78298 = x_67590 && x_78294;
                    int64_t loopres_f_res_f_res_67593;
                    
                    if (protect_cond_conj_78298) {
                        int64_t read_res_79570;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79570, mem_77644.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68863 = read_res_79570;
                        
                        loopres_f_res_f_res_67593 = x_68863;
                    } else {
                        loopres_f_res_f_res_67593 = (int64_t) 0;
                    }
                    
                    bool x_67597 = !cond_67596;
                    bool protect_cond_conj_67604 = x_67590 && x_67597;
                    bool protect_cond_conj_78301 = protect_cond_conj_67604 && x_78294;
                    int64_t r_end_f_res_67605;
                    
                    if (protect_cond_conj_78301) {
                        int64_t read_res_79571;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79571, mem_77644.mem, zeze_lhs_67595 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68864 = read_res_79571;
                        
                        r_end_f_res_67605 = x_68864;
                    } else {
                        r_end_f_res_67605 = (int64_t) 0;
                    }
                    
                    int64_t r_end_67607;
                    
                    if (cond_67596) {
                        r_end_67607 = nR_44377;
                    } else {
                        r_end_67607 = r_end_f_res_67605;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 = sub64(r_end_67607, loopres_f_res_f_res_67593);
                    int64_t ext_77893;
                    
                    if (cond_67589) {
                        ext_77893 = ctx_param_ext_77683;
                    } else {
                        ext_77893 = (int64_t) 0;
                    }
                    
                    int64_t ext_77892;
                    
                    if (cond_67589) {
                        ext_77892 = ctx_param_ext_77684;
                    } else {
                        ext_77892 = (int64_t) 1;
                    }
                    
                    int64_t ext_77890;
                    
                    if (cond_67589) {
                        ext_77890 = ctx_param_ext_77686;
                    } else {
                        ext_77890 = (int64_t) 0;
                    }
                    
                    int64_t ext_77889;
                    
                    if (cond_67589) {
                        ext_77889 = ctx_param_ext_77687;
                    } else {
                        ext_77889 = (int64_t) 1;
                    }
                    
                    int64_t bytes_77689 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;
                    int64_t ext_77899;
                    
                    if (cond_67585) {
                        ext_77899 = ctx_param_ext_77683;
                    } else {
                        ext_77899 = ext_77893;
                    }
                    
                    int64_t ext_77898;
                    
                    if (cond_67585) {
                        ext_77898 = ctx_param_ext_77684;
                    } else {
                        ext_77898 = ext_77892;
                    }
                    
                    int64_t ext_77896;
                    
                    if (cond_67585) {
                        ext_77896 = ctx_param_ext_77686;
                    } else {
                        ext_77896 = ext_77890;
                    }
                    
                    int64_t ext_77895;
                    
                    if (cond_67585) {
                        ext_77895 = ctx_param_ext_77687;
                    } else {
                        ext_77895 = ext_77889;
                    }
                    
                    int64_t loopres_67586;
                    
                    if (cond_67585) {
                        loopres_67586 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    } else {
                        loopres_67586 = zeze_lhs_67595;
                    }
                    if (cond_67585) {
                        if (memblock_set_device(ctx, &ext_mem_77900, &mem_param_77685, "mem_param_77685") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &mem_param_77688, "mem_param_77688") != 0)
                            return 1;
                    } else {
                        if (cond_67589) {
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_param_77685, "mem_param_77685") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_param_77688, "mem_param_77688") != 0)
                                return 1;
                        } else {
                            bool empty_slice_67611 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 == (int64_t) 0;
                            int64_t m_67612 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 1);
                            int64_t i_p_m_t_s_67613 = add64(loopres_f_res_f_res_67593, m_67612);
                            bool zzero_leq_i_p_m_t_s_67614 = sle64((int64_t) 0, i_p_m_t_s_67613);
                            bool i_p_m_t_s_leq_w_67615 = slt64(i_p_m_t_s_67613, nR_44377);
                            bool zzero_lte_i_67616 = sle64((int64_t) 0, loopres_f_res_f_res_67593);
                            bool i_lte_j_67617 = sle64(loopres_f_res_f_res_67593, r_end_67607);
                            bool y_67618 = i_p_m_t_s_leq_w_67615 && zzero_lte_i_67616;
                            bool y_67619 = zzero_leq_i_p_m_t_s_67614 && y_67618;
                            bool forwards_ok_67620 = i_lte_j_67617 && y_67619;
                            bool ok_or_empty_67621 = empty_slice_67611 || forwards_ok_67620;
                            bool index_certs_67622;
                            
                            if (!ok_or_empty_67621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_67593, ":", (long long) r_end_67607, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftSMJ.fut:193:16-33\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_67625 = sle64(loopres_67582, min_res_67584);
                            bool loop_not_taken_67630 = !loop_cond_67625;
                            bool protect_assert_disj_67631 = loop_not_taken_67630 || nonzzero_68535;
                            bool nonzzero_cert_67632;
                            
                            if (!protect_assert_disj_67631) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77690, bytes_77689, "mem_77690")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77692, bytes_77689, "mem_77692")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77692, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_67626 = add64(extParallelism_44385, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                            int64_t zs_lhs_67627 = sub64(zm_lhs_67626, (int64_t) 1);
                            int64_t numIter_67633 = sdiv_safe64(zs_lhs_67627, extParallelism_44385);
                            bool loop_cond_67634 = slt64((int64_t) 0, numIter_67633);
                            bool loop_not_taken_67635 = !loop_cond_67634;
                            int64_t segmap_tblock_sizze_71915;
                            
                            segmap_tblock_sizze_71915 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71905;
                            
                            int64_t segmap_usable_groups_71916 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71915);
                            int64_t segmap_tblock_sizze_71936;
                            
                            segmap_tblock_sizze_71936 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71927;
                            
                            int64_t segmap_usable_groups_71937 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71936);
                            
                            if (memblock_alloc_device(ctx, &mem_77711, (int64_t) 4, "mem_77711")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77712, (int64_t) 4, "mem_77712")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77715, (int64_t) 1, "mem_77715")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_67636;
                            int64_t loopres_f_res_f_res_67637;
                            bool loop_while_67640;
                            int64_t dp_67641;
                            
                            if (memblock_set_device(ctx, &mem_param_77695, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_77698, &mem_77690, "mem_77690") != 0)
                                return 1;
                            loop_while_67640 = loop_cond_67625;
                            dp_67641 = loopres_67582;
                            while (loop_while_67640) {
                                bool x_67644 = sle64((int64_t) 0, dp_67641);
                                bool y_67645 = slt64(dp_67641, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67646 = x_67644 && y_67645;
                                bool index_certs_67647;
                                
                                if (!bounds_check_67646) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_67641, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:197:21-38\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_79572;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_79572, mem_77646.mem, dp_67641 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_67648 = read_res_79572;
                                int64_t zeze_lhs_67649 = add64((int64_t) 1, dp_67641);
                                bool cond_67650 = zeze_lhs_67649 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                                bool x_67651 = !cond_67650;
                                bool x_67652 = sle64((int64_t) 0, zeze_lhs_67649);
                                bool y_67653 = slt64(zeze_lhs_67649, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67654 = x_67652 && y_67653;
                                bool protect_assert_disj_67655 = cond_67650 || bounds_check_67654;
                                bool index_certs_67656;
                                
                                if (!protect_assert_disj_67655) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67649, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:198:55-74\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_67657;
                                
                                if (x_67651) {
                                    int64_t read_res_79573;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79573, mem_77646.mem, zeze_lhs_67649 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_68865 = read_res_79573;
                                    
                                    s_end_f_res_67657 = x_68865;
                                } else {
                                    s_end_f_res_67657 = (int64_t) 0;
                                }
                                
                                int64_t s_end_67659;
                                
                                if (cond_67650) {
                                    s_end_67659 = nR_44377;
                                } else {
                                    s_end_67659 = s_end_f_res_67657;
                                }
                                
                                int64_t j_m_i_67660 = sub64(s_end_67659, loopres_67648);
                                bool empty_slice_67661 = j_m_i_67660 == (int64_t) 0;
                                int64_t m_67662 = sub64(j_m_i_67660, (int64_t) 1);
                                int64_t i_p_m_t_s_67663 = add64(loopres_67648, m_67662);
                                bool zzero_leq_i_p_m_t_s_67664 = sle64((int64_t) 0, i_p_m_t_s_67663);
                                bool i_p_m_t_s_leq_w_67665 = slt64(i_p_m_t_s_67663, nR_44377);
                                bool zzero_lte_i_67666 = sle64((int64_t) 0, loopres_67648);
                                bool i_lte_j_67667 = sle64(loopres_67648, s_end_67659);
                                bool y_67668 = i_p_m_t_s_leq_w_67665 && zzero_lte_i_67666;
                                bool y_67669 = zzero_leq_i_p_m_t_s_67664 && y_67668;
                                bool forwards_ok_67670 = i_lte_j_67667 && y_67669;
                                bool ok_or_empty_67671 = empty_slice_67661 || forwards_ok_67670;
                                bool index_certs_67672;
                                
                                if (!ok_or_empty_67671) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_67648, ":", (long long) s_end_67659, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  ftSMJ.fut:199:18-35\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_67675 = slt64((int64_t) 0, j_m_i_67660);
                                bool loop_not_taken_67676 = !cond_67675;
                                bool x_67677 = sle64((int64_t) 0, m_67662);
                                bool y_67678 = slt64(m_67662, j_m_i_67660);
                                bool bounds_check_67682 = x_67677 && y_67678;
                                bool protect_assert_disj_67683 = loop_not_taken_67676 || bounds_check_67682;
                                bool protect_assert_disj_67684 = loop_not_taken_67635 || protect_assert_disj_67683;
                                bool index_certs_67685;
                                
                                if (!protect_assert_disj_67684) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67662, "] out of bounds for array of shape [", (long long) j_m_i_67660, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_68069 = tS_start_66998 + loopres_67648;
                                int64_t find_joinTuples_arg3_67674 = add64(join_chunks_arg3_67139, loopres_67648);
                                bool protect_cond_conj_67679 = loop_cond_67634 && cond_67675;
                                
                                if (protect_cond_conj_67679) {
                                    if (memblock_alloc_device(ctx, &mem_77700, (int64_t) 4, "mem_77700")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_78923(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68069, tS_mem_77626.mem, mem_77700.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77700, "mem_77700") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77699, (int64_t) 4, "mem_77699")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i32(ctx, mem_77699, (int64_t) 1, 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77699, "mem_77699") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_67679) {
                                    int64_t slice_68867 = tS_start_66998 + i_p_m_t_s_67663;
                                    
                                    if (memblock_alloc_device(ctx, &mem_77703, (int64_t) 4, "mem_77703")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_78929(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68867, tS_mem_77626.mem, mem_77703.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77703, "mem_77703") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77702, (int64_t) 4, "mem_77702")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i32(ctx, mem_77702, (int64_t) 1, 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77702, "mem_77702") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_77717 = (int64_t) 4 * j_m_i_67660;
                                int64_t ext_77864;
                                int64_t ext_77863;
                                int64_t ext_77862;
                                int64_t ext_77861;
                                bool defunc_0_find_joinTuples_res_67688;
                                int64_t defunc_0_find_joinTuples_res_67689;
                                bool loop_while_67692;
                                int64_t p_67693;
                                int64_t ctx_param_ext_77705;
                                int64_t ctx_param_ext_77706;
                                int64_t ctx_param_ext_77708;
                                int64_t ctx_param_ext_77709;
                                
                                if (memblock_set_device(ctx, &mem_param_77707, &mem_77692, "mem_77692") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77710, &mem_77690, "mem_77690") != 0)
                                    return 1;
                                ctx_param_ext_77705 = (int64_t) 0;
                                ctx_param_ext_77706 = (int64_t) 1;
                                ctx_param_ext_77708 = (int64_t) 0;
                                ctx_param_ext_77709 = (int64_t) 1;
                                loop_while_67692 = loop_cond_67634;
                                p_67693 = (int64_t) 0;
                                while (loop_while_67692) {
                                    int64_t start_67696 = mul64(extParallelism_44385, p_67693);
                                    int64_t min_arg1_67697 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, start_67696);
                                    int64_t min_res_67698 = smin64(extParallelism_44385, min_arg1_67697);
                                    int64_t iter_R_67699 = add64(start_67696, min_res_67698);
                                    bool empty_slice_67700 = min_res_67698 == (int64_t) 0;
                                    int64_t m_67701 = sub64(min_res_67698, (int64_t) 1);
                                    int64_t i_p_m_t_s_67702 = add64(start_67696, m_67701);
                                    bool zzero_leq_i_p_m_t_s_67703 = sle64((int64_t) 0, i_p_m_t_s_67702);
                                    bool i_p_m_t_s_leq_w_67704 = slt64(i_p_m_t_s_67702, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                                    bool zzero_lte_i_67705 = sle64((int64_t) 0, start_67696);
                                    bool i_lte_j_67706 = sle64(start_67696, iter_R_67699);
                                    bool y_67707 = i_p_m_t_s_leq_w_67704 && zzero_lte_i_67705;
                                    bool y_67708 = zzero_leq_i_p_m_t_s_67703 && y_67707;
                                    bool forwards_ok_67709 = i_lte_j_67706 && y_67708;
                                    bool ok_or_empty_67710 = empty_slice_67700 || forwards_ok_67709;
                                    bool index_certs_67711;
                                    
                                    if (!ok_or_empty_67710) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67696, ":", (long long) iter_R_67699, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67718 = slt64(m_67701, min_res_67698);
                                    bool x_67717 = sle64((int64_t) 0, m_67701);
                                    bool bounds_check_67719 = x_67717 && y_67718;
                                    bool index_certs_67720;
                                    
                                    if (!bounds_check_67719) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67701, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67714 = slt64((int64_t) 0, min_res_67698);
                                    bool index_certs_67715;
                                    
                                    if (!y_67714) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:364:133-136\n   #2  ftSMJ.fut:353:1-364:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_67712 = loopres_f_res_f_res_67593 + start_67696;
                                    int64_t slice_67721 = loopres_f_res_f_res_67593 + i_p_m_t_s_67702;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_78945(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_67712, slice_67721, tR_mem_77625.mem, mem_77711.mem, mem_77712.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77713, &ext_mem_77704, "ext_mem_77704") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77713, &mem_77711, "mem_77711") != 0)
                                        return 1;
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77714, &ext_mem_77701, "ext_mem_77701") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77714, &mem_77712, "mem_77712") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_78951(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77712.mem, ext_mem_77713.mem, mem_77715.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
                                        return 1;
                                    
                                    bool read_res_79574;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79574, mem_77715.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_67725 = read_res_79574;
                                    int64_t ext_77859;
                                    int64_t ext_77858;
                                    int64_t ext_77856;
                                    int64_t ext_77855;
                                    int64_t loopres_67726;
                                    
                                    if (defunc_0_gt_res_67725) {
                                        if (memblock_set_device(ctx, &ext_mem_77860, &mem_param_77707, "mem_param_77707") != 0)
                                            return 1;
                                        ext_77859 = ctx_param_ext_77705;
                                        ext_77858 = ctx_param_ext_77706;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &mem_param_77710, "mem_param_77710") != 0)
                                            return 1;
                                        ext_77856 = ctx_param_ext_77708;
                                        ext_77855 = ctx_param_ext_77709;
                                        loopres_67726 = numIter_67633;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_77716, (int64_t) 1, "mem_77716")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_intzigpuseq_78957(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77711.mem, ext_mem_77714.mem, mem_77716.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_79575;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_79575, mem_77716.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_67729 = read_res_79575;
                                        
                                        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
                                            return 1;
                                        
                                        int64_t ext_77853;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77853 = ctx_param_ext_77705;
                                        } else {
                                            ext_77853 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77852;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77852 = ctx_param_ext_77706;
                                        } else {
                                            ext_77852 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_77850;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77850 = ctx_param_ext_77708;
                                        } else {
                                            ext_77850 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77849;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77849 = ctx_param_ext_77709;
                                        } else {
                                            ext_77849 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_67730;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            int64_t tmp_68871 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_param_77707, "mem_param_77707") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_param_77710, "mem_param_77710") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_68871;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_77718, bytes_77717, "mem_77718")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_77718.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, slice_68069, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67660})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_9745(ctx, &ext_mem_77720, mem_77718, j_m_i_67660, find_joinTuples_arg3_67674) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_71727;
                                            
                                            suff_outer_par_71727 = *ctx->tuning_params.inner_SMJ_intzisuff_outer_par_1 <= min_res_67698;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_int.suff_outer_par_1", (long) min_res_67698, suff_outer_par_71727 ? "true" : "false");
                                            
                                            int64_t tile_sizze_77124;
                                            
                                            tile_sizze_77124 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123;
                                            
                                            int64_t tile_sizze_76769;
                                            
                                            tile_sizze_76769 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768;
                                            
                                            int64_t num_whole_tiles_77140 = squot_safe64(j_m_i_67660, tile_sizze_77124);
                                            int64_t residual_input_77364 = srem_safe64(j_m_i_67660, tile_sizze_77124);
                                            bool cond_77365 = residual_input_77364 == (int64_t) 0;
                                            int64_t binop_x_77381 = tile_sizze_77124 * num_whole_tiles_77140;
                                            int64_t bytes_77778 = (int64_t) 8 * min_res_67698;
                                            int64_t bytes_77741 = (int64_t) 8 * tile_sizze_77124;
                                            int64_t bytes_77743 = (int64_t) 4 * tile_sizze_77124;
                                            int64_t num_whole_tiles_76785 = squot_safe64(j_m_i_67660, tile_sizze_76769);
                                            int64_t residual_input_77009 = srem_safe64(j_m_i_67660, tile_sizze_76769);
                                            bool cond_77010 = residual_input_77009 == (int64_t) 0;
                                            int64_t binop_x_77026 = tile_sizze_76769 * num_whole_tiles_76785;
                                            int64_t bytes_77802 = (int64_t) 8 * tile_sizze_76769;
                                            int64_t bytes_77804 = (int64_t) 4 * tile_sizze_76769;
                                            int64_t shared_memory_capacity_79015;
                                            
                                            shared_memory_capacity_79015 = ctx->max_shared_memory;
                                            if (suff_outer_par_71727 && sle64(sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77804, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_79015)) {
                                                int64_t ldim_76770 = sdiv_up64(min_res_67698, tile_sizze_76769);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77840, bytes_77778, "mem_77840")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77842, bytes_77778, "mem_77842")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78963 = sext_i64_i32(sdiv_up64(tile_sizze_76769, tile_sizze_76769));
                                                int32_t virt_num_tblocks_78964 = sext_i64_i32(ldim_76770);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_76767(ctx, ldim_76770, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_76768, 1, 1, bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8) + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8)) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_76770, num_whole_tiles_76785, residual_input_77009, cond_77010, binop_x_77026, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77840.mem, mem_77842.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77840, "mem_77840") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77842, "mem_77842") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_77125 = sdiv_up64(min_res_67698, tile_sizze_77124);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77779, bytes_77778, "mem_77779")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77781, bytes_77778, "mem_77781")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78989 = sext_i64_i32(sdiv_up64(tile_sizze_77124, tile_sizze_77124));
                                                int32_t virt_num_tblocks_78990 = sext_i64_i32(ldim_77125);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_77122(ctx, ldim_77125, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_77123, 1, 1, bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8) + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8)) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_77125, num_whole_tiles_77140, residual_input_77364, cond_77365, binop_x_77381, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77779.mem, mem_77781.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77779, "mem_77779") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77781, "mem_77781") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77846, bytes_77689, "mem_77846")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77710.mem, ctx_param_ext_77708, (int64_t []) {ctx_param_ext_77709}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77848, bytes_77689, "mem_77848")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77707.mem, ctx_param_ext_77705, (int64_t []) {ctx_param_ext_77706}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77843.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
                                                return 1;
                                            
                                            int64_t tmp_67777 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_77848, "mem_77848") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_77846, "mem_77846") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_67777;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_77860, &ext_mem_77854, "ext_mem_77854") != 0)
                                            return 1;
                                        ext_77859 = ext_77853;
                                        ext_77858 = ext_77852;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &ext_mem_77851, "ext_mem_77851") != 0)
                                            return 1;
                                        ext_77856 = ext_77850;
                                        ext_77855 = ext_77849;
                                        loopres_67726 = loopres_f_res_67730;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
                                        return 1;
                                    
                                    bool loop_cond_67778 = slt64(loopres_67726, numIter_67633);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_78935, &ext_mem_77860, "ext_mem_77860") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_78936, &ext_mem_77857, "ext_mem_77857") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_78937 = ext_77859;
                                    int64_t ctx_param_ext_tmp_78938 = ext_77858;
                                    int64_t ctx_param_ext_tmp_78939 = ext_77856;
                                    int64_t ctx_param_ext_tmp_78940 = ext_77855;
                                    bool loop_while_tmp_78941 = loop_cond_67778;
                                    int64_t p_tmp_78942 = loopres_67726;
                                    
                                    if (memblock_set_device(ctx, &mem_param_77707, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_77710, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
                                        return 1;
                                    ctx_param_ext_77705 = ctx_param_ext_tmp_78937;
                                    ctx_param_ext_77706 = ctx_param_ext_tmp_78938;
                                    ctx_param_ext_77708 = ctx_param_ext_tmp_78939;
                                    ctx_param_ext_77709 = ctx_param_ext_tmp_78940;
                                    loop_while_67692 = loop_while_tmp_78941;
                                    p_67693 = p_tmp_78942;
                                }
                                if (memblock_set_device(ctx, &ext_mem_77866, &mem_param_77707, "mem_param_77707") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_77865, &mem_param_77710, "mem_param_77710") != 0)
                                    return 1;
                                ext_77864 = ctx_param_ext_77705;
                                ext_77863 = ctx_param_ext_77706;
                                ext_77862 = ctx_param_ext_77708;
                                ext_77861 = ctx_param_ext_77709;
                                defunc_0_find_joinTuples_res_67688 = loop_while_67692;
                                defunc_0_find_joinTuples_res_67689 = p_67693;
                                if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77869, bytes_77689, "mem_77869")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79016 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71915));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_71919(ctx, segmap_usable_groups_71916, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71905, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77861, ext_77862, mem_param_77698.mem, ext_mem_77865.mem, mem_77869.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77872, bytes_77689, "mem_77872")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79025 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71936));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_71940(ctx, segmap_usable_groups_71937, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71927, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77863, ext_77864, mem_param_77695.mem, ext_mem_77866.mem, mem_77872.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
                                    return 1;
                                
                                bool loop_cond_67788 = sle64(zeze_lhs_67649, min_res_67584);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_78917, &mem_77872, "mem_77872") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_78918, &mem_77869, "mem_77869") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_78919 = loop_cond_67788;
                                int64_t dp_tmp_78920 = zeze_lhs_67649;
                                
                                if (memblock_set_device(ctx, &mem_param_77695, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77698, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
                                    return 1;
                                loop_while_67640 = loop_while_tmp_78919;
                                dp_67641 = dp_tmp_78920;
                            }
                            if (memblock_set_device(ctx, &ext_mem_77878, &mem_param_77695, "mem_param_77695") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77877, &mem_param_77698, "mem_param_77698") != 0)
                                return 1;
                            loopres_f_res_f_res_67636 = loop_while_67640;
                            loopres_f_res_f_res_67637 = dp_67641;
                            if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_71957;
                            
                            segmap_tblock_sizze_71957 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71947;
                            
                            int64_t segmap_usable_groups_71958 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71957);
                            
                            if (memblock_alloc_device(ctx, &mem_77881, bytes_77689, "mem_77881")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79034 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71957));
                            
                            {
                                err = gpu_kernel_inner_SMJ_intzisegmap_71961(ctx, segmap_usable_groups_71958, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71947, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77686, ctx_param_ext_77687, mem_param_77688.mem, ext_mem_77877.mem, mem_77881.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_71978;
                            
                            segmap_tblock_sizze_71978 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71969;
                            
                            int64_t segmap_usable_groups_71979 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71978);
                            
                            if (memblock_alloc_device(ctx, &mem_77884, bytes_77689, "mem_77884")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79043 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_71978));
                            
                            {
                                err = gpu_kernel_inner_SMJ_intzisegmap_71982(ctx, segmap_usable_groups_71979, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71969, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77683, ctx_param_ext_77684, mem_param_77685.mem, ext_mem_77878.mem, mem_77884.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77886, bytes_77628, "mem_77886")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77688.mem, ctx_param_ext_77686, (int64_t []) {ctx_param_ext_77687}, (int64_t []) {nR_44377})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77881.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77888, bytes_77628, "mem_77888")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77685.mem, ctx_param_ext_77683, (int64_t []) {ctx_param_ext_77684}, (int64_t []) {nR_44377})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77884.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_77888, "mem_77888") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_77886, "mem_77886") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_77900, &ext_mem_77894, "ext_mem_77894") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &ext_mem_77891, "ext_mem_77891") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_67804 = slt64(loopres_67586, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78907, &ext_mem_77900, "ext_mem_77900") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78908, &ext_mem_77897, "ext_mem_77897") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78909 = ext_77899;
                    int64_t ctx_param_ext_tmp_78910 = ext_77898;
                    int64_t ctx_param_ext_tmp_78911 = ext_77896;
                    int64_t ctx_param_ext_tmp_78912 = ext_77895;
                    bool loop_while_tmp_78913 = loop_cond_67804;
                    int64_t p_tmp_78914 = loopres_67586;
                    
                    if (memblock_set_device(ctx, &mem_param_77685, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77688, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
                        return 1;
                    ctx_param_ext_77683 = ctx_param_ext_tmp_78909;
                    ctx_param_ext_77684 = ctx_param_ext_tmp_78910;
                    ctx_param_ext_77686 = ctx_param_ext_tmp_78911;
                    ctx_param_ext_77687 = ctx_param_ext_tmp_78912;
                    loop_while_67574 = loop_while_tmp_78913;
                    p_67575 = p_tmp_78914;
                }
                if (memblock_set_device(ctx, &ext_mem_77906, &mem_param_77685, "mem_param_77685") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_77905, &mem_param_77688, "mem_param_77688") != 0)
                    return 1;
                ext_77904 = ctx_param_ext_77683;
                ext_77903 = ctx_param_ext_77684;
                ext_77902 = ctx_param_ext_77686;
                ext_77901 = ctx_param_ext_77687;
                defunc_0_join_chunks_res_67570 = loop_while_67574;
                defunc_0_join_chunks_res_67571 = p_67575;
                if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_77906, "ext_mem_77906") != 0)
                    return 1;
                ext_78076 = ext_77904;
                ext_78075 = ext_77903;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_77905, "ext_mem_77905") != 0)
                    return 1;
                ext_78073 = ext_77902;
                ext_78072 = ext_77901;
            }
            
            int64_t segmap_tblock_sizze_71999;
            
            segmap_tblock_sizze_71999 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71989;
            
            int64_t segmap_usable_groups_72000 = sdiv_up64(nR_44377, segmap_tblock_sizze_71999);
            
            if (memblock_alloc_device(ctx, &mem_78080, bytes_77628, "mem_78080")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79052 = sext_i64_i32(sdiv_up64(nR_44377, segmap_tblock_sizze_71999));
            
            {
                err = gpu_kernel_inner_SMJ_intzisegmap_72003(ctx, segmap_usable_groups_72000, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_71989, 1, 1, (int64_t) 0, nR_44377, ext_78072, ext_78073, mem_param_77640.mem, ext_mem_78074.mem, mem_78080.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_72020;
            
            segmap_tblock_sizze_72020 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72011;
            
            int64_t segmap_usable_groups_72021 = sdiv_up64(nR_44377, segmap_tblock_sizze_72020);
            
            if (memblock_alloc_device(ctx, &mem_78083, bytes_77628, "mem_78083")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79061 = sext_i64_i32(sdiv_up64(nR_44377, segmap_tblock_sizze_72020));
            
            {
                err = gpu_kernel_inner_SMJ_intzisegmap_72024(ctx, segmap_usable_groups_72021, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72011, 1, 1, (int64_t) 0, nR_44377, ext_78075, ext_78076, mem_param_77637.mem, ext_mem_78077.mem, mem_78083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_78084, (int64_t) 1, "mem_78084")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_intzigpuseq_79070(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, i_p_m_t_s_67004, tR_mem_77625.mem, tS_mem_77626.mem, mem_78084.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_79576;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_79576, mem_78084.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_67821 = read_res_79576;
            
            if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
                return 1;
            
            int64_t nextIter_67822;
            
            if (defunc_0_leq_res_67821) {
                int64_t nextIter_t_res_68886 = add64((int64_t) 1, p_66995);
                
                nextIter_67822 = nextIter_t_res_68886;
            } else {
                nextIter_67822 = numIter_66975;
            }
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_78083, "mem_78083") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_78080, "mem_78080") != 0)
                return 1;
            loopres_67019 = nextIter_67822;
        }
        
        bool loop_cond_67824 = slt64(loopres_67019, numIter_66975);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78750, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78751, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        
        bool loop_while_tmp_78752 = loop_cond_67824;
        int64_t p_tmp_78753 = loopres_67019;
        
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77640, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        loop_while_66994 = loop_while_tmp_78752;
        p_66995 = p_tmp_78753;
    }
    if (memblock_set_device(ctx, &ext_mem_78096, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78095, &mem_param_77640, "mem_param_77640") != 0)
        return 1;
    defunc_0_mergeJoin_res_66990 = loop_while_66994;
    defunc_0_mergeJoin_res_66991 = p_66995;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_72030;
    
    segscan_tblock_sizze_72030 = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72029;
    
    int64_t num_tblocks_72032;
    int64_t max_num_tblocks_79076;
    
    max_num_tblocks_79076 = *ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_72031;
    num_tblocks_72032 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_44377, segscan_tblock_sizze_72030), max_num_tblocks_79076)));
    if (memblock_alloc_device(ctx, &mem_78099, bytes_77628, "mem_78099")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78101, bytes_77628, "mem_78101")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_44377)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79077;
        
        shared_memory_79077 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79078;
        
        thread_block_sizze_79078 = ctx->max_thread_block_size;
        
        int64_t registers_79079;
        
        registers_79079 = ctx->max_registers;
        
        int64_t thread_block_sizze_79080;
        
        thread_block_sizze_79080 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79081 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79077, thread_block_sizze_79078), (int64_t) 8), squot64(squot64(registers_79079, thread_block_sizze_79080) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79082 = sdiv_up64(nR_44377, segscan_tblock_sizze_72030 * chunk_sizze_79081);
        int64_t num_virt_threads_79083 = num_virt_blocks_79082 * segscan_tblock_sizze_72030;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79081, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79084, num_virt_blocks_79082, "status_flags_mem_79084")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79084, num_virt_blocks_79082, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79106, (int64_t) 8 * num_virt_blocks_79082, "aggregates_mem_79106")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79108, (int64_t) 8 * num_virt_blocks_79082, "incprefixes_mem_79108")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzisegscan_72035(ctx, num_tblocks_72032, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72029, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72030), chunk_sizze_79081 * segscan_tblock_sizze_72030 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72030), chunk_sizze_79081 * segscan_tblock_sizze_72030 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_44377, num_tblocks_72032, num_virt_blocks_79082, num_virt_threads_79083, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, status_flags_mem_79084.mem, aggregates_mem_79106.mem, incprefixes_mem_79108.mem, global_dynid_mem_79110.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_67840 = zzero_66972 || bounds_check_66984;
    bool index_certs_67841;
    
    if (!protect_assert_disj_67840) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67842;
    
    if (nonzzero_66973) {
        int64_t read_res_79577;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79577, mem_78099.mem, gt_rhs_66981 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68889 = read_res_79577;
        
        m_f_res_67842 = x_68889;
    } else {
        m_f_res_67842 = (int64_t) 0;
    }
    
    int64_t m_67844;
    
    if (zzero_66972) {
        m_67844 = (int64_t) 0;
    } else {
        m_67844 = m_f_res_67842;
    }
    
    int64_t m_67854 = sub64(m_67844, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67856 = slt64(m_67854, nR_44377);
    bool zzero_leq_i_p_m_t_s_67855 = sle64((int64_t) 0, m_67854);
    bool y_67858 = zzero_leq_i_p_m_t_s_67855 && i_p_m_t_s_leq_w_67856;
    bool i_lte_j_67857 = sle64((int64_t) 0, m_67844);
    bool forwards_ok_67859 = i_lte_j_67857 && y_67858;
    bool eq_x_zz_67851 = (int64_t) 0 == m_f_res_67842;
    bool p_and_eq_x_y_67852 = nonzzero_66973 && eq_x_zz_67851;
    bool empty_slice_67853 = zzero_66972 || p_and_eq_x_y_67852;
    bool ok_or_empty_67860 = empty_slice_67853 || forwards_ok_67859;
    bool index_certs_67861;
    
    if (!ok_or_empty_67860) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67844, "] out of bounds for array of shape [", (long long) nR_44377, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78102 = (int64_t) 8 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78103, bytes_78102, "mem_78103")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78096.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78105, bytes_78102, "mem_78105")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78095.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78107, bytes_78102, "mem_78107")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78107.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t bytes_78108 = (int64_t) 4 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78109, bytes_78108, "mem_78109")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78109.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_77625.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_72040;
    
    segmap_tblock_sizze_72040 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72039;
    
    int64_t num_tblocks_72042;
    int64_t max_num_tblocks_79199;
    
    max_num_tblocks_79199 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72041;
    num_tblocks_72042 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_44377, segmap_tblock_sizze_72040), max_num_tblocks_79199)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79200 = sext_i64_i32(sdiv_up64(nR_44377, segmap_tblock_sizze_72040));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_72037(ctx, num_tblocks_72042, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72039, 1, 1, (int64_t) 0, nR_44377, m_67844, num_tblocks_72042, virt_num_tblocks_79200, tR_mem_77625.mem, ext_mem_77627.mem, ext_mem_78095.mem, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, mem_78103.mem, mem_78105.mem, mem_78107.mem, mem_78109.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_72046;
    
    segscan_tblock_sizze_72046 = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72045;
    
    int64_t num_tblocks_72048;
    int64_t max_num_tblocks_79213;
    
    max_num_tblocks_79213 = *ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_72047;
    num_tblocks_72048 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segscan_tblock_sizze_72046), max_num_tblocks_79213)));
    if (memblock_alloc_device(ctx, &mem_78113, bytes_78102, "mem_78113")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78115, bytes_78102, "mem_78115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78117, bytes_78102, "mem_78117")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_67844)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79214;
        
        shared_memory_79214 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79215;
        
        thread_block_sizze_79215 = ctx->max_thread_block_size;
        
        int64_t registers_79216;
        
        registers_79216 = ctx->max_registers;
        
        int64_t thread_block_sizze_79217;
        
        thread_block_sizze_79217 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79218 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79214, thread_block_sizze_79215), (int64_t) 8), squot64(squot64(registers_79216, thread_block_sizze_79217) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79219 = sdiv_up64(m_67844, segscan_tblock_sizze_72046 * chunk_sizze_79218);
        int64_t num_virt_threads_79220 = num_virt_blocks_79219 * segscan_tblock_sizze_72046;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79218, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79221, num_virt_blocks_79219, "status_flags_mem_79221")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79221, num_virt_blocks_79219, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79223, (int64_t) 8 * num_virt_blocks_79219, "aggregates_mem_79223")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79225, (int64_t) 8 * num_virt_blocks_79219, "incprefixes_mem_79225")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79227, (int64_t) 8 * num_virt_blocks_79219, "aggregates_mem_79227")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79229, (int64_t) 8 * num_virt_blocks_79219, "incprefixes_mem_79229")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzisegscan_72051(ctx, num_tblocks_72048, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_72045, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72046, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72046), smax64(chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72046, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72046), smax64(chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_72046 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_67844, num_tblocks_72048, num_virt_blocks_79219, num_virt_threads_79220, mem_78103.mem, mem_78113.mem, mem_78115.mem, mem_78117.mem, status_flags_mem_79221.mem, aggregates_mem_79223.mem, incprefixes_mem_79225.mem, aggregates_mem_79227.mem, incprefixes_mem_79229.mem, global_dynid_mem_79231.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_72067;
    
    segmap_tblock_sizze_72067 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72055;
    
    int64_t segmap_usable_groups_72068 = sdiv_up64(m_67844, segmap_tblock_sizze_72067);
    
    if (memblock_alloc_device(ctx, &mem_78120, bytes_78102, "mem_78120")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79366 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_72067));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_72071(ctx, segmap_usable_groups_72068, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72055, 1, 1, (int64_t) 0, m_67844, mem_78113.mem, mem_78120.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
        return 1;
    
    bool cond_67895 = slt64((int64_t) 0, m_67844);
    bool y_67896 = slt64(m_67854, m_67844);
    bool bounds_check_67897 = zzero_leq_i_p_m_t_s_67855 && y_67896;
    bool loop_not_taken_67898 = !cond_67895;
    bool protect_assert_disj_67899 = bounds_check_67897 || loop_not_taken_67898;
    bool index_certs_67900;
    
    if (!protect_assert_disj_67899) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  ftSMJ.fut:285:10-41\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78122, (int64_t) 8, "mem_78122")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_79375(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78120.mem, mem_78122.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78122, "mem_78122") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78121, (int64_t) 8, "mem_78121")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78121, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78121, "mem_78121") != 0)
            return 1;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78125, (int64_t) 8, "mem_78125")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_79381(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78103.mem, mem_78125.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78125, "mem_78125") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78124, (int64_t) 8, "mem_78124")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78124, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78124, "mem_78124") != 0)
            return 1;
    }
    
    bool zzero_67912 = scatter_psizze_44386 == (int64_t) 0;
    bool nonzzero_67913 = !zzero_67912;
    bool nonzzero_cert_67914;
    
    if (!nonzzero_67913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_67979 = !empty_slice_67853;
    bool protect_assert_disj_67980 = empty_slice_67853 || bounds_check_67897;
    bool index_certs_67981;
    
    if (!protect_assert_disj_67980) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67982;
    
    if (x_67979) {
        int64_t read_res_79578;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79578, mem_78115.mem, m_67854 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68897 = read_res_79578;
        
        m_f_res_67982 = x_68897;
    } else {
        m_f_res_67982 = (int64_t) 0;
    }
    
    int64_t m_67984;
    
    if (empty_slice_67853) {
        m_67984 = (int64_t) 0;
    } else {
        m_67984 = m_f_res_67982;
    }
    
    int64_t m_67994 = sub64(m_67984, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67996 = slt64(m_67994, m_67844);
    bool zzero_leq_i_p_m_t_s_67995 = sle64((int64_t) 0, m_67994);
    bool y_67998 = zzero_leq_i_p_m_t_s_67995 && i_p_m_t_s_leq_w_67996;
    bool i_lte_j_67997 = sle64((int64_t) 0, m_67984);
    bool forwards_ok_67999 = i_lte_j_67997 && y_67998;
    bool eq_x_zz_67991 = (int64_t) 0 == m_f_res_67982;
    bool p_and_eq_x_y_67992 = x_67979 && eq_x_zz_67991;
    bool empty_slice_67993 = empty_slice_67853 || p_and_eq_x_y_67992;
    bool ok_or_empty_68000 = empty_slice_67993 || forwards_ok_67999;
    bool index_certs_68001;
    
    if (!ok_or_empty_68000) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67984, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:364:133-136\n   #4  ftSMJ.fut:353:1-364:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78127 = (int64_t) 8 * m_67984;
    
    if (memblock_alloc_device(ctx, &mem_78132, (int64_t) 8, "mem_78132")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_intzigpuseq_79387(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_78123.mem, ext_mem_78126.mem, mem_78132.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
        return 1;
    
    int64_t n_pairs_t_res_67905;
    
    if (cond_67895) {
        int64_t read_res_79579;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79579, mem_78132.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_77623 = read_res_79579;
        
        n_pairs_t_res_67905 = x_77623;
    } else {
        n_pairs_t_res_67905 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
        return 1;
    
    int64_t n_pairs_67906;
    
    if (cond_67895) {
        n_pairs_67906 = n_pairs_t_res_67905;
    } else {
        n_pairs_67906 = (int64_t) 0;
    }
    
    int64_t bytes_78133 = (int64_t) 4 * n_pairs_67906;
    int64_t bytes_78135 = (int64_t) 8 * n_pairs_67906;
    int64_t segmap_tblock_sizze_72082;
    
    segmap_tblock_sizze_72082 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72081;
    
    int64_t num_tblocks_72084;
    int64_t max_num_tblocks_79393;
    
    max_num_tblocks_79393 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72083;
    num_tblocks_72084 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_72082), max_num_tblocks_79393)));
    if (memblock_alloc_device(ctx, &mem_78128, bytes_78127, "mem_78128")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78128.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78130, bytes_78127, "mem_78130")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78130.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78120.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_72090;
    
    segmap_tblock_sizze_72090 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72089;
    
    int64_t num_tblocks_72092;
    int64_t max_num_tblocks_79394;
    
    max_num_tblocks_79394 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_72091;
    num_tblocks_72092 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_72090), max_num_tblocks_79394)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79395 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_72090));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_72087(ctx, num_tblocks_72092, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72089, 1, 1, (int64_t) 0, m_67844, m_67984, num_tblocks_72092, virt_num_tblocks_79395, mem_78103.mem, mem_78115.mem, mem_78117.mem, mem_78120.mem, mem_78128.mem, mem_78130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
        return 1;
    
    bool cond_68011 = slt64((int64_t) 0, m_67984);
    int64_t segmap_tblock_sizze_72105;
    
    segmap_tblock_sizze_72105 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72097;
    if (memblock_alloc_device(ctx, &mem_78134, bytes_78133, "mem_78134")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, mem_78134, n_pairs_67906, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78136, bytes_78135, "mem_78136")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78136, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78138, bytes_78135, "mem_78138")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78138, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_67910 = add64(scatter_psizze_44386, n_pairs_67906);
    int64_t zs_lhs_67911 = sub64(zm_lhs_67910, (int64_t) 1);
    int64_t m_67915 = sdiv64(zs_lhs_67911, scatter_psizze_44386);
    bool loop_cond_67916 = slt64((int64_t) 0, m_67915);
    bool partitioned_scatter_res_67917;
    int64_t partitioned_scatter_res_67921;
    bool loop_while_67922;
    int64_t p_67926;
    
    loop_while_67922 = loop_cond_67916;
    p_67926 = (int64_t) 0;
    while (loop_while_67922) {
        int64_t lower_bound_67927 = mul64(scatter_psizze_44386, p_67926);
        int64_t min_arg1_67928 = add64(scatter_psizze_44386, lower_bound_67927);
        int64_t min_res_67929 = smin64(n_pairs_67906, min_arg1_67928);
        int64_t j_m_i_67930 = sub64(min_res_67929, lower_bound_67927);
        bool empty_slice_67931 = j_m_i_67930 == (int64_t) 0;
        int64_t m_67932 = sub64(j_m_i_67930, (int64_t) 1);
        int64_t i_p_m_t_s_67933 = add64(lower_bound_67927, m_67932);
        bool zzero_leq_i_p_m_t_s_67934 = sle64((int64_t) 0, i_p_m_t_s_67933);
        bool i_p_m_t_s_leq_w_67935 = slt64(i_p_m_t_s_67933, n_pairs_67906);
        bool zzero_lte_i_67936 = sle64((int64_t) 0, lower_bound_67927);
        bool i_lte_j_67937 = sle64(lower_bound_67927, min_res_67929);
        bool y_67938 = i_p_m_t_s_leq_w_67935 && zzero_lte_i_67936;
        bool y_67939 = zzero_leq_i_p_m_t_s_67934 && y_67938;
        bool forwards_ok_67940 = i_lte_j_67937 && y_67939;
        bool ok_or_empty_67941 = empty_slice_67931 || forwards_ok_67940;
        bool index_certs_67942;
        
        if (!ok_or_empty_67941) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_67927, ":", (long long) min_res_67929, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78148 = (int64_t) 4 * j_m_i_67930;
        int64_t bytes_78150 = (int64_t) 8 * j_m_i_67930;
        
        if (memblock_alloc_device(ctx, &mem_78149, bytes_78148, "mem_78149")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78134.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78151, bytes_78150, "mem_78151")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78136.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78153, bytes_78150, "mem_78153")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78138.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79413 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_72082));
        
        {
            err = gpu_kernel_inner_SMJ_intzisegmap_72079(ctx, num_tblocks_72084, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72081, 1, 1, (int64_t) 0, m_67844, lower_bound_67927, min_res_67929, j_m_i_67930, num_tblocks_72084, virt_num_tblocks_79413, mem_78105.mem, mem_78107.mem, mem_78109.mem, mem_78120.mem, mem_78149.mem, mem_78151.mem, mem_78153.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_67956 = add64((int64_t) 1, p_67926);
        
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78134.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78136.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78138.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        
        bool loop_cond_67967 = slt64(tmp_67956, m_67915);
        bool loop_while_tmp_79408 = loop_cond_67967;
        int64_t p_tmp_79412 = tmp_67956;
        
        loop_while_67922 = loop_while_tmp_79408;
        p_67926 = p_tmp_79412;
    }
    partitioned_scatter_res_67917 = loop_while_67922;
    partitioned_scatter_res_67921 = p_67926;
    if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
        return 1;
    
    bool loop_cond_t_res_68012 = slt64(m_67844, n_pairs_67906);
    bool x_68013 = cond_68011 && loop_cond_t_res_68012;
    
    if (memblock_alloc_device(ctx, &mem_78179, (int64_t) 4, "mem_78179")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78180, (int64_t) 8, "mem_78180")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78181, (int64_t) 8, "mem_78181")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_68014;
    int64_t joinTups_to_joinPairs_InnerJoin_res_68018;
    bool loop_while_68019;
    int64_t p_68023;
    
    if (memblock_set_device(ctx, &mem_param_78166, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78169, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78172, &mem_78138, "mem_78138") != 0)
        return 1;
    loop_while_68019 = x_68013;
    p_68023 = (int64_t) 0;
    while (loop_while_68019) {
        bool x_68024 = sle64((int64_t) 0, p_68023);
        bool y_68025 = slt64(p_68023, m_67984);
        bool bounds_check_68026 = x_68024 && y_68025;
        bool index_certs_68027;
        
        if (!bounds_check_68026) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_68023, "] out of bounds for array of shape [", (long long) m_67984, "].", "-> #0  ftSMJ.fut:300:13-42\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_79580;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79580, mem_78130.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68028 = read_res_79580;
        int64_t read_res_79581;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79581, mem_78128.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68029 = read_res_79581;
        bool x_68030 = sle64((int64_t) 0, loopres_68028);
        bool y_68031 = slt64(loopres_68028, n_pairs_67906);
        bool bounds_check_68032 = x_68030 && y_68031;
        bool index_certs_68033;
        
        if (!bounds_check_68032) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:302:52-61\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_68044 = add64(loopres_68028, loopres_68029);
        bool empty_slice_68048 = loopres_68029 == (int64_t) 0;
        int64_t m_68049 = sub64(loopres_68029, (int64_t) 1);
        int64_t i_p_m_t_s_68050 = add64(loopres_68028, m_68049);
        bool zzero_leq_i_p_m_t_s_68051 = sle64((int64_t) 0, i_p_m_t_s_68050);
        bool i_p_m_t_s_leq_w_68052 = slt64(i_p_m_t_s_68050, n_pairs_67906);
        bool i_lte_j_68053 = sle64(loopres_68028, tmp_68044);
        bool y_68054 = x_68030 && i_p_m_t_s_leq_w_68052;
        bool y_68055 = zzero_leq_i_p_m_t_s_68051 && y_68054;
        bool forwards_ok_68056 = i_lte_j_68053 && y_68055;
        bool ok_or_empty_68057 = empty_slice_68048 || forwards_ok_68056;
        bool index_certs_68058;
        
        if (!ok_or_empty_68057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, ":", (long long) tmp_68044, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:306:14-55\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:364:133-136\n   #3  ftSMJ.fut:353:1-364:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78182 = (int64_t) 4 * loopres_68029;
        int64_t bytes_78184 = (int64_t) 8 * loopres_68029;
        int64_t segmap_usable_groups_72106 = sdiv_up64(loopres_68029, segmap_tblock_sizze_72105);
        int64_t tmp_68043 = add64((int64_t) 1, p_68023);
        
        if (memblock_alloc_device(ctx, &mem_78174, bytes_78133, "mem_78174")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78174.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78176, bytes_78135, "mem_78176")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78178, bytes_78135, "mem_78178")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78172.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        
        bool cond_68062 = slt64(tmp_68043, m_67984);
        bool x_68063 = loop_cond_t_res_68012 && cond_68062;
        
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_79434(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_68028, mem_param_78166.mem, mem_param_78169.mem, mem_param_78172.mem, mem_78179.mem, mem_78180.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78183, bytes_78182, "mem_78183")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79440 = loopres_68029;
        int64_t tblock_sizze_79445;
        
        tblock_sizze_79445 = *ctx->tuning_params.inner_SMJ_intzitblock_sizze_79445;
        
        int64_t virt_num_tblocks_79446 = sdiv_up64(replicate_n_79440, tblock_sizze_79445);
        int64_t num_tblocks_79447 = smin64(virt_num_tblocks_79446, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_intzireplicate_79441(ctx, num_tblocks_79447, 1, 1, tblock_sizze_79445, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79440, virt_num_tblocks_79446, num_tblocks_79447, mem_78179.mem, mem_78183.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78185, bytes_78184, "mem_78185")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79460 = loopres_68029;
        int64_t tblock_sizze_79465;
        
        tblock_sizze_79465 = *ctx->tuning_params.inner_SMJ_intzitblock_sizze_79465;
        
        int64_t virt_num_tblocks_79466 = sdiv_up64(replicate_n_79460, tblock_sizze_79465);
        int64_t num_tblocks_79467 = smin64(virt_num_tblocks_79466, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_intzireplicate_79461(ctx, num_tblocks_79467, 1, 1, tblock_sizze_79465, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79460, virt_num_tblocks_79466, num_tblocks_79467, mem_78180.mem, mem_78185.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79480 = sext_i64_i32(sdiv_up64(loopres_68029, segmap_tblock_sizze_72105));
        
        {
            err = gpu_kernel_inner_SMJ_intzisegmap_72109(ctx, segmap_usable_groups_72106, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_72097, 1, 1, (int64_t) 0, loopres_68028, loopres_68029, mem_78178.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78174.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78185.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79426, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79427, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79428, &mem_78178, "mem_78178") != 0)
            return 1;
        
        bool loop_while_tmp_79429 = x_68063;
        int64_t p_tmp_79433 = tmp_68043;
        
        if (memblock_set_device(ctx, &mem_param_78166, &mem_param_tmp_79426, "mem_param_tmp_79426") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78169, &mem_param_tmp_79427, "mem_param_tmp_79427") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78172, &mem_param_tmp_79428, "mem_param_tmp_79428") != 0)
            return 1;
        loop_while_68019 = loop_while_tmp_79429;
        p_68023 = p_tmp_79433;
    }
    if (memblock_set_device(ctx, &ext_mem_78197, &mem_param_78166, "mem_param_78166") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78196, &mem_param_78169, "mem_param_78169") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78195, &mem_param_78172, "mem_param_78172") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_68014 = loop_while_68019;
    joinTups_to_joinPairs_InnerJoin_res_68018 = p_68023;
    if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78199, bytes_78133, "mem_78199")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_78199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78197.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78201, bytes_78135, "mem_78201")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78201.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78203, bytes_78135, "mem_78203")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_78201, "mem_78201") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78701, &mem_78203, "mem_78203") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78702, &mem_78199, "mem_78199") != 0)
        return 1;
    prim_out_78703 = n_pairs_67906;
    if (memblock_set_device(ctx, &*mem_out_p_79561, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79562, &mem_out_78701, "mem_out_78701") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79563, &mem_out_78702, "mem_out_78702") != 0)
        return 1;
    *out_prim_out_79564 = prim_out_78703;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_78203, "mem_78203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78201, "mem_78201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78199, "mem_78199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79428, "mem_param_tmp_79428") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79427, "mem_param_tmp_79427") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79426, "mem_param_tmp_79426") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78178, "mem_78178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78172, "mem_param_78172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78169, "mem_param_78169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78166, "mem_param_78166") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78124, "mem_78124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78125, "mem_78125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78121, "mem_78121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78122, "mem_78122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79229, "incprefixes_mem_79229") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79227, "aggregates_mem_79227") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79225, "incprefixes_mem_79225") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79223, "aggregates_mem_79223") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79221, "status_flags_mem_79221") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79108, "incprefixes_mem_79108") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79106, "aggregates_mem_79106") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79084, "status_flags_mem_79084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78083, "mem_78083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78080, "mem_78080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77888, "mem_77888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77886, "mem_77886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77872, "mem_77872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77869, "mem_77869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77848, "mem_77848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77846, "mem_77846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77781, "mem_77781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77779, "mem_77779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77842, "mem_77842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77840, "mem_77840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77851, "ext_mem_77851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77854, "ext_mem_77854") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77857, "ext_mem_77857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77860, "ext_mem_77860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77710, "mem_param_77710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77707, "mem_param_77707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77702, "mem_77702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77703, "mem_77703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77699, "mem_77699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77700, "mem_77700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77698, "mem_param_77698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77695, "mem_param_77695") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77891, "ext_mem_77891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77894, "ext_mem_77894") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77897, "ext_mem_77897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77900, "ext_mem_77900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77688, "mem_param_77688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77685, "mem_param_77685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77905, "ext_mem_77905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77906, "ext_mem_77906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77667, "mem_77667") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77669, "mem_77669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77651, "mem_77651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77652, "mem_77652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77647, "mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77648, "mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78053, "mem_78053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78051, "mem_78051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77986, "mem_77986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77984, "mem_77984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78047, "mem_78047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78045, "mem_78045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78056, "ext_mem_78056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78059, "ext_mem_78059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78062, "ext_mem_78062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78065, "ext_mem_78065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77915, "mem_param_77915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77912, "mem_param_77912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78070, "ext_mem_78070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78071, "ext_mem_78071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77907, "mem_77907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77908, "mem_77908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77640, "mem_param_77640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77632, "mem_77632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77633, "mem_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78702, "mem_out_78702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78701, "mem_out_78701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_79582, struct memblock_device *mem_out_p_79583, struct memblock_device *mem_out_p_79584, int64_t *out_prim_out_79585, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_49324, int64_t nS_49325, int64_t offset_R_49328, int64_t offset_S_49329, int64_t partitionsPerWindow_49330, int64_t numberOfWindows_49331, int64_t extParallelism_49332, int64_t scatter_psizze_49333)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_78203;
    
    mem_78203.references = NULL;
    
    struct memblock_device mem_78201;
    
    mem_78201.references = NULL;
    
    struct memblock_device mem_78199;
    
    mem_78199.references = NULL;
    
    struct memblock_device mem_param_tmp_79428;
    
    mem_param_tmp_79428.references = NULL;
    
    struct memblock_device mem_param_tmp_79427;
    
    mem_param_tmp_79427.references = NULL;
    
    struct memblock_device mem_param_tmp_79426;
    
    mem_param_tmp_79426.references = NULL;
    
    struct memblock_device mem_78185;
    
    mem_78185.references = NULL;
    
    struct memblock_device mem_78183;
    
    mem_78183.references = NULL;
    
    struct memblock_device mem_78178;
    
    mem_78178.references = NULL;
    
    struct memblock_device mem_78176;
    
    mem_78176.references = NULL;
    
    struct memblock_device mem_78174;
    
    mem_78174.references = NULL;
    
    struct memblock_device mem_param_78172;
    
    mem_param_78172.references = NULL;
    
    struct memblock_device mem_param_78169;
    
    mem_param_78169.references = NULL;
    
    struct memblock_device mem_param_78166;
    
    mem_param_78166.references = NULL;
    
    struct memblock_device ext_mem_78195;
    
    ext_mem_78195.references = NULL;
    
    struct memblock_device ext_mem_78196;
    
    ext_mem_78196.references = NULL;
    
    struct memblock_device ext_mem_78197;
    
    ext_mem_78197.references = NULL;
    
    struct memblock_device mem_78181;
    
    mem_78181.references = NULL;
    
    struct memblock_device mem_78180;
    
    mem_78180.references = NULL;
    
    struct memblock_device mem_78179;
    
    mem_78179.references = NULL;
    
    struct memblock_device mem_78153;
    
    mem_78153.references = NULL;
    
    struct memblock_device mem_78151;
    
    mem_78151.references = NULL;
    
    struct memblock_device mem_78149;
    
    mem_78149.references = NULL;
    
    struct memblock_device mem_78138;
    
    mem_78138.references = NULL;
    
    struct memblock_device mem_78136;
    
    mem_78136.references = NULL;
    
    struct memblock_device mem_78134;
    
    mem_78134.references = NULL;
    
    struct memblock_device mem_78130;
    
    mem_78130.references = NULL;
    
    struct memblock_device mem_78128;
    
    mem_78128.references = NULL;
    
    struct memblock_device mem_78132;
    
    mem_78132.references = NULL;
    
    struct memblock_device mem_78124;
    
    mem_78124.references = NULL;
    
    struct memblock_device mem_78125;
    
    mem_78125.references = NULL;
    
    struct memblock_device ext_mem_78126;
    
    ext_mem_78126.references = NULL;
    
    struct memblock_device mem_78121;
    
    mem_78121.references = NULL;
    
    struct memblock_device mem_78122;
    
    mem_78122.references = NULL;
    
    struct memblock_device ext_mem_78123;
    
    ext_mem_78123.references = NULL;
    
    struct memblock_device mem_78120;
    
    mem_78120.references = NULL;
    
    struct memblock_device incprefixes_mem_79229;
    
    incprefixes_mem_79229.references = NULL;
    
    struct memblock_device aggregates_mem_79227;
    
    aggregates_mem_79227.references = NULL;
    
    struct memblock_device incprefixes_mem_79225;
    
    incprefixes_mem_79225.references = NULL;
    
    struct memblock_device aggregates_mem_79223;
    
    aggregates_mem_79223.references = NULL;
    
    struct memblock_device status_flags_mem_79221;
    
    status_flags_mem_79221.references = NULL;
    
    struct memblock_device mem_78117;
    
    mem_78117.references = NULL;
    
    struct memblock_device mem_78115;
    
    mem_78115.references = NULL;
    
    struct memblock_device mem_78113;
    
    mem_78113.references = NULL;
    
    struct memblock_device mem_78109;
    
    mem_78109.references = NULL;
    
    struct memblock_device mem_78107;
    
    mem_78107.references = NULL;
    
    struct memblock_device mem_78105;
    
    mem_78105.references = NULL;
    
    struct memblock_device mem_78103;
    
    mem_78103.references = NULL;
    
    struct memblock_device incprefixes_mem_79088;
    
    incprefixes_mem_79088.references = NULL;
    
    struct memblock_device aggregates_mem_79086;
    
    aggregates_mem_79086.references = NULL;
    
    struct memblock_device status_flags_mem_79064;
    
    status_flags_mem_79064.references = NULL;
    
    struct memblock_device mem_78101;
    
    mem_78101.references = NULL;
    
    struct memblock_device mem_78099;
    
    mem_78099.references = NULL;
    
    struct memblock_device mem_param_tmp_78731;
    
    mem_param_tmp_78731.references = NULL;
    
    struct memblock_device mem_param_tmp_78730;
    
    mem_param_tmp_78730.references = NULL;
    
    struct memblock_device mem_78084;
    
    mem_78084.references = NULL;
    
    struct memblock_device mem_78083;
    
    mem_78083.references = NULL;
    
    struct memblock_device mem_78080;
    
    mem_78080.references = NULL;
    
    struct memblock_device mem_param_tmp_78888;
    
    mem_param_tmp_78888.references = NULL;
    
    struct memblock_device mem_param_tmp_78887;
    
    mem_param_tmp_78887.references = NULL;
    
    struct memblock_device mem_77888;
    
    mem_77888.references = NULL;
    
    struct memblock_device mem_77886;
    
    mem_77886.references = NULL;
    
    struct memblock_device mem_77884;
    
    mem_77884.references = NULL;
    
    struct memblock_device mem_77881;
    
    mem_77881.references = NULL;
    
    struct memblock_device mem_param_tmp_78898;
    
    mem_param_tmp_78898.references = NULL;
    
    struct memblock_device mem_param_tmp_78897;
    
    mem_param_tmp_78897.references = NULL;
    
    struct memblock_device mem_77872;
    
    mem_77872.references = NULL;
    
    struct memblock_device mem_77869;
    
    mem_77869.references = NULL;
    
    struct memblock_device mem_param_tmp_78916;
    
    mem_param_tmp_78916.references = NULL;
    
    struct memblock_device mem_param_tmp_78915;
    
    mem_param_tmp_78915.references = NULL;
    
    struct memblock_device mem_77848;
    
    mem_77848.references = NULL;
    
    struct memblock_device mem_77846;
    
    mem_77846.references = NULL;
    
    struct memblock_device mem_77781;
    
    mem_77781.references = NULL;
    
    struct memblock_device mem_77779;
    
    mem_77779.references = NULL;
    
    struct memblock_device mem_77842;
    
    mem_77842.references = NULL;
    
    struct memblock_device mem_77840;
    
    mem_77840.references = NULL;
    
    struct memblock_device ext_mem_77843;
    
    ext_mem_77843.references = NULL;
    
    struct memblock_device ext_mem_77844;
    
    ext_mem_77844.references = NULL;
    
    struct memblock_device ext_mem_77720;
    
    ext_mem_77720.references = NULL;
    
    struct memblock_device mem_77718;
    
    mem_77718.references = NULL;
    
    struct memblock_device ext_mem_77851;
    
    ext_mem_77851.references = NULL;
    
    struct memblock_device ext_mem_77854;
    
    ext_mem_77854.references = NULL;
    
    struct memblock_device mem_77716;
    
    mem_77716.references = NULL;
    
    struct memblock_device ext_mem_77857;
    
    ext_mem_77857.references = NULL;
    
    struct memblock_device ext_mem_77860;
    
    ext_mem_77860.references = NULL;
    
    struct memblock_device ext_mem_77714;
    
    ext_mem_77714.references = NULL;
    
    struct memblock_device ext_mem_77713;
    
    ext_mem_77713.references = NULL;
    
    struct memblock_device mem_param_77710;
    
    mem_param_77710.references = NULL;
    
    struct memblock_device mem_param_77707;
    
    mem_param_77707.references = NULL;
    
    struct memblock_device ext_mem_77865;
    
    ext_mem_77865.references = NULL;
    
    struct memblock_device ext_mem_77866;
    
    ext_mem_77866.references = NULL;
    
    struct memblock_device mem_77702;
    
    mem_77702.references = NULL;
    
    struct memblock_device mem_77703;
    
    mem_77703.references = NULL;
    
    struct memblock_device ext_mem_77704;
    
    ext_mem_77704.references = NULL;
    
    struct memblock_device mem_77699;
    
    mem_77699.references = NULL;
    
    struct memblock_device mem_77700;
    
    mem_77700.references = NULL;
    
    struct memblock_device ext_mem_77701;
    
    ext_mem_77701.references = NULL;
    
    struct memblock_device mem_param_77698;
    
    mem_param_77698.references = NULL;
    
    struct memblock_device mem_param_77695;
    
    mem_param_77695.references = NULL;
    
    struct memblock_device ext_mem_77877;
    
    ext_mem_77877.references = NULL;
    
    struct memblock_device ext_mem_77878;
    
    ext_mem_77878.references = NULL;
    
    struct memblock_device mem_77715;
    
    mem_77715.references = NULL;
    
    struct memblock_device mem_77712;
    
    mem_77712.references = NULL;
    
    struct memblock_device mem_77711;
    
    mem_77711.references = NULL;
    
    struct memblock_device mem_77692;
    
    mem_77692.references = NULL;
    
    struct memblock_device mem_77690;
    
    mem_77690.references = NULL;
    
    struct memblock_device ext_mem_77891;
    
    ext_mem_77891.references = NULL;
    
    struct memblock_device ext_mem_77894;
    
    ext_mem_77894.references = NULL;
    
    struct memblock_device ext_mem_77897;
    
    ext_mem_77897.references = NULL;
    
    struct memblock_device ext_mem_77900;
    
    ext_mem_77900.references = NULL;
    
    struct memblock_device mem_param_77688;
    
    mem_param_77688.references = NULL;
    
    struct memblock_device mem_param_77685;
    
    mem_param_77685.references = NULL;
    
    struct memblock_device ext_mem_77905;
    
    ext_mem_77905.references = NULL;
    
    struct memblock_device ext_mem_77906;
    
    ext_mem_77906.references = NULL;
    
    struct memblock_device mem_77682;
    
    mem_77682.references = NULL;
    
    struct memblock_device mem_77680;
    
    mem_77680.references = NULL;
    
    struct memblock_device mem_77667;
    
    mem_77667.references = NULL;
    
    struct memblock_device mem_77669;
    
    mem_77669.references = NULL;
    
    struct memblock_device ext_mem_77670;
    
    ext_mem_77670.references = NULL;
    
    struct memblock_device ext_mem_77671;
    
    ext_mem_77671.references = NULL;
    
    struct memblock_device mem_77664;
    
    mem_77664.references = NULL;
    
    struct memblock_device mem_77662;
    
    mem_77662.references = NULL;
    
    struct memblock_device mem_77651;
    
    mem_77651.references = NULL;
    
    struct memblock_device mem_77652;
    
    mem_77652.references = NULL;
    
    struct memblock_device ext_mem_77653;
    
    ext_mem_77653.references = NULL;
    
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_77647;
    
    mem_77647.references = NULL;
    
    struct memblock_device mem_77648;
    
    mem_77648.references = NULL;
    
    struct memblock_device ext_mem_77649;
    
    ext_mem_77649.references = NULL;
    
    struct memblock_device mem_77646;
    
    mem_77646.references = NULL;
    
    struct memblock_device mem_77644;
    
    mem_77644.references = NULL;
    
    struct memblock_device mem_param_tmp_78749;
    
    mem_param_tmp_78749.references = NULL;
    
    struct memblock_device mem_param_tmp_78748;
    
    mem_param_tmp_78748.references = NULL;
    
    struct memblock_device mem_78053;
    
    mem_78053.references = NULL;
    
    struct memblock_device mem_78051;
    
    mem_78051.references = NULL;
    
    struct memblock_device mem_77986;
    
    mem_77986.references = NULL;
    
    struct memblock_device mem_77984;
    
    mem_77984.references = NULL;
    
    struct memblock_device mem_78047;
    
    mem_78047.references = NULL;
    
    struct memblock_device mem_78045;
    
    mem_78045.references = NULL;
    
    struct memblock_device ext_mem_78048;
    
    ext_mem_78048.references = NULL;
    
    struct memblock_device ext_mem_78049;
    
    ext_mem_78049.references = NULL;
    
    struct memblock_device ext_mem_77925;
    
    ext_mem_77925.references = NULL;
    
    struct memblock_device mem_77923;
    
    mem_77923.references = NULL;
    
    struct memblock_device ext_mem_78056;
    
    ext_mem_78056.references = NULL;
    
    struct memblock_device ext_mem_78059;
    
    ext_mem_78059.references = NULL;
    
    struct memblock_device mem_77921;
    
    mem_77921.references = NULL;
    
    struct memblock_device ext_mem_78062;
    
    ext_mem_78062.references = NULL;
    
    struct memblock_device ext_mem_78065;
    
    ext_mem_78065.references = NULL;
    
    struct memblock_device ext_mem_77919;
    
    ext_mem_77919.references = NULL;
    
    struct memblock_device ext_mem_77918;
    
    ext_mem_77918.references = NULL;
    
    struct memblock_device mem_param_77915;
    
    mem_param_77915.references = NULL;
    
    struct memblock_device mem_param_77912;
    
    mem_param_77912.references = NULL;
    
    struct memblock_device ext_mem_78070;
    
    ext_mem_78070.references = NULL;
    
    struct memblock_device ext_mem_78071;
    
    ext_mem_78071.references = NULL;
    
    struct memblock_device mem_77920;
    
    mem_77920.references = NULL;
    
    struct memblock_device mem_77917;
    
    mem_77917.references = NULL;
    
    struct memblock_device mem_77916;
    
    mem_77916.references = NULL;
    
    struct memblock_device mem_77907;
    
    mem_77907.references = NULL;
    
    struct memblock_device mem_77908;
    
    mem_77908.references = NULL;
    
    struct memblock_device ext_mem_77909;
    
    ext_mem_77909.references = NULL;
    
    struct memblock_device ext_mem_78074;
    
    ext_mem_78074.references = NULL;
    
    struct memblock_device ext_mem_78077;
    
    ext_mem_78077.references = NULL;
    
    struct memblock_device ext_mem_78087;
    
    ext_mem_78087.references = NULL;
    
    struct memblock_device ext_mem_78090;
    
    ext_mem_78090.references = NULL;
    
    struct memblock_device mem_param_77640;
    
    mem_param_77640.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device ext_mem_78095;
    
    ext_mem_78095.references = NULL;
    
    struct memblock_device ext_mem_78096;
    
    ext_mem_78096.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77632;
    
    mem_77632.references = NULL;
    
    struct memblock_device mem_77633;
    
    mem_77633.references = NULL;
    
    struct memblock_device ext_mem_77634;
    
    ext_mem_77634.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device ext_mem_77627;
    
    ext_mem_77627.references = NULL;
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78703;
    int64_t zm_lhs_66970 = add64(nR_49324, nS_49325);
    int64_t zs_lhs_66971 = sub64(zm_lhs_66970, (int64_t) 1);
    bool zzero_66972 = nR_49324 == (int64_t) 0;
    bool nonzzero_66973 = !zzero_66972;
    bool nonzzero_cert_66974;
    
    if (!nonzzero_66973) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:232:26-29\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_66975 = sdiv64(zs_lhs_66971, nR_49324);
    
    if (futrts_indicesWithIncrement_9850(ctx, &ext_mem_77627, tR_mem_77625, nR_49324, offset_R_49328) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_77628 = (int64_t) 8 * nR_49324;
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77629, nR_49324, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, nR_49324, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_66980 = slt64((int64_t) 0, numIter_66975);
    int64_t gt_rhs_66981 = sub64(nR_49324, (int64_t) 1);
    bool x_66982 = sle64((int64_t) 0, gt_rhs_66981);
    bool y_66983 = slt64(gt_rhs_66981, nR_49324);
    bool bounds_check_66984 = x_66982 && y_66983;
    bool loop_not_taken_66985 = !loop_cond_66980;
    bool protect_assert_disj_66986 = bounds_check_66984 || loop_not_taken_66985;
    bool index_certs_66987;
    
    if (!protect_assert_disj_66986) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftSMJ.fut:239:25-33\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_66980) {
        if (memblock_alloc_device(ctx, &mem_77633, (int64_t) 8, "mem_77633")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_78724(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, tR_mem_77625.mem, mem_77633.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77633, "mem_77633") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_77632, (int64_t) 8, "mem_77632")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_77632, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77632, "mem_77632") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_77641, (int64_t) 8, "mem_77641")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77642, (int64_t) 1, "mem_77642")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_66990;
    int64_t defunc_0_mergeJoin_res_66991;
    bool loop_while_66994;
    int64_t p_66995;
    
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77640, &mem_77629, "mem_77629") != 0)
        return 1;
    loop_while_66994 = loop_cond_66980;
    p_66995 = (int64_t) 0;
    while (loop_while_66994) {
        int64_t tS_start_66998 = mul64(nR_49324, p_66995);
        int64_t min_arg1_66999 = add64(nR_49324, tS_start_66998);
        int64_t min_res_67000 = smin64(nS_49325, min_arg1_66999);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 = sub64(min_res_67000, tS_start_66998);
        bool empty_slice_67002 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 == (int64_t) 0;
        int64_t m_67003 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, (int64_t) 1);
        int64_t i_p_m_t_s_67004 = add64(tS_start_66998, m_67003);
        bool zzero_leq_i_p_m_t_s_67005 = sle64((int64_t) 0, i_p_m_t_s_67004);
        bool i_p_m_t_s_leq_w_67006 = slt64(i_p_m_t_s_67004, nS_49325);
        bool zzero_lte_i_67007 = sle64((int64_t) 0, tS_start_66998);
        bool i_lte_j_67008 = sle64(tS_start_66998, min_res_67000);
        bool y_67009 = i_p_m_t_s_leq_w_67006 && zzero_lte_i_67007;
        bool y_67010 = zzero_leq_i_p_m_t_s_67005 && y_67009;
        bool forwards_ok_67011 = i_lte_j_67008 && y_67010;
        bool ok_or_empty_67012 = empty_slice_67002 || forwards_ok_67011;
        bool index_certs_67013;
        
        if (!ok_or_empty_67012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_66998, ":", (long long) min_res_67000, "] out of bounds for array of shape [", (long long) nS_49325, "].", "-> #0  ftSMJ.fut:238:16-35\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_67015 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
        bool index_certs_67016;
        
        if (!y_67015) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:239:12-19\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_78736(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_66998, tS_mem_77626.mem, ext_mem_77634.mem, mem_77641.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_79586;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79586, mem_77642.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_67018 = read_res_79586;
        int64_t loopres_67019;
        
        if (defunc_0_gt_res_67018) {
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_param_77637, "mem_param_77637") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_param_77640, "mem_param_77640") != 0)
                return 1;
            loopres_67019 = numIter_66975;
        } else {
            bool cond_67022 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, nR_49324);
            bool dim_match_67136 = nR_49324 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            bool protect_assert_disj_78305 = cond_67022 || dim_match_67136;
            bool empty_or_match_cert_67137;
            
            if (!protect_assert_disj_78305) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "] cannot match shape of type `[", (long long) nR_49324, "]i64`.", "-> #0  ftSMJ.fut:247:18-31\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_67143 = slt64((int64_t) 0, numberOfWindows_49331);
            bool y_67146 = slt64((int64_t) 0, nR_49324);
            bool loop_not_taken_67147 = !loop_cond_67143;
            bool protect_assert_disj_67148 = y_67146 || loop_not_taken_67147;
            bool protect_assert_disj_78307 = cond_67022 || protect_assert_disj_67148;
            bool index_certs_67149;
            
            if (!protect_assert_disj_78307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftsort.fut:285:20-25\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_68532 = add64(nR_49324, extParallelism_49332);
            int64_t zs_lhs_68533 = sub64(zm_lhs_68532, (int64_t) 1);
            bool zzero_68534 = extParallelism_49332 == (int64_t) 0;
            bool nonzzero_68535 = !zzero_68534;
            bool loop_not_taken_78248 = !cond_67022;
            bool protect_assert_disj_78249 = nonzzero_68535 || loop_not_taken_78248;
            bool nonzzero_cert_68536;
            
            if (!protect_assert_disj_78249) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_68537 = sdiv_safe64(zs_lhs_68533, extParallelism_49332);
            bool loop_cond_68538 = slt64((int64_t) 0, numIter_68537);
            bool loop_not_taken_68539 = !y_67015;
            bool loop_not_taken_68540 = !loop_cond_68538;
            bool x_68541 = sle64((int64_t) 0, m_67003);
            bool y_68542 = slt64(m_67003, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
            bool bounds_check_68544 = x_68541 && y_68542;
            bool protect_assert_disj_68545 = loop_not_taken_68539 || bounds_check_68544;
            bool protect_assert_disj_68546 = loop_not_taken_68540 || protect_assert_disj_68545;
            bool protect_assert_disj_78251 = protect_assert_disj_68546 || loop_not_taken_78248;
            bool index_certs_68547;
            
            if (!protect_assert_disj_78251) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67817;
            
            if (!bounds_check_68544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:258:23-44\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67819;
            
            if (!bounds_check_66984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftSMJ.fut:258:51-59\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 = mul64(partitionsPerWindow_49330, numberOfWindows_49331);
            int64_t join_chunks_arg3_67139 = add64(offset_S_49329, tS_start_66998);
            int64_t bytes_77643 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
            bool empty_slice_67144 = partitionsPerWindow_49330 == (int64_t) 0;
            int64_t m_67145 = sub64(partitionsPerWindow_49330, (int64_t) 1);
            int64_t segmap_tblock_sizze_72498;
            
            segmap_tblock_sizze_72498 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72291;
            
            int64_t zeze_rhs_67414 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, (int64_t) 1);
            int64_t segmap_tblock_sizze_72872;
            
            segmap_tblock_sizze_72872 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72708;
            
            int64_t segmap_usable_groups_72873 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_72872);
            bool loop_cond_67569 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
            bool protect_cond_conj_68543 = y_67015 && loop_cond_68538;
            int64_t bytes_77922 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            int64_t ext_78076;
            int64_t ext_78075;
            int64_t ext_78073;
            int64_t ext_78072;
            
            if (cond_67022) {
                if (protect_cond_conj_68543) {
                    if (memblock_alloc_device(ctx, &mem_77908, (int64_t) 8, "mem_77908")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_78742(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_67004, tS_mem_77626.mem, mem_77908.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77908, "mem_77908") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77907, (int64_t) 8, "mem_77907")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_77907, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77907, "mem_77907") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77916, (int64_t) 8, "mem_77916")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77917, (int64_t) 8, "mem_77917")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77920, (int64_t) 1, "mem_77920")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_78069;
                int64_t ext_78068;
                int64_t ext_78067;
                int64_t ext_78066;
                bool defunc_0_find_joinTuples_res_68550;
                int64_t defunc_0_find_joinTuples_res_68551;
                bool loop_while_68554;
                int64_t p_68555;
                int64_t ctx_param_ext_77910;
                int64_t ctx_param_ext_77911;
                int64_t ctx_param_ext_77913;
                int64_t ctx_param_ext_77914;
                
                if (memblock_set_device(ctx, &mem_param_77912, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77915, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77910 = (int64_t) 0;
                ctx_param_ext_77911 = (int64_t) 1;
                ctx_param_ext_77913 = (int64_t) 0;
                ctx_param_ext_77914 = (int64_t) 1;
                loop_while_68554 = loop_cond_68538;
                p_68555 = (int64_t) 0;
                while (loop_while_68554) {
                    int64_t start_68558 = mul64(extParallelism_49332, p_68555);
                    int64_t min_arg1_68559 = sub64(nR_49324, start_68558);
                    int64_t min_res_68560 = smin64(extParallelism_49332, min_arg1_68559);
                    int64_t iter_R_68561 = add64(start_68558, min_res_68560);
                    bool empty_slice_68562 = min_res_68560 == (int64_t) 0;
                    int64_t m_68563 = sub64(min_res_68560, (int64_t) 1);
                    int64_t i_p_m_t_s_68564 = add64(start_68558, m_68563);
                    bool zzero_leq_i_p_m_t_s_68565 = sle64((int64_t) 0, i_p_m_t_s_68564);
                    bool i_p_m_t_s_leq_w_68566 = slt64(i_p_m_t_s_68564, nR_49324);
                    bool zzero_lte_i_68567 = sle64((int64_t) 0, start_68558);
                    bool i_lte_j_68568 = sle64(start_68558, iter_R_68561);
                    bool y_68569 = i_p_m_t_s_leq_w_68566 && zzero_lte_i_68567;
                    bool y_68570 = zzero_leq_i_p_m_t_s_68565 && y_68569;
                    bool forwards_ok_68571 = i_lte_j_68568 && y_68570;
                    bool ok_or_empty_68572 = empty_slice_68562 || forwards_ok_68571;
                    bool index_certs_68573;
                    
                    if (!ok_or_empty_68572) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_68558, ":", (long long) iter_R_68561, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68574 = slt64(m_68563, min_res_68560);
                    bool x_68575 = sle64((int64_t) 0, m_68563);
                    bool bounds_check_68576 = y_68574 && x_68575;
                    bool index_certs_68577;
                    
                    if (!bounds_check_68576) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_68563, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68580 = slt64((int64_t) 0, min_res_68560);
                    bool index_certs_68581;
                    
                    if (!y_68580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_78758(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_68558, i_p_m_t_s_68564, tR_mem_77625.mem, mem_77916.mem, mem_77917.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77918, &ext_mem_77909, "ext_mem_77909") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77918, &mem_77916, "mem_77916") != 0)
                        return 1;
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77919, &mem_77641, "mem_77641") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77919, &mem_77917, "mem_77917") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_78764(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77917.mem, ext_mem_77918.mem, mem_77920.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
                        return 1;
                    
                    bool read_res_79587;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79587, mem_77920.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_68583 = read_res_79587;
                    int64_t ext_78064;
                    int64_t ext_78063;
                    int64_t ext_78061;
                    int64_t ext_78060;
                    int64_t loopres_68585;
                    
                    if (defunc_0_gt_res_68583) {
                        if (memblock_set_device(ctx, &ext_mem_78065, &mem_param_77912, "mem_param_77912") != 0)
                            return 1;
                        ext_78064 = ctx_param_ext_77910;
                        ext_78063 = ctx_param_ext_77911;
                        if (memblock_set_device(ctx, &ext_mem_78062, &mem_param_77915, "mem_param_77915") != 0)
                            return 1;
                        ext_78061 = ctx_param_ext_77913;
                        ext_78060 = ctx_param_ext_77914;
                        loopres_68585 = numIter_68537;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77921, (int64_t) 1, "mem_77921")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_longzigpuseq_78770(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77916.mem, ext_mem_77919.mem, mem_77921.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_79588;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79588, mem_77921.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_68589 = read_res_79588;
                        
                        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
                            return 1;
                        
                        int64_t ext_78058;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78058 = ctx_param_ext_77910;
                        } else {
                            ext_78058 = (int64_t) 0;
                        }
                        
                        int64_t ext_78057;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78057 = ctx_param_ext_77911;
                        } else {
                            ext_78057 = (int64_t) 1;
                        }
                        
                        int64_t ext_78055;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78055 = ctx_param_ext_77913;
                        } else {
                            ext_78055 = (int64_t) 0;
                        }
                        
                        int64_t ext_78054;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78054 = ctx_param_ext_77914;
                        } else {
                            ext_78054 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_68590;
                        
                        if (defunc_0_gt_res_68589) {
                            int64_t tmp_68594 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_param_77912, "mem_param_77912") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_param_77915, "mem_param_77915") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68594;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_77923, bytes_77922, "mem_77923")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, tS_start_66998, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_9850(ctx, &ext_mem_77925, mem_77923, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, join_chunks_arg3_67139) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
                                return 1;
                            
                            bool suff_outer_par_72113;
                            
                            suff_outer_par_72113 = *ctx->tuning_params.inner_SMJ_longzisuff_outer_par_0 <= min_res_68560;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_long.suff_outer_par_0", (long) min_res_68560, suff_outer_par_72113 ? "true" : "false");
                            
                            int64_t tile_sizze_76414;
                            
                            tile_sizze_76414 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76413;
                            
                            int64_t tile_sizze_76059;
                            
                            tile_sizze_76059 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76058;
                            
                            int64_t num_whole_tiles_76430 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            int64_t residual_input_76654 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            bool cond_76655 = residual_input_76654 == (int64_t) 0;
                            int64_t binop_x_76671 = tile_sizze_76414 * num_whole_tiles_76430;
                            int64_t bytes_77983 = (int64_t) 8 * min_res_68560;
                            int64_t bytes_77946 = (int64_t) 8 * tile_sizze_76414;
                            int64_t num_whole_tiles_76075 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            int64_t residual_input_76299 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            bool cond_76300 = residual_input_76299 == (int64_t) 0;
                            int64_t binop_x_76316 = tile_sizze_76059 * num_whole_tiles_76075;
                            int64_t bytes_78007 = (int64_t) 8 * tile_sizze_76059;
                            int64_t shared_memory_capacity_78828;
                            
                            shared_memory_capacity_78828 = ctx->max_shared_memory;
                            if (suff_outer_par_72113 && sle64(sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78828)) {
                                int64_t ldim_76060 = sdiv_up64(min_res_68560, tile_sizze_76059);
                                
                                if (memblock_alloc_device(ctx, &mem_78045, bytes_77983, "mem_78045")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_78047, bytes_77983, "mem_78047")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78776 = sext_i64_i32(sdiv_up64(tile_sizze_76059, tile_sizze_76059));
                                int32_t virt_num_tblocks_78777 = sext_i64_i32(ldim_76060);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_76057(ctx, ldim_76060, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_76058, 1, 1, bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76060, num_whole_tiles_76075, residual_input_76299, cond_76300, binop_x_76316, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_78045.mem, mem_78047.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_78045, "mem_78045") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_78047, "mem_78047") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_76415 = sdiv_up64(min_res_68560, tile_sizze_76414);
                                
                                if (memblock_alloc_device(ctx, &mem_77984, bytes_77983, "mem_77984")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_77986, bytes_77983, "mem_77986")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78802 = sext_i64_i32(sdiv_up64(tile_sizze_76414, tile_sizze_76414));
                                int32_t virt_num_tblocks_78803 = sext_i64_i32(ldim_76415);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_76412(ctx, ldim_76415, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_76413, 1, 1, bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76415, num_whole_tiles_76430, residual_input_76654, cond_76655, binop_x_76671, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_77984.mem, mem_77986.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_77984, "mem_77984") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_77986, "mem_77986") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78051, bytes_77628, "mem_78051")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77915.mem, ctx_param_ext_77913, (int64_t []) {ctx_param_ext_77914}, (int64_t []) {nR_49324})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78049.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78053, bytes_77628, "mem_78053")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77912.mem, ctx_param_ext_77910, (int64_t []) {ctx_param_ext_77911}, (int64_t []) {nR_49324})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
                                return 1;
                            
                            int64_t tmp_68646 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_78053, "mem_78053") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_78051, "mem_78051") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68646;
                        }
                        if (memblock_set_device(ctx, &ext_mem_78065, &ext_mem_78059, "ext_mem_78059") != 0)
                            return 1;
                        ext_78064 = ext_78058;
                        ext_78063 = ext_78057;
                        if (memblock_set_device(ctx, &ext_mem_78062, &ext_mem_78056, "ext_mem_78056") != 0)
                            return 1;
                        ext_78061 = ext_78055;
                        ext_78060 = ext_78054;
                        loopres_68585 = loopres_f_res_68590;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
                        return 1;
                    
                    bool loop_cond_68647 = slt64(loopres_68585, numIter_68537);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78748, &ext_mem_78065, "ext_mem_78065") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78749, &ext_mem_78062, "ext_mem_78062") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78750 = ext_78064;
                    int64_t ctx_param_ext_tmp_78751 = ext_78063;
                    int64_t ctx_param_ext_tmp_78752 = ext_78061;
                    int64_t ctx_param_ext_tmp_78753 = ext_78060;
                    bool loop_while_tmp_78754 = loop_cond_68647;
                    int64_t p_tmp_78755 = loopres_68585;
                    
                    if (memblock_set_device(ctx, &mem_param_77912, &mem_param_tmp_78748, "mem_param_tmp_78748") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77915, &mem_param_tmp_78749, "mem_param_tmp_78749") != 0)
                        return 1;
                    ctx_param_ext_77910 = ctx_param_ext_tmp_78750;
                    ctx_param_ext_77911 = ctx_param_ext_tmp_78751;
                    ctx_param_ext_77913 = ctx_param_ext_tmp_78752;
                    ctx_param_ext_77914 = ctx_param_ext_tmp_78753;
                    loop_while_68554 = loop_while_tmp_78754;
                    p_68555 = p_tmp_78755;
                }
                if (memblock_set_device(ctx, &ext_mem_78071, &mem_param_77912, "mem_param_77912") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78070, &mem_param_77915, "mem_param_77915") != 0)
                    return 1;
                ext_78069 = ctx_param_ext_77910;
                ext_78068 = ctx_param_ext_77911;
                ext_78067 = ctx_param_ext_77913;
                ext_78066 = ctx_param_ext_77914;
                defunc_0_find_joinTuples_res_68550 = loop_while_68554;
                defunc_0_find_joinTuples_res_68551 = p_68555;
                if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_78071, "ext_mem_78071") != 0)
                    return 1;
                ext_78076 = ext_78069;
                ext_78075 = ext_78068;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_78070, "ext_mem_78070") != 0)
                    return 1;
                ext_78073 = ext_78067;
                ext_78072 = ext_78066;
            } else {
                if (memblock_alloc_device(ctx, &mem_77644, bytes_77643, "mem_77644")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77644, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_49324) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77646, bytes_77643, "mem_77646")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77646, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_49324) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77648, (int64_t) 8, "mem_77648")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_78829(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_77625.mem, mem_77648.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77648, "mem_77648") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77647, (int64_t) 8, "mem_77647")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_77647, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77647, "mem_77647") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77650, (int64_t) 1, "mem_77650")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_longzigpuseq_78835(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77641.mem, ext_mem_77649.mem, mem_77650.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
                    return 1;
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77652, (int64_t) 8, "mem_77652")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_78841(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_49324, y_67146, tR_mem_77625.mem, mem_77641.mem, mem_77650.mem, mem_77652.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77652, "mem_77652") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77651, (int64_t) 8, "mem_77651")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_77651, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77651, "mem_77651") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_67161;
                int64_t defunc_0_windowed_partitionFunc_res_67162;
                bool loop_while_67165;
                int64_t p_67166;
                
                loop_while_67165 = loop_cond_67143;
                p_67166 = (int64_t) 0;
                while (loop_while_67165) {
                    int64_t start_67169 = mul64(partitionsPerWindow_49330, p_67166);
                    int64_t end_67170 = add64(partitionsPerWindow_49330, start_67169);
                    int64_t max_res_67171 = smax64((int64_t) 1, start_67169);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172 = sub64(end_67170, max_res_67171);
                    bool bounds_invalid_upwards_67173 = slt64(end_67170, max_res_67171);
                    bool valid_67174 = !bounds_invalid_upwards_67173;
                    bool range_valid_c_67175;
                    
                    if (!valid_67174) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_67171, "..<", (long long) end_67170, " is invalid.", "-> #0  ftsort.fut:288:43-68\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_67178 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 == (int64_t) 0;
                    bool nonzzero_67179 = !zzero_67178;
                    bool nonzzero_cert_67180;
                    
                    if (!nonzzero_67179) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:291:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_77661 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool cond_67381 = slt64((int64_t) 0, start_67169);
                    int64_t conc_tmp_67382 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    int64_t ret_67383;
                    
                    if (cond_67381) {
                        ret_67383 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    } else {
                        ret_67383 = conc_tmp_67382;
                    }
                    
                    bool eq_x_y_67391 = partitionsPerWindow_49330 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool eq_x_zz_67392 = partitionsPerWindow_49330 == conc_tmp_67382;
                    bool p_and_eq_x_y_67393 = cond_67381 && eq_x_y_67391;
                    bool not_p_67394 = !cond_67381;
                    bool p_and_eq_x_y_67395 = eq_x_zz_67392 && not_p_67394;
                    bool dim_match_67396 = p_and_eq_x_y_67393 || p_and_eq_x_y_67395;
                    bool empty_or_match_cert_67397;
                    
                    if (!dim_match_67396) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_67383, "] cannot match shape of type `[", (long long) partitionsPerWindow_49330, "](i64, i64)`.", "-> #0  ftsort.fut:352:5-357:49\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_67399 = add64(m_67145, start_67169);
                    bool zzero_leq_i_p_m_t_s_67400 = sle64((int64_t) 0, i_p_m_t_s_67399);
                    bool i_p_m_t_s_leq_w_67401 = slt64(i_p_m_t_s_67399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool zzero_lte_i_67402 = sle64((int64_t) 0, start_67169);
                    bool i_lte_j_67403 = sle64(start_67169, end_67170);
                    bool y_67404 = i_p_m_t_s_leq_w_67401 && zzero_lte_i_67402;
                    bool y_67405 = zzero_leq_i_p_m_t_s_67400 && y_67404;
                    bool forwards_ok_67406 = i_lte_j_67403 && y_67405;
                    bool ok_or_empty_67407 = empty_slice_67144 || forwards_ok_67406;
                    bool index_certs_67408;
                    
                    if (!ok_or_empty_67407) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67169, ":", (long long) end_67170, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:109:37-74\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_67177 = add64(nR_49324, nR_49324);
                    int64_t segmap_usable_groups_72499 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_72498);
                    
                    if (memblock_alloc_device(ctx, &mem_77662, bytes_77661, "mem_77662")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_77664, bytes_77661, "mem_77664")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_78851 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_72498));
                    
                    {
                        err = gpu_kernel_inner_SMJ_longzisegmap_72503(ctx, segmap_usable_groups_72499, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72291, 1, 1, (int64_t) 0, nR_49324, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, max_res_67171, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, zt_rhs_67177, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77653.mem, mem_77662.mem, mem_77664.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_77666 = (int64_t) 8 * ret_67383;
                    
                    if (cond_67381) {
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77662, "mem_77662") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77664, "mem_77664") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77669, bytes_77666, "mem_77669")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_77669, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_77667, bytes_77666, "mem_77667")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_78872 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78872, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_78872 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78872, (int64_t []) {(int64_t) 1}, mem_77662.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78872 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        
                        int64_t tmp_offs_78873 = (int64_t) 0;
                        
                        if (!(tmp_offs_78873 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78873, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_78873 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78873, (int64_t []) {(int64_t) 1}, mem_77664.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78873 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77667, "mem_77667") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77669, "mem_77669") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
                        return 1;
                    
                    int64_t tmp_67398 = add64((int64_t) 1, p_67166);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77644.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77671.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77646.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77670.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
                        return 1;
                    
                    bool loop_cond_67411 = slt64(tmp_67398, numberOfWindows_49331);
                    bool loop_while_tmp_78847 = loop_cond_67411;
                    int64_t p_tmp_78848 = tmp_67398;
                    
                    loop_while_67165 = loop_while_tmp_78847;
                    p_67166 = p_tmp_78848;
                }
                defunc_0_windowed_partitionFunc_res_67161 = loop_while_67165;
                defunc_0_windowed_partitionFunc_res_67162 = p_67166;
                if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_77680, bytes_77643, "mem_77680")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77682, bytes_77643, "mem_77682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_78874 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_72872));
                
                {
                    err = gpu_kernel_inner_SMJ_longzisegmap_72877(ctx, segmap_usable_groups_72873, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_72708, 1, 1, (int64_t) 0, nR_49324, gt_rhs_66981, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zeze_rhs_67414, tR_mem_77625.mem, tS_mem_77626.mem, mem_77644.mem, mem_77646.mem, mem_77680.mem, mem_77682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_77904;
                int64_t ext_77903;
                int64_t ext_77902;
                int64_t ext_77901;
                bool defunc_0_join_chunks_res_67570;
                int64_t defunc_0_join_chunks_res_67571;
                bool loop_while_67574;
                int64_t p_67575;
                int64_t ctx_param_ext_77683;
                int64_t ctx_param_ext_77684;
                int64_t ctx_param_ext_77686;
                int64_t ctx_param_ext_77687;
                
                if (memblock_set_device(ctx, &mem_param_77685, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77688, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77683 = (int64_t) 0;
                ctx_param_ext_77684 = (int64_t) 1;
                ctx_param_ext_77686 = (int64_t) 0;
                ctx_param_ext_77687 = (int64_t) 1;
                loop_while_67574 = loop_cond_67569;
                p_67575 = (int64_t) 0;
                while (loop_while_67574) {
                    bool x_67578 = sle64((int64_t) 0, p_67575);
                    bool y_67579 = slt64(p_67575, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67580 = x_67578 && y_67579;
                    bool index_certs_67581;
                    
                    if (!bounds_check_67580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:187:22-34\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_79589;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79589, mem_77680.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67582 = read_res_79589;
                    int64_t read_res_79590;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79590, mem_77682.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67583 = read_res_79590;
                    int64_t min_res_67584 = smin64(zeze_rhs_67414, loopres_67583);
                    bool cond_67585 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, loopres_67582);
                    bool cond_67589 = slt64(min_res_67584, (int64_t) 0);
                    bool protect_assert_disj_67591 = bounds_check_67580 || cond_67589;
                    bool protect_assert_disj_78297 = cond_67585 || protect_assert_disj_67591;
                    bool index_certs_67592;
                    
                    if (!protect_assert_disj_78297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:191:19-32\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_67595 = add64((int64_t) 1, p_67575);
                    bool cond_67596 = zeze_lhs_67595 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    bool x_67598 = sle64((int64_t) 0, zeze_lhs_67595);
                    bool y_67599 = slt64(zeze_lhs_67595, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67600 = x_67598 && y_67599;
                    bool protect_assert_disj_67601 = cond_67596 || bounds_check_67600;
                    bool protect_assert_disj_67602 = cond_67589 || protect_assert_disj_67601;
                    bool protect_assert_disj_78300 = cond_67585 || protect_assert_disj_67602;
                    bool index_certs_67603;
                    
                    if (!protect_assert_disj_78300) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67595, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:192:49-64\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_78294 = !cond_67585;
                    bool x_67590 = !cond_67589;
                    bool protect_cond_conj_78298 = x_67590 && x_78294;
                    int64_t loopres_f_res_f_res_67593;
                    
                    if (protect_cond_conj_78298) {
                        int64_t read_res_79591;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79591, mem_77644.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68863 = read_res_79591;
                        
                        loopres_f_res_f_res_67593 = x_68863;
                    } else {
                        loopres_f_res_f_res_67593 = (int64_t) 0;
                    }
                    
                    bool x_67597 = !cond_67596;
                    bool protect_cond_conj_67604 = x_67590 && x_67597;
                    bool protect_cond_conj_78301 = protect_cond_conj_67604 && x_78294;
                    int64_t r_end_f_res_67605;
                    
                    if (protect_cond_conj_78301) {
                        int64_t read_res_79592;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79592, mem_77644.mem, zeze_lhs_67595 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68864 = read_res_79592;
                        
                        r_end_f_res_67605 = x_68864;
                    } else {
                        r_end_f_res_67605 = (int64_t) 0;
                    }
                    
                    int64_t r_end_67607;
                    
                    if (cond_67596) {
                        r_end_67607 = nR_49324;
                    } else {
                        r_end_67607 = r_end_f_res_67605;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 = sub64(r_end_67607, loopres_f_res_f_res_67593);
                    int64_t ext_77893;
                    
                    if (cond_67589) {
                        ext_77893 = ctx_param_ext_77683;
                    } else {
                        ext_77893 = (int64_t) 0;
                    }
                    
                    int64_t ext_77892;
                    
                    if (cond_67589) {
                        ext_77892 = ctx_param_ext_77684;
                    } else {
                        ext_77892 = (int64_t) 1;
                    }
                    
                    int64_t ext_77890;
                    
                    if (cond_67589) {
                        ext_77890 = ctx_param_ext_77686;
                    } else {
                        ext_77890 = (int64_t) 0;
                    }
                    
                    int64_t ext_77889;
                    
                    if (cond_67589) {
                        ext_77889 = ctx_param_ext_77687;
                    } else {
                        ext_77889 = (int64_t) 1;
                    }
                    
                    int64_t bytes_77689 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;
                    int64_t ext_77899;
                    
                    if (cond_67585) {
                        ext_77899 = ctx_param_ext_77683;
                    } else {
                        ext_77899 = ext_77893;
                    }
                    
                    int64_t ext_77898;
                    
                    if (cond_67585) {
                        ext_77898 = ctx_param_ext_77684;
                    } else {
                        ext_77898 = ext_77892;
                    }
                    
                    int64_t ext_77896;
                    
                    if (cond_67585) {
                        ext_77896 = ctx_param_ext_77686;
                    } else {
                        ext_77896 = ext_77890;
                    }
                    
                    int64_t ext_77895;
                    
                    if (cond_67585) {
                        ext_77895 = ctx_param_ext_77687;
                    } else {
                        ext_77895 = ext_77889;
                    }
                    
                    int64_t loopres_67586;
                    
                    if (cond_67585) {
                        loopres_67586 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    } else {
                        loopres_67586 = zeze_lhs_67595;
                    }
                    if (cond_67585) {
                        if (memblock_set_device(ctx, &ext_mem_77900, &mem_param_77685, "mem_param_77685") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &mem_param_77688, "mem_param_77688") != 0)
                            return 1;
                    } else {
                        if (cond_67589) {
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_param_77685, "mem_param_77685") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_param_77688, "mem_param_77688") != 0)
                                return 1;
                        } else {
                            bool empty_slice_67611 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 == (int64_t) 0;
                            int64_t m_67612 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 1);
                            int64_t i_p_m_t_s_67613 = add64(loopres_f_res_f_res_67593, m_67612);
                            bool zzero_leq_i_p_m_t_s_67614 = sle64((int64_t) 0, i_p_m_t_s_67613);
                            bool i_p_m_t_s_leq_w_67615 = slt64(i_p_m_t_s_67613, nR_49324);
                            bool zzero_lte_i_67616 = sle64((int64_t) 0, loopres_f_res_f_res_67593);
                            bool i_lte_j_67617 = sle64(loopres_f_res_f_res_67593, r_end_67607);
                            bool y_67618 = i_p_m_t_s_leq_w_67615 && zzero_lte_i_67616;
                            bool y_67619 = zzero_leq_i_p_m_t_s_67614 && y_67618;
                            bool forwards_ok_67620 = i_lte_j_67617 && y_67619;
                            bool ok_or_empty_67621 = empty_slice_67611 || forwards_ok_67620;
                            bool index_certs_67622;
                            
                            if (!ok_or_empty_67621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_67593, ":", (long long) r_end_67607, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftSMJ.fut:193:16-33\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_67625 = sle64(loopres_67582, min_res_67584);
                            bool loop_not_taken_67630 = !loop_cond_67625;
                            bool protect_assert_disj_67631 = loop_not_taken_67630 || nonzzero_68535;
                            bool nonzzero_cert_67632;
                            
                            if (!protect_assert_disj_67631) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77690, bytes_77689, "mem_77690")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77692, bytes_77689, "mem_77692")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77692, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_67626 = add64(extParallelism_49332, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                            int64_t zs_lhs_67627 = sub64(zm_lhs_67626, (int64_t) 1);
                            int64_t numIter_67633 = sdiv_safe64(zs_lhs_67627, extParallelism_49332);
                            bool loop_cond_67634 = slt64((int64_t) 0, numIter_67633);
                            bool loop_not_taken_67635 = !loop_cond_67634;
                            int64_t segmap_tblock_sizze_73225;
                            
                            segmap_tblock_sizze_73225 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73215;
                            
                            int64_t segmap_usable_groups_73226 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73225);
                            int64_t segmap_tblock_sizze_73246;
                            
                            segmap_tblock_sizze_73246 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73237;
                            
                            int64_t segmap_usable_groups_73247 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73246);
                            
                            if (memblock_alloc_device(ctx, &mem_77711, (int64_t) 8, "mem_77711")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77712, (int64_t) 8, "mem_77712")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77715, (int64_t) 1, "mem_77715")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_67636;
                            int64_t loopres_f_res_f_res_67637;
                            bool loop_while_67640;
                            int64_t dp_67641;
                            
                            if (memblock_set_device(ctx, &mem_param_77695, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_77698, &mem_77690, "mem_77690") != 0)
                                return 1;
                            loop_while_67640 = loop_cond_67625;
                            dp_67641 = loopres_67582;
                            while (loop_while_67640) {
                                bool x_67644 = sle64((int64_t) 0, dp_67641);
                                bool y_67645 = slt64(dp_67641, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67646 = x_67644 && y_67645;
                                bool index_certs_67647;
                                
                                if (!bounds_check_67646) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_67641, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:197:21-38\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_79593;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_79593, mem_77646.mem, dp_67641 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_67648 = read_res_79593;
                                int64_t zeze_lhs_67649 = add64((int64_t) 1, dp_67641);
                                bool cond_67650 = zeze_lhs_67649 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                                bool x_67651 = !cond_67650;
                                bool x_67652 = sle64((int64_t) 0, zeze_lhs_67649);
                                bool y_67653 = slt64(zeze_lhs_67649, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67654 = x_67652 && y_67653;
                                bool protect_assert_disj_67655 = cond_67650 || bounds_check_67654;
                                bool index_certs_67656;
                                
                                if (!protect_assert_disj_67655) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67649, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:198:55-74\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_67657;
                                
                                if (x_67651) {
                                    int64_t read_res_79594;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79594, mem_77646.mem, zeze_lhs_67649 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_68865 = read_res_79594;
                                    
                                    s_end_f_res_67657 = x_68865;
                                } else {
                                    s_end_f_res_67657 = (int64_t) 0;
                                }
                                
                                int64_t s_end_67659;
                                
                                if (cond_67650) {
                                    s_end_67659 = nR_49324;
                                } else {
                                    s_end_67659 = s_end_f_res_67657;
                                }
                                
                                int64_t j_m_i_67660 = sub64(s_end_67659, loopres_67648);
                                bool empty_slice_67661 = j_m_i_67660 == (int64_t) 0;
                                int64_t m_67662 = sub64(j_m_i_67660, (int64_t) 1);
                                int64_t i_p_m_t_s_67663 = add64(loopres_67648, m_67662);
                                bool zzero_leq_i_p_m_t_s_67664 = sle64((int64_t) 0, i_p_m_t_s_67663);
                                bool i_p_m_t_s_leq_w_67665 = slt64(i_p_m_t_s_67663, nR_49324);
                                bool zzero_lte_i_67666 = sle64((int64_t) 0, loopres_67648);
                                bool i_lte_j_67667 = sle64(loopres_67648, s_end_67659);
                                bool y_67668 = i_p_m_t_s_leq_w_67665 && zzero_lte_i_67666;
                                bool y_67669 = zzero_leq_i_p_m_t_s_67664 && y_67668;
                                bool forwards_ok_67670 = i_lte_j_67667 && y_67669;
                                bool ok_or_empty_67671 = empty_slice_67661 || forwards_ok_67670;
                                bool index_certs_67672;
                                
                                if (!ok_or_empty_67671) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_67648, ":", (long long) s_end_67659, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  ftSMJ.fut:199:18-35\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_67675 = slt64((int64_t) 0, j_m_i_67660);
                                bool loop_not_taken_67676 = !cond_67675;
                                bool x_67677 = sle64((int64_t) 0, m_67662);
                                bool y_67678 = slt64(m_67662, j_m_i_67660);
                                bool bounds_check_67682 = x_67677 && y_67678;
                                bool protect_assert_disj_67683 = loop_not_taken_67676 || bounds_check_67682;
                                bool protect_assert_disj_67684 = loop_not_taken_67635 || protect_assert_disj_67683;
                                bool index_certs_67685;
                                
                                if (!protect_assert_disj_67684) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67662, "] out of bounds for array of shape [", (long long) j_m_i_67660, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_68069 = tS_start_66998 + loopres_67648;
                                int64_t find_joinTuples_arg3_67674 = add64(join_chunks_arg3_67139, loopres_67648);
                                bool protect_cond_conj_67679 = loop_cond_67634 && cond_67675;
                                
                                if (protect_cond_conj_67679) {
                                    if (memblock_alloc_device(ctx, &mem_77700, (int64_t) 8, "mem_77700")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_78903(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68069, tS_mem_77626.mem, mem_77700.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77700, "mem_77700") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77699, (int64_t) 8, "mem_77699")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i64(ctx, mem_77699, (int64_t) 1, (int64_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77699, "mem_77699") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_67679) {
                                    int64_t slice_68867 = tS_start_66998 + i_p_m_t_s_67663;
                                    
                                    if (memblock_alloc_device(ctx, &mem_77703, (int64_t) 8, "mem_77703")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_78909(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68867, tS_mem_77626.mem, mem_77703.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77703, "mem_77703") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77702, (int64_t) 8, "mem_77702")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i64(ctx, mem_77702, (int64_t) 1, (int64_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77702, "mem_77702") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_77717 = (int64_t) 8 * j_m_i_67660;
                                int64_t ext_77864;
                                int64_t ext_77863;
                                int64_t ext_77862;
                                int64_t ext_77861;
                                bool defunc_0_find_joinTuples_res_67688;
                                int64_t defunc_0_find_joinTuples_res_67689;
                                bool loop_while_67692;
                                int64_t p_67693;
                                int64_t ctx_param_ext_77705;
                                int64_t ctx_param_ext_77706;
                                int64_t ctx_param_ext_77708;
                                int64_t ctx_param_ext_77709;
                                
                                if (memblock_set_device(ctx, &mem_param_77707, &mem_77692, "mem_77692") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77710, &mem_77690, "mem_77690") != 0)
                                    return 1;
                                ctx_param_ext_77705 = (int64_t) 0;
                                ctx_param_ext_77706 = (int64_t) 1;
                                ctx_param_ext_77708 = (int64_t) 0;
                                ctx_param_ext_77709 = (int64_t) 1;
                                loop_while_67692 = loop_cond_67634;
                                p_67693 = (int64_t) 0;
                                while (loop_while_67692) {
                                    int64_t start_67696 = mul64(extParallelism_49332, p_67693);
                                    int64_t min_arg1_67697 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, start_67696);
                                    int64_t min_res_67698 = smin64(extParallelism_49332, min_arg1_67697);
                                    int64_t iter_R_67699 = add64(start_67696, min_res_67698);
                                    bool empty_slice_67700 = min_res_67698 == (int64_t) 0;
                                    int64_t m_67701 = sub64(min_res_67698, (int64_t) 1);
                                    int64_t i_p_m_t_s_67702 = add64(start_67696, m_67701);
                                    bool zzero_leq_i_p_m_t_s_67703 = sle64((int64_t) 0, i_p_m_t_s_67702);
                                    bool i_p_m_t_s_leq_w_67704 = slt64(i_p_m_t_s_67702, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                                    bool zzero_lte_i_67705 = sle64((int64_t) 0, start_67696);
                                    bool i_lte_j_67706 = sle64(start_67696, iter_R_67699);
                                    bool y_67707 = i_p_m_t_s_leq_w_67704 && zzero_lte_i_67705;
                                    bool y_67708 = zzero_leq_i_p_m_t_s_67703 && y_67707;
                                    bool forwards_ok_67709 = i_lte_j_67706 && y_67708;
                                    bool ok_or_empty_67710 = empty_slice_67700 || forwards_ok_67709;
                                    bool index_certs_67711;
                                    
                                    if (!ok_or_empty_67710) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67696, ":", (long long) iter_R_67699, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67718 = slt64(m_67701, min_res_67698);
                                    bool x_67717 = sle64((int64_t) 0, m_67701);
                                    bool bounds_check_67719 = x_67717 && y_67718;
                                    bool index_certs_67720;
                                    
                                    if (!bounds_check_67719) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67701, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67714 = slt64((int64_t) 0, min_res_67698);
                                    bool index_certs_67715;
                                    
                                    if (!y_67714) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:377:133-136\n   #2  ftSMJ.fut:366:1-377:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_67712 = loopres_f_res_f_res_67593 + start_67696;
                                    int64_t slice_67721 = loopres_f_res_f_res_67593 + i_p_m_t_s_67702;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_78925(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_67712, slice_67721, tR_mem_77625.mem, mem_77711.mem, mem_77712.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77713, &ext_mem_77704, "ext_mem_77704") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77713, &mem_77711, "mem_77711") != 0)
                                        return 1;
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77714, &ext_mem_77701, "ext_mem_77701") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77714, &mem_77712, "mem_77712") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_78931(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77712.mem, ext_mem_77713.mem, mem_77715.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
                                        return 1;
                                    
                                    bool read_res_79595;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79595, mem_77715.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_67725 = read_res_79595;
                                    int64_t ext_77859;
                                    int64_t ext_77858;
                                    int64_t ext_77856;
                                    int64_t ext_77855;
                                    int64_t loopres_67726;
                                    
                                    if (defunc_0_gt_res_67725) {
                                        if (memblock_set_device(ctx, &ext_mem_77860, &mem_param_77707, "mem_param_77707") != 0)
                                            return 1;
                                        ext_77859 = ctx_param_ext_77705;
                                        ext_77858 = ctx_param_ext_77706;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &mem_param_77710, "mem_param_77710") != 0)
                                            return 1;
                                        ext_77856 = ctx_param_ext_77708;
                                        ext_77855 = ctx_param_ext_77709;
                                        loopres_67726 = numIter_67633;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_77716, (int64_t) 1, "mem_77716")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_longzigpuseq_78937(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77711.mem, ext_mem_77714.mem, mem_77716.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_79596;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_79596, mem_77716.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_67729 = read_res_79596;
                                        
                                        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
                                            return 1;
                                        
                                        int64_t ext_77853;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77853 = ctx_param_ext_77705;
                                        } else {
                                            ext_77853 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77852;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77852 = ctx_param_ext_77706;
                                        } else {
                                            ext_77852 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_77850;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77850 = ctx_param_ext_77708;
                                        } else {
                                            ext_77850 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77849;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77849 = ctx_param_ext_77709;
                                        } else {
                                            ext_77849 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_67730;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            int64_t tmp_68871 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_param_77707, "mem_param_77707") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_param_77710, "mem_param_77710") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_68871;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_77718, bytes_77717, "mem_77718")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77718.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, slice_68069, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67660})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_9850(ctx, &ext_mem_77720, mem_77718, j_m_i_67660, find_joinTuples_arg3_67674) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_73037;
                                            
                                            suff_outer_par_73037 = *ctx->tuning_params.inner_SMJ_longzisuff_outer_par_1 <= min_res_67698;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_long.suff_outer_par_1", (long) min_res_67698, suff_outer_par_73037 ? "true" : "false");
                                            
                                            int64_t tile_sizze_77124;
                                            
                                            tile_sizze_77124 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_77123;
                                            
                                            int64_t tile_sizze_76769;
                                            
                                            tile_sizze_76769 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_76768;
                                            
                                            int64_t num_whole_tiles_77140 = squot_safe64(j_m_i_67660, tile_sizze_77124);
                                            int64_t residual_input_77364 = srem_safe64(j_m_i_67660, tile_sizze_77124);
                                            bool cond_77365 = residual_input_77364 == (int64_t) 0;
                                            int64_t binop_x_77381 = tile_sizze_77124 * num_whole_tiles_77140;
                                            int64_t bytes_77778 = (int64_t) 8 * min_res_67698;
                                            int64_t bytes_77741 = (int64_t) 8 * tile_sizze_77124;
                                            int64_t num_whole_tiles_76785 = squot_safe64(j_m_i_67660, tile_sizze_76769);
                                            int64_t residual_input_77009 = srem_safe64(j_m_i_67660, tile_sizze_76769);
                                            bool cond_77010 = residual_input_77009 == (int64_t) 0;
                                            int64_t binop_x_77026 = tile_sizze_76769 * num_whole_tiles_76785;
                                            int64_t bytes_77802 = (int64_t) 8 * tile_sizze_76769;
                                            int64_t shared_memory_capacity_78995;
                                            
                                            shared_memory_capacity_78995 = ctx->max_shared_memory;
                                            if (suff_outer_par_73037 && sle64(sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78995)) {
                                                int64_t ldim_76770 = sdiv_up64(min_res_67698, tile_sizze_76769);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77840, bytes_77778, "mem_77840")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77842, bytes_77778, "mem_77842")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78943 = sext_i64_i32(sdiv_up64(tile_sizze_76769, tile_sizze_76769));
                                                int32_t virt_num_tblocks_78944 = sext_i64_i32(ldim_76770);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_76767(ctx, ldim_76770, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_76768, 1, 1, bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_76770, num_whole_tiles_76785, residual_input_77009, cond_77010, binop_x_77026, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77840.mem, mem_77842.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77840, "mem_77840") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77842, "mem_77842") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_77125 = sdiv_up64(min_res_67698, tile_sizze_77124);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77779, bytes_77778, "mem_77779")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77781, bytes_77778, "mem_77781")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78969 = sext_i64_i32(sdiv_up64(tile_sizze_77124, tile_sizze_77124));
                                                int32_t virt_num_tblocks_78970 = sext_i64_i32(ldim_77125);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_77122(ctx, ldim_77125, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_77123, 1, 1, bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_77125, num_whole_tiles_77140, residual_input_77364, cond_77365, binop_x_77381, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77779.mem, mem_77781.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77779, "mem_77779") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77781, "mem_77781") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77846, bytes_77689, "mem_77846")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77710.mem, ctx_param_ext_77708, (int64_t []) {ctx_param_ext_77709}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77848, bytes_77689, "mem_77848")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77707.mem, ctx_param_ext_77705, (int64_t []) {ctx_param_ext_77706}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77843.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
                                                return 1;
                                            
                                            int64_t tmp_67777 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_77848, "mem_77848") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_77846, "mem_77846") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_67777;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_77860, &ext_mem_77854, "ext_mem_77854") != 0)
                                            return 1;
                                        ext_77859 = ext_77853;
                                        ext_77858 = ext_77852;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &ext_mem_77851, "ext_mem_77851") != 0)
                                            return 1;
                                        ext_77856 = ext_77850;
                                        ext_77855 = ext_77849;
                                        loopres_67726 = loopres_f_res_67730;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
                                        return 1;
                                    
                                    bool loop_cond_67778 = slt64(loopres_67726, numIter_67633);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_78915, &ext_mem_77860, "ext_mem_77860") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_78916, &ext_mem_77857, "ext_mem_77857") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_78917 = ext_77859;
                                    int64_t ctx_param_ext_tmp_78918 = ext_77858;
                                    int64_t ctx_param_ext_tmp_78919 = ext_77856;
                                    int64_t ctx_param_ext_tmp_78920 = ext_77855;
                                    bool loop_while_tmp_78921 = loop_cond_67778;
                                    int64_t p_tmp_78922 = loopres_67726;
                                    
                                    if (memblock_set_device(ctx, &mem_param_77707, &mem_param_tmp_78915, "mem_param_tmp_78915") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_77710, &mem_param_tmp_78916, "mem_param_tmp_78916") != 0)
                                        return 1;
                                    ctx_param_ext_77705 = ctx_param_ext_tmp_78917;
                                    ctx_param_ext_77706 = ctx_param_ext_tmp_78918;
                                    ctx_param_ext_77708 = ctx_param_ext_tmp_78919;
                                    ctx_param_ext_77709 = ctx_param_ext_tmp_78920;
                                    loop_while_67692 = loop_while_tmp_78921;
                                    p_67693 = p_tmp_78922;
                                }
                                if (memblock_set_device(ctx, &ext_mem_77866, &mem_param_77707, "mem_param_77707") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_77865, &mem_param_77710, "mem_param_77710") != 0)
                                    return 1;
                                ext_77864 = ctx_param_ext_77705;
                                ext_77863 = ctx_param_ext_77706;
                                ext_77862 = ctx_param_ext_77708;
                                ext_77861 = ctx_param_ext_77709;
                                defunc_0_find_joinTuples_res_67688 = loop_while_67692;
                                defunc_0_find_joinTuples_res_67689 = p_67693;
                                if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77869, bytes_77689, "mem_77869")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_78996 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73225));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_73229(ctx, segmap_usable_groups_73226, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73215, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77861, ext_77862, mem_param_77698.mem, ext_mem_77865.mem, mem_77869.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77872, bytes_77689, "mem_77872")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79005 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73246));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_73250(ctx, segmap_usable_groups_73247, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73237, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77863, ext_77864, mem_param_77695.mem, ext_mem_77866.mem, mem_77872.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
                                    return 1;
                                
                                bool loop_cond_67788 = sle64(zeze_lhs_67649, min_res_67584);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_78897, &mem_77872, "mem_77872") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_78898, &mem_77869, "mem_77869") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_78899 = loop_cond_67788;
                                int64_t dp_tmp_78900 = zeze_lhs_67649;
                                
                                if (memblock_set_device(ctx, &mem_param_77695, &mem_param_tmp_78897, "mem_param_tmp_78897") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77698, &mem_param_tmp_78898, "mem_param_tmp_78898") != 0)
                                    return 1;
                                loop_while_67640 = loop_while_tmp_78899;
                                dp_67641 = dp_tmp_78900;
                            }
                            if (memblock_set_device(ctx, &ext_mem_77878, &mem_param_77695, "mem_param_77695") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77877, &mem_param_77698, "mem_param_77698") != 0)
                                return 1;
                            loopres_f_res_f_res_67636 = loop_while_67640;
                            loopres_f_res_f_res_67637 = dp_67641;
                            if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_73267;
                            
                            segmap_tblock_sizze_73267 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73257;
                            
                            int64_t segmap_usable_groups_73268 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73267);
                            
                            if (memblock_alloc_device(ctx, &mem_77881, bytes_77689, "mem_77881")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79014 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73267));
                            
                            {
                                err = gpu_kernel_inner_SMJ_longzisegmap_73271(ctx, segmap_usable_groups_73268, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73257, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77686, ctx_param_ext_77687, mem_param_77688.mem, ext_mem_77877.mem, mem_77881.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_73288;
                            
                            segmap_tblock_sizze_73288 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73279;
                            
                            int64_t segmap_usable_groups_73289 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73288);
                            
                            if (memblock_alloc_device(ctx, &mem_77884, bytes_77689, "mem_77884")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79023 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_73288));
                            
                            {
                                err = gpu_kernel_inner_SMJ_longzisegmap_73292(ctx, segmap_usable_groups_73289, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73279, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77683, ctx_param_ext_77684, mem_param_77685.mem, ext_mem_77878.mem, mem_77884.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77886, bytes_77628, "mem_77886")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77688.mem, ctx_param_ext_77686, (int64_t []) {ctx_param_ext_77687}, (int64_t []) {nR_49324})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77881.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77888, bytes_77628, "mem_77888")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77685.mem, ctx_param_ext_77683, (int64_t []) {ctx_param_ext_77684}, (int64_t []) {nR_49324})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77884.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_77888, "mem_77888") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_77886, "mem_77886") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_77900, &ext_mem_77894, "ext_mem_77894") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &ext_mem_77891, "ext_mem_77891") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_67804 = slt64(loopres_67586, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78887, &ext_mem_77900, "ext_mem_77900") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78888, &ext_mem_77897, "ext_mem_77897") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78889 = ext_77899;
                    int64_t ctx_param_ext_tmp_78890 = ext_77898;
                    int64_t ctx_param_ext_tmp_78891 = ext_77896;
                    int64_t ctx_param_ext_tmp_78892 = ext_77895;
                    bool loop_while_tmp_78893 = loop_cond_67804;
                    int64_t p_tmp_78894 = loopres_67586;
                    
                    if (memblock_set_device(ctx, &mem_param_77685, &mem_param_tmp_78887, "mem_param_tmp_78887") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77688, &mem_param_tmp_78888, "mem_param_tmp_78888") != 0)
                        return 1;
                    ctx_param_ext_77683 = ctx_param_ext_tmp_78889;
                    ctx_param_ext_77684 = ctx_param_ext_tmp_78890;
                    ctx_param_ext_77686 = ctx_param_ext_tmp_78891;
                    ctx_param_ext_77687 = ctx_param_ext_tmp_78892;
                    loop_while_67574 = loop_while_tmp_78893;
                    p_67575 = p_tmp_78894;
                }
                if (memblock_set_device(ctx, &ext_mem_77906, &mem_param_77685, "mem_param_77685") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_77905, &mem_param_77688, "mem_param_77688") != 0)
                    return 1;
                ext_77904 = ctx_param_ext_77683;
                ext_77903 = ctx_param_ext_77684;
                ext_77902 = ctx_param_ext_77686;
                ext_77901 = ctx_param_ext_77687;
                defunc_0_join_chunks_res_67570 = loop_while_67574;
                defunc_0_join_chunks_res_67571 = p_67575;
                if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_77906, "ext_mem_77906") != 0)
                    return 1;
                ext_78076 = ext_77904;
                ext_78075 = ext_77903;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_77905, "ext_mem_77905") != 0)
                    return 1;
                ext_78073 = ext_77902;
                ext_78072 = ext_77901;
            }
            
            int64_t segmap_tblock_sizze_73309;
            
            segmap_tblock_sizze_73309 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73299;
            
            int64_t segmap_usable_groups_73310 = sdiv_up64(nR_49324, segmap_tblock_sizze_73309);
            
            if (memblock_alloc_device(ctx, &mem_78080, bytes_77628, "mem_78080")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79032 = sext_i64_i32(sdiv_up64(nR_49324, segmap_tblock_sizze_73309));
            
            {
                err = gpu_kernel_inner_SMJ_longzisegmap_73313(ctx, segmap_usable_groups_73310, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73299, 1, 1, (int64_t) 0, nR_49324, ext_78072, ext_78073, mem_param_77640.mem, ext_mem_78074.mem, mem_78080.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_73330;
            
            segmap_tblock_sizze_73330 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73321;
            
            int64_t segmap_usable_groups_73331 = sdiv_up64(nR_49324, segmap_tblock_sizze_73330);
            
            if (memblock_alloc_device(ctx, &mem_78083, bytes_77628, "mem_78083")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79041 = sext_i64_i32(sdiv_up64(nR_49324, segmap_tblock_sizze_73330));
            
            {
                err = gpu_kernel_inner_SMJ_longzisegmap_73334(ctx, segmap_usable_groups_73331, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73321, 1, 1, (int64_t) 0, nR_49324, ext_78075, ext_78076, mem_param_77637.mem, ext_mem_78077.mem, mem_78083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_78084, (int64_t) 1, "mem_78084")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_longzigpuseq_79050(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, i_p_m_t_s_67004, tR_mem_77625.mem, tS_mem_77626.mem, mem_78084.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_79597;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_79597, mem_78084.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_67821 = read_res_79597;
            
            if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
                return 1;
            
            int64_t nextIter_67822;
            
            if (defunc_0_leq_res_67821) {
                int64_t nextIter_t_res_68886 = add64((int64_t) 1, p_66995);
                
                nextIter_67822 = nextIter_t_res_68886;
            } else {
                nextIter_67822 = numIter_66975;
            }
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_78083, "mem_78083") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_78080, "mem_78080") != 0)
                return 1;
            loopres_67019 = nextIter_67822;
        }
        
        bool loop_cond_67824 = slt64(loopres_67019, numIter_66975);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78730, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78731, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        
        bool loop_while_tmp_78732 = loop_cond_67824;
        int64_t p_tmp_78733 = loopres_67019;
        
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77640, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        loop_while_66994 = loop_while_tmp_78732;
        p_66995 = p_tmp_78733;
    }
    if (memblock_set_device(ctx, &ext_mem_78096, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78095, &mem_param_77640, "mem_param_77640") != 0)
        return 1;
    defunc_0_mergeJoin_res_66990 = loop_while_66994;
    defunc_0_mergeJoin_res_66991 = p_66995;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_73340;
    
    segscan_tblock_sizze_73340 = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73339;
    
    int64_t num_tblocks_73342;
    int64_t max_num_tblocks_79056;
    
    max_num_tblocks_79056 = *ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_73341;
    num_tblocks_73342 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_49324, segscan_tblock_sizze_73340), max_num_tblocks_79056)));
    if (memblock_alloc_device(ctx, &mem_78099, bytes_77628, "mem_78099")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78101, bytes_77628, "mem_78101")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_49324)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79057;
        
        shared_memory_79057 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79058;
        
        thread_block_sizze_79058 = ctx->max_thread_block_size;
        
        int64_t registers_79059;
        
        registers_79059 = ctx->max_registers;
        
        int64_t thread_block_sizze_79060;
        
        thread_block_sizze_79060 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79061 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79057, thread_block_sizze_79058), (int64_t) 8), squot64(squot64(registers_79059, thread_block_sizze_79060) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79062 = sdiv_up64(nR_49324, segscan_tblock_sizze_73340 * chunk_sizze_79061);
        int64_t num_virt_threads_79063 = num_virt_blocks_79062 * segscan_tblock_sizze_73340;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79061, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79064, num_virt_blocks_79062, "status_flags_mem_79064")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79064, num_virt_blocks_79062, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79086, (int64_t) 8 * num_virt_blocks_79062, "aggregates_mem_79086")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79088, (int64_t) 8 * num_virt_blocks_79062, "incprefixes_mem_79088")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzisegscan_73345(ctx, num_tblocks_73342, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73339, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73340), chunk_sizze_79061 * segscan_tblock_sizze_73340 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73340), chunk_sizze_79061 * segscan_tblock_sizze_73340 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_49324, num_tblocks_73342, num_virt_blocks_79062, num_virt_threads_79063, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, status_flags_mem_79064.mem, aggregates_mem_79086.mem, incprefixes_mem_79088.mem, global_dynid_mem_79090.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_67840 = zzero_66972 || bounds_check_66984;
    bool index_certs_67841;
    
    if (!protect_assert_disj_67840) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67842;
    
    if (nonzzero_66973) {
        int64_t read_res_79598;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79598, mem_78099.mem, gt_rhs_66981 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68889 = read_res_79598;
        
        m_f_res_67842 = x_68889;
    } else {
        m_f_res_67842 = (int64_t) 0;
    }
    
    int64_t m_67844;
    
    if (zzero_66972) {
        m_67844 = (int64_t) 0;
    } else {
        m_67844 = m_f_res_67842;
    }
    
    int64_t m_67854 = sub64(m_67844, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67856 = slt64(m_67854, nR_49324);
    bool zzero_leq_i_p_m_t_s_67855 = sle64((int64_t) 0, m_67854);
    bool y_67858 = zzero_leq_i_p_m_t_s_67855 && i_p_m_t_s_leq_w_67856;
    bool i_lte_j_67857 = sle64((int64_t) 0, m_67844);
    bool forwards_ok_67859 = i_lte_j_67857 && y_67858;
    bool eq_x_zz_67851 = (int64_t) 0 == m_f_res_67842;
    bool p_and_eq_x_y_67852 = nonzzero_66973 && eq_x_zz_67851;
    bool empty_slice_67853 = zzero_66972 || p_and_eq_x_y_67852;
    bool ok_or_empty_67860 = empty_slice_67853 || forwards_ok_67859;
    bool index_certs_67861;
    
    if (!ok_or_empty_67860) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67844, "] out of bounds for array of shape [", (long long) nR_49324, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78102 = (int64_t) 8 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78103, bytes_78102, "mem_78103")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78096.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78105, bytes_78102, "mem_78105")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78095.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78107, bytes_78102, "mem_78107")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78107.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78109, bytes_78102, "mem_78109")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78109.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_77625.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_73350;
    
    segmap_tblock_sizze_73350 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73349;
    
    int64_t num_tblocks_73352;
    int64_t max_num_tblocks_79199;
    
    max_num_tblocks_79199 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73351;
    num_tblocks_73352 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_49324, segmap_tblock_sizze_73350), max_num_tblocks_79199)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79200 = sext_i64_i32(sdiv_up64(nR_49324, segmap_tblock_sizze_73350));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_73347(ctx, num_tblocks_73352, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73349, 1, 1, (int64_t) 0, nR_49324, m_67844, num_tblocks_73352, virt_num_tblocks_79200, tR_mem_77625.mem, ext_mem_77627.mem, ext_mem_78095.mem, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, mem_78103.mem, mem_78105.mem, mem_78107.mem, mem_78109.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_73356;
    
    segscan_tblock_sizze_73356 = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73355;
    
    int64_t num_tblocks_73358;
    int64_t max_num_tblocks_79213;
    
    max_num_tblocks_79213 = *ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_73357;
    num_tblocks_73358 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segscan_tblock_sizze_73356), max_num_tblocks_79213)));
    if (memblock_alloc_device(ctx, &mem_78113, bytes_78102, "mem_78113")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78115, bytes_78102, "mem_78115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78117, bytes_78102, "mem_78117")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_67844)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79214;
        
        shared_memory_79214 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79215;
        
        thread_block_sizze_79215 = ctx->max_thread_block_size;
        
        int64_t registers_79216;
        
        registers_79216 = ctx->max_registers;
        
        int64_t thread_block_sizze_79217;
        
        thread_block_sizze_79217 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79218 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79214, thread_block_sizze_79215), (int64_t) 8), squot64(squot64(registers_79216, thread_block_sizze_79217) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79219 = sdiv_up64(m_67844, segscan_tblock_sizze_73356 * chunk_sizze_79218);
        int64_t num_virt_threads_79220 = num_virt_blocks_79219 * segscan_tblock_sizze_73356;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79218, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79221, num_virt_blocks_79219, "status_flags_mem_79221")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79221, num_virt_blocks_79219, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79223, (int64_t) 8 * num_virt_blocks_79219, "aggregates_mem_79223")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79225, (int64_t) 8 * num_virt_blocks_79219, "incprefixes_mem_79225")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79227, (int64_t) 8 * num_virt_blocks_79219, "aggregates_mem_79227")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79229, (int64_t) 8 * num_virt_blocks_79219, "incprefixes_mem_79229")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzisegscan_73361(ctx, num_tblocks_73358, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_73355, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73356, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73356), smax64(chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73356, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73356), smax64(chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8, chunk_sizze_79218 * segscan_tblock_sizze_73356 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_67844, num_tblocks_73358, num_virt_blocks_79219, num_virt_threads_79220, mem_78103.mem, mem_78113.mem, mem_78115.mem, mem_78117.mem, status_flags_mem_79221.mem, aggregates_mem_79223.mem, incprefixes_mem_79225.mem, aggregates_mem_79227.mem, incprefixes_mem_79229.mem, global_dynid_mem_79231.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_73377;
    
    segmap_tblock_sizze_73377 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73365;
    
    int64_t segmap_usable_groups_73378 = sdiv_up64(m_67844, segmap_tblock_sizze_73377);
    
    if (memblock_alloc_device(ctx, &mem_78120, bytes_78102, "mem_78120")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79366 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_73377));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_73381(ctx, segmap_usable_groups_73378, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73365, 1, 1, (int64_t) 0, m_67844, mem_78113.mem, mem_78120.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
        return 1;
    
    bool cond_67895 = slt64((int64_t) 0, m_67844);
    bool y_67896 = slt64(m_67854, m_67844);
    bool bounds_check_67897 = zzero_leq_i_p_m_t_s_67855 && y_67896;
    bool loop_not_taken_67898 = !cond_67895;
    bool protect_assert_disj_67899 = bounds_check_67897 || loop_not_taken_67898;
    bool index_certs_67900;
    
    if (!protect_assert_disj_67899) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  ftSMJ.fut:285:10-41\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78122, (int64_t) 8, "mem_78122")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_79375(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78120.mem, mem_78122.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78122, "mem_78122") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78121, (int64_t) 8, "mem_78121")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78121, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78121, "mem_78121") != 0)
            return 1;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78125, (int64_t) 8, "mem_78125")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_79381(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78103.mem, mem_78125.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78125, "mem_78125") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78124, (int64_t) 8, "mem_78124")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78124, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78124, "mem_78124") != 0)
            return 1;
    }
    
    bool zzero_67912 = scatter_psizze_49333 == (int64_t) 0;
    bool nonzzero_67913 = !zzero_67912;
    bool nonzzero_cert_67914;
    
    if (!nonzzero_67913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_67979 = !empty_slice_67853;
    bool protect_assert_disj_67980 = empty_slice_67853 || bounds_check_67897;
    bool index_certs_67981;
    
    if (!protect_assert_disj_67980) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67982;
    
    if (x_67979) {
        int64_t read_res_79599;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79599, mem_78115.mem, m_67854 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68897 = read_res_79599;
        
        m_f_res_67982 = x_68897;
    } else {
        m_f_res_67982 = (int64_t) 0;
    }
    
    int64_t m_67984;
    
    if (empty_slice_67853) {
        m_67984 = (int64_t) 0;
    } else {
        m_67984 = m_f_res_67982;
    }
    
    int64_t m_67994 = sub64(m_67984, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67996 = slt64(m_67994, m_67844);
    bool zzero_leq_i_p_m_t_s_67995 = sle64((int64_t) 0, m_67994);
    bool y_67998 = zzero_leq_i_p_m_t_s_67995 && i_p_m_t_s_leq_w_67996;
    bool i_lte_j_67997 = sle64((int64_t) 0, m_67984);
    bool forwards_ok_67999 = i_lte_j_67997 && y_67998;
    bool eq_x_zz_67991 = (int64_t) 0 == m_f_res_67982;
    bool p_and_eq_x_y_67992 = x_67979 && eq_x_zz_67991;
    bool empty_slice_67993 = empty_slice_67853 || p_and_eq_x_y_67992;
    bool ok_or_empty_68000 = empty_slice_67993 || forwards_ok_67999;
    bool index_certs_68001;
    
    if (!ok_or_empty_68000) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67984, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:377:133-136\n   #4  ftSMJ.fut:366:1-377:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78127 = (int64_t) 8 * m_67984;
    
    if (memblock_alloc_device(ctx, &mem_78132, (int64_t) 8, "mem_78132")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_longzigpuseq_79387(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_78123.mem, ext_mem_78126.mem, mem_78132.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
        return 1;
    
    int64_t n_pairs_t_res_67905;
    
    if (cond_67895) {
        int64_t read_res_79600;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79600, mem_78132.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_77623 = read_res_79600;
        
        n_pairs_t_res_67905 = x_77623;
    } else {
        n_pairs_t_res_67905 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
        return 1;
    
    int64_t n_pairs_67906;
    
    if (cond_67895) {
        n_pairs_67906 = n_pairs_t_res_67905;
    } else {
        n_pairs_67906 = (int64_t) 0;
    }
    
    int64_t bytes_78133 = (int64_t) 8 * n_pairs_67906;
    int64_t segmap_tblock_sizze_73392;
    
    segmap_tblock_sizze_73392 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73391;
    
    int64_t num_tblocks_73394;
    int64_t max_num_tblocks_79393;
    
    max_num_tblocks_79393 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73393;
    num_tblocks_73394 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_73392), max_num_tblocks_79393)));
    if (memblock_alloc_device(ctx, &mem_78128, bytes_78127, "mem_78128")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78128.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78130, bytes_78127, "mem_78130")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78130.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78120.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_73400;
    
    segmap_tblock_sizze_73400 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73399;
    
    int64_t num_tblocks_73402;
    int64_t max_num_tblocks_79394;
    
    max_num_tblocks_79394 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_73401;
    num_tblocks_73402 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_73400), max_num_tblocks_79394)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79395 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_73400));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_73397(ctx, num_tblocks_73402, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73399, 1, 1, (int64_t) 0, m_67844, m_67984, num_tblocks_73402, virt_num_tblocks_79395, mem_78103.mem, mem_78115.mem, mem_78117.mem, mem_78120.mem, mem_78128.mem, mem_78130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
        return 1;
    
    bool cond_68011 = slt64((int64_t) 0, m_67984);
    int64_t segmap_tblock_sizze_73415;
    
    segmap_tblock_sizze_73415 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73407;
    if (memblock_alloc_device(ctx, &mem_78134, bytes_78133, "mem_78134")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78134, n_pairs_67906, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78136, bytes_78133, "mem_78136")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78136, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78138, bytes_78133, "mem_78138")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78138, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_67910 = add64(scatter_psizze_49333, n_pairs_67906);
    int64_t zs_lhs_67911 = sub64(zm_lhs_67910, (int64_t) 1);
    int64_t m_67915 = sdiv64(zs_lhs_67911, scatter_psizze_49333);
    bool loop_cond_67916 = slt64((int64_t) 0, m_67915);
    bool partitioned_scatter_res_67917;
    int64_t partitioned_scatter_res_67921;
    bool loop_while_67922;
    int64_t p_67926;
    
    loop_while_67922 = loop_cond_67916;
    p_67926 = (int64_t) 0;
    while (loop_while_67922) {
        int64_t lower_bound_67927 = mul64(scatter_psizze_49333, p_67926);
        int64_t min_arg1_67928 = add64(scatter_psizze_49333, lower_bound_67927);
        int64_t min_res_67929 = smin64(n_pairs_67906, min_arg1_67928);
        int64_t j_m_i_67930 = sub64(min_res_67929, lower_bound_67927);
        bool empty_slice_67931 = j_m_i_67930 == (int64_t) 0;
        int64_t m_67932 = sub64(j_m_i_67930, (int64_t) 1);
        int64_t i_p_m_t_s_67933 = add64(lower_bound_67927, m_67932);
        bool zzero_leq_i_p_m_t_s_67934 = sle64((int64_t) 0, i_p_m_t_s_67933);
        bool i_p_m_t_s_leq_w_67935 = slt64(i_p_m_t_s_67933, n_pairs_67906);
        bool zzero_lte_i_67936 = sle64((int64_t) 0, lower_bound_67927);
        bool i_lte_j_67937 = sle64(lower_bound_67927, min_res_67929);
        bool y_67938 = i_p_m_t_s_leq_w_67935 && zzero_lte_i_67936;
        bool y_67939 = zzero_leq_i_p_m_t_s_67934 && y_67938;
        bool forwards_ok_67940 = i_lte_j_67937 && y_67939;
        bool ok_or_empty_67941 = empty_slice_67931 || forwards_ok_67940;
        bool index_certs_67942;
        
        if (!ok_or_empty_67941) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_67927, ":", (long long) min_res_67929, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78148 = (int64_t) 8 * j_m_i_67930;
        
        if (memblock_alloc_device(ctx, &mem_78149, bytes_78148, "mem_78149")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78134.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78151, bytes_78148, "mem_78151")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78136.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78153, bytes_78148, "mem_78153")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78138.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79413 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_73392));
        
        {
            err = gpu_kernel_inner_SMJ_longzisegmap_73389(ctx, num_tblocks_73394, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73391, 1, 1, (int64_t) 0, m_67844, lower_bound_67927, min_res_67929, j_m_i_67930, num_tblocks_73394, virt_num_tblocks_79413, mem_78105.mem, mem_78107.mem, mem_78109.mem, mem_78120.mem, mem_78149.mem, mem_78151.mem, mem_78153.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_67956 = add64((int64_t) 1, p_67926);
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78134.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78136.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78138.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        
        bool loop_cond_67967 = slt64(tmp_67956, m_67915);
        bool loop_while_tmp_79408 = loop_cond_67967;
        int64_t p_tmp_79412 = tmp_67956;
        
        loop_while_67922 = loop_while_tmp_79408;
        p_67926 = p_tmp_79412;
    }
    partitioned_scatter_res_67917 = loop_while_67922;
    partitioned_scatter_res_67921 = p_67926;
    if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
        return 1;
    
    bool loop_cond_t_res_68012 = slt64(m_67844, n_pairs_67906);
    bool x_68013 = cond_68011 && loop_cond_t_res_68012;
    
    if (memblock_alloc_device(ctx, &mem_78179, (int64_t) 8, "mem_78179")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78180, (int64_t) 8, "mem_78180")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78181, (int64_t) 8, "mem_78181")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_68014;
    int64_t joinTups_to_joinPairs_InnerJoin_res_68018;
    bool loop_while_68019;
    int64_t p_68023;
    
    if (memblock_set_device(ctx, &mem_param_78166, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78169, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78172, &mem_78138, "mem_78138") != 0)
        return 1;
    loop_while_68019 = x_68013;
    p_68023 = (int64_t) 0;
    while (loop_while_68019) {
        bool x_68024 = sle64((int64_t) 0, p_68023);
        bool y_68025 = slt64(p_68023, m_67984);
        bool bounds_check_68026 = x_68024 && y_68025;
        bool index_certs_68027;
        
        if (!bounds_check_68026) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_68023, "] out of bounds for array of shape [", (long long) m_67984, "].", "-> #0  ftSMJ.fut:300:13-42\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_79601;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79601, mem_78130.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68028 = read_res_79601;
        int64_t read_res_79602;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79602, mem_78128.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68029 = read_res_79602;
        bool x_68030 = sle64((int64_t) 0, loopres_68028);
        bool y_68031 = slt64(loopres_68028, n_pairs_67906);
        bool bounds_check_68032 = x_68030 && y_68031;
        bool index_certs_68033;
        
        if (!bounds_check_68032) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:302:52-61\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_68044 = add64(loopres_68028, loopres_68029);
        bool empty_slice_68048 = loopres_68029 == (int64_t) 0;
        int64_t m_68049 = sub64(loopres_68029, (int64_t) 1);
        int64_t i_p_m_t_s_68050 = add64(loopres_68028, m_68049);
        bool zzero_leq_i_p_m_t_s_68051 = sle64((int64_t) 0, i_p_m_t_s_68050);
        bool i_p_m_t_s_leq_w_68052 = slt64(i_p_m_t_s_68050, n_pairs_67906);
        bool i_lte_j_68053 = sle64(loopres_68028, tmp_68044);
        bool y_68054 = x_68030 && i_p_m_t_s_leq_w_68052;
        bool y_68055 = zzero_leq_i_p_m_t_s_68051 && y_68054;
        bool forwards_ok_68056 = i_lte_j_68053 && y_68055;
        bool ok_or_empty_68057 = empty_slice_68048 || forwards_ok_68056;
        bool index_certs_68058;
        
        if (!ok_or_empty_68057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, ":", (long long) tmp_68044, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:306:14-55\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:377:133-136\n   #3  ftSMJ.fut:366:1-377:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78182 = (int64_t) 8 * loopres_68029;
        int64_t segmap_usable_groups_73416 = sdiv_up64(loopres_68029, segmap_tblock_sizze_73415);
        int64_t tmp_68043 = add64((int64_t) 1, p_68023);
        
        if (memblock_alloc_device(ctx, &mem_78174, bytes_78133, "mem_78174")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78174.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78176, bytes_78133, "mem_78176")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78178, bytes_78133, "mem_78178")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78172.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        
        bool cond_68062 = slt64(tmp_68043, m_67984);
        bool x_68063 = loop_cond_t_res_68012 && cond_68062;
        
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_79434(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_68028, mem_param_78166.mem, mem_param_78169.mem, mem_param_78172.mem, mem_78179.mem, mem_78180.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78183, bytes_78182, "mem_78183")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79440 = loopres_68029;
        int64_t tblock_sizze_79445;
        
        tblock_sizze_79445 = *ctx->tuning_params.inner_SMJ_longzitblock_sizze_79445;
        
        int64_t virt_num_tblocks_79446 = sdiv_up64(replicate_n_79440, tblock_sizze_79445);
        int64_t num_tblocks_79447 = smin64(virt_num_tblocks_79446, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_longzireplicate_79441(ctx, num_tblocks_79447, 1, 1, tblock_sizze_79445, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79440, virt_num_tblocks_79446, num_tblocks_79447, mem_78179.mem, mem_78183.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78185, bytes_78182, "mem_78185")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79460 = loopres_68029;
        int64_t tblock_sizze_79465;
        
        tblock_sizze_79465 = *ctx->tuning_params.inner_SMJ_longzitblock_sizze_79465;
        
        int64_t virt_num_tblocks_79466 = sdiv_up64(replicate_n_79460, tblock_sizze_79465);
        int64_t num_tblocks_79467 = smin64(virt_num_tblocks_79466, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_longzireplicate_79461(ctx, num_tblocks_79467, 1, 1, tblock_sizze_79465, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79460, virt_num_tblocks_79466, num_tblocks_79467, mem_78180.mem, mem_78185.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79480 = sext_i64_i32(sdiv_up64(loopres_68029, segmap_tblock_sizze_73415));
        
        {
            err = gpu_kernel_inner_SMJ_longzisegmap_73419(ctx, segmap_usable_groups_73416, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_73407, 1, 1, (int64_t) 0, loopres_68028, loopres_68029, mem_78178.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78174.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78185.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79426, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79427, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79428, &mem_78178, "mem_78178") != 0)
            return 1;
        
        bool loop_while_tmp_79429 = x_68063;
        int64_t p_tmp_79433 = tmp_68043;
        
        if (memblock_set_device(ctx, &mem_param_78166, &mem_param_tmp_79426, "mem_param_tmp_79426") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78169, &mem_param_tmp_79427, "mem_param_tmp_79427") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78172, &mem_param_tmp_79428, "mem_param_tmp_79428") != 0)
            return 1;
        loop_while_68019 = loop_while_tmp_79429;
        p_68023 = p_tmp_79433;
    }
    if (memblock_set_device(ctx, &ext_mem_78197, &mem_param_78166, "mem_param_78166") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78196, &mem_param_78169, "mem_param_78169") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78195, &mem_param_78172, "mem_param_78172") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_68014 = loop_while_68019;
    joinTups_to_joinPairs_InnerJoin_res_68018 = p_68023;
    if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78199, bytes_78133, "mem_78199")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78197.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78201, bytes_78133, "mem_78201")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78201.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78203, bytes_78133, "mem_78203")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_78201, "mem_78201") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78701, &mem_78203, "mem_78203") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78702, &mem_78199, "mem_78199") != 0)
        return 1;
    prim_out_78703 = n_pairs_67906;
    if (memblock_set_device(ctx, &*mem_out_p_79582, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79583, &mem_out_78701, "mem_out_78701") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79584, &mem_out_78702, "mem_out_78702") != 0)
        return 1;
    *out_prim_out_79585 = prim_out_78703;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_78203, "mem_78203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78201, "mem_78201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78199, "mem_78199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79428, "mem_param_tmp_79428") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79427, "mem_param_tmp_79427") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79426, "mem_param_tmp_79426") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78178, "mem_78178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78172, "mem_param_78172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78169, "mem_param_78169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78166, "mem_param_78166") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78124, "mem_78124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78125, "mem_78125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78121, "mem_78121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78122, "mem_78122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79229, "incprefixes_mem_79229") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79227, "aggregates_mem_79227") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79225, "incprefixes_mem_79225") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79223, "aggregates_mem_79223") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79221, "status_flags_mem_79221") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79088, "incprefixes_mem_79088") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79086, "aggregates_mem_79086") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79064, "status_flags_mem_79064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78731, "mem_param_tmp_78731") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78730, "mem_param_tmp_78730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78083, "mem_78083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78080, "mem_78080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78888, "mem_param_tmp_78888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78887, "mem_param_tmp_78887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77888, "mem_77888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77886, "mem_77886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78898, "mem_param_tmp_78898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78897, "mem_param_tmp_78897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77872, "mem_77872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77869, "mem_77869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78916, "mem_param_tmp_78916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78915, "mem_param_tmp_78915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77848, "mem_77848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77846, "mem_77846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77781, "mem_77781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77779, "mem_77779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77842, "mem_77842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77840, "mem_77840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77851, "ext_mem_77851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77854, "ext_mem_77854") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77857, "ext_mem_77857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77860, "ext_mem_77860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77710, "mem_param_77710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77707, "mem_param_77707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77702, "mem_77702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77703, "mem_77703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77699, "mem_77699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77700, "mem_77700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77698, "mem_param_77698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77695, "mem_param_77695") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77891, "ext_mem_77891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77894, "ext_mem_77894") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77897, "ext_mem_77897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77900, "ext_mem_77900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77688, "mem_param_77688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77685, "mem_param_77685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77905, "ext_mem_77905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77906, "ext_mem_77906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77667, "mem_77667") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77669, "mem_77669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77651, "mem_77651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77652, "mem_77652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77647, "mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77648, "mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78749, "mem_param_tmp_78749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78748, "mem_param_tmp_78748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78053, "mem_78053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78051, "mem_78051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77986, "mem_77986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77984, "mem_77984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78047, "mem_78047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78045, "mem_78045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78056, "ext_mem_78056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78059, "ext_mem_78059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78062, "ext_mem_78062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78065, "ext_mem_78065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77915, "mem_param_77915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77912, "mem_param_77912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78070, "ext_mem_78070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78071, "ext_mem_78071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77907, "mem_77907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77908, "mem_77908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77640, "mem_param_77640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77632, "mem_77632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77633, "mem_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78702, "mem_out_78702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78701, "mem_out_78701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_79603, struct memblock_device *mem_out_p_79604, struct memblock_device *mem_out_p_79605, int64_t *out_prim_out_79606, struct memblock_device tR_mem_77625, struct memblock_device tS_mem_77626, int64_t nR_39348, int64_t nS_39349, int64_t offset_R_39352, int64_t offset_S_39353, int64_t partitionsPerWindow_39354, int64_t numberOfWindows_39355, int64_t extParallelism_39356, int64_t scatter_psizze_39357)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_78203;
    
    mem_78203.references = NULL;
    
    struct memblock_device mem_78201;
    
    mem_78201.references = NULL;
    
    struct memblock_device mem_78199;
    
    mem_78199.references = NULL;
    
    struct memblock_device mem_param_tmp_79448;
    
    mem_param_tmp_79448.references = NULL;
    
    struct memblock_device mem_param_tmp_79447;
    
    mem_param_tmp_79447.references = NULL;
    
    struct memblock_device mem_param_tmp_79446;
    
    mem_param_tmp_79446.references = NULL;
    
    struct memblock_device mem_78185;
    
    mem_78185.references = NULL;
    
    struct memblock_device mem_78183;
    
    mem_78183.references = NULL;
    
    struct memblock_device mem_78178;
    
    mem_78178.references = NULL;
    
    struct memblock_device mem_78176;
    
    mem_78176.references = NULL;
    
    struct memblock_device mem_78174;
    
    mem_78174.references = NULL;
    
    struct memblock_device mem_param_78172;
    
    mem_param_78172.references = NULL;
    
    struct memblock_device mem_param_78169;
    
    mem_param_78169.references = NULL;
    
    struct memblock_device mem_param_78166;
    
    mem_param_78166.references = NULL;
    
    struct memblock_device ext_mem_78195;
    
    ext_mem_78195.references = NULL;
    
    struct memblock_device ext_mem_78196;
    
    ext_mem_78196.references = NULL;
    
    struct memblock_device ext_mem_78197;
    
    ext_mem_78197.references = NULL;
    
    struct memblock_device mem_78181;
    
    mem_78181.references = NULL;
    
    struct memblock_device mem_78180;
    
    mem_78180.references = NULL;
    
    struct memblock_device mem_78179;
    
    mem_78179.references = NULL;
    
    struct memblock_device mem_78153;
    
    mem_78153.references = NULL;
    
    struct memblock_device mem_78151;
    
    mem_78151.references = NULL;
    
    struct memblock_device mem_78149;
    
    mem_78149.references = NULL;
    
    struct memblock_device mem_78138;
    
    mem_78138.references = NULL;
    
    struct memblock_device mem_78136;
    
    mem_78136.references = NULL;
    
    struct memblock_device mem_78134;
    
    mem_78134.references = NULL;
    
    struct memblock_device mem_78130;
    
    mem_78130.references = NULL;
    
    struct memblock_device mem_78128;
    
    mem_78128.references = NULL;
    
    struct memblock_device mem_78132;
    
    mem_78132.references = NULL;
    
    struct memblock_device mem_78124;
    
    mem_78124.references = NULL;
    
    struct memblock_device mem_78125;
    
    mem_78125.references = NULL;
    
    struct memblock_device ext_mem_78126;
    
    ext_mem_78126.references = NULL;
    
    struct memblock_device mem_78121;
    
    mem_78121.references = NULL;
    
    struct memblock_device mem_78122;
    
    mem_78122.references = NULL;
    
    struct memblock_device ext_mem_78123;
    
    ext_mem_78123.references = NULL;
    
    struct memblock_device mem_78120;
    
    mem_78120.references = NULL;
    
    struct memblock_device incprefixes_mem_79249;
    
    incprefixes_mem_79249.references = NULL;
    
    struct memblock_device aggregates_mem_79247;
    
    aggregates_mem_79247.references = NULL;
    
    struct memblock_device incprefixes_mem_79245;
    
    incprefixes_mem_79245.references = NULL;
    
    struct memblock_device aggregates_mem_79243;
    
    aggregates_mem_79243.references = NULL;
    
    struct memblock_device status_flags_mem_79241;
    
    status_flags_mem_79241.references = NULL;
    
    struct memblock_device mem_78117;
    
    mem_78117.references = NULL;
    
    struct memblock_device mem_78115;
    
    mem_78115.references = NULL;
    
    struct memblock_device mem_78113;
    
    mem_78113.references = NULL;
    
    struct memblock_device mem_78109;
    
    mem_78109.references = NULL;
    
    struct memblock_device mem_78107;
    
    mem_78107.references = NULL;
    
    struct memblock_device mem_78105;
    
    mem_78105.references = NULL;
    
    struct memblock_device mem_78103;
    
    mem_78103.references = NULL;
    
    struct memblock_device incprefixes_mem_79108;
    
    incprefixes_mem_79108.references = NULL;
    
    struct memblock_device aggregates_mem_79106;
    
    aggregates_mem_79106.references = NULL;
    
    struct memblock_device status_flags_mem_79084;
    
    status_flags_mem_79084.references = NULL;
    
    struct memblock_device mem_78101;
    
    mem_78101.references = NULL;
    
    struct memblock_device mem_78099;
    
    mem_78099.references = NULL;
    
    struct memblock_device mem_param_tmp_78751;
    
    mem_param_tmp_78751.references = NULL;
    
    struct memblock_device mem_param_tmp_78750;
    
    mem_param_tmp_78750.references = NULL;
    
    struct memblock_device mem_78084;
    
    mem_78084.references = NULL;
    
    struct memblock_device mem_78083;
    
    mem_78083.references = NULL;
    
    struct memblock_device mem_78080;
    
    mem_78080.references = NULL;
    
    struct memblock_device mem_param_tmp_78908;
    
    mem_param_tmp_78908.references = NULL;
    
    struct memblock_device mem_param_tmp_78907;
    
    mem_param_tmp_78907.references = NULL;
    
    struct memblock_device mem_77888;
    
    mem_77888.references = NULL;
    
    struct memblock_device mem_77886;
    
    mem_77886.references = NULL;
    
    struct memblock_device mem_77884;
    
    mem_77884.references = NULL;
    
    struct memblock_device mem_77881;
    
    mem_77881.references = NULL;
    
    struct memblock_device mem_param_tmp_78918;
    
    mem_param_tmp_78918.references = NULL;
    
    struct memblock_device mem_param_tmp_78917;
    
    mem_param_tmp_78917.references = NULL;
    
    struct memblock_device mem_77872;
    
    mem_77872.references = NULL;
    
    struct memblock_device mem_77869;
    
    mem_77869.references = NULL;
    
    struct memblock_device mem_param_tmp_78936;
    
    mem_param_tmp_78936.references = NULL;
    
    struct memblock_device mem_param_tmp_78935;
    
    mem_param_tmp_78935.references = NULL;
    
    struct memblock_device mem_77848;
    
    mem_77848.references = NULL;
    
    struct memblock_device mem_77846;
    
    mem_77846.references = NULL;
    
    struct memblock_device mem_77781;
    
    mem_77781.references = NULL;
    
    struct memblock_device mem_77779;
    
    mem_77779.references = NULL;
    
    struct memblock_device mem_77842;
    
    mem_77842.references = NULL;
    
    struct memblock_device mem_77840;
    
    mem_77840.references = NULL;
    
    struct memblock_device ext_mem_77843;
    
    ext_mem_77843.references = NULL;
    
    struct memblock_device ext_mem_77844;
    
    ext_mem_77844.references = NULL;
    
    struct memblock_device ext_mem_77720;
    
    ext_mem_77720.references = NULL;
    
    struct memblock_device mem_77718;
    
    mem_77718.references = NULL;
    
    struct memblock_device ext_mem_77851;
    
    ext_mem_77851.references = NULL;
    
    struct memblock_device ext_mem_77854;
    
    ext_mem_77854.references = NULL;
    
    struct memblock_device mem_77716;
    
    mem_77716.references = NULL;
    
    struct memblock_device ext_mem_77857;
    
    ext_mem_77857.references = NULL;
    
    struct memblock_device ext_mem_77860;
    
    ext_mem_77860.references = NULL;
    
    struct memblock_device ext_mem_77714;
    
    ext_mem_77714.references = NULL;
    
    struct memblock_device ext_mem_77713;
    
    ext_mem_77713.references = NULL;
    
    struct memblock_device mem_param_77710;
    
    mem_param_77710.references = NULL;
    
    struct memblock_device mem_param_77707;
    
    mem_param_77707.references = NULL;
    
    struct memblock_device ext_mem_77865;
    
    ext_mem_77865.references = NULL;
    
    struct memblock_device ext_mem_77866;
    
    ext_mem_77866.references = NULL;
    
    struct memblock_device mem_77702;
    
    mem_77702.references = NULL;
    
    struct memblock_device mem_77703;
    
    mem_77703.references = NULL;
    
    struct memblock_device ext_mem_77704;
    
    ext_mem_77704.references = NULL;
    
    struct memblock_device mem_77699;
    
    mem_77699.references = NULL;
    
    struct memblock_device mem_77700;
    
    mem_77700.references = NULL;
    
    struct memblock_device ext_mem_77701;
    
    ext_mem_77701.references = NULL;
    
    struct memblock_device mem_param_77698;
    
    mem_param_77698.references = NULL;
    
    struct memblock_device mem_param_77695;
    
    mem_param_77695.references = NULL;
    
    struct memblock_device ext_mem_77877;
    
    ext_mem_77877.references = NULL;
    
    struct memblock_device ext_mem_77878;
    
    ext_mem_77878.references = NULL;
    
    struct memblock_device mem_77715;
    
    mem_77715.references = NULL;
    
    struct memblock_device mem_77712;
    
    mem_77712.references = NULL;
    
    struct memblock_device mem_77711;
    
    mem_77711.references = NULL;
    
    struct memblock_device mem_77692;
    
    mem_77692.references = NULL;
    
    struct memblock_device mem_77690;
    
    mem_77690.references = NULL;
    
    struct memblock_device ext_mem_77891;
    
    ext_mem_77891.references = NULL;
    
    struct memblock_device ext_mem_77894;
    
    ext_mem_77894.references = NULL;
    
    struct memblock_device ext_mem_77897;
    
    ext_mem_77897.references = NULL;
    
    struct memblock_device ext_mem_77900;
    
    ext_mem_77900.references = NULL;
    
    struct memblock_device mem_param_77688;
    
    mem_param_77688.references = NULL;
    
    struct memblock_device mem_param_77685;
    
    mem_param_77685.references = NULL;
    
    struct memblock_device ext_mem_77905;
    
    ext_mem_77905.references = NULL;
    
    struct memblock_device ext_mem_77906;
    
    ext_mem_77906.references = NULL;
    
    struct memblock_device mem_77682;
    
    mem_77682.references = NULL;
    
    struct memblock_device mem_77680;
    
    mem_77680.references = NULL;
    
    struct memblock_device mem_77667;
    
    mem_77667.references = NULL;
    
    struct memblock_device mem_77669;
    
    mem_77669.references = NULL;
    
    struct memblock_device ext_mem_77670;
    
    ext_mem_77670.references = NULL;
    
    struct memblock_device ext_mem_77671;
    
    ext_mem_77671.references = NULL;
    
    struct memblock_device mem_77664;
    
    mem_77664.references = NULL;
    
    struct memblock_device mem_77662;
    
    mem_77662.references = NULL;
    
    struct memblock_device mem_77651;
    
    mem_77651.references = NULL;
    
    struct memblock_device mem_77652;
    
    mem_77652.references = NULL;
    
    struct memblock_device ext_mem_77653;
    
    ext_mem_77653.references = NULL;
    
    struct memblock_device mem_77650;
    
    mem_77650.references = NULL;
    
    struct memblock_device mem_77647;
    
    mem_77647.references = NULL;
    
    struct memblock_device mem_77648;
    
    mem_77648.references = NULL;
    
    struct memblock_device ext_mem_77649;
    
    ext_mem_77649.references = NULL;
    
    struct memblock_device mem_77646;
    
    mem_77646.references = NULL;
    
    struct memblock_device mem_77644;
    
    mem_77644.references = NULL;
    
    struct memblock_device mem_param_tmp_78769;
    
    mem_param_tmp_78769.references = NULL;
    
    struct memblock_device mem_param_tmp_78768;
    
    mem_param_tmp_78768.references = NULL;
    
    struct memblock_device mem_78053;
    
    mem_78053.references = NULL;
    
    struct memblock_device mem_78051;
    
    mem_78051.references = NULL;
    
    struct memblock_device mem_77986;
    
    mem_77986.references = NULL;
    
    struct memblock_device mem_77984;
    
    mem_77984.references = NULL;
    
    struct memblock_device mem_78047;
    
    mem_78047.references = NULL;
    
    struct memblock_device mem_78045;
    
    mem_78045.references = NULL;
    
    struct memblock_device ext_mem_78048;
    
    ext_mem_78048.references = NULL;
    
    struct memblock_device ext_mem_78049;
    
    ext_mem_78049.references = NULL;
    
    struct memblock_device ext_mem_77925;
    
    ext_mem_77925.references = NULL;
    
    struct memblock_device mem_77923;
    
    mem_77923.references = NULL;
    
    struct memblock_device ext_mem_78056;
    
    ext_mem_78056.references = NULL;
    
    struct memblock_device ext_mem_78059;
    
    ext_mem_78059.references = NULL;
    
    struct memblock_device mem_77921;
    
    mem_77921.references = NULL;
    
    struct memblock_device ext_mem_78062;
    
    ext_mem_78062.references = NULL;
    
    struct memblock_device ext_mem_78065;
    
    ext_mem_78065.references = NULL;
    
    struct memblock_device ext_mem_77919;
    
    ext_mem_77919.references = NULL;
    
    struct memblock_device ext_mem_77918;
    
    ext_mem_77918.references = NULL;
    
    struct memblock_device mem_param_77915;
    
    mem_param_77915.references = NULL;
    
    struct memblock_device mem_param_77912;
    
    mem_param_77912.references = NULL;
    
    struct memblock_device ext_mem_78070;
    
    ext_mem_78070.references = NULL;
    
    struct memblock_device ext_mem_78071;
    
    ext_mem_78071.references = NULL;
    
    struct memblock_device mem_77920;
    
    mem_77920.references = NULL;
    
    struct memblock_device mem_77917;
    
    mem_77917.references = NULL;
    
    struct memblock_device mem_77916;
    
    mem_77916.references = NULL;
    
    struct memblock_device mem_77907;
    
    mem_77907.references = NULL;
    
    struct memblock_device mem_77908;
    
    mem_77908.references = NULL;
    
    struct memblock_device ext_mem_77909;
    
    ext_mem_77909.references = NULL;
    
    struct memblock_device ext_mem_78074;
    
    ext_mem_78074.references = NULL;
    
    struct memblock_device ext_mem_78077;
    
    ext_mem_78077.references = NULL;
    
    struct memblock_device ext_mem_78087;
    
    ext_mem_78087.references = NULL;
    
    struct memblock_device ext_mem_78090;
    
    ext_mem_78090.references = NULL;
    
    struct memblock_device mem_param_77640;
    
    mem_param_77640.references = NULL;
    
    struct memblock_device mem_param_77637;
    
    mem_param_77637.references = NULL;
    
    struct memblock_device ext_mem_78095;
    
    ext_mem_78095.references = NULL;
    
    struct memblock_device ext_mem_78096;
    
    ext_mem_78096.references = NULL;
    
    struct memblock_device mem_77642;
    
    mem_77642.references = NULL;
    
    struct memblock_device mem_77641;
    
    mem_77641.references = NULL;
    
    struct memblock_device mem_77632;
    
    mem_77632.references = NULL;
    
    struct memblock_device mem_77633;
    
    mem_77633.references = NULL;
    
    struct memblock_device ext_mem_77634;
    
    ext_mem_77634.references = NULL;
    
    struct memblock_device mem_77631;
    
    mem_77631.references = NULL;
    
    struct memblock_device mem_77629;
    
    mem_77629.references = NULL;
    
    struct memblock_device ext_mem_77627;
    
    ext_mem_77627.references = NULL;
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78703;
    int64_t zm_lhs_66970 = add64(nR_39348, nS_39349);
    int64_t zs_lhs_66971 = sub64(zm_lhs_66970, (int64_t) 1);
    bool zzero_66972 = nR_39348 == (int64_t) 0;
    bool nonzzero_66973 = !zzero_66972;
    bool nonzzero_cert_66974;
    
    if (!nonzzero_66973) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:232:26-29\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_66975 = sdiv64(zs_lhs_66971, nR_39348);
    
    if (futrts_indicesWithIncrement_9601(ctx, &ext_mem_77627, tR_mem_77625, nR_39348, offset_R_39352) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_77628 = (int64_t) 8 * nR_39348;
    
    if (memblock_alloc_device(ctx, &mem_77629, bytes_77628, "mem_77629")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77629, nR_39348, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77631, bytes_77628, "mem_77631")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_77631, nR_39348, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_66980 = slt64((int64_t) 0, numIter_66975);
    int64_t gt_rhs_66981 = sub64(nR_39348, (int64_t) 1);
    bool x_66982 = sle64((int64_t) 0, gt_rhs_66981);
    bool y_66983 = slt64(gt_rhs_66981, nR_39348);
    bool bounds_check_66984 = x_66982 && y_66983;
    bool loop_not_taken_66985 = !loop_cond_66980;
    bool protect_assert_disj_66986 = bounds_check_66984 || loop_not_taken_66985;
    bool index_certs_66987;
    
    if (!protect_assert_disj_66986) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftSMJ.fut:239:25-33\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_66980) {
        if (memblock_alloc_device(ctx, &mem_77633, (int64_t) 2, "mem_77633")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_78724(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, tR_mem_77625.mem, mem_77633.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77633, "mem_77633") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_77632, (int64_t) 2, "mem_77632")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i16(ctx, mem_77632, (int64_t) 1, (int16_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_77634, &mem_77632, "mem_77632") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_77641, (int64_t) 2, "mem_77641")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_77642, (int64_t) 1, "mem_77642")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_66990;
    int64_t defunc_0_mergeJoin_res_66991;
    bool loop_while_66994;
    int64_t p_66995;
    
    if (memblock_set_device(ctx, &mem_param_77637, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_77640, &mem_77629, "mem_77629") != 0)
        return 1;
    loop_while_66994 = loop_cond_66980;
    p_66995 = (int64_t) 0;
    while (loop_while_66994) {
        int64_t tS_start_66998 = mul64(nR_39348, p_66995);
        int64_t min_arg1_66999 = add64(nR_39348, tS_start_66998);
        int64_t min_res_67000 = smin64(nS_39349, min_arg1_66999);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 = sub64(min_res_67000, tS_start_66998);
        bool empty_slice_67002 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001 == (int64_t) 0;
        int64_t m_67003 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, (int64_t) 1);
        int64_t i_p_m_t_s_67004 = add64(tS_start_66998, m_67003);
        bool zzero_leq_i_p_m_t_s_67005 = sle64((int64_t) 0, i_p_m_t_s_67004);
        bool i_p_m_t_s_leq_w_67006 = slt64(i_p_m_t_s_67004, nS_39349);
        bool zzero_lte_i_67007 = sle64((int64_t) 0, tS_start_66998);
        bool i_lte_j_67008 = sle64(tS_start_66998, min_res_67000);
        bool y_67009 = i_p_m_t_s_leq_w_67006 && zzero_lte_i_67007;
        bool y_67010 = zzero_leq_i_p_m_t_s_67005 && y_67009;
        bool forwards_ok_67011 = i_lte_j_67008 && y_67010;
        bool ok_or_empty_67012 = empty_slice_67002 || forwards_ok_67011;
        bool index_certs_67013;
        
        if (!ok_or_empty_67012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_66998, ":", (long long) min_res_67000, "] out of bounds for array of shape [", (long long) nS_39349, "].", "-> #0  ftSMJ.fut:238:16-35\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_67015 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
        bool index_certs_67016;
        
        if (!y_67015) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:239:12-19\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_78756(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_66998, tS_mem_77626.mem, ext_mem_77634.mem, mem_77641.mem, mem_77642.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_79607;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79607, mem_77642.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_67018 = read_res_79607;
        int64_t loopres_67019;
        
        if (defunc_0_gt_res_67018) {
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_param_77637, "mem_param_77637") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_param_77640, "mem_param_77640") != 0)
                return 1;
            loopres_67019 = numIter_66975;
        } else {
            bool cond_67022 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, nR_39348);
            bool dim_match_67136 = nR_39348 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            bool protect_assert_disj_78305 = cond_67022 || dim_match_67136;
            bool empty_or_match_cert_67137;
            
            if (!protect_assert_disj_78305) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "] cannot match shape of type `[", (long long) nR_39348, "]i16`.", "-> #0  ftSMJ.fut:247:18-31\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_67143 = slt64((int64_t) 0, numberOfWindows_39355);
            bool y_67146 = slt64((int64_t) 0, nR_39348);
            bool loop_not_taken_67147 = !loop_cond_67143;
            bool protect_assert_disj_67148 = y_67146 || loop_not_taken_67147;
            bool protect_assert_disj_78307 = cond_67022 || protect_assert_disj_67148;
            bool index_certs_67149;
            
            if (!protect_assert_disj_78307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftsort.fut:285:20-25\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_68532 = add64(nR_39348, extParallelism_39356);
            int64_t zs_lhs_68533 = sub64(zm_lhs_68532, (int64_t) 1);
            bool zzero_68534 = extParallelism_39356 == (int64_t) 0;
            bool nonzzero_68535 = !zzero_68534;
            bool loop_not_taken_78248 = !cond_67022;
            bool protect_assert_disj_78249 = nonzzero_68535 || loop_not_taken_78248;
            bool nonzzero_cert_68536;
            
            if (!protect_assert_disj_78249) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_68537 = sdiv_safe64(zs_lhs_68533, extParallelism_39356);
            bool loop_cond_68538 = slt64((int64_t) 0, numIter_68537);
            bool loop_not_taken_68539 = !y_67015;
            bool loop_not_taken_68540 = !loop_cond_68538;
            bool x_68541 = sle64((int64_t) 0, m_67003);
            bool y_68542 = slt64(m_67003, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001);
            bool bounds_check_68544 = x_68541 && y_68542;
            bool protect_assert_disj_68545 = loop_not_taken_68539 || bounds_check_68544;
            bool protect_assert_disj_68546 = loop_not_taken_68540 || protect_assert_disj_68545;
            bool protect_assert_disj_78251 = protect_assert_disj_68546 || loop_not_taken_78248;
            bool index_certs_68547;
            
            if (!protect_assert_disj_78251) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67817;
            
            if (!bounds_check_68544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67003, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, "].", "-> #0  ftSMJ.fut:258:23-44\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_67819;
            
            if (!bounds_check_66984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftSMJ.fut:258:51-59\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 = mul64(partitionsPerWindow_39354, numberOfWindows_39355);
            int64_t join_chunks_arg3_67139 = add64(offset_S_39353, tS_start_66998);
            int64_t bytes_77643 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
            bool empty_slice_67144 = partitionsPerWindow_39354 == (int64_t) 0;
            int64_t m_67145 = sub64(partitionsPerWindow_39354, (int64_t) 1);
            int64_t segmap_tblock_sizze_69878;
            
            segmap_tblock_sizze_69878 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_69671;
            
            int64_t zeze_rhs_67414 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, (int64_t) 1);
            int64_t segmap_tblock_sizze_70252;
            
            segmap_tblock_sizze_70252 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70088;
            
            int64_t segmap_usable_groups_70253 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_70252);
            bool loop_cond_67569 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
            bool protect_cond_conj_68543 = y_67015 && loop_cond_68538;
            int64_t bytes_77922 = (int64_t) 2 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001;
            int64_t ext_78076;
            int64_t ext_78075;
            int64_t ext_78073;
            int64_t ext_78072;
            
            if (cond_67022) {
                if (protect_cond_conj_68543) {
                    if (memblock_alloc_device(ctx, &mem_77908, (int64_t) 2, "mem_77908")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78762(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_67004, tS_mem_77626.mem, mem_77908.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77908, "mem_77908") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77907, (int64_t) 2, "mem_77907")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_77907, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77909, &mem_77907, "mem_77907") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77916, (int64_t) 2, "mem_77916")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77917, (int64_t) 2, "mem_77917")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77920, (int64_t) 1, "mem_77920")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_78069;
                int64_t ext_78068;
                int64_t ext_78067;
                int64_t ext_78066;
                bool defunc_0_find_joinTuples_res_68550;
                int64_t defunc_0_find_joinTuples_res_68551;
                bool loop_while_68554;
                int64_t p_68555;
                int64_t ctx_param_ext_77910;
                int64_t ctx_param_ext_77911;
                int64_t ctx_param_ext_77913;
                int64_t ctx_param_ext_77914;
                
                if (memblock_set_device(ctx, &mem_param_77912, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77915, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77910 = (int64_t) 0;
                ctx_param_ext_77911 = (int64_t) 1;
                ctx_param_ext_77913 = (int64_t) 0;
                ctx_param_ext_77914 = (int64_t) 1;
                loop_while_68554 = loop_cond_68538;
                p_68555 = (int64_t) 0;
                while (loop_while_68554) {
                    int64_t start_68558 = mul64(extParallelism_39356, p_68555);
                    int64_t min_arg1_68559 = sub64(nR_39348, start_68558);
                    int64_t min_res_68560 = smin64(extParallelism_39356, min_arg1_68559);
                    int64_t iter_R_68561 = add64(start_68558, min_res_68560);
                    bool empty_slice_68562 = min_res_68560 == (int64_t) 0;
                    int64_t m_68563 = sub64(min_res_68560, (int64_t) 1);
                    int64_t i_p_m_t_s_68564 = add64(start_68558, m_68563);
                    bool zzero_leq_i_p_m_t_s_68565 = sle64((int64_t) 0, i_p_m_t_s_68564);
                    bool i_p_m_t_s_leq_w_68566 = slt64(i_p_m_t_s_68564, nR_39348);
                    bool zzero_lte_i_68567 = sle64((int64_t) 0, start_68558);
                    bool i_lte_j_68568 = sle64(start_68558, iter_R_68561);
                    bool y_68569 = i_p_m_t_s_leq_w_68566 && zzero_lte_i_68567;
                    bool y_68570 = zzero_leq_i_p_m_t_s_68565 && y_68569;
                    bool forwards_ok_68571 = i_lte_j_68568 && y_68570;
                    bool ok_or_empty_68572 = empty_slice_68562 || forwards_ok_68571;
                    bool index_certs_68573;
                    
                    if (!ok_or_empty_68572) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_68558, ":", (long long) iter_R_68561, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68574 = slt64(m_68563, min_res_68560);
                    bool x_68575 = sle64((int64_t) 0, m_68563);
                    bool bounds_check_68576 = y_68574 && x_68575;
                    bool index_certs_68577;
                    
                    if (!bounds_check_68576) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_68563, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_68580 = slt64((int64_t) 0, min_res_68560);
                    bool index_certs_68581;
                    
                    if (!y_68580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_68560, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78778(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_68558, i_p_m_t_s_68564, tR_mem_77625.mem, mem_77916.mem, mem_77917.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77918, &ext_mem_77909, "ext_mem_77909") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77918, &mem_77916, "mem_77916") != 0)
                        return 1;
                    if (y_67015) {
                        if (memblock_set_device(ctx, &ext_mem_77919, &mem_77641, "mem_77641") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_77919, &mem_77917, "mem_77917") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78784(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77917.mem, ext_mem_77918.mem, mem_77920.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
                        return 1;
                    
                    bool read_res_79608;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79608, mem_77920.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_68583 = read_res_79608;
                    int64_t ext_78064;
                    int64_t ext_78063;
                    int64_t ext_78061;
                    int64_t ext_78060;
                    int64_t loopres_68585;
                    
                    if (defunc_0_gt_res_68583) {
                        if (memblock_set_device(ctx, &ext_mem_78065, &mem_param_77912, "mem_param_77912") != 0)
                            return 1;
                        ext_78064 = ctx_param_ext_77910;
                        ext_78063 = ctx_param_ext_77911;
                        if (memblock_set_device(ctx, &ext_mem_78062, &mem_param_77915, "mem_param_77915") != 0)
                            return 1;
                        ext_78061 = ctx_param_ext_77913;
                        ext_78060 = ctx_param_ext_77914;
                        loopres_68585 = numIter_68537;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77921, (int64_t) 1, "mem_77921")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_shortzigpuseq_78790(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77916.mem, ext_mem_77919.mem, mem_77921.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_79609;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79609, mem_77921.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_68589 = read_res_79609;
                        
                        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
                            return 1;
                        
                        int64_t ext_78058;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78058 = ctx_param_ext_77910;
                        } else {
                            ext_78058 = (int64_t) 0;
                        }
                        
                        int64_t ext_78057;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78057 = ctx_param_ext_77911;
                        } else {
                            ext_78057 = (int64_t) 1;
                        }
                        
                        int64_t ext_78055;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78055 = ctx_param_ext_77913;
                        } else {
                            ext_78055 = (int64_t) 0;
                        }
                        
                        int64_t ext_78054;
                        
                        if (defunc_0_gt_res_68589) {
                            ext_78054 = ctx_param_ext_77914;
                        } else {
                            ext_78054 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_68590;
                        
                        if (defunc_0_gt_res_68589) {
                            int64_t tmp_68594 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_param_77912, "mem_param_77912") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_param_77915, "mem_param_77915") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68594;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_77923, bytes_77922, "mem_77923")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_77923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, tS_start_66998, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_9601(ctx, &ext_mem_77925, mem_77923, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, join_chunks_arg3_67139) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
                                return 1;
                            
                            bool suff_outer_par_69493;
                            
                            suff_outer_par_69493 = *ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_0 <= min_res_68560;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_short.suff_outer_par_0", (long) min_res_68560, suff_outer_par_69493 ? "true" : "false");
                            
                            int64_t tile_sizze_76414;
                            
                            tile_sizze_76414 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413;
                            
                            int64_t tile_sizze_76059;
                            
                            tile_sizze_76059 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058;
                            
                            int64_t num_whole_tiles_76430 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            int64_t residual_input_76654 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76414);
                            bool cond_76655 = residual_input_76654 == (int64_t) 0;
                            int64_t binop_x_76671 = tile_sizze_76414 * num_whole_tiles_76430;
                            int64_t bytes_77983 = (int64_t) 8 * min_res_68560;
                            int64_t bytes_77946 = (int64_t) 8 * tile_sizze_76414;
                            int64_t bytes_77948 = (int64_t) 2 * tile_sizze_76414;
                            int64_t num_whole_tiles_76075 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            int64_t residual_input_76299 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, tile_sizze_76059);
                            bool cond_76300 = residual_input_76299 == (int64_t) 0;
                            int64_t binop_x_76316 = tile_sizze_76059 * num_whole_tiles_76075;
                            int64_t bytes_78007 = (int64_t) 8 * tile_sizze_76059;
                            int64_t bytes_78009 = (int64_t) 2 * tile_sizze_76059;
                            int64_t shared_memory_capacity_78848;
                            
                            shared_memory_capacity_78848 = ctx->max_shared_memory;
                            if (suff_outer_par_69493 && sle64(sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78009, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_78007, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_78848)) {
                                int64_t ldim_76060 = sdiv_up64(min_res_68560, tile_sizze_76059);
                                
                                if (memblock_alloc_device(ctx, &mem_78045, bytes_77983, "mem_78045")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_78047, bytes_77983, "mem_78047")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78796 = sext_i64_i32(sdiv_up64(tile_sizze_76059, tile_sizze_76059));
                                int32_t virt_num_tblocks_78797 = sext_i64_i32(ldim_76060);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76057(ctx, ldim_76060, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76058, 1, 1, bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8) + (bytes_78009 + srem64((int64_t) 8 - srem64(bytes_78009, (int64_t) 8), (int64_t) 8)) + (bytes_78007 + srem64((int64_t) 8 - srem64(bytes_78007, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76060, num_whole_tiles_76075, residual_input_76299, cond_76300, binop_x_76316, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_78045.mem, mem_78047.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_78045, "mem_78045") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_78047, "mem_78047") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_76415 = sdiv_up64(min_res_68560, tile_sizze_76414);
                                
                                if (memblock_alloc_device(ctx, &mem_77984, bytes_77983, "mem_77984")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_77986, bytes_77983, "mem_77986")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_78822 = sext_i64_i32(sdiv_up64(tile_sizze_76414, tile_sizze_76414));
                                int32_t virt_num_tblocks_78823 = sext_i64_i32(ldim_76415);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76412(ctx, ldim_76415, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76413, 1, 1, bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8) + (bytes_77948 + srem64((int64_t) 8 - srem64(bytes_77948, (int64_t) 8), (int64_t) 8)) + (bytes_77946 + srem64((int64_t) 8 - srem64(bytes_77946, (int64_t) 8), (int64_t) 8)), tS_start_66998, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_67001, start_68558, min_res_68560, ldim_76415, num_whole_tiles_76430, residual_input_76654, cond_76655, binop_x_76671, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77925.mem, mem_77984.mem, mem_77986.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_78049, &mem_77984, "mem_77984") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_78048, &mem_77986, "mem_77986") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78051, bytes_77628, "mem_78051")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77915.mem, ctx_param_ext_77913, (int64_t []) {ctx_param_ext_77914}, (int64_t []) {nR_39348})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78051.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78049.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_78053, bytes_77628, "mem_78053")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77912.mem, ctx_param_ext_77910, (int64_t []) {ctx_param_ext_77911}, (int64_t []) {nR_39348})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78053.mem, start_68558, (int64_t []) {(int64_t) 1}, ext_mem_78048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_68560})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
                                return 1;
                            
                            int64_t tmp_68646 = add64((int64_t) 1, p_68555);
                            
                            if (memblock_set_device(ctx, &ext_mem_78059, &mem_78053, "mem_78053") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_78056, &mem_78051, "mem_78051") != 0)
                                return 1;
                            loopres_f_res_68590 = tmp_68646;
                        }
                        if (memblock_set_device(ctx, &ext_mem_78065, &ext_mem_78059, "ext_mem_78059") != 0)
                            return 1;
                        ext_78064 = ext_78058;
                        ext_78063 = ext_78057;
                        if (memblock_set_device(ctx, &ext_mem_78062, &ext_mem_78056, "ext_mem_78056") != 0)
                            return 1;
                        ext_78061 = ext_78055;
                        ext_78060 = ext_78054;
                        loopres_68585 = loopres_f_res_68590;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
                        return 1;
                    
                    bool loop_cond_68647 = slt64(loopres_68585, numIter_68537);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78768, &ext_mem_78065, "ext_mem_78065") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78769, &ext_mem_78062, "ext_mem_78062") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78770 = ext_78064;
                    int64_t ctx_param_ext_tmp_78771 = ext_78063;
                    int64_t ctx_param_ext_tmp_78772 = ext_78061;
                    int64_t ctx_param_ext_tmp_78773 = ext_78060;
                    bool loop_while_tmp_78774 = loop_cond_68647;
                    int64_t p_tmp_78775 = loopres_68585;
                    
                    if (memblock_set_device(ctx, &mem_param_77912, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77915, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
                        return 1;
                    ctx_param_ext_77910 = ctx_param_ext_tmp_78770;
                    ctx_param_ext_77911 = ctx_param_ext_tmp_78771;
                    ctx_param_ext_77913 = ctx_param_ext_tmp_78772;
                    ctx_param_ext_77914 = ctx_param_ext_tmp_78773;
                    loop_while_68554 = loop_while_tmp_78774;
                    p_68555 = p_tmp_78775;
                }
                if (memblock_set_device(ctx, &ext_mem_78071, &mem_param_77912, "mem_param_77912") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78070, &mem_param_77915, "mem_param_77915") != 0)
                    return 1;
                ext_78069 = ctx_param_ext_77910;
                ext_78068 = ctx_param_ext_77911;
                ext_78067 = ctx_param_ext_77913;
                ext_78066 = ctx_param_ext_77914;
                defunc_0_find_joinTuples_res_68550 = loop_while_68554;
                defunc_0_find_joinTuples_res_68551 = p_68555;
                if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_78071, "ext_mem_78071") != 0)
                    return 1;
                ext_78076 = ext_78069;
                ext_78075 = ext_78068;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_78070, "ext_mem_78070") != 0)
                    return 1;
                ext_78073 = ext_78067;
                ext_78072 = ext_78066;
            } else {
                if (memblock_alloc_device(ctx, &mem_77644, bytes_77643, "mem_77644")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77644, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_39348) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77646, bytes_77643, "mem_77646")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_77646, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, nR_39348) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77648, (int64_t) 2, "mem_77648")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78849(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_77625.mem, mem_77648.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77648, "mem_77648") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77647, (int64_t) 2, "mem_77647")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_77647, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77649, &mem_77647, "mem_77647") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_77650, (int64_t) 1, "mem_77650")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_shortzigpuseq_78855(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77641.mem, ext_mem_77649.mem, mem_77650.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
                    return 1;
                if (loop_cond_67143) {
                    if (memblock_alloc_device(ctx, &mem_77652, (int64_t) 2, "mem_77652")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78861(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_39348, y_67146, tR_mem_77625.mem, mem_77641.mem, mem_77650.mem, mem_77652.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77652, "mem_77652") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_77651, (int64_t) 2, "mem_77651")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_77651, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_77653, &mem_77651, "mem_77651") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_67161;
                int64_t defunc_0_windowed_partitionFunc_res_67162;
                bool loop_while_67165;
                int64_t p_67166;
                
                loop_while_67165 = loop_cond_67143;
                p_67166 = (int64_t) 0;
                while (loop_while_67165) {
                    int64_t start_67169 = mul64(partitionsPerWindow_39354, p_67166);
                    int64_t end_67170 = add64(partitionsPerWindow_39354, start_67169);
                    int64_t max_res_67171 = smax64((int64_t) 1, start_67169);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172 = sub64(end_67170, max_res_67171);
                    bool bounds_invalid_upwards_67173 = slt64(end_67170, max_res_67171);
                    bool valid_67174 = !bounds_invalid_upwards_67173;
                    bool range_valid_c_67175;
                    
                    if (!valid_67174) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_67171, "..<", (long long) end_67170, " is invalid.", "-> #0  ftsort.fut:288:43-68\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_67178 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140 == (int64_t) 0;
                    bool nonzzero_67179 = !zzero_67178;
                    bool nonzzero_cert_67180;
                    
                    if (!nonzzero_67179) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:291:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:290:8-350:8\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_77661 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool cond_67381 = slt64((int64_t) 0, start_67169);
                    int64_t conc_tmp_67382 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    int64_t ret_67383;
                    
                    if (cond_67381) {
                        ret_67383 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    } else {
                        ret_67383 = conc_tmp_67382;
                    }
                    
                    bool eq_x_y_67391 = partitionsPerWindow_39354 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                    bool eq_x_zz_67392 = partitionsPerWindow_39354 == conc_tmp_67382;
                    bool p_and_eq_x_y_67393 = cond_67381 && eq_x_y_67391;
                    bool not_p_67394 = !cond_67381;
                    bool p_and_eq_x_y_67395 = eq_x_zz_67392 && not_p_67394;
                    bool dim_match_67396 = p_and_eq_x_y_67393 || p_and_eq_x_y_67395;
                    bool empty_or_match_cert_67397;
                    
                    if (!dim_match_67396) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_67383, "] cannot match shape of type `[", (long long) partitionsPerWindow_39354, "](i64, i64)`.", "-> #0  ftsort.fut:352:5-357:49\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_67399 = add64(m_67145, start_67169);
                    bool zzero_leq_i_p_m_t_s_67400 = sle64((int64_t) 0, i_p_m_t_s_67399);
                    bool i_p_m_t_s_leq_w_67401 = slt64(i_p_m_t_s_67399, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool zzero_lte_i_67402 = sle64((int64_t) 0, start_67169);
                    bool i_lte_j_67403 = sle64(start_67169, end_67170);
                    bool y_67404 = i_p_m_t_s_leq_w_67401 && zzero_lte_i_67402;
                    bool y_67405 = zzero_leq_i_p_m_t_s_67400 && y_67404;
                    bool forwards_ok_67406 = i_lte_j_67403 && y_67405;
                    bool ok_or_empty_67407 = empty_slice_67144 || forwards_ok_67406;
                    bool index_certs_67408;
                    
                    if (!ok_or_empty_67407) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67169, ":", (long long) end_67170, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:109:37-74\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_67177 = add64(nR_39348, nR_39348);
                    int64_t segmap_usable_groups_69879 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_69878);
                    
                    if (memblock_alloc_device(ctx, &mem_77662, bytes_77661, "mem_77662")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_77664, bytes_77661, "mem_77664")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_78871 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, segmap_tblock_sizze_69878));
                    
                    {
                        err = gpu_kernel_inner_SMJ_shortzisegmap_69883(ctx, segmap_usable_groups_69879, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_69671, 1, 1, (int64_t) 0, nR_39348, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, max_res_67171, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172, zt_rhs_67177, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77653.mem, mem_77662.mem, mem_77664.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_77666 = (int64_t) 8 * ret_67383;
                    
                    if (cond_67381) {
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77662, "mem_77662") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77664, "mem_77664") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_77669, bytes_77666, "mem_77669")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_77669, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_77667, bytes_77666, "mem_77667")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_78892 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77667.mem, tmp_offs_78892, (int64_t []) {(int64_t) 1}, mem_77662.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78892 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        
                        int64_t tmp_offs_78893 = (int64_t) 0;
                        
                        if (!(tmp_offs_78893 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77669.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_78893 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77669.mem, tmp_offs_78893, (int64_t []) {(int64_t) 1}, mem_77664.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172})) != 0)
                            goto cleanup;
                        tmp_offs_78893 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_67172;
                        if (memblock_set_device(ctx, &ext_mem_77671, &mem_77667, "mem_77667") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77670, &mem_77669, "mem_77669") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
                        return 1;
                    
                    int64_t tmp_67398 = add64((int64_t) 1, p_67166);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77644.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77671.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77646.mem, start_67169, (int64_t []) {(int64_t) 1}, ext_mem_77670.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_67383})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
                        return 1;
                    
                    bool loop_cond_67411 = slt64(tmp_67398, numberOfWindows_39355);
                    bool loop_while_tmp_78867 = loop_cond_67411;
                    int64_t p_tmp_78868 = tmp_67398;
                    
                    loop_while_67165 = loop_while_tmp_78867;
                    p_67166 = p_tmp_78868;
                }
                defunc_0_windowed_partitionFunc_res_67161 = loop_while_67165;
                defunc_0_windowed_partitionFunc_res_67162 = p_67166;
                if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_77680, bytes_77643, "mem_77680")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_77682, bytes_77643, "mem_77682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_78894 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, segmap_tblock_sizze_70252));
                
                {
                    err = gpu_kernel_inner_SMJ_shortzisegmap_70257(ctx, segmap_usable_groups_70253, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70088, 1, 1, (int64_t) 0, nR_39348, gt_rhs_66981, tS_start_66998, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, zeze_rhs_67414, tR_mem_77625.mem, tS_mem_77626.mem, mem_77644.mem, mem_77646.mem, mem_77680.mem, mem_77682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_77904;
                int64_t ext_77903;
                int64_t ext_77902;
                int64_t ext_77901;
                bool defunc_0_join_chunks_res_67570;
                int64_t defunc_0_join_chunks_res_67571;
                bool loop_while_67574;
                int64_t p_67575;
                int64_t ctx_param_ext_77683;
                int64_t ctx_param_ext_77684;
                int64_t ctx_param_ext_77686;
                int64_t ctx_param_ext_77687;
                
                if (memblock_set_device(ctx, &mem_param_77685, &mem_77631, "mem_77631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_77688, &mem_77629, "mem_77629") != 0)
                    return 1;
                ctx_param_ext_77683 = (int64_t) 0;
                ctx_param_ext_77684 = (int64_t) 1;
                ctx_param_ext_77686 = (int64_t) 0;
                ctx_param_ext_77687 = (int64_t) 1;
                loop_while_67574 = loop_cond_67569;
                p_67575 = (int64_t) 0;
                while (loop_while_67574) {
                    bool x_67578 = sle64((int64_t) 0, p_67575);
                    bool y_67579 = slt64(p_67575, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67580 = x_67578 && y_67579;
                    bool index_certs_67581;
                    
                    if (!bounds_check_67580) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:187:22-34\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_79610;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79610, mem_77680.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67582 = read_res_79610;
                    int64_t read_res_79611;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_79611, mem_77682.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_67583 = read_res_79611;
                    int64_t min_res_67584 = smin64(zeze_rhs_67414, loopres_67583);
                    bool cond_67585 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, loopres_67582);
                    bool cond_67589 = slt64(min_res_67584, (int64_t) 0);
                    bool protect_assert_disj_67591 = bounds_check_67580 || cond_67589;
                    bool protect_assert_disj_78297 = cond_67585 || protect_assert_disj_67591;
                    bool index_certs_67592;
                    
                    if (!protect_assert_disj_78297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_67575, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:191:19-32\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_67595 = add64((int64_t) 1, p_67575);
                    bool cond_67596 = zeze_lhs_67595 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    bool x_67598 = sle64((int64_t) 0, zeze_lhs_67595);
                    bool y_67599 = slt64(zeze_lhs_67595, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    bool bounds_check_67600 = x_67598 && y_67599;
                    bool protect_assert_disj_67601 = cond_67596 || bounds_check_67600;
                    bool protect_assert_disj_67602 = cond_67589 || protect_assert_disj_67601;
                    bool protect_assert_disj_78300 = cond_67585 || protect_assert_disj_67602;
                    bool index_certs_67603;
                    
                    if (!protect_assert_disj_78300) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67595, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:192:49-64\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_78294 = !cond_67585;
                    bool x_67590 = !cond_67589;
                    bool protect_cond_conj_78298 = x_67590 && x_78294;
                    int64_t loopres_f_res_f_res_67593;
                    
                    if (protect_cond_conj_78298) {
                        int64_t read_res_79612;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79612, mem_77644.mem, p_67575 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68863 = read_res_79612;
                        
                        loopres_f_res_f_res_67593 = x_68863;
                    } else {
                        loopres_f_res_f_res_67593 = (int64_t) 0;
                    }
                    
                    bool x_67597 = !cond_67596;
                    bool protect_cond_conj_67604 = x_67590 && x_67597;
                    bool protect_cond_conj_78301 = protect_cond_conj_67604 && x_78294;
                    int64_t r_end_f_res_67605;
                    
                    if (protect_cond_conj_78301) {
                        int64_t read_res_79613;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_79613, mem_77644.mem, zeze_lhs_67595 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_68864 = read_res_79613;
                        
                        r_end_f_res_67605 = x_68864;
                    } else {
                        r_end_f_res_67605 = (int64_t) 0;
                    }
                    
                    int64_t r_end_67607;
                    
                    if (cond_67596) {
                        r_end_67607 = nR_39348;
                    } else {
                        r_end_67607 = r_end_f_res_67605;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 = sub64(r_end_67607, loopres_f_res_f_res_67593);
                    int64_t ext_77893;
                    
                    if (cond_67589) {
                        ext_77893 = ctx_param_ext_77683;
                    } else {
                        ext_77893 = (int64_t) 0;
                    }
                    
                    int64_t ext_77892;
                    
                    if (cond_67589) {
                        ext_77892 = ctx_param_ext_77684;
                    } else {
                        ext_77892 = (int64_t) 1;
                    }
                    
                    int64_t ext_77890;
                    
                    if (cond_67589) {
                        ext_77890 = ctx_param_ext_77686;
                    } else {
                        ext_77890 = (int64_t) 0;
                    }
                    
                    int64_t ext_77889;
                    
                    if (cond_67589) {
                        ext_77889 = ctx_param_ext_77687;
                    } else {
                        ext_77889 = (int64_t) 1;
                    }
                    
                    int64_t bytes_77689 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608;
                    int64_t ext_77899;
                    
                    if (cond_67585) {
                        ext_77899 = ctx_param_ext_77683;
                    } else {
                        ext_77899 = ext_77893;
                    }
                    
                    int64_t ext_77898;
                    
                    if (cond_67585) {
                        ext_77898 = ctx_param_ext_77684;
                    } else {
                        ext_77898 = ext_77892;
                    }
                    
                    int64_t ext_77896;
                    
                    if (cond_67585) {
                        ext_77896 = ctx_param_ext_77686;
                    } else {
                        ext_77896 = ext_77890;
                    }
                    
                    int64_t ext_77895;
                    
                    if (cond_67585) {
                        ext_77895 = ctx_param_ext_77687;
                    } else {
                        ext_77895 = ext_77889;
                    }
                    
                    int64_t loopres_67586;
                    
                    if (cond_67585) {
                        loopres_67586 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                    } else {
                        loopres_67586 = zeze_lhs_67595;
                    }
                    if (cond_67585) {
                        if (memblock_set_device(ctx, &ext_mem_77900, &mem_param_77685, "mem_param_77685") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &mem_param_77688, "mem_param_77688") != 0)
                            return 1;
                    } else {
                        if (cond_67589) {
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_param_77685, "mem_param_77685") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_param_77688, "mem_param_77688") != 0)
                                return 1;
                        } else {
                            bool empty_slice_67611 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608 == (int64_t) 0;
                            int64_t m_67612 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 1);
                            int64_t i_p_m_t_s_67613 = add64(loopres_f_res_f_res_67593, m_67612);
                            bool zzero_leq_i_p_m_t_s_67614 = sle64((int64_t) 0, i_p_m_t_s_67613);
                            bool i_p_m_t_s_leq_w_67615 = slt64(i_p_m_t_s_67613, nR_39348);
                            bool zzero_lte_i_67616 = sle64((int64_t) 0, loopres_f_res_f_res_67593);
                            bool i_lte_j_67617 = sle64(loopres_f_res_f_res_67593, r_end_67607);
                            bool y_67618 = i_p_m_t_s_leq_w_67615 && zzero_lte_i_67616;
                            bool y_67619 = zzero_leq_i_p_m_t_s_67614 && y_67618;
                            bool forwards_ok_67620 = i_lte_j_67617 && y_67619;
                            bool ok_or_empty_67621 = empty_slice_67611 || forwards_ok_67620;
                            bool index_certs_67622;
                            
                            if (!ok_or_empty_67621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_67593, ":", (long long) r_end_67607, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftSMJ.fut:193:16-33\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_67625 = sle64(loopres_67582, min_res_67584);
                            bool loop_not_taken_67630 = !loop_cond_67625;
                            bool protect_assert_disj_67631 = loop_not_taken_67630 || nonzzero_68535;
                            bool nonzzero_cert_67632;
                            
                            if (!protect_assert_disj_67631) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:48:39-55\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77690, bytes_77689, "mem_77690")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77692, bytes_77689, "mem_77692")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_77692, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_67626 = add64(extParallelism_39356, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                            int64_t zs_lhs_67627 = sub64(zm_lhs_67626, (int64_t) 1);
                            int64_t numIter_67633 = sdiv_safe64(zs_lhs_67627, extParallelism_39356);
                            bool loop_cond_67634 = slt64((int64_t) 0, numIter_67633);
                            bool loop_not_taken_67635 = !loop_cond_67634;
                            int64_t segmap_tblock_sizze_70605;
                            
                            segmap_tblock_sizze_70605 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70595;
                            
                            int64_t segmap_usable_groups_70606 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70605);
                            int64_t segmap_tblock_sizze_70626;
                            
                            segmap_tblock_sizze_70626 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70617;
                            
                            int64_t segmap_usable_groups_70627 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70626);
                            
                            if (memblock_alloc_device(ctx, &mem_77711, (int64_t) 2, "mem_77711")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77712, (int64_t) 2, "mem_77712")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_77715, (int64_t) 1, "mem_77715")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_67636;
                            int64_t loopres_f_res_f_res_67637;
                            bool loop_while_67640;
                            int64_t dp_67641;
                            
                            if (memblock_set_device(ctx, &mem_param_77695, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_77698, &mem_77690, "mem_77690") != 0)
                                return 1;
                            loop_while_67640 = loop_cond_67625;
                            dp_67641 = loopres_67582;
                            while (loop_while_67640) {
                                bool x_67644 = sle64((int64_t) 0, dp_67641);
                                bool y_67645 = slt64(dp_67641, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67646 = x_67644 && y_67645;
                                bool index_certs_67647;
                                
                                if (!bounds_check_67646) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_67641, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:197:21-38\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_79614;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_79614, mem_77646.mem, dp_67641 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_67648 = read_res_79614;
                                int64_t zeze_lhs_67649 = add64((int64_t) 1, dp_67641);
                                bool cond_67650 = zeze_lhs_67649 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140;
                                bool x_67651 = !cond_67650;
                                bool x_67652 = sle64((int64_t) 0, zeze_lhs_67649);
                                bool y_67653 = slt64(zeze_lhs_67649, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                                bool bounds_check_67654 = x_67652 && y_67653;
                                bool protect_assert_disj_67655 = cond_67650 || bounds_check_67654;
                                bool index_certs_67656;
                                
                                if (!protect_assert_disj_67655) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_67649, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140, "].", "-> #0  ftSMJ.fut:198:55-74\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_67657;
                                
                                if (x_67651) {
                                    int64_t read_res_79615;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79615, mem_77646.mem, zeze_lhs_67649 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_68865 = read_res_79615;
                                    
                                    s_end_f_res_67657 = x_68865;
                                } else {
                                    s_end_f_res_67657 = (int64_t) 0;
                                }
                                
                                int64_t s_end_67659;
                                
                                if (cond_67650) {
                                    s_end_67659 = nR_39348;
                                } else {
                                    s_end_67659 = s_end_f_res_67657;
                                }
                                
                                int64_t j_m_i_67660 = sub64(s_end_67659, loopres_67648);
                                bool empty_slice_67661 = j_m_i_67660 == (int64_t) 0;
                                int64_t m_67662 = sub64(j_m_i_67660, (int64_t) 1);
                                int64_t i_p_m_t_s_67663 = add64(loopres_67648, m_67662);
                                bool zzero_leq_i_p_m_t_s_67664 = sle64((int64_t) 0, i_p_m_t_s_67663);
                                bool i_p_m_t_s_leq_w_67665 = slt64(i_p_m_t_s_67663, nR_39348);
                                bool zzero_lte_i_67666 = sle64((int64_t) 0, loopres_67648);
                                bool i_lte_j_67667 = sle64(loopres_67648, s_end_67659);
                                bool y_67668 = i_p_m_t_s_leq_w_67665 && zzero_lte_i_67666;
                                bool y_67669 = zzero_leq_i_p_m_t_s_67664 && y_67668;
                                bool forwards_ok_67670 = i_lte_j_67667 && y_67669;
                                bool ok_or_empty_67671 = empty_slice_67661 || forwards_ok_67670;
                                bool index_certs_67672;
                                
                                if (!ok_or_empty_67671) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_67648, ":", (long long) s_end_67659, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  ftSMJ.fut:199:18-35\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_67675 = slt64((int64_t) 0, j_m_i_67660);
                                bool loop_not_taken_67676 = !cond_67675;
                                bool x_67677 = sle64((int64_t) 0, m_67662);
                                bool y_67678 = slt64(m_67662, j_m_i_67660);
                                bool bounds_check_67682 = x_67677 && y_67678;
                                bool protect_assert_disj_67683 = loop_not_taken_67676 || bounds_check_67682;
                                bool protect_assert_disj_67684 = loop_not_taken_67635 || protect_assert_disj_67683;
                                bool index_certs_67685;
                                
                                if (!protect_assert_disj_67684) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67662, "] out of bounds for array of shape [", (long long) j_m_i_67660, "].", "-> #0  ftSMJ.fut:60:34-42\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_68069 = tS_start_66998 + loopres_67648;
                                int64_t find_joinTuples_arg3_67674 = add64(join_chunks_arg3_67139, loopres_67648);
                                bool protect_cond_conj_67679 = loop_cond_67634 && cond_67675;
                                
                                if (protect_cond_conj_67679) {
                                    if (memblock_alloc_device(ctx, &mem_77700, (int64_t) 2, "mem_77700")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78923(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68069, tS_mem_77626.mem, mem_77700.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77700, "mem_77700") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77699, (int64_t) 2, "mem_77699")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i16(ctx, mem_77699, (int64_t) 1, (int16_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77701, &mem_77699, "mem_77699") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_67679) {
                                    int64_t slice_68867 = tS_start_66998 + i_p_m_t_s_67663;
                                    
                                    if (memblock_alloc_device(ctx, &mem_77703, (int64_t) 2, "mem_77703")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78929(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_68867, tS_mem_77626.mem, mem_77703.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77703, "mem_77703") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_77702, (int64_t) 2, "mem_77702")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i16(ctx, mem_77702, (int64_t) 1, (int16_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_77704, &mem_77702, "mem_77702") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_77717 = (int64_t) 2 * j_m_i_67660;
                                int64_t ext_77864;
                                int64_t ext_77863;
                                int64_t ext_77862;
                                int64_t ext_77861;
                                bool defunc_0_find_joinTuples_res_67688;
                                int64_t defunc_0_find_joinTuples_res_67689;
                                bool loop_while_67692;
                                int64_t p_67693;
                                int64_t ctx_param_ext_77705;
                                int64_t ctx_param_ext_77706;
                                int64_t ctx_param_ext_77708;
                                int64_t ctx_param_ext_77709;
                                
                                if (memblock_set_device(ctx, &mem_param_77707, &mem_77692, "mem_77692") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77710, &mem_77690, "mem_77690") != 0)
                                    return 1;
                                ctx_param_ext_77705 = (int64_t) 0;
                                ctx_param_ext_77706 = (int64_t) 1;
                                ctx_param_ext_77708 = (int64_t) 0;
                                ctx_param_ext_77709 = (int64_t) 1;
                                loop_while_67692 = loop_cond_67634;
                                p_67693 = (int64_t) 0;
                                while (loop_while_67692) {
                                    int64_t start_67696 = mul64(extParallelism_39356, p_67693);
                                    int64_t min_arg1_67697 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, start_67696);
                                    int64_t min_res_67698 = smin64(extParallelism_39356, min_arg1_67697);
                                    int64_t iter_R_67699 = add64(start_67696, min_res_67698);
                                    bool empty_slice_67700 = min_res_67698 == (int64_t) 0;
                                    int64_t m_67701 = sub64(min_res_67698, (int64_t) 1);
                                    int64_t i_p_m_t_s_67702 = add64(start_67696, m_67701);
                                    bool zzero_leq_i_p_m_t_s_67703 = sle64((int64_t) 0, i_p_m_t_s_67702);
                                    bool i_p_m_t_s_leq_w_67704 = slt64(i_p_m_t_s_67702, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608);
                                    bool zzero_lte_i_67705 = sle64((int64_t) 0, start_67696);
                                    bool i_lte_j_67706 = sle64(start_67696, iter_R_67699);
                                    bool y_67707 = i_p_m_t_s_leq_w_67704 && zzero_lte_i_67705;
                                    bool y_67708 = zzero_leq_i_p_m_t_s_67703 && y_67707;
                                    bool forwards_ok_67709 = i_lte_j_67706 && y_67708;
                                    bool ok_or_empty_67710 = empty_slice_67700 || forwards_ok_67709;
                                    bool index_certs_67711;
                                    
                                    if (!ok_or_empty_67710) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_67696, ":", (long long) iter_R_67699, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, "].", "-> #0  ftSMJ.fut:55:20-49\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67718 = slt64(m_67701, min_res_67698);
                                    bool x_67717 = sle64((int64_t) 0, m_67701);
                                    bool bounds_check_67719 = x_67717 && y_67718;
                                    bool index_certs_67720;
                                    
                                    if (!bounds_check_67719) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67701, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:58:21-40\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_67714 = slt64((int64_t) 0, min_res_67698);
                                    bool index_certs_67715;
                                    
                                    if (!y_67714) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_67698, "].", "-> #0  ftSMJ.fut:57:21-30\n   #1  ftSMJ.fut:351:133-136\n   #2  ftSMJ.fut:340:1-351:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_67712 = loopres_f_res_f_res_67593 + start_67696;
                                    int64_t slice_67721 = loopres_f_res_f_res_67593 + i_p_m_t_s_67702;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78945(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_67712, slice_67721, tR_mem_77625.mem, mem_77711.mem, mem_77712.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77713, &ext_mem_77704, "ext_mem_77704") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77713, &mem_77711, "mem_77711") != 0)
                                        return 1;
                                    if (cond_67675) {
                                        if (memblock_set_device(ctx, &ext_mem_77714, &ext_mem_77701, "ext_mem_77701") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_77714, &mem_77712, "mem_77712") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_78951(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77712.mem, ext_mem_77713.mem, mem_77715.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
                                        return 1;
                                    
                                    bool read_res_79616;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_79616, mem_77715.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_67725 = read_res_79616;
                                    int64_t ext_77859;
                                    int64_t ext_77858;
                                    int64_t ext_77856;
                                    int64_t ext_77855;
                                    int64_t loopres_67726;
                                    
                                    if (defunc_0_gt_res_67725) {
                                        if (memblock_set_device(ctx, &ext_mem_77860, &mem_param_77707, "mem_param_77707") != 0)
                                            return 1;
                                        ext_77859 = ctx_param_ext_77705;
                                        ext_77858 = ctx_param_ext_77706;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &mem_param_77710, "mem_param_77710") != 0)
                                            return 1;
                                        ext_77856 = ctx_param_ext_77708;
                                        ext_77855 = ctx_param_ext_77709;
                                        loopres_67726 = numIter_67633;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_77716, (int64_t) 1, "mem_77716")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_shortzigpuseq_78957(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_77711.mem, ext_mem_77714.mem, mem_77716.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_79617;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_79617, mem_77716.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_67729 = read_res_79617;
                                        
                                        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
                                            return 1;
                                        
                                        int64_t ext_77853;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77853 = ctx_param_ext_77705;
                                        } else {
                                            ext_77853 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77852;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77852 = ctx_param_ext_77706;
                                        } else {
                                            ext_77852 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_77850;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77850 = ctx_param_ext_77708;
                                        } else {
                                            ext_77850 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_77849;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            ext_77849 = ctx_param_ext_77709;
                                        } else {
                                            ext_77849 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_67730;
                                        
                                        if (defunc_0_gt_res_67729) {
                                            int64_t tmp_68871 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_param_77707, "mem_param_77707") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_param_77710, "mem_param_77710") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_68871;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_77718, bytes_77717, "mem_77718")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_77718.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_77626.mem, slice_68069, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67660})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_9601(ctx, &ext_mem_77720, mem_77718, j_m_i_67660, find_joinTuples_arg3_67674) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_70417;
                                            
                                            suff_outer_par_70417 = *ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_1 <= min_res_67698;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_short.suff_outer_par_1", (long) min_res_67698, suff_outer_par_70417 ? "true" : "false");
                                            
                                            int64_t tile_sizze_77124;
                                            
                                            tile_sizze_77124 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123;
                                            
                                            int64_t tile_sizze_76769;
                                            
                                            tile_sizze_76769 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768;
                                            
                                            int64_t num_whole_tiles_77140 = squot_safe64(j_m_i_67660, tile_sizze_77124);
                                            int64_t residual_input_77364 = srem_safe64(j_m_i_67660, tile_sizze_77124);
                                            bool cond_77365 = residual_input_77364 == (int64_t) 0;
                                            int64_t binop_x_77381 = tile_sizze_77124 * num_whole_tiles_77140;
                                            int64_t bytes_77778 = (int64_t) 8 * min_res_67698;
                                            int64_t bytes_77741 = (int64_t) 8 * tile_sizze_77124;
                                            int64_t bytes_77743 = (int64_t) 2 * tile_sizze_77124;
                                            int64_t num_whole_tiles_76785 = squot_safe64(j_m_i_67660, tile_sizze_76769);
                                            int64_t residual_input_77009 = srem_safe64(j_m_i_67660, tile_sizze_76769);
                                            bool cond_77010 = residual_input_77009 == (int64_t) 0;
                                            int64_t binop_x_77026 = tile_sizze_76769 * num_whole_tiles_76785;
                                            int64_t bytes_77802 = (int64_t) 8 * tile_sizze_76769;
                                            int64_t bytes_77804 = (int64_t) 2 * tile_sizze_76769;
                                            int64_t shared_memory_capacity_79015;
                                            
                                            shared_memory_capacity_79015 = ctx->max_shared_memory;
                                            if (suff_outer_par_70417 && sle64(sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77804, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_77802, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_79015)) {
                                                int64_t ldim_76770 = sdiv_up64(min_res_67698, tile_sizze_76769);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77840, bytes_77778, "mem_77840")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77842, bytes_77778, "mem_77842")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78963 = sext_i64_i32(sdiv_up64(tile_sizze_76769, tile_sizze_76769));
                                                int32_t virt_num_tblocks_78964 = sext_i64_i32(ldim_76770);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_76767(ctx, ldim_76770, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_76768, 1, 1, bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8) + (bytes_77804 + srem64((int64_t) 8 - srem64(bytes_77804, (int64_t) 8), (int64_t) 8)) + (bytes_77802 + srem64((int64_t) 8 - srem64(bytes_77802, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_76770, num_whole_tiles_76785, residual_input_77009, cond_77010, binop_x_77026, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77840.mem, mem_77842.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77840, "mem_77840") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77842, "mem_77842") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_77125 = sdiv_up64(min_res_67698, tile_sizze_77124);
                                                
                                                if (memblock_alloc_device(ctx, &mem_77779, bytes_77778, "mem_77779")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_77781, bytes_77778, "mem_77781")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_78989 = sext_i64_i32(sdiv_up64(tile_sizze_77124, tile_sizze_77124));
                                                int32_t virt_num_tblocks_78990 = sext_i64_i32(ldim_77125);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_77122(ctx, ldim_77125, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_77123, 1, 1, bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8) + (bytes_77743 + srem64((int64_t) 8 - srem64(bytes_77743, (int64_t) 8), (int64_t) 8)) + (bytes_77741 + srem64((int64_t) 8 - srem64(bytes_77741, (int64_t) 8), (int64_t) 8)), j_m_i_67660, min_res_67698, slice_67712, slice_68069, ldim_77125, num_whole_tiles_77140, residual_input_77364, cond_77365, binop_x_77381, tR_mem_77625.mem, tS_mem_77626.mem, ext_mem_77720.mem, mem_77779.mem, mem_77781.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_77844, &mem_77779, "mem_77779") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_77843, &mem_77781, "mem_77781") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77846, bytes_77689, "mem_77846")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77710.mem, ctx_param_ext_77708, (int64_t []) {ctx_param_ext_77709}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77846.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_77848, bytes_77689, "mem_77848")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77707.mem, ctx_param_ext_77705, (int64_t []) {ctx_param_ext_77706}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77848.mem, start_67696, (int64_t []) {(int64_t) 1}, ext_mem_77843.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_67698})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
                                                return 1;
                                            
                                            int64_t tmp_67777 = add64((int64_t) 1, p_67693);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_77854, &mem_77848, "mem_77848") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_77851, &mem_77846, "mem_77846") != 0)
                                                return 1;
                                            loopres_f_res_67730 = tmp_67777;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_77860, &ext_mem_77854, "ext_mem_77854") != 0)
                                            return 1;
                                        ext_77859 = ext_77853;
                                        ext_77858 = ext_77852;
                                        if (memblock_set_device(ctx, &ext_mem_77857, &ext_mem_77851, "ext_mem_77851") != 0)
                                            return 1;
                                        ext_77856 = ext_77850;
                                        ext_77855 = ext_77849;
                                        loopres_67726 = loopres_f_res_67730;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
                                        return 1;
                                    
                                    bool loop_cond_67778 = slt64(loopres_67726, numIter_67633);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_78935, &ext_mem_77860, "ext_mem_77860") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_78936, &ext_mem_77857, "ext_mem_77857") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_78937 = ext_77859;
                                    int64_t ctx_param_ext_tmp_78938 = ext_77858;
                                    int64_t ctx_param_ext_tmp_78939 = ext_77856;
                                    int64_t ctx_param_ext_tmp_78940 = ext_77855;
                                    bool loop_while_tmp_78941 = loop_cond_67778;
                                    int64_t p_tmp_78942 = loopres_67726;
                                    
                                    if (memblock_set_device(ctx, &mem_param_77707, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_77710, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
                                        return 1;
                                    ctx_param_ext_77705 = ctx_param_ext_tmp_78937;
                                    ctx_param_ext_77706 = ctx_param_ext_tmp_78938;
                                    ctx_param_ext_77708 = ctx_param_ext_tmp_78939;
                                    ctx_param_ext_77709 = ctx_param_ext_tmp_78940;
                                    loop_while_67692 = loop_while_tmp_78941;
                                    p_67693 = p_tmp_78942;
                                }
                                if (memblock_set_device(ctx, &ext_mem_77866, &mem_param_77707, "mem_param_77707") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_77865, &mem_param_77710, "mem_param_77710") != 0)
                                    return 1;
                                ext_77864 = ctx_param_ext_77705;
                                ext_77863 = ctx_param_ext_77706;
                                ext_77862 = ctx_param_ext_77708;
                                ext_77861 = ctx_param_ext_77709;
                                defunc_0_find_joinTuples_res_67688 = loop_while_67692;
                                defunc_0_find_joinTuples_res_67689 = p_67693;
                                if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77869, bytes_77689, "mem_77869")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79016 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70605));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_70609(ctx, segmap_usable_groups_70606, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70595, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77861, ext_77862, mem_param_77698.mem, ext_mem_77865.mem, mem_77869.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_77872, bytes_77689, "mem_77872")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_79025 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70626));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_70630(ctx, segmap_usable_groups_70627, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70617, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ext_77863, ext_77864, mem_param_77695.mem, ext_mem_77866.mem, mem_77872.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
                                    return 1;
                                
                                bool loop_cond_67788 = sle64(zeze_lhs_67649, min_res_67584);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_78917, &mem_77872, "mem_77872") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_78918, &mem_77869, "mem_77869") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_78919 = loop_cond_67788;
                                int64_t dp_tmp_78920 = zeze_lhs_67649;
                                
                                if (memblock_set_device(ctx, &mem_param_77695, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_77698, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
                                    return 1;
                                loop_while_67640 = loop_while_tmp_78919;
                                dp_67641 = dp_tmp_78920;
                            }
                            if (memblock_set_device(ctx, &ext_mem_77878, &mem_param_77695, "mem_param_77695") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77877, &mem_param_77698, "mem_param_77698") != 0)
                                return 1;
                            loopres_f_res_f_res_67636 = loop_while_67640;
                            loopres_f_res_f_res_67637 = dp_67641;
                            if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_70647;
                            
                            segmap_tblock_sizze_70647 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70637;
                            
                            int64_t segmap_usable_groups_70648 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70647);
                            
                            if (memblock_alloc_device(ctx, &mem_77881, bytes_77689, "mem_77881")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79034 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70647));
                            
                            {
                                err = gpu_kernel_inner_SMJ_shortzisegmap_70651(ctx, segmap_usable_groups_70648, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70637, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77686, ctx_param_ext_77687, mem_param_77688.mem, ext_mem_77877.mem, mem_77881.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_70668;
                            
                            segmap_tblock_sizze_70668 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70659;
                            
                            int64_t segmap_usable_groups_70669 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70668);
                            
                            if (memblock_alloc_device(ctx, &mem_77884, bytes_77689, "mem_77884")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_79043 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, segmap_tblock_sizze_70668));
                            
                            {
                                err = gpu_kernel_inner_SMJ_shortzisegmap_70672(ctx, segmap_usable_groups_70669, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70659, 1, 1, (int64_t) 0, loopres_f_res_f_res_67593, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608, ctx_param_ext_77683, ctx_param_ext_77684, mem_param_77685.mem, ext_mem_77878.mem, mem_77884.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77886, bytes_77628, "mem_77886")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77688.mem, ctx_param_ext_77686, (int64_t []) {ctx_param_ext_77687}, (int64_t []) {nR_39348})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77886.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77881.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_77888, bytes_77628, "mem_77888")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_77685.mem, ctx_param_ext_77683, (int64_t []) {ctx_param_ext_77684}, (int64_t []) {nR_39348})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_77888.mem, loopres_f_res_f_res_67593, (int64_t []) {(int64_t) 1}, mem_77884.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_67608})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77894, &mem_77888, "mem_77888") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_77891, &mem_77886, "mem_77886") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_77900, &ext_mem_77894, "ext_mem_77894") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_77897, &ext_mem_77891, "ext_mem_77891") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_67804 = slt64(loopres_67586, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_67140);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_78907, &ext_mem_77900, "ext_mem_77900") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_78908, &ext_mem_77897, "ext_mem_77897") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_78909 = ext_77899;
                    int64_t ctx_param_ext_tmp_78910 = ext_77898;
                    int64_t ctx_param_ext_tmp_78911 = ext_77896;
                    int64_t ctx_param_ext_tmp_78912 = ext_77895;
                    bool loop_while_tmp_78913 = loop_cond_67804;
                    int64_t p_tmp_78914 = loopres_67586;
                    
                    if (memblock_set_device(ctx, &mem_param_77685, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_77688, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
                        return 1;
                    ctx_param_ext_77683 = ctx_param_ext_tmp_78909;
                    ctx_param_ext_77684 = ctx_param_ext_tmp_78910;
                    ctx_param_ext_77686 = ctx_param_ext_tmp_78911;
                    ctx_param_ext_77687 = ctx_param_ext_tmp_78912;
                    loop_while_67574 = loop_while_tmp_78913;
                    p_67575 = p_tmp_78914;
                }
                if (memblock_set_device(ctx, &ext_mem_77906, &mem_param_77685, "mem_param_77685") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_77905, &mem_param_77688, "mem_param_77688") != 0)
                    return 1;
                ext_77904 = ctx_param_ext_77683;
                ext_77903 = ctx_param_ext_77684;
                ext_77902 = ctx_param_ext_77686;
                ext_77901 = ctx_param_ext_77687;
                defunc_0_join_chunks_res_67570 = loop_while_67574;
                defunc_0_join_chunks_res_67571 = p_67575;
                if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_78077, &ext_mem_77906, "ext_mem_77906") != 0)
                    return 1;
                ext_78076 = ext_77904;
                ext_78075 = ext_77903;
                if (memblock_set_device(ctx, &ext_mem_78074, &ext_mem_77905, "ext_mem_77905") != 0)
                    return 1;
                ext_78073 = ext_77902;
                ext_78072 = ext_77901;
            }
            
            int64_t segmap_tblock_sizze_70689;
            
            segmap_tblock_sizze_70689 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70679;
            
            int64_t segmap_usable_groups_70690 = sdiv_up64(nR_39348, segmap_tblock_sizze_70689);
            
            if (memblock_alloc_device(ctx, &mem_78080, bytes_77628, "mem_78080")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79052 = sext_i64_i32(sdiv_up64(nR_39348, segmap_tblock_sizze_70689));
            
            {
                err = gpu_kernel_inner_SMJ_shortzisegmap_70693(ctx, segmap_usable_groups_70690, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70679, 1, 1, (int64_t) 0, nR_39348, ext_78072, ext_78073, mem_param_77640.mem, ext_mem_78074.mem, mem_78080.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_70710;
            
            segmap_tblock_sizze_70710 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70701;
            
            int64_t segmap_usable_groups_70711 = sdiv_up64(nR_39348, segmap_tblock_sizze_70710);
            
            if (memblock_alloc_device(ctx, &mem_78083, bytes_77628, "mem_78083")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_79061 = sext_i64_i32(sdiv_up64(nR_39348, segmap_tblock_sizze_70710));
            
            {
                err = gpu_kernel_inner_SMJ_shortzisegmap_70714(ctx, segmap_usable_groups_70711, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70701, 1, 1, (int64_t) 0, nR_39348, ext_78075, ext_78076, mem_param_77637.mem, ext_mem_78077.mem, mem_78083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_78084, (int64_t) 1, "mem_78084")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_shortzigpuseq_79070(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_66981, i_p_m_t_s_67004, tR_mem_77625.mem, tS_mem_77626.mem, mem_78084.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_79618;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_79618, mem_78084.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_67821 = read_res_79618;
            
            if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
                return 1;
            
            int64_t nextIter_67822;
            
            if (defunc_0_leq_res_67821) {
                int64_t nextIter_t_res_68886 = add64((int64_t) 1, p_66995);
                
                nextIter_67822 = nextIter_t_res_68886;
            } else {
                nextIter_67822 = numIter_66975;
            }
            if (memblock_set_device(ctx, &ext_mem_78090, &mem_78083, "mem_78083") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_78087, &mem_78080, "mem_78080") != 0)
                return 1;
            loopres_67019 = nextIter_67822;
        }
        
        bool loop_cond_67824 = slt64(loopres_67019, numIter_66975);
        
        if (memblock_set_device(ctx, &mem_param_tmp_78750, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_78751, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        
        bool loop_while_tmp_78752 = loop_cond_67824;
        int64_t p_tmp_78753 = loopres_67019;
        
        if (memblock_set_device(ctx, &mem_param_77637, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_77640, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        loop_while_66994 = loop_while_tmp_78752;
        p_66995 = p_tmp_78753;
    }
    if (memblock_set_device(ctx, &ext_mem_78096, &mem_param_77637, "mem_param_77637") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78095, &mem_param_77640, "mem_param_77640") != 0)
        return 1;
    defunc_0_mergeJoin_res_66990 = loop_while_66994;
    defunc_0_mergeJoin_res_66991 = p_66995;
    if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_70720;
    
    segscan_tblock_sizze_70720 = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70719;
    
    int64_t num_tblocks_70722;
    int64_t max_num_tblocks_79076;
    
    max_num_tblocks_79076 = *ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_70721;
    num_tblocks_70722 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_39348, segscan_tblock_sizze_70720), max_num_tblocks_79076)));
    if (memblock_alloc_device(ctx, &mem_78099, bytes_77628, "mem_78099")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78101, bytes_77628, "mem_78101")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_39348)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79077;
        
        shared_memory_79077 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79078;
        
        thread_block_sizze_79078 = ctx->max_thread_block_size;
        
        int64_t registers_79079;
        
        registers_79079 = ctx->max_registers;
        
        int64_t thread_block_sizze_79080;
        
        thread_block_sizze_79080 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79081 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79077, thread_block_sizze_79078), (int64_t) 8), squot64(squot64(registers_79079, thread_block_sizze_79080) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79082 = sdiv_up64(nR_39348, segscan_tblock_sizze_70720 * chunk_sizze_79081);
        int64_t num_virt_threads_79083 = num_virt_blocks_79082 * segscan_tblock_sizze_70720;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79081, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79084, num_virt_blocks_79082, "status_flags_mem_79084")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79084, num_virt_blocks_79082, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79106, (int64_t) 8 * num_virt_blocks_79082, "aggregates_mem_79106")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79108, (int64_t) 8 * num_virt_blocks_79082, "incprefixes_mem_79108")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzisegscan_70725(ctx, num_tblocks_70722, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70719, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_70720), chunk_sizze_79081 * segscan_tblock_sizze_70720 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_70720), chunk_sizze_79081 * segscan_tblock_sizze_70720 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_39348, num_tblocks_70722, num_virt_blocks_79082, num_virt_threads_79083, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, status_flags_mem_79084.mem, aggregates_mem_79106.mem, incprefixes_mem_79108.mem, global_dynid_mem_79110.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_67840 = zzero_66972 || bounds_check_66984;
    bool index_certs_67841;
    
    if (!protect_assert_disj_67840) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_66981, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67842;
    
    if (nonzzero_66973) {
        int64_t read_res_79619;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79619, mem_78099.mem, gt_rhs_66981 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68889 = read_res_79619;
        
        m_f_res_67842 = x_68889;
    } else {
        m_f_res_67842 = (int64_t) 0;
    }
    
    int64_t m_67844;
    
    if (zzero_66972) {
        m_67844 = (int64_t) 0;
    } else {
        m_67844 = m_f_res_67842;
    }
    
    int64_t m_67854 = sub64(m_67844, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67856 = slt64(m_67854, nR_39348);
    bool zzero_leq_i_p_m_t_s_67855 = sle64((int64_t) 0, m_67854);
    bool y_67858 = zzero_leq_i_p_m_t_s_67855 && i_p_m_t_s_leq_w_67856;
    bool i_lte_j_67857 = sle64((int64_t) 0, m_67844);
    bool forwards_ok_67859 = i_lte_j_67857 && y_67858;
    bool eq_x_zz_67851 = (int64_t) 0 == m_f_res_67842;
    bool p_and_eq_x_y_67852 = nonzzero_66973 && eq_x_zz_67851;
    bool empty_slice_67853 = zzero_66972 || p_and_eq_x_y_67852;
    bool ok_or_empty_67860 = empty_slice_67853 || forwards_ok_67859;
    bool index_certs_67861;
    
    if (!ok_or_empty_67860) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67844, "] out of bounds for array of shape [", (long long) nR_39348, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78102 = (int64_t) 8 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78103, bytes_78102, "mem_78103")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78096.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78105, bytes_78102, "mem_78105")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78095.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78107, bytes_78102, "mem_78107")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78107.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_77627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t bytes_78108 = (int64_t) 2 * m_67844;
    
    if (memblock_alloc_device(ctx, &mem_78109, bytes_78108, "mem_78109")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78109.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_77625.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67844})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_70730;
    
    segmap_tblock_sizze_70730 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70729;
    
    int64_t num_tblocks_70732;
    int64_t max_num_tblocks_79219;
    
    max_num_tblocks_79219 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70731;
    num_tblocks_70732 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_39348, segmap_tblock_sizze_70730), max_num_tblocks_79219)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79220 = sext_i64_i32(sdiv_up64(nR_39348, segmap_tblock_sizze_70730));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_70727(ctx, num_tblocks_70732, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70729, 1, 1, (int64_t) 0, nR_39348, m_67844, num_tblocks_70732, virt_num_tblocks_79220, tR_mem_77625.mem, ext_mem_77627.mem, ext_mem_78095.mem, ext_mem_78096.mem, mem_78099.mem, mem_78101.mem, mem_78103.mem, mem_78105.mem, mem_78107.mem, mem_78109.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_70736;
    
    segscan_tblock_sizze_70736 = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70735;
    
    int64_t num_tblocks_70738;
    int64_t max_num_tblocks_79233;
    
    max_num_tblocks_79233 = *ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_70737;
    num_tblocks_70738 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segscan_tblock_sizze_70736), max_num_tblocks_79233)));
    if (memblock_alloc_device(ctx, &mem_78113, bytes_78102, "mem_78113")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78115, bytes_78102, "mem_78115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78117, bytes_78102, "mem_78117")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_67844)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_79234;
        
        shared_memory_79234 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_79235;
        
        thread_block_sizze_79235 = ctx->max_thread_block_size;
        
        int64_t registers_79236;
        
        registers_79236 = ctx->max_registers;
        
        int64_t thread_block_sizze_79237;
        
        thread_block_sizze_79237 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_79238 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_79234, thread_block_sizze_79235), (int64_t) 8), squot64(squot64(registers_79236, thread_block_sizze_79237) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_79239 = sdiv_up64(m_67844, segscan_tblock_sizze_70736 * chunk_sizze_79238);
        int64_t num_virt_threads_79240 = num_virt_blocks_79239 * segscan_tblock_sizze_70736;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_79238, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_79241, num_virt_blocks_79239, "status_flags_mem_79241")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_79241, num_virt_blocks_79239, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79243, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79243")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79245, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79245")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_79247, (int64_t) 8 * num_virt_blocks_79239, "aggregates_mem_79247")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_79249, (int64_t) 8 * num_virt_blocks_79239, "incprefixes_mem_79249")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzisegscan_70741(ctx, num_tblocks_70738, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_70735, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70736, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70736), smax64(chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70736, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70736), smax64(chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8, chunk_sizze_79238 * segscan_tblock_sizze_70736 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_67844, num_tblocks_70738, num_virt_blocks_79239, num_virt_threads_79240, mem_78103.mem, mem_78113.mem, mem_78115.mem, mem_78117.mem, status_flags_mem_79241.mem, aggregates_mem_79243.mem, incprefixes_mem_79245.mem, aggregates_mem_79247.mem, incprefixes_mem_79249.mem, global_dynid_mem_79251.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_70757;
    
    segmap_tblock_sizze_70757 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70745;
    
    int64_t segmap_usable_groups_70758 = sdiv_up64(m_67844, segmap_tblock_sizze_70757);
    
    if (memblock_alloc_device(ctx, &mem_78120, bytes_78102, "mem_78120")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79386 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_70757));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_70761(ctx, segmap_usable_groups_70758, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70745, 1, 1, (int64_t) 0, m_67844, mem_78113.mem, mem_78120.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
        return 1;
    
    bool cond_67895 = slt64((int64_t) 0, m_67844);
    bool y_67896 = slt64(m_67854, m_67844);
    bool bounds_check_67897 = zzero_leq_i_p_m_t_s_67855 && y_67896;
    bool loop_not_taken_67898 = !cond_67895;
    bool protect_assert_disj_67899 = bounds_check_67897 || loop_not_taken_67898;
    bool index_certs_67900;
    
    if (!protect_assert_disj_67899) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  ftSMJ.fut:285:10-41\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78122, (int64_t) 8, "mem_78122")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_79395(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78120.mem, mem_78122.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78122, "mem_78122") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78121, (int64_t) 8, "mem_78121")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78121, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78123, &mem_78121, "mem_78121") != 0)
            return 1;
    }
    if (cond_67895) {
        if (memblock_alloc_device(ctx, &mem_78125, (int64_t) 8, "mem_78125")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_79401(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_67854, mem_78103.mem, mem_78125.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78125, "mem_78125") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_78124, (int64_t) 8, "mem_78124")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_78124, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_78126, &mem_78124, "mem_78124") != 0)
            return 1;
    }
    
    bool zzero_67912 = scatter_psizze_39357 == (int64_t) 0;
    bool nonzzero_67913 = !zzero_67912;
    bool nonzzero_cert_67914;
    
    if (!nonzzero_67913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_67979 = !empty_slice_67853;
    bool protect_assert_disj_67980 = empty_slice_67853 || bounds_check_67897;
    bool index_certs_67981;
    
    if (!protect_assert_disj_67980) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_67854, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_67982;
    
    if (x_67979) {
        int64_t read_res_79620;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79620, mem_78115.mem, m_67854 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_68897 = read_res_79620;
        
        m_f_res_67982 = x_68897;
    } else {
        m_f_res_67982 = (int64_t) 0;
    }
    
    int64_t m_67984;
    
    if (empty_slice_67853) {
        m_67984 = (int64_t) 0;
    } else {
        m_67984 = m_f_res_67982;
    }
    
    int64_t m_67994 = sub64(m_67984, (int64_t) 1);
    bool i_p_m_t_s_leq_w_67996 = slt64(m_67994, m_67844);
    bool zzero_leq_i_p_m_t_s_67995 = sle64((int64_t) 0, m_67994);
    bool y_67998 = zzero_leq_i_p_m_t_s_67995 && i_p_m_t_s_leq_w_67996;
    bool i_lte_j_67997 = sle64((int64_t) 0, m_67984);
    bool forwards_ok_67999 = i_lte_j_67997 && y_67998;
    bool eq_x_zz_67991 = (int64_t) 0 == m_f_res_67982;
    bool p_and_eq_x_y_67992 = x_67979 && eq_x_zz_67991;
    bool empty_slice_67993 = empty_slice_67853 || p_and_eq_x_y_67992;
    bool ok_or_empty_68000 = empty_slice_67993 || forwards_ok_67999;
    bool index_certs_68001;
    
    if (!ok_or_empty_68000) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_67984, "] out of bounds for array of shape [", (long long) m_67844, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:326:7-327:73\n   #3  ftSMJ.fut:351:133-136\n   #4  ftSMJ.fut:340:1-351:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_78127 = (int64_t) 8 * m_67984;
    
    if (memblock_alloc_device(ctx, &mem_78132, (int64_t) 8, "mem_78132")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_shortzigpuseq_79407(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_78123.mem, ext_mem_78126.mem, mem_78132.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
        return 1;
    
    int64_t n_pairs_t_res_67905;
    
    if (cond_67895) {
        int64_t read_res_79621;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79621, mem_78132.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_77623 = read_res_79621;
        
        n_pairs_t_res_67905 = x_77623;
    } else {
        n_pairs_t_res_67905 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
        return 1;
    
    int64_t n_pairs_67906;
    
    if (cond_67895) {
        n_pairs_67906 = n_pairs_t_res_67905;
    } else {
        n_pairs_67906 = (int64_t) 0;
    }
    
    int64_t bytes_78133 = (int64_t) 2 * n_pairs_67906;
    int64_t bytes_78135 = (int64_t) 8 * n_pairs_67906;
    int64_t segmap_tblock_sizze_70772;
    
    segmap_tblock_sizze_70772 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70771;
    
    int64_t num_tblocks_70774;
    int64_t max_num_tblocks_79413;
    
    max_num_tblocks_79413 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70773;
    num_tblocks_70774 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_70772), max_num_tblocks_79413)));
    if (memblock_alloc_device(ctx, &mem_78128, bytes_78127, "mem_78128")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78128.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_78130, bytes_78127, "mem_78130")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78130.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78120.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_67984})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_70780;
    
    segmap_tblock_sizze_70780 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70779;
    
    int64_t num_tblocks_70782;
    int64_t max_num_tblocks_79414;
    
    max_num_tblocks_79414 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_70781;
    num_tblocks_70782 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_67844, segmap_tblock_sizze_70780), max_num_tblocks_79414)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_79415 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_70780));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_70777(ctx, num_tblocks_70782, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70779, 1, 1, (int64_t) 0, m_67844, m_67984, num_tblocks_70782, virt_num_tblocks_79415, mem_78103.mem, mem_78115.mem, mem_78117.mem, mem_78120.mem, mem_78128.mem, mem_78130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
        return 1;
    
    bool cond_68011 = slt64((int64_t) 0, m_67984);
    int64_t segmap_tblock_sizze_70795;
    
    segmap_tblock_sizze_70795 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70787;
    if (memblock_alloc_device(ctx, &mem_78134, bytes_78133, "mem_78134")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i16(ctx, mem_78134, n_pairs_67906, (int16_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78136, bytes_78135, "mem_78136")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78136, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78138, bytes_78135, "mem_78138")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_78138, n_pairs_67906, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_67910 = add64(scatter_psizze_39357, n_pairs_67906);
    int64_t zs_lhs_67911 = sub64(zm_lhs_67910, (int64_t) 1);
    int64_t m_67915 = sdiv64(zs_lhs_67911, scatter_psizze_39357);
    bool loop_cond_67916 = slt64((int64_t) 0, m_67915);
    bool partitioned_scatter_res_67917;
    int64_t partitioned_scatter_res_67921;
    bool loop_while_67922;
    int64_t p_67926;
    
    loop_while_67922 = loop_cond_67916;
    p_67926 = (int64_t) 0;
    while (loop_while_67922) {
        int64_t lower_bound_67927 = mul64(scatter_psizze_39357, p_67926);
        int64_t min_arg1_67928 = add64(scatter_psizze_39357, lower_bound_67927);
        int64_t min_res_67929 = smin64(n_pairs_67906, min_arg1_67928);
        int64_t j_m_i_67930 = sub64(min_res_67929, lower_bound_67927);
        bool empty_slice_67931 = j_m_i_67930 == (int64_t) 0;
        int64_t m_67932 = sub64(j_m_i_67930, (int64_t) 1);
        int64_t i_p_m_t_s_67933 = add64(lower_bound_67927, m_67932);
        bool zzero_leq_i_p_m_t_s_67934 = sle64((int64_t) 0, i_p_m_t_s_67933);
        bool i_p_m_t_s_leq_w_67935 = slt64(i_p_m_t_s_67933, n_pairs_67906);
        bool zzero_lte_i_67936 = sle64((int64_t) 0, lower_bound_67927);
        bool i_lte_j_67937 = sle64(lower_bound_67927, min_res_67929);
        bool y_67938 = i_p_m_t_s_leq_w_67935 && zzero_lte_i_67936;
        bool y_67939 = zzero_leq_i_p_m_t_s_67934 && y_67938;
        bool forwards_ok_67940 = i_lte_j_67937 && y_67939;
        bool ok_or_empty_67941 = empty_slice_67931 || forwards_ok_67940;
        bool index_certs_67942;
        
        if (!ok_or_empty_67941) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_67927, ":", (long long) min_res_67929, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78148 = (int64_t) 2 * j_m_i_67930;
        int64_t bytes_78150 = (int64_t) 8 * j_m_i_67930;
        
        if (memblock_alloc_device(ctx, &mem_78149, bytes_78148, "mem_78149")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78134.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78151, bytes_78150, "mem_78151")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78136.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78153, bytes_78150, "mem_78153")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_78138.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_67927, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79433 = sext_i64_i32(sdiv_up64(m_67844, segmap_tblock_sizze_70772));
        
        {
            err = gpu_kernel_inner_SMJ_shortzisegmap_70769(ctx, num_tblocks_70774, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70771, 1, 1, (int64_t) 0, m_67844, lower_bound_67927, min_res_67929, j_m_i_67930, num_tblocks_70774, virt_num_tblocks_79433, mem_78105.mem, mem_78107.mem, mem_78109.mem, mem_78120.mem, mem_78149.mem, mem_78151.mem, mem_78153.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_67956 = add64((int64_t) 1, p_67926);
        
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78134.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78149.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78136.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78138.mem, lower_bound_67927, (int64_t []) {(int64_t) 1}, mem_78153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_67930})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        
        bool loop_cond_67967 = slt64(tmp_67956, m_67915);
        bool loop_while_tmp_79428 = loop_cond_67967;
        int64_t p_tmp_79432 = tmp_67956;
        
        loop_while_67922 = loop_while_tmp_79428;
        p_67926 = p_tmp_79432;
    }
    partitioned_scatter_res_67917 = loop_while_67922;
    partitioned_scatter_res_67921 = p_67926;
    if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
        return 1;
    
    bool loop_cond_t_res_68012 = slt64(m_67844, n_pairs_67906);
    bool x_68013 = cond_68011 && loop_cond_t_res_68012;
    
    if (memblock_alloc_device(ctx, &mem_78179, (int64_t) 2, "mem_78179")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78180, (int64_t) 8, "mem_78180")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_78181, (int64_t) 8, "mem_78181")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_68014;
    int64_t joinTups_to_joinPairs_InnerJoin_res_68018;
    bool loop_while_68019;
    int64_t p_68023;
    
    if (memblock_set_device(ctx, &mem_param_78166, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78169, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_78172, &mem_78138, "mem_78138") != 0)
        return 1;
    loop_while_68019 = x_68013;
    p_68023 = (int64_t) 0;
    while (loop_while_68019) {
        bool x_68024 = sle64((int64_t) 0, p_68023);
        bool y_68025 = slt64(p_68023, m_67984);
        bool bounds_check_68026 = x_68024 && y_68025;
        bool index_certs_68027;
        
        if (!bounds_check_68026) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_68023, "] out of bounds for array of shape [", (long long) m_67984, "].", "-> #0  ftSMJ.fut:300:13-42\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_79622;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79622, mem_78130.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68028 = read_res_79622;
        int64_t read_res_79623;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_79623, mem_78128.mem, p_68023 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_68029 = read_res_79623;
        bool x_68030 = sle64((int64_t) 0, loopres_68028);
        bool y_68031 = slt64(loopres_68028, n_pairs_67906);
        bool bounds_check_68032 = x_68030 && y_68031;
        bool index_certs_68033;
        
        if (!bounds_check_68032) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:302:52-61\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_68044 = add64(loopres_68028, loopres_68029);
        bool empty_slice_68048 = loopres_68029 == (int64_t) 0;
        int64_t m_68049 = sub64(loopres_68029, (int64_t) 1);
        int64_t i_p_m_t_s_68050 = add64(loopres_68028, m_68049);
        bool zzero_leq_i_p_m_t_s_68051 = sle64((int64_t) 0, i_p_m_t_s_68050);
        bool i_p_m_t_s_leq_w_68052 = slt64(i_p_m_t_s_68050, n_pairs_67906);
        bool i_lte_j_68053 = sle64(loopres_68028, tmp_68044);
        bool y_68054 = x_68030 && i_p_m_t_s_leq_w_68052;
        bool y_68055 = zzero_leq_i_p_m_t_s_68051 && y_68054;
        bool forwards_ok_68056 = i_lte_j_68053 && y_68055;
        bool ok_or_empty_68057 = empty_slice_68048 || forwards_ok_68056;
        bool index_certs_68058;
        
        if (!ok_or_empty_68057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_68028, ":", (long long) tmp_68044, "] out of bounds for array of shape [", (long long) n_pairs_67906, "].", "-> #0  ftSMJ.fut:306:14-55\n   #1  ftSMJ.fut:326:7-327:73\n   #2  ftSMJ.fut:351:133-136\n   #3  ftSMJ.fut:340:1-351:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_78182 = (int64_t) 2 * loopres_68029;
        int64_t bytes_78184 = (int64_t) 8 * loopres_68029;
        int64_t segmap_usable_groups_70796 = sdiv_up64(loopres_68029, segmap_tblock_sizze_70795);
        int64_t tmp_68043 = add64((int64_t) 1, p_68023);
        
        if (memblock_alloc_device(ctx, &mem_78174, bytes_78133, "mem_78174")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78174.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78176, bytes_78135, "mem_78176")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_78178, bytes_78135, "mem_78178")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_78172.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
            goto cleanup;
        
        bool cond_68062 = slt64(tmp_68043, m_67984);
        bool x_68063 = loop_cond_t_res_68012 && cond_68062;
        
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_79454(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_68028, mem_param_78166.mem, mem_param_78169.mem, mem_param_78172.mem, mem_78179.mem, mem_78180.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78183, bytes_78182, "mem_78183")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79460 = loopres_68029;
        int64_t tblock_sizze_79465;
        
        tblock_sizze_79465 = *ctx->tuning_params.inner_SMJ_shortzitblock_sizze_79465;
        
        int64_t virt_num_tblocks_79466 = sdiv_up64(replicate_n_79460, tblock_sizze_79465);
        int64_t num_tblocks_79467 = smin64(virt_num_tblocks_79466, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_shortzireplicate_79461(ctx, num_tblocks_79467, 1, 1, tblock_sizze_79465, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79460, virt_num_tblocks_79466, num_tblocks_79467, mem_78179.mem, mem_78183.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_78185, bytes_78184, "mem_78185")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_79480 = loopres_68029;
        int64_t tblock_sizze_79485;
        
        tblock_sizze_79485 = *ctx->tuning_params.inner_SMJ_shortzitblock_sizze_79485;
        
        int64_t virt_num_tblocks_79486 = sdiv_up64(replicate_n_79480, tblock_sizze_79485);
        int64_t num_tblocks_79487 = smin64(virt_num_tblocks_79486, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_shortzireplicate_79481(ctx, num_tblocks_79487, 1, 1, tblock_sizze_79485, 1, 1, (int64_t) 0, loopres_68029, replicate_n_79480, virt_num_tblocks_79486, num_tblocks_79487, mem_78180.mem, mem_78185.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_79500 = sext_i64_i32(sdiv_up64(loopres_68029, segmap_tblock_sizze_70795));
        
        {
            err = gpu_kernel_inner_SMJ_shortzisegmap_70799(ctx, segmap_usable_groups_70796, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_70787, 1, 1, (int64_t) 0, loopres_68028, loopres_68029, mem_78178.mem, mem_78181.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78174.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78176.mem, loopres_68028, (int64_t []) {(int64_t) 1}, mem_78185.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_68029})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79446, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79447, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_79448, &mem_78178, "mem_78178") != 0)
            return 1;
        
        bool loop_while_tmp_79449 = x_68063;
        int64_t p_tmp_79453 = tmp_68043;
        
        if (memblock_set_device(ctx, &mem_param_78166, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78169, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_78172, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        loop_while_68019 = loop_while_tmp_79449;
        p_68023 = p_tmp_79453;
    }
    if (memblock_set_device(ctx, &ext_mem_78197, &mem_param_78166, "mem_param_78166") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78196, &mem_param_78169, "mem_param_78169") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_78195, &mem_param_78172, "mem_param_78172") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_68014 = loop_while_68019;
    joinTups_to_joinPairs_InnerJoin_res_68018 = p_68023;
    if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78199, bytes_78133, "mem_78199")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_78199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78197.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78201, bytes_78135, "mem_78201")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78201.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_78203, bytes_78135, "mem_78203")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_78203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_78195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_67906})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78700, &mem_78201, "mem_78201") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78701, &mem_78203, "mem_78203") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_78702, &mem_78199, "mem_78199") != 0)
        return 1;
    prim_out_78703 = n_pairs_67906;
    if (memblock_set_device(ctx, &*mem_out_p_79603, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79604, &mem_out_78701, "mem_out_78701") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79605, &mem_out_78702, "mem_out_78702") != 0)
        return 1;
    *out_prim_out_79606 = prim_out_78703;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_78203, "mem_78203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78201, "mem_78201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78199, "mem_78199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79448, "mem_param_tmp_79448") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79447, "mem_param_tmp_79447") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_79446, "mem_param_tmp_79446") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78185, "mem_78185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78183, "mem_78183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78178, "mem_78178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78176, "mem_78176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78174, "mem_78174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78172, "mem_param_78172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78169, "mem_param_78169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_78166, "mem_param_78166") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78195, "ext_mem_78195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78196, "ext_mem_78196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78197, "ext_mem_78197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78181, "mem_78181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78180, "mem_78180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78179, "mem_78179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78153, "mem_78153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78151, "mem_78151") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78149, "mem_78149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78138, "mem_78138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78136, "mem_78136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78134, "mem_78134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78130, "mem_78130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78128, "mem_78128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78132, "mem_78132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78124, "mem_78124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78125, "mem_78125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78126, "ext_mem_78126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78121, "mem_78121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78122, "mem_78122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78123, "ext_mem_78123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78120, "mem_78120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79249, "incprefixes_mem_79249") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79247, "aggregates_mem_79247") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79245, "incprefixes_mem_79245") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79243, "aggregates_mem_79243") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79241, "status_flags_mem_79241") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78117, "mem_78117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78115, "mem_78115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78113, "mem_78113") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78109, "mem_78109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78107, "mem_78107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78105, "mem_78105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78103, "mem_78103") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_79108, "incprefixes_mem_79108") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_79106, "aggregates_mem_79106") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_79084, "status_flags_mem_79084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78101, "mem_78101") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78099, "mem_78099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78751, "mem_param_tmp_78751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78750, "mem_param_tmp_78750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78084, "mem_78084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78083, "mem_78083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78080, "mem_78080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78908, "mem_param_tmp_78908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78907, "mem_param_tmp_78907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77888, "mem_77888") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77886, "mem_77886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77884, "mem_77884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77881, "mem_77881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78918, "mem_param_tmp_78918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78917, "mem_param_tmp_78917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77872, "mem_77872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77869, "mem_77869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78936, "mem_param_tmp_78936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78935, "mem_param_tmp_78935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77848, "mem_77848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77846, "mem_77846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77781, "mem_77781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77779, "mem_77779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77842, "mem_77842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77840, "mem_77840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77843, "ext_mem_77843") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77844, "ext_mem_77844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77720, "ext_mem_77720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77718, "mem_77718") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77851, "ext_mem_77851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77854, "ext_mem_77854") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77716, "mem_77716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77857, "ext_mem_77857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77860, "ext_mem_77860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77714, "ext_mem_77714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77713, "ext_mem_77713") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77710, "mem_param_77710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77707, "mem_param_77707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77865, "ext_mem_77865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77866, "ext_mem_77866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77702, "mem_77702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77703, "mem_77703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77704, "ext_mem_77704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77699, "mem_77699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77700, "mem_77700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77701, "ext_mem_77701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77698, "mem_param_77698") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77695, "mem_param_77695") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77877, "ext_mem_77877") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77878, "ext_mem_77878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77715, "mem_77715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77712, "mem_77712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77711, "mem_77711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77692, "mem_77692") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77690, "mem_77690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77891, "ext_mem_77891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77894, "ext_mem_77894") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77897, "ext_mem_77897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77900, "ext_mem_77900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77688, "mem_param_77688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77685, "mem_param_77685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77905, "ext_mem_77905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77906, "ext_mem_77906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77682, "mem_77682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77680, "mem_77680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77667, "mem_77667") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77669, "mem_77669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77670, "ext_mem_77670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77671, "ext_mem_77671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77664, "mem_77664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77662, "mem_77662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77651, "mem_77651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77652, "mem_77652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77653, "ext_mem_77653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77650, "mem_77650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77647, "mem_77647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77648, "mem_77648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77649, "ext_mem_77649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77646, "mem_77646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77644, "mem_77644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78769, "mem_param_tmp_78769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_78768, "mem_param_tmp_78768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78053, "mem_78053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78051, "mem_78051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77986, "mem_77986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77984, "mem_77984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78047, "mem_78047") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_78045, "mem_78045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78048, "ext_mem_78048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78049, "ext_mem_78049") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77925, "ext_mem_77925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77923, "mem_77923") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78056, "ext_mem_78056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78059, "ext_mem_78059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77921, "mem_77921") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78062, "ext_mem_78062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78065, "ext_mem_78065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77919, "ext_mem_77919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77918, "ext_mem_77918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77915, "mem_param_77915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77912, "mem_param_77912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78070, "ext_mem_78070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78071, "ext_mem_78071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77920, "mem_77920") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77917, "mem_77917") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77916, "mem_77916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77907, "mem_77907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77908, "mem_77908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77909, "ext_mem_77909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78074, "ext_mem_78074") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78077, "ext_mem_78077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78087, "ext_mem_78087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78090, "ext_mem_78090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77640, "mem_param_77640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_77637, "mem_param_77637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78095, "ext_mem_78095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_78096, "ext_mem_78096") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77642, "mem_77642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77641, "mem_77641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77632, "mem_77632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77633, "mem_77633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77634, "ext_mem_77634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77631, "mem_77631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77629, "mem_77629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_77627, "ext_mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78702, "mem_out_78702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78701, "mem_out_78701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_79624, struct memblock_device eta_p_mem_77625, int64_t nz2080U_62616)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_78725;
    
    segred_tmp_mem_78725.references = NULL;
    
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78700;
    int64_t segred_tblock_sizze_68924;
    
    segred_tblock_sizze_68924 = *ctx->tuning_params.max_idxzisegred_tblock_sizze_68923;
    
    int64_t num_tblocks_68926;
    int64_t max_num_tblocks_78701;
    
    max_num_tblocks_78701 = *ctx->tuning_params.max_idxzisegred_num_tblocks_68925;
    num_tblocks_68926 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nz2080U_62616, segred_tblock_sizze_68924), max_num_tblocks_78701)));
    if (memblock_alloc_device(ctx, &mem_77627, (int64_t) 8, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_78702 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_78725, (int64_t) 8 * num_tblocks_68926, "segred_tmp_mem_78725")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_78727 = num_tblocks_68926 * segred_tblock_sizze_68924;
    
    {
        err = gpu_kernel_max_idxzisegred_nonseg_68931(ctx, num_tblocks_68926, 1, 1, *ctx->tuning_params.max_idxzisegred_tblock_sizze_68923, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_68924 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_68924, (int64_t) 8), (int64_t) 8)), nz2080U_62616, num_tblocks_68926, num_threads_78727, eta_p_mem_77625.mem, mem_77627.mem, counters_mem_78703.mem, segred_tmp_mem_78725.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t read_res_79625;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_79625, mem_77627.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_res_68085 = read_res_79625;
    
    if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
        return 1;
    prim_out_78700 = defunc_0_reduce_res_68085;
    *out_prim_out_79624 = prim_out_78700;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_78725, "segred_tmp_mem_78725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_79626, struct memblock_device eta_p_mem_77625, int64_t nz2080U_62579)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_78725;
    
    segred_tmp_mem_78725.references = NULL;
    
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t prim_out_78700;
    int64_t segred_tblock_sizze_68914;
    
    segred_tblock_sizze_68914 = *ctx->tuning_params.min_idxzisegred_tblock_sizze_68913;
    
    int64_t num_tblocks_68916;
    int64_t max_num_tblocks_78701;
    
    max_num_tblocks_78701 = *ctx->tuning_params.min_idxzisegred_num_tblocks_68915;
    num_tblocks_68916 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nz2080U_62579, segred_tblock_sizze_68914), max_num_tblocks_78701)));
    if (memblock_alloc_device(ctx, &mem_77627, (int64_t) 8, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_78702 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_78725, (int64_t) 8 * num_tblocks_68916, "segred_tmp_mem_78725")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_78727 = num_tblocks_68916 * segred_tblock_sizze_68914;
    
    {
        err = gpu_kernel_min_idxzisegred_nonseg_68921(ctx, num_tblocks_68916, 1, 1, *ctx->tuning_params.min_idxzisegred_tblock_sizze_68913, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_68914 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_68914, (int64_t) 8), (int64_t) 8)), nz2080U_62579, num_tblocks_68916, num_threads_78727, eta_p_mem_77625.mem, mem_77627.mem, counters_mem_78703.mem, segred_tmp_mem_78725.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t read_res_79627;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_79627, mem_77627.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_res_68085 = read_res_79627;
    
    if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
        return 1;
    prim_out_78700 = defunc_0_reduce_res_68085;
    *out_prim_out_79626 = prim_out_78700;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_78725, "segred_tmp_mem_78725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_10056(struct futhark_context *ctx, struct memblock_device *mem_out_p_79628, struct memblock_device xs_mem_77625, int64_t n_54395, int64_t incr_54396)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t rng_54401 = add64(n_54395, incr_54396);
    bool bounds_invalid_upwards_54405 = slt64(rng_54401, incr_54396);
    bool valid_54410 = !bounds_invalid_upwards_54405;
    bool range_valid_c_54411;
    
    if (!valid_54410) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_54396, "..<", (long long) rng_54401, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77626 = (int64_t) 8 * n_54395;
    
    if (memblock_alloc_device(ctx, &mem_77627, bytes_77626, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_77627, n_54395, incr_54396, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77627, "mem_77627") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79628, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9601(struct futhark_context *ctx, struct memblock_device *mem_out_p_79629, struct memblock_device xs_mem_77625, int64_t n_34021, int64_t incr_34022)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t rng_34027 = add64(n_34021, incr_34022);
    bool bounds_invalid_upwards_34031 = slt64(rng_34027, incr_34022);
    bool valid_34036 = !bounds_invalid_upwards_34031;
    bool range_valid_c_34037;
    
    if (!valid_34036) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_34022, "..<", (long long) rng_34027, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77626 = (int64_t) 8 * n_34021;
    
    if (memblock_alloc_device(ctx, &mem_77627, bytes_77626, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_77627, n_34021, incr_34022, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77627, "mem_77627") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79629, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9745(struct futhark_context *ctx, struct memblock_device *mem_out_p_79630, struct memblock_device xs_mem_77625, int64_t n_39390, int64_t incr_39391)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t rng_39396 = add64(n_39390, incr_39391);
    bool bounds_invalid_upwards_39400 = slt64(rng_39396, incr_39391);
    bool valid_39405 = !bounds_invalid_upwards_39400;
    bool range_valid_c_39406;
    
    if (!valid_39405) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_39391, "..<", (long long) rng_39396, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77626 = (int64_t) 8 * n_39390;
    
    if (memblock_alloc_device(ctx, &mem_77627, bytes_77626, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_77627, n_39390, incr_39391, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77627, "mem_77627") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79630, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9850(struct futhark_context *ctx, struct memblock_device *mem_out_p_79631, struct memblock_device xs_mem_77625, int64_t n_44410, int64_t incr_44411)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t rng_44416 = add64(n_44410, incr_44411);
    bool bounds_invalid_upwards_44420 = slt64(rng_44416, incr_44411);
    bool valid_44425 = !bounds_invalid_upwards_44420;
    bool range_valid_c_44426;
    
    if (!valid_44425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_44411, "..<", (long long) rng_44416, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77626 = (int64_t) 8 * n_44410;
    
    if (memblock_alloc_device(ctx, &mem_77627, bytes_77626, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_77627, n_44410, incr_44411, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77627, "mem_77627") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79631, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_9949(struct futhark_context *ctx, struct memblock_device *mem_out_p_79632, struct memblock_device xs_mem_77625, int64_t n_49366, int64_t incr_49367)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_77627;
    
    mem_77627.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
    struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
    struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
    struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
    struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
    int64_t rng_49372 = add64(n_49366, incr_49367);
    bool bounds_invalid_upwards_49376 = slt64(rng_49372, incr_49367);
    bool valid_49381 = !bounds_invalid_upwards_49376;
    bool range_valid_c_49382;
    
    if (!valid_49381) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_49367, "..<", (long long) rng_49372, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_77626 = (int64_t) 8 * n_49366;
    
    if (memblock_alloc_device(ctx, &mem_77627, bytes_77626, "mem_77627")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_77627, n_49366, incr_49367, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_78700, &mem_77627, "mem_77627") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_79632, &mem_out_78700, "mem_out_78700") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_77627, "mem_77627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_78700, "mem_out_78700") != 0)
            return 1;
    }
    return err;
}

int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_61033 = (int64_t) 0;
    int64_t dz2083U_61034 = (int64_t) 0;
    int64_t incr_61035 = (int64_t) 0;
    int64_t psizze_61036 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77626;
    
    ys_mem_77626.references = NULL;
    
    struct memblock_device is_mem_77625;
    
    is_mem_77625.references = NULL;
    incr_61035 = in0;
    psizze_61036 = in1;
    is_mem_77625 = in2->mem;
    niz2084U_61033 = in2->shape[0];
    ys_mem_77626 = in3->mem;
    dz2083U_61034 = in3->shape[0];
    if (!(niz2084U_61033 == in2->shape[0] && dz2083U_61034 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_78700, is_mem_77625, ys_mem_77626, niz2084U_61033, dz2083U_61034, incr_61035, psizze_61036);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = niz2084U_61033;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_62540 = (int64_t) 0;
    int64_t n_62541 = (int64_t) 0;
    int64_t incr_62542 = (int64_t) 0;
    int64_t psizze_62543 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77627;
    
    ys_mem_77627.references = NULL;
    
    struct memblock_device is_mem_77626;
    
    is_mem_77626.references = NULL;
    
    struct memblock_device preVals_mem_77625;
    
    preVals_mem_77625.references = NULL;
    incr_62542 = in0;
    psizze_62543 = in1;
    preVals_mem_77625 = in2->mem;
    ni_62540 = in2->shape[0];
    is_mem_77626 = in3->mem;
    ni_62540 = in3->shape[0];
    ys_mem_77627 = in4->mem;
    n_62541 = in4->shape[0];
    if (!(ni_62540 == in2->shape[0] && (ni_62540 == in3->shape[0] && n_62541 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_78700, preVals_mem_77625, is_mem_77626, ys_mem_77627, ni_62540, n_62541, incr_62542, psizze_62543);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = ni_62540;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_60693 = (int64_t) 0;
    int64_t dz2083U_60694 = (int64_t) 0;
    int64_t incr_60695 = (int64_t) 0;
    int64_t psizze_60696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77626;
    
    ys_mem_77626.references = NULL;
    
    struct memblock_device is_mem_77625;
    
    is_mem_77625.references = NULL;
    incr_60695 = in0;
    psizze_60696 = in1;
    is_mem_77625 = in2->mem;
    niz2084U_60693 = in2->shape[0];
    ys_mem_77626 = in3->mem;
    dz2083U_60694 = in3->shape[0];
    if (!(niz2084U_60693 == in2->shape[0] && dz2083U_60694 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_78700, is_mem_77625, ys_mem_77626, niz2084U_60693, dz2083U_60694, incr_60695, psizze_60696);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = niz2084U_60693;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_62239 = (int64_t) 0;
    int64_t n_62240 = (int64_t) 0;
    int64_t incr_62241 = (int64_t) 0;
    int64_t psizze_62242 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77627;
    
    ys_mem_77627.references = NULL;
    
    struct memblock_device is_mem_77626;
    
    is_mem_77626.references = NULL;
    
    struct memblock_device preVals_mem_77625;
    
    preVals_mem_77625.references = NULL;
    incr_62241 = in0;
    psizze_62242 = in1;
    preVals_mem_77625 = in2->mem;
    ni_62239 = in2->shape[0];
    is_mem_77626 = in3->mem;
    ni_62239 = in3->shape[0];
    ys_mem_77627 = in4->mem;
    n_62240 = in4->shape[0];
    if (!(ni_62239 == in2->shape[0] && (ni_62239 == in3->shape[0] && n_62240 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_78700, preVals_mem_77625, is_mem_77626, ys_mem_77627, ni_62239, n_62240, incr_62241, psizze_62242);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = ni_62239;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_60044 = (int64_t) 0;
    int64_t dz2083U_60045 = (int64_t) 0;
    int64_t incr_60046 = (int64_t) 0;
    int64_t psizze_60047 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77626;
    
    ys_mem_77626.references = NULL;
    
    struct memblock_device is_mem_77625;
    
    is_mem_77625.references = NULL;
    incr_60046 = in0;
    psizze_60047 = in1;
    is_mem_77625 = in2->mem;
    niz2084U_60044 = in2->shape[0];
    ys_mem_77626 = in3->mem;
    dz2083U_60045 = in3->shape[0];
    if (!(niz2084U_60044 == in2->shape[0] && dz2083U_60045 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_78700, is_mem_77625, ys_mem_77626, niz2084U_60044, dz2083U_60045, incr_60046, psizze_60047);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = niz2084U_60044;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_61637 = (int64_t) 0;
    int64_t n_61638 = (int64_t) 0;
    int64_t incr_61639 = (int64_t) 0;
    int64_t psizze_61640 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77627;
    
    ys_mem_77627.references = NULL;
    
    struct memblock_device is_mem_77626;
    
    is_mem_77626.references = NULL;
    
    struct memblock_device preVals_mem_77625;
    
    preVals_mem_77625.references = NULL;
    incr_61639 = in0;
    psizze_61640 = in1;
    preVals_mem_77625 = in2->mem;
    ni_61637 = in2->shape[0];
    is_mem_77626 = in3->mem;
    ni_61637 = in3->shape[0];
    ys_mem_77627 = in4->mem;
    n_61638 = in4->shape[0];
    if (!(ni_61637 == in2->shape[0] && (ni_61637 == in3->shape[0] && n_61638 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_78700, preVals_mem_77625, is_mem_77626, ys_mem_77627, ni_61637, n_61638, incr_61639, psizze_61640);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = ni_61637;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_60353 = (int64_t) 0;
    int64_t dz2083U_60354 = (int64_t) 0;
    int64_t incr_60355 = (int64_t) 0;
    int64_t psizze_60356 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77626;
    
    ys_mem_77626.references = NULL;
    
    struct memblock_device is_mem_77625;
    
    is_mem_77625.references = NULL;
    incr_60355 = in0;
    psizze_60356 = in1;
    is_mem_77625 = in2->mem;
    niz2084U_60353 = in2->shape[0];
    ys_mem_77626 = in3->mem;
    dz2083U_60354 = in3->shape[0];
    if (!(niz2084U_60353 == in2->shape[0] && dz2083U_60354 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_78700, is_mem_77625, ys_mem_77626, niz2084U_60353, dz2083U_60354, incr_60355, psizze_60356);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = niz2084U_60353;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_61938 = (int64_t) 0;
    int64_t n_61939 = (int64_t) 0;
    int64_t incr_61940 = (int64_t) 0;
    int64_t psizze_61941 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77627;
    
    ys_mem_77627.references = NULL;
    
    struct memblock_device is_mem_77626;
    
    is_mem_77626.references = NULL;
    
    struct memblock_device preVals_mem_77625;
    
    preVals_mem_77625.references = NULL;
    incr_61940 = in0;
    psizze_61941 = in1;
    preVals_mem_77625 = in2->mem;
    ni_61938 = in2->shape[0];
    is_mem_77626 = in3->mem;
    ni_61938 = in3->shape[0];
    ys_mem_77627 = in4->mem;
    n_61939 = in4->shape[0];
    if (!(ni_61938 == in2->shape[0] && (ni_61938 == in3->shape[0] && n_61939 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_78700, preVals_mem_77625, is_mem_77626, ys_mem_77627, ni_61938, n_61939, incr_61940, psizze_61941);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = ni_61938;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_59732 = (int64_t) 0;
    int64_t dz2083U_59733 = (int64_t) 0;
    int64_t incr_59734 = (int64_t) 0;
    int64_t psizze_59735 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77626;
    
    ys_mem_77626.references = NULL;
    
    struct memblock_device is_mem_77625;
    
    is_mem_77625.references = NULL;
    incr_59734 = in0;
    psizze_59735 = in1;
    is_mem_77625 = in2->mem;
    niz2084U_59732 = in2->shape[0];
    ys_mem_77626 = in3->mem;
    dz2083U_59733 = in3->shape[0];
    if (!(niz2084U_59732 == in2->shape[0] && dz2083U_59733 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_78700, is_mem_77625, ys_mem_77626, niz2084U_59732, dz2083U_59733, incr_59734, psizze_59735);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = niz2084U_59732;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_61336 = (int64_t) 0;
    int64_t n_61337 = (int64_t) 0;
    int64_t incr_61338 = (int64_t) 0;
    int64_t psizze_61339 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device ys_mem_77627;
    
    ys_mem_77627.references = NULL;
    
    struct memblock_device is_mem_77626;
    
    is_mem_77626.references = NULL;
    
    struct memblock_device preVals_mem_77625;
    
    preVals_mem_77625.references = NULL;
    incr_61338 = in0;
    psizze_61339 = in1;
    preVals_mem_77625 = in2->mem;
    ni_61336 = in2->shape[0];
    is_mem_77626 = in3->mem;
    ni_61336 = in3->shape[0];
    ys_mem_77627 = in4->mem;
    n_61337 = in4->shape[0];
    if (!(ni_61336 == in2->shape[0] && (ni_61336 == in3->shape[0] && n_61337 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_78700, preVals_mem_77625, is_mem_77626, ys_mem_77627, ni_61336, n_61337, incr_61338, psizze_61339);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_78700;
            (*out0)->shape[0] = ni_61336;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_59382 = (int64_t) 0;
    int64_t nS_59383 = (int64_t) 0;
    int64_t offset_R_59386 = (int64_t) 0;
    int64_t offset_S_59387 = (int64_t) 0;
    int64_t partitionsPerWindow_59388 = (int64_t) 0;
    int64_t numberOfWindows_59389 = (int64_t) 0;
    int64_t extParallelism_59390 = (int64_t) 0;
    int64_t scatter_psizze_59391 = (int64_t) 0;
    int64_t prim_out_78703 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device tS_mem_77626;
    
    tS_mem_77626.references = NULL;
    
    struct memblock_device tR_mem_77625;
    
    tR_mem_77625.references = NULL;
    tR_mem_77625 = in0->mem;
    nR_59382 = in0->shape[0];
    tS_mem_77626 = in1->mem;
    nS_59383 = in1->shape[0];
    offset_R_59386 = in2;
    offset_S_59387 = in3;
    partitionsPerWindow_59388 = in4;
    numberOfWindows_59389 = in5;
    extParallelism_59390 = in6;
    scatter_psizze_59391 = in7;
    if (!(nR_59382 == in0->shape[0] && nS_59383 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_78700, &mem_out_78701, &mem_out_78702, &prim_out_78703, tR_mem_77625, tS_mem_77626, nR_59382, nS_59383, offset_R_59386, offset_S_59387, partitionsPerWindow_59388, numberOfWindows_59389, extParallelism_59390, scatter_psizze_59391);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_78700;
            (*out0)->v0->shape[0] = prim_out_78703;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_78701;
            (*out0)->v1->shape[0] = prim_out_78703;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_78702;
            (*out0)->v2->shape[0] = prim_out_78703;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_54353 = (int64_t) 0;
    int64_t nS_54354 = (int64_t) 0;
    int64_t offset_R_54357 = (int64_t) 0;
    int64_t offset_S_54358 = (int64_t) 0;
    int64_t partitionsPerWindow_54359 = (int64_t) 0;
    int64_t numberOfWindows_54360 = (int64_t) 0;
    int64_t extParallelism_54361 = (int64_t) 0;
    int64_t scatter_psizze_54362 = (int64_t) 0;
    int64_t prim_out_78703 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device tS_mem_77626;
    
    tS_mem_77626.references = NULL;
    
    struct memblock_device tR_mem_77625;
    
    tR_mem_77625.references = NULL;
    tR_mem_77625 = in0->mem;
    nR_54353 = in0->shape[0];
    tS_mem_77626 = in1->mem;
    nS_54354 = in1->shape[0];
    offset_R_54357 = in2;
    offset_S_54358 = in3;
    partitionsPerWindow_54359 = in4;
    numberOfWindows_54360 = in5;
    extParallelism_54361 = in6;
    scatter_psizze_54362 = in7;
    if (!(nR_54353 == in0->shape[0] && nS_54354 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_78700, &mem_out_78701, &mem_out_78702, &prim_out_78703, tR_mem_77625, tS_mem_77626, nR_54353, nS_54354, offset_R_54357, offset_S_54358, partitionsPerWindow_54359, numberOfWindows_54360, extParallelism_54361, scatter_psizze_54362);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_78700;
            (*out0)->v0->shape[0] = prim_out_78703;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_78701;
            (*out0)->v1->shape[0] = prim_out_78703;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_78702;
            (*out0)->v2->shape[0] = prim_out_78703;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_44377 = (int64_t) 0;
    int64_t nS_44378 = (int64_t) 0;
    int64_t offset_R_44381 = (int64_t) 0;
    int64_t offset_S_44382 = (int64_t) 0;
    int64_t partitionsPerWindow_44383 = (int64_t) 0;
    int64_t numberOfWindows_44384 = (int64_t) 0;
    int64_t extParallelism_44385 = (int64_t) 0;
    int64_t scatter_psizze_44386 = (int64_t) 0;
    int64_t prim_out_78703 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device tS_mem_77626;
    
    tS_mem_77626.references = NULL;
    
    struct memblock_device tR_mem_77625;
    
    tR_mem_77625.references = NULL;
    tR_mem_77625 = in0->mem;
    nR_44377 = in0->shape[0];
    tS_mem_77626 = in1->mem;
    nS_44378 = in1->shape[0];
    offset_R_44381 = in2;
    offset_S_44382 = in3;
    partitionsPerWindow_44383 = in4;
    numberOfWindows_44384 = in5;
    extParallelism_44385 = in6;
    scatter_psizze_44386 = in7;
    if (!(nR_44377 == in0->shape[0] && nS_44378 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_78700, &mem_out_78701, &mem_out_78702, &prim_out_78703, tR_mem_77625, tS_mem_77626, nR_44377, nS_44378, offset_R_44381, offset_S_44382, partitionsPerWindow_44383, numberOfWindows_44384, extParallelism_44385, scatter_psizze_44386);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_78700;
            (*out0)->v0->shape[0] = prim_out_78703;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_78701;
            (*out0)->v1->shape[0] = prim_out_78703;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_78702;
            (*out0)->v2->shape[0] = prim_out_78703;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_49324 = (int64_t) 0;
    int64_t nS_49325 = (int64_t) 0;
    int64_t offset_R_49328 = (int64_t) 0;
    int64_t offset_S_49329 = (int64_t) 0;
    int64_t partitionsPerWindow_49330 = (int64_t) 0;
    int64_t numberOfWindows_49331 = (int64_t) 0;
    int64_t extParallelism_49332 = (int64_t) 0;
    int64_t scatter_psizze_49333 = (int64_t) 0;
    int64_t prim_out_78703 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device tS_mem_77626;
    
    tS_mem_77626.references = NULL;
    
    struct memblock_device tR_mem_77625;
    
    tR_mem_77625.references = NULL;
    tR_mem_77625 = in0->mem;
    nR_49324 = in0->shape[0];
    tS_mem_77626 = in1->mem;
    nS_49325 = in1->shape[0];
    offset_R_49328 = in2;
    offset_S_49329 = in3;
    partitionsPerWindow_49330 = in4;
    numberOfWindows_49331 = in5;
    extParallelism_49332 = in6;
    scatter_psizze_49333 = in7;
    if (!(nR_49324 == in0->shape[0] && nS_49325 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_78700, &mem_out_78701, &mem_out_78702, &prim_out_78703, tR_mem_77625, tS_mem_77626, nR_49324, nS_49325, offset_R_49328, offset_S_49329, partitionsPerWindow_49330, numberOfWindows_49331, extParallelism_49332, scatter_psizze_49333);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_78700;
            (*out0)->v0->shape[0] = prim_out_78703;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_78701;
            (*out0)->v1->shape[0] = prim_out_78703;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_78702;
            (*out0)->v2->shape[0] = prim_out_78703;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_39348 = (int64_t) 0;
    int64_t nS_39349 = (int64_t) 0;
    int64_t offset_R_39352 = (int64_t) 0;
    int64_t offset_S_39353 = (int64_t) 0;
    int64_t partitionsPerWindow_39354 = (int64_t) 0;
    int64_t numberOfWindows_39355 = (int64_t) 0;
    int64_t extParallelism_39356 = (int64_t) 0;
    int64_t scatter_psizze_39357 = (int64_t) 0;
    int64_t prim_out_78703 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_78702;
    
    mem_out_78702.references = NULL;
    
    struct memblock_device mem_out_78701;
    
    mem_out_78701.references = NULL;
    
    struct memblock_device mem_out_78700;
    
    mem_out_78700.references = NULL;
    
    struct memblock_device tS_mem_77626;
    
    tS_mem_77626.references = NULL;
    
    struct memblock_device tR_mem_77625;
    
    tR_mem_77625.references = NULL;
    tR_mem_77625 = in0->mem;
    nR_39348 = in0->shape[0];
    tS_mem_77626 = in1->mem;
    nS_39349 = in1->shape[0];
    offset_R_39352 = in2;
    offset_S_39353 = in3;
    partitionsPerWindow_39354 = in4;
    numberOfWindows_39355 = in5;
    extParallelism_39356 = in6;
    scatter_psizze_39357 = in7;
    if (!(nR_39348 == in0->shape[0] && nS_39349 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_78700, &mem_out_78701, &mem_out_78702, &prim_out_78703, tR_mem_77625, tS_mem_77626, nR_39348, nS_39349, offset_R_39352, offset_S_39353, partitionsPerWindow_39354, numberOfWindows_39355, extParallelism_39356, scatter_psizze_39357);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_78700;
            (*out0)->v0->shape[0] = prim_out_78703;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_78701;
            (*out0)->v1->shape[0] = prim_out_78703;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_78702;
            (*out0)->v2->shape[0] = prim_out_78703;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_62616 = (int64_t) 0;
    int64_t prim_out_78700 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device eta_p_mem_77625;
    
    eta_p_mem_77625.references = NULL;
    eta_p_mem_77625 = in0->mem;
    nz2080U_62616 = in0->shape[0];
    if (!(nz2080U_62616 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_78700, eta_p_mem_77625, nz2080U_62616);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            *out0 = prim_out_78700;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_62579 = (int64_t) 0;
    int64_t prim_out_78700 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device eta_p_mem_77625;
    
    eta_p_mem_77625.references = NULL;
    eta_p_mem_77625 = in0->mem;
    nz2080U_62579 = in0->shape[0];
    if (!(nz2080U_62579 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_78700, eta_p_mem_77625, nz2080U_62579);
        if (ret == 0) {
            struct memblock_device counters_mem_78703 = ctx->constants->counters_mem_78703;
            struct memblock_device global_dynid_mem_79090 = ctx->constants->global_dynid_mem_79090;
            struct memblock_device global_dynid_mem_79110 = ctx->constants->global_dynid_mem_79110;
            struct memblock_device global_dynid_mem_79231 = ctx->constants->global_dynid_mem_79231;
            struct memblock_device global_dynid_mem_79251 = ctx->constants->global_dynid_mem_79251;
            
            *out0 = prim_out_78700;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
  
