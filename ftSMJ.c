// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_unified_memory(struct futhark_context_config *cfg, int flag);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s);
const char *futhark_context_config_get_program(struct futhark_context_config *cfg);
void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);

// Entry points
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>


#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
};
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    struct memblock_device counters_mem_76545;
    struct memblock_device global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093;
};
struct tuning_params {
    int dummy;
    int64_t *builtinzhiota_i64zitblock_sizze_76552;
    int64_t *builtinzhreplicate_f32zitblock_sizze_76581;
    int64_t *builtinzhreplicate_f64zitblock_sizze_76581;
    int64_t *builtinzhreplicate_i16zitblock_sizze_76581;
    int64_t *builtinzhreplicate_i32zitblock_sizze_76963;
    int64_t *builtinzhreplicate_i64zitblock_sizze_76555;
    int64_t *builtinzhreplicate_i8zitblock_sizze_76937;
    int64_t *gather_payloads_doublezisegmap_tblock_sizze_67001;
    int64_t *gather_payloads_doublezisegmap_tblock_sizze_67019;
    int64_t *gather_payloads_double_GFURzisegmap_tblock_sizze_67281;
    int64_t *gather_payloads_double_GFURzisegmap_tblock_sizze_67299;
    int64_t *gather_payloads_floatzisegmap_tblock_sizze_66945;
    int64_t *gather_payloads_floatzisegmap_tblock_sizze_66963;
    int64_t *gather_payloads_float_GFURzisegmap_tblock_sizze_67225;
    int64_t *gather_payloads_float_GFURzisegmap_tblock_sizze_67243;
    int64_t *gather_payloads_intzisegmap_tblock_sizze_66833;
    int64_t *gather_payloads_intzisegmap_tblock_sizze_66851;
    int64_t *gather_payloads_int_GFURzisegmap_tblock_sizze_67113;
    int64_t *gather_payloads_int_GFURzisegmap_tblock_sizze_67131;
    int64_t *gather_payloads_longzisegmap_tblock_sizze_66889;
    int64_t *gather_payloads_longzisegmap_tblock_sizze_66907;
    int64_t *gather_payloads_long_GFURzisegmap_tblock_sizze_67169;
    int64_t *gather_payloads_long_GFURzisegmap_tblock_sizze_67187;
    int64_t *gather_payloads_shortzisegmap_tblock_sizze_66777;
    int64_t *gather_payloads_shortzisegmap_tblock_sizze_66795;
    int64_t *gather_payloads_short_GFURzisegmap_tblock_sizze_67057;
    int64_t *gather_payloads_short_GFURzisegmap_tblock_sizze_67075;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_73813;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_73855;
    int64_t *inner_SMJ_doublezisegmap_num_tblocks_73863;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_72753;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73170;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73677;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73699;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73719;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73741;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73761;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73783;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73811;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73827;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73853;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73861;
    int64_t *inner_SMJ_doublezisegmap_tblock_sizze_73869;
    int64_t *inner_SMJ_doublezisegscan_num_tblocks_73803;
    int64_t *inner_SMJ_doublezisegscan_num_tblocks_73819;
    int64_t *inner_SMJ_doublezisegscan_tblock_sizze_73801;
    int64_t *inner_SMJ_doublezisegscan_tblock_sizze_73817;
    int64_t *inner_SMJ_doublezisuff_outer_par_0;
    int64_t *inner_SMJ_doublezisuff_outer_par_1;
    int64_t *inner_SMJ_doublezitblock_sizze_77307;
    int64_t *inner_SMJ_doublezitblock_sizze_77327;
    int64_t *inner_SMJ_doublezitile_sizze_73900;
    int64_t *inner_SMJ_doublezitile_sizze_74255;
    int64_t *inner_SMJ_doublezitile_sizze_74610;
    int64_t *inner_SMJ_doublezitile_sizze_74965;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_72503;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_72545;
    int64_t *inner_SMJ_floatzisegmap_num_tblocks_72553;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_71443;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_71860;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72367;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72389;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72409;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72431;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72451;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72473;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72501;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72517;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72543;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72551;
    int64_t *inner_SMJ_floatzisegmap_tblock_sizze_72559;
    int64_t *inner_SMJ_floatzisegscan_num_tblocks_72493;
    int64_t *inner_SMJ_floatzisegscan_num_tblocks_72509;
    int64_t *inner_SMJ_floatzisegscan_tblock_sizze_72491;
    int64_t *inner_SMJ_floatzisegscan_tblock_sizze_72507;
    int64_t *inner_SMJ_floatzisuff_outer_par_0;
    int64_t *inner_SMJ_floatzisuff_outer_par_1;
    int64_t *inner_SMJ_floatzitblock_sizze_77307;
    int64_t *inner_SMJ_floatzitblock_sizze_77327;
    int64_t *inner_SMJ_floatzitile_sizze_73900;
    int64_t *inner_SMJ_floatzitile_sizze_74255;
    int64_t *inner_SMJ_floatzitile_sizze_74610;
    int64_t *inner_SMJ_floatzitile_sizze_74965;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_69883;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_69925;
    int64_t *inner_SMJ_intzisegmap_num_tblocks_69933;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_68823;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69240;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69747;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69769;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69789;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69811;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69831;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69853;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69881;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69897;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69923;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69931;
    int64_t *inner_SMJ_intzisegmap_tblock_sizze_69939;
    int64_t *inner_SMJ_intzisegscan_num_tblocks_69873;
    int64_t *inner_SMJ_intzisegscan_num_tblocks_69889;
    int64_t *inner_SMJ_intzisegscan_tblock_sizze_69871;
    int64_t *inner_SMJ_intzisegscan_tblock_sizze_69887;
    int64_t *inner_SMJ_intzisuff_outer_par_0;
    int64_t *inner_SMJ_intzisuff_outer_par_1;
    int64_t *inner_SMJ_intzitblock_sizze_77287;
    int64_t *inner_SMJ_intzitblock_sizze_77307;
    int64_t *inner_SMJ_intzitile_sizze_73900;
    int64_t *inner_SMJ_intzitile_sizze_74255;
    int64_t *inner_SMJ_intzitile_sizze_74610;
    int64_t *inner_SMJ_intzitile_sizze_74965;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_71193;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_71235;
    int64_t *inner_SMJ_longzisegmap_num_tblocks_71243;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_70133;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_70550;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71057;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71079;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71099;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71121;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71141;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71163;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71191;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71207;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71233;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71241;
    int64_t *inner_SMJ_longzisegmap_tblock_sizze_71249;
    int64_t *inner_SMJ_longzisegscan_num_tblocks_71183;
    int64_t *inner_SMJ_longzisegscan_num_tblocks_71199;
    int64_t *inner_SMJ_longzisegscan_tblock_sizze_71181;
    int64_t *inner_SMJ_longzisegscan_tblock_sizze_71197;
    int64_t *inner_SMJ_longzisuff_outer_par_0;
    int64_t *inner_SMJ_longzisuff_outer_par_1;
    int64_t *inner_SMJ_longzitblock_sizze_77287;
    int64_t *inner_SMJ_longzitblock_sizze_77307;
    int64_t *inner_SMJ_longzitile_sizze_73900;
    int64_t *inner_SMJ_longzitile_sizze_74255;
    int64_t *inner_SMJ_longzitile_sizze_74610;
    int64_t *inner_SMJ_longzitile_sizze_74965;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_68573;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_68615;
    int64_t *inner_SMJ_shortzisegmap_num_tblocks_68623;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_67513;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_67930;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68437;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68459;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68479;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68501;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68521;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68543;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68571;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68587;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68613;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68621;
    int64_t *inner_SMJ_shortzisegmap_tblock_sizze_68629;
    int64_t *inner_SMJ_shortzisegscan_num_tblocks_68563;
    int64_t *inner_SMJ_shortzisegscan_num_tblocks_68579;
    int64_t *inner_SMJ_shortzisegscan_tblock_sizze_68561;
    int64_t *inner_SMJ_shortzisegscan_tblock_sizze_68577;
    int64_t *inner_SMJ_shortzisuff_outer_par_0;
    int64_t *inner_SMJ_shortzisuff_outer_par_1;
    int64_t *inner_SMJ_shortzitblock_sizze_77307;
    int64_t *inner_SMJ_shortzitblock_sizze_77327;
    int64_t *inner_SMJ_shortzitile_sizze_73900;
    int64_t *inner_SMJ_shortzitile_sizze_74255;
    int64_t *inner_SMJ_shortzitile_sizze_74610;
    int64_t *inner_SMJ_shortzitile_sizze_74965;
    int64_t *max_idxzisegred_num_tblocks_66767;
    int64_t *max_idxzisegred_tblock_sizze_66765;
    int64_t *min_idxzisegred_num_tblocks_66757;
    int64_t *min_idxzisegred_tblock_sizze_66755;
};
static const int num_tuning_params = 171;
static const char *tuning_param_names[] = {"builtin#iota_i64.tblock_size_76552", "builtin#replicate_f32.tblock_size_76581", "builtin#replicate_f64.tblock_size_76581", "builtin#replicate_i16.tblock_size_76581", "builtin#replicate_i32.tblock_size_76963", "builtin#replicate_i64.tblock_size_76555", "builtin#replicate_i8.tblock_size_76937", "gather_payloads_double.segmap_tblock_size_67001", "gather_payloads_double.segmap_tblock_size_67019", "gather_payloads_double_GFUR.segmap_tblock_size_67281", "gather_payloads_double_GFUR.segmap_tblock_size_67299", "gather_payloads_float.segmap_tblock_size_66945", "gather_payloads_float.segmap_tblock_size_66963", "gather_payloads_float_GFUR.segmap_tblock_size_67225", "gather_payloads_float_GFUR.segmap_tblock_size_67243", "gather_payloads_int.segmap_tblock_size_66833", "gather_payloads_int.segmap_tblock_size_66851", "gather_payloads_int_GFUR.segmap_tblock_size_67113", "gather_payloads_int_GFUR.segmap_tblock_size_67131", "gather_payloads_long.segmap_tblock_size_66889", "gather_payloads_long.segmap_tblock_size_66907", "gather_payloads_long_GFUR.segmap_tblock_size_67169", "gather_payloads_long_GFUR.segmap_tblock_size_67187", "gather_payloads_short.segmap_tblock_size_66777", "gather_payloads_short.segmap_tblock_size_66795", "gather_payloads_short_GFUR.segmap_tblock_size_67057", "gather_payloads_short_GFUR.segmap_tblock_size_67075", "inner_SMJ_double.segmap_num_tblocks_73813", "inner_SMJ_double.segmap_num_tblocks_73855", "inner_SMJ_double.segmap_num_tblocks_73863", "inner_SMJ_double.segmap_tblock_size_72753", "inner_SMJ_double.segmap_tblock_size_73170", "inner_SMJ_double.segmap_tblock_size_73677", "inner_SMJ_double.segmap_tblock_size_73699", "inner_SMJ_double.segmap_tblock_size_73719", "inner_SMJ_double.segmap_tblock_size_73741", "inner_SMJ_double.segmap_tblock_size_73761", "inner_SMJ_double.segmap_tblock_size_73783", "inner_SMJ_double.segmap_tblock_size_73811", "inner_SMJ_double.segmap_tblock_size_73827", "inner_SMJ_double.segmap_tblock_size_73853", "inner_SMJ_double.segmap_tblock_size_73861", "inner_SMJ_double.segmap_tblock_size_73869", "inner_SMJ_double.segscan_num_tblocks_73803", "inner_SMJ_double.segscan_num_tblocks_73819", "inner_SMJ_double.segscan_tblock_size_73801", "inner_SMJ_double.segscan_tblock_size_73817", "inner_SMJ_double.suff_outer_par_0", "inner_SMJ_double.suff_outer_par_1", "inner_SMJ_double.tblock_size_77307", "inner_SMJ_double.tblock_size_77327", "inner_SMJ_double.tile_size_73900", "inner_SMJ_double.tile_size_74255", "inner_SMJ_double.tile_size_74610", "inner_SMJ_double.tile_size_74965", "inner_SMJ_float.segmap_num_tblocks_72503", "inner_SMJ_float.segmap_num_tblocks_72545", "inner_SMJ_float.segmap_num_tblocks_72553", "inner_SMJ_float.segmap_tblock_size_71443", "inner_SMJ_float.segmap_tblock_size_71860", "inner_SMJ_float.segmap_tblock_size_72367", "inner_SMJ_float.segmap_tblock_size_72389", "inner_SMJ_float.segmap_tblock_size_72409", "inner_SMJ_float.segmap_tblock_size_72431", "inner_SMJ_float.segmap_tblock_size_72451", "inner_SMJ_float.segmap_tblock_size_72473", "inner_SMJ_float.segmap_tblock_size_72501", "inner_SMJ_float.segmap_tblock_size_72517", "inner_SMJ_float.segmap_tblock_size_72543", "inner_SMJ_float.segmap_tblock_size_72551", "inner_SMJ_float.segmap_tblock_size_72559", "inner_SMJ_float.segscan_num_tblocks_72493", "inner_SMJ_float.segscan_num_tblocks_72509", "inner_SMJ_float.segscan_tblock_size_72491", "inner_SMJ_float.segscan_tblock_size_72507", "inner_SMJ_float.suff_outer_par_0", "inner_SMJ_float.suff_outer_par_1", "inner_SMJ_float.tblock_size_77307", "inner_SMJ_float.tblock_size_77327", "inner_SMJ_float.tile_size_73900", "inner_SMJ_float.tile_size_74255", "inner_SMJ_float.tile_size_74610", "inner_SMJ_float.tile_size_74965", "inner_SMJ_int.segmap_num_tblocks_69883", "inner_SMJ_int.segmap_num_tblocks_69925", "inner_SMJ_int.segmap_num_tblocks_69933", "inner_SMJ_int.segmap_tblock_size_68823", "inner_SMJ_int.segmap_tblock_size_69240", "inner_SMJ_int.segmap_tblock_size_69747", "inner_SMJ_int.segmap_tblock_size_69769", "inner_SMJ_int.segmap_tblock_size_69789", "inner_SMJ_int.segmap_tblock_size_69811", "inner_SMJ_int.segmap_tblock_size_69831", "inner_SMJ_int.segmap_tblock_size_69853", "inner_SMJ_int.segmap_tblock_size_69881", "inner_SMJ_int.segmap_tblock_size_69897", "inner_SMJ_int.segmap_tblock_size_69923", "inner_SMJ_int.segmap_tblock_size_69931", "inner_SMJ_int.segmap_tblock_size_69939", "inner_SMJ_int.segscan_num_tblocks_69873", "inner_SMJ_int.segscan_num_tblocks_69889", "inner_SMJ_int.segscan_tblock_size_69871", "inner_SMJ_int.segscan_tblock_size_69887", "inner_SMJ_int.suff_outer_par_0", "inner_SMJ_int.suff_outer_par_1", "inner_SMJ_int.tblock_size_77287", "inner_SMJ_int.tblock_size_77307", "inner_SMJ_int.tile_size_73900", "inner_SMJ_int.tile_size_74255", "inner_SMJ_int.tile_size_74610", "inner_SMJ_int.tile_size_74965", "inner_SMJ_long.segmap_num_tblocks_71193", "inner_SMJ_long.segmap_num_tblocks_71235", "inner_SMJ_long.segmap_num_tblocks_71243", "inner_SMJ_long.segmap_tblock_size_70133", "inner_SMJ_long.segmap_tblock_size_70550", "inner_SMJ_long.segmap_tblock_size_71057", "inner_SMJ_long.segmap_tblock_size_71079", "inner_SMJ_long.segmap_tblock_size_71099", "inner_SMJ_long.segmap_tblock_size_71121", "inner_SMJ_long.segmap_tblock_size_71141", "inner_SMJ_long.segmap_tblock_size_71163", "inner_SMJ_long.segmap_tblock_size_71191", "inner_SMJ_long.segmap_tblock_size_71207", "inner_SMJ_long.segmap_tblock_size_71233", "inner_SMJ_long.segmap_tblock_size_71241", "inner_SMJ_long.segmap_tblock_size_71249", "inner_SMJ_long.segscan_num_tblocks_71183", "inner_SMJ_long.segscan_num_tblocks_71199", "inner_SMJ_long.segscan_tblock_size_71181", "inner_SMJ_long.segscan_tblock_size_71197", "inner_SMJ_long.suff_outer_par_0", "inner_SMJ_long.suff_outer_par_1", "inner_SMJ_long.tblock_size_77287", "inner_SMJ_long.tblock_size_77307", "inner_SMJ_long.tile_size_73900", "inner_SMJ_long.tile_size_74255", "inner_SMJ_long.tile_size_74610", "inner_SMJ_long.tile_size_74965", "inner_SMJ_short.segmap_num_tblocks_68573", "inner_SMJ_short.segmap_num_tblocks_68615", "inner_SMJ_short.segmap_num_tblocks_68623", "inner_SMJ_short.segmap_tblock_size_67513", "inner_SMJ_short.segmap_tblock_size_67930", "inner_SMJ_short.segmap_tblock_size_68437", "inner_SMJ_short.segmap_tblock_size_68459", "inner_SMJ_short.segmap_tblock_size_68479", "inner_SMJ_short.segmap_tblock_size_68501", "inner_SMJ_short.segmap_tblock_size_68521", "inner_SMJ_short.segmap_tblock_size_68543", "inner_SMJ_short.segmap_tblock_size_68571", "inner_SMJ_short.segmap_tblock_size_68587", "inner_SMJ_short.segmap_tblock_size_68613", "inner_SMJ_short.segmap_tblock_size_68621", "inner_SMJ_short.segmap_tblock_size_68629", "inner_SMJ_short.segscan_num_tblocks_68563", "inner_SMJ_short.segscan_num_tblocks_68579", "inner_SMJ_short.segscan_tblock_size_68561", "inner_SMJ_short.segscan_tblock_size_68577", "inner_SMJ_short.suff_outer_par_0", "inner_SMJ_short.suff_outer_par_1", "inner_SMJ_short.tblock_size_77307", "inner_SMJ_short.tblock_size_77327", "inner_SMJ_short.tile_size_73900", "inner_SMJ_short.tile_size_74255", "inner_SMJ_short.tile_size_74610", "inner_SMJ_short.tile_size_74965", "max_idx.segred_num_tblocks_66767", "max_idx.segred_tblock_size_66765", "min_idx.segred_num_tblocks_66757", "min_idx.segred_tblock_size_66755", NULL};
static const char *tuning_param_vars[] = {"builtinzhiota_i64zitblock_sizze_76552", "builtinzhreplicate_f32zitblock_sizze_76581", "builtinzhreplicate_f64zitblock_sizze_76581", "builtinzhreplicate_i16zitblock_sizze_76581", "builtinzhreplicate_i32zitblock_sizze_76963", "builtinzhreplicate_i64zitblock_sizze_76555", "builtinzhreplicate_i8zitblock_sizze_76937", "gather_payloads_doublezisegmap_tblock_sizze_67001", "gather_payloads_doublezisegmap_tblock_sizze_67019", "gather_payloads_double_GFURzisegmap_tblock_sizze_67281", "gather_payloads_double_GFURzisegmap_tblock_sizze_67299", "gather_payloads_floatzisegmap_tblock_sizze_66945", "gather_payloads_floatzisegmap_tblock_sizze_66963", "gather_payloads_float_GFURzisegmap_tblock_sizze_67225", "gather_payloads_float_GFURzisegmap_tblock_sizze_67243", "gather_payloads_intzisegmap_tblock_sizze_66833", "gather_payloads_intzisegmap_tblock_sizze_66851", "gather_payloads_int_GFURzisegmap_tblock_sizze_67113", "gather_payloads_int_GFURzisegmap_tblock_sizze_67131", "gather_payloads_longzisegmap_tblock_sizze_66889", "gather_payloads_longzisegmap_tblock_sizze_66907", "gather_payloads_long_GFURzisegmap_tblock_sizze_67169", "gather_payloads_long_GFURzisegmap_tblock_sizze_67187", "gather_payloads_shortzisegmap_tblock_sizze_66777", "gather_payloads_shortzisegmap_tblock_sizze_66795", "gather_payloads_short_GFURzisegmap_tblock_sizze_67057", "gather_payloads_short_GFURzisegmap_tblock_sizze_67075", "inner_SMJ_doublezisegmap_num_tblocks_73813", "inner_SMJ_doublezisegmap_num_tblocks_73855", "inner_SMJ_doublezisegmap_num_tblocks_73863", "inner_SMJ_doublezisegmap_tblock_sizze_72753", "inner_SMJ_doublezisegmap_tblock_sizze_73170", "inner_SMJ_doublezisegmap_tblock_sizze_73677", "inner_SMJ_doublezisegmap_tblock_sizze_73699", "inner_SMJ_doublezisegmap_tblock_sizze_73719", "inner_SMJ_doublezisegmap_tblock_sizze_73741", "inner_SMJ_doublezisegmap_tblock_sizze_73761", "inner_SMJ_doublezisegmap_tblock_sizze_73783", "inner_SMJ_doublezisegmap_tblock_sizze_73811", "inner_SMJ_doublezisegmap_tblock_sizze_73827", "inner_SMJ_doublezisegmap_tblock_sizze_73853", "inner_SMJ_doublezisegmap_tblock_sizze_73861", "inner_SMJ_doublezisegmap_tblock_sizze_73869", "inner_SMJ_doublezisegscan_num_tblocks_73803", "inner_SMJ_doublezisegscan_num_tblocks_73819", "inner_SMJ_doublezisegscan_tblock_sizze_73801", "inner_SMJ_doublezisegscan_tblock_sizze_73817", "inner_SMJ_doublezisuff_outer_par_0", "inner_SMJ_doublezisuff_outer_par_1", "inner_SMJ_doublezitblock_sizze_77307", "inner_SMJ_doublezitblock_sizze_77327", "inner_SMJ_doublezitile_sizze_73900", "inner_SMJ_doublezitile_sizze_74255", "inner_SMJ_doublezitile_sizze_74610", "inner_SMJ_doublezitile_sizze_74965", "inner_SMJ_floatzisegmap_num_tblocks_72503", "inner_SMJ_floatzisegmap_num_tblocks_72545", "inner_SMJ_floatzisegmap_num_tblocks_72553", "inner_SMJ_floatzisegmap_tblock_sizze_71443", "inner_SMJ_floatzisegmap_tblock_sizze_71860", "inner_SMJ_floatzisegmap_tblock_sizze_72367", "inner_SMJ_floatzisegmap_tblock_sizze_72389", "inner_SMJ_floatzisegmap_tblock_sizze_72409", "inner_SMJ_floatzisegmap_tblock_sizze_72431", "inner_SMJ_floatzisegmap_tblock_sizze_72451", "inner_SMJ_floatzisegmap_tblock_sizze_72473", "inner_SMJ_floatzisegmap_tblock_sizze_72501", "inner_SMJ_floatzisegmap_tblock_sizze_72517", "inner_SMJ_floatzisegmap_tblock_sizze_72543", "inner_SMJ_floatzisegmap_tblock_sizze_72551", "inner_SMJ_floatzisegmap_tblock_sizze_72559", "inner_SMJ_floatzisegscan_num_tblocks_72493", "inner_SMJ_floatzisegscan_num_tblocks_72509", "inner_SMJ_floatzisegscan_tblock_sizze_72491", "inner_SMJ_floatzisegscan_tblock_sizze_72507", "inner_SMJ_floatzisuff_outer_par_0", "inner_SMJ_floatzisuff_outer_par_1", "inner_SMJ_floatzitblock_sizze_77307", "inner_SMJ_floatzitblock_sizze_77327", "inner_SMJ_floatzitile_sizze_73900", "inner_SMJ_floatzitile_sizze_74255", "inner_SMJ_floatzitile_sizze_74610", "inner_SMJ_floatzitile_sizze_74965", "inner_SMJ_intzisegmap_num_tblocks_69883", "inner_SMJ_intzisegmap_num_tblocks_69925", "inner_SMJ_intzisegmap_num_tblocks_69933", "inner_SMJ_intzisegmap_tblock_sizze_68823", "inner_SMJ_intzisegmap_tblock_sizze_69240", "inner_SMJ_intzisegmap_tblock_sizze_69747", "inner_SMJ_intzisegmap_tblock_sizze_69769", "inner_SMJ_intzisegmap_tblock_sizze_69789", "inner_SMJ_intzisegmap_tblock_sizze_69811", "inner_SMJ_intzisegmap_tblock_sizze_69831", "inner_SMJ_intzisegmap_tblock_sizze_69853", "inner_SMJ_intzisegmap_tblock_sizze_69881", "inner_SMJ_intzisegmap_tblock_sizze_69897", "inner_SMJ_intzisegmap_tblock_sizze_69923", "inner_SMJ_intzisegmap_tblock_sizze_69931", "inner_SMJ_intzisegmap_tblock_sizze_69939", "inner_SMJ_intzisegscan_num_tblocks_69873", "inner_SMJ_intzisegscan_num_tblocks_69889", "inner_SMJ_intzisegscan_tblock_sizze_69871", "inner_SMJ_intzisegscan_tblock_sizze_69887", "inner_SMJ_intzisuff_outer_par_0", "inner_SMJ_intzisuff_outer_par_1", "inner_SMJ_intzitblock_sizze_77287", "inner_SMJ_intzitblock_sizze_77307", "inner_SMJ_intzitile_sizze_73900", "inner_SMJ_intzitile_sizze_74255", "inner_SMJ_intzitile_sizze_74610", "inner_SMJ_intzitile_sizze_74965", "inner_SMJ_longzisegmap_num_tblocks_71193", "inner_SMJ_longzisegmap_num_tblocks_71235", "inner_SMJ_longzisegmap_num_tblocks_71243", "inner_SMJ_longzisegmap_tblock_sizze_70133", "inner_SMJ_longzisegmap_tblock_sizze_70550", "inner_SMJ_longzisegmap_tblock_sizze_71057", "inner_SMJ_longzisegmap_tblock_sizze_71079", "inner_SMJ_longzisegmap_tblock_sizze_71099", "inner_SMJ_longzisegmap_tblock_sizze_71121", "inner_SMJ_longzisegmap_tblock_sizze_71141", "inner_SMJ_longzisegmap_tblock_sizze_71163", "inner_SMJ_longzisegmap_tblock_sizze_71191", "inner_SMJ_longzisegmap_tblock_sizze_71207", "inner_SMJ_longzisegmap_tblock_sizze_71233", "inner_SMJ_longzisegmap_tblock_sizze_71241", "inner_SMJ_longzisegmap_tblock_sizze_71249", "inner_SMJ_longzisegscan_num_tblocks_71183", "inner_SMJ_longzisegscan_num_tblocks_71199", "inner_SMJ_longzisegscan_tblock_sizze_71181", "inner_SMJ_longzisegscan_tblock_sizze_71197", "inner_SMJ_longzisuff_outer_par_0", "inner_SMJ_longzisuff_outer_par_1", "inner_SMJ_longzitblock_sizze_77287", "inner_SMJ_longzitblock_sizze_77307", "inner_SMJ_longzitile_sizze_73900", "inner_SMJ_longzitile_sizze_74255", "inner_SMJ_longzitile_sizze_74610", "inner_SMJ_longzitile_sizze_74965", "inner_SMJ_shortzisegmap_num_tblocks_68573", "inner_SMJ_shortzisegmap_num_tblocks_68615", "inner_SMJ_shortzisegmap_num_tblocks_68623", "inner_SMJ_shortzisegmap_tblock_sizze_67513", "inner_SMJ_shortzisegmap_tblock_sizze_67930", "inner_SMJ_shortzisegmap_tblock_sizze_68437", "inner_SMJ_shortzisegmap_tblock_sizze_68459", "inner_SMJ_shortzisegmap_tblock_sizze_68479", "inner_SMJ_shortzisegmap_tblock_sizze_68501", "inner_SMJ_shortzisegmap_tblock_sizze_68521", "inner_SMJ_shortzisegmap_tblock_sizze_68543", "inner_SMJ_shortzisegmap_tblock_sizze_68571", "inner_SMJ_shortzisegmap_tblock_sizze_68587", "inner_SMJ_shortzisegmap_tblock_sizze_68613", "inner_SMJ_shortzisegmap_tblock_sizze_68621", "inner_SMJ_shortzisegmap_tblock_sizze_68629", "inner_SMJ_shortzisegscan_num_tblocks_68563", "inner_SMJ_shortzisegscan_num_tblocks_68579", "inner_SMJ_shortzisegscan_tblock_sizze_68561", "inner_SMJ_shortzisegscan_tblock_sizze_68577", "inner_SMJ_shortzisuff_outer_par_0", "inner_SMJ_shortzisuff_outer_par_1", "inner_SMJ_shortzitblock_sizze_77307", "inner_SMJ_shortzitblock_sizze_77327", "inner_SMJ_shortzitile_sizze_73900", "inner_SMJ_shortzitile_sizze_74255", "inner_SMJ_shortzitile_sizze_74610", "inner_SMJ_shortzitile_sizze_74965", "max_idxzisegred_num_tblocks_66767", "max_idxzisegred_tblock_sizze_66765", "min_idxzisegred_num_tblocks_66757", "min_idxzisegred_tblock_sizze_66755", NULL};
static const char *tuning_param_classes[] = {"thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", NULL};
static int64_t tuning_param_defaults[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
static const int max_failure_args = 2;
static const int f64_required = 1;
static const char *gpu_program[] = {"#define FUTHARK_CUDA\n// start of prelude.cu\n\n#define SCALAR_FUN_ATTR __device__ static inline\n#define FUTHARK_FUN_ATTR __device__ static\n#define FUTHARK_F64_ENABLED\n\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\n\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\n\nstatic inline __device__ int get_tblock_id(int d) {\n  switch (d) {\n  case 0: return blockIdx.x;\n  case 1: return blockIdx.y;\n  case 2: return blockIdx.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_num_tblocks(int d) {\n  switch(d) {\n  case 0: return gridDim.x;\n  case 1: return gridDim.y;\n  case 2: return gridDim.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x + blockIdx.x * blockDim.x;\n    case 1: return threadIdx.y + blockIdx.y * blockDim.y;\n    case 2: return threadIdx.z + blockIdx.z * blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x;\n    case 1: return threadIdx.y;\n    case 2: return threadIdx.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_size(int d) {\n  switch (d) {\n    case 0: return blockDim.x;\n    case 1: return blockDim.y;\n    case 2: return blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_size(int d) {\n  switch (d) {\n    case 0: return gridDim.x * blockDim.x;\n    case 1: return gridDim.y * blockDim.y;\n    case 2: return gridDim.z * blockDim.z;\n    default: return 0;\n  }\n}\n\n\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline __device__ void barrier(int x) {\n  __syncthreads();\n}\nstatic inline __device__ void mem_fence_local() {\n  __threadfence_block();\n}\nstatic inline __device__ void mem_fence_global", "() {\n  __threadfence();\n}\n\nstatic inline __device__ void barrier_local() {\n  __syncthreads();\n}\n\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ unsigned char shared_mem[];\n\n#define SHARED_MEM_PARAM\n#define FUTHARK_KERNEL extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define FUTHARK_KERNEL_SIZED(a,b,c) extern \"C\" __global__ __launch_bounds__(a*b*c)\n\n// End of prelude.cu\n// Start of half.h.\n\n// Conversion functions are from http://half.sourceforge.net/, but\n// translated to C.\n//\n// Copyright (c) 2012-2021 Christian Rau\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n#ifndef __OPENCL_VERSION__\n#define __constant\n#endif\n\n__constant static const uint16_t base_table[512] = {\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0", "000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,\n  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,\n  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8",
                                    "000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,\n  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,\n  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };\n\n__constant static const unsigned char shift_table[512] = {\n  24, 24, 24, 24, 24, 24,", " 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2", "4, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };\n\n__constant static const uint32_t mantissa_table[2048] = {\n  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,\n  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,\n  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,\n  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,\n  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,\n  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,\n  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,\n  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,\n  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,\n  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x37",
                                    "1B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,\n  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,\n  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,\n  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,\n  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,\n  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,\n  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,\n  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,\n  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,\n  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,\n  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,\n  0x", "37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,\n  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,\n  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,\n  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,\n  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,\n  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,\n  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,\n  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,\n  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,\n  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,\n  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x", "37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,\n  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,\n  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,\n  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,\n  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,\n  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,\n  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,\n  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,\n  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,\n  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,\n  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x",
                                    "38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,\n  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,\n  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,\n  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,\n  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,\n  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,\n  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,\n  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,\n  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,\n  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,\n  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x", "384BC000,\n  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,\n  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,\n  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,\n  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,\n  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,\n  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,\n  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,\n  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,\n  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,\n  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,\n  0x38740000, 0x38744000, 0x38748000, 0x3874C000, ", "0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,\n  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,\n  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,\n  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,\n  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,\n  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,\n  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,\n  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,\n  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,\n  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,\n  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, ",
                                    "0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,\n  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,\n  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,\n  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,\n  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,\n  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,\n  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,\n  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,\n  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,\n  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,\n  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, ", "0x3823C000, 0x3823E000,\n  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,\n  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,\n  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,\n  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,\n  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,\n  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,\n  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,\n  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,\n  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,\n  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,\n  0x38380000, 0x38382000, 0x38384000", ", 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,\n  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,\n  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,\n  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,\n  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,\n  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,\n  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,\n  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,\n  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,\n  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,\n  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000",
                                    ", 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,\n  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,\n  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,\n  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,\n  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,\n  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,\n  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,\n  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,\n  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,\n  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,\n  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000", ", 0x3861A000, 0x3861C000, 0x3861E000,\n  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,\n  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,\n  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,\n  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,\n  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,\n  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,\n  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,\n  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,\n  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,\n  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,\n  0x38760000, 0x387620", "00, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,\n  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,\n  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,\n  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,\n  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };\n__constant static const uint32_t exponent_table[64] = {\n  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,\n  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,\n  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,\n  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };\n__constant static const unsigned short offset_table[64] = {\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1",
                                    "024, 1024, 1024, 1024, 1024, 1024,\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };\n\nSCALAR_FUN_ATTR uint16_t float2halfbits(float value) {\n  union { float x; uint32_t y; } u;\n  u.x = value;\n  uint32_t bits = u.y;\n\n  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;\n\n  return hbits;\n}\n\nSCALAR_FUN_ATTR float halfbits2float(uint16_t value) {\n  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];\n\n  union { uint32_t x; float y; } u;\n  u.x = bits;\n  return u.y;\n}\n\nSCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {\n  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;\n  if(fabs > 0x7C00 || tabs > 0x7C00) {\n    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);\n  }\n  if(from == to || !(fabs|tabs)) {\n    return to;\n  }\n  if(!fabs) {\n    return (to&0x8000)+1;\n  }\n  unsigned int out =\n    from +\n    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)\n    - 1;\n  return out;\n}\n\n// End of half.h.\n// Start of scalar.h.\n\n// Implementation of the primitive scalar operations.  Very\n// repetitive.  This code is inserted directly into both CUDA and\n// OpenCL programs, as well as the CPU code, so it has some #ifdefs to\n// work everywhere.  Some operations are defined as macros because\n// this allows us to use them as constant expressions in things like\n// array sizes and static initialisers.\n\n// Some of the #ifdefs are because OpenCL uses type-generic functions\n// for some operations (e.g. sqrt), while C and CUDA sensibly use\n// distinct functions for different precisions (e.g. sqrtf() and\n// sqrt()).  This is quite annoying.  Due to C's unfortunate casting\n// rules, it is also really easy to accidentally implement\n// floating-point functions in the wrong precision, so be careful.\n\n/", "/ Double-precision definitions are only included if the preprocessor\n// macro FUTHARK_F64_ENABLED is set.\n\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);\n\nSCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {\n  return x * y;\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  // This strange pattern is used to prevent the ISPC compiler from\n  // causing SIGFPEs and bogus results on divisions where inactive lanes\n  // have 0-valued divisors. It ensures that any inactive lane instead\n  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  uint", "8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALA",
                                    "R_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t q = x / ys;\n  int8_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t q = x / ys;\n  int16_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n  int32_t q = x / ys;\n  int32_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t q = x / ys;\n  int64_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y)", " {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int32_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) ", "{\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  ",
                                    "foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\n#else\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  return", " y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t q = x / y;\n  int8_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t q = x / y;\n  int16_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t q = x / y;\n  int32_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t q = x / y;\n  int64_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t r = ", "x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t ",
                                    "y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {\n  return (uint8_t)(x << y);\n}\n\nS", "CALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {\n  return (uint16_t)(x << y);\n}\n\nSCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult64(uint64_t x, uint64", "_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {\n  uint8_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {\n  uint16_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {\n  uint32_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {\n  uint64_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x",
                                    ") {\n  return x;\n}\n\nSCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {\n  return x;\n}\n\n#define sext_i8_i8(x) ((int8_t) (int8_t) (x))\n#define sext_i8_i16(x) ((int16_t) (int8_t) (x))\n#define sext_i8_i32(x) ((int32_t) (int8_t) (x))\n#define sext_i8_i64(x) ((int64_t) (int8_t) (x))\n#define sext_i16_i8(x) ((int8_t) (int16_t) (x))\n#define sext_i16_i16(x) ((int16_t) (int16_t) (x))\n#define sext_i16_i32(x) ((int32_t) (int16_t) (x))\n#define sext_i16_i64(x) ((int64_t) (int16_t) (x))\n#define sext_i32_i8(x) ((int8_t) (int32_t) (x))\n#define sext_i32_i16(x) ((int16_t) (int32_t) (x))\n#define sext_i32_i32(x) ((int32_t) (int32_t) (x))\n#define sext_i32_i64(x) ((int64_t) (int32_t) (x))\n#define sext_i64_i8(x) ((int8_t) (int64_t) (x))\n#define sext_i64_i16(x) ((int16_t) (int64_t) (x))\n#define sext_i64_i32(x) ((int32_t) (int64_t) (x))\n#define sext_i64_i64(x) ((int64_t) (int64_t) (x))\n#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))\n#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))\n#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))\n#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))\n#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))\n#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))\n#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))\n#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))\n#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))\n#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))\n#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))\n#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))\n#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))\n#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))\n#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))\n#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))\n\nSCALAR_FUN_ATTR int8_t abs8(int8_t x) {\n  return (int8_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int16_t abs16(int16_t x) {\n  return (int16_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int32_t abs32(int32_t x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR int64_t abs64(int64_t x) {\n#if defined(__OPENCL_VER", "SION__) || defined(ISPC)\n  return abs(x);\n#else\n  return llabs(x);\n#endif\n}\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return __popc(zext_i8_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return __popc(zext_i16_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return __popc(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return __popcll(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return m", "ul_hi(a, b); }\n#elif defined(__CUDA_ARCH__)\nSCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }\nSCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }\n#elif ISPC\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 = al * bl;\n  uint64_t p2 = al * bh;\n  uint64_t p3 = ah * bl;\n  uint64_t p4 = ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\nSCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR int",
                                    "32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 =  al * bl;\n  int64_t  p2 = al * bh;\n  int64_t  p3 = ah * bl;\n  uint64_t p4 =  ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\n\n#else // Not OpenCL, ISPC, or CUDA, but plain C.\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }\nSCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t ", "a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }\n#else // Not OpenCL\n\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return clz(x);\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return __clz(zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return __clz(zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  retur", "n __clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return __clzll(x);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return count_leading_zeros((int32_t)(uint8_t)x)-24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return count_leading_zeros((int32_t)(uint16_t)x)-16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return count_leading_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return count_leading_zeros(x);\n}\n\n#else // Not OpenCL, ISPC or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_clz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int i = 0;\n  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int i = 0;\n  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int i = 0;\n  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int i = 0;\n  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 8 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 16 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 32 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int y = __ffsll(x);\n  return y == 0 ? 64 : y - 1",
                                    ";\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return count_trailing_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return count_trailing_zeros(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);\n}\n#endif\n\nSCALAR_FUN_ATTR float fdiv32(float x, float y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR float fadd32(float x, float y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR float fsub32(float x, float y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR float fmul32(float x, float y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt32(float x, float y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple32(float x, float y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {\n  return (float) x;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, f", "loat y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return pow(x, y);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float a, float b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\n#else // Not OpenCL, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return powf(x, y);\n}\n#endif\n\nSCALAR_FUN_ATTR bool futrts_isnan32(float x) {\n  return isnan(x);\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite32(float x) {\n  return !isnan(x) && !futrts_isinf32(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return isinf(x);\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  };\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {", "\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f32_bool(float x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR float btof_bool_f32(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinh(x);\n}\n\nSC",
                                    "ALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fma(a, b, c);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return futrts_log32(x) / log(2.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return futrts_log32(x) / log(10.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;\n  float y = 1.0f + x;\n  float z = y - 1.0f;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform float cbrtf(uniform float);\nSCALAR_FUN_ATTR float futrts_cbrt32(float", " x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return (exp(x)+exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return (exp(x)-exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return futrts_sinh32(x)/futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  float f = x+sqrt(x*x-1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  float f = x+sqrt(x*x+1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  float f = (1+x)/(1-x);\n  if(futrts_isfinite32(f)) return log(f)/2.0f;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {\n    x = abs(x);\n    y = abs(y);\n    float a;\n    float b;\n    if (x >= y){\n        a = x;\n        b = y;\n    } else {\n        a = y;\n        b = x;\n    }\n    if(b == 0){\n      return a;\n    }\n\n    int e;\n    float an;\n    float bn;\n    an = frexp (a, &e);\n    bn = ldexp (b, - e);\n    float cn;\n    cn = sqrt (an * an + bn * bn);\n    return ldexp (cn, e);\n  } else {\n    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;\n    else return x + y;\n  }\n\n}\n\nextern \"C\" unmasked uniform float tgammaf(", "uniform float x);\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = tgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = lgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erff(uniform float x);\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erff(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erfcf(uniform float x);\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erfcf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform float nextafterf(uniform float x, uniform float y);\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  float res;\n  foreach_active (i) {\n    uniform float r = nextafterf(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  int32_t xb = futrts_to_bits32(x);\n  int32_t yb = futrts_to_bits32(y);\n  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futr",
                                    "ts_fma32(float a, float b, float c) {\n  return a * b + c;\n}\n\n#else // Not OpenCL or ISPC, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return logf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1pf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return expf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  re", "turn rintf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floorf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceilf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafterf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexpf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysignf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fmaf(a, b, c);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  return intbits(x);\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  return floatbits(x);\n}\n#else\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  union {\n    float f;\n    int32_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  union {\n    int32_t f;\n    float t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\nSCALAR_FUN_ATTR float fsignum32(float x) {\n  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf64(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite64(float x) {\n  return !isnan(x) && !futrts_isinf64(x);\n}\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}", "\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double a, double b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return futrts_log64(x)/log(2.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return futrts_log64(x)/log(10.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;\n  double y = 1.0d + x;\n  double z = y - 1.0d;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform double cbrt(uniform double);\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(dou",
                                    "ble x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return (exp(x)+exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return (exp(x)-exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return futrts_sinh64(x)/futrts_cosh64(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  double f = x+sqrt(x*x-1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  double f = x+sqrt(x*x+1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  double f = (1.0d+x)/(1.0d-x);\n  if(futrts_isfinite64(f)) return log(f)/2.0d;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nextern \"C\" unmasked uniform double hypot(uniform double x, uniform double y);\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = hypot(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double tgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = tgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double lgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = lgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erf(uniform double x);\nSCALAR_FUN_ATTR do", "uble futrts_erf64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erfc(uniform double x);\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erfc(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform double nextafter(uniform float x, uniform double y);\nSCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = nextafter(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int", "16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0.0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1.0 : 0.0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  int64_t res;\n  foreach_active (i) {\n    uniform double tmp = extract(x, i);\n    uniform int64_t r = *((uniform int64_t* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  double res;\n  foreach_active (i) {\n    uniform int64_t tmp = extract(x, i);\n    uniform double r = *((uniform double* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {\n  int64_t xb = futrts_to_bits64(x);\n  int64_t yb = futrts_to_bits64(y);\n  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#e",
                                    "lse\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double x, double y) {\n  return pow(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(double x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  r", "eturn tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erf64(double x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return fma(a, b, c);\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf64(double x) {\n  return isinf(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x", ") {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1 : 0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  union {\n    double f;\n    int64_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  union {\n    int64_t f;\n    double t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n#ifdef __OPENCL_VERSION__\n  return mix(v0, v1, t);\n#else\n  return v0 + (v1 - v0) * t;\n#endif\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n#ifdef __OPENCL_VERSION__\n  return mad(a, b, c);\n#else\n  return a * b + c;\n#endif\n}\n\nSCALAR",
                                    "_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#endif\n\n#endif\n\n// End of scalar.h.\n// Start of scalar_f16.h.\n\n// Half-precision is emulated if needed (e.g. in straight C) with the\n// native type used if possible.  The emulation works by typedef'ing\n// 'float' to 'f16', and then implementing all operations on single\n// precision.  To cut down on duplication, we use the same code for\n// those Futhark functions that require just operators or casts.  The\n// in-memory representation for arrays will still be 16 bits even\n// under emulation, so the compiler will have to be careful when\n// generating reads or writes.\n\n#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))\n#define EMULATE_F16\n#endif\n\n#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)\n#pragma OPENCL EXTENSION cl_khr_fp16 : enable\n#endif\n\n#ifdef EMULATE_F16\n\n// Note that the half-precision storage format is still 16 bits - the\n// compiler will have to be real careful!\ntypedef float f16;\n\n#elif ISPC\ntypedef float16 f16;\n\n#else\n\n#ifdef __CUDA_ARCH__\n#include <cuda_fp16.h>\n#endif\n\ntypedef half f16;\n\n#endif\n\n// Some of these functions convert to single precision because half\n// precision versions are not available.\n\nSCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {\n  return (f16) x;\n}\n\nSCALAR", "_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {\n  return (int8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {\n  return (int16_t) x;\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {\n  return (int32_t) x;\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {\n  return (int64_t) x;\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {\n  return (uint8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {\n  return (uint16_t) x;\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {\n  return (uint32_t) x;\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {\n  return (uint64_t) x;\n}\n\nSCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {\n  return x != (f16)0;\n}\n\nSCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifndef EMULATE_F16\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return isnan((float)x);\n}\n\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#elif ISPC\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#else // Assuming CUDA.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 ", "x, f16 y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return powf(x, y);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf16(float x) {\n  return !futrts_isnan16(x) && futrts_isnan16(x - x);\n}\nSCALAR_FUN_ATTR bool futrts_isfinite16(float x) {\n  return !futrts_isnan16(x) && !futrts_isinf16(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return isinf((float)x);\n}\n#endif\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return e",
                                    "rf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fma(a, b, c);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log16(x) / log(2.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log16(x) / log(10.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;\n  f16 y = 1.0f16 + x;\n  f16 z = y - 1.0f16;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return (float16)sqrt((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return (float16)cos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return (float16)sin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return (float16)tan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return (float16)acos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return (float16)asin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return (float16)atan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  retu", "rn (exp(x)+exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return (exp(x)-exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_sinh16(x)/futrts_cosh16(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x-1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x+1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  float16 f = (1+x)/(1-x);\n  if(futrts_isfinite16(f)) return log(f)/2.0f16;\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return (float16)atan2((float)x, (float)y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return (float16)futrts_hypot32((float)x, (float)y);\n}\n\nextern \"C\" unmasked uniform float tgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)tgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)lgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  f16 res = (f16)futrts_cbrt32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  f16 res = (f16)futrts_erf32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  f16 res = (f16)futrts_erfc32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return x - y * (float16)trunc((float) (x/y));\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return (float16)round((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return (float16)floor((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return (float16)ceil((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrt", "s_nextafter16(f16 x, f16 y) {\n  return (float16)futrts_nextafter32((float)x, (float) y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\n#else // Assume CUDA.\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return hlog(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return hlog2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return hlog10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return (f16)log1pf((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return hsqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return hexp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return hcos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return hsin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f1",
                                    "6 x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rintf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return hfloor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return hceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fmaf(a, b, c);\n}\n\n#endif\n\n// The CUDA __half type cannot be put in unions for some reason, so we\n// use bespoke conversion functions instead.\n#ifdef __CUDA_ARCH__\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return __half_as_ushort(x);\n}\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return __ushort_as_half(x);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  varying int16_t y = *((varying int16_t * uniform)&x);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  varying f16 y = *((varying f16 * uniform)&x);\n  return y;\n}\n#else\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  union {\n    f16 f;\n    int16_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  union {\n    int16_t f;\n    f16 t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\n#else // No native f16 - emulate.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs32(x);\n}\n\nSC", "ALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return fpow32(x, y);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return futrts_isnan32(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return futrts_isinf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_log32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log2_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log10_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return futrts_log1p_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return futrts_sqrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return futrts_cbrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return futrts_exp32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return futrts_cos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return futrts_sin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return futrts_tan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return futrts_acos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return futrts_asin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return futrts_atan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return futrts_sinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_tanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return futrts_acosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return futrts_asinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return futrts_atanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return futrts_atan2_32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return futrts_hypot32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return futrts_gamma32(x);\n}\n\nSCA", "LAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return futrts_lgamma32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return futrts_erf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return futrts_erfc32(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return futrts_round32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return futrts_floor32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return futrts_ceil32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return futrts_lerp32(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return futrts_mad32(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return futrts_fma32(a, b, c);\n}\n\n// Even when we are using an OpenCL that does not support cl_khr_fp16,\n// it must still support vload_half for actually creating a\n// half-precision number, which can then be efficiently converted to a\n// float.  Similarly for vstore_half.\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  int16_t y;\n  // Violating strict aliasing here.\n  vstore_half((float)x, 0, (half*)&y);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return (f16)vload_half(0, (half*)&x);\n}\n\n#else\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return (int16_t)float2halfbits(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return halfbits2float((uint16_t)x);\n}\n\nSCALAR_FUN_ATTR f16 fsignum16(f16 x) {\n  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#endif\n\n#endif\n\nSCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {\n  retu",
                                    "rn x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {\n  return (f16) x;\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {\n  return (double) x;\n}\n\n#if ISPC\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) ((float)x);\n}\n#else\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) x;\n}\n#endif\n#endif\n\n\n// End of scalar_f16.h.\n// Start of atomics.h\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32", "_t *p, uint32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x);\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#el", "se\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  float ret;\n  asm volatile(\"atom.global.add.f32 %0,[%1],%2;\":\"=f\"(ret):\"l\"(p),\"f\"(x):\"memory\");\n  return ret;\n#elif defined(__opencl_c_ext_fp32_global_atomic_add)\n  // use hardware-supported atomic addition on some Intel GPUs\n  return atomic_fetch_add_explicit((volatile __global atomic_float*)p,\n                                   x,\n                                   memory_order_relaxed);\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f32)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f32(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  float old = x;\n  float ret;\n  while ((old=atomic_xchg(p, ret=atomic_xchg(p, 0.0f)+old))!=0.0f);\n  return ret;\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_shared((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile",
                                    " __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, ", "int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR uint", "64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x);\n\n#ifdef FUTHARK_F64_ENABLED\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x);\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x);\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val) {\n#if defined(F",
                                    "UTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  double ret;\n  asm volatile(\"atom.global.add.f64 %0,[%1],%2;\":\"=d\"(ret):\"l\"(p),\"d\"(x):\"memory\");\n  return ret;\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f64)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f64(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  union {int64_t i; double f;} old;\n  union {int64_t i; double f;} ret;\n  old.f = x;\n  while (1) {\n    ret.i = atom_xchg((volatile __global int64_t*)p, (int64_t)0);\n    ret.f += old.f;\n    old.i = atom_xchg((volatile __global int64_t*)p, ret.i);\n    if (old.i == 0) {\n      break;\n    }\n  }\n  return ret.f;\n#endif\n}\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  u", "nion { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do ", "{\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(v",
                                    "olatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n#endif // defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\n// End of atomics.h\n// Start of transpose.cl\n\n#define GEN_TRANSPOSE_KERNELS(NAME, ELEM_TYPE)                          \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_PER_THREAD, 1)\\\nvoid map_transpose_##NAME(SHARED_MEM_PARAM                              \\\n                          __global ELEM_TYPE *dst_mem,                  \\\n                          int64_t dst_offset,                           \\\n                          __global ELEM_TYPE *src_mem,                  \\\n                          int64_t src_offset,                           \\\n                          int32_t num_arrays,                           \\\n                          int32_t x_elems,                              \\\n                          int32_t y_elems,                              \\\n                          int32_t mulx,                                 \\\n                          int32_t muly,                                 \\\n                          int32_t repeat_1,                             \\\n                          int32_t repeat_2) {                           \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_g", "lobal_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = global_id_0;                                    \\\n      int32_t y_index = tblock_id_1 * TR_TILE_DIM + get_local_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_in", "dex + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_height(SHARED_MEM_PARAM                 \\\n                                                __global ELEM_TYPE *dst_mem, \\\n                                                int64_t dst_offset,     \\\n                                                __global ELEM_TYPE *src_mem, \\\n                                                int64_t src_offset,     \\\n                                                int32_t num_arrays,     \\\n                                                int32_t x_elems,        \\\n                                                int32_t y_elems,        \\\n                                                int32_t mulx,           \\\n                                                int32_t muly,           \\\n                                                int32_t repeat_1,       \\\n ",
                                    "                                               int32_t repeat_2) {     \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index =                                                 \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n        get_local_id(0) +                                               \\\n        get_local_id(1)%mulx * TR_BLOCK_DIM;                            \\\n      int32_t y_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(1)/mulx; \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(0)/mulx;      \\\n      y_index =                                                         \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n", "        get_local_id(1) +                                               \\\n        (get_local_id(0)%mulx) * TR_BLOCK_DIM;                          \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n      if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_width(SHARED_MEM_PARAM                  \\\n                                      __global ELEM_TYPE *dst_mem,      \\\n                                      int64_t dst_offset,               \\\n                                      __global ELEM_TYPE *src_mem,      \\\n                                      int64_t src_offset,               \\\n                                      int32_t num_arrays,               \\\n                                      int32_t x_elems,                  \\\n                                      int32_t y_elems,                  \\\n                                      int32_t mulx,                     \\\n                                      int32_t muly,                     \\\n                                      int32_t repeat_1,                 \\\n  ", "                                    int32_t repeat_2) {               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(0)/muly; \\\n      int32_t y_index =                                                 \\\n        tblock_id_1 * TR_BLOCK_DIM * muly +                             \\\n        get_local_id(1) + (get_local_id(0)%muly) * TR_BLOCK_DIM;        \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM * muly +                     \\\n        get_local_id(0) + (get_local_id(1)%muly) * TR_BLOCK_DIM;        \\\n      y_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(1)/muly;      \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n ",
                                    "     if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_num_tblocks(2) * get_local_size(2);            \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_num_tblocks(1) * get_local_size(1);              \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*TR_BLOCK_DIM, 1, 1)                   \\\nvoid map_transpose_##NAME##_small(SHARED_MEM_PARAM                       \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int32_t num_arrays,                   \\\n                                  int32_t x_elems,                      \\\n                                  int32_t y_elems,                      \\\n                                  int32_t mulx,                         \\\n                                  int32_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  ", "int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = global_id_0/(y_elems * x_elems) * y_elems * x_elems; \\\n      int32_t x_index = (global_id_0 % (y_elems * x_elems))/y_elems;    \\\n      int32_t y_index = global_id_0%y_elems;                            \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      int32_t index_out = x_index * y_elems + y_index;                  \\\n      if (global_id_0 < x_elems * y_elems * num_arrays) {               \\\n        dst_mem[odata_offset + index_out] = src_mem[idata_offset + index_in]; \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_", "PER_THREAD, 1)\\\nvoid map_transpose_##NAME##_large(SHARED_MEM_PARAM                      \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int64_t num_arrays,                   \\\n                                  int64_t x_elems,                      \\\n                                  int64_t y_elems,                      \\\n                                  int64_t mulx,                         \\\n                                  int64_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;             \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int64_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int64_t odata_offset = dst_offset + our_array_offset;             \\\n      int64_t idata_offset = src_offset + our_array_offset;             \\\n      int64_t x_index = global_id_0;                                    \\\n      int64_t y_index = tblock_id_1 * TR_TILE_DIM + get_loc",
                                    "al_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                      ", "                             \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n\nGEN_TRANSPOSE_KERNELS(1b, uint8_t)\nGEN_TRANSPOSE_KERNELS(2b, uint16_t)\nGEN_TRANSPOSE_KERNELS(4b, uint32_t)\nGEN_TRANSPOSE_KERNELS(8b, uint64_t)\n\n// End of transpose.cl\n// Start of copy.cl\n\n#define GEN_COPY_KERNEL(NAME, ELEM_TYPE) \\\nFUTHARK_KERNEL void lmad_copy_##NAME(SHARED_MEM_PARAM                   \\\n                               __global ELEM_TYPE *dst_mem,             \\\n                               int64_t dst_offset,                      \\\n                               __global ELEM_TYPE *src_mem,             \\\n                               int64_t src_offset,                      \\\n                               int64_t n,                               \\\n                               int r,                                   \\\n                               int64_t shape0, int64_t dst_stride0, int64_t src_stride0, \\\n                               int64_t shape1, int64_t dst_stride1, int64_t src_stride1, \\\n                               int64_t shape2, int64_t dst_stride2, int64_t src_stride2, \\\n                               int64_t shape3, int64_t dst_stride3, int64_t src_stride3, \\\n                               int64_t shape4, int64_t dst_stride4, int64_t src_stride4, \\\n                               int64_t shape5, int64_t dst_stride5, int64_t src_stride5, \\\n                               int64_t shape6, int64_t dst_stride6, int64_t src_stride6, \\\n                               int64_t shape7, int64_t dst_stride7, int64_t src_stride7) { \\\n  int64_t gtid = get_global_id(0);                                      \\\n  int64_t remainder = gtid;                                             \\\n                                             ", "                           \\\n  if (gtid >= n) {                                                      \\\n    return;                                                             \\\n  }                                                                     \\\n                                                                        \\\n  if (r > 0) {                                                          \\\n    int64_t i = remainder % shape0;                                     \\\n    dst_offset += i * dst_stride0;                                      \\\n    src_offset += i * src_stride0;                                      \\\n    remainder /= shape0;                                                \\\n  }                                                                     \\\n  if (r > 1) {                                                          \\\n    int64_t i = remainder % shape1;                                     \\\n    dst_offset += i * dst_stride1;                                      \\\n    src_offset += i * src_stride1;                                      \\\n    remainder /= shape1;                                                \\\n  }                                                                     \\\n  if (r > 2) {                                                          \\\n    int64_t i = remainder % shape2;                                     \\\n    dst_offset += i * dst_stride2;                                      \\\n    src_offset += i * src_stride2;                                      \\\n    remainder /= shape2;                                                \\\n  }                                                                     \\\n  if (r > 3) {                                                          \\\n    int64_t i = remainder % shape3;                                     \\\n    dst_offset += i * dst_stride3;                                      \\\n    src_offset += i * src_stride3;                                      \\\n    remainder /= shape3;                       ",
                                    "                         \\\n  }                                                                     \\\n  if (r > 4) {                                                          \\\n    int64_t i = remainder % shape4;                                     \\\n    dst_offset += i * dst_stride4;                                      \\\n    src_offset += i * src_stride4;                                      \\\n    remainder /= shape4;                                                \\\n  }                                                                     \\\n  if (r > 5) {                                                          \\\n    int64_t i = remainder % shape5;                                     \\\n    dst_offset += i * dst_stride5;                                      \\\n    src_offset += i * src_stride5;                                      \\\n    remainder /= shape5;                                                \\\n  }                                                                     \\\n  if (r > 6) {                                                          \\\n    int64_t i = remainder % shape6;                                     \\\n    dst_offset += i * dst_stride6;                                      \\\n    src_offset += i * src_stride6;                                      \\\n    remainder /= shape6;                                                \\\n  }                                                                     \\\n  if (r > 7) {                                                          \\\n    int64_t i = remainder % shape7;                                     \\\n    dst_offset += i * dst_stride7;                                      \\\n    src_offset += i * src_stride7;                                      \\\n    remainder /= shape7;                                                \\\n  }                                                                     \\\n                                                                        \\\n  dst_mem[dst_offset] = src_mem[src_offset];     ", "                       \\\n}\n\nGEN_COPY_KERNEL(1b, uint8_t)\nGEN_COPY_KERNEL(2b, uint16_t)\nGEN_COPY_KERNEL(4b, uint32_t)\nGEN_COPY_KERNEL(8b, uint64_t)\n\n// End of copy.cl\n\n\n\nFUTHARK_KERNEL\nvoid builtinzhiota_i64ziiota_i64_76548(int64_t n_76544, int64_t x_76545, int64_t s_76546, int64_t virt_num_tblocks_76553, int64_t num_tblocks_76554, __global unsigned char *mem_76543)\n{\n    int32_t iota_ltid_76549;\n    int32_t tblock_sizze_76551;\n    int32_t iota_gid_76550;\n    int32_t iota_gtid_76548;\n    int32_t phys_tblock_id_76555;\n    int32_t iterations_76556;\n    \n    iota_ltid_76549 = get_local_id(0);\n    tblock_sizze_76551 = get_local_size(0);\n    iota_gid_76550 = get_tblock_id(0);\n    iota_gtid_76548 = iota_gid_76550 * tblock_sizze_76551 + iota_ltid_76549;\n    phys_tblock_id_76555 = get_tblock_id(0);\n    iterations_76556 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76553) - phys_tblock_id_76555, sext_i64_i32(num_tblocks_76554));\n    for (int32_t i_76557 = 0; i_76557 < iterations_76556; i_76557++) {\n        int32_t virt_tblock_id_76558;\n        int64_t global_tid_76559;\n        \n        virt_tblock_id_76558 = phys_tblock_id_76555 + i_76557 * sext_i64_i32(num_tblocks_76554);\n        global_tid_76559 = sext_i32_i64(virt_tblock_id_76558) * sext_i32_i64(tblock_sizze_76551) + sext_i32_i64(iota_ltid_76549);\n        if (slt64(global_tid_76559, n_76544)) {\n            ((__global int64_t *) mem_76543)[global_tid_76559] = add64(mul64(global_tid_76559, s_76546), x_76545);\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f32zireplicate_76577(int64_t num_elems_76573, float val_76574, int64_t replicate_n_76576, int64_t virt_num_tblocks_76582, int64_t num_tblocks_76583, __global unsigned char *mem_76572)\n{\n    int32_t replicate_ltid_76578;\n    int32_t tblock_sizze_76580;\n    int32_t replicate_gid_76579;\n    int32_t replicate_gtid_76577;\n    int32_t phys_tblock_id_76584;\n    int32_t iterations_76585;\n", "    \n    replicate_ltid_76578 = get_local_id(0);\n    tblock_sizze_76580 = get_local_size(0);\n    replicate_gid_76579 = get_tblock_id(0);\n    replicate_gtid_76577 = replicate_gid_76579 * tblock_sizze_76580 + replicate_ltid_76578;\n    phys_tblock_id_76584 = get_tblock_id(0);\n    iterations_76585 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76582) - phys_tblock_id_76584, sext_i64_i32(num_tblocks_76583));\n    for (int32_t i_76586 = 0; i_76586 < iterations_76585; i_76586++) {\n        int32_t virt_tblock_id_76587;\n        int64_t global_tid_76588;\n        int64_t slice_76590;\n        int64_t rep_i_76589;\n        int64_t remnant_76591;\n        \n        virt_tblock_id_76587 = phys_tblock_id_76584 + i_76586 * sext_i64_i32(num_tblocks_76583);\n        global_tid_76588 = sext_i32_i64(virt_tblock_id_76587) * sext_i32_i64(tblock_sizze_76580) + sext_i32_i64(replicate_ltid_76578);\n        slice_76590 = num_elems_76573;\n        rep_i_76589 = global_tid_76588;\n        remnant_76591 = global_tid_76588 - rep_i_76589;\n        if (slt64(global_tid_76588, replicate_n_76576)) {\n            ((__global float *) mem_76572)[rep_i_76589] = val_76574;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f64zireplicate_76577(int64_t num_elems_76573, double val_76574, int64_t replicate_n_76576, int64_t virt_num_tblocks_76582, int64_t num_tblocks_76583, __global unsigned char *mem_76572)\n{\n    int32_t replicate_ltid_76578;\n    int32_t tblock_sizze_76580;\n    int32_t replicate_gid_76579;\n    int32_t replicate_gtid_76577;\n    int32_t phys_tblock_id_76584;\n    int32_t iterations_76585;\n    \n    replicate_ltid_76578 = get_local_id(0);\n    tblock_sizze_76580 = get_local_size(0);\n    replicate_gid_76579 = get_tblock_id(0);\n    replicate_gtid_76577 = replicate_gid_76579 * tblock_sizze_76580 + replicate_ltid_76578;\n    phys_tblock_id_76584 = get_tblock_id(0);\n    iterations_76585 = sdiv_up32(sext_i64_i32(virt_num_tblo",
                                    "cks_76582) - phys_tblock_id_76584, sext_i64_i32(num_tblocks_76583));\n    for (int32_t i_76586 = 0; i_76586 < iterations_76585; i_76586++) {\n        int32_t virt_tblock_id_76587;\n        int64_t global_tid_76588;\n        int64_t slice_76590;\n        int64_t rep_i_76589;\n        int64_t remnant_76591;\n        \n        virt_tblock_id_76587 = phys_tblock_id_76584 + i_76586 * sext_i64_i32(num_tblocks_76583);\n        global_tid_76588 = sext_i32_i64(virt_tblock_id_76587) * sext_i32_i64(tblock_sizze_76580) + sext_i32_i64(replicate_ltid_76578);\n        slice_76590 = num_elems_76573;\n        rep_i_76589 = global_tid_76588;\n        remnant_76591 = global_tid_76588 - rep_i_76589;\n        if (slt64(global_tid_76588, replicate_n_76576)) {\n            ((__global double *) mem_76572)[rep_i_76589] = val_76574;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i16zireplicate_76577(int64_t num_elems_76573, int16_t val_76574, int64_t replicate_n_76576, int64_t virt_num_tblocks_76582, int64_t num_tblocks_76583, __global unsigned char *mem_76572)\n{\n    int32_t replicate_ltid_76578;\n    int32_t tblock_sizze_76580;\n    int32_t replicate_gid_76579;\n    int32_t replicate_gtid_76577;\n    int32_t phys_tblock_id_76584;\n    int32_t iterations_76585;\n    \n    replicate_ltid_76578 = get_local_id(0);\n    tblock_sizze_76580 = get_local_size(0);\n    replicate_gid_76579 = get_tblock_id(0);\n    replicate_gtid_76577 = replicate_gid_76579 * tblock_sizze_76580 + replicate_ltid_76578;\n    phys_tblock_id_76584 = get_tblock_id(0);\n    iterations_76585 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76582) - phys_tblock_id_76584, sext_i64_i32(num_tblocks_76583));\n    for (int32_t i_76586 = 0; i_76586 < iterations_76585; i_76586++) {\n        int32_t virt_tblock_id_76587;\n        int64_t global_tid_76588;\n        int64_t slice_76590;\n        int64_t rep_i_76589;\n        int64_t remnant_76591;\n        \n        virt_tblock_i", "d_76587 = phys_tblock_id_76584 + i_76586 * sext_i64_i32(num_tblocks_76583);\n        global_tid_76588 = sext_i32_i64(virt_tblock_id_76587) * sext_i32_i64(tblock_sizze_76580) + sext_i32_i64(replicate_ltid_76578);\n        slice_76590 = num_elems_76573;\n        rep_i_76589 = global_tid_76588;\n        remnant_76591 = global_tid_76588 - rep_i_76589;\n        if (slt64(global_tid_76588, replicate_n_76576)) {\n            ((__global int16_t *) mem_76572)[rep_i_76589] = val_76574;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i32zireplicate_76959(int64_t num_elems_76955, int32_t val_76956, int64_t replicate_n_76958, int64_t virt_num_tblocks_76964, int64_t num_tblocks_76965, __global unsigned char *mem_76954)\n{\n    int32_t replicate_ltid_76960;\n    int32_t tblock_sizze_76962;\n    int32_t replicate_gid_76961;\n    int32_t replicate_gtid_76959;\n    int32_t phys_tblock_id_76966;\n    int32_t iterations_76967;\n    \n    replicate_ltid_76960 = get_local_id(0);\n    tblock_sizze_76962 = get_local_size(0);\n    replicate_gid_76961 = get_tblock_id(0);\n    replicate_gtid_76959 = replicate_gid_76961 * tblock_sizze_76962 + replicate_ltid_76960;\n    phys_tblock_id_76966 = get_tblock_id(0);\n    iterations_76967 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76964) - phys_tblock_id_76966, sext_i64_i32(num_tblocks_76965));\n    for (int32_t i_76968 = 0; i_76968 < iterations_76967; i_76968++) {\n        int32_t virt_tblock_id_76969;\n        int64_t global_tid_76970;\n        int64_t slice_76972;\n        int64_t rep_i_76971;\n        int64_t remnant_76973;\n        \n        virt_tblock_id_76969 = phys_tblock_id_76966 + i_76968 * sext_i64_i32(num_tblocks_76965);\n        global_tid_76970 = sext_i32_i64(virt_tblock_id_76969) * sext_i32_i64(tblock_sizze_76962) + sext_i32_i64(replicate_ltid_76960);\n        slice_76972 = num_elems_76955;\n        rep_i_76971 = global_tid_76970;\n        remnant_76973 = global_tid_76970", " - rep_i_76971;\n        if (slt64(global_tid_76970, replicate_n_76958)) {\n            ((__global int32_t *) mem_76954)[rep_i_76971] = val_76956;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i64zireplicate_76551(int64_t num_elems_76547, int64_t val_76548, int64_t replicate_n_76550, int64_t virt_num_tblocks_76556, int64_t num_tblocks_76557, __global unsigned char *mem_76546)\n{\n    int32_t replicate_ltid_76552;\n    int32_t tblock_sizze_76554;\n    int32_t replicate_gid_76553;\n    int32_t replicate_gtid_76551;\n    int32_t phys_tblock_id_76558;\n    int32_t iterations_76559;\n    \n    replicate_ltid_76552 = get_local_id(0);\n    tblock_sizze_76554 = get_local_size(0);\n    replicate_gid_76553 = get_tblock_id(0);\n    replicate_gtid_76551 = replicate_gid_76553 * tblock_sizze_76554 + replicate_ltid_76552;\n    phys_tblock_id_76558 = get_tblock_id(0);\n    iterations_76559 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76556) - phys_tblock_id_76558, sext_i64_i32(num_tblocks_76557));\n    for (int32_t i_76560 = 0; i_76560 < iterations_76559; i_76560++) {\n        int32_t virt_tblock_id_76561;\n        int64_t global_tid_76562;\n        int64_t slice_76564;\n        int64_t rep_i_76563;\n        int64_t remnant_76565;\n        \n        virt_tblock_id_76561 = phys_tblock_id_76558 + i_76560 * sext_i64_i32(num_tblocks_76557);\n        global_tid_76562 = sext_i32_i64(virt_tblock_id_76561) * sext_i32_i64(tblock_sizze_76554) + sext_i32_i64(replicate_ltid_76552);\n        slice_76564 = num_elems_76547;\n        rep_i_76563 = global_tid_76562;\n        remnant_76565 = global_tid_76562 - rep_i_76563;\n        if (slt64(global_tid_76562, replicate_n_76550)) {\n            ((__global int64_t *) mem_76546)[rep_i_76563] = val_76548;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i8zireplicate_76933(int64_t num_elems_7",
                                    "6929, int8_t val_76930, int64_t replicate_n_76932, int64_t virt_num_tblocks_76938, int64_t num_tblocks_76939, __global unsigned char *mem_76928)\n{\n    int32_t replicate_ltid_76934;\n    int32_t tblock_sizze_76936;\n    int32_t replicate_gid_76935;\n    int32_t replicate_gtid_76933;\n    int32_t phys_tblock_id_76940;\n    int32_t iterations_76941;\n    \n    replicate_ltid_76934 = get_local_id(0);\n    tblock_sizze_76936 = get_local_size(0);\n    replicate_gid_76935 = get_tblock_id(0);\n    replicate_gtid_76933 = replicate_gid_76935 * tblock_sizze_76936 + replicate_ltid_76934;\n    phys_tblock_id_76940 = get_tblock_id(0);\n    iterations_76941 = sdiv_up32(sext_i64_i32(virt_num_tblocks_76938) - phys_tblock_id_76940, sext_i64_i32(num_tblocks_76939));\n    for (int32_t i_76942 = 0; i_76942 < iterations_76941; i_76942++) {\n        int32_t virt_tblock_id_76943;\n        int64_t global_tid_76944;\n        int64_t slice_76946;\n        int64_t rep_i_76945;\n        int64_t remnant_76947;\n        \n        virt_tblock_id_76943 = phys_tblock_id_76940 + i_76942 * sext_i64_i32(num_tblocks_76939);\n        global_tid_76944 = sext_i32_i64(virt_tblock_id_76943) * sext_i32_i64(tblock_sizze_76936) + sext_i32_i64(replicate_ltid_76934);\n        slice_76946 = num_elems_76929;\n        rep_i_76945 = global_tid_76944;\n        remnant_76947 = global_tid_76944 - rep_i_76945;\n        if (slt64(global_tid_76944, replicate_n_76932)) {\n            ((__global int8_t *) mem_76928)[rep_i_76945] = val_76930;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_doublezisegmap_67013_dim1, 1, 1)\nvoid gather_payloads_doublezisegmap_67013(__global int *global_failure, int64_t niz2084U_58875, int64_t incr_58877, __global unsigned char *is_mem_75467, __global unsigned char *mem_75471)\n{\n    #define segmap_tblock_sizze_67009 (gather_payloads_doublezisegmap_67013zisegmap_tblock_sizze_67009)\n    if (*global_failure >= 0)\n        return;\n", "    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67013;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67012;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67013 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67009 + sext_i32_i64(local_tid_76545);\n    slice_76550 = niz2084U_58875;\n    gtid_67012 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67012;\n    if (slt64(gtid_67012, niz2084U_58875)) {\n        int64_t eta_p_67014;\n        int64_t lifted_lambda_res_67015;\n        \n        eta_p_67014 = ((__global int64_t *) is_mem_75467)[gtid_67012];\n        lifted_lambda_res_67015 = sub64(eta_p_67014, incr_58877);\n        ((__global int64_t *) mem_75471)[gtid_67012] = lifted_lambda_res_67015;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67009\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_doublezisegmap_67041_dim1, 1, 1)\nvoid gather_payloads_doublezisegmap_67041(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_58875, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75468, __global unsigned char *mem_param_75476, __global unsigned char *mem_param_75479, __global unsigned char *mem_75484)\n{\n    #define segmap_tblock_sizze_67037 (gather_payloads_doublezisegmap_67041zisegmap_tblock_sizze_67037)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    i", "nt64_t phys_tid_67041;\n    int64_t global_tid_76584;\n    int64_t slice_76585;\n    int64_t gtid_67040;\n    int64_t remnant_76586;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    phys_tid_67041 = sext_i32_i64(global_tid_76579);\n    global_tid_76584 = sext_i32_i64(block_id_76581) * segmap_tblock_sizze_67037 + sext_i32_i64(local_tid_76580);\n    slice_76585 = niz2084U_58875;\n    gtid_67040 = global_tid_76584;\n    remnant_76586 = global_tid_76584 - gtid_67040;\n    if (slt64(gtid_67040, niz2084U_58875)) {\n        int64_t eta_p_67042;\n        bool cond_67044;\n        bool cond_t_res_67045;\n        bool x_67046;\n        double lifted_lambda_res_67047;\n        \n        eta_p_67042 = ((__global int64_t *) mem_param_75476)[gtid_67040];\n        cond_67044 = sle64(lower_bound_61616, eta_p_67042);\n        cond_t_res_67045 = slt64(eta_p_67042, min_res_61618);\n        x_67046 = cond_67044 && cond_t_res_67045;\n        if (x_67046) {\n            int64_t tmp_67048;\n            bool x_67049;\n            bool y_67050;\n            bool bounds_check_67051;\n            bool index_certs_67052;\n            double tmp_67053;\n            \n            tmp_67048 = sub64(eta_p_67042, lower_bound_61616);\n            x_67049 = sle64((int64_t) 0, tmp_67048);\n            y_67050 = slt64(tmp_67048, j_m_i_61619);\n            bounds_check_67051 = x_67049 && y_67050;\n            if (!bounds_check_67051) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67048;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67053 = ((__global double *) ys_mem_75468)[et",
                                    "a_p_67042];\n            lifted_lambda_res_67047 = tmp_67053;\n        } else {\n            double eta_p_67043 = ((__global double *) mem_param_75479)[gtid_67040];\n            \n            lifted_lambda_res_67047 = eta_p_67043;\n        }\n        ((__global double *) mem_75484)[gtid_67040] = lifted_lambda_res_67047;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67037\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_double_GFURzisegmap_67293_dim1, 1, 1)\nvoid gather_payloads_double_GFURzisegmap_67293(__global int *global_failure, int64_t ni_60382, int64_t incr_60384, __global unsigned char *is_mem_75468, __global unsigned char *mem_75472)\n{\n    #define segmap_tblock_sizze_67289 (gather_payloads_double_GFURzisegmap_67293zisegmap_tblock_sizze_67289)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67293;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67292;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67293 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67289 + sext_i32_i64(local_tid_76545);\n    slice_76550 = ni_60382;\n    gtid_67292 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67292;\n    if (slt64(gtid_67292, ni_60382)) {\n        int64_t eta_p_67294;\n        int64_t lifted_lambda_res_67295;\n        \n        eta_p_67294 = ((__global int64_t *) is_mem_75468)[gtid_67292];\n        lifted_lambda_res_67295 = sub64(eta_p_67294, incr_60384);\n        ((__global int64_t *) mem_75472)[gtid_67292] = lifted_lambda_res_67295;\n    }\n    \n  error_0:\n    return;\n    #undef ", "segmap_tblock_sizze_67289\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_double_GFURzisegmap_67321_dim1, 1, 1)\nvoid gather_payloads_double_GFURzisegmap_67321(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_60382, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75469, __global unsigned char *mem_param_75475, __global unsigned char *mem_param_75478, __global unsigned char *mem_75483)\n{\n    #define segmap_tblock_sizze_67317 (gather_payloads_double_GFURzisegmap_67321zisegmap_tblock_sizze_67317)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76560;\n    int32_t tblock_sizze_76563;\n    int32_t wave_sizze_76562;\n    int32_t block_id_76561;\n    int32_t global_tid_76559;\n    int64_t phys_tid_67321;\n    int64_t global_tid_76564;\n    int64_t slice_76565;\n    int64_t gtid_67320;\n    int64_t remnant_76566;\n    \n    local_tid_76560 = get_local_id(0);\n    tblock_sizze_76563 = get_local_size(0);\n    wave_sizze_76562 = LOCKSTEP_WIDTH;\n    block_id_76561 = get_tblock_id(0);\n    global_tid_76559 = block_id_76561 * tblock_sizze_76563 + local_tid_76560;\n    phys_tid_67321 = sext_i32_i64(global_tid_76559);\n    global_tid_76564 = sext_i32_i64(block_id_76561) * segmap_tblock_sizze_67317 + sext_i32_i64(local_tid_76560);\n    slice_76565 = ni_60382;\n    gtid_67320 = global_tid_76564;\n    remnant_76566 = global_tid_76564 - gtid_67320;\n    if (slt64(gtid_67320, ni_60382)) {\n        int64_t eta_p_67322;\n        bool cond_67324;\n        bool cond_t_res_67325;\n        bool x_67326;\n        double lifted_lambda_res_67327;\n        \n        eta_p_67322 = ((__global int64_t *) mem_param_75475)[gtid_67320];\n        cond_67324 = sle64(lower_bound_61616, eta_p_67322);\n        cond_t_res_67325 = slt64(eta_p_67322, min_res_61618);\n        x_67326 = cond_67324 && cond_t_res_67325;\n        if (x_67326) {\n            int64_t tmp_67328;\n            bool x_67329;\n            bool y_67", "330;\n            bool bounds_check_67331;\n            bool index_certs_67332;\n            double tmp_67333;\n            \n            tmp_67328 = sub64(eta_p_67322, lower_bound_61616);\n            x_67329 = sle64((int64_t) 0, tmp_67328);\n            y_67330 = slt64(tmp_67328, j_m_i_61619);\n            bounds_check_67331 = x_67329 && y_67330;\n            if (!bounds_check_67331) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67328;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67333 = ((__global double *) ys_mem_75469)[eta_p_67322];\n            lifted_lambda_res_67327 = tmp_67333;\n        } else {\n            double eta_p_67323 = ((__global double *) mem_param_75478)[gtid_67320];\n            \n            lifted_lambda_res_67327 = eta_p_67323;\n        }\n        ((__global double *) mem_75483)[gtid_67320] = lifted_lambda_res_67327;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67317\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_floatzisegmap_66957_dim1, 1, 1)\nvoid gather_payloads_floatzisegmap_66957(__global int *global_failure, int64_t niz2084U_58535, int64_t incr_58537, __global unsigned char *is_mem_75467, __global unsigned char *mem_75471)\n{\n    #define segmap_tblock_sizze_66953 (gather_payloads_floatzisegmap_66957zisegmap_tblock_sizze_66953)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_66957;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_66956;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WID",
                                    "TH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_66957 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_66953 + sext_i32_i64(local_tid_76545);\n    slice_76550 = niz2084U_58535;\n    gtid_66956 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_66956;\n    if (slt64(gtid_66956, niz2084U_58535)) {\n        int64_t eta_p_66958;\n        int64_t lifted_lambda_res_66959;\n        \n        eta_p_66958 = ((__global int64_t *) is_mem_75467)[gtid_66956];\n        lifted_lambda_res_66959 = sub64(eta_p_66958, incr_58537);\n        ((__global int64_t *) mem_75471)[gtid_66956] = lifted_lambda_res_66959;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66953\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_floatzisegmap_66985_dim1, 1, 1)\nvoid gather_payloads_floatzisegmap_66985(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_58535, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75468, __global unsigned char *mem_param_75476, __global unsigned char *mem_param_75479, __global unsigned char *mem_75484)\n{\n    #define segmap_tblock_sizze_66981 (gather_payloads_floatzisegmap_66985zisegmap_tblock_sizze_66981)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    int64_t phys_tid_66985;\n    int64_t global_tid_76584;\n    int64_t slice_76585;\n    int64_t gtid_66984;\n    int64_t remnant_76586;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    phys_tid_66985 = sext_i32_i64(global_", "tid_76579);\n    global_tid_76584 = sext_i32_i64(block_id_76581) * segmap_tblock_sizze_66981 + sext_i32_i64(local_tid_76580);\n    slice_76585 = niz2084U_58535;\n    gtid_66984 = global_tid_76584;\n    remnant_76586 = global_tid_76584 - gtid_66984;\n    if (slt64(gtid_66984, niz2084U_58535)) {\n        int64_t eta_p_66986;\n        bool cond_66988;\n        bool cond_t_res_66989;\n        bool x_66990;\n        float lifted_lambda_res_66991;\n        \n        eta_p_66986 = ((__global int64_t *) mem_param_75476)[gtid_66984];\n        cond_66988 = sle64(lower_bound_61616, eta_p_66986);\n        cond_t_res_66989 = slt64(eta_p_66986, min_res_61618);\n        x_66990 = cond_66988 && cond_t_res_66989;\n        if (x_66990) {\n            int64_t tmp_66992;\n            bool x_66993;\n            bool y_66994;\n            bool bounds_check_66995;\n            bool index_certs_66996;\n            float tmp_66997;\n            \n            tmp_66992 = sub64(eta_p_66986, lower_bound_61616);\n            x_66993 = sle64((int64_t) 0, tmp_66992);\n            y_66994 = slt64(tmp_66992, j_m_i_61619);\n            bounds_check_66995 = x_66993 && y_66994;\n            if (!bounds_check_66995) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_66992;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_66997 = ((__global float *) ys_mem_75468)[eta_p_66986];\n            lifted_lambda_res_66991 = tmp_66997;\n        } else {\n            float eta_p_66987 = ((__global float *) mem_param_75479)[gtid_66984];\n            \n            lifted_lambda_res_66991 = eta_p_66987;\n        }\n        ((__global float *) mem_75484)[gtid_66984] = lifted_lambda_res_66991;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66981\n}\nFUTHARK_KERNEL_SIZED(gather_payl", "oads_float_GFURzisegmap_67237_dim1, 1, 1)\nvoid gather_payloads_float_GFURzisegmap_67237(__global int *global_failure, int64_t ni_60081, int64_t incr_60083, __global unsigned char *is_mem_75468, __global unsigned char *mem_75472)\n{\n    #define segmap_tblock_sizze_67233 (gather_payloads_float_GFURzisegmap_67237zisegmap_tblock_sizze_67233)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67237;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67236;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67237 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67233 + sext_i32_i64(local_tid_76545);\n    slice_76550 = ni_60081;\n    gtid_67236 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67236;\n    if (slt64(gtid_67236, ni_60081)) {\n        int64_t eta_p_67238;\n        int64_t lifted_lambda_res_67239;\n        \n        eta_p_67238 = ((__global int64_t *) is_mem_75468)[gtid_67236];\n        lifted_lambda_res_67239 = sub64(eta_p_67238, incr_60083);\n        ((__global int64_t *) mem_75472)[gtid_67236] = lifted_lambda_res_67239;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67233\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_float_GFURzisegmap_67265_dim1, 1, 1)\nvoid gather_payloads_float_GFURzisegmap_67265(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_60081, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75469, __global unsigned char *mem_param_75475, __global uns",
                                    "igned char *mem_param_75478, __global unsigned char *mem_75483)\n{\n    #define segmap_tblock_sizze_67261 (gather_payloads_float_GFURzisegmap_67265zisegmap_tblock_sizze_67261)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76560;\n    int32_t tblock_sizze_76563;\n    int32_t wave_sizze_76562;\n    int32_t block_id_76561;\n    int32_t global_tid_76559;\n    int64_t phys_tid_67265;\n    int64_t global_tid_76564;\n    int64_t slice_76565;\n    int64_t gtid_67264;\n    int64_t remnant_76566;\n    \n    local_tid_76560 = get_local_id(0);\n    tblock_sizze_76563 = get_local_size(0);\n    wave_sizze_76562 = LOCKSTEP_WIDTH;\n    block_id_76561 = get_tblock_id(0);\n    global_tid_76559 = block_id_76561 * tblock_sizze_76563 + local_tid_76560;\n    phys_tid_67265 = sext_i32_i64(global_tid_76559);\n    global_tid_76564 = sext_i32_i64(block_id_76561) * segmap_tblock_sizze_67261 + sext_i32_i64(local_tid_76560);\n    slice_76565 = ni_60081;\n    gtid_67264 = global_tid_76564;\n    remnant_76566 = global_tid_76564 - gtid_67264;\n    if (slt64(gtid_67264, ni_60081)) {\n        int64_t eta_p_67266;\n        bool cond_67268;\n        bool cond_t_res_67269;\n        bool x_67270;\n        float lifted_lambda_res_67271;\n        \n        eta_p_67266 = ((__global int64_t *) mem_param_75475)[gtid_67264];\n        cond_67268 = sle64(lower_bound_61616, eta_p_67266);\n        cond_t_res_67269 = slt64(eta_p_67266, min_res_61618);\n        x_67270 = cond_67268 && cond_t_res_67269;\n        if (x_67270) {\n            int64_t tmp_67272;\n            bool x_67273;\n            bool y_67274;\n            bool bounds_check_67275;\n            bool index_certs_67276;\n            float tmp_67277;\n            \n            tmp_67272 = sub64(eta_p_67266, lower_bound_61616);\n            x_67273 = sle64((int64_t) 0, tmp_67272);\n            y_67274 = slt64(tmp_67272, j_m_i_61619);\n            bounds_check_67275 = x_67273 && y_67274;\n            if (!bounds_check_67275) {\n                {\n                    if (atom", "ic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67272;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67277 = ((__global float *) ys_mem_75469)[eta_p_67266];\n            lifted_lambda_res_67271 = tmp_67277;\n        } else {\n            float eta_p_67267 = ((__global float *) mem_param_75478)[gtid_67264];\n            \n            lifted_lambda_res_67271 = eta_p_67267;\n        }\n        ((__global float *) mem_75483)[gtid_67264] = lifted_lambda_res_67271;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67261\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_intzisegmap_66845_dim1, 1, 1)\nvoid gather_payloads_intzisegmap_66845(__global int *global_failure, int64_t niz2084U_57886, int64_t incr_57888, __global unsigned char *is_mem_75467, __global unsigned char *mem_75471)\n{\n    #define segmap_tblock_sizze_66841 (gather_payloads_intzisegmap_66845zisegmap_tblock_sizze_66841)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_66845;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_66844;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_66845 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_66841 + sext_i32_i64(local_tid_76545);\n    slice_76550 = niz2084U_57886;\n    gtid_66844 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_66844;\n    if (slt64(gtid_66844, niz20", "84U_57886)) {\n        int64_t eta_p_66846;\n        int64_t lifted_lambda_res_66847;\n        \n        eta_p_66846 = ((__global int64_t *) is_mem_75467)[gtid_66844];\n        lifted_lambda_res_66847 = sub64(eta_p_66846, incr_57888);\n        ((__global int64_t *) mem_75471)[gtid_66844] = lifted_lambda_res_66847;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66841\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_intzisegmap_66873_dim1, 1, 1)\nvoid gather_payloads_intzisegmap_66873(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_57886, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75468, __global unsigned char *mem_param_75476, __global unsigned char *mem_param_75479, __global unsigned char *mem_75484)\n{\n    #define segmap_tblock_sizze_66869 (gather_payloads_intzisegmap_66873zisegmap_tblock_sizze_66869)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    int64_t phys_tid_66873;\n    int64_t global_tid_76584;\n    int64_t slice_76585;\n    int64_t gtid_66872;\n    int64_t remnant_76586;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    phys_tid_66873 = sext_i32_i64(global_tid_76579);\n    global_tid_76584 = sext_i32_i64(block_id_76581) * segmap_tblock_sizze_66869 + sext_i32_i64(local_tid_76580);\n    slice_76585 = niz2084U_57886;\n    gtid_66872 = global_tid_76584;\n    remnant_76586 = global_tid_76584 - gtid_66872;\n    if (slt64(gtid_66872, niz2084U_57886)) {\n        int64_t eta_p_66874;\n        bool cond_66876;\n        bool cond_t_res_66877;\n        bool x_66878;\n        int32_t lifted_lambda_res_66879;\n      ",
                                    "  \n        eta_p_66874 = ((__global int64_t *) mem_param_75476)[gtid_66872];\n        cond_66876 = sle64(lower_bound_61616, eta_p_66874);\n        cond_t_res_66877 = slt64(eta_p_66874, min_res_61618);\n        x_66878 = cond_66876 && cond_t_res_66877;\n        if (x_66878) {\n            int64_t tmp_66880;\n            bool x_66881;\n            bool y_66882;\n            bool bounds_check_66883;\n            bool index_certs_66884;\n            int32_t tmp_66885;\n            \n            tmp_66880 = sub64(eta_p_66874, lower_bound_61616);\n            x_66881 = sle64((int64_t) 0, tmp_66880);\n            y_66882 = slt64(tmp_66880, j_m_i_61619);\n            bounds_check_66883 = x_66881 && y_66882;\n            if (!bounds_check_66883) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_66880;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_66885 = ((__global int32_t *) ys_mem_75468)[eta_p_66874];\n            lifted_lambda_res_66879 = tmp_66885;\n        } else {\n            int32_t eta_p_66875 = ((__global int32_t *) mem_param_75479)[gtid_66872];\n            \n            lifted_lambda_res_66879 = eta_p_66875;\n        }\n        ((__global int32_t *) mem_75484)[gtid_66872] = lifted_lambda_res_66879;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66869\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_int_GFURzisegmap_67125_dim1, 1, 1)\nvoid gather_payloads_int_GFURzisegmap_67125(__global int *global_failure, int64_t ni_59479, int64_t incr_59481, __global unsigned char *is_mem_75468, __global unsigned char *mem_75472)\n{\n    #define segmap_tblock_sizze_67121 (gather_payloads_int_GFURzisegmap_67125zisegmap_tblock_sizze_67121)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_", "sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67125;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67124;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67125 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67121 + sext_i32_i64(local_tid_76545);\n    slice_76550 = ni_59479;\n    gtid_67124 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67124;\n    if (slt64(gtid_67124, ni_59479)) {\n        int64_t eta_p_67126;\n        int64_t lifted_lambda_res_67127;\n        \n        eta_p_67126 = ((__global int64_t *) is_mem_75468)[gtid_67124];\n        lifted_lambda_res_67127 = sub64(eta_p_67126, incr_59481);\n        ((__global int64_t *) mem_75472)[gtid_67124] = lifted_lambda_res_67127;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67121\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_int_GFURzisegmap_67153_dim1, 1, 1)\nvoid gather_payloads_int_GFURzisegmap_67153(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_59479, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75469, __global unsigned char *mem_param_75475, __global unsigned char *mem_param_75478, __global unsigned char *mem_75483)\n{\n    #define segmap_tblock_sizze_67149 (gather_payloads_int_GFURzisegmap_67153zisegmap_tblock_sizze_67149)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76560;\n    int32_t tblock_sizze_76563;\n    int32_t wave_sizze_76562;\n    int32_t block_id_76561;\n    int32_t global_tid_76559;\n    int64_t phys_tid_67153;\n    int64_t global_tid_76564;\n    int64_t ", "slice_76565;\n    int64_t gtid_67152;\n    int64_t remnant_76566;\n    \n    local_tid_76560 = get_local_id(0);\n    tblock_sizze_76563 = get_local_size(0);\n    wave_sizze_76562 = LOCKSTEP_WIDTH;\n    block_id_76561 = get_tblock_id(0);\n    global_tid_76559 = block_id_76561 * tblock_sizze_76563 + local_tid_76560;\n    phys_tid_67153 = sext_i32_i64(global_tid_76559);\n    global_tid_76564 = sext_i32_i64(block_id_76561) * segmap_tblock_sizze_67149 + sext_i32_i64(local_tid_76560);\n    slice_76565 = ni_59479;\n    gtid_67152 = global_tid_76564;\n    remnant_76566 = global_tid_76564 - gtid_67152;\n    if (slt64(gtid_67152, ni_59479)) {\n        int64_t eta_p_67154;\n        bool cond_67156;\n        bool cond_t_res_67157;\n        bool x_67158;\n        int32_t lifted_lambda_res_67159;\n        \n        eta_p_67154 = ((__global int64_t *) mem_param_75475)[gtid_67152];\n        cond_67156 = sle64(lower_bound_61616, eta_p_67154);\n        cond_t_res_67157 = slt64(eta_p_67154, min_res_61618);\n        x_67158 = cond_67156 && cond_t_res_67157;\n        if (x_67158) {\n            int64_t tmp_67160;\n            bool x_67161;\n            bool y_67162;\n            bool bounds_check_67163;\n            bool index_certs_67164;\n            int32_t tmp_67165;\n            \n            tmp_67160 = sub64(eta_p_67154, lower_bound_61616);\n            x_67161 = sle64((int64_t) 0, tmp_67160);\n            y_67162 = slt64(tmp_67160, j_m_i_61619);\n            bounds_check_67163 = x_67161 && y_67162;\n            if (!bounds_check_67163) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67160;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67165 = ((__global int32_t *) ys_mem_75469)[eta_p_67154];\n            lifted_lambda_res_67159 = tmp_67165;\n        } els",
                                    "e {\n            int32_t eta_p_67155 = ((__global int32_t *) mem_param_75478)[gtid_67152];\n            \n            lifted_lambda_res_67159 = eta_p_67155;\n        }\n        ((__global int32_t *) mem_75483)[gtid_67152] = lifted_lambda_res_67159;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67149\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_longzisegmap_66901_dim1, 1, 1)\nvoid gather_payloads_longzisegmap_66901(__global int *global_failure, int64_t niz2084U_58195, int64_t incr_58197, __global unsigned char *is_mem_75467, __global unsigned char *mem_75471)\n{\n    #define segmap_tblock_sizze_66897 (gather_payloads_longzisegmap_66901zisegmap_tblock_sizze_66897)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_66901;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_66900;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_66901 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_66897 + sext_i32_i64(local_tid_76545);\n    slice_76550 = niz2084U_58195;\n    gtid_66900 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_66900;\n    if (slt64(gtid_66900, niz2084U_58195)) {\n        int64_t eta_p_66902;\n        int64_t lifted_lambda_res_66903;\n        \n        eta_p_66902 = ((__global int64_t *) is_mem_75467)[gtid_66900];\n        lifted_lambda_res_66903 = sub64(eta_p_66902, incr_58197);\n        ((__global int64_t *) mem_75471)[gtid_66900] = lifted_lambda_res_66903;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66897\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_longziseg", "map_66929_dim1, 1, 1)\nvoid gather_payloads_longzisegmap_66929(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_58195, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75468, __global unsigned char *mem_param_75476, __global unsigned char *mem_param_75479, __global unsigned char *mem_75484)\n{\n    #define segmap_tblock_sizze_66925 (gather_payloads_longzisegmap_66929zisegmap_tblock_sizze_66925)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    int64_t phys_tid_66929;\n    int64_t global_tid_76584;\n    int64_t slice_76585;\n    int64_t gtid_66928;\n    int64_t remnant_76586;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    phys_tid_66929 = sext_i32_i64(global_tid_76579);\n    global_tid_76584 = sext_i32_i64(block_id_76581) * segmap_tblock_sizze_66925 + sext_i32_i64(local_tid_76580);\n    slice_76585 = niz2084U_58195;\n    gtid_66928 = global_tid_76584;\n    remnant_76586 = global_tid_76584 - gtid_66928;\n    if (slt64(gtid_66928, niz2084U_58195)) {\n        int64_t eta_p_66930;\n        bool cond_66932;\n        bool cond_t_res_66933;\n        bool x_66934;\n        int64_t lifted_lambda_res_66935;\n        \n        eta_p_66930 = ((__global int64_t *) mem_param_75476)[gtid_66928];\n        cond_66932 = sle64(lower_bound_61616, eta_p_66930);\n        cond_t_res_66933 = slt64(eta_p_66930, min_res_61618);\n        x_66934 = cond_66932 && cond_t_res_66933;\n        if (x_66934) {\n            int64_t tmp_66936;\n            bool x_66937;\n            bool y_66938;\n            bool bounds_check_66939;\n            bool index_certs_66940", ";\n            int64_t tmp_66941;\n            \n            tmp_66936 = sub64(eta_p_66930, lower_bound_61616);\n            x_66937 = sle64((int64_t) 0, tmp_66936);\n            y_66938 = slt64(tmp_66936, j_m_i_61619);\n            bounds_check_66939 = x_66937 && y_66938;\n            if (!bounds_check_66939) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_66936;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_66941 = ((__global int64_t *) ys_mem_75468)[eta_p_66930];\n            lifted_lambda_res_66935 = tmp_66941;\n        } else {\n            int64_t eta_p_66931 = ((__global int64_t *) mem_param_75479)[gtid_66928];\n            \n            lifted_lambda_res_66935 = eta_p_66931;\n        }\n        ((__global int64_t *) mem_75484)[gtid_66928] = lifted_lambda_res_66935;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66925\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_long_GFURzisegmap_67181_dim1, 1, 1)\nvoid gather_payloads_long_GFURzisegmap_67181(__global int *global_failure, int64_t ni_59780, int64_t incr_59782, __global unsigned char *is_mem_75468, __global unsigned char *mem_75472)\n{\n    #define segmap_tblock_sizze_67177 (gather_payloads_long_GFURzisegmap_67181zisegmap_tblock_sizze_67177)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67181;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67180;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 =",
                                    " block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67181 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67177 + sext_i32_i64(local_tid_76545);\n    slice_76550 = ni_59780;\n    gtid_67180 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67180;\n    if (slt64(gtid_67180, ni_59780)) {\n        int64_t eta_p_67182;\n        int64_t lifted_lambda_res_67183;\n        \n        eta_p_67182 = ((__global int64_t *) is_mem_75468)[gtid_67180];\n        lifted_lambda_res_67183 = sub64(eta_p_67182, incr_59782);\n        ((__global int64_t *) mem_75472)[gtid_67180] = lifted_lambda_res_67183;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67177\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_long_GFURzisegmap_67209_dim1, 1, 1)\nvoid gather_payloads_long_GFURzisegmap_67209(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_59780, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75469, __global unsigned char *mem_param_75475, __global unsigned char *mem_param_75478, __global unsigned char *mem_75483)\n{\n    #define segmap_tblock_sizze_67205 (gather_payloads_long_GFURzisegmap_67209zisegmap_tblock_sizze_67205)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76560;\n    int32_t tblock_sizze_76563;\n    int32_t wave_sizze_76562;\n    int32_t block_id_76561;\n    int32_t global_tid_76559;\n    int64_t phys_tid_67209;\n    int64_t global_tid_76564;\n    int64_t slice_76565;\n    int64_t gtid_67208;\n    int64_t remnant_76566;\n    \n    local_tid_76560 = get_local_id(0);\n    tblock_sizze_76563 = get_local_size(0);\n    wave_sizze_76562 = LOCKSTEP_WIDTH;\n    block_id_76561 = get_tblock_id(0);\n    global_tid_76559 = block_id_76561 * tblock_sizze_76563 + local_tid_76560;\n    phys_tid_67209 = sext_i32_i64(global_tid_76559);\n    global_tid_76564 = sext_i32_i64(block_id_76561) * segma", "p_tblock_sizze_67205 + sext_i32_i64(local_tid_76560);\n    slice_76565 = ni_59780;\n    gtid_67208 = global_tid_76564;\n    remnant_76566 = global_tid_76564 - gtid_67208;\n    if (slt64(gtid_67208, ni_59780)) {\n        int64_t eta_p_67210;\n        bool cond_67212;\n        bool cond_t_res_67213;\n        bool x_67214;\n        int64_t lifted_lambda_res_67215;\n        \n        eta_p_67210 = ((__global int64_t *) mem_param_75475)[gtid_67208];\n        cond_67212 = sle64(lower_bound_61616, eta_p_67210);\n        cond_t_res_67213 = slt64(eta_p_67210, min_res_61618);\n        x_67214 = cond_67212 && cond_t_res_67213;\n        if (x_67214) {\n            int64_t tmp_67216;\n            bool x_67217;\n            bool y_67218;\n            bool bounds_check_67219;\n            bool index_certs_67220;\n            int64_t tmp_67221;\n            \n            tmp_67216 = sub64(eta_p_67210, lower_bound_61616);\n            x_67217 = sle64((int64_t) 0, tmp_67216);\n            y_67218 = slt64(tmp_67216, j_m_i_61619);\n            bounds_check_67219 = x_67217 && y_67218;\n            if (!bounds_check_67219) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67216;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67221 = ((__global int64_t *) ys_mem_75469)[eta_p_67210];\n            lifted_lambda_res_67215 = tmp_67221;\n        } else {\n            int64_t eta_p_67211 = ((__global int64_t *) mem_param_75478)[gtid_67208];\n            \n            lifted_lambda_res_67215 = eta_p_67211;\n        }\n        ((__global int64_t *) mem_75483)[gtid_67208] = lifted_lambda_res_67215;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67205\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_shortzisegmap_66789_dim1, 1, 1)\nvoid gather_payloads_shortzisegmap", "_66789(__global int *global_failure, int64_t niz2084U_57574, int64_t incr_57576, __global unsigned char *is_mem_75467, __global unsigned char *mem_75471)\n{\n    #define segmap_tblock_sizze_66785 (gather_payloads_shortzisegmap_66789zisegmap_tblock_sizze_66785)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_66789;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_66788;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_66789 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_66785 + sext_i32_i64(local_tid_76545);\n    slice_76550 = niz2084U_57574;\n    gtid_66788 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_66788;\n    if (slt64(gtid_66788, niz2084U_57574)) {\n        int64_t eta_p_66790;\n        int64_t lifted_lambda_res_66791;\n        \n        eta_p_66790 = ((__global int64_t *) is_mem_75467)[gtid_66788];\n        lifted_lambda_res_66791 = sub64(eta_p_66790, incr_57576);\n        ((__global int64_t *) mem_75471)[gtid_66788] = lifted_lambda_res_66791;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66785\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_shortzisegmap_66817_dim1, 1, 1)\nvoid gather_payloads_shortzisegmap_66817(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t niz2084U_57574, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75468, __global unsigned char *mem_param_75476, __global unsigned char *mem_param_75479, __global unsigned char *mem_75484)\n{\n    #d",
                                    "efine segmap_tblock_sizze_66813 (gather_payloads_shortzisegmap_66817zisegmap_tblock_sizze_66813)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    int64_t phys_tid_66817;\n    int64_t global_tid_76584;\n    int64_t slice_76585;\n    int64_t gtid_66816;\n    int64_t remnant_76586;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    phys_tid_66817 = sext_i32_i64(global_tid_76579);\n    global_tid_76584 = sext_i32_i64(block_id_76581) * segmap_tblock_sizze_66813 + sext_i32_i64(local_tid_76580);\n    slice_76585 = niz2084U_57574;\n    gtid_66816 = global_tid_76584;\n    remnant_76586 = global_tid_76584 - gtid_66816;\n    if (slt64(gtid_66816, niz2084U_57574)) {\n        int64_t eta_p_66818;\n        bool cond_66820;\n        bool cond_t_res_66821;\n        bool x_66822;\n        int16_t lifted_lambda_res_66823;\n        \n        eta_p_66818 = ((__global int64_t *) mem_param_75476)[gtid_66816];\n        cond_66820 = sle64(lower_bound_61616, eta_p_66818);\n        cond_t_res_66821 = slt64(eta_p_66818, min_res_61618);\n        x_66822 = cond_66820 && cond_t_res_66821;\n        if (x_66822) {\n            int64_t tmp_66824;\n            bool x_66825;\n            bool y_66826;\n            bool bounds_check_66827;\n            bool index_certs_66828;\n            int16_t tmp_66829;\n            \n            tmp_66824 = sub64(eta_p_66818, lower_bound_61616);\n            x_66825 = sle64((int64_t) 0, tmp_66824);\n            y_66826 = slt64(tmp_66824, j_m_i_61619);\n            bounds_check_66827 = x_66825 && y_66826;\n            if (!bounds_check_66827) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 8) == -1) {\n       ", "                 global_failure_args[0] = (int64_t) tmp_66824;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_66829 = ((__global int16_t *) ys_mem_75468)[eta_p_66818];\n            lifted_lambda_res_66823 = tmp_66829;\n        } else {\n            int16_t eta_p_66819 = ((__global int16_t *) mem_param_75479)[gtid_66816];\n            \n            lifted_lambda_res_66823 = eta_p_66819;\n        }\n        ((__global int16_t *) mem_75484)[gtid_66816] = lifted_lambda_res_66823;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_66813\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_short_GFURzisegmap_67069_dim1, 1, 1)\nvoid gather_payloads_short_GFURzisegmap_67069(__global int *global_failure, int64_t ni_59178, int64_t incr_59180, __global unsigned char *is_mem_75468, __global unsigned char *mem_75472)\n{\n    #define segmap_tblock_sizze_67065 (gather_payloads_short_GFURzisegmap_67069zisegmap_tblock_sizze_67065)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76545;\n    int32_t tblock_sizze_76548;\n    int32_t wave_sizze_76547;\n    int32_t block_id_76546;\n    int32_t global_tid_76544;\n    int64_t phys_tid_67069;\n    int64_t global_tid_76549;\n    int64_t slice_76550;\n    int64_t gtid_67068;\n    int64_t remnant_76551;\n    \n    local_tid_76545 = get_local_id(0);\n    tblock_sizze_76548 = get_local_size(0);\n    wave_sizze_76547 = LOCKSTEP_WIDTH;\n    block_id_76546 = get_tblock_id(0);\n    global_tid_76544 = block_id_76546 * tblock_sizze_76548 + local_tid_76545;\n    phys_tid_67069 = sext_i32_i64(global_tid_76544);\n    global_tid_76549 = sext_i32_i64(block_id_76546) * segmap_tblock_sizze_67065 + sext_i32_i64(local_tid_76545);\n    slice_76550 = ni_59178;\n    gtid_67068 = global_tid_76549;\n    remnant_76551 = global_tid_76549 - gtid_67068;\n    if (slt64(gtid_67068, ni_59178)) {\n        int64_t eta_p_67070;\n       ", " int64_t lifted_lambda_res_67071;\n        \n        eta_p_67070 = ((__global int64_t *) is_mem_75468)[gtid_67068];\n        lifted_lambda_res_67071 = sub64(eta_p_67070, incr_59180);\n        ((__global int64_t *) mem_75472)[gtid_67068] = lifted_lambda_res_67071;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67065\n}\nFUTHARK_KERNEL_SIZED(gather_payloads_short_GFURzisegmap_67097_dim1, 1, 1)\nvoid gather_payloads_short_GFURzisegmap_67097(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_59178, int64_t lower_bound_61616, int64_t min_res_61618, int64_t j_m_i_61619, __global unsigned char *ys_mem_75469, __global unsigned char *mem_param_75475, __global unsigned char *mem_param_75478, __global unsigned char *mem_75483)\n{\n    #define segmap_tblock_sizze_67093 (gather_payloads_short_GFURzisegmap_67097zisegmap_tblock_sizze_67093)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76560;\n    int32_t tblock_sizze_76563;\n    int32_t wave_sizze_76562;\n    int32_t block_id_76561;\n    int32_t global_tid_76559;\n    int64_t phys_tid_67097;\n    int64_t global_tid_76564;\n    int64_t slice_76565;\n    int64_t gtid_67096;\n    int64_t remnant_76566;\n    \n    local_tid_76560 = get_local_id(0);\n    tblock_sizze_76563 = get_local_size(0);\n    wave_sizze_76562 = LOCKSTEP_WIDTH;\n    block_id_76561 = get_tblock_id(0);\n    global_tid_76559 = block_id_76561 * tblock_sizze_76563 + local_tid_76560;\n    phys_tid_67097 = sext_i32_i64(global_tid_76559);\n    global_tid_76564 = sext_i32_i64(block_id_76561) * segmap_tblock_sizze_67093 + sext_i32_i64(local_tid_76560);\n    slice_76565 = ni_59178;\n    gtid_67096 = global_tid_76564;\n    remnant_76566 = global_tid_76564 - gtid_67096;\n    if (slt64(gtid_67096, ni_59178)) {\n        int64_t eta_p_67098;\n        bool cond_67100;\n        bool cond_t_res_67101;\n        bool x_67102;\n        int16_t lifted_lambda_res_67103;\n        \n        eta_p_67098 = ((__global int64_t *) ",
                                    "mem_param_75475)[gtid_67096];\n        cond_67100 = sle64(lower_bound_61616, eta_p_67098);\n        cond_t_res_67101 = slt64(eta_p_67098, min_res_61618);\n        x_67102 = cond_67100 && cond_t_res_67101;\n        if (x_67102) {\n            int64_t tmp_67104;\n            bool x_67105;\n            bool y_67106;\n            bool bounds_check_67107;\n            bool index_certs_67108;\n            int16_t tmp_67109;\n            \n            tmp_67104 = sub64(eta_p_67098, lower_bound_61616);\n            x_67105 = sle64((int64_t) 0, tmp_67104);\n            y_67106 = slt64(tmp_67104, j_m_i_61619);\n            bounds_check_67107 = x_67105 && y_67106;\n            if (!bounds_check_67107) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_67104;\n                        global_failure_args[1] = (int64_t) j_m_i_61619;\n                        ;\n                    }\n                    return;\n                }\n            }\n            tmp_67109 = ((__global int16_t *) ys_mem_75469)[eta_p_67098];\n            lifted_lambda_res_67103 = tmp_67109;\n        } else {\n            int16_t eta_p_67099 = ((__global int16_t *) mem_param_75478)[gtid_67096];\n            \n            lifted_lambda_res_67103 = eta_p_67099;\n        }\n        ((__global int16_t *) mem_75483)[gtid_67096] = lifted_lambda_res_67103;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_67093\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76566_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76566(__global int *global_failure, int64_t gt_rhs_64823, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75475)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76568;\n    int32_t tblock_sizze_76571;\n    int32_t wave_sizze_76570;\n    int32_t block_id_76569;\n    int32_t global_tid_76567;\n    int64_t tid_76566;\n    double x_75366;\n    \n    local_tid_76568 = get_local_id(0", ");\n    tblock_sizze_76571 = get_local_size(0);\n    wave_sizze_76570 = LOCKSTEP_WIDTH;\n    block_id_76569 = get_tblock_id(0);\n    global_tid_76567 = block_id_76569 * tblock_sizze_76571 + local_tid_76568;\n    tid_76566 = sext_i32_i64(global_tid_76567);\n    x_75366 = ((__global double *) tR_mem_75467)[gt_rhs_64823];\n    ((__global double *) mem_75475)[(int64_t) 0] = x_75366;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76598_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76598(__global int *global_failure, int64_t tS_start_64840, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75476, __global unsigned char *mem_75483, __global unsigned char *mem_75484)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76600;\n    int32_t tblock_sizze_76603;\n    int32_t wave_sizze_76602;\n    int32_t block_id_76601;\n    int32_t global_tid_76599;\n    int64_t tid_76598;\n    double gt_lhs_75370;\n    double gt_rhs_75372;\n    bool defunc_0_gt_res_75374;\n    \n    local_tid_76600 = get_local_id(0);\n    tblock_sizze_76603 = get_local_size(0);\n    wave_sizze_76602 = LOCKSTEP_WIDTH;\n    block_id_76601 = get_tblock_id(0);\n    global_tid_76599 = block_id_76601 * tblock_sizze_76603 + local_tid_76600;\n    tid_76598 = sext_i32_i64(global_tid_76599);\n    gt_lhs_75370 = ((__global double *) tS_mem_75468)[tS_start_64840];\n    gt_rhs_75372 = ((__global double *) ext_mem_75476)[(int64_t) 0];\n    defunc_0_gt_res_75374 = gt_rhs_75372 < gt_lhs_75370;\n    ((__global double *) mem_75483)[(int64_t) 0] = gt_lhs_75370;\n    ((__global bool *) mem_75484)[(int64_t) 0] = defunc_0_gt_res_75374;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76604_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76604(__global int *global_failure, int64_t i_p_m_t_s_64846, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75750)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76606;\n    int32_t tblock_si", "zze_76609;\n    int32_t wave_sizze_76608;\n    int32_t block_id_76607;\n    int32_t global_tid_76605;\n    int64_t tid_76604;\n    double x_75376;\n    \n    local_tid_76606 = get_local_id(0);\n    tblock_sizze_76609 = get_local_size(0);\n    wave_sizze_76608 = LOCKSTEP_WIDTH;\n    block_id_76607 = get_tblock_id(0);\n    global_tid_76605 = block_id_76607 * tblock_sizze_76609 + local_tid_76606;\n    tid_76604 = sext_i32_i64(global_tid_76605);\n    x_75376 = ((__global double *) tS_mem_75468)[i_p_m_t_s_64846];\n    ((__global double *) mem_75750)[(int64_t) 0] = x_75376;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76620_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76620(__global int *global_failure, int64_t start_66400, int64_t i_p_m_t_s_66406, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75758, __global unsigned char *mem_75759)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76622;\n    int32_t tblock_sizze_76625;\n    int32_t wave_sizze_76624;\n    int32_t block_id_76623;\n    int32_t global_tid_76621;\n    int64_t tid_76620;\n    double r_max_75380;\n    double r_min_75383;\n    \n    local_tid_76622 = get_local_id(0);\n    tblock_sizze_76625 = get_local_size(0);\n    wave_sizze_76624 = LOCKSTEP_WIDTH;\n    block_id_76623 = get_tblock_id(0);\n    global_tid_76621 = block_id_76623 * tblock_sizze_76625 + local_tid_76622;\n    tid_76620 = sext_i32_i64(global_tid_76621);\n    r_max_75380 = ((__global double *) tR_mem_75467)[i_p_m_t_s_66406];\n    r_min_75383 = ((__global double *) tR_mem_75467)[start_66400];\n    ((__global double *) mem_75758)[(int64_t) 0] = r_max_75380;\n    ((__global double *) mem_75759)[(int64_t) 0] = r_min_75383;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76626_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76626(__global int *global_failure, __global unsigned char *mem_75759, __global unsigned char *ext_mem_75760, __global unsigned char *mem_75762)\n{\n    if (*global_failure",
                                    " >= 0)\n        return;\n    \n    int32_t local_tid_76628;\n    int32_t tblock_sizze_76631;\n    int32_t wave_sizze_76630;\n    int32_t block_id_76629;\n    int32_t global_tid_76627;\n    int64_t tid_76626;\n    double s_max_75385;\n    double r_min_75386;\n    bool defunc_0_gt_res_75387;\n    \n    local_tid_76628 = get_local_id(0);\n    tblock_sizze_76631 = get_local_size(0);\n    wave_sizze_76630 = LOCKSTEP_WIDTH;\n    block_id_76629 = get_tblock_id(0);\n    global_tid_76627 = block_id_76629 * tblock_sizze_76631 + local_tid_76628;\n    tid_76626 = sext_i32_i64(global_tid_76627);\n    s_max_75385 = ((__global double *) ext_mem_75760)[(int64_t) 0];\n    r_min_75386 = ((__global double *) mem_75759)[(int64_t) 0];\n    defunc_0_gt_res_75387 = s_max_75385 < r_min_75386;\n    ((__global bool *) mem_75762)[(int64_t) 0] = defunc_0_gt_res_75387;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76632_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76632(__global int *global_failure, __global unsigned char *mem_75758, __global unsigned char *ext_mem_75761, __global unsigned char *mem_75763)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76634;\n    int32_t tblock_sizze_76637;\n    int32_t wave_sizze_76636;\n    int32_t block_id_76635;\n    int32_t global_tid_76633;\n    int64_t tid_76632;\n    double r_max_75390;\n    double s_min_75391;\n    bool defunc_0_gt_res_75392;\n    \n    local_tid_76634 = get_local_id(0);\n    tblock_sizze_76637 = get_local_size(0);\n    wave_sizze_76636 = LOCKSTEP_WIDTH;\n    block_id_76635 = get_tblock_id(0);\n    global_tid_76633 = block_id_76635 * tblock_sizze_76637 + local_tid_76634;\n    tid_76632 = sext_i32_i64(global_tid_76633);\n    r_max_75390 = ((__global double *) mem_75758)[(int64_t) 0];\n    s_min_75391 = ((__global double *) ext_mem_75761)[(int64_t) 0];\n    defunc_0_gt_res_75392 = r_max_75390 < s_min_75391;\n    ((__global bool *) mem_75763)[(int64_t) 0] = defunc_0_gt_res_75392;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL", "_SIZED(inner_SMJ_doublezigpuseq_76691_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76691(__global int *global_failure, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75490)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76693;\n    int32_t tblock_sizze_76696;\n    int32_t wave_sizze_76695;\n    int32_t block_id_76694;\n    int32_t global_tid_76692;\n    int64_t tid_76691;\n    double x_75394;\n    \n    local_tid_76693 = get_local_id(0);\n    tblock_sizze_76696 = get_local_size(0);\n    wave_sizze_76695 = LOCKSTEP_WIDTH;\n    block_id_76694 = get_tblock_id(0);\n    global_tid_76692 = block_id_76694 * tblock_sizze_76696 + local_tid_76693;\n    tid_76691 = sext_i32_i64(global_tid_76692);\n    x_75394 = ((__global double *) tR_mem_75467)[(int64_t) 0];\n    ((__global double *) mem_75490)[(int64_t) 0] = x_75394;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76697_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76697(__global int *global_failure, __global unsigned char *mem_75483, __global unsigned char *ext_mem_75491, __global unsigned char *mem_75492)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76699;\n    int32_t tblock_sizze_76702;\n    int32_t wave_sizze_76701;\n    int32_t block_id_76700;\n    int32_t global_tid_76698;\n    int64_t tid_76697;\n    double leq_lhs_75398;\n    double gt_lhs_75399;\n    bool defunc_0_leq_res_75400;\n    \n    local_tid_76699 = get_local_id(0);\n    tblock_sizze_76702 = get_local_size(0);\n    wave_sizze_76701 = LOCKSTEP_WIDTH;\n    block_id_76700 = get_tblock_id(0);\n    global_tid_76698 = block_id_76700 * tblock_sizze_76702 + local_tid_76699;\n    tid_76697 = sext_i32_i64(global_tid_76698);\n    leq_lhs_75398 = ((__global double *) ext_mem_75491)[(int64_t) 0];\n    gt_lhs_75399 = ((__global double *) mem_75483)[(int64_t) 0];\n    defunc_0_leq_res_75400 = leq_lhs_75398 <= gt_lhs_75399;\n    ((__global bool *) mem_75492)[(int64_t) 0] = defunc_0_leq_res_75400;\n    \n  error_", "0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76703_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76703(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_57224, unsigned char y_64988_bits, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75483, __global unsigned char *mem_75492, __global unsigned char *mem_75494)\n{\n    bool y_64988 = y_64988_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76705;\n    int32_t tblock_sizze_76708;\n    int32_t wave_sizze_76707;\n    int32_t block_id_76706;\n    int32_t global_tid_76704;\n    int64_t tid_76703;\n    bool defunc_0_leq_res_75402;\n    double x_75407;\n    \n    local_tid_76705 = get_local_id(0);\n    tblock_sizze_76708 = get_local_size(0);\n    wave_sizze_76707 = LOCKSTEP_WIDTH;\n    block_id_76706 = get_tblock_id(0);\n    global_tid_76704 = block_id_76706 * tblock_sizze_76708 + local_tid_76705;\n    tid_76703 = sext_i32_i64(global_tid_76704);\n    defunc_0_leq_res_75402 = ((__global bool *) mem_75492)[(int64_t) 0];\n    if (defunc_0_leq_res_75402) {\n        bool index_certs_75403;\n        double lowest_t_res_75404;\n        \n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_57224;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_75404 = ((__global double *) tR_mem_75467)[(int64_t) 0];\n        x_75407 = lowest_t_res_75404;\n    } else {\n        double gt_lhs_75406;\n        bool index_certs_75405;\n        \n        gt_lhs_75406 = ((__global double *) mem_75483)[(int64_t) 0];\n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                 ",
                                    "   global_failure_args[1] = (int64_t) nR_57224;\n                    ;\n                }\n                return;\n            }\n        }\n        x_75407 = gt_lhs_75406;\n    }\n    ((__global double *) mem_75494)[(int64_t) 0] = x_75407;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76765_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76765(__global int *global_failure, int64_t slice_65911, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75542)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76767;\n    int32_t tblock_sizze_76770;\n    int32_t wave_sizze_76769;\n    int32_t block_id_76768;\n    int32_t global_tid_76766;\n    int64_t tid_76765;\n    double x_75412;\n    \n    local_tid_76767 = get_local_id(0);\n    tblock_sizze_76770 = get_local_size(0);\n    wave_sizze_76769 = LOCKSTEP_WIDTH;\n    block_id_76768 = get_tblock_id(0);\n    global_tid_76766 = block_id_76768 * tblock_sizze_76770 + local_tid_76767;\n    tid_76765 = sext_i32_i64(global_tid_76766);\n    x_75412 = ((__global double *) tS_mem_75468)[slice_65911];\n    ((__global double *) mem_75542)[(int64_t) 0] = x_75412;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76771_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76771(__global int *global_failure, int64_t slice_66709, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75545)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76773;\n    int32_t tblock_sizze_76776;\n    int32_t wave_sizze_76775;\n    int32_t block_id_76774;\n    int32_t global_tid_76772;\n    int64_t tid_76771;\n    double x_75416;\n    \n    local_tid_76773 = get_local_id(0);\n    tblock_sizze_76776 = get_local_size(0);\n    wave_sizze_76775 = LOCKSTEP_WIDTH;\n    block_id_76774 = get_tblock_id(0);\n    global_tid_76772 = block_id_76774 * tblock_sizze_76776 + local_tid_76773;\n    tid_76771 = sext_i32_i64(global_tid_76772);\n    x_75416 = ((__global double *) tS_mem_75468)[slice_66709]", ";\n    ((__global double *) mem_75545)[(int64_t) 0] = x_75416;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76787_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76787(__global int *global_failure, int64_t slice_65554, int64_t slice_65563, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75553, __global unsigned char *mem_75554)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76789;\n    int32_t tblock_sizze_76792;\n    int32_t wave_sizze_76791;\n    int32_t block_id_76790;\n    int32_t global_tid_76788;\n    int64_t tid_76787;\n    double r_max_75420;\n    double r_min_75423;\n    \n    local_tid_76789 = get_local_id(0);\n    tblock_sizze_76792 = get_local_size(0);\n    wave_sizze_76791 = LOCKSTEP_WIDTH;\n    block_id_76790 = get_tblock_id(0);\n    global_tid_76788 = block_id_76790 * tblock_sizze_76792 + local_tid_76789;\n    tid_76787 = sext_i32_i64(global_tid_76788);\n    r_max_75420 = ((__global double *) tR_mem_75467)[slice_65563];\n    r_min_75423 = ((__global double *) tR_mem_75467)[slice_65554];\n    ((__global double *) mem_75553)[(int64_t) 0] = r_max_75420;\n    ((__global double *) mem_75554)[(int64_t) 0] = r_min_75423;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76793_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76793(__global int *global_failure, __global unsigned char *mem_75554, __global unsigned char *ext_mem_75555, __global unsigned char *mem_75557)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76795;\n    int32_t tblock_sizze_76798;\n    int32_t wave_sizze_76797;\n    int32_t block_id_76796;\n    int32_t global_tid_76794;\n    int64_t tid_76793;\n    double s_max_75425;\n    double r_min_75426;\n    bool defunc_0_gt_res_75427;\n    \n    local_tid_76795 = get_local_id(0);\n    tblock_sizze_76798 = get_local_size(0);\n    wave_sizze_76797 = LOCKSTEP_WIDTH;\n    block_id_76796 = get_tblock_id(0);\n    global_tid_76794 = block_id_76796 * tblock_sizze_76798 + ", "local_tid_76795;\n    tid_76793 = sext_i32_i64(global_tid_76794);\n    s_max_75425 = ((__global double *) ext_mem_75555)[(int64_t) 0];\n    r_min_75426 = ((__global double *) mem_75554)[(int64_t) 0];\n    defunc_0_gt_res_75427 = s_max_75425 < r_min_75426;\n    ((__global bool *) mem_75557)[(int64_t) 0] = defunc_0_gt_res_75427;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76799_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76799(__global int *global_failure, __global unsigned char *mem_75553, __global unsigned char *ext_mem_75556, __global unsigned char *mem_75558)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76801;\n    int32_t tblock_sizze_76804;\n    int32_t wave_sizze_76803;\n    int32_t block_id_76802;\n    int32_t global_tid_76800;\n    int64_t tid_76799;\n    double r_max_75430;\n    double s_min_75431;\n    bool defunc_0_gt_res_75432;\n    \n    local_tid_76801 = get_local_id(0);\n    tblock_sizze_76804 = get_local_size(0);\n    wave_sizze_76803 = LOCKSTEP_WIDTH;\n    block_id_76802 = get_tblock_id(0);\n    global_tid_76800 = block_id_76802 * tblock_sizze_76804 + local_tid_76801;\n    tid_76799 = sext_i32_i64(global_tid_76800);\n    r_max_75430 = ((__global double *) mem_75553)[(int64_t) 0];\n    s_min_75431 = ((__global double *) ext_mem_75556)[(int64_t) 0];\n    defunc_0_gt_res_75432 = r_max_75430 < s_min_75431;\n    ((__global bool *) mem_75558)[(int64_t) 0] = defunc_0_gt_res_75432;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_76912_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_76912(__global int *global_failure, int64_t gt_rhs_64823, int64_t i_p_m_t_s_64846, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75926)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76914;\n    int32_t tblock_sizze_76917;\n    int32_t wave_sizze_76916;\n    int32_t block_id_76915;\n    int32_t global_tid_76913;\n    int64_t tid_76912;\n    doub",
                                    "le leq_lhs_75434;\n    double leq_rhs_75436;\n    bool defunc_0_leq_res_75440;\n    \n    local_tid_76914 = get_local_id(0);\n    tblock_sizze_76917 = get_local_size(0);\n    wave_sizze_76916 = LOCKSTEP_WIDTH;\n    block_id_76915 = get_tblock_id(0);\n    global_tid_76913 = block_id_76915 * tblock_sizze_76917 + local_tid_76914;\n    tid_76912 = sext_i32_i64(global_tid_76913);\n    leq_lhs_75434 = ((__global double *) tS_mem_75468)[i_p_m_t_s_64846];\n    leq_rhs_75436 = ((__global double *) tR_mem_75467)[gt_rhs_64823];\n    defunc_0_leq_res_75440 = leq_lhs_75434 <= leq_rhs_75436;\n    ((__global bool *) mem_75926)[(int64_t) 0] = defunc_0_leq_res_75440;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_77237_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_77237(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75962, __global unsigned char *mem_75964)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77239;\n    int32_t tblock_sizze_77242;\n    int32_t wave_sizze_77241;\n    int32_t block_id_77240;\n    int32_t global_tid_77238;\n    int64_t tid_77237;\n    int64_t x_75442;\n    \n    local_tid_77239 = get_local_id(0);\n    tblock_sizze_77242 = get_local_size(0);\n    wave_sizze_77241 = LOCKSTEP_WIDTH;\n    block_id_77240 = get_tblock_id(0);\n    global_tid_77238 = block_id_77240 * tblock_sizze_77242 + local_tid_77239;\n    tid_77237 = sext_i32_i64(global_tid_77238);\n    x_75442 = ((__global int64_t *) mem_75962)[m_65696];\n    ((__global int64_t *) mem_75964)[(int64_t) 0] = x_75442;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_77243_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_77243(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75945, __global unsigned char *mem_75967)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77245;\n    int32_t tblock_sizze_77248;\n    int32_t wave_sizze_77247;\n    int32_t block_id_77246;\n    int32_t global_tid_77244;\n  ", "  int64_t tid_77243;\n    int64_t x_75446;\n    \n    local_tid_77245 = get_local_id(0);\n    tblock_sizze_77248 = get_local_size(0);\n    wave_sizze_77247 = LOCKSTEP_WIDTH;\n    block_id_77246 = get_tblock_id(0);\n    global_tid_77244 = block_id_77246 * tblock_sizze_77248 + local_tid_77245;\n    tid_77243 = sext_i32_i64(global_tid_77244);\n    x_75446 = ((__global int64_t *) mem_75945)[m_65696];\n    ((__global int64_t *) mem_75967)[(int64_t) 0] = x_75446;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_77249_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_77249(__global int *global_failure, __global unsigned char *ext_mem_75965, __global unsigned char *ext_mem_75968, __global unsigned char *mem_75974)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77251;\n    int32_t tblock_sizze_77254;\n    int32_t wave_sizze_77253;\n    int32_t block_id_77252;\n    int32_t global_tid_77250;\n    int64_t tid_77249;\n    int64_t zp_lhs_75450;\n    int64_t n_pairs_t_res_75451;\n    int64_t n_pairs_t_res_75452;\n    \n    local_tid_77251 = get_local_id(0);\n    tblock_sizze_77254 = get_local_size(0);\n    wave_sizze_77253 = LOCKSTEP_WIDTH;\n    block_id_77252 = get_tblock_id(0);\n    global_tid_77250 = block_id_77252 * tblock_sizze_77254 + local_tid_77251;\n    tid_77249 = sext_i32_i64(global_tid_77250);\n    zp_lhs_75450 = ((__global int64_t *) ext_mem_75965)[(int64_t) 0];\n    n_pairs_t_res_75451 = ((__global int64_t *) ext_mem_75968)[(int64_t) 0];\n    n_pairs_t_res_75452 = add64(zp_lhs_75450, n_pairs_t_res_75451);\n    ((__global int64_t *) mem_75974)[(int64_t) 0] = n_pairs_t_res_75452;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezigpuseq_77296_dim1, 1, 1)\nvoid inner_SMJ_doublezigpuseq_77296(__global int *global_failure, int64_t loopres_65870, __global unsigned char *mem_param_76008, __global unsigned char *mem_param_76011, __global unsigned char *mem_param_76014, __global unsigned char *mem_76021, __global unsigned char *mem_76022, __", "global unsigned char *mem_76023)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77298;\n    int32_t tblock_sizze_77301;\n    int32_t wave_sizze_77300;\n    int32_t block_id_77299;\n    int32_t global_tid_77297;\n    int64_t tid_77296;\n    double loopres_75454;\n    int64_t loopres_75456;\n    int64_t loopres_75458;\n    \n    local_tid_77298 = get_local_id(0);\n    tblock_sizze_77301 = get_local_size(0);\n    wave_sizze_77300 = LOCKSTEP_WIDTH;\n    block_id_77299 = get_tblock_id(0);\n    global_tid_77297 = block_id_77299 * tblock_sizze_77301 + local_tid_77298;\n    tid_77296 = sext_i32_i64(global_tid_77297);\n    loopres_75454 = ((__global double *) mem_param_76008)[loopres_65870];\n    loopres_75456 = ((__global int64_t *) mem_param_76011)[loopres_65870];\n    loopres_75458 = ((__global int64_t *) mem_param_76014)[loopres_65870];\n    ((__global double *) mem_76021)[(int64_t) 0] = loopres_75454;\n    ((__global int64_t *) mem_76022)[(int64_t) 0] = loopres_75456;\n    ((__global int64_t *) mem_76023)[(int64_t) 0] = loopres_75458;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_doublezireplicate_77303(int64_t loopres_65871, int64_t replicate_n_77302, int64_t virt_num_tblocks_77308, int64_t num_tblocks_77309, __global unsigned char *mem_76021, __global unsigned char *mem_76025)\n{\n    int32_t replicate_ltid_77304;\n    int32_t tblock_sizze_77306;\n    int32_t replicate_gid_77305;\n    int32_t replicate_gtid_77303;\n    int32_t phys_tblock_id_77310;\n    int32_t iterations_77311;\n    \n    replicate_ltid_77304 = get_local_id(0);\n    tblock_sizze_77306 = get_local_size(0);\n    replicate_gid_77305 = get_tblock_id(0);\n    replicate_gtid_77303 = replicate_gid_77305 * tblock_sizze_77306 + replicate_ltid_77304;\n    phys_tblock_id_77310 = get_tblock_id(0);\n    iterations_77311 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77308) - phys_tblock_id_77310, sext_i64_i32(num_tblocks_77309));\n    for (int32_t i_77312 = 0; i_77312 < iterations_77311; i_77312++) {\n        int",
                                    "32_t virt_tblock_id_77313;\n        int64_t global_tid_77314;\n        int64_t slice_77317;\n        int64_t slice_77318;\n        int64_t rep_i_77315;\n        int64_t remnant_77319;\n        int64_t rep_i_77316;\n        int64_t remnant_77320;\n        \n        virt_tblock_id_77313 = phys_tblock_id_77310 + i_77312 * sext_i64_i32(num_tblocks_77309);\n        global_tid_77314 = sext_i32_i64(virt_tblock_id_77313) * sext_i32_i64(tblock_sizze_77306) + sext_i32_i64(replicate_ltid_77304);\n        slice_77317 = (int64_t) 1;\n        slice_77318 = loopres_65871 * slice_77317;\n        rep_i_77315 = squot64(global_tid_77314, slice_77317);\n        remnant_77319 = global_tid_77314 - rep_i_77315 * slice_77317;\n        rep_i_77316 = remnant_77319;\n        remnant_77320 = remnant_77319 - rep_i_77316;\n        if (slt64(global_tid_77314, replicate_n_77302)) {\n            double tmp_77321 = ((__global double *) mem_76021)[rep_i_77316];\n            \n            ((__global double *) mem_76025)[rep_i_77315 + rep_i_77316] = tmp_77321;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_doublezireplicate_77323(int64_t loopres_65871, int64_t replicate_n_77322, int64_t virt_num_tblocks_77328, int64_t num_tblocks_77329, __global unsigned char *mem_76022, __global unsigned char *mem_76027)\n{\n    int32_t replicate_ltid_77324;\n    int32_t tblock_sizze_77326;\n    int32_t replicate_gid_77325;\n    int32_t replicate_gtid_77323;\n    int32_t phys_tblock_id_77330;\n    int32_t iterations_77331;\n    \n    replicate_ltid_77324 = get_local_id(0);\n    tblock_sizze_77326 = get_local_size(0);\n    replicate_gid_77325 = get_tblock_id(0);\n    replicate_gtid_77323 = replicate_gid_77325 * tblock_sizze_77326 + replicate_ltid_77324;\n    phys_tblock_id_77330 = get_tblock_id(0);\n    iterations_77331 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77328) - phys_tblock_id_77330, sext_i64_i32(num_tblocks_77329));\n    for (int32_t i_77332 = 0; i_77332 <", " iterations_77331; i_77332++) {\n        int32_t virt_tblock_id_77333;\n        int64_t global_tid_77334;\n        int64_t slice_77337;\n        int64_t slice_77338;\n        int64_t rep_i_77335;\n        int64_t remnant_77339;\n        int64_t rep_i_77336;\n        int64_t remnant_77340;\n        \n        virt_tblock_id_77333 = phys_tblock_id_77330 + i_77332 * sext_i64_i32(num_tblocks_77329);\n        global_tid_77334 = sext_i32_i64(virt_tblock_id_77333) * sext_i32_i64(tblock_sizze_77326) + sext_i32_i64(replicate_ltid_77324);\n        slice_77337 = (int64_t) 1;\n        slice_77338 = loopres_65871 * slice_77337;\n        rep_i_77335 = squot64(global_tid_77334, slice_77337);\n        remnant_77339 = global_tid_77334 - rep_i_77335 * slice_77337;\n        rep_i_77336 = remnant_77339;\n        remnant_77340 = remnant_77339 - rep_i_77336;\n        if (slt64(global_tid_77334, replicate_n_77322)) {\n            int64_t tmp_77341 = ((__global int64_t *) mem_76022)[rep_i_77336];\n            \n            ((__global int64_t *) mem_76027)[rep_i_77335 + rep_i_77336] = tmp_77341;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_72965_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_72965(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_57224, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t max_res_65013, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, int64_t zt_rhs_65019, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75495, __global unsigned char *mem_75504, __global unsigned char *mem_75506)\n{\n    #define segmap_tblock_sizze_72960 (inner_SMJ_doublezisegmap_72965zisegmap_tblock_sizze_72960)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76715;\n    int32_t tblock_sizze_76718;\n  ", "  int32_t wave_sizze_76717;\n    int32_t block_id_76716;\n    int32_t global_tid_76714;\n    int64_t phys_tid_72965;\n    int64_t global_tid_76719;\n    int64_t slice_76720;\n    int64_t gtid_72964;\n    int64_t remnant_76721;\n    \n    local_tid_76715 = get_local_id(0);\n    tblock_sizze_76718 = get_local_size(0);\n    wave_sizze_76717 = LOCKSTEP_WIDTH;\n    block_id_76716 = get_tblock_id(0);\n    global_tid_76714 = block_id_76716 * tblock_sizze_76718 + local_tid_76715;\n    phys_tid_72965 = sext_i32_i64(global_tid_76714);\n    global_tid_76719 = sext_i32_i64(block_id_76716) * segmap_tblock_sizze_72960 + sext_i32_i64(local_tid_76715);\n    slice_76720 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;\n    gtid_72964 = global_tid_76719;\n    remnant_76721 = global_tid_76719 - gtid_72964;\n    if (slt64(gtid_72964, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014)) {\n        double lowest_75411;\n        int64_t index_primexp_73897;\n        int64_t zs_lhs_72967;\n        int64_t index_72968;\n        bool cond_72969;\n        int64_t loop_over_72970;\n        int64_t loop_over_72971;\n        int64_t loop_over_72973;\n        bool defunc_0_f_res_72976;\n        int64_t defunc_0_f_res_72977;\n        int64_t defunc_0_f_res_72978;\n        int64_t defunc_0_f_res_72979;\n        bool loop_while_72980;\n        int64_t p_72981;\n        int64_t p_72982;\n        int64_t p_72983;\n        \n        lowest_75411 = ((__global double *) ext_mem_75495)[(int64_t) 0];\n        index_primexp_73897 = add64(max_res_65013, gtid_72964);\n        zs_lhs_72967 = mul64(zt_rhs_65019, index_primexp_73897);\n        index_72968 = sdiv64(zs_lhs_72967, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n        cond_72969 = slt64(nR_57224, index_72968);\n        if (cond_72969) {\n            loop_over_72970 = nR_57224;\n        } else {\n            loop_over_72970 = index_72968;\n        }\n        if (cond_72969) {\n            int64_t loop_over_t_res_72972 = sub64(index_72968, nR_57224);\n",
                                    "            \n            loop_over_72971 = loop_over_t_res_72972;\n        } else {\n            loop_over_72971 = (int64_t) 0;\n        }\n        if (cond_72969) {\n            int64_t zm_lhs_72974;\n            int64_t loop_over_t_res_72975;\n            \n            zm_lhs_72974 = sub64(index_72968, nR_57224);\n            loop_over_t_res_72975 = sub64(zm_lhs_72974, (int64_t) 1);\n            loop_over_72973 = loop_over_t_res_72975;\n        } else {\n            loop_over_72973 = (int64_t) 0;\n        }\n        loop_while_72980 = 1;\n        p_72981 = loop_over_72973;\n        p_72982 = loop_over_72970;\n        p_72983 = loop_over_72971;\n        while (loop_while_72980) {\n            int64_t zs_lhs_72984;\n            int64_t offset_72985;\n            int64_t ai_72986;\n            int64_t max_arg1_72987;\n            int64_t max_res_72988;\n            bool cond_72989;\n            double b_prev_72990;\n            bool cond_72998;\n            int64_t loopres_72999;\n            int64_t loopres_73000;\n            int64_t loopres_73001;\n            bool loopres_73002;\n            bool loop_while_tmp_76722;\n            int64_t p_tmp_76723;\n            int64_t p_tmp_76724;\n            int64_t p_tmp_76725;\n            \n            zs_lhs_72984 = sub64(p_72982, p_72981);\n            offset_72985 = sdiv64(zs_lhs_72984, (int64_t) 2);\n            ai_72986 = sub64(p_72982, offset_72985);\n            max_arg1_72987 = add64(p_72983, offset_72985);\n            max_res_72988 = smax64((int64_t) 0, max_arg1_72987);\n            cond_72989 = slt64((int64_t) 0, max_res_72988);\n            if (cond_72989) {\n                int64_t tmp_72991;\n                bool x_72992;\n                bool y_72993;\n                bool bounds_check_72994;\n                bool index_certs_72995;\n                int64_t slice_72996;\n                double b_prev_t_res_72997;\n                \n                tmp_72991 = sub64(max_res_72988, (int64_t) 1);\n                x_72992 = sle64((int64_t) 0, tmp_72991);\n      ", "          y_72993 = slt64(tmp_72991, nR_57224);\n                bounds_check_72994 = x_72992 && y_72993;\n                if (!bounds_check_72994) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_72991;\n                            global_failure_args[1] = (int64_t) nR_57224;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_72996 = tS_start_64840 + tmp_72991;\n                b_prev_t_res_72997 = ((__global double *) tS_mem_75468)[slice_72996];\n                b_prev_72990 = b_prev_t_res_72997;\n            } else {\n                b_prev_72990 = lowest_75411;\n            }\n            cond_72998 = sle64(ai_72986, (int64_t) 0);\n            if (cond_72998) {\n                loopres_72999 = p_72981;\n                loopres_73000 = (int64_t) 0;\n                loopres_73001 = max_res_72988;\n                loopres_73002 = 0;\n            } else {\n                bool cond_73003;\n                int64_t loopres_f_res_73004;\n                int64_t loopres_f_res_73005;\n                int64_t loopres_f_res_73006;\n                bool loopres_f_res_73007;\n                \n                cond_73003 = sle64(nR_57224, max_res_72988);\n                if (cond_73003) {\n                    int64_t min_arg1_73008;\n                    int64_t min_res_73009;\n                    bool x_73010;\n                    bool y_73011;\n                    bool bounds_check_73012;\n                    bool index_certs_73013;\n                    bool x_73016;\n                    bool y_73017;\n                    bool bounds_check_73018;\n                    bool index_certs_73019;\n                    int64_t slice_73014;\n                    double leq_lhs_73015;\n                    double leq_rhs_73020;\n                    bool defunc_0_leq_res_73021;\n                    in", "t64_t loopres_f_res_t_res_73022;\n                    bool x_73023;\n                    int64_t loopres_f_res_t_res_73024;\n                    \n                    min_arg1_73008 = sub64(nR_57224, (int64_t) 1);\n                    min_res_73009 = smin64(ai_72986, min_arg1_73008);\n                    x_73010 = sle64((int64_t) 0, min_arg1_73008);\n                    y_73011 = slt64(min_arg1_73008, nR_57224);\n                    bounds_check_73012 = x_73010 && y_73011;\n                    if (!bounds_check_73012) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_73008;\n                                global_failure_args[1] = (int64_t) nR_57224;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_73016 = sle64((int64_t) 0, min_res_73009);\n                    y_73017 = slt64(min_res_73009, nR_57224);\n                    bounds_check_73018 = x_73016 && y_73017;\n                    if (!bounds_check_73018) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_73009;\n                                global_failure_args[1] = (int64_t) nR_57224;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_73014 = tS_start_64840 + min_arg1_73008;\n                    leq_lhs_73015 = ((__global double *) tS_mem_75468)[slice_73014];\n                    leq_rhs_73020 = ((__global double *) tR_mem_75467)[min_res_73009];\n                    defunc_0_leq_res_73021 = leq_lhs_73015 <= leq_rhs_73020;\n                    if (defunc_0_leq_res_73021) {\n                        loopres_f",
                                    "_res_t_res_73022 = ai_72986;\n                    } else {\n                        loopres_f_res_t_res_73022 = p_72982;\n                    }\n                    x_73023 = !defunc_0_leq_res_73021;\n                    if (defunc_0_leq_res_73021) {\n                        loopres_f_res_t_res_73024 = nR_57224;\n                    } else {\n                        int64_t tmp_73025 = sub64(min_arg1_73008, offset_72985);\n                        \n                        loopres_f_res_t_res_73024 = tmp_73025;\n                    }\n                    loopres_f_res_73004 = p_72981;\n                    loopres_f_res_73005 = loopres_f_res_t_res_73022;\n                    loopres_f_res_73006 = loopres_f_res_t_res_73024;\n                    loopres_f_res_73007 = x_73023;\n                } else {\n                    bool cond_73026;\n                    int64_t loopres_f_res_f_res_73027;\n                    int64_t loopres_f_res_f_res_73028;\n                    int64_t loopres_f_res_f_res_73029;\n                    bool loopres_f_res_f_res_73030;\n                    \n                    cond_73026 = sle64(nR_57224, ai_72986);\n                    if (cond_73026) {\n                        int64_t min_arg1_73031;\n                        int64_t min_res_73032;\n                        bool x_73033;\n                        bool y_73034;\n                        bool bounds_check_73035;\n                        bool index_certs_73036;\n                        bool x_73038;\n                        bool y_73039;\n                        bool bounds_check_73040;\n                        bool index_certs_73041;\n                        double leq_lhs_73037;\n                        int64_t slice_73042;\n                        double leq_rhs_73043;\n                        bool defunc_0_leq_res_73044;\n                        int64_t loopres_f_res_f_res_t_res_73045;\n                        bool x_73046;\n                        int64_t loopres_f_res_f_res_t_res_73047;\n                        \n          ", "              min_arg1_73031 = sub64(nR_57224, (int64_t) 1);\n                        min_res_73032 = smin64(max_res_72988, min_arg1_73031);\n                        x_73033 = sle64((int64_t) 0, min_arg1_73031);\n                        y_73034 = slt64(min_arg1_73031, nR_57224);\n                        bounds_check_73035 = x_73033 && y_73034;\n                        if (!bounds_check_73035) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_73031;\n                                    global_failure_args[1] = (int64_t) nR_57224;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_73038 = sle64((int64_t) 0, min_res_73032);\n                        y_73039 = slt64(min_res_73032, nR_57224);\n                        bounds_check_73040 = x_73038 && y_73039;\n                        if (!bounds_check_73040) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_73032;\n                                    global_failure_args[1] = (int64_t) nR_57224;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_73037 = ((__global double *) tR_mem_75467)[min_arg1_73031];\n                        slice_73042 = tS_start_64840 + min_res_73032;\n                        leq_rhs_73043 = ((__global double *) tS_mem_75468)[slice_73042];\n                        defunc_0_leq_res_73044 = leq_lhs_73037 <= leq_rhs_73043;\n                        if (defunc_0_leq_res_73044) {\n                            loopres_f_res_f_res_t", "_res_73045 = max_res_72988;\n                        } else {\n                            loopres_f_res_f_res_t_res_73045 = p_72983;\n                        }\n                        x_73046 = !defunc_0_leq_res_73044;\n                        if (defunc_0_leq_res_73044) {\n                            loopres_f_res_f_res_t_res_73047 = nR_57224;\n                        } else {\n                            loopres_f_res_f_res_t_res_73047 = min_arg1_73031;\n                        }\n                        loopres_f_res_f_res_73027 = p_72981;\n                        loopres_f_res_f_res_73028 = loopres_f_res_f_res_t_res_73047;\n                        loopres_f_res_f_res_73029 = loopres_f_res_f_res_t_res_73045;\n                        loopres_f_res_f_res_73030 = x_73046;\n                    } else {\n                        bool cond_73048;\n                        int64_t loopres_f_res_f_res_f_res_73049;\n                        int64_t loopres_f_res_f_res_f_res_73050;\n                        int64_t loopres_f_res_f_res_f_res_73051;\n                        bool loopres_f_res_f_res_f_res_73052;\n                        \n                        cond_73048 = sle64(p_72982, p_72981);\n                        if (cond_73048) {\n                            bool cond_73053;\n                            int64_t ai_73054;\n                            bool x_73067;\n                            bool y_73068;\n                            bool bounds_check_73069;\n                            bool index_certs_73070;\n                            double b_prev_73056;\n                            double gt_lhs_73071;\n                            bool defunc_0_gt_res_73072;\n                            int64_t defunc_0_partFunc_sequential_search_res_73073;\n                            int64_t defunc_0_partFunc_sequential_search_res_73074;\n                            \n                            cond_73053 = slt64(ai_72986, nR_57224);\n                            if (cond_73053) {\n                             ",
                                    "   ai_73054 = ai_72986;\n                            } else {\n                                int64_t ai_f_res_73055 = sub64(nR_57224, (int64_t) 1);\n                                \n                                ai_73054 = ai_f_res_73055;\n                            }\n                            x_73067 = sle64((int64_t) 0, ai_73054);\n                            y_73068 = slt64(ai_73054, nR_57224);\n                            bounds_check_73069 = x_73067 && y_73068;\n                            if (!bounds_check_73069) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_73054;\n                                        global_failure_args[1] = (int64_t) nR_57224;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_72989) {\n                                int64_t tmp_73057;\n                                bool x_73058;\n                                bool y_73059;\n                                bool bounds_check_73060;\n                                bool index_certs_73061;\n                                int64_t slice_73062;\n                                double b_prev_t_res_73063;\n                                \n                                tmp_73057 = sub64(max_res_72988, (int64_t) 1);\n                                x_73058 = sle64((int64_t) 0, tmp_73057);\n                                y_73059 = slt64(tmp_73057, nR_57224);\n                                bounds_check_73060 = x_73058 && y_73059;\n                                if (!bounds_check_73060) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                                        ", "    global_failure_args[0] = (int64_t) tmp_73057;\n                                            global_failure_args[1] = (int64_t) nR_57224;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_73062 = tS_start_64840 + tmp_73057;\n                                b_prev_t_res_73063 = ((__global double *) tS_mem_75468)[slice_73062];\n                                b_prev_73056 = b_prev_t_res_73063;\n                            } else {\n                                bool y_73064;\n                                bool index_certs_73065;\n                                double b_prev_f_res_73066;\n                                \n                                y_73064 = slt64((int64_t) 0, nR_57224);\n                                if (!y_73064) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_57224;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_73066 = ((__global double *) tS_mem_75468)[tS_start_64840];\n                                b_prev_73056 = b_prev_f_res_73066;\n                            }\n                            gt_lhs_73071 = ((__global double *) tR_mem_75467)[ai_73054];\n                            defunc_0_gt_res_73072 = b_prev_73056 < gt_lhs_73071;\n                            if (defunc_0_gt_res_73072) {\n                                int64_t zl_rhs_73075;\n                                bool loop_cond", "_73076;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_73077;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_73078;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_73079;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_73080;\n                                bool loop_while_73081;\n                                int64_t p_73082;\n                                int64_t p_73083;\n                                int64_t p_73084;\n                                \n                                zl_rhs_73075 = sub64(nR_57224, max_res_72988);\n                                loop_cond_73076 = slt64((int64_t) 0, zl_rhs_73075);\n                                loop_while_73081 = loop_cond_73076;\n                                p_73082 = ai_73054;\n                                p_73083 = max_res_72988;\n                                p_73084 = (int64_t) 0;\n                                while (loop_while_73081) {\n                                    int64_t i_a_73085;\n                                    int64_t i_b_73086;\n                                    int64_t leq_lhs_73087;\n                                    bool x_73088;\n                                    bool y_73089;\n                                    bool bounds_check_73090;\n                                    bool index_certs_73091;\n                                    bool x_73093;\n                                    bool y_73094;\n                                    bool bounds_check_73095;\n                                    bool index_certs_73096;\n                                    double leq_lhs_73092;\n                                    int64_t slice_73097;\n                                    double leq_rhs_73098;\n                                    bool defunc_0_leq_res_73099;\n                                    int64_t loopres_73100;\n                          ",
                                    "          int64_t loopres_73101;\n                                    int64_t loopres_73102;\n                                    bool loop_cond_73104;\n                                    bool loop_while_tmp_76726;\n                                    int64_t p_tmp_76727;\n                                    int64_t p_tmp_76728;\n                                    int64_t p_tmp_76729;\n                                    \n                                    i_a_73085 = sub64(ai_73054, p_73084);\n                                    i_b_73086 = add64(max_res_72988, p_73084);\n                                    leq_lhs_73087 = sub64(i_a_73085, (int64_t) 1);\n                                    x_73088 = sle64((int64_t) 0, leq_lhs_73087);\n                                    y_73089 = slt64(leq_lhs_73087, nR_57224);\n                                    bounds_check_73090 = x_73088 && y_73089;\n                                    if (!bounds_check_73090) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_73087;\n                                                global_failure_args[1] = (int64_t) nR_57224;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_73093 = sle64((int64_t) 0, i_b_73086);\n                                    y_73094 = slt64(i_b_73086, nR_57224);\n                                    bounds_check_73095 = x_73093 && y_73094;\n                                    if (!bounds_check_73095) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                                    ", "            global_failure_args[0] = (int64_t) i_b_73086;\n                                                global_failure_args[1] = (int64_t) nR_57224;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_73092 = ((__global double *) tR_mem_75467)[leq_lhs_73087];\n                                    slice_73097 = tS_start_64840 + i_b_73086;\n                                    leq_rhs_73098 = ((__global double *) tS_mem_75468)[slice_73097];\n                                    defunc_0_leq_res_73099 = leq_lhs_73092 <= leq_rhs_73098;\n                                    if (defunc_0_leq_res_73099) {\n                                        loopres_73100 = i_a_73085;\n                                    } else {\n                                        loopres_73100 = ai_73054;\n                                    }\n                                    if (defunc_0_leq_res_73099) {\n                                        loopres_73101 = i_b_73086;\n                                    } else {\n                                        loopres_73101 = max_res_72988;\n                                    }\n                                    if (defunc_0_leq_res_73099) {\n                                        loopres_73102 = zl_rhs_73075;\n                                    } else {\n                                        int64_t tmp_73103 = add64((int64_t) 1, p_73084);\n                                        \n                                        loopres_73102 = tmp_73103;\n                                    }\n                                    loop_cond_73104 = slt64(loopres_73102, zl_rhs_73075);\n                                    loop_while_tmp_76726 = loop_cond_73104;\n                                    p_tmp_76727 = loopres_73100;\n                              ", "      p_tmp_76728 = loopres_73101;\n                                    p_tmp_76729 = loopres_73102;\n                                    loop_while_73081 = loop_while_tmp_76726;\n                                    p_73082 = p_tmp_76727;\n                                    p_73083 = p_tmp_76728;\n                                    p_73084 = p_tmp_76729;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_73077 = loop_while_73081;\n                                defunc_0_partFunc_sequential_search_res_t_res_73078 = p_73082;\n                                defunc_0_partFunc_sequential_search_res_t_res_73079 = p_73083;\n                                defunc_0_partFunc_sequential_search_res_t_res_73080 = p_73084;\n                                defunc_0_partFunc_sequential_search_res_73073 = defunc_0_partFunc_sequential_search_res_t_res_73078;\n                                defunc_0_partFunc_sequential_search_res_73074 = defunc_0_partFunc_sequential_search_res_t_res_73079;\n                            } else {\n                                int64_t zl_rhs_73105;\n                                bool loop_cond_73106;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_73107;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73108;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73109;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_73110;\n                                bool loop_while_73111;\n                                int64_t p_73112;\n                                int64_t p_73113;\n                                int64_t p_73114;\n                                \n                                zl_rhs_73105 = sub64(max_res_72988, (int64_t) 1);\n                                loop_cond_73106 = slt64((int64_t) 0, zl_rhs_73105);\n                                loop_while",
                                    "_73111 = loop_cond_73106;\n                                p_73112 = ai_73054;\n                                p_73113 = max_res_72988;\n                                p_73114 = (int64_t) 0;\n                                while (loop_while_73111) {\n                                    int64_t zp_lhs_73115;\n                                    int64_t hi_a_73116;\n                                    bool cond_73117;\n                                    int64_t i_a_73118;\n                                    int64_t zm_lhs_73120;\n                                    int64_t i_b_73121;\n                                    bool x_73122;\n                                    bool y_73123;\n                                    bool bounds_check_73124;\n                                    bool index_certs_73125;\n                                    bool x_73127;\n                                    bool y_73128;\n                                    bool bounds_check_73129;\n                                    bool index_certs_73130;\n                                    double gt_lhs_73126;\n                                    int64_t slice_73131;\n                                    double gt_rhs_73132;\n                                    bool defunc_0_gt_res_73133;\n                                    int64_t loopres_73134;\n                                    int64_t loopres_73135;\n                                    int64_t loopres_73136;\n                                    bool loop_cond_73138;\n                                    bool loop_while_tmp_76730;\n                                    int64_t p_tmp_76731;\n                                    int64_t p_tmp_76732;\n                                    int64_t p_tmp_76733;\n                                    \n                                    zp_lhs_73115 = add64(ai_73054, p_73114);\n                                    hi_a_73116 = add64((int64_t) 1, zp_lhs_73115);\n                                    cond_73117 = slt64(hi_a_73116, nR_572", "24);\n                                    if (cond_73117) {\n                                        i_a_73118 = hi_a_73116;\n                                    } else {\n                                        int64_t i_a_f_res_73119 = sub64(nR_57224, (int64_t) 1);\n                                        \n                                        i_a_73118 = i_a_f_res_73119;\n                                    }\n                                    zm_lhs_73120 = sub64(max_res_72988, p_73114);\n                                    i_b_73121 = sub64(zm_lhs_73120, (int64_t) 1);\n                                    x_73122 = sle64((int64_t) 0, i_a_73118);\n                                    y_73123 = slt64(i_a_73118, nR_57224);\n                                    bounds_check_73124 = x_73122 && y_73123;\n                                    if (!bounds_check_73124) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_73118;\n                                                global_failure_args[1] = (int64_t) nR_57224;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_73127 = sle64((int64_t) 0, i_b_73121);\n                                    y_73128 = slt64(i_b_73121, nR_57224);\n                                    bounds_check_73129 = x_73127 && y_73128;\n                                    if (!bounds_check_73129) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 23) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_73121;\n                                   ", "             global_failure_args[1] = (int64_t) nR_57224;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_73126 = ((__global double *) tR_mem_75467)[i_a_73118];\n                                    slice_73131 = tS_start_64840 + i_b_73121;\n                                    gt_rhs_73132 = ((__global double *) tS_mem_75468)[slice_73131];\n                                    defunc_0_gt_res_73133 = gt_rhs_73132 < gt_lhs_73126;\n                                    if (defunc_0_gt_res_73133) {\n                                        loopres_73134 = i_a_73118;\n                                    } else {\n                                        loopres_73134 = ai_73054;\n                                    }\n                                    if (defunc_0_gt_res_73133) {\n                                        loopres_73135 = zm_lhs_73120;\n                                    } else {\n                                        loopres_73135 = max_res_72988;\n                                    }\n                                    if (defunc_0_gt_res_73133) {\n                                        loopres_73136 = zl_rhs_73105;\n                                    } else {\n                                        int64_t tmp_73137 = add64((int64_t) 1, p_73114);\n                                        \n                                        loopres_73136 = tmp_73137;\n                                    }\n                                    loop_cond_73138 = slt64(loopres_73136, zl_rhs_73105);\n                                    loop_while_tmp_76730 = loop_cond_73138;\n                                    p_tmp_76731 = loopres_73134;\n                                    p_tmp_76732 = loopres_73135;\n                                    p_tmp_76733 = loopres_73136;\n   ",
                                    "                                 loop_while_73111 = loop_while_tmp_76730;\n                                    p_73112 = p_tmp_76731;\n                                    p_73113 = p_tmp_76732;\n                                    p_73114 = p_tmp_76733;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_73107 = loop_while_73111;\n                                defunc_0_partFunc_sequential_search_res_f_res_73108 = p_73112;\n                                defunc_0_partFunc_sequential_search_res_f_res_73109 = p_73113;\n                                defunc_0_partFunc_sequential_search_res_f_res_73110 = p_73114;\n                                defunc_0_partFunc_sequential_search_res_73073 = defunc_0_partFunc_sequential_search_res_f_res_73108;\n                                defunc_0_partFunc_sequential_search_res_73074 = defunc_0_partFunc_sequential_search_res_f_res_73109;\n                            }\n                            loopres_f_res_f_res_f_res_73049 = p_72981;\n                            loopres_f_res_f_res_f_res_73050 = defunc_0_partFunc_sequential_search_res_73073;\n                            loopres_f_res_f_res_f_res_73051 = defunc_0_partFunc_sequential_search_res_73074;\n                            loopres_f_res_f_res_f_res_73052 = 0;\n                        } else {\n                            bool x_73139;\n                            bool y_73140;\n                            bool bounds_check_73141;\n                            bool index_certs_73142;\n                            double gt_lhs_73143;\n                            bool defunc_0_gt_res_73144;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73145;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73146;\n                            int64_t loopres_f_res_f_res_f_res_f_res_73147;\n                            bool loopres_f_res_f_res_f_res_f_res_73148;\n                            \n                       ", "     x_73139 = sle64((int64_t) 0, ai_72986);\n                            y_73140 = slt64(ai_72986, nR_57224);\n                            bounds_check_73141 = x_73139 && y_73140;\n                            if (!bounds_check_73141) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 24) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_72986;\n                                        global_failure_args[1] = (int64_t) nR_57224;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_73143 = ((__global double *) tR_mem_75467)[ai_72986];\n                            defunc_0_gt_res_73144 = b_prev_72990 < gt_lhs_73143;\n                            if (defunc_0_gt_res_73144) {\n                                int64_t leq_lhs_73149;\n                                bool x_73150;\n                                bool y_73151;\n                                bool bounds_check_73152;\n                                bool index_certs_73153;\n                                bool x_73155;\n                                bool y_73156;\n                                bool bounds_check_73157;\n                                bool index_certs_73158;\n                                double leq_lhs_73154;\n                                int64_t slice_73159;\n                                double leq_rhs_73160;\n                                bool defunc_0_leq_res_73161;\n                                bool x_73162;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_73163;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_73164;\n                                \n                                leq_lhs_73149 = sub64(ai_72986, (int64_t) 1);\n                                x_", "73150 = sle64((int64_t) 0, leq_lhs_73149);\n                                y_73151 = slt64(leq_lhs_73149, nR_57224);\n                                bounds_check_73152 = x_73150 && y_73151;\n                                if (!bounds_check_73152) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 25) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_73149;\n                                            global_failure_args[1] = (int64_t) nR_57224;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_73155 = sle64((int64_t) 0, max_res_72988);\n                                y_73156 = slt64(max_res_72988, nR_57224);\n                                bounds_check_73157 = x_73155 && y_73156;\n                                if (!bounds_check_73157) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 26) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_72988;\n                                            global_failure_args[1] = (int64_t) nR_57224;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_73154 = ((__global double *) tR_mem_75467)[leq_lhs_73149];\n                                slice_73159 = tS_start_64840 + max_res_72988;\n                                leq_rhs_73160 = ((__global double *) tS_mem_75468)[slice_73159];\n                                defunc_0_leq_res_73161 = leq_lhs_73154 <= leq_rhs_73160;\n                                x_73162 =",
                                    " !defunc_0_leq_res_73161;\n                                if (defunc_0_leq_res_73161) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_73163 = ai_72986;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_73163 = leq_lhs_73149;\n                                }\n                                if (defunc_0_leq_res_73161) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_73164 = max_res_72988;\n                                } else {\n                                    int64_t tmp_73165 = add64((int64_t) 1, max_res_72988);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_73164 = tmp_73165;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_73145 = p_72981;\n                                loopres_f_res_f_res_f_res_f_res_73146 = loopres_f_res_f_res_f_res_f_res_t_res_73163;\n                                loopres_f_res_f_res_f_res_f_res_73147 = loopres_f_res_f_res_f_res_f_res_t_res_73164;\n                                loopres_f_res_f_res_f_res_f_res_73148 = x_73162;\n                            } else {\n                                int64_t tmp_73166 = add64((int64_t) 1, ai_72986);\n                                \n                                loopres_f_res_f_res_f_res_f_res_73145 = tmp_73166;\n                                loopres_f_res_f_res_f_res_f_res_73146 = p_72982;\n                                loopres_f_res_f_res_f_res_f_res_73147 = p_72983;\n                                loopres_f_res_f_res_f_res_f_res_73148 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_73049 = loopres_f_res_f_res_f_res_f_res_73145;\n                            loopres_f_res_f_res_f_res_73050 = loopres_f_res_f_res_f_res_f_res_73146;\n                            loopres_f_res_f_res_f_res_73051 = loopres_f_res_f_res_f_res_f_res", "_73147;\n                            loopres_f_res_f_res_f_res_73052 = loopres_f_res_f_res_f_res_f_res_73148;\n                        }\n                        loopres_f_res_f_res_73027 = loopres_f_res_f_res_f_res_73049;\n                        loopres_f_res_f_res_73028 = loopres_f_res_f_res_f_res_73050;\n                        loopres_f_res_f_res_73029 = loopres_f_res_f_res_f_res_73051;\n                        loopres_f_res_f_res_73030 = loopres_f_res_f_res_f_res_73052;\n                    }\n                    loopres_f_res_73004 = loopres_f_res_f_res_73027;\n                    loopres_f_res_73005 = loopres_f_res_f_res_73028;\n                    loopres_f_res_73006 = loopres_f_res_f_res_73029;\n                    loopres_f_res_73007 = loopres_f_res_f_res_73030;\n                }\n                loopres_72999 = loopres_f_res_73004;\n                loopres_73000 = loopres_f_res_73005;\n                loopres_73001 = loopres_f_res_73006;\n                loopres_73002 = loopres_f_res_73007;\n            }\n            loop_while_tmp_76722 = loopres_73002;\n            p_tmp_76723 = loopres_72999;\n            p_tmp_76724 = loopres_73000;\n            p_tmp_76725 = loopres_73001;\n            loop_while_72980 = loop_while_tmp_76722;\n            p_72981 = p_tmp_76723;\n            p_72982 = p_tmp_76724;\n            p_72983 = p_tmp_76725;\n        }\n        defunc_0_f_res_72976 = loop_while_72980;\n        defunc_0_f_res_72977 = p_72981;\n        defunc_0_f_res_72978 = p_72982;\n        defunc_0_f_res_72979 = p_72983;\n        ((__global int64_t *) mem_75504)[gtid_72964] = defunc_0_f_res_72978;\n        ((__global int64_t *) mem_75506)[gtid_72964] = defunc_0_f_res_72979;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72960\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73339_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73339(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_57224, int64_t gt_rhs_64823, int64_t tS_", "start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t zeze_rhs_65256, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75486, __global unsigned char *mem_75488, __global unsigned char *mem_75522, __global unsigned char *mem_75524)\n{\n    #define segmap_tblock_sizze_73334 (inner_SMJ_doublezisegmap_73339zisegmap_tblock_sizze_73334)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76738;\n    int32_t tblock_sizze_76741;\n    int32_t wave_sizze_76740;\n    int32_t block_id_76739;\n    int32_t global_tid_76737;\n    int64_t phys_tid_73339;\n    int64_t global_tid_76742;\n    int64_t slice_76743;\n    int64_t gtid_73338;\n    int64_t remnant_76744;\n    \n    local_tid_76738 = get_local_id(0);\n    tblock_sizze_76741 = get_local_size(0);\n    wave_sizze_76740 = LOCKSTEP_WIDTH;\n    block_id_76739 = get_tblock_id(0);\n    global_tid_76737 = block_id_76739 * tblock_sizze_76741 + local_tid_76738;\n    phys_tid_73339 = sext_i32_i64(global_tid_76737);\n    global_tid_76742 = sext_i32_i64(block_id_76739) * segmap_tblock_sizze_73334 + sext_i32_i64(local_tid_76738);\n    slice_76743 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n    gtid_73338 = global_tid_76742;\n    remnant_76744 = global_tid_76742 - gtid_73338;\n    if (slt64(gtid_73338, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982)) {\n        int64_t eta_p_73341;\n        int64_t min_res_73342;\n        bool x_73343;\n        bool y_73344;\n        bool bounds_check_73345;\n        bool index_certs_73346;\n        bool cond_73348;\n        int64_t ri_next_73349;\n        int64_t max_arg1_73356;\n        int64_t max_res_73357;\n        bool x_73358;\n        bool y_73359;\n        bool bounds_check_73360;\n        bool index_certs_73361;\n        double r_min_73347;\n        double r_max_73362;\n        bool defunc_0_f_res_73363;\n        int64_t defunc_0_f_res_73364;\n        bool loop_while_73365",
                                    ";\n        int64_t fm_73366;\n        bool defunc_0_f_res_73432;\n        int64_t defunc_0_f_res_73433;\n        bool loop_while_73434;\n        int64_t lm_73435;\n        \n        eta_p_73341 = ((__global int64_t *) mem_75486)[gtid_73338];\n        min_res_73342 = smin64(gt_rhs_64823, eta_p_73341);\n        x_73343 = sle64((int64_t) 0, min_res_73342);\n        y_73344 = slt64(min_res_73342, nR_57224);\n        bounds_check_73345 = x_73343 && y_73344;\n        if (!bounds_check_73345) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 27) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_73342;\n                    global_failure_args[1] = (int64_t) nR_57224;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_73348 = gtid_73338 == zeze_rhs_65256;\n        if (cond_73348) {\n            ri_next_73349 = nR_57224;\n        } else {\n            int64_t tmp_73350;\n            bool x_73351;\n            bool y_73352;\n            bool bounds_check_73353;\n            bool index_certs_73354;\n            int64_t ri_next_f_res_73355;\n            \n            tmp_73350 = add64((int64_t) 1, gtid_73338);\n            x_73351 = sle64((int64_t) 0, tmp_73350);\n            y_73352 = slt64(tmp_73350, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_73353 = x_73351 && y_73352;\n            if (!bounds_check_73353) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 28) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_73350;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_73355 = ((__global int64_t *) mem_75486)[tmp_73350];\n            ri_next_73349 = ri_next_f_res_73355;\n        }\n      ", "  max_arg1_73356 = sub64(ri_next_73349, (int64_t) 1);\n        max_res_73357 = smax64((int64_t) 0, max_arg1_73356);\n        x_73358 = sle64((int64_t) 0, max_res_73357);\n        y_73359 = slt64(max_res_73357, nR_57224);\n        bounds_check_73360 = x_73358 && y_73359;\n        if (!bounds_check_73360) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 29) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_73357;\n                    global_failure_args[1] = (int64_t) nR_57224;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_73347 = ((__global double *) tR_mem_75467)[min_res_73342];\n        r_max_73362 = ((__global double *) tR_mem_75467)[max_res_73357];\n        loop_while_73365 = 1;\n        fm_73366 = gtid_73338;\n        while (loop_while_73365) {\n            bool x_73367;\n            bool y_73368;\n            bool bounds_check_73369;\n            bool index_certs_73370;\n            int64_t loopres_73371;\n            int64_t min_res_73372;\n            bool x_73373;\n            bool y_73374;\n            bool bounds_check_73375;\n            bool index_certs_73376;\n            bool cond_73379;\n            int64_t si_next_73380;\n            int64_t max_arg1_73387;\n            int64_t max_res_73388;\n            bool x_73389;\n            bool y_73390;\n            bool bounds_check_73391;\n            bool index_certs_73392;\n            int64_t min_res_73395;\n            bool x_73396;\n            bool y_73397;\n            bool bounds_check_73398;\n            bool index_certs_73399;\n            int64_t max_arg1_73402;\n            int64_t max_res_73403;\n            bool x_73404;\n            bool y_73405;\n            bool bounds_check_73406;\n            bool index_certs_73407;\n            int64_t slice_73377;\n            double s_min_73378;\n            int64_t slice_73393;\n            int64_t slice_73400;\n            int64_t slice_73408;\n            bool defunc_0_gt_res_73410;\n", "            bool loopres_73411;\n            int64_t loopres_73412;\n            bool loop_while_tmp_76745;\n            int64_t fm_tmp_76746;\n            \n            x_73367 = sle64((int64_t) 0, fm_73366);\n            y_73368 = slt64(fm_73366, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_73369 = x_73367 && y_73368;\n            if (!bounds_check_73369) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 30) == -1) {\n                        global_failure_args[0] = (int64_t) fm_73366;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_73371 = ((__global int64_t *) mem_75488)[fm_73366];\n            min_res_73372 = smin64(gt_rhs_64823, loopres_73371);\n            x_73373 = sle64((int64_t) 0, min_res_73372);\n            y_73374 = slt64(min_res_73372, nR_57224);\n            bounds_check_73375 = x_73373 && y_73374;\n            if (!bounds_check_73375) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 31) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_73372;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_73379 = sle64(zeze_rhs_65256, fm_73366);\n            if (cond_73379) {\n                si_next_73380 = nR_57224;\n            } else {\n                int64_t tmp_73381;\n                bool x_73382;\n                bool y_73383;\n                bool bounds_check_73384;\n                bool index_certs_73385;\n                int64_t si_next_f_res_73386;\n                \n                tmp_73381 = add64((int64_t) 1, fm_73366);\n                x_73382 = sle64((int64_t) 0, tmp_7",
                                    "3381);\n                y_73383 = slt64(tmp_73381, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_73384 = x_73382 && y_73383;\n                if (!bounds_check_73384) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 32) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_73381;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_73386 = ((__global int64_t *) mem_75488)[tmp_73381];\n                si_next_73380 = si_next_f_res_73386;\n            }\n            max_arg1_73387 = sub64(si_next_73380, (int64_t) 1);\n            max_res_73388 = smax64(min_res_73372, max_arg1_73387);\n            x_73389 = sle64((int64_t) 0, max_res_73388);\n            y_73390 = slt64(max_res_73388, nR_57224);\n            bounds_check_73391 = x_73389 && y_73390;\n            if (!bounds_check_73391) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 33) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_73388;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_73395 = smin64(zeze_rhs_65256, si_next_73380);\n            x_73396 = sle64((int64_t) 0, min_res_73395);\n            y_73397 = slt64(min_res_73395, nR_57224);\n            bounds_check_73398 = x_73396 && y_73397;\n            if (!bounds_check_73398) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 34) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_73395;\n                        global_failure_args[1] = (int64_", "t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_73402 = sub64(min_res_73372, (int64_t) 1);\n            max_res_73403 = smax64((int64_t) 0, max_arg1_73402);\n            x_73404 = sle64((int64_t) 0, max_res_73403);\n            y_73405 = slt64(max_res_73403, nR_57224);\n            bounds_check_73406 = x_73404 && y_73405;\n            if (!bounds_check_73406) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 35) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_73403;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_73377 = tS_start_64840 + min_res_73372;\n            s_min_73378 = ((__global double *) tS_mem_75468)[slice_73377];\n            slice_73393 = tS_start_64840 + max_res_73388;\n            slice_73400 = tS_start_64840 + min_res_73395;\n            slice_73408 = tS_start_64840 + max_res_73403;\n            defunc_0_gt_res_73410 = s_min_73378 < r_min_73347;\n            if (defunc_0_gt_res_73410) {\n                double s_max_73394;\n                bool defunc_0_leq_res_73413;\n                bool loopres_t_res_73414;\n                int64_t loopres_t_res_73415;\n                \n                s_max_73394 = ((__global double *) tS_mem_75468)[slice_73393];\n                defunc_0_leq_res_73413 = r_min_73347 <= s_max_73394;\n                if (defunc_0_leq_res_73413) {\n                    loopres_t_res_73414 = 0;\n                    loopres_t_res_73415 = fm_73366;\n                } else {\n                    double s_nextMin_73401;\n                    bool defunc_0_leq_res_73416;\n                    int64_t zgze_lhs_73417;\n                    bool tmp_f_res_73418;\n                    bool x_73419;\n                    bool y_73420;\n                    bool tmp_73421;\n", "                    bool loopres_t_res_f_res_73422;\n                    \n                    s_nextMin_73401 = ((__global double *) tS_mem_75468)[slice_73400];\n                    defunc_0_leq_res_73416 = r_min_73347 <= s_nextMin_73401;\n                    zgze_lhs_73417 = add64((int64_t) 1, fm_73366);\n                    tmp_f_res_73418 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zgze_lhs_73417);\n                    x_73419 = !defunc_0_leq_res_73416;\n                    y_73420 = tmp_f_res_73418 && x_73419;\n                    tmp_73421 = defunc_0_leq_res_73416 || y_73420;\n                    loopres_t_res_f_res_73422 = !tmp_73421;\n                    loopres_t_res_73414 = loopres_t_res_f_res_73422;\n                    loopres_t_res_73415 = zgze_lhs_73417;\n                }\n                loopres_73411 = loopres_t_res_73414;\n                loopres_73412 = loopres_t_res_73415;\n            } else {\n                double s_prevMax_73409;\n                bool defunc_0_leq_res_73423;\n                int64_t zlze_lhs_73424;\n                bool tmp_f_res_73425;\n                bool x_73426;\n                bool y_73427;\n                bool tmp_73428;\n                int64_t max_res_73429;\n                bool loopres_f_res_73430;\n                \n                s_prevMax_73409 = ((__global double *) tS_mem_75468)[slice_73408];\n                defunc_0_leq_res_73423 = s_prevMax_73409 <= r_min_73347;\n                zlze_lhs_73424 = sub64(fm_73366, (int64_t) 1);\n                tmp_f_res_73425 = sle64(zlze_lhs_73424, (int64_t) 0);\n                x_73426 = !defunc_0_leq_res_73423;\n                y_73427 = tmp_f_res_73425 && x_73426;\n                tmp_73428 = defunc_0_leq_res_73423 || y_73427;\n                max_res_73429 = smax64((int64_t) 0, zlze_lhs_73424);\n                loopres_f_res_73430 = !tmp_73428;\n                loopres_73411 = loopres_f_res_73430;\n                loopres_73412 = max_res_73429;\n            }\n           ",
                                    " loop_while_tmp_76745 = loopres_73411;\n            fm_tmp_76746 = loopres_73412;\n            loop_while_73365 = loop_while_tmp_76745;\n            fm_73366 = fm_tmp_76746;\n        }\n        defunc_0_f_res_73363 = loop_while_73365;\n        defunc_0_f_res_73364 = fm_73366;\n        loop_while_73434 = 1;\n        lm_73435 = gtid_73338;\n        while (loop_while_73434) {\n            bool x_73436;\n            bool y_73437;\n            bool bounds_check_73438;\n            bool index_certs_73439;\n            int64_t loopres_73440;\n            int64_t min_res_73441;\n            bool x_73442;\n            bool y_73443;\n            bool bounds_check_73444;\n            bool index_certs_73445;\n            bool cond_73448;\n            int64_t si_next_73449;\n            int64_t max_arg1_73456;\n            int64_t max_res_73457;\n            bool x_73458;\n            bool y_73459;\n            bool bounds_check_73460;\n            bool index_certs_73461;\n            int64_t min_res_73464;\n            bool x_73465;\n            bool y_73466;\n            bool bounds_check_73467;\n            bool index_certs_73468;\n            int64_t max_arg1_73471;\n            int64_t max_res_73472;\n            bool x_73473;\n            bool y_73474;\n            bool bounds_check_73475;\n            bool index_certs_73476;\n            int64_t slice_73446;\n            int64_t slice_73462;\n            double s_max_73463;\n            int64_t slice_73469;\n            int64_t slice_73477;\n            bool defunc_0_gt_res_73479;\n            bool loopres_73480;\n            int64_t loopres_73481;\n            bool loop_cond_t_res_73496;\n            bool x_73497;\n            bool loop_while_tmp_76747;\n            int64_t lm_tmp_76748;\n            \n            x_73436 = sle64((int64_t) 0, lm_73435);\n            y_73437 = slt64(lm_73435, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_73438 = x_73436 && y_73437;\n            if (!bounds_check_73438) {\n                {\n    ", "                if (atomic_cmpxchg_i32_global(global_failure, -1, 36) == -1) {\n                        global_failure_args[0] = (int64_t) lm_73435;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_73440 = ((__global int64_t *) mem_75488)[lm_73435];\n            min_res_73441 = smin64(gt_rhs_64823, loopres_73440);\n            x_73442 = sle64((int64_t) 0, min_res_73441);\n            y_73443 = slt64(min_res_73441, nR_57224);\n            bounds_check_73444 = x_73442 && y_73443;\n            if (!bounds_check_73444) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 37) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_73441;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_73448 = sle64(zeze_rhs_65256, lm_73435);\n            if (cond_73448) {\n                si_next_73449 = nR_57224;\n            } else {\n                int64_t tmp_73450;\n                bool x_73451;\n                bool y_73452;\n                bool bounds_check_73453;\n                bool index_certs_73454;\n                int64_t si_next_f_res_73455;\n                \n                tmp_73450 = add64((int64_t) 1, lm_73435);\n                x_73451 = sle64((int64_t) 0, tmp_73450);\n                y_73452 = slt64(tmp_73450, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_73453 = x_73451 && y_73452;\n                if (!bounds_check_73453) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 38) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_73450;\n                        ", "    global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_73455 = ((__global int64_t *) mem_75488)[tmp_73450];\n                si_next_73449 = si_next_f_res_73455;\n            }\n            max_arg1_73456 = sub64(si_next_73449, (int64_t) 1);\n            max_res_73457 = smax64(min_res_73441, max_arg1_73456);\n            x_73458 = sle64((int64_t) 0, max_res_73457);\n            y_73459 = slt64(max_res_73457, nR_57224);\n            bounds_check_73460 = x_73458 && y_73459;\n            if (!bounds_check_73460) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 39) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_73457;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_73464 = smin64(zeze_rhs_65256, si_next_73449);\n            x_73465 = sle64((int64_t) 0, min_res_73464);\n            y_73466 = slt64(min_res_73464, nR_57224);\n            bounds_check_73467 = x_73465 && y_73466;\n            if (!bounds_check_73467) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 40) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_73464;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_73471 = sub64(min_res_73441, (int64_t) 1);\n            max_res_73472 = smax64((int64_t) 0, max_arg1_73471);\n            x_73473 = sle64((int64_t) 0, max_res_73472);\n            y_73474 = slt64(max_res_73472, nR_57224);\n            bounds_check_73475 = x_73473 && y_73474;\n            i",
                                    "f (!bounds_check_73475) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 41) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_73472;\n                        global_failure_args[1] = (int64_t) nR_57224;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_73446 = tS_start_64840 + min_res_73441;\n            slice_73462 = tS_start_64840 + max_res_73457;\n            s_max_73463 = ((__global double *) tS_mem_75468)[slice_73462];\n            slice_73469 = tS_start_64840 + min_res_73464;\n            slice_73477 = tS_start_64840 + max_res_73472;\n            defunc_0_gt_res_73479 = r_max_73362 < s_max_73463;\n            if (defunc_0_gt_res_73479) {\n                double s_min_73447;\n                bool defunc_0_leq_res_73482;\n                bool loopres_t_res_73483;\n                int64_t loopres_t_res_73484;\n                \n                s_min_73447 = ((__global double *) tS_mem_75468)[slice_73446];\n                defunc_0_leq_res_73482 = s_min_73447 <= r_max_73362;\n                if (defunc_0_leq_res_73482) {\n                    loopres_t_res_73483 = 0;\n                    loopres_t_res_73484 = lm_73435;\n                } else {\n                    double s_prevMax_73478;\n                    bool defunc_0_leq_res_73485;\n                    int64_t zlze_lhs_73486;\n                    bool tmp_f_res_73487;\n                    bool x_73488;\n                    bool y_73489;\n                    bool tmp_73490;\n                    int64_t max_res_73491;\n                    bool loopres_t_res_f_res_73492;\n                    \n                    s_prevMax_73478 = ((__global double *) tS_mem_75468)[slice_73477];\n                    defunc_0_leq_res_73485 = s_prevMax_73478 <= r_max_73362;\n                    zlze_lhs_73486 = sub64(lm_73435, (int64_t) 1);\n                    tmp_f_res_73487 = sle64(zlze_lhs_73486, (int64_t) 0);\n      ", "              x_73488 = !defunc_0_leq_res_73485;\n                    y_73489 = tmp_f_res_73487 && x_73488;\n                    tmp_73490 = defunc_0_leq_res_73485 || y_73489;\n                    max_res_73491 = smax64((int64_t) 0, zlze_lhs_73486);\n                    loopres_t_res_f_res_73492 = !tmp_73490;\n                    loopres_t_res_73483 = loopres_t_res_f_res_73492;\n                    loopres_t_res_73484 = max_res_73491;\n                }\n                loopres_73480 = loopres_t_res_73483;\n                loopres_73481 = loopres_t_res_73484;\n            } else {\n                double s_nextMin_73470;\n                bool defunc_0_leq_res_73493;\n                int64_t tmp_73494;\n                bool loopres_f_res_73495;\n                \n                s_nextMin_73470 = ((__global double *) tS_mem_75468)[slice_73469];\n                defunc_0_leq_res_73493 = r_max_73362 <= s_nextMin_73470;\n                tmp_73494 = add64((int64_t) 1, lm_73435);\n                loopres_f_res_73495 = !defunc_0_leq_res_73493;\n                loopres_73480 = loopres_f_res_73495;\n                loopres_73481 = tmp_73494;\n            }\n            loop_cond_t_res_73496 = slt64(loopres_73481, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            x_73497 = loopres_73480 && loop_cond_t_res_73496;\n            loop_while_tmp_76747 = x_73497;\n            lm_tmp_76748 = loopres_73481;\n            loop_while_73434 = loop_while_tmp_76747;\n            lm_73435 = lm_tmp_76748;\n        }\n        defunc_0_f_res_73432 = loop_while_73434;\n        defunc_0_f_res_73433 = lm_73435;\n        ((__global int64_t *) mem_75522)[gtid_73338] = defunc_0_f_res_73364;\n        ((__global int64_t *) mem_75524)[gtid_73338] = defunc_0_f_res_73433;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73334\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73691_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73691(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20U", "r_startz7dUzg_65450, int64_t ext_75703, int64_t ext_75704, __global unsigned char *mem_param_75540, __global unsigned char *ext_mem_75707, __global unsigned char *mem_75711)\n{\n    #define segmap_tblock_sizze_73687 (inner_SMJ_doublezisegmap_73691zisegmap_tblock_sizze_73687)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76860;\n    int32_t tblock_sizze_76863;\n    int32_t wave_sizze_76862;\n    int32_t block_id_76861;\n    int32_t global_tid_76859;\n    int64_t phys_tid_73691;\n    int64_t global_tid_76864;\n    int64_t slice_76865;\n    int64_t gtid_73690;\n    int64_t remnant_76866;\n    \n    local_tid_76860 = get_local_id(0);\n    tblock_sizze_76863 = get_local_size(0);\n    wave_sizze_76862 = LOCKSTEP_WIDTH;\n    block_id_76861 = get_tblock_id(0);\n    global_tid_76859 = block_id_76861 * tblock_sizze_76863 + local_tid_76860;\n    phys_tid_73691 = sext_i32_i64(global_tid_76859);\n    global_tid_76864 = sext_i32_i64(block_id_76861) * segmap_tblock_sizze_73687 + sext_i32_i64(local_tid_76860);\n    slice_76865 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_73690 = global_tid_76864;\n    remnant_76866 = global_tid_76864 - gtid_73690;\n    if (slt64(gtid_73690, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_73692;\n        bool cond_73694;\n        int64_t lifted_lambda_res_73695;\n        \n        eta_p_73692 = ((__global int64_t *) mem_param_75540)[gtid_73690];\n        cond_73694 = slt64(eta_p_73692, (int64_t) 0);\n        if (cond_73694) {\n            int64_t eta_p_73693 = ((__global int64_t *) ext_mem_75707)[ext_75704 + gtid_73690 * ext_75703];\n            \n            lifted_lambda_res_73695 = eta_p_73693;\n        } else {\n            lifted_lambda_res_73695 = eta_p_73692;\n        }\n        ((__global int64_t *) mem_75711)[gtid_73690] = lifted_lambda_res_73695;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73687\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73712_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_",
                                    "73712(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75705, int64_t ext_75706, __global unsigned char *mem_param_75537, __global unsigned char *ext_mem_75708, __global unsigned char *mem_75714)\n{\n    #define segmap_tblock_sizze_73708 (inner_SMJ_doublezisegmap_73712zisegmap_tblock_sizze_73708)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76869;\n    int32_t tblock_sizze_76872;\n    int32_t wave_sizze_76871;\n    int32_t block_id_76870;\n    int32_t global_tid_76868;\n    int64_t phys_tid_73712;\n    int64_t global_tid_76873;\n    int64_t slice_76874;\n    int64_t gtid_73711;\n    int64_t remnant_76875;\n    \n    local_tid_76869 = get_local_id(0);\n    tblock_sizze_76872 = get_local_size(0);\n    wave_sizze_76871 = LOCKSTEP_WIDTH;\n    block_id_76870 = get_tblock_id(0);\n    global_tid_76868 = block_id_76870 * tblock_sizze_76872 + local_tid_76869;\n    phys_tid_73712 = sext_i32_i64(global_tid_76868);\n    global_tid_76873 = sext_i32_i64(block_id_76870) * segmap_tblock_sizze_73708 + sext_i32_i64(local_tid_76869);\n    slice_76874 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_73711 = global_tid_76873;\n    remnant_76875 = global_tid_76873 - gtid_73711;\n    if (slt64(gtid_73711, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_73713;\n        int64_t eta_p_73714;\n        int64_t defunc_0_f_res_73715;\n        \n        eta_p_73713 = ((__global int64_t *) mem_param_75537)[gtid_73711];\n        eta_p_73714 = ((__global int64_t *) ext_mem_75708)[ext_75706 + gtid_73711 * ext_75705];\n        defunc_0_f_res_73715 = add64(eta_p_73713, eta_p_73714);\n        ((__global int64_t *) mem_75714)[gtid_73711] = defunc_0_f_res_73715;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73708\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73733_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73733(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz", "20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75528, int64_t ctx_param_ext_75529, __global unsigned char *mem_param_75530, __global unsigned char *ext_mem_75719, __global unsigned char *mem_75723)\n{\n    #define segmap_tblock_sizze_73729 (inner_SMJ_doublezisegmap_73733zisegmap_tblock_sizze_73729)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76878;\n    int32_t tblock_sizze_76881;\n    int32_t wave_sizze_76880;\n    int32_t block_id_76879;\n    int32_t global_tid_76877;\n    int64_t phys_tid_73733;\n    int64_t global_tid_76882;\n    int64_t slice_76883;\n    int64_t gtid_73732;\n    int64_t remnant_76884;\n    \n    local_tid_76878 = get_local_id(0);\n    tblock_sizze_76881 = get_local_size(0);\n    wave_sizze_76880 = LOCKSTEP_WIDTH;\n    block_id_76879 = get_tblock_id(0);\n    global_tid_76877 = block_id_76879 * tblock_sizze_76881 + local_tid_76878;\n    phys_tid_73733 = sext_i32_i64(global_tid_76877);\n    global_tid_76882 = sext_i32_i64(block_id_76879) * segmap_tblock_sizze_73729 + sext_i32_i64(local_tid_76878);\n    slice_76883 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_73732 = global_tid_76882;\n    remnant_76884 = global_tid_76882 - gtid_73732;\n    if (slt64(gtid_73732, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73891;\n        int64_t eta_p_73734;\n        bool cond_73736;\n        int64_t lifted_lambda_res_73737;\n        \n        slice_73891 = loopres_f_res_f_res_65435 + gtid_73732;\n        eta_p_73734 = ((__global int64_t *) mem_param_75530)[ctx_param_ext_75528 + slice_73891 * ctx_param_ext_75529];\n        cond_73736 = slt64(eta_p_73734, (int64_t) 0);\n        if (cond_73736) {\n            int64_t eta_p_73735 = ((__global int64_t *) ext_mem_75719)[gtid_73732];\n            \n            lifted_lambda_res_73737 = eta_p_73735;\n        } else {\n            lifted_lambda_res_73737 = eta_p_73734;\n        }\n        ((__global int64_t *) mem_75723)[gtid_73732] = lifted_lambda_res_73737;\n    }\n    \n  error_0:\n    return", ";\n    #undef segmap_tblock_sizze_73729\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73754_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73754(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75525, int64_t ctx_param_ext_75526, __global unsigned char *mem_param_75527, __global unsigned char *ext_mem_75720, __global unsigned char *mem_75726)\n{\n    #define segmap_tblock_sizze_73750 (inner_SMJ_doublezisegmap_73754zisegmap_tblock_sizze_73750)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76887;\n    int32_t tblock_sizze_76890;\n    int32_t wave_sizze_76889;\n    int32_t block_id_76888;\n    int32_t global_tid_76886;\n    int64_t phys_tid_73754;\n    int64_t global_tid_76891;\n    int64_t slice_76892;\n    int64_t gtid_73753;\n    int64_t remnant_76893;\n    \n    local_tid_76887 = get_local_id(0);\n    tblock_sizze_76890 = get_local_size(0);\n    wave_sizze_76889 = LOCKSTEP_WIDTH;\n    block_id_76888 = get_tblock_id(0);\n    global_tid_76886 = block_id_76888 * tblock_sizze_76890 + local_tid_76887;\n    phys_tid_73754 = sext_i32_i64(global_tid_76886);\n    global_tid_76891 = sext_i32_i64(block_id_76888) * segmap_tblock_sizze_73750 + sext_i32_i64(local_tid_76887);\n    slice_76892 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_73753 = global_tid_76891;\n    remnant_76893 = global_tid_76891 - gtid_73753;\n    if (slt64(gtid_73753, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73890;\n        int64_t eta_p_73755;\n        int64_t eta_p_73756;\n        int64_t defunc_0_f_res_73757;\n        \n        slice_73890 = loopres_f_res_f_res_65435 + gtid_73753;\n        eta_p_73755 = ((__global int64_t *) mem_param_75527)[ctx_param_ext_75525 + slice_73890 * ctx_param_ext_75526];\n        eta_p_73756 = ((__global int64_t *) ext_mem_75720)[gtid_73753];\n        defunc_0_f_res_73757 = add64(eta_p_73755, eta_p_73756);\n        ((__global int64_t *) mem_75726)[gti",
                                    "d_73753] = defunc_0_f_res_73757;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73750\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73775_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73775(__global int *global_failure, int64_t nR_57224, int64_t ext_75914, int64_t ext_75915, __global unsigned char *mem_param_75482, __global unsigned char *ext_mem_75916, __global unsigned char *mem_75922)\n{\n    #define segmap_tblock_sizze_73771 (inner_SMJ_doublezisegmap_73775zisegmap_tblock_sizze_73771)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76896;\n    int32_t tblock_sizze_76899;\n    int32_t wave_sizze_76898;\n    int32_t block_id_76897;\n    int32_t global_tid_76895;\n    int64_t phys_tid_73775;\n    int64_t global_tid_76900;\n    int64_t slice_76901;\n    int64_t gtid_73774;\n    int64_t remnant_76902;\n    \n    local_tid_76896 = get_local_id(0);\n    tblock_sizze_76899 = get_local_size(0);\n    wave_sizze_76898 = LOCKSTEP_WIDTH;\n    block_id_76897 = get_tblock_id(0);\n    global_tid_76895 = block_id_76897 * tblock_sizze_76899 + local_tid_76896;\n    phys_tid_73775 = sext_i32_i64(global_tid_76895);\n    global_tid_76900 = sext_i32_i64(block_id_76897) * segmap_tblock_sizze_73771 + sext_i32_i64(local_tid_76896);\n    slice_76901 = nR_57224;\n    gtid_73774 = global_tid_76900;\n    remnant_76902 = global_tid_76900 - gtid_73774;\n    if (slt64(gtid_73774, nR_57224)) {\n        int64_t eta_p_73776;\n        bool cond_73778;\n        int64_t lifted_lambda_res_73779;\n        \n        eta_p_73776 = ((__global int64_t *) mem_param_75482)[gtid_73774];\n        cond_73778 = slt64(eta_p_73776, (int64_t) 0);\n        if (cond_73778) {\n            int64_t eta_p_73777 = ((__global int64_t *) ext_mem_75916)[ext_75915 + gtid_73774 * ext_75914];\n            \n            lifted_lambda_res_73779 = eta_p_73777;\n        } else {\n            lifted_lambda_res_73779 = eta_p_73776;\n        }\n        ((__global int64_t *) mem_75922)[gtid_73774] = lifted_lambda_res_73779;\n    }\n  ", "  \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73771\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73796_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73796(__global int *global_failure, int64_t nR_57224, int64_t ext_75917, int64_t ext_75918, __global unsigned char *mem_param_75479, __global unsigned char *ext_mem_75919, __global unsigned char *mem_75925)\n{\n    #define segmap_tblock_sizze_73792 (inner_SMJ_doublezisegmap_73796zisegmap_tblock_sizze_73792)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76905;\n    int32_t tblock_sizze_76908;\n    int32_t wave_sizze_76907;\n    int32_t block_id_76906;\n    int32_t global_tid_76904;\n    int64_t phys_tid_73796;\n    int64_t global_tid_76909;\n    int64_t slice_76910;\n    int64_t gtid_73795;\n    int64_t remnant_76911;\n    \n    local_tid_76905 = get_local_id(0);\n    tblock_sizze_76908 = get_local_size(0);\n    wave_sizze_76907 = LOCKSTEP_WIDTH;\n    block_id_76906 = get_tblock_id(0);\n    global_tid_76904 = block_id_76906 * tblock_sizze_76908 + local_tid_76905;\n    phys_tid_73796 = sext_i32_i64(global_tid_76904);\n    global_tid_76909 = sext_i32_i64(block_id_76906) * segmap_tblock_sizze_73792 + sext_i32_i64(local_tid_76905);\n    slice_76910 = nR_57224;\n    gtid_73795 = global_tid_76909;\n    remnant_76911 = global_tid_76909 - gtid_73795;\n    if (slt64(gtid_73795, nR_57224)) {\n        int64_t eta_p_73797;\n        int64_t eta_p_73798;\n        int64_t defunc_0_f_res_73799;\n        \n        eta_p_73797 = ((__global int64_t *) mem_param_75479)[gtid_73795];\n        eta_p_73798 = ((__global int64_t *) ext_mem_75919)[ext_75918 + gtid_73795 * ext_75917];\n        defunc_0_f_res_73799 = add64(eta_p_73797, eta_p_73798);\n        ((__global int64_t *) mem_75925)[gtid_73795] = defunc_0_f_res_73799;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73792\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73809_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73809(__global int *global_failure, int64_t nR_57224, ", "int64_t m_65686, int64_t num_tblocks_73814, int32_t virt_num_tblocks_77062, __global unsigned char *tR_mem_75467, __global unsigned char *ext_mem_75469, __global unsigned char *ext_mem_75937, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *mem_75945, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951)\n{\n    #define segmap_tblock_sizze_73812 (inner_SMJ_doublezisegmap_73809zisegmap_tblock_sizze_73812)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77064;\n    int32_t tblock_sizze_77067;\n    int32_t wave_sizze_77066;\n    int32_t block_id_77065;\n    int32_t global_tid_77063;\n    int64_t phys_tid_73809;\n    int32_t phys_tblock_id_77068;\n    int32_t iterations_77069;\n    \n    local_tid_77064 = get_local_id(0);\n    tblock_sizze_77067 = get_local_size(0);\n    wave_sizze_77066 = LOCKSTEP_WIDTH;\n    block_id_77065 = get_tblock_id(0);\n    global_tid_77063 = block_id_77065 * tblock_sizze_77067 + local_tid_77064;\n    phys_tid_73809 = sext_i32_i64(global_tid_77063);\n    phys_tblock_id_77068 = get_tblock_id(0);\n    iterations_77069 = sdiv_up32(virt_num_tblocks_77062 - phys_tblock_id_77068, sext_i64_i32(num_tblocks_73814));\n    for (int32_t i_77070 = 0; i_77070 < iterations_77069; i_77070++) {\n        int32_t virt_tblock_id_77071;\n        int64_t global_tid_77072;\n        int64_t slice_77073;\n        int64_t write_i_73808;\n        int64_t remnant_77074;\n        \n        virt_tblock_id_77071 = phys_tblock_id_77068 + i_77070 * sext_i64_i32(num_tblocks_73814);\n        global_tid_77072 = sext_i32_i64(virt_tblock_id_77071) * segmap_tblock_sizze_73812 + sext_i32_i64(local_tid_77064);\n        slice_77073 = nR_57224;\n        write_i_73808 = global_tid_77072;\n        remnant_77074 = global_tid_77072 - write_i_73808;\n        if (slt64(write_i_73808, nR_57224)) {\n            int64_t eta_p_65951;\n            double write_value_65953;",
                                    "\n            int64_t write_value_65954;\n            int64_t write_value_65955;\n            int64_t write_value_65956;\n            bool cond_65957;\n            int64_t lifted_lambda_res_65958;\n            \n            eta_p_65951 = ((__global int64_t *) mem_75943)[write_i_73808];\n            write_value_65953 = ((__global double *) tR_mem_75467)[write_i_73808];\n            write_value_65954 = ((__global int64_t *) ext_mem_75469)[write_i_73808];\n            write_value_65955 = ((__global int64_t *) ext_mem_75937)[write_i_73808];\n            write_value_65956 = ((__global int64_t *) ext_mem_75938)[write_i_73808];\n            cond_65957 = eta_p_65951 == (int64_t) 1;\n            if (cond_65957) {\n                int64_t eta_p_65952;\n                int64_t lifted_lambda_res_t_res_66732;\n                \n                eta_p_65952 = ((__global int64_t *) mem_75941)[write_i_73808];\n                lifted_lambda_res_t_res_66732 = sub64(eta_p_65952, (int64_t) 1);\n                lifted_lambda_res_65958 = lifted_lambda_res_t_res_66732;\n            } else {\n                lifted_lambda_res_65958 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global double *) mem_75951)[lifted_lambda_res_65958] = write_value_65953;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75949)[lifted_lambda_res_65958] = write_value_65954;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75947)[lifted_lambda_res_65958] = write_value_65955;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75945)[lifted_lambda_res_65958] = write_value_65956;\n            }\n       ", " }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73812\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73843_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73843(__global int *global_failure, int64_t m_65686, __global unsigned char *mem_75955, __global unsigned char *mem_75962)\n{\n    #define segmap_tblock_sizze_73839 (inner_SMJ_doublezisegmap_73843zisegmap_tblock_sizze_73839)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77230;\n    int32_t tblock_sizze_77233;\n    int32_t wave_sizze_77232;\n    int32_t block_id_77231;\n    int32_t global_tid_77229;\n    int64_t phys_tid_73843;\n    int64_t global_tid_77234;\n    int64_t slice_77235;\n    int64_t gtid_73842;\n    int64_t remnant_77236;\n    \n    local_tid_77230 = get_local_id(0);\n    tblock_sizze_77233 = get_local_size(0);\n    wave_sizze_77232 = LOCKSTEP_WIDTH;\n    block_id_77231 = get_tblock_id(0);\n    global_tid_77229 = block_id_77231 * tblock_sizze_77233 + local_tid_77230;\n    phys_tid_73843 = sext_i32_i64(global_tid_77229);\n    global_tid_77234 = sext_i32_i64(block_id_77231) * segmap_tblock_sizze_73839 + sext_i32_i64(local_tid_77230);\n    slice_77235 = m_65686;\n    gtid_73842 = global_tid_77234;\n    remnant_77236 = global_tid_77234 - gtid_73842;\n    if (slt64(gtid_73842, m_65686)) {\n        int64_t zv_lhs_73845;\n        int64_t tmp_73846;\n        bool cond_73848;\n        int64_t lifted_lambda_res_73849;\n        \n        zv_lhs_73845 = add64((int64_t) -1, gtid_73842);\n        tmp_73846 = smod64(zv_lhs_73845, m_65686);\n        cond_73848 = gtid_73842 == (int64_t) 0;\n        if (cond_73848) {\n            lifted_lambda_res_73849 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_73847 = ((__global int64_t *) mem_75955)[tmp_73846];\n            \n            lifted_lambda_res_73849 = lifted_lambda_res_73847;\n        }\n        ((__global int64_t *) mem_75962)[gtid_73842] = lifted_lambda_res_73849;\n    }\n    \n  ", "error_0:\n    return;\n    #undef segmap_tblock_sizze_73839\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73851_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73851(__global int *global_failure, int64_t m_65686, int64_t lower_bound_65769, int64_t min_res_65771, int64_t j_m_i_65772, int64_t num_tblocks_73856, int32_t virt_num_tblocks_77275, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951, __global unsigned char *mem_75962, __global unsigned char *mem_75991, __global unsigned char *mem_75993, __global unsigned char *mem_75995)\n{\n    #define segmap_tblock_sizze_73854 (inner_SMJ_doublezisegmap_73851zisegmap_tblock_sizze_73854)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77277;\n    int32_t tblock_sizze_77280;\n    int32_t wave_sizze_77279;\n    int32_t block_id_77278;\n    int32_t global_tid_77276;\n    int64_t phys_tid_73851;\n    int32_t phys_tblock_id_77281;\n    int32_t iterations_77282;\n    \n    local_tid_77277 = get_local_id(0);\n    tblock_sizze_77280 = get_local_size(0);\n    wave_sizze_77279 = LOCKSTEP_WIDTH;\n    block_id_77278 = get_tblock_id(0);\n    global_tid_77276 = block_id_77278 * tblock_sizze_77280 + local_tid_77277;\n    phys_tid_73851 = sext_i32_i64(global_tid_77276);\n    phys_tblock_id_77281 = get_tblock_id(0);\n    iterations_77282 = sdiv_up32(virt_num_tblocks_77275 - phys_tblock_id_77281, sext_i64_i32(num_tblocks_73856));\n    for (int32_t i_77283 = 0; i_77283 < iterations_77282; i_77283++) {\n        int32_t virt_tblock_id_77284;\n        int64_t global_tid_77285;\n        int64_t slice_77286;\n        int64_t write_i_73850;\n        int64_t remnant_77287;\n        \n        virt_tblock_id_77284 = phys_tblock_id_77281 + i_77283 * sext_i64_i32(num_tblocks_73856);\n        global_tid_77285 = sext_i32_i64(virt_tblock_id_77284) * segmap_tblock_sizze_73854 + sext_i32_i64(local_tid_77277);\n        slice_77286 = m_65686;\n        write_i_73850 = global_tid_77285;\n        remnant_77287 = global_tid",
                                    "_77285 - write_i_73850;\n        if (slt64(write_i_73850, m_65686)) {\n            int64_t eta_p_66344;\n            double write_value_66345;\n            int64_t write_value_66346;\n            int64_t write_value_66347;\n            bool cond_66348;\n            bool cond_t_res_66349;\n            bool x_66350;\n            int64_t lifted_lambda_res_66351;\n            \n            eta_p_66344 = ((__global int64_t *) mem_75962)[write_i_73850];\n            write_value_66345 = ((__global double *) mem_75951)[write_i_73850];\n            write_value_66346 = ((__global int64_t *) mem_75949)[write_i_73850];\n            write_value_66347 = ((__global int64_t *) mem_75947)[write_i_73850];\n            cond_66348 = sle64(lower_bound_65769, eta_p_66344);\n            cond_t_res_66349 = slt64(eta_p_66344, min_res_65771);\n            x_66350 = cond_66348 && cond_t_res_66349;\n            if (x_66350) {\n                int64_t lifted_lambda_res_t_res_66735 = sub64(eta_p_66344, lower_bound_65769);\n                \n                lifted_lambda_res_66351 = lifted_lambda_res_t_res_66735;\n            } else {\n                lifted_lambda_res_66351 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global double *) mem_75991)[lifted_lambda_res_66351] = write_value_66345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75993)[lifted_lambda_res_66351] = write_value_66346;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75995)[lifted_lambda_res_66351] = write_value_66347;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73854\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ", "_doublezisegmap_73859_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73859(__global int *global_failure, int64_t m_65686, int64_t m_65826, int64_t num_tblocks_73864, int32_t virt_num_tblocks_77257, __global unsigned char *mem_75945, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *mem_75962, __global unsigned char *mem_75970, __global unsigned char *mem_75972)\n{\n    #define segmap_tblock_sizze_73862 (inner_SMJ_doublezisegmap_73859zisegmap_tblock_sizze_73862)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77259;\n    int32_t tblock_sizze_77262;\n    int32_t wave_sizze_77261;\n    int32_t block_id_77260;\n    int32_t global_tid_77258;\n    int64_t phys_tid_73859;\n    int32_t phys_tblock_id_77263;\n    int32_t iterations_77264;\n    \n    local_tid_77259 = get_local_id(0);\n    tblock_sizze_77262 = get_local_size(0);\n    wave_sizze_77261 = LOCKSTEP_WIDTH;\n    block_id_77260 = get_tblock_id(0);\n    global_tid_77258 = block_id_77260 * tblock_sizze_77262 + local_tid_77259;\n    phys_tid_73859 = sext_i32_i64(global_tid_77258);\n    phys_tblock_id_77263 = get_tblock_id(0);\n    iterations_77264 = sdiv_up32(virt_num_tblocks_77257 - phys_tblock_id_77263, sext_i64_i32(num_tblocks_73864));\n    for (int32_t i_77265 = 0; i_77265 < iterations_77264; i_77265++) {\n        int32_t virt_tblock_id_77266;\n        int64_t global_tid_77267;\n        int64_t slice_77268;\n        int64_t write_i_73858;\n        int64_t remnant_77269;\n        \n        virt_tblock_id_77266 = phys_tblock_id_77263 + i_77265 * sext_i64_i32(num_tblocks_73864);\n        global_tid_77267 = sext_i32_i64(virt_tblock_id_77266) * segmap_tblock_sizze_73862 + sext_i32_i64(local_tid_77259);\n        slice_77268 = m_65686;\n        write_i_73858 = global_tid_77267;\n        remnant_77269 = global_tid_77267 - write_i_73858;\n        if (slt64(write_i_73858, m_65686)) {\n            int64_t eta_p_65928;\n            int64_t write_value_65930;\n            int64_t write_value_65931;", "\n            bool cond_65932;\n            int64_t lifted_lambda_res_65933;\n            \n            eta_p_65928 = ((__global int64_t *) mem_75959)[write_i_73858];\n            write_value_65930 = ((__global int64_t *) mem_75962)[write_i_73858];\n            write_value_65931 = ((__global int64_t *) mem_75945)[write_i_73858];\n            cond_65932 = eta_p_65928 == (int64_t) 1;\n            if (cond_65932) {\n                int64_t eta_p_65929;\n                int64_t lifted_lambda_res_t_res_66740;\n                \n                eta_p_65929 = ((__global int64_t *) mem_75957)[write_i_73858];\n                lifted_lambda_res_t_res_66740 = sub64(eta_p_65929, (int64_t) 1);\n                lifted_lambda_res_65933 = lifted_lambda_res_t_res_66740;\n            } else {\n                lifted_lambda_res_65933 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75972)[lifted_lambda_res_65933] = write_value_65930;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75970)[lifted_lambda_res_65933] = write_value_65931;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73862\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_73881_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_73881(__global int *global_failure, int64_t loopres_65870, int64_t loopres_65871, __global unsigned char *mem_76020, __global unsigned char *mem_76023)\n{\n    #define segmap_tblock_sizze_73877 (inner_SMJ_doublezisegmap_73881zisegmap_tblock_sizze_73877)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77344;\n    int32_t tblock_sizze_77347;\n    int32_t wave_sizze_77346;\n    int32_t block_id_77345;\n    int32_t global_tid_77343;\n    int64_t phys_tid_73881;\n    int64_t",
                                    " global_tid_77348;\n    int64_t slice_77349;\n    int64_t gtid_73880;\n    int64_t remnant_77350;\n    \n    local_tid_77344 = get_local_id(0);\n    tblock_sizze_77347 = get_local_size(0);\n    wave_sizze_77346 = LOCKSTEP_WIDTH;\n    block_id_77345 = get_tblock_id(0);\n    global_tid_77343 = block_id_77345 * tblock_sizze_77347 + local_tid_77344;\n    phys_tid_73881 = sext_i32_i64(global_tid_77343);\n    global_tid_77348 = sext_i32_i64(block_id_77345) * segmap_tblock_sizze_73877 + sext_i32_i64(local_tid_77344);\n    slice_77349 = loopres_65871;\n    gtid_73880 = global_tid_77348;\n    remnant_77350 = global_tid_77348 - gtid_73880;\n    if (slt64(gtid_73880, loopres_65871)) {\n        int64_t loopres_75462;\n        int64_t tmp_73883;\n        \n        loopres_75462 = ((__global int64_t *) mem_76023)[(int64_t) 0];\n        tmp_73883 = add64(gtid_73880, loopres_75462);\n        ((__global int64_t *) mem_76020)[loopres_65870 + gtid_73880] = tmp_73883;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73877\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_73899_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_73899(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_73902, int64_t num_whole_tiles_73917, int64_t residual_input_74141, unsigned char cond_74142_bits, int64_t binop_x_74158, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75887, __global unsigned char *mem_75889)\n{\n    bool cond_74142 = cond_74142_bits;\n    \n    #define tile_sizze_73901 (inner_SMJ_doublezisegmap_intrablock_73899zitile_sizze_73901)\n    #define bytes_75849 (inner_SMJ_doublezisegmap_intrablock_73899zibytes_75849)\n    \n    volatile __local unsigned char *color_76532_backing_2 = &shared_mem[0];\n    const int64_t color_76532_backing_2_offset = 0 + (bytes_75849 + srem64((int64_t) 8 - ", "srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76531_backing_1 = &shared_mem[color_76532_backing_2_offset];\n    const int64_t color_76531_backing_1_offset = color_76532_backing_2_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76530_backing_0 = &shared_mem[color_76531_backing_1_offset];\n    const int64_t color_76530_backing_0_offset = color_76531_backing_1_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76641;\n    int32_t tblock_sizze_76644;\n    int32_t wave_sizze_76643;\n    int32_t block_id_76642;\n    int32_t global_tid_76640;\n    int64_t gid_flat_73899;\n    int64_t slice_76646;\n    int64_t ltid_pre_76645;\n    int64_t remnant_76647;\n    int64_t slice_76648;\n    int64_t gid_73898;\n    int64_t remnant_76649;\n    __local unsigned char *color_76530;\n    __local unsigned char *color_76531;\n    __local unsigned char *color_76532;\n    int64_t binop_x_73909;\n    double mem_75833[1];\n    int64_t ltid_flat_73904;\n    int64_t ltid_73903;\n    int64_t gtid_73910;\n    bool cond_73911;\n    double pre_73912;\n    int64_t mem_75837[1];\n    double mem_75841[1];\n    int64_t mem_75845[1];\n    int64_t ltid_flat_73919;\n    int64_t ltid_73918;\n    int64_t gtid_73929;\n    bool cond_73930;\n    int64_t neutral_73931;\n    double neutral_73932;\n    int64_t ext_mem_75869[1];\n    double ext_mem_75868[1];\n    int64_t ext_mem_75867[1];\n    int64_t mem_param_75846[1];\n    double mem_param_75847[1];\n    int64_t mem_param_75848[1];\n    int64_t mem_75879[1];\n    int64_t mem_75883[1];\n    int64_t ext_mem_75885[1];\n    int64_t ext_mem_75884[1];\n    \n    local_tid_76641 = get_local_id(0);\n    tblock_sizze_76644 = get_local_size(0);\n    wave_sizze_76643 = LOCKSTEP_WIDTH;\n    block_id_76642 = get_tblock_id(0);\n    global_tid_76640 = block_id_76642 * tbloc", "k_sizze_76644 + local_tid_76641;\n    gid_flat_73899 = sext_i32_i64(block_id_76642);\n    slice_76646 = tile_sizze_73901;\n    ltid_pre_76645 = sext_i32_i64(local_tid_76641);\n    remnant_76647 = sext_i32_i64(local_tid_76641) - ltid_pre_76645;\n    slice_76648 = ldim_73902;\n    gid_73898 = sext_i32_i64(block_id_76642);\n    remnant_76649 = sext_i32_i64(block_id_76642) - gid_73898;\n    color_76530 = (__local unsigned char *) color_76530_backing_0;\n    color_76531 = (__local unsigned char *) color_76531_backing_1;\n    color_76532 = (__local unsigned char *) color_76532_backing_2;\n    binop_x_73909 = gid_73898 * tile_sizze_73901;\n    ltid_flat_73904 = sext_i32_i64(local_tid_76641);\n    ltid_73903 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73910 = ltid_73903 + binop_x_73909;\n    cond_73911 = slt64(gtid_73910, min_res_66402);\n    if (cond_73911) {\n        int64_t slice_73913;\n        double eta_p_73914;\n        \n        slice_73913 = start_66400 + gtid_73910;\n        eta_p_73914 = ((__global double *) tR_mem_75467)[slice_73913];\n        pre_73912 = eta_p_73914;\n    } else {\n        pre_73912 = 0.0;\n    }\n    mem_75833[(int64_t) 0] = pre_73912;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_73919 = sext_i32_i64(local_tid_76641);\n    ltid_73918 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73929 = binop_x_73909 + ltid_73918;\n    cond_73930 = slt64(gtid_73929, min_res_66402);\n    if (cond_73930) {\n        neutral_73931 = (int64_t) -1;\n    } else {\n        neutral_73931 = (int64_t) 0;\n    }\n    if (cond_73930) {\n        double eta_p_73934 = mem_75833[(int64_t) 0];\n        \n        neutral_73932 = eta_p_73934;\n    } else {\n        neutral_73932 = 0.0;\n    }\n    mem_75837[(int64_t) 0] = neutral_73931;\n    mem_75841[(int64_t) 0] = neutral_73932;\n    mem_75845[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75846[i_3] = mem_75837[i_3];\n    for (int32_t i_4 ",
                                    "= 0; i_4 < 1; i_4++)\n        mem_param_75847[i_4] = mem_75841[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75848[i_5] = mem_75845[i_5];\n    for (int64_t tile_id_73944 = 0; tile_id_73944 < num_whole_tiles_73917; tile_id_73944++) {\n        int64_t binop_x_74043;\n        int64_t ltid_flat_74042;\n        int64_t ltid_74041;\n        int64_t j_74044;\n        bool cond_74048;\n        int64_t pre1d_74051;\n        int64_t pre1d_74049;\n        double pre1d_74050;\n        int64_t mem_75858[1];\n        double mem_75862[1];\n        int64_t mem_75866[1];\n        int64_t ltid_flat_74062;\n        int64_t ltid_74061;\n        int64_t gtid_74064;\n        int64_t acc_74066;\n        double acc_74067;\n        int64_t acc_74068;\n        bool cond_74069;\n        int64_t acc_74070;\n        double acc_74071;\n        int64_t acc_74072;\n        int64_t mem_param_tmp_76650[1];\n        double mem_param_tmp_76651[1];\n        int64_t mem_param_tmp_76652[1];\n        \n        binop_x_74043 = tile_sizze_73901 * tile_id_73944;\n        ltid_flat_74042 = sext_i32_i64(local_tid_76641);\n        ltid_74041 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74044 = ltid_74041 + binop_x_74043;\n        cond_74048 = slt64(j_74044, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74051 = btoi_bool_i64(cond_74048);\n        if (cond_74048) {\n            int64_t tile_elem_74052;\n            int64_t slice_75321;\n            double tile_elem_74053;\n            \n            tile_elem_74052 = ((__global int64_t *) ext_mem_75767)[j_74044];\n            slice_75321 = tS_start_64840 + j_74044;\n            tile_elem_74053 = ((__global double *) tS_mem_75468)[slice_75321];\n            pre1d_74049 = tile_elem_74052;\n            pre1d_74050 = tile_elem_74053;\n        } else {\n            pre1d_74049 = (int64_t) 0;\n            pre1d_74050 = 0.0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74041] = pre1d_74049;\n        ((__local double *) color_76531)[ltid_74041] = pre1d_740", "50;\n        ((__local int64_t *) color_76530)[ltid_74041] = pre1d_74051;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74062 = sext_i32_i64(local_tid_76641);\n        ltid_74061 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74064 = binop_x_73909 + ltid_74061;\n        acc_74066 = mem_param_75846[(int64_t) 0];\n        acc_74067 = mem_param_75847[(int64_t) 0];\n        acc_74068 = mem_param_75848[(int64_t) 0];\n        cond_74069 = slt64(gtid_74064, min_res_66402);\n        if (cond_74069) {\n            double eta_p_74065;\n            int64_t x_74073;\n            double x_74074;\n            int64_t x_74075;\n            int64_t redout_75334;\n            double redout_75335;\n            int64_t redout_75336;\n            \n            eta_p_74065 = mem_75833[(int64_t) 0];\n            redout_75334 = acc_74066;\n            redout_75335 = acc_74067;\n            redout_75336 = acc_74068;\n            for (int64_t i_75337 = 0; i_75337 < tile_sizze_73901; i_75337++) {\n                int64_t x_74076;\n                double x_74077;\n                bool defunc_0_neq_res_74085;\n                bool defunc_0_neq_res_74086;\n                bool cond_f_res_74087;\n                bool y_74088;\n                bool cond_74089;\n                bool defunc_0_neq_res_74090;\n                bool defunc_0_neq_res_74091;\n                bool cond_t_res_f_res_74092;\n                bool y_74093;\n                bool cond_t_res_74094;\n                bool x_74095;\n                int64_t defunc_0_op_res_74096;\n                double defunc_0_op_res_74097;\n                int64_t defunc_0_op_res_74098;\n                int64_t redout_tmp_76656;\n                double redout_tmp_76657;\n                int64_t redout_tmp_76658;\n                \n                x_74076 = ((__local int64_t *) color_76532)[i_75337];\n                x_74077 = ((__local double *) color_76531)[i_75337];\n                defunc_0_neq_res_74085 = redout_75335 == eta_p_74065;\n                defunc_0_neq_r", "es_74086 = !defunc_0_neq_res_74085;\n                cond_f_res_74087 = slt64(redout_75334, (int64_t) 0);\n                y_74088 = defunc_0_neq_res_74085 && cond_f_res_74087;\n                cond_74089 = defunc_0_neq_res_74086 || y_74088;\n                defunc_0_neq_res_74090 = x_74077 == eta_p_74065;\n                defunc_0_neq_res_74091 = !defunc_0_neq_res_74090;\n                cond_t_res_f_res_74092 = slt64(x_74076, (int64_t) 0);\n                y_74093 = defunc_0_neq_res_74090 && cond_t_res_f_res_74092;\n                cond_t_res_74094 = defunc_0_neq_res_74091 || y_74093;\n                x_74095 = cond_74089 && cond_t_res_74094;\n                if (x_74095) {\n                    defunc_0_op_res_74096 = (int64_t) -1;\n                    defunc_0_op_res_74097 = eta_p_74065;\n                    defunc_0_op_res_74098 = (int64_t) 0;\n                } else {\n                    int64_t x_74078;\n                    int64_t defunc_0_op_res_f_res_74099;\n                    double defunc_0_op_res_f_res_74100;\n                    int64_t defunc_0_op_res_f_res_74101;\n                    \n                    x_74078 = ((__local int64_t *) color_76530)[i_75337];\n                    if (cond_74089) {\n                        defunc_0_op_res_f_res_74099 = x_74076;\n                        defunc_0_op_res_f_res_74100 = x_74077;\n                        defunc_0_op_res_f_res_74101 = x_74078;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74102;\n                        int64_t defunc_0_op_res_f_res_f_res_74103;\n                        int64_t defunc_0_op_res_f_res_f_res_74104;\n                        \n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74102 = redout_75335;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74102 = eta_p_74065;\n                        }\n                        if (cond_t_res_74094) {\n                            defunc_",
                                    "0_op_res_f_res_f_res_74103 = redout_75334;\n                            defunc_0_op_res_f_res_f_res_74104 = redout_75336;\n                        } else {\n                            int64_t min_res_74105;\n                            int64_t tmp_74106;\n                            \n                            min_res_74105 = smin64(x_74076, redout_75334);\n                            tmp_74106 = add64(x_74078, redout_75336);\n                            defunc_0_op_res_f_res_f_res_74103 = min_res_74105;\n                            defunc_0_op_res_f_res_f_res_74104 = tmp_74106;\n                        }\n                        defunc_0_op_res_f_res_74099 = defunc_0_op_res_f_res_f_res_74103;\n                        defunc_0_op_res_f_res_74100 = defunc_0_op_res_f_res_f_res_74102;\n                        defunc_0_op_res_f_res_74101 = defunc_0_op_res_f_res_f_res_74104;\n                    }\n                    defunc_0_op_res_74096 = defunc_0_op_res_f_res_74099;\n                    defunc_0_op_res_74097 = defunc_0_op_res_f_res_74100;\n                    defunc_0_op_res_74098 = defunc_0_op_res_f_res_74101;\n                }\n                redout_tmp_76656 = defunc_0_op_res_74096;\n                redout_tmp_76657 = defunc_0_op_res_74097;\n                redout_tmp_76658 = defunc_0_op_res_74098;\n                redout_75334 = redout_tmp_76656;\n                redout_75335 = redout_tmp_76657;\n                redout_75336 = redout_tmp_76658;\n            }\n            x_74073 = redout_75334;\n            x_74074 = redout_75335;\n            x_74075 = redout_75336;\n            acc_74070 = x_74073;\n            acc_74071 = x_74074;\n            acc_74072 = x_74075;\n        } else {\n            acc_74070 = acc_74066;\n            acc_74071 = acc_74067;\n            acc_74072 = acc_74068;\n        }\n        mem_75858[(int64_t) 0] = acc_74070;\n        mem_75862[(int64_t) 0] = acc_74071;\n        mem_75866[(int64_t) 0] = acc_74072;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6", " = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76650[i_6] = mem_75858[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76651[i_7] = mem_75862[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76652[i_8] = mem_75866[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75846[i_9] = mem_param_tmp_76650[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75847[i_10] = mem_param_tmp_76651[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75848[i_11] = mem_param_tmp_76652[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75869[i_12] = mem_param_75846[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75868[i_13] = mem_param_75847[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75867[i_14] = mem_param_75848[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74142) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75885[i_15] = ext_mem_75869[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75884[i_16] = ext_mem_75867[i_16];\n    } else {\n        int64_t ltid_flat_74144;\n        int64_t ltid_74143;\n        int64_t j_74159;\n        bool cond_74163;\n        int64_t pre1d_74166;\n        int64_t pre1d_74164;\n        double pre1d_74165;\n        int64_t ltid_flat_74180;\n        int64_t ltid_74179;\n        int64_t gtid_74193;\n        int64_t acc_74195;\n        int64_t acc_74197;\n        bool cond_74198;\n        int64_t acc_74199;\n        int64_t acc_74201;\n        \n        ltid_flat_74144 = sext_i32_i64(local_tid_76641);\n        ltid_74143 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74159 = ltid_74143 + binop_x_74158;\n        cond_74163 = slt64(j_74159, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74166 = btoi_bool_i64(cond_74163);\n        if (cond_74163) {\n            int64_t tile_elem_74167;\n            int64_t", " slice_75320;\n            double tile_elem_74168;\n            \n            tile_elem_74167 = ((__global int64_t *) ext_mem_75767)[j_74159];\n            slice_75320 = tS_start_64840 + j_74159;\n            tile_elem_74168 = ((__global double *) tS_mem_75468)[slice_75320];\n            pre1d_74164 = tile_elem_74167;\n            pre1d_74165 = tile_elem_74168;\n        } else {\n            pre1d_74164 = (int64_t) 0;\n            pre1d_74165 = 0.0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74143] = pre1d_74164;\n        ((__local double *) color_76531)[ltid_74143] = pre1d_74165;\n        ((__local int64_t *) color_76530)[ltid_74143] = pre1d_74166;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74180 = sext_i32_i64(local_tid_76641);\n        ltid_74179 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74193 = binop_x_73909 + ltid_74179;\n        acc_74195 = ext_mem_75869[(int64_t) 0];\n        acc_74197 = ext_mem_75867[(int64_t) 0];\n        cond_74198 = slt64(gtid_74193, min_res_66402);\n        if (cond_74198) {\n            double eta_p_74194;\n            double acc_74196;\n            int64_t x_74202;\n            double x_74203;\n            int64_t x_74204;\n            int64_t redout_75338;\n            double redout_75339;\n            int64_t redout_75340;\n            \n            eta_p_74194 = mem_75833[(int64_t) 0];\n            acc_74196 = ext_mem_75868[(int64_t) 0];\n            redout_75338 = acc_74195;\n            redout_75339 = acc_74196;\n            redout_75340 = acc_74197;\n            for (int64_t i_75341 = 0; i_75341 < residual_input_74141; i_75341++) {\n                int64_t x_74205;\n                double x_74206;\n                bool defunc_0_neq_res_74214;\n                bool defunc_0_neq_res_74215;\n                bool cond_f_res_74216;\n                bool y_74217;\n                bool cond_74218;\n                bool defunc_0_neq_res_74219;\n                bool defunc_0_neq_res_74220;\n                bool cond_t_res_f_res_74221;\n ",
                                    "               bool y_74222;\n                bool cond_t_res_74223;\n                bool x_74224;\n                int64_t defunc_0_op_res_74225;\n                double defunc_0_op_res_74226;\n                int64_t defunc_0_op_res_74227;\n                int64_t redout_tmp_76659;\n                double redout_tmp_76660;\n                int64_t redout_tmp_76661;\n                \n                x_74205 = ((__local int64_t *) color_76532)[i_75341];\n                x_74206 = ((__local double *) color_76531)[i_75341];\n                defunc_0_neq_res_74214 = redout_75339 == eta_p_74194;\n                defunc_0_neq_res_74215 = !defunc_0_neq_res_74214;\n                cond_f_res_74216 = slt64(redout_75338, (int64_t) 0);\n                y_74217 = defunc_0_neq_res_74214 && cond_f_res_74216;\n                cond_74218 = defunc_0_neq_res_74215 || y_74217;\n                defunc_0_neq_res_74219 = x_74206 == eta_p_74194;\n                defunc_0_neq_res_74220 = !defunc_0_neq_res_74219;\n                cond_t_res_f_res_74221 = slt64(x_74205, (int64_t) 0);\n                y_74222 = defunc_0_neq_res_74219 && cond_t_res_f_res_74221;\n                cond_t_res_74223 = defunc_0_neq_res_74220 || y_74222;\n                x_74224 = cond_74218 && cond_t_res_74223;\n                if (x_74224) {\n                    defunc_0_op_res_74225 = (int64_t) -1;\n                    defunc_0_op_res_74226 = eta_p_74194;\n                    defunc_0_op_res_74227 = (int64_t) 0;\n                } else {\n                    int64_t x_74207;\n                    int64_t defunc_0_op_res_f_res_74228;\n                    double defunc_0_op_res_f_res_74229;\n                    int64_t defunc_0_op_res_f_res_74230;\n                    \n                    x_74207 = ((__local int64_t *) color_76530)[i_75341];\n                    if (cond_74218) {\n                        defunc_0_op_res_f_res_74228 = x_74205;\n                        defunc_0_op_res_f_res_74229 = x_74206;\n                        defunc_0_op_res_f_r", "es_74230 = x_74207;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74231;\n                        int64_t defunc_0_op_res_f_res_f_res_74232;\n                        int64_t defunc_0_op_res_f_res_f_res_74233;\n                        \n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74231 = redout_75339;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74231 = eta_p_74194;\n                        }\n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74232 = redout_75338;\n                            defunc_0_op_res_f_res_f_res_74233 = redout_75340;\n                        } else {\n                            int64_t min_res_74234;\n                            int64_t tmp_74235;\n                            \n                            min_res_74234 = smin64(x_74205, redout_75338);\n                            tmp_74235 = add64(x_74207, redout_75340);\n                            defunc_0_op_res_f_res_f_res_74232 = min_res_74234;\n                            defunc_0_op_res_f_res_f_res_74233 = tmp_74235;\n                        }\n                        defunc_0_op_res_f_res_74228 = defunc_0_op_res_f_res_f_res_74232;\n                        defunc_0_op_res_f_res_74229 = defunc_0_op_res_f_res_f_res_74231;\n                        defunc_0_op_res_f_res_74230 = defunc_0_op_res_f_res_f_res_74233;\n                    }\n                    defunc_0_op_res_74225 = defunc_0_op_res_f_res_74228;\n                    defunc_0_op_res_74226 = defunc_0_op_res_f_res_74229;\n                    defunc_0_op_res_74227 = defunc_0_op_res_f_res_74230;\n                }\n                redout_tmp_76659 = defunc_0_op_res_74225;\n                redout_tmp_76660 = defunc_0_op_res_74226;\n                redout_tmp_76661 = defunc_0_op_res_74227;\n                redout_75338 = redout_tmp_76659;\n                redout_753", "39 = redout_tmp_76660;\n                redout_75340 = redout_tmp_76661;\n            }\n            x_74202 = redout_75338;\n            x_74203 = redout_75339;\n            x_74204 = redout_75340;\n            acc_74199 = x_74202;\n            acc_74201 = x_74204;\n        } else {\n            acc_74199 = acc_74195;\n            acc_74201 = acc_74197;\n        }\n        mem_75879[(int64_t) 0] = acc_74199;\n        mem_75883[(int64_t) 0] = acc_74201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75885[i_17] = mem_75879[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75884[i_18] = mem_75883[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76662 = ext_mem_75885[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75887)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76662;\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76663 = ext_mem_75884[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75889)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76663;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_73901\n    #undef bytes_75849\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_74254_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_74254(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_74257, int64_t num_whole_tiles_74272, int64_t residual_input_74496, unsigned char cond_74497_bits, int64_t binop_x_74513, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75826, __global unsigned char *mem_75",
                                    "828)\n{\n    bool cond_74497 = cond_74497_bits;\n    \n    #define tile_sizze_74256 (inner_SMJ_doublezisegmap_intrablock_74254zitile_sizze_74256)\n    #define bytes_75788 (inner_SMJ_doublezisegmap_intrablock_74254zibytes_75788)\n    \n    volatile __local unsigned char *color_76535_backing_2 = &shared_mem[0];\n    const int64_t color_76535_backing_2_offset = 0 + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76534_backing_1 = &shared_mem[color_76535_backing_2_offset];\n    const int64_t color_76534_backing_1_offset = color_76535_backing_2_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76533_backing_0 = &shared_mem[color_76534_backing_1_offset];\n    const int64_t color_76533_backing_0_offset = color_76534_backing_1_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76667;\n    int32_t tblock_sizze_76670;\n    int32_t wave_sizze_76669;\n    int32_t block_id_76668;\n    int32_t global_tid_76666;\n    int64_t gid_flat_74254;\n    int64_t slice_76672;\n    int64_t ltid_pre_76671;\n    int64_t remnant_76673;\n    int64_t slice_76674;\n    int64_t gid_74253;\n    int64_t remnant_76675;\n    __local unsigned char *color_76533;\n    __local unsigned char *color_76534;\n    __local unsigned char *color_76535;\n    int64_t binop_x_74264;\n    double mem_75772[1];\n    int64_t ltid_flat_74259;\n    int64_t ltid_74258;\n    int64_t gtid_74265;\n    bool cond_74266;\n    double pre_74267;\n    int64_t mem_75776[1];\n    double mem_75780[1];\n    int64_t mem_75784[1];\n    int64_t ltid_flat_74274;\n    int64_t ltid_74273;\n    int64_t gtid_74284;\n    bool cond_74285;\n    int64_t neutral_74286;\n    double neutral_74287;\n    int64_t ext_mem_75808[1];\n    double ext_mem_75807[1];\n    int64_t ext_mem_75806[1];\n    int64_t mem_param_757", "85[1];\n    double mem_param_75786[1];\n    int64_t mem_param_75787[1];\n    int64_t mem_75818[1];\n    int64_t mem_75822[1];\n    int64_t ext_mem_75824[1];\n    int64_t ext_mem_75823[1];\n    \n    local_tid_76667 = get_local_id(0);\n    tblock_sizze_76670 = get_local_size(0);\n    wave_sizze_76669 = LOCKSTEP_WIDTH;\n    block_id_76668 = get_tblock_id(0);\n    global_tid_76666 = block_id_76668 * tblock_sizze_76670 + local_tid_76667;\n    gid_flat_74254 = sext_i32_i64(block_id_76668);\n    slice_76672 = tile_sizze_74256;\n    ltid_pre_76671 = sext_i32_i64(local_tid_76667);\n    remnant_76673 = sext_i32_i64(local_tid_76667) - ltid_pre_76671;\n    slice_76674 = ldim_74257;\n    gid_74253 = sext_i32_i64(block_id_76668);\n    remnant_76675 = sext_i32_i64(block_id_76668) - gid_74253;\n    color_76533 = (__local unsigned char *) color_76533_backing_0;\n    color_76534 = (__local unsigned char *) color_76534_backing_1;\n    color_76535 = (__local unsigned char *) color_76535_backing_2;\n    binop_x_74264 = gid_74253 * tile_sizze_74256;\n    ltid_flat_74259 = sext_i32_i64(local_tid_76667);\n    ltid_74258 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74265 = ltid_74258 + binop_x_74264;\n    cond_74266 = slt64(gtid_74265, min_res_66402);\n    if (cond_74266) {\n        int64_t slice_74268;\n        double eta_p_74269;\n        \n        slice_74268 = start_66400 + gtid_74265;\n        eta_p_74269 = ((__global double *) tR_mem_75467)[slice_74268];\n        pre_74267 = eta_p_74269;\n    } else {\n        pre_74267 = 0.0;\n    }\n    mem_75772[(int64_t) 0] = pre_74267;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74274 = sext_i32_i64(local_tid_76667);\n    ltid_74273 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74284 = binop_x_74264 + ltid_74273;\n    cond_74285 = slt64(gtid_74284, min_res_66402);\n    if (cond_74285) {\n        neutral_74286 = (int64_t) -1;\n    } else {\n        neutral_74286 = (int64_t) 0;\n    }\n    if (cond_74285) {\n        double eta_p_74289 = mem_75772[(int64_t) 0];\n        \n", "        neutral_74287 = eta_p_74289;\n    } else {\n        neutral_74287 = 0.0;\n    }\n    mem_75776[(int64_t) 0] = neutral_74286;\n    mem_75780[(int64_t) 0] = neutral_74287;\n    mem_75784[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75785[i_3] = mem_75776[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75786[i_4] = mem_75780[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75787[i_5] = mem_75784[i_5];\n    for (int64_t tile_id_74299 = 0; tile_id_74299 < num_whole_tiles_74272; tile_id_74299++) {\n        int64_t binop_x_74398;\n        int64_t ltid_flat_74397;\n        int64_t ltid_74396;\n        int64_t j_74399;\n        bool cond_74403;\n        int64_t pre1d_74406;\n        int64_t pre1d_74404;\n        double pre1d_74405;\n        int64_t mem_75797[1];\n        double mem_75801[1];\n        int64_t mem_75805[1];\n        int64_t ltid_flat_74417;\n        int64_t ltid_74416;\n        int64_t gtid_74419;\n        int64_t acc_74421;\n        double acc_74422;\n        int64_t acc_74423;\n        bool cond_74424;\n        int64_t acc_74425;\n        double acc_74426;\n        int64_t acc_74427;\n        int64_t mem_param_tmp_76676[1];\n        double mem_param_tmp_76677[1];\n        int64_t mem_param_tmp_76678[1];\n        \n        binop_x_74398 = tile_sizze_74256 * tile_id_74299;\n        ltid_flat_74397 = sext_i32_i64(local_tid_76667);\n        ltid_74396 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74399 = ltid_74396 + binop_x_74398;\n        cond_74403 = slt64(j_74399, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74406 = btoi_bool_i64(cond_74403);\n        if (cond_74403) {\n            int64_t tile_elem_74407;\n            int64_t slice_75325;\n            double tile_elem_74408;\n            \n            tile_elem_74407 = ((__global int64_t *) ext_mem_75767)[j_74399];\n            slice_75325 = tS_start_64840 + j_74399;\n  ",
                                    "          tile_elem_74408 = ((__global double *) tS_mem_75468)[slice_75325];\n            pre1d_74404 = tile_elem_74407;\n            pre1d_74405 = tile_elem_74408;\n        } else {\n            pre1d_74404 = (int64_t) 0;\n            pre1d_74405 = 0.0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74396] = pre1d_74404;\n        ((__local double *) color_76534)[ltid_74396] = pre1d_74405;\n        ((__local int64_t *) color_76533)[ltid_74396] = pre1d_74406;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74417 = sext_i32_i64(local_tid_76667);\n        ltid_74416 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74419 = binop_x_74264 + ltid_74416;\n        acc_74421 = mem_param_75785[(int64_t) 0];\n        acc_74422 = mem_param_75786[(int64_t) 0];\n        acc_74423 = mem_param_75787[(int64_t) 0];\n        cond_74424 = slt64(gtid_74419, min_res_66402);\n        if (cond_74424) {\n            double eta_p_74420;\n            int64_t x_74428;\n            double x_74429;\n            int64_t x_74430;\n            int64_t redout_75342;\n            double redout_75343;\n            int64_t redout_75344;\n            \n            eta_p_74420 = mem_75772[(int64_t) 0];\n            redout_75342 = acc_74421;\n            redout_75343 = acc_74422;\n            redout_75344 = acc_74423;\n            for (int64_t i_75345 = 0; i_75345 < tile_sizze_74256; i_75345++) {\n                int64_t x_74431;\n                double x_74432;\n                bool defunc_0_neq_res_74440;\n                bool defunc_0_neq_res_74441;\n                bool cond_f_res_74442;\n                bool y_74443;\n                bool cond_74444;\n                bool defunc_0_neq_res_74445;\n                bool defunc_0_neq_res_74446;\n                bool cond_t_res_f_res_74447;\n                bool y_74448;\n                bool cond_t_res_74449;\n                bool x_74450;\n                int64_t defunc_0_op_res_74451;\n                double defunc_0_op_res_74452;\n                int64_t defunc_0_op", "_res_74453;\n                int64_t redout_tmp_76682;\n                double redout_tmp_76683;\n                int64_t redout_tmp_76684;\n                \n                x_74431 = ((__local int64_t *) color_76535)[i_75345];\n                x_74432 = ((__local double *) color_76534)[i_75345];\n                defunc_0_neq_res_74440 = redout_75343 == eta_p_74420;\n                defunc_0_neq_res_74441 = !defunc_0_neq_res_74440;\n                cond_f_res_74442 = slt64(redout_75342, (int64_t) 0);\n                y_74443 = defunc_0_neq_res_74440 && cond_f_res_74442;\n                cond_74444 = defunc_0_neq_res_74441 || y_74443;\n                defunc_0_neq_res_74445 = x_74432 == eta_p_74420;\n                defunc_0_neq_res_74446 = !defunc_0_neq_res_74445;\n                cond_t_res_f_res_74447 = slt64(x_74431, (int64_t) 0);\n                y_74448 = defunc_0_neq_res_74445 && cond_t_res_f_res_74447;\n                cond_t_res_74449 = defunc_0_neq_res_74446 || y_74448;\n                x_74450 = cond_74444 && cond_t_res_74449;\n                if (x_74450) {\n                    defunc_0_op_res_74451 = (int64_t) -1;\n                    defunc_0_op_res_74452 = eta_p_74420;\n                    defunc_0_op_res_74453 = (int64_t) 0;\n                } else {\n                    int64_t x_74433;\n                    int64_t defunc_0_op_res_f_res_74454;\n                    double defunc_0_op_res_f_res_74455;\n                    int64_t defunc_0_op_res_f_res_74456;\n                    \n                    x_74433 = ((__local int64_t *) color_76533)[i_75345];\n                    if (cond_74444) {\n                        defunc_0_op_res_f_res_74454 = x_74431;\n                        defunc_0_op_res_f_res_74455 = x_74432;\n                        defunc_0_op_res_f_res_74456 = x_74433;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74457;\n                        int64_t defunc_0_op_res_f_res_f_res_74458;\n                        int64_t defunc_0_op_", "res_f_res_f_res_74459;\n                        \n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74457 = redout_75343;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74457 = eta_p_74420;\n                        }\n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74458 = redout_75342;\n                            defunc_0_op_res_f_res_f_res_74459 = redout_75344;\n                        } else {\n                            int64_t min_res_74460;\n                            int64_t tmp_74461;\n                            \n                            min_res_74460 = smin64(x_74431, redout_75342);\n                            tmp_74461 = add64(x_74433, redout_75344);\n                            defunc_0_op_res_f_res_f_res_74458 = min_res_74460;\n                            defunc_0_op_res_f_res_f_res_74459 = tmp_74461;\n                        }\n                        defunc_0_op_res_f_res_74454 = defunc_0_op_res_f_res_f_res_74458;\n                        defunc_0_op_res_f_res_74455 = defunc_0_op_res_f_res_f_res_74457;\n                        defunc_0_op_res_f_res_74456 = defunc_0_op_res_f_res_f_res_74459;\n                    }\n                    defunc_0_op_res_74451 = defunc_0_op_res_f_res_74454;\n                    defunc_0_op_res_74452 = defunc_0_op_res_f_res_74455;\n                    defunc_0_op_res_74453 = defunc_0_op_res_f_res_74456;\n                }\n                redout_tmp_76682 = defunc_0_op_res_74451;\n                redout_tmp_76683 = defunc_0_op_res_74452;\n                redout_tmp_76684 = defunc_0_op_res_74453;\n                redout_75342 = redout_tmp_76682;\n                redout_75343 = redout_tmp_76683;\n                redout_75344 = redout_tmp_76684;\n            }\n            x_74428 = redout_75342;\n            x_74429 = redout_75343;\n            x_74430 = redout_75344;\n            acc_74425 = x_74428;",
                                    "\n            acc_74426 = x_74429;\n            acc_74427 = x_74430;\n        } else {\n            acc_74425 = acc_74421;\n            acc_74426 = acc_74422;\n            acc_74427 = acc_74423;\n        }\n        mem_75797[(int64_t) 0] = acc_74425;\n        mem_75801[(int64_t) 0] = acc_74426;\n        mem_75805[(int64_t) 0] = acc_74427;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76676[i_6] = mem_75797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76677[i_7] = mem_75801[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76678[i_8] = mem_75805[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75785[i_9] = mem_param_tmp_76676[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75786[i_10] = mem_param_tmp_76677[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75787[i_11] = mem_param_tmp_76678[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75808[i_12] = mem_param_75785[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75807[i_13] = mem_param_75786[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75806[i_14] = mem_param_75787[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74497) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75824[i_15] = ext_mem_75808[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75823[i_16] = ext_mem_75806[i_16];\n    } else {\n        int64_t ltid_flat_74499;\n        int64_t ltid_74498;\n        int64_t j_74514;\n        bool cond_74518;\n        int64_t pre1d_74521;\n        int64_t pre1d_74519;\n        double pre1d_74520;\n        int64_t ltid_flat_74535;\n        int64_t ltid_74534;\n        int64_t gtid_74548;\n        int64_t acc_74550;\n        int64_t acc_74552;\n        bool cond_74553;\n        int64_t acc_74554;\n        int64_t acc_74556;\n ", "       \n        ltid_flat_74499 = sext_i32_i64(local_tid_76667);\n        ltid_74498 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74514 = ltid_74498 + binop_x_74513;\n        cond_74518 = slt64(j_74514, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74521 = btoi_bool_i64(cond_74518);\n        if (cond_74518) {\n            int64_t tile_elem_74522;\n            int64_t slice_75324;\n            double tile_elem_74523;\n            \n            tile_elem_74522 = ((__global int64_t *) ext_mem_75767)[j_74514];\n            slice_75324 = tS_start_64840 + j_74514;\n            tile_elem_74523 = ((__global double *) tS_mem_75468)[slice_75324];\n            pre1d_74519 = tile_elem_74522;\n            pre1d_74520 = tile_elem_74523;\n        } else {\n            pre1d_74519 = (int64_t) 0;\n            pre1d_74520 = 0.0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74498] = pre1d_74519;\n        ((__local double *) color_76534)[ltid_74498] = pre1d_74520;\n        ((__local int64_t *) color_76533)[ltid_74498] = pre1d_74521;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74535 = sext_i32_i64(local_tid_76667);\n        ltid_74534 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74548 = binop_x_74264 + ltid_74534;\n        acc_74550 = ext_mem_75808[(int64_t) 0];\n        acc_74552 = ext_mem_75806[(int64_t) 0];\n        cond_74553 = slt64(gtid_74548, min_res_66402);\n        if (cond_74553) {\n            double eta_p_74549;\n            double acc_74551;\n            int64_t x_74557;\n            double x_74558;\n            int64_t x_74559;\n            int64_t redout_75346;\n            double redout_75347;\n            int64_t redout_75348;\n            \n            eta_p_74549 = mem_75772[(int64_t) 0];\n            acc_74551 = ext_mem_75807[(int64_t) 0];\n            redout_75346 = acc_74550;\n            redout_75347 = acc_74551;\n            redout_75348 = acc_74552;\n            for (int64_t i_75349 = 0; i_75349 < residual_input_74496; i_75349++) {\n", "                int64_t x_74560;\n                double x_74561;\n                bool defunc_0_neq_res_74569;\n                bool defunc_0_neq_res_74570;\n                bool cond_f_res_74571;\n                bool y_74572;\n                bool cond_74573;\n                bool defunc_0_neq_res_74574;\n                bool defunc_0_neq_res_74575;\n                bool cond_t_res_f_res_74576;\n                bool y_74577;\n                bool cond_t_res_74578;\n                bool x_74579;\n                int64_t defunc_0_op_res_74580;\n                double defunc_0_op_res_74581;\n                int64_t defunc_0_op_res_74582;\n                int64_t redout_tmp_76685;\n                double redout_tmp_76686;\n                int64_t redout_tmp_76687;\n                \n                x_74560 = ((__local int64_t *) color_76535)[i_75349];\n                x_74561 = ((__local double *) color_76534)[i_75349];\n                defunc_0_neq_res_74569 = redout_75347 == eta_p_74549;\n                defunc_0_neq_res_74570 = !defunc_0_neq_res_74569;\n                cond_f_res_74571 = slt64(redout_75346, (int64_t) 0);\n                y_74572 = defunc_0_neq_res_74569 && cond_f_res_74571;\n                cond_74573 = defunc_0_neq_res_74570 || y_74572;\n                defunc_0_neq_res_74574 = x_74561 == eta_p_74549;\n                defunc_0_neq_res_74575 = !defunc_0_neq_res_74574;\n                cond_t_res_f_res_74576 = slt64(x_74560, (int64_t) 0);\n                y_74577 = defunc_0_neq_res_74574 && cond_t_res_f_res_74576;\n                cond_t_res_74578 = defunc_0_neq_res_74575 || y_74577;\n                x_74579 = cond_74573 && cond_t_res_74578;\n                if (x_74579) {\n                    defunc_0_op_res_74580 = (int64_t) -1;\n                    defunc_0_op_res_74581 = eta_p_74549;\n                    defunc_0_op_res_74582 = (int64_t) 0;\n                } else {\n                    int64_t x_74562;\n                    int64_t defunc_0_op_res_f_res_74583;\n                    do",
                                    "uble defunc_0_op_res_f_res_74584;\n                    int64_t defunc_0_op_res_f_res_74585;\n                    \n                    x_74562 = ((__local int64_t *) color_76533)[i_75349];\n                    if (cond_74573) {\n                        defunc_0_op_res_f_res_74583 = x_74560;\n                        defunc_0_op_res_f_res_74584 = x_74561;\n                        defunc_0_op_res_f_res_74585 = x_74562;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74586;\n                        int64_t defunc_0_op_res_f_res_f_res_74587;\n                        int64_t defunc_0_op_res_f_res_f_res_74588;\n                        \n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74586 = redout_75347;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74586 = eta_p_74549;\n                        }\n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74587 = redout_75346;\n                            defunc_0_op_res_f_res_f_res_74588 = redout_75348;\n                        } else {\n                            int64_t min_res_74589;\n                            int64_t tmp_74590;\n                            \n                            min_res_74589 = smin64(x_74560, redout_75346);\n                            tmp_74590 = add64(x_74562, redout_75348);\n                            defunc_0_op_res_f_res_f_res_74587 = min_res_74589;\n                            defunc_0_op_res_f_res_f_res_74588 = tmp_74590;\n                        }\n                        defunc_0_op_res_f_res_74583 = defunc_0_op_res_f_res_f_res_74587;\n                        defunc_0_op_res_f_res_74584 = defunc_0_op_res_f_res_f_res_74586;\n                        defunc_0_op_res_f_res_74585 = defunc_0_op_res_f_res_f_res_74588;\n                    }\n                    defunc_0_op_res_74580 = defunc_0_op_res_f_res_74583;\n                    ", "defunc_0_op_res_74581 = defunc_0_op_res_f_res_74584;\n                    defunc_0_op_res_74582 = defunc_0_op_res_f_res_74585;\n                }\n                redout_tmp_76685 = defunc_0_op_res_74580;\n                redout_tmp_76686 = defunc_0_op_res_74581;\n                redout_tmp_76687 = defunc_0_op_res_74582;\n                redout_75346 = redout_tmp_76685;\n                redout_75347 = redout_tmp_76686;\n                redout_75348 = redout_tmp_76687;\n            }\n            x_74557 = redout_75346;\n            x_74558 = redout_75347;\n            x_74559 = redout_75348;\n            acc_74554 = x_74557;\n            acc_74556 = x_74559;\n        } else {\n            acc_74554 = acc_74550;\n            acc_74556 = acc_74552;\n        }\n        mem_75818[(int64_t) 0] = acc_74554;\n        mem_75822[(int64_t) 0] = acc_74556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75824[i_17] = mem_75818[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75823[i_18] = mem_75822[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76688 = ext_mem_75824[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75826)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76688;\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76689 = ext_mem_75823[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75828)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76689;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74256\n    #undef bytes_75788\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_74609_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_74609(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int", "64_t slice_65554, int64_t slice_65911, int64_t ldim_74612, int64_t num_whole_tiles_74627, int64_t residual_input_74851, unsigned char cond_74852_bits, int64_t binop_x_74868, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75682, __global unsigned char *mem_75684)\n{\n    bool cond_74852 = cond_74852_bits;\n    \n    #define tile_sizze_74611 (inner_SMJ_doublezisegmap_intrablock_74609zitile_sizze_74611)\n    #define bytes_75644 (inner_SMJ_doublezisegmap_intrablock_74609zibytes_75644)\n    \n    volatile __local unsigned char *color_76538_backing_2 = &shared_mem[0];\n    const int64_t color_76538_backing_2_offset = 0 + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76537_backing_1 = &shared_mem[color_76538_backing_2_offset];\n    const int64_t color_76537_backing_1_offset = color_76538_backing_2_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76536_backing_0 = &shared_mem[color_76537_backing_1_offset];\n    const int64_t color_76536_backing_0_offset = color_76537_backing_1_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76808;\n    int32_t tblock_sizze_76811;\n    int32_t wave_sizze_76810;\n    int32_t block_id_76809;\n    int32_t global_tid_76807;\n    int64_t gid_flat_74609;\n    int64_t slice_76813;\n    int64_t ltid_pre_76812;\n    int64_t remnant_76814;\n    int64_t slice_76815;\n    int64_t gid_74608;\n    int64_t remnant_76816;\n    __local unsigned char *color_76536;\n    __local unsigned char *color_76537;\n    __local unsigned char *color_76538;\n    int64_t binop_x_74619;\n    double mem_75628[1];\n    int64_t ltid_flat_74614;\n    int64_t ltid_74613;\n    int64_t gtid_74620;\n    bool cond_74621;\n    double",
                                    " pre_74622;\n    int64_t mem_75632[1];\n    double mem_75636[1];\n    int64_t mem_75640[1];\n    int64_t ltid_flat_74629;\n    int64_t ltid_74628;\n    int64_t gtid_74639;\n    bool cond_74640;\n    int64_t neutral_74641;\n    double neutral_74642;\n    int64_t ext_mem_75664[1];\n    double ext_mem_75663[1];\n    int64_t ext_mem_75662[1];\n    int64_t mem_param_75641[1];\n    double mem_param_75642[1];\n    int64_t mem_param_75643[1];\n    int64_t mem_75674[1];\n    int64_t mem_75678[1];\n    int64_t ext_mem_75680[1];\n    int64_t ext_mem_75679[1];\n    \n    local_tid_76808 = get_local_id(0);\n    tblock_sizze_76811 = get_local_size(0);\n    wave_sizze_76810 = LOCKSTEP_WIDTH;\n    block_id_76809 = get_tblock_id(0);\n    global_tid_76807 = block_id_76809 * tblock_sizze_76811 + local_tid_76808;\n    gid_flat_74609 = sext_i32_i64(block_id_76809);\n    slice_76813 = tile_sizze_74611;\n    ltid_pre_76812 = sext_i32_i64(local_tid_76808);\n    remnant_76814 = sext_i32_i64(local_tid_76808) - ltid_pre_76812;\n    slice_76815 = ldim_74612;\n    gid_74608 = sext_i32_i64(block_id_76809);\n    remnant_76816 = sext_i32_i64(block_id_76809) - gid_74608;\n    color_76536 = (__local unsigned char *) color_76536_backing_0;\n    color_76537 = (__local unsigned char *) color_76537_backing_1;\n    color_76538 = (__local unsigned char *) color_76538_backing_2;\n    binop_x_74619 = gid_74608 * tile_sizze_74611;\n    ltid_flat_74614 = sext_i32_i64(local_tid_76808);\n    ltid_74613 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74620 = ltid_74613 + binop_x_74619;\n    cond_74621 = slt64(gtid_74620, min_res_65540);\n    if (cond_74621) {\n        int64_t slice_74623;\n        double eta_p_74624;\n        \n        slice_74623 = slice_65554 + gtid_74620;\n        eta_p_74624 = ((__global double *) tR_mem_75467)[slice_74623];\n        pre_74622 = eta_p_74624;\n    } else {\n        pre_74622 = 0.0;\n    }\n    mem_75628[(int64_t) 0] = pre_74622;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74629 = sext_i32_i64(local_tid_76808);\n   ", " ltid_74628 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74639 = binop_x_74619 + ltid_74628;\n    cond_74640 = slt64(gtid_74639, min_res_65540);\n    if (cond_74640) {\n        neutral_74641 = (int64_t) -1;\n    } else {\n        neutral_74641 = (int64_t) 0;\n    }\n    if (cond_74640) {\n        double eta_p_74644 = mem_75628[(int64_t) 0];\n        \n        neutral_74642 = eta_p_74644;\n    } else {\n        neutral_74642 = 0.0;\n    }\n    mem_75632[(int64_t) 0] = neutral_74641;\n    mem_75636[(int64_t) 0] = neutral_74642;\n    mem_75640[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75641[i_3] = mem_75632[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75642[i_4] = mem_75636[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75643[i_5] = mem_75640[i_5];\n    for (int64_t tile_id_74654 = 0; tile_id_74654 < num_whole_tiles_74627; tile_id_74654++) {\n        int64_t binop_x_74753;\n        int64_t ltid_flat_74752;\n        int64_t ltid_74751;\n        int64_t j_74754;\n        bool cond_74758;\n        int64_t pre1d_74761;\n        int64_t pre1d_74759;\n        double pre1d_74760;\n        int64_t mem_75653[1];\n        double mem_75657[1];\n        int64_t mem_75661[1];\n        int64_t ltid_flat_74772;\n        int64_t ltid_74771;\n        int64_t gtid_74774;\n        int64_t acc_74776;\n        double acc_74777;\n        int64_t acc_74778;\n        bool cond_74779;\n        int64_t acc_74780;\n        double acc_74781;\n        int64_t acc_74782;\n        int64_t mem_param_tmp_76817[1];\n        double mem_param_tmp_76818[1];\n        int64_t mem_param_tmp_76819[1];\n        \n        binop_x_74753 = tile_sizze_74611 * tile_id_74654;\n        ltid_flat_74752 = sext_i32_i64(local_tid_76808);\n        ltid_74751 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74754 = ltid_74751 + binop_x_74753;\n        cond_74758 = slt64(j_74754, j_m_i_65502);\n       ", " pre1d_74761 = btoi_bool_i64(cond_74758);\n        if (cond_74758) {\n            int64_t tile_elem_74762;\n            int64_t slice_75329;\n            double tile_elem_74763;\n            \n            tile_elem_74762 = ((__global int64_t *) ext_mem_75562)[j_74754];\n            slice_75329 = slice_65911 + j_74754;\n            tile_elem_74763 = ((__global double *) tS_mem_75468)[slice_75329];\n            pre1d_74759 = tile_elem_74762;\n            pre1d_74760 = tile_elem_74763;\n        } else {\n            pre1d_74759 = (int64_t) 0;\n            pre1d_74760 = 0.0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74751] = pre1d_74759;\n        ((__local double *) color_76537)[ltid_74751] = pre1d_74760;\n        ((__local int64_t *) color_76536)[ltid_74751] = pre1d_74761;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74772 = sext_i32_i64(local_tid_76808);\n        ltid_74771 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74774 = binop_x_74619 + ltid_74771;\n        acc_74776 = mem_param_75641[(int64_t) 0];\n        acc_74777 = mem_param_75642[(int64_t) 0];\n        acc_74778 = mem_param_75643[(int64_t) 0];\n        cond_74779 = slt64(gtid_74774, min_res_65540);\n        if (cond_74779) {\n            double eta_p_74775;\n            int64_t x_74783;\n            double x_74784;\n            int64_t x_74785;\n            int64_t redout_75350;\n            double redout_75351;\n            int64_t redout_75352;\n            \n            eta_p_74775 = mem_75628[(int64_t) 0];\n            redout_75350 = acc_74776;\n            redout_75351 = acc_74777;\n            redout_75352 = acc_74778;\n            for (int64_t i_75353 = 0; i_75353 < tile_sizze_74611; i_75353++) {\n                int64_t x_74786;\n                double x_74787;\n                bool defunc_0_neq_res_74795;\n                bool defunc_0_neq_res_74796;\n                bool cond_f_res_74797;\n                bool y_74798;\n                bool cond_74799;\n                bool defunc_0_neq_res_74800;\n  ",
                                    "              bool defunc_0_neq_res_74801;\n                bool cond_t_res_f_res_74802;\n                bool y_74803;\n                bool cond_t_res_74804;\n                bool x_74805;\n                int64_t defunc_0_op_res_74806;\n                double defunc_0_op_res_74807;\n                int64_t defunc_0_op_res_74808;\n                int64_t redout_tmp_76823;\n                double redout_tmp_76824;\n                int64_t redout_tmp_76825;\n                \n                x_74786 = ((__local int64_t *) color_76538)[i_75353];\n                x_74787 = ((__local double *) color_76537)[i_75353];\n                defunc_0_neq_res_74795 = redout_75351 == eta_p_74775;\n                defunc_0_neq_res_74796 = !defunc_0_neq_res_74795;\n                cond_f_res_74797 = slt64(redout_75350, (int64_t) 0);\n                y_74798 = defunc_0_neq_res_74795 && cond_f_res_74797;\n                cond_74799 = defunc_0_neq_res_74796 || y_74798;\n                defunc_0_neq_res_74800 = x_74787 == eta_p_74775;\n                defunc_0_neq_res_74801 = !defunc_0_neq_res_74800;\n                cond_t_res_f_res_74802 = slt64(x_74786, (int64_t) 0);\n                y_74803 = defunc_0_neq_res_74800 && cond_t_res_f_res_74802;\n                cond_t_res_74804 = defunc_0_neq_res_74801 || y_74803;\n                x_74805 = cond_74799 && cond_t_res_74804;\n                if (x_74805) {\n                    defunc_0_op_res_74806 = (int64_t) -1;\n                    defunc_0_op_res_74807 = eta_p_74775;\n                    defunc_0_op_res_74808 = (int64_t) 0;\n                } else {\n                    int64_t x_74788;\n                    int64_t defunc_0_op_res_f_res_74809;\n                    double defunc_0_op_res_f_res_74810;\n                    int64_t defunc_0_op_res_f_res_74811;\n                    \n                    x_74788 = ((__local int64_t *) color_76536)[i_75353];\n                    if (cond_74799) {\n                        defunc_0_op_res_f_res_74809 = x_74786;\n                 ", "       defunc_0_op_res_f_res_74810 = x_74787;\n                        defunc_0_op_res_f_res_74811 = x_74788;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74812;\n                        int64_t defunc_0_op_res_f_res_f_res_74813;\n                        int64_t defunc_0_op_res_f_res_f_res_74814;\n                        \n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74812 = redout_75351;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74812 = eta_p_74775;\n                        }\n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74813 = redout_75350;\n                            defunc_0_op_res_f_res_f_res_74814 = redout_75352;\n                        } else {\n                            int64_t min_res_74815;\n                            int64_t tmp_74816;\n                            \n                            min_res_74815 = smin64(x_74786, redout_75350);\n                            tmp_74816 = add64(x_74788, redout_75352);\n                            defunc_0_op_res_f_res_f_res_74813 = min_res_74815;\n                            defunc_0_op_res_f_res_f_res_74814 = tmp_74816;\n                        }\n                        defunc_0_op_res_f_res_74809 = defunc_0_op_res_f_res_f_res_74813;\n                        defunc_0_op_res_f_res_74810 = defunc_0_op_res_f_res_f_res_74812;\n                        defunc_0_op_res_f_res_74811 = defunc_0_op_res_f_res_f_res_74814;\n                    }\n                    defunc_0_op_res_74806 = defunc_0_op_res_f_res_74809;\n                    defunc_0_op_res_74807 = defunc_0_op_res_f_res_74810;\n                    defunc_0_op_res_74808 = defunc_0_op_res_f_res_74811;\n                }\n                redout_tmp_76823 = defunc_0_op_res_74806;\n                redout_tmp_76824 = defunc_0_op_res_74807;\n                redout_tmp_76825 = defunc_0_", "op_res_74808;\n                redout_75350 = redout_tmp_76823;\n                redout_75351 = redout_tmp_76824;\n                redout_75352 = redout_tmp_76825;\n            }\n            x_74783 = redout_75350;\n            x_74784 = redout_75351;\n            x_74785 = redout_75352;\n            acc_74780 = x_74783;\n            acc_74781 = x_74784;\n            acc_74782 = x_74785;\n        } else {\n            acc_74780 = acc_74776;\n            acc_74781 = acc_74777;\n            acc_74782 = acc_74778;\n        }\n        mem_75653[(int64_t) 0] = acc_74780;\n        mem_75657[(int64_t) 0] = acc_74781;\n        mem_75661[(int64_t) 0] = acc_74782;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76817[i_6] = mem_75653[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76818[i_7] = mem_75657[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76819[i_8] = mem_75661[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75641[i_9] = mem_param_tmp_76817[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75642[i_10] = mem_param_tmp_76818[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75643[i_11] = mem_param_tmp_76819[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75664[i_12] = mem_param_75641[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75663[i_13] = mem_param_75642[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75662[i_14] = mem_param_75643[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74852) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75680[i_15] = ext_mem_75664[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75679[i_16] = ext_mem_75662[i_16];\n    } else {\n        int64_t ltid_flat_74854;\n        int64_t ltid_74853;\n        int64_t j_74869;\n        bool cond_7",
                                    "4873;\n        int64_t pre1d_74876;\n        int64_t pre1d_74874;\n        double pre1d_74875;\n        int64_t ltid_flat_74890;\n        int64_t ltid_74889;\n        int64_t gtid_74903;\n        int64_t acc_74905;\n        int64_t acc_74907;\n        bool cond_74908;\n        int64_t acc_74909;\n        int64_t acc_74911;\n        \n        ltid_flat_74854 = sext_i32_i64(local_tid_76808);\n        ltid_74853 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74869 = ltid_74853 + binop_x_74868;\n        cond_74873 = slt64(j_74869, j_m_i_65502);\n        pre1d_74876 = btoi_bool_i64(cond_74873);\n        if (cond_74873) {\n            int64_t tile_elem_74877;\n            int64_t slice_75328;\n            double tile_elem_74878;\n            \n            tile_elem_74877 = ((__global int64_t *) ext_mem_75562)[j_74869];\n            slice_75328 = slice_65911 + j_74869;\n            tile_elem_74878 = ((__global double *) tS_mem_75468)[slice_75328];\n            pre1d_74874 = tile_elem_74877;\n            pre1d_74875 = tile_elem_74878;\n        } else {\n            pre1d_74874 = (int64_t) 0;\n            pre1d_74875 = 0.0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74853] = pre1d_74874;\n        ((__local double *) color_76537)[ltid_74853] = pre1d_74875;\n        ((__local int64_t *) color_76536)[ltid_74853] = pre1d_74876;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74890 = sext_i32_i64(local_tid_76808);\n        ltid_74889 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74903 = binop_x_74619 + ltid_74889;\n        acc_74905 = ext_mem_75664[(int64_t) 0];\n        acc_74907 = ext_mem_75662[(int64_t) 0];\n        cond_74908 = slt64(gtid_74903, min_res_65540);\n        if (cond_74908) {\n            double eta_p_74904;\n            double acc_74906;\n            int64_t x_74912;\n            double x_74913;\n            int64_t x_74914;\n            int64_t redout_75354;\n            double redout_75355;\n            int64_t redout_75356;\n            \n            eta_p_74904", " = mem_75628[(int64_t) 0];\n            acc_74906 = ext_mem_75663[(int64_t) 0];\n            redout_75354 = acc_74905;\n            redout_75355 = acc_74906;\n            redout_75356 = acc_74907;\n            for (int64_t i_75357 = 0; i_75357 < residual_input_74851; i_75357++) {\n                int64_t x_74915;\n                double x_74916;\n                bool defunc_0_neq_res_74924;\n                bool defunc_0_neq_res_74925;\n                bool cond_f_res_74926;\n                bool y_74927;\n                bool cond_74928;\n                bool defunc_0_neq_res_74929;\n                bool defunc_0_neq_res_74930;\n                bool cond_t_res_f_res_74931;\n                bool y_74932;\n                bool cond_t_res_74933;\n                bool x_74934;\n                int64_t defunc_0_op_res_74935;\n                double defunc_0_op_res_74936;\n                int64_t defunc_0_op_res_74937;\n                int64_t redout_tmp_76826;\n                double redout_tmp_76827;\n                int64_t redout_tmp_76828;\n                \n                x_74915 = ((__local int64_t *) color_76538)[i_75357];\n                x_74916 = ((__local double *) color_76537)[i_75357];\n                defunc_0_neq_res_74924 = redout_75355 == eta_p_74904;\n                defunc_0_neq_res_74925 = !defunc_0_neq_res_74924;\n                cond_f_res_74926 = slt64(redout_75354, (int64_t) 0);\n                y_74927 = defunc_0_neq_res_74924 && cond_f_res_74926;\n                cond_74928 = defunc_0_neq_res_74925 || y_74927;\n                defunc_0_neq_res_74929 = x_74916 == eta_p_74904;\n                defunc_0_neq_res_74930 = !defunc_0_neq_res_74929;\n                cond_t_res_f_res_74931 = slt64(x_74915, (int64_t) 0);\n                y_74932 = defunc_0_neq_res_74929 && cond_t_res_f_res_74931;\n                cond_t_res_74933 = defunc_0_neq_res_74930 || y_74932;\n                x_74934 = cond_74928 && cond_t_res_74933;\n                if (x_74934) {\n                    defunc_0_op_res_7", "4935 = (int64_t) -1;\n                    defunc_0_op_res_74936 = eta_p_74904;\n                    defunc_0_op_res_74937 = (int64_t) 0;\n                } else {\n                    int64_t x_74917;\n                    int64_t defunc_0_op_res_f_res_74938;\n                    double defunc_0_op_res_f_res_74939;\n                    int64_t defunc_0_op_res_f_res_74940;\n                    \n                    x_74917 = ((__local int64_t *) color_76536)[i_75357];\n                    if (cond_74928) {\n                        defunc_0_op_res_f_res_74938 = x_74915;\n                        defunc_0_op_res_f_res_74939 = x_74916;\n                        defunc_0_op_res_f_res_74940 = x_74917;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_74941;\n                        int64_t defunc_0_op_res_f_res_f_res_74942;\n                        int64_t defunc_0_op_res_f_res_f_res_74943;\n                        \n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74941 = redout_75355;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74941 = eta_p_74904;\n                        }\n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74942 = redout_75354;\n                            defunc_0_op_res_f_res_f_res_74943 = redout_75356;\n                        } else {\n                            int64_t min_res_74944;\n                            int64_t tmp_74945;\n                            \n                            min_res_74944 = smin64(x_74915, redout_75354);\n                            tmp_74945 = add64(x_74917, redout_75356);\n                            defunc_0_op_res_f_res_f_res_74942 = min_res_74944;\n                            defunc_0_op_res_f_res_f_res_74943 = tmp_74945;\n                        }\n                        defunc_0_op_res_f_res_74938 = defunc_0_op_res_f_res_f_res_74942;\n                 ",
                                    "       defunc_0_op_res_f_res_74939 = defunc_0_op_res_f_res_f_res_74941;\n                        defunc_0_op_res_f_res_74940 = defunc_0_op_res_f_res_f_res_74943;\n                    }\n                    defunc_0_op_res_74935 = defunc_0_op_res_f_res_74938;\n                    defunc_0_op_res_74936 = defunc_0_op_res_f_res_74939;\n                    defunc_0_op_res_74937 = defunc_0_op_res_f_res_74940;\n                }\n                redout_tmp_76826 = defunc_0_op_res_74935;\n                redout_tmp_76827 = defunc_0_op_res_74936;\n                redout_tmp_76828 = defunc_0_op_res_74937;\n                redout_75354 = redout_tmp_76826;\n                redout_75355 = redout_tmp_76827;\n                redout_75356 = redout_tmp_76828;\n            }\n            x_74912 = redout_75354;\n            x_74913 = redout_75355;\n            x_74914 = redout_75356;\n            acc_74909 = x_74912;\n            acc_74911 = x_74914;\n        } else {\n            acc_74909 = acc_74905;\n            acc_74911 = acc_74907;\n        }\n        mem_75674[(int64_t) 0] = acc_74909;\n        mem_75678[(int64_t) 0] = acc_74911;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75680[i_17] = mem_75674[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75679[i_18] = mem_75678[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76829 = ext_mem_75680[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75682)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76829;\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76830 = ext_mem_75679[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75684)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76830;\n    }\n    ", "\n  error_8:\n    return;\n    #undef tile_sizze_74611\n    #undef bytes_75644\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegmap_intrablock_74964_dim1, 1, 1)\nvoid inner_SMJ_doublezisegmap_intrablock_74964(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74967, int64_t num_whole_tiles_74982, int64_t residual_input_75206, unsigned char cond_75207_bits, int64_t binop_x_75223, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75621, __global unsigned char *mem_75623)\n{\n    bool cond_75207 = cond_75207_bits;\n    \n    #define tile_sizze_74966 (inner_SMJ_doublezisegmap_intrablock_74964zitile_sizze_74966)\n    #define bytes_75583 (inner_SMJ_doublezisegmap_intrablock_74964zibytes_75583)\n    \n    volatile __local unsigned char *color_76541_backing_2 = &shared_mem[0];\n    const int64_t color_76541_backing_2_offset = 0 + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76540_backing_1 = &shared_mem[color_76541_backing_2_offset];\n    const int64_t color_76540_backing_1_offset = color_76541_backing_2_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76539_backing_0 = &shared_mem[color_76540_backing_1_offset];\n    const int64_t color_76539_backing_0_offset = color_76540_backing_1_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76834;\n    int32_t tblock_sizze_76837;\n    int32_t wave_sizze_76836;\n    int32_t block_id_76835;\n    int32_t global_tid_76833;\n    int64_t gid_flat_74964;\n    int64_t slice_76839;\n    int64_t ltid_pre_76838;\n    int64_t remnant_76840;\n    int64_t slice_76841;\n    int64_t gid_74963;\n    int64_t remnant_76842;\n    ", "__local unsigned char *color_76539;\n    __local unsigned char *color_76540;\n    __local unsigned char *color_76541;\n    int64_t binop_x_74974;\n    double mem_75567[1];\n    int64_t ltid_flat_74969;\n    int64_t ltid_74968;\n    int64_t gtid_74975;\n    bool cond_74976;\n    double pre_74977;\n    int64_t mem_75571[1];\n    double mem_75575[1];\n    int64_t mem_75579[1];\n    int64_t ltid_flat_74984;\n    int64_t ltid_74983;\n    int64_t gtid_74994;\n    bool cond_74995;\n    int64_t neutral_74996;\n    double neutral_74997;\n    int64_t ext_mem_75603[1];\n    double ext_mem_75602[1];\n    int64_t ext_mem_75601[1];\n    int64_t mem_param_75580[1];\n    double mem_param_75581[1];\n    int64_t mem_param_75582[1];\n    int64_t mem_75613[1];\n    int64_t mem_75617[1];\n    int64_t ext_mem_75619[1];\n    int64_t ext_mem_75618[1];\n    \n    local_tid_76834 = get_local_id(0);\n    tblock_sizze_76837 = get_local_size(0);\n    wave_sizze_76836 = LOCKSTEP_WIDTH;\n    block_id_76835 = get_tblock_id(0);\n    global_tid_76833 = block_id_76835 * tblock_sizze_76837 + local_tid_76834;\n    gid_flat_74964 = sext_i32_i64(block_id_76835);\n    slice_76839 = tile_sizze_74966;\n    ltid_pre_76838 = sext_i32_i64(local_tid_76834);\n    remnant_76840 = sext_i32_i64(local_tid_76834) - ltid_pre_76838;\n    slice_76841 = ldim_74967;\n    gid_74963 = sext_i32_i64(block_id_76835);\n    remnant_76842 = sext_i32_i64(block_id_76835) - gid_74963;\n    color_76539 = (__local unsigned char *) color_76539_backing_0;\n    color_76540 = (__local unsigned char *) color_76540_backing_1;\n    color_76541 = (__local unsigned char *) color_76541_backing_2;\n    binop_x_74974 = gid_74963 * tile_sizze_74966;\n    ltid_flat_74969 = sext_i32_i64(local_tid_76834);\n    ltid_74968 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74975 = ltid_74968 + binop_x_74974;\n    cond_74976 = slt64(gtid_74975, min_res_65540);\n    if (cond_74976) {\n        int64_t slice_74978;\n        double eta_p_74979;\n        \n        slice_74978 = slice_65554 + gtid_74975;\n  ",
                                    "      eta_p_74979 = ((__global double *) tR_mem_75467)[slice_74978];\n        pre_74977 = eta_p_74979;\n    } else {\n        pre_74977 = 0.0;\n    }\n    mem_75567[(int64_t) 0] = pre_74977;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74984 = sext_i32_i64(local_tid_76834);\n    ltid_74983 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74994 = binop_x_74974 + ltid_74983;\n    cond_74995 = slt64(gtid_74994, min_res_65540);\n    if (cond_74995) {\n        neutral_74996 = (int64_t) -1;\n    } else {\n        neutral_74996 = (int64_t) 0;\n    }\n    if (cond_74995) {\n        double eta_p_74999 = mem_75567[(int64_t) 0];\n        \n        neutral_74997 = eta_p_74999;\n    } else {\n        neutral_74997 = 0.0;\n    }\n    mem_75571[(int64_t) 0] = neutral_74996;\n    mem_75575[(int64_t) 0] = neutral_74997;\n    mem_75579[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75580[i_3] = mem_75571[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75581[i_4] = mem_75575[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75582[i_5] = mem_75579[i_5];\n    for (int64_t tile_id_75009 = 0; tile_id_75009 < num_whole_tiles_74982; tile_id_75009++) {\n        int64_t binop_x_75108;\n        int64_t ltid_flat_75107;\n        int64_t ltid_75106;\n        int64_t j_75109;\n        bool cond_75113;\n        int64_t pre1d_75116;\n        int64_t pre1d_75114;\n        double pre1d_75115;\n        int64_t mem_75592[1];\n        double mem_75596[1];\n        int64_t mem_75600[1];\n        int64_t ltid_flat_75127;\n        int64_t ltid_75126;\n        int64_t gtid_75129;\n        int64_t acc_75131;\n        double acc_75132;\n        int64_t acc_75133;\n        bool cond_75134;\n        int64_t acc_75135;\n        double acc_75136;\n        int64_t acc_75137;\n        int64_t mem_param_tmp_76843[1];\n        double mem_param_tmp_76844[1];\n        int64_t mem_param_tmp_76845[1];\n        \n       ", " binop_x_75108 = tile_sizze_74966 * tile_id_75009;\n        ltid_flat_75107 = sext_i32_i64(local_tid_76834);\n        ltid_75106 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75109 = ltid_75106 + binop_x_75108;\n        cond_75113 = slt64(j_75109, j_m_i_65502);\n        pre1d_75116 = btoi_bool_i64(cond_75113);\n        if (cond_75113) {\n            int64_t tile_elem_75117;\n            int64_t slice_75333;\n            double tile_elem_75118;\n            \n            tile_elem_75117 = ((__global int64_t *) ext_mem_75562)[j_75109];\n            slice_75333 = slice_65911 + j_75109;\n            tile_elem_75118 = ((__global double *) tS_mem_75468)[slice_75333];\n            pre1d_75114 = tile_elem_75117;\n            pre1d_75115 = tile_elem_75118;\n        } else {\n            pre1d_75114 = (int64_t) 0;\n            pre1d_75115 = 0.0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75106] = pre1d_75114;\n        ((__local double *) color_76540)[ltid_75106] = pre1d_75115;\n        ((__local int64_t *) color_76539)[ltid_75106] = pre1d_75116;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75127 = sext_i32_i64(local_tid_76834);\n        ltid_75126 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75129 = binop_x_74974 + ltid_75126;\n        acc_75131 = mem_param_75580[(int64_t) 0];\n        acc_75132 = mem_param_75581[(int64_t) 0];\n        acc_75133 = mem_param_75582[(int64_t) 0];\n        cond_75134 = slt64(gtid_75129, min_res_65540);\n        if (cond_75134) {\n            double eta_p_75130;\n            int64_t x_75138;\n            double x_75139;\n            int64_t x_75140;\n            int64_t redout_75358;\n            double redout_75359;\n            int64_t redout_75360;\n            \n            eta_p_75130 = mem_75567[(int64_t) 0];\n            redout_75358 = acc_75131;\n            redout_75359 = acc_75132;\n            redout_75360 = acc_75133;\n            for (int64_t i_75361 = 0; i_75361 < tile_sizze_74966; i_75361++) {\n                int64_t x_75", "141;\n                double x_75142;\n                bool defunc_0_neq_res_75150;\n                bool defunc_0_neq_res_75151;\n                bool cond_f_res_75152;\n                bool y_75153;\n                bool cond_75154;\n                bool defunc_0_neq_res_75155;\n                bool defunc_0_neq_res_75156;\n                bool cond_t_res_f_res_75157;\n                bool y_75158;\n                bool cond_t_res_75159;\n                bool x_75160;\n                int64_t defunc_0_op_res_75161;\n                double defunc_0_op_res_75162;\n                int64_t defunc_0_op_res_75163;\n                int64_t redout_tmp_76849;\n                double redout_tmp_76850;\n                int64_t redout_tmp_76851;\n                \n                x_75141 = ((__local int64_t *) color_76541)[i_75361];\n                x_75142 = ((__local double *) color_76540)[i_75361];\n                defunc_0_neq_res_75150 = redout_75359 == eta_p_75130;\n                defunc_0_neq_res_75151 = !defunc_0_neq_res_75150;\n                cond_f_res_75152 = slt64(redout_75358, (int64_t) 0);\n                y_75153 = defunc_0_neq_res_75150 && cond_f_res_75152;\n                cond_75154 = defunc_0_neq_res_75151 || y_75153;\n                defunc_0_neq_res_75155 = x_75142 == eta_p_75130;\n                defunc_0_neq_res_75156 = !defunc_0_neq_res_75155;\n                cond_t_res_f_res_75157 = slt64(x_75141, (int64_t) 0);\n                y_75158 = defunc_0_neq_res_75155 && cond_t_res_f_res_75157;\n                cond_t_res_75159 = defunc_0_neq_res_75156 || y_75158;\n                x_75160 = cond_75154 && cond_t_res_75159;\n                if (x_75160) {\n                    defunc_0_op_res_75161 = (int64_t) -1;\n                    defunc_0_op_res_75162 = eta_p_75130;\n                    defunc_0_op_res_75163 = (int64_t) 0;\n                } else {\n                    int64_t x_75143;\n                    int64_t defunc_0_op_res_f_res_75164;\n                    double defunc_0_op_res_f_res_7",
                                    "5165;\n                    int64_t defunc_0_op_res_f_res_75166;\n                    \n                    x_75143 = ((__local int64_t *) color_76539)[i_75361];\n                    if (cond_75154) {\n                        defunc_0_op_res_f_res_75164 = x_75141;\n                        defunc_0_op_res_f_res_75165 = x_75142;\n                        defunc_0_op_res_f_res_75166 = x_75143;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_75167;\n                        int64_t defunc_0_op_res_f_res_f_res_75168;\n                        int64_t defunc_0_op_res_f_res_f_res_75169;\n                        \n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75167 = redout_75359;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75167 = eta_p_75130;\n                        }\n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75168 = redout_75358;\n                            defunc_0_op_res_f_res_f_res_75169 = redout_75360;\n                        } else {\n                            int64_t min_res_75170;\n                            int64_t tmp_75171;\n                            \n                            min_res_75170 = smin64(x_75141, redout_75358);\n                            tmp_75171 = add64(x_75143, redout_75360);\n                            defunc_0_op_res_f_res_f_res_75168 = min_res_75170;\n                            defunc_0_op_res_f_res_f_res_75169 = tmp_75171;\n                        }\n                        defunc_0_op_res_f_res_75164 = defunc_0_op_res_f_res_f_res_75168;\n                        defunc_0_op_res_f_res_75165 = defunc_0_op_res_f_res_f_res_75167;\n                        defunc_0_op_res_f_res_75166 = defunc_0_op_res_f_res_f_res_75169;\n                    }\n                    defunc_0_op_res_75161 = defunc_0_op_res_f_res_75164;\n                    defunc_0_op_res_75162 = defu", "nc_0_op_res_f_res_75165;\n                    defunc_0_op_res_75163 = defunc_0_op_res_f_res_75166;\n                }\n                redout_tmp_76849 = defunc_0_op_res_75161;\n                redout_tmp_76850 = defunc_0_op_res_75162;\n                redout_tmp_76851 = defunc_0_op_res_75163;\n                redout_75358 = redout_tmp_76849;\n                redout_75359 = redout_tmp_76850;\n                redout_75360 = redout_tmp_76851;\n            }\n            x_75138 = redout_75358;\n            x_75139 = redout_75359;\n            x_75140 = redout_75360;\n            acc_75135 = x_75138;\n            acc_75136 = x_75139;\n            acc_75137 = x_75140;\n        } else {\n            acc_75135 = acc_75131;\n            acc_75136 = acc_75132;\n            acc_75137 = acc_75133;\n        }\n        mem_75592[(int64_t) 0] = acc_75135;\n        mem_75596[(int64_t) 0] = acc_75136;\n        mem_75600[(int64_t) 0] = acc_75137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76843[i_6] = mem_75592[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76844[i_7] = mem_75596[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76845[i_8] = mem_75600[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75580[i_9] = mem_param_tmp_76843[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75581[i_10] = mem_param_tmp_76844[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75582[i_11] = mem_param_tmp_76845[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75603[i_12] = mem_param_75580[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75602[i_13] = mem_param_75581[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75601[i_14] = mem_param_75582[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_75207) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n ", "           ext_mem_75619[i_15] = ext_mem_75603[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75618[i_16] = ext_mem_75601[i_16];\n    } else {\n        int64_t ltid_flat_75209;\n        int64_t ltid_75208;\n        int64_t j_75224;\n        bool cond_75228;\n        int64_t pre1d_75231;\n        int64_t pre1d_75229;\n        double pre1d_75230;\n        int64_t ltid_flat_75245;\n        int64_t ltid_75244;\n        int64_t gtid_75258;\n        int64_t acc_75260;\n        int64_t acc_75262;\n        bool cond_75263;\n        int64_t acc_75264;\n        int64_t acc_75266;\n        \n        ltid_flat_75209 = sext_i32_i64(local_tid_76834);\n        ltid_75208 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75224 = ltid_75208 + binop_x_75223;\n        cond_75228 = slt64(j_75224, j_m_i_65502);\n        pre1d_75231 = btoi_bool_i64(cond_75228);\n        if (cond_75228) {\n            int64_t tile_elem_75232;\n            int64_t slice_75332;\n            double tile_elem_75233;\n            \n            tile_elem_75232 = ((__global int64_t *) ext_mem_75562)[j_75224];\n            slice_75332 = slice_65911 + j_75224;\n            tile_elem_75233 = ((__global double *) tS_mem_75468)[slice_75332];\n            pre1d_75229 = tile_elem_75232;\n            pre1d_75230 = tile_elem_75233;\n        } else {\n            pre1d_75229 = (int64_t) 0;\n            pre1d_75230 = 0.0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75208] = pre1d_75229;\n        ((__local double *) color_76540)[ltid_75208] = pre1d_75230;\n        ((__local int64_t *) color_76539)[ltid_75208] = pre1d_75231;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75245 = sext_i32_i64(local_tid_76834);\n        ltid_75244 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75258 = binop_x_74974 + ltid_75244;\n        acc_75260 = ext_mem_75603[(int64_t) 0];\n        acc_75262 = ext_mem_75601[(int64_t) 0];\n        cond_75263 = slt64(gtid_75258, min_res_65540);\n        if (cond_75263) {\n         ",
                                    "   double eta_p_75259;\n            double acc_75261;\n            int64_t x_75267;\n            double x_75268;\n            int64_t x_75269;\n            int64_t redout_75362;\n            double redout_75363;\n            int64_t redout_75364;\n            \n            eta_p_75259 = mem_75567[(int64_t) 0];\n            acc_75261 = ext_mem_75602[(int64_t) 0];\n            redout_75362 = acc_75260;\n            redout_75363 = acc_75261;\n            redout_75364 = acc_75262;\n            for (int64_t i_75365 = 0; i_75365 < residual_input_75206; i_75365++) {\n                int64_t x_75270;\n                double x_75271;\n                bool defunc_0_neq_res_75279;\n                bool defunc_0_neq_res_75280;\n                bool cond_f_res_75281;\n                bool y_75282;\n                bool cond_75283;\n                bool defunc_0_neq_res_75284;\n                bool defunc_0_neq_res_75285;\n                bool cond_t_res_f_res_75286;\n                bool y_75287;\n                bool cond_t_res_75288;\n                bool x_75289;\n                int64_t defunc_0_op_res_75290;\n                double defunc_0_op_res_75291;\n                int64_t defunc_0_op_res_75292;\n                int64_t redout_tmp_76852;\n                double redout_tmp_76853;\n                int64_t redout_tmp_76854;\n                \n                x_75270 = ((__local int64_t *) color_76541)[i_75365];\n                x_75271 = ((__local double *) color_76540)[i_75365];\n                defunc_0_neq_res_75279 = redout_75363 == eta_p_75259;\n                defunc_0_neq_res_75280 = !defunc_0_neq_res_75279;\n                cond_f_res_75281 = slt64(redout_75362, (int64_t) 0);\n                y_75282 = defunc_0_neq_res_75279 && cond_f_res_75281;\n                cond_75283 = defunc_0_neq_res_75280 || y_75282;\n                defunc_0_neq_res_75284 = x_75271 == eta_p_75259;\n                defunc_0_neq_res_75285 = !defunc_0_neq_res_75284;\n                cond_t_res_f_res_75286 = slt64(x_75270, (int64_t) ", "0);\n                y_75287 = defunc_0_neq_res_75284 && cond_t_res_f_res_75286;\n                cond_t_res_75288 = defunc_0_neq_res_75285 || y_75287;\n                x_75289 = cond_75283 && cond_t_res_75288;\n                if (x_75289) {\n                    defunc_0_op_res_75290 = (int64_t) -1;\n                    defunc_0_op_res_75291 = eta_p_75259;\n                    defunc_0_op_res_75292 = (int64_t) 0;\n                } else {\n                    int64_t x_75272;\n                    int64_t defunc_0_op_res_f_res_75293;\n                    double defunc_0_op_res_f_res_75294;\n                    int64_t defunc_0_op_res_f_res_75295;\n                    \n                    x_75272 = ((__local int64_t *) color_76539)[i_75365];\n                    if (cond_75283) {\n                        defunc_0_op_res_f_res_75293 = x_75270;\n                        defunc_0_op_res_f_res_75294 = x_75271;\n                        defunc_0_op_res_f_res_75295 = x_75272;\n                    } else {\n                        double defunc_0_op_res_f_res_f_res_75296;\n                        int64_t defunc_0_op_res_f_res_f_res_75297;\n                        int64_t defunc_0_op_res_f_res_f_res_75298;\n                        \n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75296 = redout_75363;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75296 = eta_p_75259;\n                        }\n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75297 = redout_75362;\n                            defunc_0_op_res_f_res_f_res_75298 = redout_75364;\n                        } else {\n                            int64_t min_res_75299;\n                            int64_t tmp_75300;\n                            \n                            min_res_75299 = smin64(x_75270, redout_75362);\n                            tmp_75300 = add64(x_75272, redout_75364);\n          ", "                  defunc_0_op_res_f_res_f_res_75297 = min_res_75299;\n                            defunc_0_op_res_f_res_f_res_75298 = tmp_75300;\n                        }\n                        defunc_0_op_res_f_res_75293 = defunc_0_op_res_f_res_f_res_75297;\n                        defunc_0_op_res_f_res_75294 = defunc_0_op_res_f_res_f_res_75296;\n                        defunc_0_op_res_f_res_75295 = defunc_0_op_res_f_res_f_res_75298;\n                    }\n                    defunc_0_op_res_75290 = defunc_0_op_res_f_res_75293;\n                    defunc_0_op_res_75291 = defunc_0_op_res_f_res_75294;\n                    defunc_0_op_res_75292 = defunc_0_op_res_f_res_75295;\n                }\n                redout_tmp_76852 = defunc_0_op_res_75290;\n                redout_tmp_76853 = defunc_0_op_res_75291;\n                redout_tmp_76854 = defunc_0_op_res_75292;\n                redout_75362 = redout_tmp_76852;\n                redout_75363 = redout_tmp_76853;\n                redout_75364 = redout_tmp_76854;\n            }\n            x_75267 = redout_75362;\n            x_75268 = redout_75363;\n            x_75269 = redout_75364;\n            acc_75264 = x_75267;\n            acc_75266 = x_75269;\n        } else {\n            acc_75264 = acc_75260;\n            acc_75266 = acc_75262;\n        }\n        mem_75613[(int64_t) 0] = acc_75264;\n        mem_75617[(int64_t) 0] = acc_75266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75619[i_17] = mem_75613[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75618[i_18] = mem_75617[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76855 = ext_mem_75619[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75621)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76855;\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + t",
                                    "ile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76856 = ext_mem_75618[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75623)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76856;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74966\n    #undef bytes_75583\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegscan_73807_dim1, 1, 1)\nvoid inner_SMJ_doublezisegscan_73807(__global int *global_failure, int64_t nR_57224, int64_t num_tblocks_73804, int64_t num_virt_blocks_76924, int64_t num_virt_threads_76925, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *status_flags_mem_76926, __global unsigned char *aggregates_mem_76948, __global unsigned char *incprefixes_mem_76950, __global unsigned char *global_dynid_mem_76952)\n{\n    #define segscan_tblock_sizze_73802 (inner_SMJ_doublezisegscan_73807zisegscan_tblock_sizze_73802)\n    #define chunk_sizze_76923 (inner_SMJ_doublezisegscan_73807zichunk_sizze_76923)\n    \n    volatile __local unsigned char *local_mem_76982_backing_0 = &shared_mem[0];\n    const int64_t local_mem_76982_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73802), chunk_sizze_76923 * segscan_tblock_sizze_73802 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73802), chunk_sizze_76923 * segscan_tblock_sizze_73802 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76975;\n    int32_t tblock_sizze_76978;\n    int32_t wave_sizze_76977;\n    int32_t block_id_76976;\n    int32_t global_tid_76974;\n    int64_t phys_tid_73807;\n    int32_t chunk_sizze_32b_76979;\n    int64_t byte_offsets_76980;\n    int64_t warp_byte_offset_76981;\n    __local unsigned char *local_mem_76982;\n    int64_t trans_arr_len_76983;\n    int64_t phys_block_id_76989;\n    in", "t64_t virtloop_bound_76990;\n    \n    local_tid_76975 = get_local_id(0);\n    tblock_sizze_76978 = get_local_size(0);\n    wave_sizze_76977 = LOCKSTEP_WIDTH;\n    block_id_76976 = get_tblock_id(0);\n    global_tid_76974 = block_id_76976 * tblock_sizze_76978 + local_tid_76975;\n    phys_tid_73807 = sext_i32_i64(global_tid_76974);\n    chunk_sizze_32b_76979 = sext_i64_i32(chunk_sizze_76923);\n    byte_offsets_76980 = segscan_tblock_sizze_73802 * (int64_t) 8;\n    warp_byte_offset_76981 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_76982 = (__local unsigned char *) local_mem_76982_backing_0;\n    trans_arr_len_76983 = chunk_sizze_76923 * segscan_tblock_sizze_73802;\n    phys_block_id_76989 = get_tblock_id(0);\n    virtloop_bound_76990 = sdiv_up64(num_virt_blocks_76924 - phys_block_id_76989, num_tblocks_73804);\n    for (int64_t virtloop_i_76991 = 0; virtloop_i_76991 < virtloop_bound_76990; virtloop_i_76991++) {\n        int64_t dynamic_id_76992;\n        int64_t block_offset_76993;\n        int64_t sgm_idx_76994;\n        int32_t boundary_76995;\n        int32_t segsizze_compact_76996;\n        int64_t private_mem_76997[chunk_sizze_76923];\n        int64_t thd_offset_76999;\n        int64_t acc_77015;\n        int64_t prefix_77025;\n        bool block_new_sgm_77026;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_76975 == 0) {\n                dynamic_id_76992 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_76952)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 0] = dynamic_id_76992;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_76992 == num_virt_blocks_76924 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_76952)[(int64_t) 0] = 0;\n    ", "                }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_76992 = ((__local int32_t *) local_mem_76982)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_76993 = dynamic_id_76992 * chunk_sizze_76923 * segscan_tblock_sizze_73802;\n        sgm_idx_76994 = smod64(block_offset_76993, nR_57224);\n        boundary_76995 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_73802, nR_57224 - sgm_idx_76994));\n        segsizze_compact_76996 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_73802, nR_57224));\n        thd_offset_76999 = block_offset_76993 + sext_i32_i64(local_tid_76975);\n        // Load and map\n        {\n            for (int64_t i_77000 = 0; i_77000 < chunk_sizze_76923; i_77000++) {\n                int64_t virt_tid_77001 = thd_offset_76999 + i_77000 * segscan_tblock_sizze_73802;\n                int64_t slice_77002 = nR_57224;\n                int64_t gtid_73806 = virt_tid_77001;\n                int64_t remnant_77003 = virt_tid_77001 - gtid_73806;\n                \n                if (slt64(virt_tid_77001, nR_57224)) {\n                    int64_t eta_p_65962 = ((__global int64_t *) ext_mem_75938)[gtid_73806];\n                    bool lifted_lambda_res_65963 = slt64((int64_t) 0, eta_p_65962);\n                    int64_t defunc_0_f_res_65964 = btoi_bool_i64(lifted_lambda_res_65963);\n                    \n                    ((__global int64_t *) mem_75943)[gtid_73806] = defunc_0_f_res_65964;\n                    private_mem_76997[i_77000] = defunc_0_f_res_65964;\n                } else {\n                    private_mem_76997[i_77000] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77004 = 0; i_77004 < chunk_sizze_76923; i_77004++) {\n                int64_t sharedIdx_77005 = sext_i32_i64(local_tid_76975) + i_77004 * segscan_tblock_sizze_73802;\n          ",
                                    "      int64_t tmp_77006 = private_mem_76997[i_77004];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77005] = tmp_77006;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77007 = 0; i_77007 < chunk_sizze_76923; i_77007++) {\n                int64_t sharedIdx_77008 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77007;\n                int64_t tmp_77009 = ((__local int64_t *) local_mem_76982)[sharedIdx_77008];\n                \n                private_mem_76997[i_77007] = tmp_77009;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77010 = 0; i_77010 < chunk_sizze_76923 - (int64_t) 1; i_77010++) {\n                int64_t eta_p_65673;\n                int64_t eta_p_65674;\n                \n                eta_p_65673 = private_mem_76997[i_77010];\n                eta_p_65674 = private_mem_76997[i_77010 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_65675 = add64(eta_p_65673, eta_p_65674);\n                \n                private_mem_76997[i_77010 + (int64_t) 1] = defunc_0_op_res_65675;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77011 = private_mem_76997[chunk_sizze_76923 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = tmp_77011;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77012;\n            int64_t eta_p_77013;\n            int64_t eta_p_77016;\n            int64_t eta_p_77017;\n            bool ltid_in_bounds_77019 = slt64(sext_i32_i64(local_tid_76975), num_virt_threads_76925);\n            int32_t skip_threads_77020;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77019) {\n                    eta_p_77013 = ((volatile __local int64_t *) l", "ocal_mem_76982)[sext_i32_i64(local_tid_76975)];\n                    if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                        eta_p_77012 = eta_p_77013;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77020 = 1;\n                while (slt32(skip_threads_77020, 32)) {\n                    bool thread_active_77021 = sle32(skip_threads_77020, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && ltid_in_bounds_77019;\n                    \n                    if (thread_active_77021) {\n                        // read operands\n                        {\n                            eta_p_77012 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77020)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77021) {\n                            int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                            \n                            eta_p_77012 = defunc_0_op_res_77014;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77021) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77012;\n                            eta_p_77013 = eta_p_77012;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77020 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n  ", "          // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 31 && ltid_in_bounds_77019) {\n                    ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32))] = eta_p_77012;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77022;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                        eta_p_77017 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                        if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                            eta_p_77016 = eta_p_77017;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77022 = 1;\n                    while (slt32(skip_threads_77022, 32)) {\n                        bool thread_active_77023 = sle32(skip_threads_77022, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019);\n                        \n                        if (thread_active_77023) {\n                            // read operands\n                            {\n                                eta_p_77016 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77022)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77023) {\n                                int64_t defunc_0_op_res_77018 = add64(eta_p_77016, eta_p",
                                    "_77017);\n                                \n                                eta_p_77016 = defunc_0_op_res_77018;\n                            }\n                        }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77023) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77016;\n                                eta_p_77017 = eta_p_77016;\n                            }\n                        }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77022 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77024 = squot32(local_tid_76975, 32) == 0 || !ltid_in_bounds_77019;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77024) {\n                        eta_p_77013 = eta_p_77012;\n                        eta_p_77012 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77024) {\n                        int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                        \n                        eta_p_77012 = defunc_0_op_res_77014;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77024) {\n                        ((__local int64_t *) local_mem_76982)[sext_i32", "_i64(local_tid_76975)] = eta_p_77012;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                    ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77013;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_76975 == 0) {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[segscan_tblock_sizze_73802 - (int64_t) 1];\n            } else {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77025 = (int64_t) 0;\n        block_new_sgm_77026 = sgm_idx_76994 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77026 && local_tid_76975 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = acc_77015;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                acc_77015 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77026 && slt32(local_tid_76975, wave_sizze_76977)) {\n                if (local_tid_76975 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_76948)[dynamic_id_76992] = acc_77015;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 1;\n                    \n                    int8_t tmp_77027 = ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_76982)[(int64_t) 0] = tmp_77027;\n                }\n  ", "              mem_fence_local();\n                \n                int8_t status_77028 = ((__local int8_t *) local_mem_76982)[(int64_t) 0];\n                \n                if (status_77028 == (int8_t) 2) {\n                    if (local_tid_76975 == 0) {\n                        prefix_77025 = ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77029 = sext_i64_i32(dynamic_id_76992 - sext_i32_i64(wave_sizze_76977));\n                    \n                    while (slt32(wave_sizze_76977 * -1, readOffset_77029)) {\n                        int32_t read_i_77030 = readOffset_77029 + local_tid_76975;\n                        int64_t aggr_77031 = (int64_t) 0;\n                        int8_t flag_77032 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77030)) {\n                            flag_77032 = ((volatile __global int8_t *) status_flags_mem_76926)[sext_i32_i64(read_i_77030)];\n                            if (flag_77032 == (int8_t) 2) {\n                                aggr_77031 = ((volatile __global int64_t *) incprefixes_mem_76950)[sext_i32_i64(read_i_77030)];\n                            } else if (flag_77032 == (int8_t) 1) {\n                                aggr_77031 = ((volatile __global int64_t *) aggregates_mem_76948)[sext_i32_i64(read_i_77030)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = aggr_77031;\n                        ((__local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flag_77032;\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        if (slt8(flag_77032, (int8_t) 2)) {\n                            int8_t flg_x_77036;\n                            int8_t flg_y_77037;\n                     ",
                                    "       int64_t eta_p_77033;\n                            int64_t eta_p_77034;\n                            int32_t skip_threads_77038;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77037 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                                eta_p_77034 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)];\n                                if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                                    eta_p_77033 = eta_p_77034;\n                                    flg_x_77036 = flg_y_77037;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77038 = 1;\n                                while (slt32(skip_threads_77038, 32)) {\n                                    if (sle32(skip_threads_77038, local_tid_76975 - squot32(local_tid_76975, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77036 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038)];\n                                            eta_p_77033 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77037 == (int8_t) 2 || flg_y_77037 == (int8_t) 0) {\n                                                flg_x_77036 = flg_y_77037;\n                                                eta_p_770", "33 = eta_p_77034;\n                                            } else {\n                                                int64_t defunc_0_op_res_77035 = add64(eta_p_77033, eta_p_77034);\n                                                \n                                                eta_p_77033 = defunc_0_op_res_77035;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flg_x_77036;\n                                            flg_y_77037 = flg_x_77036;\n                                            ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = eta_p_77033;\n                                            eta_p_77034 = eta_p_77033;\n                                        }\n                                    }\n                                    skip_threads_77038 *= 2;\n                                }\n                            }\n                        }\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        aggr_77031 = ((__local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(wave_sizze_76977) - (int64_t) 1)];\n                        if (flag_77032 == (int8_t) 2) {\n                            readOffset_77029 = wave_sizze_76977 * -1;\n                        } else if (flag_77032 == (int8_t) 1) {\n                            readOffset_77029 -= wave_sizze_76977;\n                        }\n                        if (slt8((int8_t) 0, flag_77032)) {\n                            int64_t eta_p_77039 = aggr_77031;\n                            int64_t eta_p_77040 = prefix_77025;\n                            int64_t defunc_0_op_res_77041 = add64(eta_p_77039, eta_p_77040);\n                 ", "           \n                            prefix_77025 = defunc_0_op_res_77041;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_76975 == 0) {\n                    if (boundary_76995 == sext_i64_i32(segscan_tblock_sizze_73802 * chunk_sizze_76923)) {\n                        int64_t eta_p_77042 = prefix_77025;\n                        int64_t eta_p_77043 = acc_77015;\n                        int64_t defunc_0_op_res_77044 = add64(eta_p_77042, eta_p_77043);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = defunc_0_op_res_77044;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 4] = prefix_77025;\n                    acc_77015 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_76992 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77025 = ((__local int64_t *) local_mem_76982)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77045;\n            int64_t eta_p_77046;\n            int64_t eta_p_77048 = prefix_77025;\n            int64_t eta_p_77049 = acc_77015;\n            \n            if (slt32(local_tid_76975 * chunk_sizze_32b_76979, boundary_76995) && !block_new_sgm_77026) {\n                int64_t defunc_0_op_res_77050 = add64(eta_p_77048, eta_p_77049);\n                \n                eta_p_77045 = defunc_0_op_res_77050;\n            } else {\n                eta_p_77045 = acc_77015;\n            }\n            \n            int32_t stopping_point_77051 = segsizze_compact_76996 - srem32(local_tid_76975 * chunk_sizze_32b_76979 - 1 + segsizze_compact_76996 - boundary_76995",
                                    ", segsizze_compact_76996);\n            \n            for (int64_t i_77052 = 0; i_77052 < chunk_sizze_76923; i_77052++) {\n                if (slt32(sext_i64_i32(i_77052), stopping_point_77051 - 1)) {\n                    eta_p_77046 = private_mem_76997[i_77052];\n                    \n                    int64_t defunc_0_op_res_77047 = add64(eta_p_77045, eta_p_77046);\n                    \n                    private_mem_76997[i_77052] = defunc_0_op_res_77047;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77053 = 0; i_77053 < chunk_sizze_76923; i_77053++) {\n                int64_t sharedIdx_77054 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77053;\n                int64_t tmp_77055 = private_mem_76997[i_77053];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77054] = tmp_77055;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77056 = 0; i_77056 < chunk_sizze_76923; i_77056++) {\n                int64_t flat_idx_77057 = thd_offset_76999 + i_77056 * segscan_tblock_sizze_73802;\n                int64_t slice_77058 = nR_57224;\n                int64_t gtid_73806 = flat_idx_77057;\n                int64_t remnant_77059 = flat_idx_77057 - gtid_73806;\n                \n                if (slt64(flat_idx_77057, nR_57224)) {\n                    int64_t tmp_77060 = ((__local int64_t *) local_mem_76982)[flat_idx_77057 - block_offset_76993];\n                    \n                    ((__global int64_t *) mem_75941)[gtid_73806] = tmp_77060;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_73802\n    #undef chunk_sizze_76923\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_doublezisegscan_73823_dim1, 1, 1)\nvoid inner_SMJ_doublezisegscan_73823(__global int *global_failure, int64_t m_65686, int64_t num_tblocks_73820, int", "64_t num_virt_blocks_77081, int64_t num_virt_threads_77082, __global unsigned char *mem_75945, __global unsigned char *mem_75955, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *status_flags_mem_77083, __global unsigned char *aggregates_mem_77085, __global unsigned char *incprefixes_mem_77087, __global unsigned char *aggregates_mem_77089, __global unsigned char *incprefixes_mem_77091, __global unsigned char *global_dynid_mem_77093)\n{\n    #define segscan_tblock_sizze_73818 (inner_SMJ_doublezisegscan_73823zisegscan_tblock_sizze_73818)\n    #define chunk_sizze_77080 (inner_SMJ_doublezisegscan_73823zichunk_sizze_77080)\n    \n    volatile __local unsigned char *local_mem_77105_backing_0 = &shared_mem[0];\n    const int64_t local_mem_77105_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73818, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73818), smax64(chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73818, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73818), smax64(chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77096;\n    int32_t tblock_sizze_77099;\n    int32_t wave_sizze_77098;\n    int32_t block_id_77097;\n    int32_t global_tid_77095;\n    int64_t phys_tid_73823;\n    int32_t chunk_sizze_32b_77100;\n    int64_t byte_offsets_77101;\n    int64_t byte_offsets_77102;\n    int64_t warp_byte_offset_77103;\n    int64_t warp_byte_offset_77104;\n    __local unsigned char *local_mem_77105;\n    int64_t trans_arr_len_77106;\n    int64_t phys_block_id_77115;\n    int64_t virtloop_bound_77116;\n    \n    lo", "cal_tid_77096 = get_local_id(0);\n    tblock_sizze_77099 = get_local_size(0);\n    wave_sizze_77098 = LOCKSTEP_WIDTH;\n    block_id_77097 = get_tblock_id(0);\n    global_tid_77095 = block_id_77097 * tblock_sizze_77099 + local_tid_77096;\n    phys_tid_73823 = sext_i32_i64(global_tid_77095);\n    chunk_sizze_32b_77100 = sext_i64_i32(chunk_sizze_77080);\n    byte_offsets_77101 = segscan_tblock_sizze_73818 * (int64_t) 8;\n    byte_offsets_77102 = sdiv_up64(byte_offsets_77101, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_73818 * (int64_t) 8;\n    warp_byte_offset_77103 = (int64_t) 288;\n    warp_byte_offset_77104 = sdiv_up64(warp_byte_offset_77103, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_77105 = (__local unsigned char *) local_mem_77105_backing_0;\n    trans_arr_len_77106 = chunk_sizze_77080 * segscan_tblock_sizze_73818;\n    phys_block_id_77115 = get_tblock_id(0);\n    virtloop_bound_77116 = sdiv_up64(num_virt_blocks_77081 - phys_block_id_77115, num_tblocks_73820);\n    for (int64_t virtloop_i_77117 = 0; virtloop_i_77117 < virtloop_bound_77116; virtloop_i_77117++) {\n        int64_t dynamic_id_77118;\n        int64_t block_offset_77119;\n        int64_t sgm_idx_77120;\n        int32_t boundary_77121;\n        int32_t segsizze_compact_77122;\n        int64_t private_mem_77123[chunk_sizze_77080];\n        int64_t private_mem_77125[chunk_sizze_77080];\n        int64_t thd_offset_77127;\n        int64_t acc_77153;\n        int64_t acc_77154;\n        int64_t prefix_77167;\n        int64_t prefix_77168;\n        bool block_new_sgm_77169;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_77096 == 0) {\n                dynamic_id_77118 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_77093)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 0] = dynam",
                                    "ic_id_77118;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_77118 == num_virt_blocks_77081 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_77093)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_77118 = ((__local int32_t *) local_mem_77105)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_77119 = dynamic_id_77118 * chunk_sizze_77080 * segscan_tblock_sizze_73818;\n        sgm_idx_77120 = smod64(block_offset_77119, m_65686);\n        boundary_77121 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_73818, m_65686 - sgm_idx_77120));\n        segsizze_compact_77122 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_73818, m_65686));\n        thd_offset_77127 = block_offset_77119 + sext_i32_i64(local_tid_77096);\n        // Load and map\n        {\n            for (int64_t i_77128 = 0; i_77128 < chunk_sizze_77080; i_77128++) {\n                int64_t virt_tid_77129 = thd_offset_77127 + i_77128 * segscan_tblock_sizze_73818;\n                int64_t slice_77130 = m_65686;\n                int64_t gtid_73822 = virt_tid_77129;\n                int64_t remnant_77131 = virt_tid_77129 - gtid_73822;\n                \n                if (slt64(virt_tid_77129, m_65686)) {\n                    int64_t x_65967 = ((__global int64_t *) mem_75945)[gtid_73822];\n                    bool lifted_lambda_res_65969 = slt64((int64_t) 1, x_65967);\n                    int64_t defunc_0_f_res_65970 = btoi_bool_i64(lifted_lambda_res_65969);\n                    \n                    ((__global int64_t *) mem_75959)[gtid_73822] = defunc_0_f_res_65970;\n                    private_mem_77123[i_77128] = x_65967;\n                    private_mem_77125[i_77128] = defunc_0_f_res_65970;\n                } else {\n                    private_mem_77123[i_7", "7128] = (int64_t) 0;\n                    private_mem_77125[i_77128] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77132 = 0; i_77132 < chunk_sizze_77080; i_77132++) {\n                int64_t sharedIdx_77133 = sext_i32_i64(local_tid_77096) + i_77132 * segscan_tblock_sizze_73818;\n                int64_t tmp_77134 = private_mem_77123[i_77132];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77133] = tmp_77134;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77135 = 0; i_77135 < chunk_sizze_77080; i_77135++) {\n                int64_t sharedIdx_77136 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77135;\n                int64_t tmp_77137 = ((__local int64_t *) local_mem_77105)[sharedIdx_77136];\n                \n                private_mem_77123[i_77135] = tmp_77137;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77138 = 0; i_77138 < chunk_sizze_77080; i_77138++) {\n                int64_t sharedIdx_77139 = sext_i32_i64(local_tid_77096) + i_77138 * segscan_tblock_sizze_73818;\n                int64_t tmp_77140 = private_mem_77125[i_77138];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77139] = tmp_77140;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77141 = 0; i_77141 < chunk_sizze_77080; i_77141++) {\n                int64_t sharedIdx_77142 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77141;\n                int64_t tmp_77143 = ((__local int64_t *) local_mem_77105)[sharedIdx_77142];\n                \n                private_mem_77125[i_77141] = tmp_77143;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77144 = 0; i_77144 < chunk_sizze_77080 - (int64_t) 1; i_77144++) {\n                int", "64_t eta_p_65723;\n                int64_t eta_p_65724;\n                \n                eta_p_65723 = private_mem_77123[i_77144];\n                eta_p_65724 = private_mem_77123[i_77144 + (int64_t) 1];\n                \n                int64_t eta_p_65816;\n                int64_t eta_p_65817;\n                \n                eta_p_65816 = private_mem_77125[i_77144];\n                eta_p_65817 = private_mem_77125[i_77144 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_65725 = add64(eta_p_65723, eta_p_65724);\n                int64_t defunc_0_op_res_65818 = add64(eta_p_65816, eta_p_65817);\n                \n                private_mem_77123[i_77144 + (int64_t) 1] = lifted_lambda_res_65725;\n                private_mem_77125[i_77144 + (int64_t) 1] = defunc_0_op_res_65818;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77145 = private_mem_77123[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = tmp_77145;\n            \n            int64_t tmp_77146 = private_mem_77125[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = tmp_77146;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77147;\n            int64_t eta_p_77148;\n            int64_t eta_p_77149;\n            int64_t eta_p_77150;\n            int64_t eta_p_77155;\n            int64_t eta_p_77156;\n            int64_t eta_p_77157;\n            int64_t eta_p_77158;\n            bool ltid_in_bounds_77161 = slt64(sext_i32_i64(local_tid_77096), num_virt_threads_77082);\n            int32_t skip_threads_77162;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77161) {\n                    eta_p_77149 = ((volatile __local int",
                                    "64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                    eta_p_77150 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                    if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                        eta_p_77147 = eta_p_77149;\n                        eta_p_77148 = eta_p_77150;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77162 = 1;\n                while (slt32(skip_threads_77162, 32)) {\n                    bool thread_active_77163 = sle32(skip_threads_77162, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && ltid_in_bounds_77161;\n                    \n                    if (thread_active_77163) {\n                        // read operands\n                        {\n                            eta_p_77147 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162)];\n                            eta_p_77148 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77163) {\n                            int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                            int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                            \n                            eta_p_77147 = lifted_lambda_res_77151;\n                            eta_p_77148 = defunc_0_op_res_77152;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (th", "read_active_77163) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                            eta_p_77149 = eta_p_77147;\n                            ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                            eta_p_77150 = eta_p_77148;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77162 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 31 && ltid_in_bounds_77161) {\n                    ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77147;\n                    ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77148;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77164;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                        eta_p_77157 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                        eta_p_77158 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                        if ((local_tid_77096 ", "- squot32(local_tid_77096, 32) * 32) == 0) {\n                            eta_p_77155 = eta_p_77157;\n                            eta_p_77156 = eta_p_77158;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77164 = 1;\n                    while (slt32(skip_threads_77164, 32)) {\n                        bool thread_active_77165 = sle32(skip_threads_77164, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161);\n                        \n                        if (thread_active_77165) {\n                            // read operands\n                            {\n                                eta_p_77155 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164)];\n                                eta_p_77156 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77165) {\n                                int64_t lifted_lambda_res_77159 = add64(eta_p_77155, eta_p_77157);\n                                int64_t defunc_0_op_res_77160 = add64(eta_p_77156, eta_p_77158);\n                                \n                                eta_p_77155 = lifted_lambda_res_77159;\n                                eta_p_77156 = defunc_0_op_res_77160;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77165) {\n                            // write result\n                      ",
                                    "      {\n                                ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77155;\n                                eta_p_77157 = eta_p_77155;\n                                ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77156;\n                                eta_p_77158 = eta_p_77156;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77164 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77166 = squot32(local_tid_77096, 32) == 0 || !ltid_in_bounds_77161;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77166) {\n                        eta_p_77149 = eta_p_77147;\n                        eta_p_77150 = eta_p_77148;\n                        eta_p_77147 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1];\n                        eta_p_77148 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77166) {\n                        int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                        int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                        \n                        eta_p_77147 = lifted_lambda_res_77151;\n                        eta_p_77148 = defunc_0_op_res_77152;\n                    }\n                }\n   ", "             // write final result\n                {\n                    if (!no_carry_in_77166) {\n                        ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                        ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                    ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77149;\n                    ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_77096 == 0) {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[segscan_tblock_sizze_73818 - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (segscan_tblock_sizze_73818 - (int64_t) 1)];\n            } else {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77167 = (int64_t) 0;\n        prefix_77168 = (int64_t) 0;\n        block_new_sgm_77169 = sgm_idx_77120 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77169 && local_tid_77096 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = acc_77153;\n                ((volatile __global i", "nt64_t *) incprefixes_mem_77091)[dynamic_id_77118] = acc_77154;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                acc_77153 = (int64_t) 0;\n                acc_77154 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77169 && slt32(local_tid_77096, wave_sizze_77098)) {\n                if (local_tid_77096 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_77085)[dynamic_id_77118] = acc_77153;\n                    ((volatile __global int64_t *) aggregates_mem_77089)[dynamic_id_77118] = acc_77154;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 1;\n                    \n                    int8_t tmp_77170 = ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_77105)[(int64_t) 0] = tmp_77170;\n                }\n                mem_fence_local();\n                \n                int8_t status_77171 = ((__local int8_t *) local_mem_77105)[(int64_t) 0];\n                \n                if (status_77171 == (int8_t) 2) {\n                    if (local_tid_77096 == 0) {\n                        prefix_77167 = ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118 - (int64_t) 1];\n                        prefix_77168 = ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77172 = sext_i64_i32(dynamic_id_77118 - sext_i32_i64(wave_sizze_77098));\n                    \n                    while (slt32(wave_sizze_77098 * -1, readOffset_77172)) {\n                        int32_t read_i_77173 = readOffset_77172 + local_tid_77096;\n                        int64_t aggr_77174 = (int64_t) 0;\n                        int64_t aggr",
                                    "_77175 = (int64_t) 0;\n                        int8_t flag_77176 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77173)) {\n                            flag_77176 = ((volatile __global int8_t *) status_flags_mem_77083)[sext_i32_i64(read_i_77173)];\n                            if (flag_77176 == (int8_t) 2) {\n                                aggr_77174 = ((volatile __global int64_t *) incprefixes_mem_77087)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) incprefixes_mem_77091)[sext_i32_i64(read_i_77173)];\n                            } else if (flag_77176 == (int8_t) 1) {\n                                aggr_77174 = ((volatile __global int64_t *) aggregates_mem_77085)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) aggregates_mem_77089)[sext_i32_i64(read_i_77173)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = aggr_77174;\n                        ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = aggr_77175;\n                        ((__local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flag_77176;\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze_77098) - (int64_t) 1];\n                        if (slt8(flag_77176, (int8_t) 2)) {\n                            int8_t flg_x_77183;\n                            int8_t flg_y_77184;\n                            int64_t eta_p_77177;\n                            int64_t eta_p_77178;\n                            int64_t eta_p_77179;\n                            int64_t eta_p_77180;\n                            int32_t skip_threads_77185;\n                            \n                            // read input for in-block scan\n                           ", " {\n                                flg_y_77184 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                                eta_p_77179 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)];\n                                eta_p_77180 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                                    eta_p_77177 = eta_p_77179;\n                                    eta_p_77178 = eta_p_77180;\n                                    flg_x_77183 = flg_y_77184;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77185 = 1;\n                                while (slt32(skip_threads_77185, 32)) {\n                                    if (sle32(skip_threads_77185, local_tid_77096 - squot32(local_tid_77096, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77183 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185)];\n                                            eta_p_77177 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                            eta_p_77178 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                        }\n                                        // perform operation\n                                        {\n                               ", "             if (flg_y_77184 == (int8_t) 2 || flg_y_77184 == (int8_t) 0) {\n                                                flg_x_77183 = flg_y_77184;\n                                                eta_p_77177 = eta_p_77179;\n                                                eta_p_77178 = eta_p_77180;\n                                            } else {\n                                                int64_t lifted_lambda_res_77181 = add64(eta_p_77177, eta_p_77179);\n                                                int64_t defunc_0_op_res_77182 = add64(eta_p_77178, eta_p_77180);\n                                                \n                                                eta_p_77177 = lifted_lambda_res_77181;\n                                                eta_p_77178 = defunc_0_op_res_77182;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flg_x_77183;\n                                            flg_y_77184 = flg_x_77183;\n                                            ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = eta_p_77177;\n                                            eta_p_77179 = eta_p_77177;\n                                            ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77178;\n                                            eta_p_77180 = eta_p_77178;\n                                        }\n                                    }\n                                    skip_threads_77185 *= 2;\n                                }\n                            }\n                        }\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze",
                                    "_77098) - (int64_t) 1];\n                        aggr_77174 = ((__local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(wave_sizze_77098) - (int64_t) 1)];\n                        aggr_77175 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(wave_sizze_77098) - (int64_t) 1)];\n                        if (flag_77176 == (int8_t) 2) {\n                            readOffset_77172 = wave_sizze_77098 * -1;\n                        } else if (flag_77176 == (int8_t) 1) {\n                            readOffset_77172 -= wave_sizze_77098;\n                        }\n                        if (slt8((int8_t) 0, flag_77176)) {\n                            int64_t eta_p_77186 = aggr_77174;\n                            int64_t eta_p_77187 = aggr_77175;\n                            int64_t eta_p_77188 = prefix_77167;\n                            int64_t eta_p_77189 = prefix_77168;\n                            int64_t lifted_lambda_res_77190 = add64(eta_p_77186, eta_p_77188);\n                            int64_t defunc_0_op_res_77191 = add64(eta_p_77187, eta_p_77189);\n                            \n                            prefix_77167 = lifted_lambda_res_77190;\n                            prefix_77168 = defunc_0_op_res_77191;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_77096 == 0) {\n                    if (boundary_77121 == sext_i64_i32(segscan_tblock_sizze_73818 * chunk_sizze_77080)) {\n                        int64_t eta_p_77192 = prefix_77167;\n                        int64_t eta_p_77193 = prefix_77168;\n                        int64_t eta_p_77194 = acc_77153;\n                        int64_t eta_p_77195 = acc_77154;\n                        int64_t lifted_lambda_res_77196 = add64(eta_p_77192, eta_p_77194);\n                        int64_t defunc_0_op_res_77197 = add64(eta_p_77193, eta_p_77195);\n                        \n                        (", "(volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = lifted_lambda_res_77196;\n                        ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118] = defunc_0_op_res_77197;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 4] = prefix_77167;\n                    ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8)] = prefix_77168;\n                    acc_77153 = (int64_t) 0;\n                    acc_77154 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_77118 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77167 = ((__local int64_t *) local_mem_77105)[(int64_t) 4];\n                prefix_77168 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77198;\n            int64_t eta_p_77200;\n            int64_t eta_p_77204 = prefix_77167;\n            int64_t eta_p_77206 = acc_77153;\n            int64_t eta_p_77199;\n            int64_t eta_p_77201;\n            int64_t eta_p_77205 = prefix_77168;\n            int64_t eta_p_77207 = acc_77154;\n            \n            if (slt32(local_tid_77096 * chunk_sizze_32b_77100, boundary_77121) && !block_new_sgm_77169) {\n                int64_t lifted_lambda_res_77208 = add64(eta_p_77204, eta_p_77206);\n                int64_t defunc_0_op_res_77209 = add64(eta_p_77205, eta_p_77207);\n                \n                eta_p_77198 = lifted_lambda_res_77208;\n                eta_p_77199 = defunc_0_op_res_77209;\n            } else {\n                eta_p_77198 = acc_77153;\n                eta_p_77199 = acc_77154;\n            }\n            \n           ", " int32_t stopping_point_77210 = segsizze_compact_77122 - srem32(local_tid_77096 * chunk_sizze_32b_77100 - 1 + segsizze_compact_77122 - boundary_77121, segsizze_compact_77122);\n            \n            for (int64_t i_77211 = 0; i_77211 < chunk_sizze_77080; i_77211++) {\n                if (slt32(sext_i64_i32(i_77211), stopping_point_77210 - 1)) {\n                    eta_p_77200 = private_mem_77123[i_77211];\n                    eta_p_77201 = private_mem_77125[i_77211];\n                    \n                    int64_t lifted_lambda_res_77202 = add64(eta_p_77198, eta_p_77200);\n                    int64_t defunc_0_op_res_77203 = add64(eta_p_77199, eta_p_77201);\n                    \n                    private_mem_77123[i_77211] = lifted_lambda_res_77202;\n                    private_mem_77125[i_77211] = defunc_0_op_res_77203;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77212 = 0; i_77212 < chunk_sizze_77080; i_77212++) {\n                int64_t sharedIdx_77213 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77212;\n                int64_t tmp_77214 = private_mem_77123[i_77212];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77213] = tmp_77214;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77215 = 0; i_77215 < chunk_sizze_77080; i_77215++) {\n                int64_t flat_idx_77216 = thd_offset_77127 + i_77215 * segscan_tblock_sizze_73818;\n                int64_t slice_77217 = m_65686;\n                int64_t gtid_73822 = flat_idx_77216;\n                int64_t remnant_77218 = flat_idx_77216 - gtid_73822;\n                \n                if (slt64(flat_idx_77216, m_65686)) {\n                    int64_t tmp_77219 = ((__local int64_t *) local_mem_77105)[flat_idx_77216 - block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75955)[gtid_73822] = tmp_772",
                                    "19;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77220 = 0; i_77220 < chunk_sizze_77080; i_77220++) {\n                int64_t sharedIdx_77221 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77220;\n                int64_t tmp_77222 = private_mem_77125[i_77220];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77221] = tmp_77222;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77223 = 0; i_77223 < chunk_sizze_77080; i_77223++) {\n                int64_t flat_idx_77224 = thd_offset_77127 + i_77223 * segscan_tblock_sizze_73818;\n                int64_t slice_77225 = m_65686;\n                int64_t gtid_73822 = flat_idx_77224;\n                int64_t remnant_77226 = flat_idx_77224 - gtid_73822;\n                \n                if (slt64(flat_idx_77224, m_65686)) {\n                    int64_t tmp_77227 = ((__local int64_t *) local_mem_77105)[flat_idx_77224 - block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75957)[gtid_73822] = tmp_77227;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_73818\n    #undef chunk_sizze_77080\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76566_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76566(__global int *global_failure, int64_t gt_rhs_64823, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75475)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76568;\n    int32_t tblock_sizze_76571;\n    int32_t wave_sizze_76570;\n    int32_t block_id_76569;\n    int32_t global_tid_76567;\n    int64_t tid_76566;\n    float x_75366;\n    \n    local_tid_76568 = get_local_id(0);\n    tblock_sizze_76571 = get_local_size(0);\n    wave_sizze_76570 = LOCKSTEP_WIDTH;\n    block_id_76569 = get_tblock_id(0);\n    global_tid_76567 = block_id_76569 * tblock_sizze_76571 + loca", "l_tid_76568;\n    tid_76566 = sext_i32_i64(global_tid_76567);\n    x_75366 = ((__global float *) tR_mem_75467)[gt_rhs_64823];\n    ((__global float *) mem_75475)[(int64_t) 0] = x_75366;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76598_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76598(__global int *global_failure, int64_t tS_start_64840, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75476, __global unsigned char *mem_75483, __global unsigned char *mem_75484)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76600;\n    int32_t tblock_sizze_76603;\n    int32_t wave_sizze_76602;\n    int32_t block_id_76601;\n    int32_t global_tid_76599;\n    int64_t tid_76598;\n    float gt_lhs_75370;\n    float gt_rhs_75372;\n    bool defunc_0_gt_res_75374;\n    \n    local_tid_76600 = get_local_id(0);\n    tblock_sizze_76603 = get_local_size(0);\n    wave_sizze_76602 = LOCKSTEP_WIDTH;\n    block_id_76601 = get_tblock_id(0);\n    global_tid_76599 = block_id_76601 * tblock_sizze_76603 + local_tid_76600;\n    tid_76598 = sext_i32_i64(global_tid_76599);\n    gt_lhs_75370 = ((__global float *) tS_mem_75468)[tS_start_64840];\n    gt_rhs_75372 = ((__global float *) ext_mem_75476)[(int64_t) 0];\n    defunc_0_gt_res_75374 = gt_rhs_75372 < gt_lhs_75370;\n    ((__global float *) mem_75483)[(int64_t) 0] = gt_lhs_75370;\n    ((__global bool *) mem_75484)[(int64_t) 0] = defunc_0_gt_res_75374;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76604_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76604(__global int *global_failure, int64_t i_p_m_t_s_64846, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75750)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76606;\n    int32_t tblock_sizze_76609;\n    int32_t wave_sizze_76608;\n    int32_t block_id_76607;\n    int32_t global_tid_76605;\n    int64_t tid_76604;\n    float x_75376;\n    \n    local_tid_76606 = get_local_id(0);\n    tblock_sizze", "_76609 = get_local_size(0);\n    wave_sizze_76608 = LOCKSTEP_WIDTH;\n    block_id_76607 = get_tblock_id(0);\n    global_tid_76605 = block_id_76607 * tblock_sizze_76609 + local_tid_76606;\n    tid_76604 = sext_i32_i64(global_tid_76605);\n    x_75376 = ((__global float *) tS_mem_75468)[i_p_m_t_s_64846];\n    ((__global float *) mem_75750)[(int64_t) 0] = x_75376;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76620_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76620(__global int *global_failure, int64_t start_66400, int64_t i_p_m_t_s_66406, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75758, __global unsigned char *mem_75759)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76622;\n    int32_t tblock_sizze_76625;\n    int32_t wave_sizze_76624;\n    int32_t block_id_76623;\n    int32_t global_tid_76621;\n    int64_t tid_76620;\n    float r_max_75380;\n    float r_min_75383;\n    \n    local_tid_76622 = get_local_id(0);\n    tblock_sizze_76625 = get_local_size(0);\n    wave_sizze_76624 = LOCKSTEP_WIDTH;\n    block_id_76623 = get_tblock_id(0);\n    global_tid_76621 = block_id_76623 * tblock_sizze_76625 + local_tid_76622;\n    tid_76620 = sext_i32_i64(global_tid_76621);\n    r_max_75380 = ((__global float *) tR_mem_75467)[i_p_m_t_s_66406];\n    r_min_75383 = ((__global float *) tR_mem_75467)[start_66400];\n    ((__global float *) mem_75758)[(int64_t) 0] = r_max_75380;\n    ((__global float *) mem_75759)[(int64_t) 0] = r_min_75383;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76626_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76626(__global int *global_failure, __global unsigned char *mem_75759, __global unsigned char *ext_mem_75760, __global unsigned char *mem_75762)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76628;\n    int32_t tblock_sizze_76631;\n    int32_t wave_sizze_76630;\n    int32_t block_id_76629;\n    int32_t global_tid_76627;\n    int64_t tid_76626;\n    float s_ma",
                                    "x_75385;\n    float r_min_75386;\n    bool defunc_0_gt_res_75387;\n    \n    local_tid_76628 = get_local_id(0);\n    tblock_sizze_76631 = get_local_size(0);\n    wave_sizze_76630 = LOCKSTEP_WIDTH;\n    block_id_76629 = get_tblock_id(0);\n    global_tid_76627 = block_id_76629 * tblock_sizze_76631 + local_tid_76628;\n    tid_76626 = sext_i32_i64(global_tid_76627);\n    s_max_75385 = ((__global float *) ext_mem_75760)[(int64_t) 0];\n    r_min_75386 = ((__global float *) mem_75759)[(int64_t) 0];\n    defunc_0_gt_res_75387 = s_max_75385 < r_min_75386;\n    ((__global bool *) mem_75762)[(int64_t) 0] = defunc_0_gt_res_75387;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76632_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76632(__global int *global_failure, __global unsigned char *mem_75758, __global unsigned char *ext_mem_75761, __global unsigned char *mem_75763)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76634;\n    int32_t tblock_sizze_76637;\n    int32_t wave_sizze_76636;\n    int32_t block_id_76635;\n    int32_t global_tid_76633;\n    int64_t tid_76632;\n    float r_max_75390;\n    float s_min_75391;\n    bool defunc_0_gt_res_75392;\n    \n    local_tid_76634 = get_local_id(0);\n    tblock_sizze_76637 = get_local_size(0);\n    wave_sizze_76636 = LOCKSTEP_WIDTH;\n    block_id_76635 = get_tblock_id(0);\n    global_tid_76633 = block_id_76635 * tblock_sizze_76637 + local_tid_76634;\n    tid_76632 = sext_i32_i64(global_tid_76633);\n    r_max_75390 = ((__global float *) mem_75758)[(int64_t) 0];\n    s_min_75391 = ((__global float *) ext_mem_75761)[(int64_t) 0];\n    defunc_0_gt_res_75392 = r_max_75390 < s_min_75391;\n    ((__global bool *) mem_75763)[(int64_t) 0] = defunc_0_gt_res_75392;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76691_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76691(__global int *global_failure, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75490)\n{\n    if (*global_failure >= 0)\n     ", "   return;\n    \n    int32_t local_tid_76693;\n    int32_t tblock_sizze_76696;\n    int32_t wave_sizze_76695;\n    int32_t block_id_76694;\n    int32_t global_tid_76692;\n    int64_t tid_76691;\n    float x_75394;\n    \n    local_tid_76693 = get_local_id(0);\n    tblock_sizze_76696 = get_local_size(0);\n    wave_sizze_76695 = LOCKSTEP_WIDTH;\n    block_id_76694 = get_tblock_id(0);\n    global_tid_76692 = block_id_76694 * tblock_sizze_76696 + local_tid_76693;\n    tid_76691 = sext_i32_i64(global_tid_76692);\n    x_75394 = ((__global float *) tR_mem_75467)[(int64_t) 0];\n    ((__global float *) mem_75490)[(int64_t) 0] = x_75394;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76697_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76697(__global int *global_failure, __global unsigned char *mem_75483, __global unsigned char *ext_mem_75491, __global unsigned char *mem_75492)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76699;\n    int32_t tblock_sizze_76702;\n    int32_t wave_sizze_76701;\n    int32_t block_id_76700;\n    int32_t global_tid_76698;\n    int64_t tid_76697;\n    float leq_lhs_75398;\n    float gt_lhs_75399;\n    bool defunc_0_leq_res_75400;\n    \n    local_tid_76699 = get_local_id(0);\n    tblock_sizze_76702 = get_local_size(0);\n    wave_sizze_76701 = LOCKSTEP_WIDTH;\n    block_id_76700 = get_tblock_id(0);\n    global_tid_76698 = block_id_76700 * tblock_sizze_76702 + local_tid_76699;\n    tid_76697 = sext_i32_i64(global_tid_76698);\n    leq_lhs_75398 = ((__global float *) ext_mem_75491)[(int64_t) 0];\n    gt_lhs_75399 = ((__global float *) mem_75483)[(int64_t) 0];\n    defunc_0_leq_res_75400 = leq_lhs_75398 <= gt_lhs_75399;\n    ((__global bool *) mem_75492)[(int64_t) 0] = defunc_0_leq_res_75400;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76703_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76703(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_52195, unsigne", "d char y_64988_bits, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75483, __global unsigned char *mem_75492, __global unsigned char *mem_75494)\n{\n    bool y_64988 = y_64988_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76705;\n    int32_t tblock_sizze_76708;\n    int32_t wave_sizze_76707;\n    int32_t block_id_76706;\n    int32_t global_tid_76704;\n    int64_t tid_76703;\n    bool defunc_0_leq_res_75402;\n    float x_75407;\n    \n    local_tid_76705 = get_local_id(0);\n    tblock_sizze_76708 = get_local_size(0);\n    wave_sizze_76707 = LOCKSTEP_WIDTH;\n    block_id_76706 = get_tblock_id(0);\n    global_tid_76704 = block_id_76706 * tblock_sizze_76708 + local_tid_76705;\n    tid_76703 = sext_i32_i64(global_tid_76704);\n    defunc_0_leq_res_75402 = ((__global bool *) mem_75492)[(int64_t) 0];\n    if (defunc_0_leq_res_75402) {\n        bool index_certs_75403;\n        float lowest_t_res_75404;\n        \n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 42) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_52195;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_75404 = ((__global float *) tR_mem_75467)[(int64_t) 0];\n        x_75407 = lowest_t_res_75404;\n    } else {\n        float gt_lhs_75406;\n        bool index_certs_75405;\n        \n        gt_lhs_75406 = ((__global float *) mem_75483)[(int64_t) 0];\n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 43) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_52195;\n                    ;\n                }\n                return;\n            }\n        }\n        x_75407 = gt_lhs_75406;\n    }\n    ((__global float *) mem_75494)[(int64_t) 0] = x_75407;\n    \n  er",
                                    "ror_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76765_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76765(__global int *global_failure, int64_t slice_65911, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75542)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76767;\n    int32_t tblock_sizze_76770;\n    int32_t wave_sizze_76769;\n    int32_t block_id_76768;\n    int32_t global_tid_76766;\n    int64_t tid_76765;\n    float x_75412;\n    \n    local_tid_76767 = get_local_id(0);\n    tblock_sizze_76770 = get_local_size(0);\n    wave_sizze_76769 = LOCKSTEP_WIDTH;\n    block_id_76768 = get_tblock_id(0);\n    global_tid_76766 = block_id_76768 * tblock_sizze_76770 + local_tid_76767;\n    tid_76765 = sext_i32_i64(global_tid_76766);\n    x_75412 = ((__global float *) tS_mem_75468)[slice_65911];\n    ((__global float *) mem_75542)[(int64_t) 0] = x_75412;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76771_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76771(__global int *global_failure, int64_t slice_66709, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75545)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76773;\n    int32_t tblock_sizze_76776;\n    int32_t wave_sizze_76775;\n    int32_t block_id_76774;\n    int32_t global_tid_76772;\n    int64_t tid_76771;\n    float x_75416;\n    \n    local_tid_76773 = get_local_id(0);\n    tblock_sizze_76776 = get_local_size(0);\n    wave_sizze_76775 = LOCKSTEP_WIDTH;\n    block_id_76774 = get_tblock_id(0);\n    global_tid_76772 = block_id_76774 * tblock_sizze_76776 + local_tid_76773;\n    tid_76771 = sext_i32_i64(global_tid_76772);\n    x_75416 = ((__global float *) tS_mem_75468)[slice_66709];\n    ((__global float *) mem_75545)[(int64_t) 0] = x_75416;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76787_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76787(__global int *global_failure, int64_t slice_65554, int64_t slic", "e_65563, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75553, __global unsigned char *mem_75554)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76789;\n    int32_t tblock_sizze_76792;\n    int32_t wave_sizze_76791;\n    int32_t block_id_76790;\n    int32_t global_tid_76788;\n    int64_t tid_76787;\n    float r_max_75420;\n    float r_min_75423;\n    \n    local_tid_76789 = get_local_id(0);\n    tblock_sizze_76792 = get_local_size(0);\n    wave_sizze_76791 = LOCKSTEP_WIDTH;\n    block_id_76790 = get_tblock_id(0);\n    global_tid_76788 = block_id_76790 * tblock_sizze_76792 + local_tid_76789;\n    tid_76787 = sext_i32_i64(global_tid_76788);\n    r_max_75420 = ((__global float *) tR_mem_75467)[slice_65563];\n    r_min_75423 = ((__global float *) tR_mem_75467)[slice_65554];\n    ((__global float *) mem_75553)[(int64_t) 0] = r_max_75420;\n    ((__global float *) mem_75554)[(int64_t) 0] = r_min_75423;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76793_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76793(__global int *global_failure, __global unsigned char *mem_75554, __global unsigned char *ext_mem_75555, __global unsigned char *mem_75557)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76795;\n    int32_t tblock_sizze_76798;\n    int32_t wave_sizze_76797;\n    int32_t block_id_76796;\n    int32_t global_tid_76794;\n    int64_t tid_76793;\n    float s_max_75425;\n    float r_min_75426;\n    bool defunc_0_gt_res_75427;\n    \n    local_tid_76795 = get_local_id(0);\n    tblock_sizze_76798 = get_local_size(0);\n    wave_sizze_76797 = LOCKSTEP_WIDTH;\n    block_id_76796 = get_tblock_id(0);\n    global_tid_76794 = block_id_76796 * tblock_sizze_76798 + local_tid_76795;\n    tid_76793 = sext_i32_i64(global_tid_76794);\n    s_max_75425 = ((__global float *) ext_mem_75555)[(int64_t) 0];\n    r_min_75426 = ((__global float *) mem_75554)[(int64_t) 0];\n    defunc_0_gt_res_75427 = s_max_75425 < r_min_75426;\n    ((__global ", "bool *) mem_75557)[(int64_t) 0] = defunc_0_gt_res_75427;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76799_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76799(__global int *global_failure, __global unsigned char *mem_75553, __global unsigned char *ext_mem_75556, __global unsigned char *mem_75558)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76801;\n    int32_t tblock_sizze_76804;\n    int32_t wave_sizze_76803;\n    int32_t block_id_76802;\n    int32_t global_tid_76800;\n    int64_t tid_76799;\n    float r_max_75430;\n    float s_min_75431;\n    bool defunc_0_gt_res_75432;\n    \n    local_tid_76801 = get_local_id(0);\n    tblock_sizze_76804 = get_local_size(0);\n    wave_sizze_76803 = LOCKSTEP_WIDTH;\n    block_id_76802 = get_tblock_id(0);\n    global_tid_76800 = block_id_76802 * tblock_sizze_76804 + local_tid_76801;\n    tid_76799 = sext_i32_i64(global_tid_76800);\n    r_max_75430 = ((__global float *) mem_75553)[(int64_t) 0];\n    s_min_75431 = ((__global float *) ext_mem_75556)[(int64_t) 0];\n    defunc_0_gt_res_75432 = r_max_75430 < s_min_75431;\n    ((__global bool *) mem_75558)[(int64_t) 0] = defunc_0_gt_res_75432;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_76912_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_76912(__global int *global_failure, int64_t gt_rhs_64823, int64_t i_p_m_t_s_64846, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75926)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76914;\n    int32_t tblock_sizze_76917;\n    int32_t wave_sizze_76916;\n    int32_t block_id_76915;\n    int32_t global_tid_76913;\n    int64_t tid_76912;\n    float leq_lhs_75434;\n    float leq_rhs_75436;\n    bool defunc_0_leq_res_75440;\n    \n    local_tid_76914 = get_local_id(0);\n    tblock_sizze_76917 = get_local_size(0);\n    wave_sizze_76916 = LOCKSTEP_WIDTH;\n    block_id_76915 = get_tblock_id(0);\n    global_tid_76913 = block_id_76",
                                    "915 * tblock_sizze_76917 + local_tid_76914;\n    tid_76912 = sext_i32_i64(global_tid_76913);\n    leq_lhs_75434 = ((__global float *) tS_mem_75468)[i_p_m_t_s_64846];\n    leq_rhs_75436 = ((__global float *) tR_mem_75467)[gt_rhs_64823];\n    defunc_0_leq_res_75440 = leq_lhs_75434 <= leq_rhs_75436;\n    ((__global bool *) mem_75926)[(int64_t) 0] = defunc_0_leq_res_75440;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_77237_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_77237(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75962, __global unsigned char *mem_75964)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77239;\n    int32_t tblock_sizze_77242;\n    int32_t wave_sizze_77241;\n    int32_t block_id_77240;\n    int32_t global_tid_77238;\n    int64_t tid_77237;\n    int64_t x_75442;\n    \n    local_tid_77239 = get_local_id(0);\n    tblock_sizze_77242 = get_local_size(0);\n    wave_sizze_77241 = LOCKSTEP_WIDTH;\n    block_id_77240 = get_tblock_id(0);\n    global_tid_77238 = block_id_77240 * tblock_sizze_77242 + local_tid_77239;\n    tid_77237 = sext_i32_i64(global_tid_77238);\n    x_75442 = ((__global int64_t *) mem_75962)[m_65696];\n    ((__global int64_t *) mem_75964)[(int64_t) 0] = x_75442;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_77243_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_77243(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75945, __global unsigned char *mem_75967)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77245;\n    int32_t tblock_sizze_77248;\n    int32_t wave_sizze_77247;\n    int32_t block_id_77246;\n    int32_t global_tid_77244;\n    int64_t tid_77243;\n    int64_t x_75446;\n    \n    local_tid_77245 = get_local_id(0);\n    tblock_sizze_77248 = get_local_size(0);\n    wave_sizze_77247 = LOCKSTEP_WIDTH;\n    block_id_77246 = get_tblock_id(0);\n    global_tid_77244 = block_id_77246 * tblock_sizze_77248 + local_tid_7724", "5;\n    tid_77243 = sext_i32_i64(global_tid_77244);\n    x_75446 = ((__global int64_t *) mem_75945)[m_65696];\n    ((__global int64_t *) mem_75967)[(int64_t) 0] = x_75446;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_77249_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_77249(__global int *global_failure, __global unsigned char *ext_mem_75965, __global unsigned char *ext_mem_75968, __global unsigned char *mem_75974)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77251;\n    int32_t tblock_sizze_77254;\n    int32_t wave_sizze_77253;\n    int32_t block_id_77252;\n    int32_t global_tid_77250;\n    int64_t tid_77249;\n    int64_t zp_lhs_75450;\n    int64_t n_pairs_t_res_75451;\n    int64_t n_pairs_t_res_75452;\n    \n    local_tid_77251 = get_local_id(0);\n    tblock_sizze_77254 = get_local_size(0);\n    wave_sizze_77253 = LOCKSTEP_WIDTH;\n    block_id_77252 = get_tblock_id(0);\n    global_tid_77250 = block_id_77252 * tblock_sizze_77254 + local_tid_77251;\n    tid_77249 = sext_i32_i64(global_tid_77250);\n    zp_lhs_75450 = ((__global int64_t *) ext_mem_75965)[(int64_t) 0];\n    n_pairs_t_res_75451 = ((__global int64_t *) ext_mem_75968)[(int64_t) 0];\n    n_pairs_t_res_75452 = add64(zp_lhs_75450, n_pairs_t_res_75451);\n    ((__global int64_t *) mem_75974)[(int64_t) 0] = n_pairs_t_res_75452;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzigpuseq_77296_dim1, 1, 1)\nvoid inner_SMJ_floatzigpuseq_77296(__global int *global_failure, int64_t loopres_65870, __global unsigned char *mem_param_76008, __global unsigned char *mem_param_76011, __global unsigned char *mem_param_76014, __global unsigned char *mem_76021, __global unsigned char *mem_76022, __global unsigned char *mem_76023)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77298;\n    int32_t tblock_sizze_77301;\n    int32_t wave_sizze_77300;\n    int32_t block_id_77299;\n    int32_t global_tid_77297;\n    int64_t tid_77296;\n    float loopres_75454;\n    ", "int64_t loopres_75456;\n    int64_t loopres_75458;\n    \n    local_tid_77298 = get_local_id(0);\n    tblock_sizze_77301 = get_local_size(0);\n    wave_sizze_77300 = LOCKSTEP_WIDTH;\n    block_id_77299 = get_tblock_id(0);\n    global_tid_77297 = block_id_77299 * tblock_sizze_77301 + local_tid_77298;\n    tid_77296 = sext_i32_i64(global_tid_77297);\n    loopres_75454 = ((__global float *) mem_param_76008)[loopres_65870];\n    loopres_75456 = ((__global int64_t *) mem_param_76011)[loopres_65870];\n    loopres_75458 = ((__global int64_t *) mem_param_76014)[loopres_65870];\n    ((__global float *) mem_76021)[(int64_t) 0] = loopres_75454;\n    ((__global int64_t *) mem_76022)[(int64_t) 0] = loopres_75456;\n    ((__global int64_t *) mem_76023)[(int64_t) 0] = loopres_75458;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_floatzireplicate_77303(int64_t loopres_65871, int64_t replicate_n_77302, int64_t virt_num_tblocks_77308, int64_t num_tblocks_77309, __global unsigned char *mem_76021, __global unsigned char *mem_76025)\n{\n    int32_t replicate_ltid_77304;\n    int32_t tblock_sizze_77306;\n    int32_t replicate_gid_77305;\n    int32_t replicate_gtid_77303;\n    int32_t phys_tblock_id_77310;\n    int32_t iterations_77311;\n    \n    replicate_ltid_77304 = get_local_id(0);\n    tblock_sizze_77306 = get_local_size(0);\n    replicate_gid_77305 = get_tblock_id(0);\n    replicate_gtid_77303 = replicate_gid_77305 * tblock_sizze_77306 + replicate_ltid_77304;\n    phys_tblock_id_77310 = get_tblock_id(0);\n    iterations_77311 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77308) - phys_tblock_id_77310, sext_i64_i32(num_tblocks_77309));\n    for (int32_t i_77312 = 0; i_77312 < iterations_77311; i_77312++) {\n        int32_t virt_tblock_id_77313;\n        int64_t global_tid_77314;\n        int64_t slice_77317;\n        int64_t slice_77318;\n        int64_t rep_i_77315;\n        int64_t remnant_77319;\n        int64_t rep_i_77316;\n        int64_t remnant_77320;\n        \n        virt_tblock_id_77313 = phys_tblock_",
                                    "id_77310 + i_77312 * sext_i64_i32(num_tblocks_77309);\n        global_tid_77314 = sext_i32_i64(virt_tblock_id_77313) * sext_i32_i64(tblock_sizze_77306) + sext_i32_i64(replicate_ltid_77304);\n        slice_77317 = (int64_t) 1;\n        slice_77318 = loopres_65871 * slice_77317;\n        rep_i_77315 = squot64(global_tid_77314, slice_77317);\n        remnant_77319 = global_tid_77314 - rep_i_77315 * slice_77317;\n        rep_i_77316 = remnant_77319;\n        remnant_77320 = remnant_77319 - rep_i_77316;\n        if (slt64(global_tid_77314, replicate_n_77302)) {\n            float tmp_77321 = ((__global float *) mem_76021)[rep_i_77316];\n            \n            ((__global float *) mem_76025)[rep_i_77315 + rep_i_77316] = tmp_77321;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_floatzireplicate_77323(int64_t loopres_65871, int64_t replicate_n_77322, int64_t virt_num_tblocks_77328, int64_t num_tblocks_77329, __global unsigned char *mem_76022, __global unsigned char *mem_76027)\n{\n    int32_t replicate_ltid_77324;\n    int32_t tblock_sizze_77326;\n    int32_t replicate_gid_77325;\n    int32_t replicate_gtid_77323;\n    int32_t phys_tblock_id_77330;\n    int32_t iterations_77331;\n    \n    replicate_ltid_77324 = get_local_id(0);\n    tblock_sizze_77326 = get_local_size(0);\n    replicate_gid_77325 = get_tblock_id(0);\n    replicate_gtid_77323 = replicate_gid_77325 * tblock_sizze_77326 + replicate_ltid_77324;\n    phys_tblock_id_77330 = get_tblock_id(0);\n    iterations_77331 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77328) - phys_tblock_id_77330, sext_i64_i32(num_tblocks_77329));\n    for (int32_t i_77332 = 0; i_77332 < iterations_77331; i_77332++) {\n        int32_t virt_tblock_id_77333;\n        int64_t global_tid_77334;\n        int64_t slice_77337;\n        int64_t slice_77338;\n        int64_t rep_i_77335;\n        int64_t remnant_77339;\n        int64_t rep_i_77336;\n        int64_t remnant_77340;\n        \n    ", "    virt_tblock_id_77333 = phys_tblock_id_77330 + i_77332 * sext_i64_i32(num_tblocks_77329);\n        global_tid_77334 = sext_i32_i64(virt_tblock_id_77333) * sext_i32_i64(tblock_sizze_77326) + sext_i32_i64(replicate_ltid_77324);\n        slice_77337 = (int64_t) 1;\n        slice_77338 = loopres_65871 * slice_77337;\n        rep_i_77335 = squot64(global_tid_77334, slice_77337);\n        remnant_77339 = global_tid_77334 - rep_i_77335 * slice_77337;\n        rep_i_77336 = remnant_77339;\n        remnant_77340 = remnant_77339 - rep_i_77336;\n        if (slt64(global_tid_77334, replicate_n_77322)) {\n            int64_t tmp_77341 = ((__global int64_t *) mem_76022)[rep_i_77336];\n            \n            ((__global int64_t *) mem_76027)[rep_i_77335 + rep_i_77336] = tmp_77341;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_71655_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_71655(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_52195, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t max_res_65013, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, int64_t zt_rhs_65019, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75495, __global unsigned char *mem_75504, __global unsigned char *mem_75506)\n{\n    #define segmap_tblock_sizze_71650 (inner_SMJ_floatzisegmap_71655zisegmap_tblock_sizze_71650)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76715;\n    int32_t tblock_sizze_76718;\n    int32_t wave_sizze_76717;\n    int32_t block_id_76716;\n    int32_t global_tid_76714;\n    int64_t phys_tid_71655;\n    int64_t global_tid_76719;\n    int64_t slice_76720;\n    int64_t gtid_71654;\n    int64_t remnant_76721;\n    \n    local_tid_76715 = get_local_id(0);\n    tblock_sizze_76718 = get_local", "_size(0);\n    wave_sizze_76717 = LOCKSTEP_WIDTH;\n    block_id_76716 = get_tblock_id(0);\n    global_tid_76714 = block_id_76716 * tblock_sizze_76718 + local_tid_76715;\n    phys_tid_71655 = sext_i32_i64(global_tid_76714);\n    global_tid_76719 = sext_i32_i64(block_id_76716) * segmap_tblock_sizze_71650 + sext_i32_i64(local_tid_76715);\n    slice_76720 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;\n    gtid_71654 = global_tid_76719;\n    remnant_76721 = global_tid_76719 - gtid_71654;\n    if (slt64(gtid_71654, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014)) {\n        float lowest_75411;\n        int64_t index_primexp_73897;\n        int64_t zs_lhs_71657;\n        int64_t index_71658;\n        bool cond_71659;\n        int64_t loop_over_71660;\n        int64_t loop_over_71661;\n        int64_t loop_over_71663;\n        bool defunc_0_f_res_71666;\n        int64_t defunc_0_f_res_71667;\n        int64_t defunc_0_f_res_71668;\n        int64_t defunc_0_f_res_71669;\n        bool loop_while_71670;\n        int64_t p_71671;\n        int64_t p_71672;\n        int64_t p_71673;\n        \n        lowest_75411 = ((__global float *) ext_mem_75495)[(int64_t) 0];\n        index_primexp_73897 = add64(max_res_65013, gtid_71654);\n        zs_lhs_71657 = mul64(zt_rhs_65019, index_primexp_73897);\n        index_71658 = sdiv64(zs_lhs_71657, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n        cond_71659 = slt64(nR_52195, index_71658);\n        if (cond_71659) {\n            loop_over_71660 = nR_52195;\n        } else {\n            loop_over_71660 = index_71658;\n        }\n        if (cond_71659) {\n            int64_t loop_over_t_res_71662 = sub64(index_71658, nR_52195);\n            \n            loop_over_71661 = loop_over_t_res_71662;\n        } else {\n            loop_over_71661 = (int64_t) 0;\n        }\n        if (cond_71659) {\n            int64_t zm_lhs_71664;\n            int64_t loop_over_t_res_71665;\n            \n            zm_lhs_71664 = sub64(index_71658, nR",
                                    "_52195);\n            loop_over_t_res_71665 = sub64(zm_lhs_71664, (int64_t) 1);\n            loop_over_71663 = loop_over_t_res_71665;\n        } else {\n            loop_over_71663 = (int64_t) 0;\n        }\n        loop_while_71670 = 1;\n        p_71671 = loop_over_71663;\n        p_71672 = loop_over_71660;\n        p_71673 = loop_over_71661;\n        while (loop_while_71670) {\n            int64_t zs_lhs_71674;\n            int64_t offset_71675;\n            int64_t ai_71676;\n            int64_t max_arg1_71677;\n            int64_t max_res_71678;\n            bool cond_71679;\n            float b_prev_71680;\n            bool cond_71688;\n            int64_t loopres_71689;\n            int64_t loopres_71690;\n            int64_t loopres_71691;\n            bool loopres_71692;\n            bool loop_while_tmp_76722;\n            int64_t p_tmp_76723;\n            int64_t p_tmp_76724;\n            int64_t p_tmp_76725;\n            \n            zs_lhs_71674 = sub64(p_71672, p_71671);\n            offset_71675 = sdiv64(zs_lhs_71674, (int64_t) 2);\n            ai_71676 = sub64(p_71672, offset_71675);\n            max_arg1_71677 = add64(p_71673, offset_71675);\n            max_res_71678 = smax64((int64_t) 0, max_arg1_71677);\n            cond_71679 = slt64((int64_t) 0, max_res_71678);\n            if (cond_71679) {\n                int64_t tmp_71681;\n                bool x_71682;\n                bool y_71683;\n                bool bounds_check_71684;\n                bool index_certs_71685;\n                int64_t slice_71686;\n                float b_prev_t_res_71687;\n                \n                tmp_71681 = sub64(max_res_71678, (int64_t) 1);\n                x_71682 = sle64((int64_t) 0, tmp_71681);\n                y_71683 = slt64(tmp_71681, nR_52195);\n                bounds_check_71684 = x_71682 && y_71683;\n                if (!bounds_check_71684) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 44) == -1) {\n                            global_failure_ar", "gs[0] = (int64_t) tmp_71681;\n                            global_failure_args[1] = (int64_t) nR_52195;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_71686 = tS_start_64840 + tmp_71681;\n                b_prev_t_res_71687 = ((__global float *) tS_mem_75468)[slice_71686];\n                b_prev_71680 = b_prev_t_res_71687;\n            } else {\n                b_prev_71680 = lowest_75411;\n            }\n            cond_71688 = sle64(ai_71676, (int64_t) 0);\n            if (cond_71688) {\n                loopres_71689 = p_71671;\n                loopres_71690 = (int64_t) 0;\n                loopres_71691 = max_res_71678;\n                loopres_71692 = 0;\n            } else {\n                bool cond_71693;\n                int64_t loopres_f_res_71694;\n                int64_t loopres_f_res_71695;\n                int64_t loopres_f_res_71696;\n                bool loopres_f_res_71697;\n                \n                cond_71693 = sle64(nR_52195, max_res_71678);\n                if (cond_71693) {\n                    int64_t min_arg1_71698;\n                    int64_t min_res_71699;\n                    bool x_71700;\n                    bool y_71701;\n                    bool bounds_check_71702;\n                    bool index_certs_71703;\n                    bool x_71706;\n                    bool y_71707;\n                    bool bounds_check_71708;\n                    bool index_certs_71709;\n                    int64_t slice_71704;\n                    float leq_lhs_71705;\n                    float leq_rhs_71710;\n                    bool defunc_0_leq_res_71711;\n                    int64_t loopres_f_res_t_res_71712;\n                    bool x_71713;\n                    int64_t loopres_f_res_t_res_71714;\n                    \n                    min_arg1_71698 = sub64(nR_52195, (int64_t) 1);\n                    min_res_71699 = smin64(ai_71676, min_arg1_71698);\n                    x_717", "00 = sle64((int64_t) 0, min_arg1_71698);\n                    y_71701 = slt64(min_arg1_71698, nR_52195);\n                    bounds_check_71702 = x_71700 && y_71701;\n                    if (!bounds_check_71702) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 45) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_71698;\n                                global_failure_args[1] = (int64_t) nR_52195;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_71706 = sle64((int64_t) 0, min_res_71699);\n                    y_71707 = slt64(min_res_71699, nR_52195);\n                    bounds_check_71708 = x_71706 && y_71707;\n                    if (!bounds_check_71708) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 46) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_71699;\n                                global_failure_args[1] = (int64_t) nR_52195;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_71704 = tS_start_64840 + min_arg1_71698;\n                    leq_lhs_71705 = ((__global float *) tS_mem_75468)[slice_71704];\n                    leq_rhs_71710 = ((__global float *) tR_mem_75467)[min_res_71699];\n                    defunc_0_leq_res_71711 = leq_lhs_71705 <= leq_rhs_71710;\n                    if (defunc_0_leq_res_71711) {\n                        loopres_f_res_t_res_71712 = ai_71676;\n                    } else {\n                        loopres_f_res_t_res_71712 = p_71672;\n                    }\n                    x_71713 = !defunc_0_leq_res_71711;\n                    if (defunc_0_leq_res_71711) {\n                        loopres_f_res_t_res_71714 = nR_52195;",
                                    "\n                    } else {\n                        int64_t tmp_71715 = sub64(min_arg1_71698, offset_71675);\n                        \n                        loopres_f_res_t_res_71714 = tmp_71715;\n                    }\n                    loopres_f_res_71694 = p_71671;\n                    loopres_f_res_71695 = loopres_f_res_t_res_71712;\n                    loopres_f_res_71696 = loopres_f_res_t_res_71714;\n                    loopres_f_res_71697 = x_71713;\n                } else {\n                    bool cond_71716;\n                    int64_t loopres_f_res_f_res_71717;\n                    int64_t loopres_f_res_f_res_71718;\n                    int64_t loopres_f_res_f_res_71719;\n                    bool loopres_f_res_f_res_71720;\n                    \n                    cond_71716 = sle64(nR_52195, ai_71676);\n                    if (cond_71716) {\n                        int64_t min_arg1_71721;\n                        int64_t min_res_71722;\n                        bool x_71723;\n                        bool y_71724;\n                        bool bounds_check_71725;\n                        bool index_certs_71726;\n                        bool x_71728;\n                        bool y_71729;\n                        bool bounds_check_71730;\n                        bool index_certs_71731;\n                        float leq_lhs_71727;\n                        int64_t slice_71732;\n                        float leq_rhs_71733;\n                        bool defunc_0_leq_res_71734;\n                        int64_t loopres_f_res_f_res_t_res_71735;\n                        bool x_71736;\n                        int64_t loopres_f_res_f_res_t_res_71737;\n                        \n                        min_arg1_71721 = sub64(nR_52195, (int64_t) 1);\n                        min_res_71722 = smin64(max_res_71678, min_arg1_71721);\n                        x_71723 = sle64((int64_t) 0, min_arg1_71721);\n                        y_71724 = slt64(min_arg1_71721, nR_52195);\n                        bounds_c", "heck_71725 = x_71723 && y_71724;\n                        if (!bounds_check_71725) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 47) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_71721;\n                                    global_failure_args[1] = (int64_t) nR_52195;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_71728 = sle64((int64_t) 0, min_res_71722);\n                        y_71729 = slt64(min_res_71722, nR_52195);\n                        bounds_check_71730 = x_71728 && y_71729;\n                        if (!bounds_check_71730) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 48) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_71722;\n                                    global_failure_args[1] = (int64_t) nR_52195;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_71727 = ((__global float *) tR_mem_75467)[min_arg1_71721];\n                        slice_71732 = tS_start_64840 + min_res_71722;\n                        leq_rhs_71733 = ((__global float *) tS_mem_75468)[slice_71732];\n                        defunc_0_leq_res_71734 = leq_lhs_71727 <= leq_rhs_71733;\n                        if (defunc_0_leq_res_71734) {\n                            loopres_f_res_f_res_t_res_71735 = max_res_71678;\n                        } else {\n                            loopres_f_res_f_res_t_res_71735 = p_71673;\n                        }\n                        x_71736 = !defunc_0_leq_res_71734;\n                        if (defunc_0_leq_res_71734) {\n                            loopres_f_re", "s_f_res_t_res_71737 = nR_52195;\n                        } else {\n                            loopres_f_res_f_res_t_res_71737 = min_arg1_71721;\n                        }\n                        loopres_f_res_f_res_71717 = p_71671;\n                        loopres_f_res_f_res_71718 = loopres_f_res_f_res_t_res_71737;\n                        loopres_f_res_f_res_71719 = loopres_f_res_f_res_t_res_71735;\n                        loopres_f_res_f_res_71720 = x_71736;\n                    } else {\n                        bool cond_71738;\n                        int64_t loopres_f_res_f_res_f_res_71739;\n                        int64_t loopres_f_res_f_res_f_res_71740;\n                        int64_t loopres_f_res_f_res_f_res_71741;\n                        bool loopres_f_res_f_res_f_res_71742;\n                        \n                        cond_71738 = sle64(p_71672, p_71671);\n                        if (cond_71738) {\n                            bool cond_71743;\n                            int64_t ai_71744;\n                            bool x_71757;\n                            bool y_71758;\n                            bool bounds_check_71759;\n                            bool index_certs_71760;\n                            float b_prev_71746;\n                            float gt_lhs_71761;\n                            bool defunc_0_gt_res_71762;\n                            int64_t defunc_0_partFunc_sequential_search_res_71763;\n                            int64_t defunc_0_partFunc_sequential_search_res_71764;\n                            \n                            cond_71743 = slt64(ai_71676, nR_52195);\n                            if (cond_71743) {\n                                ai_71744 = ai_71676;\n                            } else {\n                                int64_t ai_f_res_71745 = sub64(nR_52195, (int64_t) 1);\n                                \n                                ai_71744 = ai_f_res_71745;\n                            }\n                            x_71757 = sle64",
                                    "((int64_t) 0, ai_71744);\n                            y_71758 = slt64(ai_71744, nR_52195);\n                            bounds_check_71759 = x_71757 && y_71758;\n                            if (!bounds_check_71759) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 49) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_71744;\n                                        global_failure_args[1] = (int64_t) nR_52195;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_71679) {\n                                int64_t tmp_71747;\n                                bool x_71748;\n                                bool y_71749;\n                                bool bounds_check_71750;\n                                bool index_certs_71751;\n                                int64_t slice_71752;\n                                float b_prev_t_res_71753;\n                                \n                                tmp_71747 = sub64(max_res_71678, (int64_t) 1);\n                                x_71748 = sle64((int64_t) 0, tmp_71747);\n                                y_71749 = slt64(tmp_71747, nR_52195);\n                                bounds_check_71750 = x_71748 && y_71749;\n                                if (!bounds_check_71750) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 50) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_71747;\n                                            global_failure_args[1] = (int64_t) nR_52195;\n                                            ;\n                                        }\n                                        return;\n                                    }\n ", "                               }\n                                slice_71752 = tS_start_64840 + tmp_71747;\n                                b_prev_t_res_71753 = ((__global float *) tS_mem_75468)[slice_71752];\n                                b_prev_71746 = b_prev_t_res_71753;\n                            } else {\n                                bool y_71754;\n                                bool index_certs_71755;\n                                float b_prev_f_res_71756;\n                                \n                                y_71754 = slt64((int64_t) 0, nR_52195);\n                                if (!y_71754) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 51) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_52195;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_71756 = ((__global float *) tS_mem_75468)[tS_start_64840];\n                                b_prev_71746 = b_prev_f_res_71756;\n                            }\n                            gt_lhs_71761 = ((__global float *) tR_mem_75467)[ai_71744];\n                            defunc_0_gt_res_71762 = b_prev_71746 < gt_lhs_71761;\n                            if (defunc_0_gt_res_71762) {\n                                int64_t zl_rhs_71765;\n                                bool loop_cond_71766;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_71767;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_71768;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_71769;\n                                in", "t64_t defunc_0_partFunc_sequential_search_res_t_res_71770;\n                                bool loop_while_71771;\n                                int64_t p_71772;\n                                int64_t p_71773;\n                                int64_t p_71774;\n                                \n                                zl_rhs_71765 = sub64(nR_52195, max_res_71678);\n                                loop_cond_71766 = slt64((int64_t) 0, zl_rhs_71765);\n                                loop_while_71771 = loop_cond_71766;\n                                p_71772 = ai_71744;\n                                p_71773 = max_res_71678;\n                                p_71774 = (int64_t) 0;\n                                while (loop_while_71771) {\n                                    int64_t i_a_71775;\n                                    int64_t i_b_71776;\n                                    int64_t leq_lhs_71777;\n                                    bool x_71778;\n                                    bool y_71779;\n                                    bool bounds_check_71780;\n                                    bool index_certs_71781;\n                                    bool x_71783;\n                                    bool y_71784;\n                                    bool bounds_check_71785;\n                                    bool index_certs_71786;\n                                    float leq_lhs_71782;\n                                    int64_t slice_71787;\n                                    float leq_rhs_71788;\n                                    bool defunc_0_leq_res_71789;\n                                    int64_t loopres_71790;\n                                    int64_t loopres_71791;\n                                    int64_t loopres_71792;\n                                    bool loop_cond_71794;\n                                    bool loop_while_tmp_76726;\n                                    int64_t p_tmp_76727;\n                                    int64_t p_tmp_",
                                    "76728;\n                                    int64_t p_tmp_76729;\n                                    \n                                    i_a_71775 = sub64(ai_71744, p_71774);\n                                    i_b_71776 = add64(max_res_71678, p_71774);\n                                    leq_lhs_71777 = sub64(i_a_71775, (int64_t) 1);\n                                    x_71778 = sle64((int64_t) 0, leq_lhs_71777);\n                                    y_71779 = slt64(leq_lhs_71777, nR_52195);\n                                    bounds_check_71780 = x_71778 && y_71779;\n                                    if (!bounds_check_71780) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 52) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_71777;\n                                                global_failure_args[1] = (int64_t) nR_52195;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_71783 = sle64((int64_t) 0, i_b_71776);\n                                    y_71784 = slt64(i_b_71776, nR_52195);\n                                    bounds_check_71785 = x_71783 && y_71784;\n                                    if (!bounds_check_71785) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 53) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_71776;\n                                                global_failure_args[1] = (int64_t) nR_52195;\n                                                ;\n                                            }\n                                            return;\n                     ", "                   }\n                                    }\n                                    leq_lhs_71782 = ((__global float *) tR_mem_75467)[leq_lhs_71777];\n                                    slice_71787 = tS_start_64840 + i_b_71776;\n                                    leq_rhs_71788 = ((__global float *) tS_mem_75468)[slice_71787];\n                                    defunc_0_leq_res_71789 = leq_lhs_71782 <= leq_rhs_71788;\n                                    if (defunc_0_leq_res_71789) {\n                                        loopres_71790 = i_a_71775;\n                                    } else {\n                                        loopres_71790 = ai_71744;\n                                    }\n                                    if (defunc_0_leq_res_71789) {\n                                        loopres_71791 = i_b_71776;\n                                    } else {\n                                        loopres_71791 = max_res_71678;\n                                    }\n                                    if (defunc_0_leq_res_71789) {\n                                        loopres_71792 = zl_rhs_71765;\n                                    } else {\n                                        int64_t tmp_71793 = add64((int64_t) 1, p_71774);\n                                        \n                                        loopres_71792 = tmp_71793;\n                                    }\n                                    loop_cond_71794 = slt64(loopres_71792, zl_rhs_71765);\n                                    loop_while_tmp_76726 = loop_cond_71794;\n                                    p_tmp_76727 = loopres_71790;\n                                    p_tmp_76728 = loopres_71791;\n                                    p_tmp_76729 = loopres_71792;\n                                    loop_while_71771 = loop_while_tmp_76726;\n                                    p_71772 = p_tmp_76727;\n                                    p_71773 = p_tmp_76728;\n                           ", "         p_71774 = p_tmp_76729;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_71767 = loop_while_71771;\n                                defunc_0_partFunc_sequential_search_res_t_res_71768 = p_71772;\n                                defunc_0_partFunc_sequential_search_res_t_res_71769 = p_71773;\n                                defunc_0_partFunc_sequential_search_res_t_res_71770 = p_71774;\n                                defunc_0_partFunc_sequential_search_res_71763 = defunc_0_partFunc_sequential_search_res_t_res_71768;\n                                defunc_0_partFunc_sequential_search_res_71764 = defunc_0_partFunc_sequential_search_res_t_res_71769;\n                            } else {\n                                int64_t zl_rhs_71795;\n                                bool loop_cond_71796;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_71797;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71798;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71799;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_71800;\n                                bool loop_while_71801;\n                                int64_t p_71802;\n                                int64_t p_71803;\n                                int64_t p_71804;\n                                \n                                zl_rhs_71795 = sub64(max_res_71678, (int64_t) 1);\n                                loop_cond_71796 = slt64((int64_t) 0, zl_rhs_71795);\n                                loop_while_71801 = loop_cond_71796;\n                                p_71802 = ai_71744;\n                                p_71803 = max_res_71678;\n                                p_71804 = (int64_t) 0;\n                                while (loop_while_71801) {\n                                    int64_t zp_lhs_71805;\n               ",
                                    "                     int64_t hi_a_71806;\n                                    bool cond_71807;\n                                    int64_t i_a_71808;\n                                    int64_t zm_lhs_71810;\n                                    int64_t i_b_71811;\n                                    bool x_71812;\n                                    bool y_71813;\n                                    bool bounds_check_71814;\n                                    bool index_certs_71815;\n                                    bool x_71817;\n                                    bool y_71818;\n                                    bool bounds_check_71819;\n                                    bool index_certs_71820;\n                                    float gt_lhs_71816;\n                                    int64_t slice_71821;\n                                    float gt_rhs_71822;\n                                    bool defunc_0_gt_res_71823;\n                                    int64_t loopres_71824;\n                                    int64_t loopres_71825;\n                                    int64_t loopres_71826;\n                                    bool loop_cond_71828;\n                                    bool loop_while_tmp_76730;\n                                    int64_t p_tmp_76731;\n                                    int64_t p_tmp_76732;\n                                    int64_t p_tmp_76733;\n                                    \n                                    zp_lhs_71805 = add64(ai_71744, p_71804);\n                                    hi_a_71806 = add64((int64_t) 1, zp_lhs_71805);\n                                    cond_71807 = slt64(hi_a_71806, nR_52195);\n                                    if (cond_71807) {\n                                        i_a_71808 = hi_a_71806;\n                                    } else {\n                                        int64_t i_a_f_res_71809 = sub64(nR_52195, (int64_t) 1);\n                                        \n                   ", "                     i_a_71808 = i_a_f_res_71809;\n                                    }\n                                    zm_lhs_71810 = sub64(max_res_71678, p_71804);\n                                    i_b_71811 = sub64(zm_lhs_71810, (int64_t) 1);\n                                    x_71812 = sle64((int64_t) 0, i_a_71808);\n                                    y_71813 = slt64(i_a_71808, nR_52195);\n                                    bounds_check_71814 = x_71812 && y_71813;\n                                    if (!bounds_check_71814) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 54) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_71808;\n                                                global_failure_args[1] = (int64_t) nR_52195;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_71817 = sle64((int64_t) 0, i_b_71811);\n                                    y_71818 = slt64(i_b_71811, nR_52195);\n                                    bounds_check_71819 = x_71817 && y_71818;\n                                    if (!bounds_check_71819) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 55) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_71811;\n                                                global_failure_args[1] = (int64_t) nR_52195;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt", "_lhs_71816 = ((__global float *) tR_mem_75467)[i_a_71808];\n                                    slice_71821 = tS_start_64840 + i_b_71811;\n                                    gt_rhs_71822 = ((__global float *) tS_mem_75468)[slice_71821];\n                                    defunc_0_gt_res_71823 = gt_rhs_71822 < gt_lhs_71816;\n                                    if (defunc_0_gt_res_71823) {\n                                        loopres_71824 = i_a_71808;\n                                    } else {\n                                        loopres_71824 = ai_71744;\n                                    }\n                                    if (defunc_0_gt_res_71823) {\n                                        loopres_71825 = zm_lhs_71810;\n                                    } else {\n                                        loopres_71825 = max_res_71678;\n                                    }\n                                    if (defunc_0_gt_res_71823) {\n                                        loopres_71826 = zl_rhs_71795;\n                                    } else {\n                                        int64_t tmp_71827 = add64((int64_t) 1, p_71804);\n                                        \n                                        loopres_71826 = tmp_71827;\n                                    }\n                                    loop_cond_71828 = slt64(loopres_71826, zl_rhs_71795);\n                                    loop_while_tmp_76730 = loop_cond_71828;\n                                    p_tmp_76731 = loopres_71824;\n                                    p_tmp_76732 = loopres_71825;\n                                    p_tmp_76733 = loopres_71826;\n                                    loop_while_71801 = loop_while_tmp_76730;\n                                    p_71802 = p_tmp_76731;\n                                    p_71803 = p_tmp_76732;\n                                    p_71804 = p_tmp_76733;\n                                }\n                                defunc_0_",
                                    "partFunc_sequential_search_res_f_res_71797 = loop_while_71801;\n                                defunc_0_partFunc_sequential_search_res_f_res_71798 = p_71802;\n                                defunc_0_partFunc_sequential_search_res_f_res_71799 = p_71803;\n                                defunc_0_partFunc_sequential_search_res_f_res_71800 = p_71804;\n                                defunc_0_partFunc_sequential_search_res_71763 = defunc_0_partFunc_sequential_search_res_f_res_71798;\n                                defunc_0_partFunc_sequential_search_res_71764 = defunc_0_partFunc_sequential_search_res_f_res_71799;\n                            }\n                            loopres_f_res_f_res_f_res_71739 = p_71671;\n                            loopres_f_res_f_res_f_res_71740 = defunc_0_partFunc_sequential_search_res_71763;\n                            loopres_f_res_f_res_f_res_71741 = defunc_0_partFunc_sequential_search_res_71764;\n                            loopres_f_res_f_res_f_res_71742 = 0;\n                        } else {\n                            bool x_71829;\n                            bool y_71830;\n                            bool bounds_check_71831;\n                            bool index_certs_71832;\n                            float gt_lhs_71833;\n                            bool defunc_0_gt_res_71834;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71835;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71836;\n                            int64_t loopres_f_res_f_res_f_res_f_res_71837;\n                            bool loopres_f_res_f_res_f_res_f_res_71838;\n                            \n                            x_71829 = sle64((int64_t) 0, ai_71676);\n                            y_71830 = slt64(ai_71676, nR_52195);\n                            bounds_check_71831 = x_71829 && y_71830;\n                            if (!bounds_check_71831) {\n                                {\n                                    if (atomic_cmpxchg_i32_", "global(global_failure, -1, 56) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_71676;\n                                        global_failure_args[1] = (int64_t) nR_52195;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_71833 = ((__global float *) tR_mem_75467)[ai_71676];\n                            defunc_0_gt_res_71834 = b_prev_71680 < gt_lhs_71833;\n                            if (defunc_0_gt_res_71834) {\n                                int64_t leq_lhs_71839;\n                                bool x_71840;\n                                bool y_71841;\n                                bool bounds_check_71842;\n                                bool index_certs_71843;\n                                bool x_71845;\n                                bool y_71846;\n                                bool bounds_check_71847;\n                                bool index_certs_71848;\n                                float leq_lhs_71844;\n                                int64_t slice_71849;\n                                float leq_rhs_71850;\n                                bool defunc_0_leq_res_71851;\n                                bool x_71852;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_71853;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_71854;\n                                \n                                leq_lhs_71839 = sub64(ai_71676, (int64_t) 1);\n                                x_71840 = sle64((int64_t) 0, leq_lhs_71839);\n                                y_71841 = slt64(leq_lhs_71839, nR_52195);\n                                bounds_check_71842 = x_71840 && y_71841;\n                                if (!bounds_check_71842) {\n                                    {\n                                        if ", "(atomic_cmpxchg_i32_global(global_failure, -1, 57) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_71839;\n                                            global_failure_args[1] = (int64_t) nR_52195;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_71845 = sle64((int64_t) 0, max_res_71678);\n                                y_71846 = slt64(max_res_71678, nR_52195);\n                                bounds_check_71847 = x_71845 && y_71846;\n                                if (!bounds_check_71847) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 58) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_71678;\n                                            global_failure_args[1] = (int64_t) nR_52195;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_71844 = ((__global float *) tR_mem_75467)[leq_lhs_71839];\n                                slice_71849 = tS_start_64840 + max_res_71678;\n                                leq_rhs_71850 = ((__global float *) tS_mem_75468)[slice_71849];\n                                defunc_0_leq_res_71851 = leq_lhs_71844 <= leq_rhs_71850;\n                                x_71852 = !defunc_0_leq_res_71851;\n                                if (defunc_0_leq_res_71851) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_71853 = ai_71676;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_71853 = leq_lhs_71839;\n              ",
                                    "                  }\n                                if (defunc_0_leq_res_71851) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_71854 = max_res_71678;\n                                } else {\n                                    int64_t tmp_71855 = add64((int64_t) 1, max_res_71678);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_71854 = tmp_71855;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_71835 = p_71671;\n                                loopres_f_res_f_res_f_res_f_res_71836 = loopres_f_res_f_res_f_res_f_res_t_res_71853;\n                                loopres_f_res_f_res_f_res_f_res_71837 = loopres_f_res_f_res_f_res_f_res_t_res_71854;\n                                loopres_f_res_f_res_f_res_f_res_71838 = x_71852;\n                            } else {\n                                int64_t tmp_71856 = add64((int64_t) 1, ai_71676);\n                                \n                                loopres_f_res_f_res_f_res_f_res_71835 = tmp_71856;\n                                loopres_f_res_f_res_f_res_f_res_71836 = p_71672;\n                                loopres_f_res_f_res_f_res_f_res_71837 = p_71673;\n                                loopres_f_res_f_res_f_res_f_res_71838 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_71739 = loopres_f_res_f_res_f_res_f_res_71835;\n                            loopres_f_res_f_res_f_res_71740 = loopres_f_res_f_res_f_res_f_res_71836;\n                            loopres_f_res_f_res_f_res_71741 = loopres_f_res_f_res_f_res_f_res_71837;\n                            loopres_f_res_f_res_f_res_71742 = loopres_f_res_f_res_f_res_f_res_71838;\n                        }\n                        loopres_f_res_f_res_71717 = loopres_f_res_f_res_f_res_71739;\n                        loopres_f_res_f_res_71718 = loopres_f_res_f_res_f_res_71740;\n                        loo", "pres_f_res_f_res_71719 = loopres_f_res_f_res_f_res_71741;\n                        loopres_f_res_f_res_71720 = loopres_f_res_f_res_f_res_71742;\n                    }\n                    loopres_f_res_71694 = loopres_f_res_f_res_71717;\n                    loopres_f_res_71695 = loopres_f_res_f_res_71718;\n                    loopres_f_res_71696 = loopres_f_res_f_res_71719;\n                    loopres_f_res_71697 = loopres_f_res_f_res_71720;\n                }\n                loopres_71689 = loopres_f_res_71694;\n                loopres_71690 = loopres_f_res_71695;\n                loopres_71691 = loopres_f_res_71696;\n                loopres_71692 = loopres_f_res_71697;\n            }\n            loop_while_tmp_76722 = loopres_71692;\n            p_tmp_76723 = loopres_71689;\n            p_tmp_76724 = loopres_71690;\n            p_tmp_76725 = loopres_71691;\n            loop_while_71670 = loop_while_tmp_76722;\n            p_71671 = p_tmp_76723;\n            p_71672 = p_tmp_76724;\n            p_71673 = p_tmp_76725;\n        }\n        defunc_0_f_res_71666 = loop_while_71670;\n        defunc_0_f_res_71667 = p_71671;\n        defunc_0_f_res_71668 = p_71672;\n        defunc_0_f_res_71669 = p_71673;\n        ((__global int64_t *) mem_75504)[gtid_71654] = defunc_0_f_res_71668;\n        ((__global int64_t *) mem_75506)[gtid_71654] = defunc_0_f_res_71669;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71650\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72029_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72029(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_52195, int64_t gt_rhs_64823, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t zeze_rhs_65256, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75486, __global unsigned char *mem_75488, __global unsigned char *mem_75522, __global unsigned char *mem_75524)\n{\n  ", "  #define segmap_tblock_sizze_72024 (inner_SMJ_floatzisegmap_72029zisegmap_tblock_sizze_72024)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76738;\n    int32_t tblock_sizze_76741;\n    int32_t wave_sizze_76740;\n    int32_t block_id_76739;\n    int32_t global_tid_76737;\n    int64_t phys_tid_72029;\n    int64_t global_tid_76742;\n    int64_t slice_76743;\n    int64_t gtid_72028;\n    int64_t remnant_76744;\n    \n    local_tid_76738 = get_local_id(0);\n    tblock_sizze_76741 = get_local_size(0);\n    wave_sizze_76740 = LOCKSTEP_WIDTH;\n    block_id_76739 = get_tblock_id(0);\n    global_tid_76737 = block_id_76739 * tblock_sizze_76741 + local_tid_76738;\n    phys_tid_72029 = sext_i32_i64(global_tid_76737);\n    global_tid_76742 = sext_i32_i64(block_id_76739) * segmap_tblock_sizze_72024 + sext_i32_i64(local_tid_76738);\n    slice_76743 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n    gtid_72028 = global_tid_76742;\n    remnant_76744 = global_tid_76742 - gtid_72028;\n    if (slt64(gtid_72028, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982)) {\n        int64_t eta_p_72031;\n        int64_t min_res_72032;\n        bool x_72033;\n        bool y_72034;\n        bool bounds_check_72035;\n        bool index_certs_72036;\n        bool cond_72038;\n        int64_t ri_next_72039;\n        int64_t max_arg1_72046;\n        int64_t max_res_72047;\n        bool x_72048;\n        bool y_72049;\n        bool bounds_check_72050;\n        bool index_certs_72051;\n        float r_min_72037;\n        float r_max_72052;\n        bool defunc_0_f_res_72053;\n        int64_t defunc_0_f_res_72054;\n        bool loop_while_72055;\n        int64_t fm_72056;\n        bool defunc_0_f_res_72122;\n        int64_t defunc_0_f_res_72123;\n        bool loop_while_72124;\n        int64_t lm_72125;\n        \n        eta_p_72031 = ((__global int64_t *) mem_75486)[gtid_72028];\n        min_res_72032 = smin64(gt_rhs_64823, eta_p_72031);\n        x_72033 = sle64((int64_t) 0, min_re",
                                    "s_72032);\n        y_72034 = slt64(min_res_72032, nR_52195);\n        bounds_check_72035 = x_72033 && y_72034;\n        if (!bounds_check_72035) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 59) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_72032;\n                    global_failure_args[1] = (int64_t) nR_52195;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_72038 = gtid_72028 == zeze_rhs_65256;\n        if (cond_72038) {\n            ri_next_72039 = nR_52195;\n        } else {\n            int64_t tmp_72040;\n            bool x_72041;\n            bool y_72042;\n            bool bounds_check_72043;\n            bool index_certs_72044;\n            int64_t ri_next_f_res_72045;\n            \n            tmp_72040 = add64((int64_t) 1, gtid_72028);\n            x_72041 = sle64((int64_t) 0, tmp_72040);\n            y_72042 = slt64(tmp_72040, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_72043 = x_72041 && y_72042;\n            if (!bounds_check_72043) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 60) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_72040;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_72045 = ((__global int64_t *) mem_75486)[tmp_72040];\n            ri_next_72039 = ri_next_f_res_72045;\n        }\n        max_arg1_72046 = sub64(ri_next_72039, (int64_t) 1);\n        max_res_72047 = smax64((int64_t) 0, max_arg1_72046);\n        x_72048 = sle64((int64_t) 0, max_res_72047);\n        y_72049 = slt64(max_res_72047, nR_52195);\n        bounds_check_72050 = x_72048 && y_72049;\n        if (!bounds_check_72050) {\n            {\n                if (a", "tomic_cmpxchg_i32_global(global_failure, -1, 61) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_72047;\n                    global_failure_args[1] = (int64_t) nR_52195;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_72037 = ((__global float *) tR_mem_75467)[min_res_72032];\n        r_max_72052 = ((__global float *) tR_mem_75467)[max_res_72047];\n        loop_while_72055 = 1;\n        fm_72056 = gtid_72028;\n        while (loop_while_72055) {\n            bool x_72057;\n            bool y_72058;\n            bool bounds_check_72059;\n            bool index_certs_72060;\n            int64_t loopres_72061;\n            int64_t min_res_72062;\n            bool x_72063;\n            bool y_72064;\n            bool bounds_check_72065;\n            bool index_certs_72066;\n            bool cond_72069;\n            int64_t si_next_72070;\n            int64_t max_arg1_72077;\n            int64_t max_res_72078;\n            bool x_72079;\n            bool y_72080;\n            bool bounds_check_72081;\n            bool index_certs_72082;\n            int64_t min_res_72085;\n            bool x_72086;\n            bool y_72087;\n            bool bounds_check_72088;\n            bool index_certs_72089;\n            int64_t max_arg1_72092;\n            int64_t max_res_72093;\n            bool x_72094;\n            bool y_72095;\n            bool bounds_check_72096;\n            bool index_certs_72097;\n            int64_t slice_72067;\n            float s_min_72068;\n            int64_t slice_72083;\n            int64_t slice_72090;\n            int64_t slice_72098;\n            bool defunc_0_gt_res_72100;\n            bool loopres_72101;\n            int64_t loopres_72102;\n            bool loop_while_tmp_76745;\n            int64_t fm_tmp_76746;\n            \n            x_72057 = sle64((int64_t) 0, fm_72056);\n            y_72058 = slt64(fm_72056, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_72", "059 = x_72057 && y_72058;\n            if (!bounds_check_72059) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 62) == -1) {\n                        global_failure_args[0] = (int64_t) fm_72056;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_72061 = ((__global int64_t *) mem_75488)[fm_72056];\n            min_res_72062 = smin64(gt_rhs_64823, loopres_72061);\n            x_72063 = sle64((int64_t) 0, min_res_72062);\n            y_72064 = slt64(min_res_72062, nR_52195);\n            bounds_check_72065 = x_72063 && y_72064;\n            if (!bounds_check_72065) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 63) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72062;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_72069 = sle64(zeze_rhs_65256, fm_72056);\n            if (cond_72069) {\n                si_next_72070 = nR_52195;\n            } else {\n                int64_t tmp_72071;\n                bool x_72072;\n                bool y_72073;\n                bool bounds_check_72074;\n                bool index_certs_72075;\n                int64_t si_next_f_res_72076;\n                \n                tmp_72071 = add64((int64_t) 1, fm_72056);\n                x_72072 = sle64((int64_t) 0, tmp_72071);\n                y_72073 = slt64(tmp_72071, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_72074 = x_72072 && y_72073;\n                if (!bounds_check_72074) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 64) == -1) {\n           ",
                                    "                 global_failure_args[0] = (int64_t) tmp_72071;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_72076 = ((__global int64_t *) mem_75488)[tmp_72071];\n                si_next_72070 = si_next_f_res_72076;\n            }\n            max_arg1_72077 = sub64(si_next_72070, (int64_t) 1);\n            max_res_72078 = smax64(min_res_72062, max_arg1_72077);\n            x_72079 = sle64((int64_t) 0, max_res_72078);\n            y_72080 = slt64(max_res_72078, nR_52195);\n            bounds_check_72081 = x_72079 && y_72080;\n            if (!bounds_check_72081) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 65) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72078;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_72085 = smin64(zeze_rhs_65256, si_next_72070);\n            x_72086 = sle64((int64_t) 0, min_res_72085);\n            y_72087 = slt64(min_res_72085, nR_52195);\n            bounds_check_72088 = x_72086 && y_72087;\n            if (!bounds_check_72088) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 66) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72085;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_72092 = sub64(min_res_72062, (int64_t) 1);\n            max_res_72093 = smax64((int64_t) 0, max_arg1_72092);\n            x_72094 = sle64((int64_t) 0, max_res_72093);\n            y_72095 = slt64(max_r", "es_72093, nR_52195);\n            bounds_check_72096 = x_72094 && y_72095;\n            if (!bounds_check_72096) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 67) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72093;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_72067 = tS_start_64840 + min_res_72062;\n            s_min_72068 = ((__global float *) tS_mem_75468)[slice_72067];\n            slice_72083 = tS_start_64840 + max_res_72078;\n            slice_72090 = tS_start_64840 + min_res_72085;\n            slice_72098 = tS_start_64840 + max_res_72093;\n            defunc_0_gt_res_72100 = s_min_72068 < r_min_72037;\n            if (defunc_0_gt_res_72100) {\n                float s_max_72084;\n                bool defunc_0_leq_res_72103;\n                bool loopres_t_res_72104;\n                int64_t loopres_t_res_72105;\n                \n                s_max_72084 = ((__global float *) tS_mem_75468)[slice_72083];\n                defunc_0_leq_res_72103 = r_min_72037 <= s_max_72084;\n                if (defunc_0_leq_res_72103) {\n                    loopres_t_res_72104 = 0;\n                    loopres_t_res_72105 = fm_72056;\n                } else {\n                    float s_nextMin_72091;\n                    bool defunc_0_leq_res_72106;\n                    int64_t zgze_lhs_72107;\n                    bool tmp_f_res_72108;\n                    bool x_72109;\n                    bool y_72110;\n                    bool tmp_72111;\n                    bool loopres_t_res_f_res_72112;\n                    \n                    s_nextMin_72091 = ((__global float *) tS_mem_75468)[slice_72090];\n                    defunc_0_leq_res_72106 = r_min_72037 <= s_nextMin_72091;\n                    zgze_lhs_72107 = add64((int64_t) 1, fm_72056);\n                    tmp_f_res_72108 = sle", "64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zgze_lhs_72107);\n                    x_72109 = !defunc_0_leq_res_72106;\n                    y_72110 = tmp_f_res_72108 && x_72109;\n                    tmp_72111 = defunc_0_leq_res_72106 || y_72110;\n                    loopres_t_res_f_res_72112 = !tmp_72111;\n                    loopres_t_res_72104 = loopres_t_res_f_res_72112;\n                    loopres_t_res_72105 = zgze_lhs_72107;\n                }\n                loopres_72101 = loopres_t_res_72104;\n                loopres_72102 = loopres_t_res_72105;\n            } else {\n                float s_prevMax_72099;\n                bool defunc_0_leq_res_72113;\n                int64_t zlze_lhs_72114;\n                bool tmp_f_res_72115;\n                bool x_72116;\n                bool y_72117;\n                bool tmp_72118;\n                int64_t max_res_72119;\n                bool loopres_f_res_72120;\n                \n                s_prevMax_72099 = ((__global float *) tS_mem_75468)[slice_72098];\n                defunc_0_leq_res_72113 = s_prevMax_72099 <= r_min_72037;\n                zlze_lhs_72114 = sub64(fm_72056, (int64_t) 1);\n                tmp_f_res_72115 = sle64(zlze_lhs_72114, (int64_t) 0);\n                x_72116 = !defunc_0_leq_res_72113;\n                y_72117 = tmp_f_res_72115 && x_72116;\n                tmp_72118 = defunc_0_leq_res_72113 || y_72117;\n                max_res_72119 = smax64((int64_t) 0, zlze_lhs_72114);\n                loopres_f_res_72120 = !tmp_72118;\n                loopres_72101 = loopres_f_res_72120;\n                loopres_72102 = max_res_72119;\n            }\n            loop_while_tmp_76745 = loopres_72101;\n            fm_tmp_76746 = loopres_72102;\n            loop_while_72055 = loop_while_tmp_76745;\n            fm_72056 = fm_tmp_76746;\n        }\n        defunc_0_f_res_72053 = loop_while_72055;\n        defunc_0_f_res_72054 = fm_72056;\n        loop_while_72124 = 1;\n        lm_72125 = gtid_72028;\n        while (",
                                    "loop_while_72124) {\n            bool x_72126;\n            bool y_72127;\n            bool bounds_check_72128;\n            bool index_certs_72129;\n            int64_t loopres_72130;\n            int64_t min_res_72131;\n            bool x_72132;\n            bool y_72133;\n            bool bounds_check_72134;\n            bool index_certs_72135;\n            bool cond_72138;\n            int64_t si_next_72139;\n            int64_t max_arg1_72146;\n            int64_t max_res_72147;\n            bool x_72148;\n            bool y_72149;\n            bool bounds_check_72150;\n            bool index_certs_72151;\n            int64_t min_res_72154;\n            bool x_72155;\n            bool y_72156;\n            bool bounds_check_72157;\n            bool index_certs_72158;\n            int64_t max_arg1_72161;\n            int64_t max_res_72162;\n            bool x_72163;\n            bool y_72164;\n            bool bounds_check_72165;\n            bool index_certs_72166;\n            int64_t slice_72136;\n            int64_t slice_72152;\n            float s_max_72153;\n            int64_t slice_72159;\n            int64_t slice_72167;\n            bool defunc_0_gt_res_72169;\n            bool loopres_72170;\n            int64_t loopres_72171;\n            bool loop_cond_t_res_72186;\n            bool x_72187;\n            bool loop_while_tmp_76747;\n            int64_t lm_tmp_76748;\n            \n            x_72126 = sle64((int64_t) 0, lm_72125);\n            y_72127 = slt64(lm_72125, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_72128 = x_72126 && y_72127;\n            if (!bounds_check_72128) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 68) == -1) {\n                        global_failure_args[0] = (int64_t) lm_72125;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    retu", "rn;\n                }\n            }\n            loopres_72130 = ((__global int64_t *) mem_75488)[lm_72125];\n            min_res_72131 = smin64(gt_rhs_64823, loopres_72130);\n            x_72132 = sle64((int64_t) 0, min_res_72131);\n            y_72133 = slt64(min_res_72131, nR_52195);\n            bounds_check_72134 = x_72132 && y_72133;\n            if (!bounds_check_72134) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 69) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72131;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_72138 = sle64(zeze_rhs_65256, lm_72125);\n            if (cond_72138) {\n                si_next_72139 = nR_52195;\n            } else {\n                int64_t tmp_72140;\n                bool x_72141;\n                bool y_72142;\n                bool bounds_check_72143;\n                bool index_certs_72144;\n                int64_t si_next_f_res_72145;\n                \n                tmp_72140 = add64((int64_t) 1, lm_72125);\n                x_72141 = sle64((int64_t) 0, tmp_72140);\n                y_72142 = slt64(tmp_72140, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_72143 = x_72141 && y_72142;\n                if (!bounds_check_72143) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 70) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_72140;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_72145 = ((__global int64_t *) mem_75488)[tmp_72140];\n                si_next_72139", " = si_next_f_res_72145;\n            }\n            max_arg1_72146 = sub64(si_next_72139, (int64_t) 1);\n            max_res_72147 = smax64(min_res_72131, max_arg1_72146);\n            x_72148 = sle64((int64_t) 0, max_res_72147);\n            y_72149 = slt64(max_res_72147, nR_52195);\n            bounds_check_72150 = x_72148 && y_72149;\n            if (!bounds_check_72150) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 71) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72147;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_72154 = smin64(zeze_rhs_65256, si_next_72139);\n            x_72155 = sle64((int64_t) 0, min_res_72154);\n            y_72156 = slt64(min_res_72154, nR_52195);\n            bounds_check_72157 = x_72155 && y_72156;\n            if (!bounds_check_72157) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 72) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_72154;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_72161 = sub64(min_res_72131, (int64_t) 1);\n            max_res_72162 = smax64((int64_t) 0, max_arg1_72161);\n            x_72163 = sle64((int64_t) 0, max_res_72162);\n            y_72164 = slt64(max_res_72162, nR_52195);\n            bounds_check_72165 = x_72163 && y_72164;\n            if (!bounds_check_72165) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 73) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_72162;\n                        global_failure_args[1] = (int64_t) nR_52195;\n                        ;\n                    }\n                    return;\n  ",
                                    "              }\n            }\n            slice_72136 = tS_start_64840 + min_res_72131;\n            slice_72152 = tS_start_64840 + max_res_72147;\n            s_max_72153 = ((__global float *) tS_mem_75468)[slice_72152];\n            slice_72159 = tS_start_64840 + min_res_72154;\n            slice_72167 = tS_start_64840 + max_res_72162;\n            defunc_0_gt_res_72169 = r_max_72052 < s_max_72153;\n            if (defunc_0_gt_res_72169) {\n                float s_min_72137;\n                bool defunc_0_leq_res_72172;\n                bool loopres_t_res_72173;\n                int64_t loopres_t_res_72174;\n                \n                s_min_72137 = ((__global float *) tS_mem_75468)[slice_72136];\n                defunc_0_leq_res_72172 = s_min_72137 <= r_max_72052;\n                if (defunc_0_leq_res_72172) {\n                    loopres_t_res_72173 = 0;\n                    loopres_t_res_72174 = lm_72125;\n                } else {\n                    float s_prevMax_72168;\n                    bool defunc_0_leq_res_72175;\n                    int64_t zlze_lhs_72176;\n                    bool tmp_f_res_72177;\n                    bool x_72178;\n                    bool y_72179;\n                    bool tmp_72180;\n                    int64_t max_res_72181;\n                    bool loopres_t_res_f_res_72182;\n                    \n                    s_prevMax_72168 = ((__global float *) tS_mem_75468)[slice_72167];\n                    defunc_0_leq_res_72175 = s_prevMax_72168 <= r_max_72052;\n                    zlze_lhs_72176 = sub64(lm_72125, (int64_t) 1);\n                    tmp_f_res_72177 = sle64(zlze_lhs_72176, (int64_t) 0);\n                    x_72178 = !defunc_0_leq_res_72175;\n                    y_72179 = tmp_f_res_72177 && x_72178;\n                    tmp_72180 = defunc_0_leq_res_72175 || y_72179;\n                    max_res_72181 = smax64((int64_t) 0, zlze_lhs_72176);\n                    loopres_t_res_f_res_72182 = !tmp_72180;\n                    loopres_t_res_72173 = loop", "res_t_res_f_res_72182;\n                    loopres_t_res_72174 = max_res_72181;\n                }\n                loopres_72170 = loopres_t_res_72173;\n                loopres_72171 = loopres_t_res_72174;\n            } else {\n                float s_nextMin_72160;\n                bool defunc_0_leq_res_72183;\n                int64_t tmp_72184;\n                bool loopres_f_res_72185;\n                \n                s_nextMin_72160 = ((__global float *) tS_mem_75468)[slice_72159];\n                defunc_0_leq_res_72183 = r_max_72052 <= s_nextMin_72160;\n                tmp_72184 = add64((int64_t) 1, lm_72125);\n                loopres_f_res_72185 = !defunc_0_leq_res_72183;\n                loopres_72170 = loopres_f_res_72185;\n                loopres_72171 = tmp_72184;\n            }\n            loop_cond_t_res_72186 = slt64(loopres_72171, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            x_72187 = loopres_72170 && loop_cond_t_res_72186;\n            loop_while_tmp_76747 = x_72187;\n            lm_tmp_76748 = loopres_72171;\n            loop_while_72124 = loop_while_tmp_76747;\n            lm_72125 = lm_tmp_76748;\n        }\n        defunc_0_f_res_72122 = loop_while_72124;\n        defunc_0_f_res_72123 = lm_72125;\n        ((__global int64_t *) mem_75522)[gtid_72028] = defunc_0_f_res_72054;\n        ((__global int64_t *) mem_75524)[gtid_72028] = defunc_0_f_res_72123;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72024\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72381_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72381(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75703, int64_t ext_75704, __global unsigned char *mem_param_75540, __global unsigned char *ext_mem_75707, __global unsigned char *mem_75711)\n{\n    #define segmap_tblock_sizze_72377 (inner_SMJ_floatzisegmap_72381zisegmap_tblock_sizze_72377)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76860;\n    ", "int32_t tblock_sizze_76863;\n    int32_t wave_sizze_76862;\n    int32_t block_id_76861;\n    int32_t global_tid_76859;\n    int64_t phys_tid_72381;\n    int64_t global_tid_76864;\n    int64_t slice_76865;\n    int64_t gtid_72380;\n    int64_t remnant_76866;\n    \n    local_tid_76860 = get_local_id(0);\n    tblock_sizze_76863 = get_local_size(0);\n    wave_sizze_76862 = LOCKSTEP_WIDTH;\n    block_id_76861 = get_tblock_id(0);\n    global_tid_76859 = block_id_76861 * tblock_sizze_76863 + local_tid_76860;\n    phys_tid_72381 = sext_i32_i64(global_tid_76859);\n    global_tid_76864 = sext_i32_i64(block_id_76861) * segmap_tblock_sizze_72377 + sext_i32_i64(local_tid_76860);\n    slice_76865 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_72380 = global_tid_76864;\n    remnant_76866 = global_tid_76864 - gtid_72380;\n    if (slt64(gtid_72380, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_72382;\n        bool cond_72384;\n        int64_t lifted_lambda_res_72385;\n        \n        eta_p_72382 = ((__global int64_t *) mem_param_75540)[gtid_72380];\n        cond_72384 = slt64(eta_p_72382, (int64_t) 0);\n        if (cond_72384) {\n            int64_t eta_p_72383 = ((__global int64_t *) ext_mem_75707)[ext_75704 + gtid_72380 * ext_75703];\n            \n            lifted_lambda_res_72385 = eta_p_72383;\n        } else {\n            lifted_lambda_res_72385 = eta_p_72382;\n        }\n        ((__global int64_t *) mem_75711)[gtid_72380] = lifted_lambda_res_72385;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72377\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72402_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72402(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75705, int64_t ext_75706, __global unsigned char *mem_param_75537, __global unsigned char *ext_mem_75708, __global unsigned char *mem_75714)\n{\n    #define segmap_tblock_sizze_72398 (inner_SMJ_floatzisegmap_72402zisegmap_tblock_sizze_72398)\n    if (*global_f",
                                    "ailure >= 0)\n        return;\n    \n    int32_t local_tid_76869;\n    int32_t tblock_sizze_76872;\n    int32_t wave_sizze_76871;\n    int32_t block_id_76870;\n    int32_t global_tid_76868;\n    int64_t phys_tid_72402;\n    int64_t global_tid_76873;\n    int64_t slice_76874;\n    int64_t gtid_72401;\n    int64_t remnant_76875;\n    \n    local_tid_76869 = get_local_id(0);\n    tblock_sizze_76872 = get_local_size(0);\n    wave_sizze_76871 = LOCKSTEP_WIDTH;\n    block_id_76870 = get_tblock_id(0);\n    global_tid_76868 = block_id_76870 * tblock_sizze_76872 + local_tid_76869;\n    phys_tid_72402 = sext_i32_i64(global_tid_76868);\n    global_tid_76873 = sext_i32_i64(block_id_76870) * segmap_tblock_sizze_72398 + sext_i32_i64(local_tid_76869);\n    slice_76874 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_72401 = global_tid_76873;\n    remnant_76875 = global_tid_76873 - gtid_72401;\n    if (slt64(gtid_72401, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_72403;\n        int64_t eta_p_72404;\n        int64_t defunc_0_f_res_72405;\n        \n        eta_p_72403 = ((__global int64_t *) mem_param_75537)[gtid_72401];\n        eta_p_72404 = ((__global int64_t *) ext_mem_75708)[ext_75706 + gtid_72401 * ext_75705];\n        defunc_0_f_res_72405 = add64(eta_p_72403, eta_p_72404);\n        ((__global int64_t *) mem_75714)[gtid_72401] = defunc_0_f_res_72405;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72398\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72423_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72423(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75528, int64_t ctx_param_ext_75529, __global unsigned char *mem_param_75530, __global unsigned char *ext_mem_75719, __global unsigned char *mem_75723)\n{\n    #define segmap_tblock_sizze_72419 (inner_SMJ_floatzisegmap_72423zisegmap_tblock_sizze_72419)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t loca", "l_tid_76878;\n    int32_t tblock_sizze_76881;\n    int32_t wave_sizze_76880;\n    int32_t block_id_76879;\n    int32_t global_tid_76877;\n    int64_t phys_tid_72423;\n    int64_t global_tid_76882;\n    int64_t slice_76883;\n    int64_t gtid_72422;\n    int64_t remnant_76884;\n    \n    local_tid_76878 = get_local_id(0);\n    tblock_sizze_76881 = get_local_size(0);\n    wave_sizze_76880 = LOCKSTEP_WIDTH;\n    block_id_76879 = get_tblock_id(0);\n    global_tid_76877 = block_id_76879 * tblock_sizze_76881 + local_tid_76878;\n    phys_tid_72423 = sext_i32_i64(global_tid_76877);\n    global_tid_76882 = sext_i32_i64(block_id_76879) * segmap_tblock_sizze_72419 + sext_i32_i64(local_tid_76878);\n    slice_76883 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_72422 = global_tid_76882;\n    remnant_76884 = global_tid_76882 - gtid_72422;\n    if (slt64(gtid_72422, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73891;\n        int64_t eta_p_72424;\n        bool cond_72426;\n        int64_t lifted_lambda_res_72427;\n        \n        slice_73891 = loopres_f_res_f_res_65435 + gtid_72422;\n        eta_p_72424 = ((__global int64_t *) mem_param_75530)[ctx_param_ext_75528 + slice_73891 * ctx_param_ext_75529];\n        cond_72426 = slt64(eta_p_72424, (int64_t) 0);\n        if (cond_72426) {\n            int64_t eta_p_72425 = ((__global int64_t *) ext_mem_75719)[gtid_72422];\n            \n            lifted_lambda_res_72427 = eta_p_72425;\n        } else {\n            lifted_lambda_res_72427 = eta_p_72424;\n        }\n        ((__global int64_t *) mem_75723)[gtid_72422] = lifted_lambda_res_72427;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72419\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72444_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72444(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75525, int64_t ctx_param_ext_75526, __global unsigned char *mem_param_75527, __glob", "al unsigned char *ext_mem_75720, __global unsigned char *mem_75726)\n{\n    #define segmap_tblock_sizze_72440 (inner_SMJ_floatzisegmap_72444zisegmap_tblock_sizze_72440)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76887;\n    int32_t tblock_sizze_76890;\n    int32_t wave_sizze_76889;\n    int32_t block_id_76888;\n    int32_t global_tid_76886;\n    int64_t phys_tid_72444;\n    int64_t global_tid_76891;\n    int64_t slice_76892;\n    int64_t gtid_72443;\n    int64_t remnant_76893;\n    \n    local_tid_76887 = get_local_id(0);\n    tblock_sizze_76890 = get_local_size(0);\n    wave_sizze_76889 = LOCKSTEP_WIDTH;\n    block_id_76888 = get_tblock_id(0);\n    global_tid_76886 = block_id_76888 * tblock_sizze_76890 + local_tid_76887;\n    phys_tid_72444 = sext_i32_i64(global_tid_76886);\n    global_tid_76891 = sext_i32_i64(block_id_76888) * segmap_tblock_sizze_72440 + sext_i32_i64(local_tid_76887);\n    slice_76892 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_72443 = global_tid_76891;\n    remnant_76893 = global_tid_76891 - gtid_72443;\n    if (slt64(gtid_72443, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73890;\n        int64_t eta_p_72445;\n        int64_t eta_p_72446;\n        int64_t defunc_0_f_res_72447;\n        \n        slice_73890 = loopres_f_res_f_res_65435 + gtid_72443;\n        eta_p_72445 = ((__global int64_t *) mem_param_75527)[ctx_param_ext_75525 + slice_73890 * ctx_param_ext_75526];\n        eta_p_72446 = ((__global int64_t *) ext_mem_75720)[gtid_72443];\n        defunc_0_f_res_72447 = add64(eta_p_72445, eta_p_72446);\n        ((__global int64_t *) mem_75726)[gtid_72443] = defunc_0_f_res_72447;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72440\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72465_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72465(__global int *global_failure, int64_t nR_52195, int64_t ext_75914, int64_t ext_75915, __global unsigned char *mem_param_75482, __global unsigned char *ext_mem_7591",
                                    "6, __global unsigned char *mem_75922)\n{\n    #define segmap_tblock_sizze_72461 (inner_SMJ_floatzisegmap_72465zisegmap_tblock_sizze_72461)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76896;\n    int32_t tblock_sizze_76899;\n    int32_t wave_sizze_76898;\n    int32_t block_id_76897;\n    int32_t global_tid_76895;\n    int64_t phys_tid_72465;\n    int64_t global_tid_76900;\n    int64_t slice_76901;\n    int64_t gtid_72464;\n    int64_t remnant_76902;\n    \n    local_tid_76896 = get_local_id(0);\n    tblock_sizze_76899 = get_local_size(0);\n    wave_sizze_76898 = LOCKSTEP_WIDTH;\n    block_id_76897 = get_tblock_id(0);\n    global_tid_76895 = block_id_76897 * tblock_sizze_76899 + local_tid_76896;\n    phys_tid_72465 = sext_i32_i64(global_tid_76895);\n    global_tid_76900 = sext_i32_i64(block_id_76897) * segmap_tblock_sizze_72461 + sext_i32_i64(local_tid_76896);\n    slice_76901 = nR_52195;\n    gtid_72464 = global_tid_76900;\n    remnant_76902 = global_tid_76900 - gtid_72464;\n    if (slt64(gtid_72464, nR_52195)) {\n        int64_t eta_p_72466;\n        bool cond_72468;\n        int64_t lifted_lambda_res_72469;\n        \n        eta_p_72466 = ((__global int64_t *) mem_param_75482)[gtid_72464];\n        cond_72468 = slt64(eta_p_72466, (int64_t) 0);\n        if (cond_72468) {\n            int64_t eta_p_72467 = ((__global int64_t *) ext_mem_75916)[ext_75915 + gtid_72464 * ext_75914];\n            \n            lifted_lambda_res_72469 = eta_p_72467;\n        } else {\n            lifted_lambda_res_72469 = eta_p_72466;\n        }\n        ((__global int64_t *) mem_75922)[gtid_72464] = lifted_lambda_res_72469;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72461\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72486_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72486(__global int *global_failure, int64_t nR_52195, int64_t ext_75917, int64_t ext_75918, __global unsigned char *mem_param_75479, __global unsigned char *ext_mem_75919, __global unsigned char *mem_75925)\n{\n    ", "#define segmap_tblock_sizze_72482 (inner_SMJ_floatzisegmap_72486zisegmap_tblock_sizze_72482)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76905;\n    int32_t tblock_sizze_76908;\n    int32_t wave_sizze_76907;\n    int32_t block_id_76906;\n    int32_t global_tid_76904;\n    int64_t phys_tid_72486;\n    int64_t global_tid_76909;\n    int64_t slice_76910;\n    int64_t gtid_72485;\n    int64_t remnant_76911;\n    \n    local_tid_76905 = get_local_id(0);\n    tblock_sizze_76908 = get_local_size(0);\n    wave_sizze_76907 = LOCKSTEP_WIDTH;\n    block_id_76906 = get_tblock_id(0);\n    global_tid_76904 = block_id_76906 * tblock_sizze_76908 + local_tid_76905;\n    phys_tid_72486 = sext_i32_i64(global_tid_76904);\n    global_tid_76909 = sext_i32_i64(block_id_76906) * segmap_tblock_sizze_72482 + sext_i32_i64(local_tid_76905);\n    slice_76910 = nR_52195;\n    gtid_72485 = global_tid_76909;\n    remnant_76911 = global_tid_76909 - gtid_72485;\n    if (slt64(gtid_72485, nR_52195)) {\n        int64_t eta_p_72487;\n        int64_t eta_p_72488;\n        int64_t defunc_0_f_res_72489;\n        \n        eta_p_72487 = ((__global int64_t *) mem_param_75479)[gtid_72485];\n        eta_p_72488 = ((__global int64_t *) ext_mem_75919)[ext_75918 + gtid_72485 * ext_75917];\n        defunc_0_f_res_72489 = add64(eta_p_72487, eta_p_72488);\n        ((__global int64_t *) mem_75925)[gtid_72485] = defunc_0_f_res_72489;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72482\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72499_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72499(__global int *global_failure, int64_t nR_52195, int64_t m_65686, int64_t num_tblocks_72504, int32_t virt_num_tblocks_77062, __global unsigned char *tR_mem_75467, __global unsigned char *ext_mem_75469, __global unsigned char *ext_mem_75937, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *mem_75945, __global unsigned char *mem_75947, __gl", "obal unsigned char *mem_75949, __global unsigned char *mem_75951)\n{\n    #define segmap_tblock_sizze_72502 (inner_SMJ_floatzisegmap_72499zisegmap_tblock_sizze_72502)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77064;\n    int32_t tblock_sizze_77067;\n    int32_t wave_sizze_77066;\n    int32_t block_id_77065;\n    int32_t global_tid_77063;\n    int64_t phys_tid_72499;\n    int32_t phys_tblock_id_77068;\n    int32_t iterations_77069;\n    \n    local_tid_77064 = get_local_id(0);\n    tblock_sizze_77067 = get_local_size(0);\n    wave_sizze_77066 = LOCKSTEP_WIDTH;\n    block_id_77065 = get_tblock_id(0);\n    global_tid_77063 = block_id_77065 * tblock_sizze_77067 + local_tid_77064;\n    phys_tid_72499 = sext_i32_i64(global_tid_77063);\n    phys_tblock_id_77068 = get_tblock_id(0);\n    iterations_77069 = sdiv_up32(virt_num_tblocks_77062 - phys_tblock_id_77068, sext_i64_i32(num_tblocks_72504));\n    for (int32_t i_77070 = 0; i_77070 < iterations_77069; i_77070++) {\n        int32_t virt_tblock_id_77071;\n        int64_t global_tid_77072;\n        int64_t slice_77073;\n        int64_t write_i_72498;\n        int64_t remnant_77074;\n        \n        virt_tblock_id_77071 = phys_tblock_id_77068 + i_77070 * sext_i64_i32(num_tblocks_72504);\n        global_tid_77072 = sext_i32_i64(virt_tblock_id_77071) * segmap_tblock_sizze_72502 + sext_i32_i64(local_tid_77064);\n        slice_77073 = nR_52195;\n        write_i_72498 = global_tid_77072;\n        remnant_77074 = global_tid_77072 - write_i_72498;\n        if (slt64(write_i_72498, nR_52195)) {\n            int64_t eta_p_65951;\n            float write_value_65953;\n            int64_t write_value_65954;\n            int64_t write_value_65955;\n            int64_t write_value_65956;\n            bool cond_65957;\n            int64_t lifted_lambda_res_65958;\n            \n            eta_p_65951 = ((__global int64_t *) mem_75943)[write_i_72498];\n            write_value_65953 = ((__global float *) tR_mem_75467)[write_i_72498];\n            wri",
                                    "te_value_65954 = ((__global int64_t *) ext_mem_75469)[write_i_72498];\n            write_value_65955 = ((__global int64_t *) ext_mem_75937)[write_i_72498];\n            write_value_65956 = ((__global int64_t *) ext_mem_75938)[write_i_72498];\n            cond_65957 = eta_p_65951 == (int64_t) 1;\n            if (cond_65957) {\n                int64_t eta_p_65952;\n                int64_t lifted_lambda_res_t_res_66732;\n                \n                eta_p_65952 = ((__global int64_t *) mem_75941)[write_i_72498];\n                lifted_lambda_res_t_res_66732 = sub64(eta_p_65952, (int64_t) 1);\n                lifted_lambda_res_65958 = lifted_lambda_res_t_res_66732;\n            } else {\n                lifted_lambda_res_65958 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global float *) mem_75951)[lifted_lambda_res_65958] = write_value_65953;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75949)[lifted_lambda_res_65958] = write_value_65954;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75947)[lifted_lambda_res_65958] = write_value_65955;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75945)[lifted_lambda_res_65958] = write_value_65956;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72502\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72533_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72533(__global int *global_failure, int64_t m_65686, __global unsigned char *mem_75955, __global unsigned char *mem_75962)\n{\n    #define segmap_tblock", "_sizze_72529 (inner_SMJ_floatzisegmap_72533zisegmap_tblock_sizze_72529)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77230;\n    int32_t tblock_sizze_77233;\n    int32_t wave_sizze_77232;\n    int32_t block_id_77231;\n    int32_t global_tid_77229;\n    int64_t phys_tid_72533;\n    int64_t global_tid_77234;\n    int64_t slice_77235;\n    int64_t gtid_72532;\n    int64_t remnant_77236;\n    \n    local_tid_77230 = get_local_id(0);\n    tblock_sizze_77233 = get_local_size(0);\n    wave_sizze_77232 = LOCKSTEP_WIDTH;\n    block_id_77231 = get_tblock_id(0);\n    global_tid_77229 = block_id_77231 * tblock_sizze_77233 + local_tid_77230;\n    phys_tid_72533 = sext_i32_i64(global_tid_77229);\n    global_tid_77234 = sext_i32_i64(block_id_77231) * segmap_tblock_sizze_72529 + sext_i32_i64(local_tid_77230);\n    slice_77235 = m_65686;\n    gtid_72532 = global_tid_77234;\n    remnant_77236 = global_tid_77234 - gtid_72532;\n    if (slt64(gtid_72532, m_65686)) {\n        int64_t zv_lhs_72535;\n        int64_t tmp_72536;\n        bool cond_72538;\n        int64_t lifted_lambda_res_72539;\n        \n        zv_lhs_72535 = add64((int64_t) -1, gtid_72532);\n        tmp_72536 = smod64(zv_lhs_72535, m_65686);\n        cond_72538 = gtid_72532 == (int64_t) 0;\n        if (cond_72538) {\n            lifted_lambda_res_72539 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_72537 = ((__global int64_t *) mem_75955)[tmp_72536];\n            \n            lifted_lambda_res_72539 = lifted_lambda_res_72537;\n        }\n        ((__global int64_t *) mem_75962)[gtid_72532] = lifted_lambda_res_72539;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72529\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72541_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72541(__global int *global_failure, int64_t m_65686, int64_t lower_bound_65769, int64_t min_res_65771, int64_t j_m_i_65772, int64_t num_tblocks_72546, int32_t virt_num_tblocks_77275, __global unsigned char *mem_75947, __global uns", "igned char *mem_75949, __global unsigned char *mem_75951, __global unsigned char *mem_75962, __global unsigned char *mem_75991, __global unsigned char *mem_75993, __global unsigned char *mem_75995)\n{\n    #define segmap_tblock_sizze_72544 (inner_SMJ_floatzisegmap_72541zisegmap_tblock_sizze_72544)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77277;\n    int32_t tblock_sizze_77280;\n    int32_t wave_sizze_77279;\n    int32_t block_id_77278;\n    int32_t global_tid_77276;\n    int64_t phys_tid_72541;\n    int32_t phys_tblock_id_77281;\n    int32_t iterations_77282;\n    \n    local_tid_77277 = get_local_id(0);\n    tblock_sizze_77280 = get_local_size(0);\n    wave_sizze_77279 = LOCKSTEP_WIDTH;\n    block_id_77278 = get_tblock_id(0);\n    global_tid_77276 = block_id_77278 * tblock_sizze_77280 + local_tid_77277;\n    phys_tid_72541 = sext_i32_i64(global_tid_77276);\n    phys_tblock_id_77281 = get_tblock_id(0);\n    iterations_77282 = sdiv_up32(virt_num_tblocks_77275 - phys_tblock_id_77281, sext_i64_i32(num_tblocks_72546));\n    for (int32_t i_77283 = 0; i_77283 < iterations_77282; i_77283++) {\n        int32_t virt_tblock_id_77284;\n        int64_t global_tid_77285;\n        int64_t slice_77286;\n        int64_t write_i_72540;\n        int64_t remnant_77287;\n        \n        virt_tblock_id_77284 = phys_tblock_id_77281 + i_77283 * sext_i64_i32(num_tblocks_72546);\n        global_tid_77285 = sext_i32_i64(virt_tblock_id_77284) * segmap_tblock_sizze_72544 + sext_i32_i64(local_tid_77277);\n        slice_77286 = m_65686;\n        write_i_72540 = global_tid_77285;\n        remnant_77287 = global_tid_77285 - write_i_72540;\n        if (slt64(write_i_72540, m_65686)) {\n            int64_t eta_p_66344;\n            float write_value_66345;\n            int64_t write_value_66346;\n            int64_t write_value_66347;\n            bool cond_66348;\n            bool cond_t_res_66349;\n            bool x_66350;\n            int64_t lifted_lambda_res_66351;\n            \n            eta_p_66",
                                    "344 = ((__global int64_t *) mem_75962)[write_i_72540];\n            write_value_66345 = ((__global float *) mem_75951)[write_i_72540];\n            write_value_66346 = ((__global int64_t *) mem_75949)[write_i_72540];\n            write_value_66347 = ((__global int64_t *) mem_75947)[write_i_72540];\n            cond_66348 = sle64(lower_bound_65769, eta_p_66344);\n            cond_t_res_66349 = slt64(eta_p_66344, min_res_65771);\n            x_66350 = cond_66348 && cond_t_res_66349;\n            if (x_66350) {\n                int64_t lifted_lambda_res_t_res_66735 = sub64(eta_p_66344, lower_bound_65769);\n                \n                lifted_lambda_res_66351 = lifted_lambda_res_t_res_66735;\n            } else {\n                lifted_lambda_res_66351 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global float *) mem_75991)[lifted_lambda_res_66351] = write_value_66345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75993)[lifted_lambda_res_66351] = write_value_66346;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75995)[lifted_lambda_res_66351] = write_value_66347;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72544\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72549_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72549(__global int *global_failure, int64_t m_65686, int64_t m_65826, int64_t num_tblocks_72554, int32_t virt_num_tblocks_77257, __global unsigned char *mem_75945, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *mem_75962, __global unsigned char *mem_75970, __global unsigned char", " *mem_75972)\n{\n    #define segmap_tblock_sizze_72552 (inner_SMJ_floatzisegmap_72549zisegmap_tblock_sizze_72552)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77259;\n    int32_t tblock_sizze_77262;\n    int32_t wave_sizze_77261;\n    int32_t block_id_77260;\n    int32_t global_tid_77258;\n    int64_t phys_tid_72549;\n    int32_t phys_tblock_id_77263;\n    int32_t iterations_77264;\n    \n    local_tid_77259 = get_local_id(0);\n    tblock_sizze_77262 = get_local_size(0);\n    wave_sizze_77261 = LOCKSTEP_WIDTH;\n    block_id_77260 = get_tblock_id(0);\n    global_tid_77258 = block_id_77260 * tblock_sizze_77262 + local_tid_77259;\n    phys_tid_72549 = sext_i32_i64(global_tid_77258);\n    phys_tblock_id_77263 = get_tblock_id(0);\n    iterations_77264 = sdiv_up32(virt_num_tblocks_77257 - phys_tblock_id_77263, sext_i64_i32(num_tblocks_72554));\n    for (int32_t i_77265 = 0; i_77265 < iterations_77264; i_77265++) {\n        int32_t virt_tblock_id_77266;\n        int64_t global_tid_77267;\n        int64_t slice_77268;\n        int64_t write_i_72548;\n        int64_t remnant_77269;\n        \n        virt_tblock_id_77266 = phys_tblock_id_77263 + i_77265 * sext_i64_i32(num_tblocks_72554);\n        global_tid_77267 = sext_i32_i64(virt_tblock_id_77266) * segmap_tblock_sizze_72552 + sext_i32_i64(local_tid_77259);\n        slice_77268 = m_65686;\n        write_i_72548 = global_tid_77267;\n        remnant_77269 = global_tid_77267 - write_i_72548;\n        if (slt64(write_i_72548, m_65686)) {\n            int64_t eta_p_65928;\n            int64_t write_value_65930;\n            int64_t write_value_65931;\n            bool cond_65932;\n            int64_t lifted_lambda_res_65933;\n            \n            eta_p_65928 = ((__global int64_t *) mem_75959)[write_i_72548];\n            write_value_65930 = ((__global int64_t *) mem_75962)[write_i_72548];\n            write_value_65931 = ((__global int64_t *) mem_75945)[write_i_72548];\n            cond_65932 = eta_p_65928 == (int64_t) 1;\n            i", "f (cond_65932) {\n                int64_t eta_p_65929;\n                int64_t lifted_lambda_res_t_res_66740;\n                \n                eta_p_65929 = ((__global int64_t *) mem_75957)[write_i_72548];\n                lifted_lambda_res_t_res_66740 = sub64(eta_p_65929, (int64_t) 1);\n                lifted_lambda_res_65933 = lifted_lambda_res_t_res_66740;\n            } else {\n                lifted_lambda_res_65933 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75972)[lifted_lambda_res_65933] = write_value_65930;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75970)[lifted_lambda_res_65933] = write_value_65931;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_72552\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_72571_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_72571(__global int *global_failure, int64_t loopres_65870, int64_t loopres_65871, __global unsigned char *mem_76020, __global unsigned char *mem_76023)\n{\n    #define segmap_tblock_sizze_72567 (inner_SMJ_floatzisegmap_72571zisegmap_tblock_sizze_72567)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77344;\n    int32_t tblock_sizze_77347;\n    int32_t wave_sizze_77346;\n    int32_t block_id_77345;\n    int32_t global_tid_77343;\n    int64_t phys_tid_72571;\n    int64_t global_tid_77348;\n    int64_t slice_77349;\n    int64_t gtid_72570;\n    int64_t remnant_77350;\n    \n    local_tid_77344 = get_local_id(0);\n    tblock_sizze_77347 = get_local_size(0);\n    wave_sizze_77346 = LOCKSTEP_WIDTH;\n    block_id_77345 = get_tblock_id(0);\n    global_tid_77343 = block_id_77345 * tblock_sizze_77347 + local_tid_77344;\n    phys_tid_72571 = sext_i32_i64(global_tid_77343);\n  ",
                                    "  global_tid_77348 = sext_i32_i64(block_id_77345) * segmap_tblock_sizze_72567 + sext_i32_i64(local_tid_77344);\n    slice_77349 = loopres_65871;\n    gtid_72570 = global_tid_77348;\n    remnant_77350 = global_tid_77348 - gtid_72570;\n    if (slt64(gtid_72570, loopres_65871)) {\n        int64_t loopres_75462;\n        int64_t tmp_72573;\n        \n        loopres_75462 = ((__global int64_t *) mem_76023)[(int64_t) 0];\n        tmp_72573 = add64(gtid_72570, loopres_75462);\n        ((__global int64_t *) mem_76020)[loopres_65870 + gtid_72570] = tmp_72573;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_72567\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_73899_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_73899(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_73902, int64_t num_whole_tiles_73917, int64_t residual_input_74141, unsigned char cond_74142_bits, int64_t binop_x_74158, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75887, __global unsigned char *mem_75889)\n{\n    bool cond_74142 = cond_74142_bits;\n    \n    #define tile_sizze_73901 (inner_SMJ_floatzisegmap_intrablock_73899zitile_sizze_73901)\n    #define bytes_75849 (inner_SMJ_floatzisegmap_intrablock_73899zibytes_75849)\n    #define bytes_75851 (inner_SMJ_floatzisegmap_intrablock_73899zibytes_75851)\n    \n    volatile __local unsigned char *color_76532_backing_2 = &shared_mem[0];\n    const int64_t color_76532_backing_2_offset = 0 + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76531_backing_1 = &shared_mem[color_76532_backing_2_offset];\n    const int64_t color_76531_backing_1_offset = color_76532_backing_2_offset + (bytes_75851 + srem64((int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8));\n ", "   volatile __local unsigned char *color_76530_backing_0 = &shared_mem[color_76531_backing_1_offset];\n    const int64_t color_76530_backing_0_offset = color_76531_backing_1_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76641;\n    int32_t tblock_sizze_76644;\n    int32_t wave_sizze_76643;\n    int32_t block_id_76642;\n    int32_t global_tid_76640;\n    int64_t gid_flat_73899;\n    int64_t slice_76646;\n    int64_t ltid_pre_76645;\n    int64_t remnant_76647;\n    int64_t slice_76648;\n    int64_t gid_73898;\n    int64_t remnant_76649;\n    __local unsigned char *color_76530;\n    __local unsigned char *color_76531;\n    __local unsigned char *color_76532;\n    int64_t binop_x_73909;\n    float mem_75833[1];\n    int64_t ltid_flat_73904;\n    int64_t ltid_73903;\n    int64_t gtid_73910;\n    bool cond_73911;\n    float pre_73912;\n    int64_t mem_75837[1];\n    float mem_75841[1];\n    int64_t mem_75845[1];\n    int64_t ltid_flat_73919;\n    int64_t ltid_73918;\n    int64_t gtid_73929;\n    bool cond_73930;\n    int64_t neutral_73931;\n    float neutral_73932;\n    int64_t ext_mem_75869[1];\n    float ext_mem_75868[1];\n    int64_t ext_mem_75867[1];\n    int64_t mem_param_75846[1];\n    float mem_param_75847[1];\n    int64_t mem_param_75848[1];\n    int64_t mem_75879[1];\n    int64_t mem_75883[1];\n    int64_t ext_mem_75885[1];\n    int64_t ext_mem_75884[1];\n    \n    local_tid_76641 = get_local_id(0);\n    tblock_sizze_76644 = get_local_size(0);\n    wave_sizze_76643 = LOCKSTEP_WIDTH;\n    block_id_76642 = get_tblock_id(0);\n    global_tid_76640 = block_id_76642 * tblock_sizze_76644 + local_tid_76641;\n    gid_flat_73899 = sext_i32_i64(block_id_76642);\n    slice_76646 = tile_sizze_73901;\n    ltid_pre_76645 = sext_i32_i64(local_tid_76641);\n    remnant_76647 = sext_i32_i64(local_tid_76641) - ltid_pre_76645;\n    slice_76648 = ldim_73902;\n    gid_73898 = sext_i32_i64(block_id_76642);\n    remn", "ant_76649 = sext_i32_i64(block_id_76642) - gid_73898;\n    color_76530 = (__local unsigned char *) color_76530_backing_0;\n    color_76531 = (__local unsigned char *) color_76531_backing_1;\n    color_76532 = (__local unsigned char *) color_76532_backing_2;\n    binop_x_73909 = gid_73898 * tile_sizze_73901;\n    ltid_flat_73904 = sext_i32_i64(local_tid_76641);\n    ltid_73903 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73910 = ltid_73903 + binop_x_73909;\n    cond_73911 = slt64(gtid_73910, min_res_66402);\n    if (cond_73911) {\n        int64_t slice_73913;\n        float eta_p_73914;\n        \n        slice_73913 = start_66400 + gtid_73910;\n        eta_p_73914 = ((__global float *) tR_mem_75467)[slice_73913];\n        pre_73912 = eta_p_73914;\n    } else {\n        pre_73912 = 0.0F;\n    }\n    mem_75833[(int64_t) 0] = pre_73912;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_73919 = sext_i32_i64(local_tid_76641);\n    ltid_73918 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73929 = binop_x_73909 + ltid_73918;\n    cond_73930 = slt64(gtid_73929, min_res_66402);\n    if (cond_73930) {\n        neutral_73931 = (int64_t) -1;\n    } else {\n        neutral_73931 = (int64_t) 0;\n    }\n    if (cond_73930) {\n        float eta_p_73934 = mem_75833[(int64_t) 0];\n        \n        neutral_73932 = eta_p_73934;\n    } else {\n        neutral_73932 = 0.0F;\n    }\n    mem_75837[(int64_t) 0] = neutral_73931;\n    mem_75841[(int64_t) 0] = neutral_73932;\n    mem_75845[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75846[i_3] = mem_75837[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75847[i_4] = mem_75841[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75848[i_5] = mem_75845[i_5];\n    for (int64_t tile_id_73944 = 0; tile_id_73944 < num_whole_tiles_73917; tile_id_73944++) {\n        int64_t binop_x_74043;\n        int64_t ltid_flat_74042;\n        in",
                                    "t64_t ltid_74041;\n        int64_t j_74044;\n        bool cond_74048;\n        int64_t pre1d_74051;\n        int64_t pre1d_74049;\n        float pre1d_74050;\n        int64_t mem_75858[1];\n        float mem_75862[1];\n        int64_t mem_75866[1];\n        int64_t ltid_flat_74062;\n        int64_t ltid_74061;\n        int64_t gtid_74064;\n        int64_t acc_74066;\n        float acc_74067;\n        int64_t acc_74068;\n        bool cond_74069;\n        int64_t acc_74070;\n        float acc_74071;\n        int64_t acc_74072;\n        int64_t mem_param_tmp_76650[1];\n        float mem_param_tmp_76651[1];\n        int64_t mem_param_tmp_76652[1];\n        \n        binop_x_74043 = tile_sizze_73901 * tile_id_73944;\n        ltid_flat_74042 = sext_i32_i64(local_tid_76641);\n        ltid_74041 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74044 = ltid_74041 + binop_x_74043;\n        cond_74048 = slt64(j_74044, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74051 = btoi_bool_i64(cond_74048);\n        if (cond_74048) {\n            int64_t tile_elem_74052;\n            int64_t slice_75321;\n            float tile_elem_74053;\n            \n            tile_elem_74052 = ((__global int64_t *) ext_mem_75767)[j_74044];\n            slice_75321 = tS_start_64840 + j_74044;\n            tile_elem_74053 = ((__global float *) tS_mem_75468)[slice_75321];\n            pre1d_74049 = tile_elem_74052;\n            pre1d_74050 = tile_elem_74053;\n        } else {\n            pre1d_74049 = (int64_t) 0;\n            pre1d_74050 = 0.0F;\n        }\n        ((__local int64_t *) color_76532)[ltid_74041] = pre1d_74049;\n        ((__local float *) color_76531)[ltid_74041] = pre1d_74050;\n        ((__local int64_t *) color_76530)[ltid_74041] = pre1d_74051;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74062 = sext_i32_i64(local_tid_76641);\n        ltid_74061 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74064 = binop_x_73909 + ltid_74061;\n        acc_74066 = mem_param_75846[(int64_t) 0];\n", "        acc_74067 = mem_param_75847[(int64_t) 0];\n        acc_74068 = mem_param_75848[(int64_t) 0];\n        cond_74069 = slt64(gtid_74064, min_res_66402);\n        if (cond_74069) {\n            float eta_p_74065;\n            int64_t x_74073;\n            float x_74074;\n            int64_t x_74075;\n            int64_t redout_75334;\n            float redout_75335;\n            int64_t redout_75336;\n            \n            eta_p_74065 = mem_75833[(int64_t) 0];\n            redout_75334 = acc_74066;\n            redout_75335 = acc_74067;\n            redout_75336 = acc_74068;\n            for (int64_t i_75337 = 0; i_75337 < tile_sizze_73901; i_75337++) {\n                int64_t x_74076;\n                float x_74077;\n                bool defunc_0_neq_res_74085;\n                bool defunc_0_neq_res_74086;\n                bool cond_f_res_74087;\n                bool y_74088;\n                bool cond_74089;\n                bool defunc_0_neq_res_74090;\n                bool defunc_0_neq_res_74091;\n                bool cond_t_res_f_res_74092;\n                bool y_74093;\n                bool cond_t_res_74094;\n                bool x_74095;\n                int64_t defunc_0_op_res_74096;\n                float defunc_0_op_res_74097;\n                int64_t defunc_0_op_res_74098;\n                int64_t redout_tmp_76656;\n                float redout_tmp_76657;\n                int64_t redout_tmp_76658;\n                \n                x_74076 = ((__local int64_t *) color_76532)[i_75337];\n                x_74077 = ((__local float *) color_76531)[i_75337];\n                defunc_0_neq_res_74085 = redout_75335 == eta_p_74065;\n                defunc_0_neq_res_74086 = !defunc_0_neq_res_74085;\n                cond_f_res_74087 = slt64(redout_75334, (int64_t) 0);\n                y_74088 = defunc_0_neq_res_74085 && cond_f_res_74087;\n                cond_74089 = defunc_0_neq_res_74086 || y_74088;\n                defunc_0_neq_res_74090 = x_74077 == eta_p_74065;\n                defunc_0_neq_res_74", "091 = !defunc_0_neq_res_74090;\n                cond_t_res_f_res_74092 = slt64(x_74076, (int64_t) 0);\n                y_74093 = defunc_0_neq_res_74090 && cond_t_res_f_res_74092;\n                cond_t_res_74094 = defunc_0_neq_res_74091 || y_74093;\n                x_74095 = cond_74089 && cond_t_res_74094;\n                if (x_74095) {\n                    defunc_0_op_res_74096 = (int64_t) -1;\n                    defunc_0_op_res_74097 = eta_p_74065;\n                    defunc_0_op_res_74098 = (int64_t) 0;\n                } else {\n                    int64_t x_74078;\n                    int64_t defunc_0_op_res_f_res_74099;\n                    float defunc_0_op_res_f_res_74100;\n                    int64_t defunc_0_op_res_f_res_74101;\n                    \n                    x_74078 = ((__local int64_t *) color_76530)[i_75337];\n                    if (cond_74089) {\n                        defunc_0_op_res_f_res_74099 = x_74076;\n                        defunc_0_op_res_f_res_74100 = x_74077;\n                        defunc_0_op_res_f_res_74101 = x_74078;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74102;\n                        int64_t defunc_0_op_res_f_res_f_res_74103;\n                        int64_t defunc_0_op_res_f_res_f_res_74104;\n                        \n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74102 = redout_75335;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74102 = eta_p_74065;\n                        }\n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74103 = redout_75334;\n                            defunc_0_op_res_f_res_f_res_74104 = redout_75336;\n                        } else {\n                            int64_t min_res_74105;\n                            int64_t tmp_74106;\n                            \n                            min_res_74105 = smin64(x_74076, ",
                                    "redout_75334);\n                            tmp_74106 = add64(x_74078, redout_75336);\n                            defunc_0_op_res_f_res_f_res_74103 = min_res_74105;\n                            defunc_0_op_res_f_res_f_res_74104 = tmp_74106;\n                        }\n                        defunc_0_op_res_f_res_74099 = defunc_0_op_res_f_res_f_res_74103;\n                        defunc_0_op_res_f_res_74100 = defunc_0_op_res_f_res_f_res_74102;\n                        defunc_0_op_res_f_res_74101 = defunc_0_op_res_f_res_f_res_74104;\n                    }\n                    defunc_0_op_res_74096 = defunc_0_op_res_f_res_74099;\n                    defunc_0_op_res_74097 = defunc_0_op_res_f_res_74100;\n                    defunc_0_op_res_74098 = defunc_0_op_res_f_res_74101;\n                }\n                redout_tmp_76656 = defunc_0_op_res_74096;\n                redout_tmp_76657 = defunc_0_op_res_74097;\n                redout_tmp_76658 = defunc_0_op_res_74098;\n                redout_75334 = redout_tmp_76656;\n                redout_75335 = redout_tmp_76657;\n                redout_75336 = redout_tmp_76658;\n            }\n            x_74073 = redout_75334;\n            x_74074 = redout_75335;\n            x_74075 = redout_75336;\n            acc_74070 = x_74073;\n            acc_74071 = x_74074;\n            acc_74072 = x_74075;\n        } else {\n            acc_74070 = acc_74066;\n            acc_74071 = acc_74067;\n            acc_74072 = acc_74068;\n        }\n        mem_75858[(int64_t) 0] = acc_74070;\n        mem_75862[(int64_t) 0] = acc_74071;\n        mem_75866[(int64_t) 0] = acc_74072;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76650[i_6] = mem_75858[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76651[i_7] = mem_75862[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76652[i_8] = mem_75866[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_", "param_75846[i_9] = mem_param_tmp_76650[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75847[i_10] = mem_param_tmp_76651[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75848[i_11] = mem_param_tmp_76652[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75869[i_12] = mem_param_75846[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75868[i_13] = mem_param_75847[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75867[i_14] = mem_param_75848[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74142) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75885[i_15] = ext_mem_75869[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75884[i_16] = ext_mem_75867[i_16];\n    } else {\n        int64_t ltid_flat_74144;\n        int64_t ltid_74143;\n        int64_t j_74159;\n        bool cond_74163;\n        int64_t pre1d_74166;\n        int64_t pre1d_74164;\n        float pre1d_74165;\n        int64_t ltid_flat_74180;\n        int64_t ltid_74179;\n        int64_t gtid_74193;\n        int64_t acc_74195;\n        int64_t acc_74197;\n        bool cond_74198;\n        int64_t acc_74199;\n        int64_t acc_74201;\n        \n        ltid_flat_74144 = sext_i32_i64(local_tid_76641);\n        ltid_74143 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74159 = ltid_74143 + binop_x_74158;\n        cond_74163 = slt64(j_74159, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74166 = btoi_bool_i64(cond_74163);\n        if (cond_74163) {\n            int64_t tile_elem_74167;\n            int64_t slice_75320;\n            float tile_elem_74168;\n            \n            tile_elem_74167 = ((__global int64_t *) ext_mem_75767)[j_74159];\n            slice_75320 = tS_start_64840 + j_74159;\n            tile_elem_74168 = ((__global float *) tS_mem_75468)[slice_75320];\n            pre1d_74164 = tile_elem_74167;\n            pre1d_74165 = tile", "_elem_74168;\n        } else {\n            pre1d_74164 = (int64_t) 0;\n            pre1d_74165 = 0.0F;\n        }\n        ((__local int64_t *) color_76532)[ltid_74143] = pre1d_74164;\n        ((__local float *) color_76531)[ltid_74143] = pre1d_74165;\n        ((__local int64_t *) color_76530)[ltid_74143] = pre1d_74166;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74180 = sext_i32_i64(local_tid_76641);\n        ltid_74179 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74193 = binop_x_73909 + ltid_74179;\n        acc_74195 = ext_mem_75869[(int64_t) 0];\n        acc_74197 = ext_mem_75867[(int64_t) 0];\n        cond_74198 = slt64(gtid_74193, min_res_66402);\n        if (cond_74198) {\n            float eta_p_74194;\n            float acc_74196;\n            int64_t x_74202;\n            float x_74203;\n            int64_t x_74204;\n            int64_t redout_75338;\n            float redout_75339;\n            int64_t redout_75340;\n            \n            eta_p_74194 = mem_75833[(int64_t) 0];\n            acc_74196 = ext_mem_75868[(int64_t) 0];\n            redout_75338 = acc_74195;\n            redout_75339 = acc_74196;\n            redout_75340 = acc_74197;\n            for (int64_t i_75341 = 0; i_75341 < residual_input_74141; i_75341++) {\n                int64_t x_74205;\n                float x_74206;\n                bool defunc_0_neq_res_74214;\n                bool defunc_0_neq_res_74215;\n                bool cond_f_res_74216;\n                bool y_74217;\n                bool cond_74218;\n                bool defunc_0_neq_res_74219;\n                bool defunc_0_neq_res_74220;\n                bool cond_t_res_f_res_74221;\n                bool y_74222;\n                bool cond_t_res_74223;\n                bool x_74224;\n                int64_t defunc_0_op_res_74225;\n                float defunc_0_op_res_74226;\n                int64_t defunc_0_op_res_74227;\n                int64_t redout_tmp_76659;\n                float redout_tmp_76660;\n                int64_t redout",
                                    "_tmp_76661;\n                \n                x_74205 = ((__local int64_t *) color_76532)[i_75341];\n                x_74206 = ((__local float *) color_76531)[i_75341];\n                defunc_0_neq_res_74214 = redout_75339 == eta_p_74194;\n                defunc_0_neq_res_74215 = !defunc_0_neq_res_74214;\n                cond_f_res_74216 = slt64(redout_75338, (int64_t) 0);\n                y_74217 = defunc_0_neq_res_74214 && cond_f_res_74216;\n                cond_74218 = defunc_0_neq_res_74215 || y_74217;\n                defunc_0_neq_res_74219 = x_74206 == eta_p_74194;\n                defunc_0_neq_res_74220 = !defunc_0_neq_res_74219;\n                cond_t_res_f_res_74221 = slt64(x_74205, (int64_t) 0);\n                y_74222 = defunc_0_neq_res_74219 && cond_t_res_f_res_74221;\n                cond_t_res_74223 = defunc_0_neq_res_74220 || y_74222;\n                x_74224 = cond_74218 && cond_t_res_74223;\n                if (x_74224) {\n                    defunc_0_op_res_74225 = (int64_t) -1;\n                    defunc_0_op_res_74226 = eta_p_74194;\n                    defunc_0_op_res_74227 = (int64_t) 0;\n                } else {\n                    int64_t x_74207;\n                    int64_t defunc_0_op_res_f_res_74228;\n                    float defunc_0_op_res_f_res_74229;\n                    int64_t defunc_0_op_res_f_res_74230;\n                    \n                    x_74207 = ((__local int64_t *) color_76530)[i_75341];\n                    if (cond_74218) {\n                        defunc_0_op_res_f_res_74228 = x_74205;\n                        defunc_0_op_res_f_res_74229 = x_74206;\n                        defunc_0_op_res_f_res_74230 = x_74207;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74231;\n                        int64_t defunc_0_op_res_f_res_f_res_74232;\n                        int64_t defunc_0_op_res_f_res_f_res_74233;\n                        \n                        if (cond_t_res_74223) {\n                            defu", "nc_0_op_res_f_res_f_res_74231 = redout_75339;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74231 = eta_p_74194;\n                        }\n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74232 = redout_75338;\n                            defunc_0_op_res_f_res_f_res_74233 = redout_75340;\n                        } else {\n                            int64_t min_res_74234;\n                            int64_t tmp_74235;\n                            \n                            min_res_74234 = smin64(x_74205, redout_75338);\n                            tmp_74235 = add64(x_74207, redout_75340);\n                            defunc_0_op_res_f_res_f_res_74232 = min_res_74234;\n                            defunc_0_op_res_f_res_f_res_74233 = tmp_74235;\n                        }\n                        defunc_0_op_res_f_res_74228 = defunc_0_op_res_f_res_f_res_74232;\n                        defunc_0_op_res_f_res_74229 = defunc_0_op_res_f_res_f_res_74231;\n                        defunc_0_op_res_f_res_74230 = defunc_0_op_res_f_res_f_res_74233;\n                    }\n                    defunc_0_op_res_74225 = defunc_0_op_res_f_res_74228;\n                    defunc_0_op_res_74226 = defunc_0_op_res_f_res_74229;\n                    defunc_0_op_res_74227 = defunc_0_op_res_f_res_74230;\n                }\n                redout_tmp_76659 = defunc_0_op_res_74225;\n                redout_tmp_76660 = defunc_0_op_res_74226;\n                redout_tmp_76661 = defunc_0_op_res_74227;\n                redout_75338 = redout_tmp_76659;\n                redout_75339 = redout_tmp_76660;\n                redout_75340 = redout_tmp_76661;\n            }\n            x_74202 = redout_75338;\n            x_74203 = redout_75339;\n            x_74204 = redout_75340;\n            acc_74199 = x_74202;\n            acc_74201 = x_74204;\n        } else {\n            acc_74199 = acc_74195;\n            acc_74201 = acc_74197;\n       ", " }\n        mem_75879[(int64_t) 0] = acc_74199;\n        mem_75883[(int64_t) 0] = acc_74201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75885[i_17] = mem_75879[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75884[i_18] = mem_75883[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76662 = ext_mem_75885[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75887)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76662;\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76663 = ext_mem_75884[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75889)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76663;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_73901\n    #undef bytes_75849\n    #undef bytes_75851\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_74254_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_74254(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_74257, int64_t num_whole_tiles_74272, int64_t residual_input_74496, unsigned char cond_74497_bits, int64_t binop_x_74513, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75826, __global unsigned char *mem_75828)\n{\n    bool cond_74497 = cond_74497_bits;\n    \n    #define tile_sizze_74256 (inner_SMJ_floatzisegmap_intrablock_74254zitile_sizze_74256)\n    #define bytes_75788 (inner_SMJ_floatzisegmap_intrablock_74254zibytes_75788)\n    #define bytes_75790 (inner_SMJ_floatzisegmap_intrablock_74254zibytes_75790)\n    \n    volatile __local unsign",
                                    "ed char *color_76535_backing_2 = &shared_mem[0];\n    const int64_t color_76535_backing_2_offset = 0 + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76534_backing_1 = &shared_mem[color_76535_backing_2_offset];\n    const int64_t color_76534_backing_1_offset = color_76535_backing_2_offset + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76533_backing_0 = &shared_mem[color_76534_backing_1_offset];\n    const int64_t color_76533_backing_0_offset = color_76534_backing_1_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76667;\n    int32_t tblock_sizze_76670;\n    int32_t wave_sizze_76669;\n    int32_t block_id_76668;\n    int32_t global_tid_76666;\n    int64_t gid_flat_74254;\n    int64_t slice_76672;\n    int64_t ltid_pre_76671;\n    int64_t remnant_76673;\n    int64_t slice_76674;\n    int64_t gid_74253;\n    int64_t remnant_76675;\n    __local unsigned char *color_76533;\n    __local unsigned char *color_76534;\n    __local unsigned char *color_76535;\n    int64_t binop_x_74264;\n    float mem_75772[1];\n    int64_t ltid_flat_74259;\n    int64_t ltid_74258;\n    int64_t gtid_74265;\n    bool cond_74266;\n    float pre_74267;\n    int64_t mem_75776[1];\n    float mem_75780[1];\n    int64_t mem_75784[1];\n    int64_t ltid_flat_74274;\n    int64_t ltid_74273;\n    int64_t gtid_74284;\n    bool cond_74285;\n    int64_t neutral_74286;\n    float neutral_74287;\n    int64_t ext_mem_75808[1];\n    float ext_mem_75807[1];\n    int64_t ext_mem_75806[1];\n    int64_t mem_param_75785[1];\n    float mem_param_75786[1];\n    int64_t mem_param_75787[1];\n    int64_t mem_75818[1];\n    int64_t mem_75822[1];\n    int64_t ext_mem_75824[1];\n    int64_t ext_mem_75823[1];\n    \n    local_tid_76667 = get_local_id(0);\n    tblock_sizze_76670 = get_local_", "size(0);\n    wave_sizze_76669 = LOCKSTEP_WIDTH;\n    block_id_76668 = get_tblock_id(0);\n    global_tid_76666 = block_id_76668 * tblock_sizze_76670 + local_tid_76667;\n    gid_flat_74254 = sext_i32_i64(block_id_76668);\n    slice_76672 = tile_sizze_74256;\n    ltid_pre_76671 = sext_i32_i64(local_tid_76667);\n    remnant_76673 = sext_i32_i64(local_tid_76667) - ltid_pre_76671;\n    slice_76674 = ldim_74257;\n    gid_74253 = sext_i32_i64(block_id_76668);\n    remnant_76675 = sext_i32_i64(block_id_76668) - gid_74253;\n    color_76533 = (__local unsigned char *) color_76533_backing_0;\n    color_76534 = (__local unsigned char *) color_76534_backing_1;\n    color_76535 = (__local unsigned char *) color_76535_backing_2;\n    binop_x_74264 = gid_74253 * tile_sizze_74256;\n    ltid_flat_74259 = sext_i32_i64(local_tid_76667);\n    ltid_74258 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74265 = ltid_74258 + binop_x_74264;\n    cond_74266 = slt64(gtid_74265, min_res_66402);\n    if (cond_74266) {\n        int64_t slice_74268;\n        float eta_p_74269;\n        \n        slice_74268 = start_66400 + gtid_74265;\n        eta_p_74269 = ((__global float *) tR_mem_75467)[slice_74268];\n        pre_74267 = eta_p_74269;\n    } else {\n        pre_74267 = 0.0F;\n    }\n    mem_75772[(int64_t) 0] = pre_74267;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74274 = sext_i32_i64(local_tid_76667);\n    ltid_74273 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74284 = binop_x_74264 + ltid_74273;\n    cond_74285 = slt64(gtid_74284, min_res_66402);\n    if (cond_74285) {\n        neutral_74286 = (int64_t) -1;\n    } else {\n        neutral_74286 = (int64_t) 0;\n    }\n    if (cond_74285) {\n        float eta_p_74289 = mem_75772[(int64_t) 0];\n        \n        neutral_74287 = eta_p_74289;\n    } else {\n        neutral_74287 = 0.0F;\n    }\n    mem_75776[(int64_t) 0] = neutral_74286;\n    mem_75780[(int64_t) 0] = neutral_74287;\n    mem_75784[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(C", "LK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75785[i_3] = mem_75776[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75786[i_4] = mem_75780[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75787[i_5] = mem_75784[i_5];\n    for (int64_t tile_id_74299 = 0; tile_id_74299 < num_whole_tiles_74272; tile_id_74299++) {\n        int64_t binop_x_74398;\n        int64_t ltid_flat_74397;\n        int64_t ltid_74396;\n        int64_t j_74399;\n        bool cond_74403;\n        int64_t pre1d_74406;\n        int64_t pre1d_74404;\n        float pre1d_74405;\n        int64_t mem_75797[1];\n        float mem_75801[1];\n        int64_t mem_75805[1];\n        int64_t ltid_flat_74417;\n        int64_t ltid_74416;\n        int64_t gtid_74419;\n        int64_t acc_74421;\n        float acc_74422;\n        int64_t acc_74423;\n        bool cond_74424;\n        int64_t acc_74425;\n        float acc_74426;\n        int64_t acc_74427;\n        int64_t mem_param_tmp_76676[1];\n        float mem_param_tmp_76677[1];\n        int64_t mem_param_tmp_76678[1];\n        \n        binop_x_74398 = tile_sizze_74256 * tile_id_74299;\n        ltid_flat_74397 = sext_i32_i64(local_tid_76667);\n        ltid_74396 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74399 = ltid_74396 + binop_x_74398;\n        cond_74403 = slt64(j_74399, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74406 = btoi_bool_i64(cond_74403);\n        if (cond_74403) {\n            int64_t tile_elem_74407;\n            int64_t slice_75325;\n            float tile_elem_74408;\n            \n            tile_elem_74407 = ((__global int64_t *) ext_mem_75767)[j_74399];\n            slice_75325 = tS_start_64840 + j_74399;\n            tile_elem_74408 = ((__global float *) tS_mem_75468)[slice_75325];\n            pre1d_74404 = tile_elem_74407;\n            pre1d_74405 = tile_elem_74408;\n        } else {\n            pre1d_74404 = (int64_t) 0;\n            pre1d_74405 = 0.0F;\n        }\n        ",
                                    "((__local int64_t *) color_76535)[ltid_74396] = pre1d_74404;\n        ((__local float *) color_76534)[ltid_74396] = pre1d_74405;\n        ((__local int64_t *) color_76533)[ltid_74396] = pre1d_74406;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74417 = sext_i32_i64(local_tid_76667);\n        ltid_74416 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74419 = binop_x_74264 + ltid_74416;\n        acc_74421 = mem_param_75785[(int64_t) 0];\n        acc_74422 = mem_param_75786[(int64_t) 0];\n        acc_74423 = mem_param_75787[(int64_t) 0];\n        cond_74424 = slt64(gtid_74419, min_res_66402);\n        if (cond_74424) {\n            float eta_p_74420;\n            int64_t x_74428;\n            float x_74429;\n            int64_t x_74430;\n            int64_t redout_75342;\n            float redout_75343;\n            int64_t redout_75344;\n            \n            eta_p_74420 = mem_75772[(int64_t) 0];\n            redout_75342 = acc_74421;\n            redout_75343 = acc_74422;\n            redout_75344 = acc_74423;\n            for (int64_t i_75345 = 0; i_75345 < tile_sizze_74256; i_75345++) {\n                int64_t x_74431;\n                float x_74432;\n                bool defunc_0_neq_res_74440;\n                bool defunc_0_neq_res_74441;\n                bool cond_f_res_74442;\n                bool y_74443;\n                bool cond_74444;\n                bool defunc_0_neq_res_74445;\n                bool defunc_0_neq_res_74446;\n                bool cond_t_res_f_res_74447;\n                bool y_74448;\n                bool cond_t_res_74449;\n                bool x_74450;\n                int64_t defunc_0_op_res_74451;\n                float defunc_0_op_res_74452;\n                int64_t defunc_0_op_res_74453;\n                int64_t redout_tmp_76682;\n                float redout_tmp_76683;\n                int64_t redout_tmp_76684;\n                \n                x_74431 = ((__local int64_t *) color_76535)[i_75345];\n                x_74432 = ((__local float *) color_", "76534)[i_75345];\n                defunc_0_neq_res_74440 = redout_75343 == eta_p_74420;\n                defunc_0_neq_res_74441 = !defunc_0_neq_res_74440;\n                cond_f_res_74442 = slt64(redout_75342, (int64_t) 0);\n                y_74443 = defunc_0_neq_res_74440 && cond_f_res_74442;\n                cond_74444 = defunc_0_neq_res_74441 || y_74443;\n                defunc_0_neq_res_74445 = x_74432 == eta_p_74420;\n                defunc_0_neq_res_74446 = !defunc_0_neq_res_74445;\n                cond_t_res_f_res_74447 = slt64(x_74431, (int64_t) 0);\n                y_74448 = defunc_0_neq_res_74445 && cond_t_res_f_res_74447;\n                cond_t_res_74449 = defunc_0_neq_res_74446 || y_74448;\n                x_74450 = cond_74444 && cond_t_res_74449;\n                if (x_74450) {\n                    defunc_0_op_res_74451 = (int64_t) -1;\n                    defunc_0_op_res_74452 = eta_p_74420;\n                    defunc_0_op_res_74453 = (int64_t) 0;\n                } else {\n                    int64_t x_74433;\n                    int64_t defunc_0_op_res_f_res_74454;\n                    float defunc_0_op_res_f_res_74455;\n                    int64_t defunc_0_op_res_f_res_74456;\n                    \n                    x_74433 = ((__local int64_t *) color_76533)[i_75345];\n                    if (cond_74444) {\n                        defunc_0_op_res_f_res_74454 = x_74431;\n                        defunc_0_op_res_f_res_74455 = x_74432;\n                        defunc_0_op_res_f_res_74456 = x_74433;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74457;\n                        int64_t defunc_0_op_res_f_res_f_res_74458;\n                        int64_t defunc_0_op_res_f_res_f_res_74459;\n                        \n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74457 = redout_75343;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74457 = eta_p_7", "4420;\n                        }\n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74458 = redout_75342;\n                            defunc_0_op_res_f_res_f_res_74459 = redout_75344;\n                        } else {\n                            int64_t min_res_74460;\n                            int64_t tmp_74461;\n                            \n                            min_res_74460 = smin64(x_74431, redout_75342);\n                            tmp_74461 = add64(x_74433, redout_75344);\n                            defunc_0_op_res_f_res_f_res_74458 = min_res_74460;\n                            defunc_0_op_res_f_res_f_res_74459 = tmp_74461;\n                        }\n                        defunc_0_op_res_f_res_74454 = defunc_0_op_res_f_res_f_res_74458;\n                        defunc_0_op_res_f_res_74455 = defunc_0_op_res_f_res_f_res_74457;\n                        defunc_0_op_res_f_res_74456 = defunc_0_op_res_f_res_f_res_74459;\n                    }\n                    defunc_0_op_res_74451 = defunc_0_op_res_f_res_74454;\n                    defunc_0_op_res_74452 = defunc_0_op_res_f_res_74455;\n                    defunc_0_op_res_74453 = defunc_0_op_res_f_res_74456;\n                }\n                redout_tmp_76682 = defunc_0_op_res_74451;\n                redout_tmp_76683 = defunc_0_op_res_74452;\n                redout_tmp_76684 = defunc_0_op_res_74453;\n                redout_75342 = redout_tmp_76682;\n                redout_75343 = redout_tmp_76683;\n                redout_75344 = redout_tmp_76684;\n            }\n            x_74428 = redout_75342;\n            x_74429 = redout_75343;\n            x_74430 = redout_75344;\n            acc_74425 = x_74428;\n            acc_74426 = x_74429;\n            acc_74427 = x_74430;\n        } else {\n            acc_74425 = acc_74421;\n            acc_74426 = acc_74422;\n            acc_74427 = acc_74423;\n        }\n        mem_75797[(int64_t) 0] = acc_74425;\n        mem_75801[(int64_t) 0] = ac",
                                    "c_74426;\n        mem_75805[(int64_t) 0] = acc_74427;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76676[i_6] = mem_75797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76677[i_7] = mem_75801[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76678[i_8] = mem_75805[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75785[i_9] = mem_param_tmp_76676[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75786[i_10] = mem_param_tmp_76677[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75787[i_11] = mem_param_tmp_76678[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75808[i_12] = mem_param_75785[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75807[i_13] = mem_param_75786[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75806[i_14] = mem_param_75787[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74497) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75824[i_15] = ext_mem_75808[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75823[i_16] = ext_mem_75806[i_16];\n    } else {\n        int64_t ltid_flat_74499;\n        int64_t ltid_74498;\n        int64_t j_74514;\n        bool cond_74518;\n        int64_t pre1d_74521;\n        int64_t pre1d_74519;\n        float pre1d_74520;\n        int64_t ltid_flat_74535;\n        int64_t ltid_74534;\n        int64_t gtid_74548;\n        int64_t acc_74550;\n        int64_t acc_74552;\n        bool cond_74553;\n        int64_t acc_74554;\n        int64_t acc_74556;\n        \n        ltid_flat_74499 = sext_i32_i64(local_tid_76667);\n        ltid_74498 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74514 = ltid_74498 + binop_x_74513;\n        cond_74518 = slt64(j_74514, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_745", "21 = btoi_bool_i64(cond_74518);\n        if (cond_74518) {\n            int64_t tile_elem_74522;\n            int64_t slice_75324;\n            float tile_elem_74523;\n            \n            tile_elem_74522 = ((__global int64_t *) ext_mem_75767)[j_74514];\n            slice_75324 = tS_start_64840 + j_74514;\n            tile_elem_74523 = ((__global float *) tS_mem_75468)[slice_75324];\n            pre1d_74519 = tile_elem_74522;\n            pre1d_74520 = tile_elem_74523;\n        } else {\n            pre1d_74519 = (int64_t) 0;\n            pre1d_74520 = 0.0F;\n        }\n        ((__local int64_t *) color_76535)[ltid_74498] = pre1d_74519;\n        ((__local float *) color_76534)[ltid_74498] = pre1d_74520;\n        ((__local int64_t *) color_76533)[ltid_74498] = pre1d_74521;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74535 = sext_i32_i64(local_tid_76667);\n        ltid_74534 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74548 = binop_x_74264 + ltid_74534;\n        acc_74550 = ext_mem_75808[(int64_t) 0];\n        acc_74552 = ext_mem_75806[(int64_t) 0];\n        cond_74553 = slt64(gtid_74548, min_res_66402);\n        if (cond_74553) {\n            float eta_p_74549;\n            float acc_74551;\n            int64_t x_74557;\n            float x_74558;\n            int64_t x_74559;\n            int64_t redout_75346;\n            float redout_75347;\n            int64_t redout_75348;\n            \n            eta_p_74549 = mem_75772[(int64_t) 0];\n            acc_74551 = ext_mem_75807[(int64_t) 0];\n            redout_75346 = acc_74550;\n            redout_75347 = acc_74551;\n            redout_75348 = acc_74552;\n            for (int64_t i_75349 = 0; i_75349 < residual_input_74496; i_75349++) {\n                int64_t x_74560;\n                float x_74561;\n                bool defunc_0_neq_res_74569;\n                bool defunc_0_neq_res_74570;\n                bool cond_f_res_74571;\n                bool y_74572;\n                bool cond_74573;\n                bool defunc_0", "_neq_res_74574;\n                bool defunc_0_neq_res_74575;\n                bool cond_t_res_f_res_74576;\n                bool y_74577;\n                bool cond_t_res_74578;\n                bool x_74579;\n                int64_t defunc_0_op_res_74580;\n                float defunc_0_op_res_74581;\n                int64_t defunc_0_op_res_74582;\n                int64_t redout_tmp_76685;\n                float redout_tmp_76686;\n                int64_t redout_tmp_76687;\n                \n                x_74560 = ((__local int64_t *) color_76535)[i_75349];\n                x_74561 = ((__local float *) color_76534)[i_75349];\n                defunc_0_neq_res_74569 = redout_75347 == eta_p_74549;\n                defunc_0_neq_res_74570 = !defunc_0_neq_res_74569;\n                cond_f_res_74571 = slt64(redout_75346, (int64_t) 0);\n                y_74572 = defunc_0_neq_res_74569 && cond_f_res_74571;\n                cond_74573 = defunc_0_neq_res_74570 || y_74572;\n                defunc_0_neq_res_74574 = x_74561 == eta_p_74549;\n                defunc_0_neq_res_74575 = !defunc_0_neq_res_74574;\n                cond_t_res_f_res_74576 = slt64(x_74560, (int64_t) 0);\n                y_74577 = defunc_0_neq_res_74574 && cond_t_res_f_res_74576;\n                cond_t_res_74578 = defunc_0_neq_res_74575 || y_74577;\n                x_74579 = cond_74573 && cond_t_res_74578;\n                if (x_74579) {\n                    defunc_0_op_res_74580 = (int64_t) -1;\n                    defunc_0_op_res_74581 = eta_p_74549;\n                    defunc_0_op_res_74582 = (int64_t) 0;\n                } else {\n                    int64_t x_74562;\n                    int64_t defunc_0_op_res_f_res_74583;\n                    float defunc_0_op_res_f_res_74584;\n                    int64_t defunc_0_op_res_f_res_74585;\n                    \n                    x_74562 = ((__local int64_t *) color_76533)[i_75349];\n                    if (cond_74573) {\n                        defunc_0_op_res_f_res_74583 = x_74560;\n   ",
                                    "                     defunc_0_op_res_f_res_74584 = x_74561;\n                        defunc_0_op_res_f_res_74585 = x_74562;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74586;\n                        int64_t defunc_0_op_res_f_res_f_res_74587;\n                        int64_t defunc_0_op_res_f_res_f_res_74588;\n                        \n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74586 = redout_75347;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74586 = eta_p_74549;\n                        }\n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74587 = redout_75346;\n                            defunc_0_op_res_f_res_f_res_74588 = redout_75348;\n                        } else {\n                            int64_t min_res_74589;\n                            int64_t tmp_74590;\n                            \n                            min_res_74589 = smin64(x_74560, redout_75346);\n                            tmp_74590 = add64(x_74562, redout_75348);\n                            defunc_0_op_res_f_res_f_res_74587 = min_res_74589;\n                            defunc_0_op_res_f_res_f_res_74588 = tmp_74590;\n                        }\n                        defunc_0_op_res_f_res_74583 = defunc_0_op_res_f_res_f_res_74587;\n                        defunc_0_op_res_f_res_74584 = defunc_0_op_res_f_res_f_res_74586;\n                        defunc_0_op_res_f_res_74585 = defunc_0_op_res_f_res_f_res_74588;\n                    }\n                    defunc_0_op_res_74580 = defunc_0_op_res_f_res_74583;\n                    defunc_0_op_res_74581 = defunc_0_op_res_f_res_74584;\n                    defunc_0_op_res_74582 = defunc_0_op_res_f_res_74585;\n                }\n                redout_tmp_76685 = defunc_0_op_res_74580;\n                redout_tmp_76686 = defunc_0_op_res_74581;\n                redout_tmp_7668", "7 = defunc_0_op_res_74582;\n                redout_75346 = redout_tmp_76685;\n                redout_75347 = redout_tmp_76686;\n                redout_75348 = redout_tmp_76687;\n            }\n            x_74557 = redout_75346;\n            x_74558 = redout_75347;\n            x_74559 = redout_75348;\n            acc_74554 = x_74557;\n            acc_74556 = x_74559;\n        } else {\n            acc_74554 = acc_74550;\n            acc_74556 = acc_74552;\n        }\n        mem_75818[(int64_t) 0] = acc_74554;\n        mem_75822[(int64_t) 0] = acc_74556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75824[i_17] = mem_75818[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75823[i_18] = mem_75822[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76688 = ext_mem_75824[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75826)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76688;\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76689 = ext_mem_75823[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75828)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76689;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74256\n    #undef bytes_75788\n    #undef bytes_75790\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_74609_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_74609(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74612, int64_t num_whole_tiles_74627, int64_t residual_input_74851, unsigned char cond_74852_bits, int64_t binop_x_74868, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned ch", "ar *ext_mem_75562, __global unsigned char *mem_75682, __global unsigned char *mem_75684)\n{\n    bool cond_74852 = cond_74852_bits;\n    \n    #define tile_sizze_74611 (inner_SMJ_floatzisegmap_intrablock_74609zitile_sizze_74611)\n    #define bytes_75644 (inner_SMJ_floatzisegmap_intrablock_74609zibytes_75644)\n    #define bytes_75646 (inner_SMJ_floatzisegmap_intrablock_74609zibytes_75646)\n    \n    volatile __local unsigned char *color_76538_backing_2 = &shared_mem[0];\n    const int64_t color_76538_backing_2_offset = 0 + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76537_backing_1 = &shared_mem[color_76538_backing_2_offset];\n    const int64_t color_76537_backing_1_offset = color_76538_backing_2_offset + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76536_backing_0 = &shared_mem[color_76537_backing_1_offset];\n    const int64_t color_76536_backing_0_offset = color_76537_backing_1_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76808;\n    int32_t tblock_sizze_76811;\n    int32_t wave_sizze_76810;\n    int32_t block_id_76809;\n    int32_t global_tid_76807;\n    int64_t gid_flat_74609;\n    int64_t slice_76813;\n    int64_t ltid_pre_76812;\n    int64_t remnant_76814;\n    int64_t slice_76815;\n    int64_t gid_74608;\n    int64_t remnant_76816;\n    __local unsigned char *color_76536;\n    __local unsigned char *color_76537;\n    __local unsigned char *color_76538;\n    int64_t binop_x_74619;\n    float mem_75628[1];\n    int64_t ltid_flat_74614;\n    int64_t ltid_74613;\n    int64_t gtid_74620;\n    bool cond_74621;\n    float pre_74622;\n    int64_t mem_75632[1];\n    float mem_75636[1];\n    int64_t mem_75640[1];\n    int64_t ltid_flat_74629;\n    int64_t ltid_74628;\n    int64_t gtid_74639;\n    bool cond_74640;\n    int6",
                                    "4_t neutral_74641;\n    float neutral_74642;\n    int64_t ext_mem_75664[1];\n    float ext_mem_75663[1];\n    int64_t ext_mem_75662[1];\n    int64_t mem_param_75641[1];\n    float mem_param_75642[1];\n    int64_t mem_param_75643[1];\n    int64_t mem_75674[1];\n    int64_t mem_75678[1];\n    int64_t ext_mem_75680[1];\n    int64_t ext_mem_75679[1];\n    \n    local_tid_76808 = get_local_id(0);\n    tblock_sizze_76811 = get_local_size(0);\n    wave_sizze_76810 = LOCKSTEP_WIDTH;\n    block_id_76809 = get_tblock_id(0);\n    global_tid_76807 = block_id_76809 * tblock_sizze_76811 + local_tid_76808;\n    gid_flat_74609 = sext_i32_i64(block_id_76809);\n    slice_76813 = tile_sizze_74611;\n    ltid_pre_76812 = sext_i32_i64(local_tid_76808);\n    remnant_76814 = sext_i32_i64(local_tid_76808) - ltid_pre_76812;\n    slice_76815 = ldim_74612;\n    gid_74608 = sext_i32_i64(block_id_76809);\n    remnant_76816 = sext_i32_i64(block_id_76809) - gid_74608;\n    color_76536 = (__local unsigned char *) color_76536_backing_0;\n    color_76537 = (__local unsigned char *) color_76537_backing_1;\n    color_76538 = (__local unsigned char *) color_76538_backing_2;\n    binop_x_74619 = gid_74608 * tile_sizze_74611;\n    ltid_flat_74614 = sext_i32_i64(local_tid_76808);\n    ltid_74613 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74620 = ltid_74613 + binop_x_74619;\n    cond_74621 = slt64(gtid_74620, min_res_65540);\n    if (cond_74621) {\n        int64_t slice_74623;\n        float eta_p_74624;\n        \n        slice_74623 = slice_65554 + gtid_74620;\n        eta_p_74624 = ((__global float *) tR_mem_75467)[slice_74623];\n        pre_74622 = eta_p_74624;\n    } else {\n        pre_74622 = 0.0F;\n    }\n    mem_75628[(int64_t) 0] = pre_74622;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74629 = sext_i32_i64(local_tid_76808);\n    ltid_74628 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74639 = binop_x_74619 + ltid_74628;\n    cond_74640 = slt64(gtid_74639, min_res_65540);\n    if (cond_74640) {\n        neutral_74641 =", " (int64_t) -1;\n    } else {\n        neutral_74641 = (int64_t) 0;\n    }\n    if (cond_74640) {\n        float eta_p_74644 = mem_75628[(int64_t) 0];\n        \n        neutral_74642 = eta_p_74644;\n    } else {\n        neutral_74642 = 0.0F;\n    }\n    mem_75632[(int64_t) 0] = neutral_74641;\n    mem_75636[(int64_t) 0] = neutral_74642;\n    mem_75640[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75641[i_3] = mem_75632[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75642[i_4] = mem_75636[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75643[i_5] = mem_75640[i_5];\n    for (int64_t tile_id_74654 = 0; tile_id_74654 < num_whole_tiles_74627; tile_id_74654++) {\n        int64_t binop_x_74753;\n        int64_t ltid_flat_74752;\n        int64_t ltid_74751;\n        int64_t j_74754;\n        bool cond_74758;\n        int64_t pre1d_74761;\n        int64_t pre1d_74759;\n        float pre1d_74760;\n        int64_t mem_75653[1];\n        float mem_75657[1];\n        int64_t mem_75661[1];\n        int64_t ltid_flat_74772;\n        int64_t ltid_74771;\n        int64_t gtid_74774;\n        int64_t acc_74776;\n        float acc_74777;\n        int64_t acc_74778;\n        bool cond_74779;\n        int64_t acc_74780;\n        float acc_74781;\n        int64_t acc_74782;\n        int64_t mem_param_tmp_76817[1];\n        float mem_param_tmp_76818[1];\n        int64_t mem_param_tmp_76819[1];\n        \n        binop_x_74753 = tile_sizze_74611 * tile_id_74654;\n        ltid_flat_74752 = sext_i32_i64(local_tid_76808);\n        ltid_74751 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74754 = ltid_74751 + binop_x_74753;\n        cond_74758 = slt64(j_74754, j_m_i_65502);\n        pre1d_74761 = btoi_bool_i64(cond_74758);\n        if (cond_74758) {\n            int64_t tile_elem_74762;\n            int64_t slice_75329;\n            float tile_elem_74763;\n            \n            tile_e", "lem_74762 = ((__global int64_t *) ext_mem_75562)[j_74754];\n            slice_75329 = slice_65911 + j_74754;\n            tile_elem_74763 = ((__global float *) tS_mem_75468)[slice_75329];\n            pre1d_74759 = tile_elem_74762;\n            pre1d_74760 = tile_elem_74763;\n        } else {\n            pre1d_74759 = (int64_t) 0;\n            pre1d_74760 = 0.0F;\n        }\n        ((__local int64_t *) color_76538)[ltid_74751] = pre1d_74759;\n        ((__local float *) color_76537)[ltid_74751] = pre1d_74760;\n        ((__local int64_t *) color_76536)[ltid_74751] = pre1d_74761;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74772 = sext_i32_i64(local_tid_76808);\n        ltid_74771 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74774 = binop_x_74619 + ltid_74771;\n        acc_74776 = mem_param_75641[(int64_t) 0];\n        acc_74777 = mem_param_75642[(int64_t) 0];\n        acc_74778 = mem_param_75643[(int64_t) 0];\n        cond_74779 = slt64(gtid_74774, min_res_65540);\n        if (cond_74779) {\n            float eta_p_74775;\n            int64_t x_74783;\n            float x_74784;\n            int64_t x_74785;\n            int64_t redout_75350;\n            float redout_75351;\n            int64_t redout_75352;\n            \n            eta_p_74775 = mem_75628[(int64_t) 0];\n            redout_75350 = acc_74776;\n            redout_75351 = acc_74777;\n            redout_75352 = acc_74778;\n            for (int64_t i_75353 = 0; i_75353 < tile_sizze_74611; i_75353++) {\n                int64_t x_74786;\n                float x_74787;\n                bool defunc_0_neq_res_74795;\n                bool defunc_0_neq_res_74796;\n                bool cond_f_res_74797;\n                bool y_74798;\n                bool cond_74799;\n                bool defunc_0_neq_res_74800;\n                bool defunc_0_neq_res_74801;\n                bool cond_t_res_f_res_74802;\n                bool y_74803;\n                bool cond_t_res_74804;\n                bool x_74805;\n                int64_t",
                                    " defunc_0_op_res_74806;\n                float defunc_0_op_res_74807;\n                int64_t defunc_0_op_res_74808;\n                int64_t redout_tmp_76823;\n                float redout_tmp_76824;\n                int64_t redout_tmp_76825;\n                \n                x_74786 = ((__local int64_t *) color_76538)[i_75353];\n                x_74787 = ((__local float *) color_76537)[i_75353];\n                defunc_0_neq_res_74795 = redout_75351 == eta_p_74775;\n                defunc_0_neq_res_74796 = !defunc_0_neq_res_74795;\n                cond_f_res_74797 = slt64(redout_75350, (int64_t) 0);\n                y_74798 = defunc_0_neq_res_74795 && cond_f_res_74797;\n                cond_74799 = defunc_0_neq_res_74796 || y_74798;\n                defunc_0_neq_res_74800 = x_74787 == eta_p_74775;\n                defunc_0_neq_res_74801 = !defunc_0_neq_res_74800;\n                cond_t_res_f_res_74802 = slt64(x_74786, (int64_t) 0);\n                y_74803 = defunc_0_neq_res_74800 && cond_t_res_f_res_74802;\n                cond_t_res_74804 = defunc_0_neq_res_74801 || y_74803;\n                x_74805 = cond_74799 && cond_t_res_74804;\n                if (x_74805) {\n                    defunc_0_op_res_74806 = (int64_t) -1;\n                    defunc_0_op_res_74807 = eta_p_74775;\n                    defunc_0_op_res_74808 = (int64_t) 0;\n                } else {\n                    int64_t x_74788;\n                    int64_t defunc_0_op_res_f_res_74809;\n                    float defunc_0_op_res_f_res_74810;\n                    int64_t defunc_0_op_res_f_res_74811;\n                    \n                    x_74788 = ((__local int64_t *) color_76536)[i_75353];\n                    if (cond_74799) {\n                        defunc_0_op_res_f_res_74809 = x_74786;\n                        defunc_0_op_res_f_res_74810 = x_74787;\n                        defunc_0_op_res_f_res_74811 = x_74788;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74812;\n           ", "             int64_t defunc_0_op_res_f_res_f_res_74813;\n                        int64_t defunc_0_op_res_f_res_f_res_74814;\n                        \n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74812 = redout_75351;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74812 = eta_p_74775;\n                        }\n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74813 = redout_75350;\n                            defunc_0_op_res_f_res_f_res_74814 = redout_75352;\n                        } else {\n                            int64_t min_res_74815;\n                            int64_t tmp_74816;\n                            \n                            min_res_74815 = smin64(x_74786, redout_75350);\n                            tmp_74816 = add64(x_74788, redout_75352);\n                            defunc_0_op_res_f_res_f_res_74813 = min_res_74815;\n                            defunc_0_op_res_f_res_f_res_74814 = tmp_74816;\n                        }\n                        defunc_0_op_res_f_res_74809 = defunc_0_op_res_f_res_f_res_74813;\n                        defunc_0_op_res_f_res_74810 = defunc_0_op_res_f_res_f_res_74812;\n                        defunc_0_op_res_f_res_74811 = defunc_0_op_res_f_res_f_res_74814;\n                    }\n                    defunc_0_op_res_74806 = defunc_0_op_res_f_res_74809;\n                    defunc_0_op_res_74807 = defunc_0_op_res_f_res_74810;\n                    defunc_0_op_res_74808 = defunc_0_op_res_f_res_74811;\n                }\n                redout_tmp_76823 = defunc_0_op_res_74806;\n                redout_tmp_76824 = defunc_0_op_res_74807;\n                redout_tmp_76825 = defunc_0_op_res_74808;\n                redout_75350 = redout_tmp_76823;\n                redout_75351 = redout_tmp_76824;\n                redout_75352 = redout_tmp_76825;\n            }\n            x_74783 = redout_75350;\n    ", "        x_74784 = redout_75351;\n            x_74785 = redout_75352;\n            acc_74780 = x_74783;\n            acc_74781 = x_74784;\n            acc_74782 = x_74785;\n        } else {\n            acc_74780 = acc_74776;\n            acc_74781 = acc_74777;\n            acc_74782 = acc_74778;\n        }\n        mem_75653[(int64_t) 0] = acc_74780;\n        mem_75657[(int64_t) 0] = acc_74781;\n        mem_75661[(int64_t) 0] = acc_74782;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76817[i_6] = mem_75653[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76818[i_7] = mem_75657[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76819[i_8] = mem_75661[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75641[i_9] = mem_param_tmp_76817[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75642[i_10] = mem_param_tmp_76818[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75643[i_11] = mem_param_tmp_76819[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75664[i_12] = mem_param_75641[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75663[i_13] = mem_param_75642[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75662[i_14] = mem_param_75643[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74852) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75680[i_15] = ext_mem_75664[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75679[i_16] = ext_mem_75662[i_16];\n    } else {\n        int64_t ltid_flat_74854;\n        int64_t ltid_74853;\n        int64_t j_74869;\n        bool cond_74873;\n        int64_t pre1d_74876;\n        int64_t pre1d_74874;\n        float pre1d_74875;\n        int64_t ltid_flat_74890;\n        int64_t ltid_74889;\n        int64_t gtid_74903;\n        int64_t acc_74905;\n        ",
                                    "int64_t acc_74907;\n        bool cond_74908;\n        int64_t acc_74909;\n        int64_t acc_74911;\n        \n        ltid_flat_74854 = sext_i32_i64(local_tid_76808);\n        ltid_74853 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74869 = ltid_74853 + binop_x_74868;\n        cond_74873 = slt64(j_74869, j_m_i_65502);\n        pre1d_74876 = btoi_bool_i64(cond_74873);\n        if (cond_74873) {\n            int64_t tile_elem_74877;\n            int64_t slice_75328;\n            float tile_elem_74878;\n            \n            tile_elem_74877 = ((__global int64_t *) ext_mem_75562)[j_74869];\n            slice_75328 = slice_65911 + j_74869;\n            tile_elem_74878 = ((__global float *) tS_mem_75468)[slice_75328];\n            pre1d_74874 = tile_elem_74877;\n            pre1d_74875 = tile_elem_74878;\n        } else {\n            pre1d_74874 = (int64_t) 0;\n            pre1d_74875 = 0.0F;\n        }\n        ((__local int64_t *) color_76538)[ltid_74853] = pre1d_74874;\n        ((__local float *) color_76537)[ltid_74853] = pre1d_74875;\n        ((__local int64_t *) color_76536)[ltid_74853] = pre1d_74876;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74890 = sext_i32_i64(local_tid_76808);\n        ltid_74889 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74903 = binop_x_74619 + ltid_74889;\n        acc_74905 = ext_mem_75664[(int64_t) 0];\n        acc_74907 = ext_mem_75662[(int64_t) 0];\n        cond_74908 = slt64(gtid_74903, min_res_65540);\n        if (cond_74908) {\n            float eta_p_74904;\n            float acc_74906;\n            int64_t x_74912;\n            float x_74913;\n            int64_t x_74914;\n            int64_t redout_75354;\n            float redout_75355;\n            int64_t redout_75356;\n            \n            eta_p_74904 = mem_75628[(int64_t) 0];\n            acc_74906 = ext_mem_75663[(int64_t) 0];\n            redout_75354 = acc_74905;\n            redout_75355 = acc_74906;\n            redout_75356 = acc_74907;\n            for (int64_t i_75", "357 = 0; i_75357 < residual_input_74851; i_75357++) {\n                int64_t x_74915;\n                float x_74916;\n                bool defunc_0_neq_res_74924;\n                bool defunc_0_neq_res_74925;\n                bool cond_f_res_74926;\n                bool y_74927;\n                bool cond_74928;\n                bool defunc_0_neq_res_74929;\n                bool defunc_0_neq_res_74930;\n                bool cond_t_res_f_res_74931;\n                bool y_74932;\n                bool cond_t_res_74933;\n                bool x_74934;\n                int64_t defunc_0_op_res_74935;\n                float defunc_0_op_res_74936;\n                int64_t defunc_0_op_res_74937;\n                int64_t redout_tmp_76826;\n                float redout_tmp_76827;\n                int64_t redout_tmp_76828;\n                \n                x_74915 = ((__local int64_t *) color_76538)[i_75357];\n                x_74916 = ((__local float *) color_76537)[i_75357];\n                defunc_0_neq_res_74924 = redout_75355 == eta_p_74904;\n                defunc_0_neq_res_74925 = !defunc_0_neq_res_74924;\n                cond_f_res_74926 = slt64(redout_75354, (int64_t) 0);\n                y_74927 = defunc_0_neq_res_74924 && cond_f_res_74926;\n                cond_74928 = defunc_0_neq_res_74925 || y_74927;\n                defunc_0_neq_res_74929 = x_74916 == eta_p_74904;\n                defunc_0_neq_res_74930 = !defunc_0_neq_res_74929;\n                cond_t_res_f_res_74931 = slt64(x_74915, (int64_t) 0);\n                y_74932 = defunc_0_neq_res_74929 && cond_t_res_f_res_74931;\n                cond_t_res_74933 = defunc_0_neq_res_74930 || y_74932;\n                x_74934 = cond_74928 && cond_t_res_74933;\n                if (x_74934) {\n                    defunc_0_op_res_74935 = (int64_t) -1;\n                    defunc_0_op_res_74936 = eta_p_74904;\n                    defunc_0_op_res_74937 = (int64_t) 0;\n                } else {\n                    int64_t x_74917;\n                    int64_t d", "efunc_0_op_res_f_res_74938;\n                    float defunc_0_op_res_f_res_74939;\n                    int64_t defunc_0_op_res_f_res_74940;\n                    \n                    x_74917 = ((__local int64_t *) color_76536)[i_75357];\n                    if (cond_74928) {\n                        defunc_0_op_res_f_res_74938 = x_74915;\n                        defunc_0_op_res_f_res_74939 = x_74916;\n                        defunc_0_op_res_f_res_74940 = x_74917;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_74941;\n                        int64_t defunc_0_op_res_f_res_f_res_74942;\n                        int64_t defunc_0_op_res_f_res_f_res_74943;\n                        \n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74941 = redout_75355;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74941 = eta_p_74904;\n                        }\n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74942 = redout_75354;\n                            defunc_0_op_res_f_res_f_res_74943 = redout_75356;\n                        } else {\n                            int64_t min_res_74944;\n                            int64_t tmp_74945;\n                            \n                            min_res_74944 = smin64(x_74915, redout_75354);\n                            tmp_74945 = add64(x_74917, redout_75356);\n                            defunc_0_op_res_f_res_f_res_74942 = min_res_74944;\n                            defunc_0_op_res_f_res_f_res_74943 = tmp_74945;\n                        }\n                        defunc_0_op_res_f_res_74938 = defunc_0_op_res_f_res_f_res_74942;\n                        defunc_0_op_res_f_res_74939 = defunc_0_op_res_f_res_f_res_74941;\n                        defunc_0_op_res_f_res_74940 = defunc_0_op_res_f_res_f_res_74943;\n                    }\n                    defunc_0_op_res_74935 = d",
                                    "efunc_0_op_res_f_res_74938;\n                    defunc_0_op_res_74936 = defunc_0_op_res_f_res_74939;\n                    defunc_0_op_res_74937 = defunc_0_op_res_f_res_74940;\n                }\n                redout_tmp_76826 = defunc_0_op_res_74935;\n                redout_tmp_76827 = defunc_0_op_res_74936;\n                redout_tmp_76828 = defunc_0_op_res_74937;\n                redout_75354 = redout_tmp_76826;\n                redout_75355 = redout_tmp_76827;\n                redout_75356 = redout_tmp_76828;\n            }\n            x_74912 = redout_75354;\n            x_74913 = redout_75355;\n            x_74914 = redout_75356;\n            acc_74909 = x_74912;\n            acc_74911 = x_74914;\n        } else {\n            acc_74909 = acc_74905;\n            acc_74911 = acc_74907;\n        }\n        mem_75674[(int64_t) 0] = acc_74909;\n        mem_75678[(int64_t) 0] = acc_74911;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75680[i_17] = mem_75674[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75679[i_18] = mem_75678[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76829 = ext_mem_75680[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75682)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76829;\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76830 = ext_mem_75679[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75684)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76830;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74611\n    #undef bytes_75644\n    #undef bytes_75646\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegmap_intrablock_74964_dim1, 1, 1)\nvoid inner_SMJ_floatzisegmap_intrablock_74964(__global", " int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74967, int64_t num_whole_tiles_74982, int64_t residual_input_75206, unsigned char cond_75207_bits, int64_t binop_x_75223, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75621, __global unsigned char *mem_75623)\n{\n    bool cond_75207 = cond_75207_bits;\n    \n    #define tile_sizze_74966 (inner_SMJ_floatzisegmap_intrablock_74964zitile_sizze_74966)\n    #define bytes_75583 (inner_SMJ_floatzisegmap_intrablock_74964zibytes_75583)\n    #define bytes_75585 (inner_SMJ_floatzisegmap_intrablock_74964zibytes_75585)\n    \n    volatile __local unsigned char *color_76541_backing_2 = &shared_mem[0];\n    const int64_t color_76541_backing_2_offset = 0 + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76540_backing_1 = &shared_mem[color_76541_backing_2_offset];\n    const int64_t color_76540_backing_1_offset = color_76541_backing_2_offset + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76539_backing_0 = &shared_mem[color_76540_backing_1_offset];\n    const int64_t color_76539_backing_0_offset = color_76540_backing_1_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76834;\n    int32_t tblock_sizze_76837;\n    int32_t wave_sizze_76836;\n    int32_t block_id_76835;\n    int32_t global_tid_76833;\n    int64_t gid_flat_74964;\n    int64_t slice_76839;\n    int64_t ltid_pre_76838;\n    int64_t remnant_76840;\n    int64_t slice_76841;\n    int64_t gid_74963;\n    int64_t remnant_76842;\n    __local unsigned char *color_76539;\n    __local unsigned char *color_76540;\n    __local unsigned char *color_76541;\n    int64_t b", "inop_x_74974;\n    float mem_75567[1];\n    int64_t ltid_flat_74969;\n    int64_t ltid_74968;\n    int64_t gtid_74975;\n    bool cond_74976;\n    float pre_74977;\n    int64_t mem_75571[1];\n    float mem_75575[1];\n    int64_t mem_75579[1];\n    int64_t ltid_flat_74984;\n    int64_t ltid_74983;\n    int64_t gtid_74994;\n    bool cond_74995;\n    int64_t neutral_74996;\n    float neutral_74997;\n    int64_t ext_mem_75603[1];\n    float ext_mem_75602[1];\n    int64_t ext_mem_75601[1];\n    int64_t mem_param_75580[1];\n    float mem_param_75581[1];\n    int64_t mem_param_75582[1];\n    int64_t mem_75613[1];\n    int64_t mem_75617[1];\n    int64_t ext_mem_75619[1];\n    int64_t ext_mem_75618[1];\n    \n    local_tid_76834 = get_local_id(0);\n    tblock_sizze_76837 = get_local_size(0);\n    wave_sizze_76836 = LOCKSTEP_WIDTH;\n    block_id_76835 = get_tblock_id(0);\n    global_tid_76833 = block_id_76835 * tblock_sizze_76837 + local_tid_76834;\n    gid_flat_74964 = sext_i32_i64(block_id_76835);\n    slice_76839 = tile_sizze_74966;\n    ltid_pre_76838 = sext_i32_i64(local_tid_76834);\n    remnant_76840 = sext_i32_i64(local_tid_76834) - ltid_pre_76838;\n    slice_76841 = ldim_74967;\n    gid_74963 = sext_i32_i64(block_id_76835);\n    remnant_76842 = sext_i32_i64(block_id_76835) - gid_74963;\n    color_76539 = (__local unsigned char *) color_76539_backing_0;\n    color_76540 = (__local unsigned char *) color_76540_backing_1;\n    color_76541 = (__local unsigned char *) color_76541_backing_2;\n    binop_x_74974 = gid_74963 * tile_sizze_74966;\n    ltid_flat_74969 = sext_i32_i64(local_tid_76834);\n    ltid_74968 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74975 = ltid_74968 + binop_x_74974;\n    cond_74976 = slt64(gtid_74975, min_res_65540);\n    if (cond_74976) {\n        int64_t slice_74978;\n        float eta_p_74979;\n        \n        slice_74978 = slice_65554 + gtid_74975;\n        eta_p_74979 = ((__global float *) tR_mem_75467)[slice_74978];\n        pre_74977 = eta_p_74979;\n    } else {\n        pre_74977 = 0.",
                                    "0F;\n    }\n    mem_75567[(int64_t) 0] = pre_74977;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74984 = sext_i32_i64(local_tid_76834);\n    ltid_74983 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74994 = binop_x_74974 + ltid_74983;\n    cond_74995 = slt64(gtid_74994, min_res_65540);\n    if (cond_74995) {\n        neutral_74996 = (int64_t) -1;\n    } else {\n        neutral_74996 = (int64_t) 0;\n    }\n    if (cond_74995) {\n        float eta_p_74999 = mem_75567[(int64_t) 0];\n        \n        neutral_74997 = eta_p_74999;\n    } else {\n        neutral_74997 = 0.0F;\n    }\n    mem_75571[(int64_t) 0] = neutral_74996;\n    mem_75575[(int64_t) 0] = neutral_74997;\n    mem_75579[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75580[i_3] = mem_75571[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75581[i_4] = mem_75575[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75582[i_5] = mem_75579[i_5];\n    for (int64_t tile_id_75009 = 0; tile_id_75009 < num_whole_tiles_74982; tile_id_75009++) {\n        int64_t binop_x_75108;\n        int64_t ltid_flat_75107;\n        int64_t ltid_75106;\n        int64_t j_75109;\n        bool cond_75113;\n        int64_t pre1d_75116;\n        int64_t pre1d_75114;\n        float pre1d_75115;\n        int64_t mem_75592[1];\n        float mem_75596[1];\n        int64_t mem_75600[1];\n        int64_t ltid_flat_75127;\n        int64_t ltid_75126;\n        int64_t gtid_75129;\n        int64_t acc_75131;\n        float acc_75132;\n        int64_t acc_75133;\n        bool cond_75134;\n        int64_t acc_75135;\n        float acc_75136;\n        int64_t acc_75137;\n        int64_t mem_param_tmp_76843[1];\n        float mem_param_tmp_76844[1];\n        int64_t mem_param_tmp_76845[1];\n        \n        binop_x_75108 = tile_sizze_74966 * tile_id_75009;\n        ltid_flat_75107 = sext_i32_i64(local_tid_76834);\n        ltid_75106 = sext_i32_i64", "(sext_i64_i32(ltid_pre_76838));\n        j_75109 = ltid_75106 + binop_x_75108;\n        cond_75113 = slt64(j_75109, j_m_i_65502);\n        pre1d_75116 = btoi_bool_i64(cond_75113);\n        if (cond_75113) {\n            int64_t tile_elem_75117;\n            int64_t slice_75333;\n            float tile_elem_75118;\n            \n            tile_elem_75117 = ((__global int64_t *) ext_mem_75562)[j_75109];\n            slice_75333 = slice_65911 + j_75109;\n            tile_elem_75118 = ((__global float *) tS_mem_75468)[slice_75333];\n            pre1d_75114 = tile_elem_75117;\n            pre1d_75115 = tile_elem_75118;\n        } else {\n            pre1d_75114 = (int64_t) 0;\n            pre1d_75115 = 0.0F;\n        }\n        ((__local int64_t *) color_76541)[ltid_75106] = pre1d_75114;\n        ((__local float *) color_76540)[ltid_75106] = pre1d_75115;\n        ((__local int64_t *) color_76539)[ltid_75106] = pre1d_75116;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75127 = sext_i32_i64(local_tid_76834);\n        ltid_75126 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75129 = binop_x_74974 + ltid_75126;\n        acc_75131 = mem_param_75580[(int64_t) 0];\n        acc_75132 = mem_param_75581[(int64_t) 0];\n        acc_75133 = mem_param_75582[(int64_t) 0];\n        cond_75134 = slt64(gtid_75129, min_res_65540);\n        if (cond_75134) {\n            float eta_p_75130;\n            int64_t x_75138;\n            float x_75139;\n            int64_t x_75140;\n            int64_t redout_75358;\n            float redout_75359;\n            int64_t redout_75360;\n            \n            eta_p_75130 = mem_75567[(int64_t) 0];\n            redout_75358 = acc_75131;\n            redout_75359 = acc_75132;\n            redout_75360 = acc_75133;\n            for (int64_t i_75361 = 0; i_75361 < tile_sizze_74966; i_75361++) {\n                int64_t x_75141;\n                float x_75142;\n                bool defunc_0_neq_res_75150;\n                bool defunc_0_neq_res_75151;\n                bool", " cond_f_res_75152;\n                bool y_75153;\n                bool cond_75154;\n                bool defunc_0_neq_res_75155;\n                bool defunc_0_neq_res_75156;\n                bool cond_t_res_f_res_75157;\n                bool y_75158;\n                bool cond_t_res_75159;\n                bool x_75160;\n                int64_t defunc_0_op_res_75161;\n                float defunc_0_op_res_75162;\n                int64_t defunc_0_op_res_75163;\n                int64_t redout_tmp_76849;\n                float redout_tmp_76850;\n                int64_t redout_tmp_76851;\n                \n                x_75141 = ((__local int64_t *) color_76541)[i_75361];\n                x_75142 = ((__local float *) color_76540)[i_75361];\n                defunc_0_neq_res_75150 = redout_75359 == eta_p_75130;\n                defunc_0_neq_res_75151 = !defunc_0_neq_res_75150;\n                cond_f_res_75152 = slt64(redout_75358, (int64_t) 0);\n                y_75153 = defunc_0_neq_res_75150 && cond_f_res_75152;\n                cond_75154 = defunc_0_neq_res_75151 || y_75153;\n                defunc_0_neq_res_75155 = x_75142 == eta_p_75130;\n                defunc_0_neq_res_75156 = !defunc_0_neq_res_75155;\n                cond_t_res_f_res_75157 = slt64(x_75141, (int64_t) 0);\n                y_75158 = defunc_0_neq_res_75155 && cond_t_res_f_res_75157;\n                cond_t_res_75159 = defunc_0_neq_res_75156 || y_75158;\n                x_75160 = cond_75154 && cond_t_res_75159;\n                if (x_75160) {\n                    defunc_0_op_res_75161 = (int64_t) -1;\n                    defunc_0_op_res_75162 = eta_p_75130;\n                    defunc_0_op_res_75163 = (int64_t) 0;\n                } else {\n                    int64_t x_75143;\n                    int64_t defunc_0_op_res_f_res_75164;\n                    float defunc_0_op_res_f_res_75165;\n                    int64_t defunc_0_op_res_f_res_75166;\n                    \n                    x_75143 = ((__local int64_t *) color_76539)[i_7",
                                    "5361];\n                    if (cond_75154) {\n                        defunc_0_op_res_f_res_75164 = x_75141;\n                        defunc_0_op_res_f_res_75165 = x_75142;\n                        defunc_0_op_res_f_res_75166 = x_75143;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_75167;\n                        int64_t defunc_0_op_res_f_res_f_res_75168;\n                        int64_t defunc_0_op_res_f_res_f_res_75169;\n                        \n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75167 = redout_75359;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75167 = eta_p_75130;\n                        }\n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75168 = redout_75358;\n                            defunc_0_op_res_f_res_f_res_75169 = redout_75360;\n                        } else {\n                            int64_t min_res_75170;\n                            int64_t tmp_75171;\n                            \n                            min_res_75170 = smin64(x_75141, redout_75358);\n                            tmp_75171 = add64(x_75143, redout_75360);\n                            defunc_0_op_res_f_res_f_res_75168 = min_res_75170;\n                            defunc_0_op_res_f_res_f_res_75169 = tmp_75171;\n                        }\n                        defunc_0_op_res_f_res_75164 = defunc_0_op_res_f_res_f_res_75168;\n                        defunc_0_op_res_f_res_75165 = defunc_0_op_res_f_res_f_res_75167;\n                        defunc_0_op_res_f_res_75166 = defunc_0_op_res_f_res_f_res_75169;\n                    }\n                    defunc_0_op_res_75161 = defunc_0_op_res_f_res_75164;\n                    defunc_0_op_res_75162 = defunc_0_op_res_f_res_75165;\n                    defunc_0_op_res_75163 = defunc_0_op_res_f_res_75166;\n                }\n                redout_tmp_76849 = d", "efunc_0_op_res_75161;\n                redout_tmp_76850 = defunc_0_op_res_75162;\n                redout_tmp_76851 = defunc_0_op_res_75163;\n                redout_75358 = redout_tmp_76849;\n                redout_75359 = redout_tmp_76850;\n                redout_75360 = redout_tmp_76851;\n            }\n            x_75138 = redout_75358;\n            x_75139 = redout_75359;\n            x_75140 = redout_75360;\n            acc_75135 = x_75138;\n            acc_75136 = x_75139;\n            acc_75137 = x_75140;\n        } else {\n            acc_75135 = acc_75131;\n            acc_75136 = acc_75132;\n            acc_75137 = acc_75133;\n        }\n        mem_75592[(int64_t) 0] = acc_75135;\n        mem_75596[(int64_t) 0] = acc_75136;\n        mem_75600[(int64_t) 0] = acc_75137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76843[i_6] = mem_75592[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76844[i_7] = mem_75596[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76845[i_8] = mem_75600[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75580[i_9] = mem_param_tmp_76843[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75581[i_10] = mem_param_tmp_76844[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75582[i_11] = mem_param_tmp_76845[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75603[i_12] = mem_param_75580[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75602[i_13] = mem_param_75581[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75601[i_14] = mem_param_75582[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_75207) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75619[i_15] = ext_mem_75603[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75618[i_16] = ext_mem_75601[i", "_16];\n    } else {\n        int64_t ltid_flat_75209;\n        int64_t ltid_75208;\n        int64_t j_75224;\n        bool cond_75228;\n        int64_t pre1d_75231;\n        int64_t pre1d_75229;\n        float pre1d_75230;\n        int64_t ltid_flat_75245;\n        int64_t ltid_75244;\n        int64_t gtid_75258;\n        int64_t acc_75260;\n        int64_t acc_75262;\n        bool cond_75263;\n        int64_t acc_75264;\n        int64_t acc_75266;\n        \n        ltid_flat_75209 = sext_i32_i64(local_tid_76834);\n        ltid_75208 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75224 = ltid_75208 + binop_x_75223;\n        cond_75228 = slt64(j_75224, j_m_i_65502);\n        pre1d_75231 = btoi_bool_i64(cond_75228);\n        if (cond_75228) {\n            int64_t tile_elem_75232;\n            int64_t slice_75332;\n            float tile_elem_75233;\n            \n            tile_elem_75232 = ((__global int64_t *) ext_mem_75562)[j_75224];\n            slice_75332 = slice_65911 + j_75224;\n            tile_elem_75233 = ((__global float *) tS_mem_75468)[slice_75332];\n            pre1d_75229 = tile_elem_75232;\n            pre1d_75230 = tile_elem_75233;\n        } else {\n            pre1d_75229 = (int64_t) 0;\n            pre1d_75230 = 0.0F;\n        }\n        ((__local int64_t *) color_76541)[ltid_75208] = pre1d_75229;\n        ((__local float *) color_76540)[ltid_75208] = pre1d_75230;\n        ((__local int64_t *) color_76539)[ltid_75208] = pre1d_75231;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75245 = sext_i32_i64(local_tid_76834);\n        ltid_75244 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75258 = binop_x_74974 + ltid_75244;\n        acc_75260 = ext_mem_75603[(int64_t) 0];\n        acc_75262 = ext_mem_75601[(int64_t) 0];\n        cond_75263 = slt64(gtid_75258, min_res_65540);\n        if (cond_75263) {\n            float eta_p_75259;\n            float acc_75261;\n            int64_t x_75267;\n            float x_75268;\n            int64_t x_75269;\n            int64_t",
                                    " redout_75362;\n            float redout_75363;\n            int64_t redout_75364;\n            \n            eta_p_75259 = mem_75567[(int64_t) 0];\n            acc_75261 = ext_mem_75602[(int64_t) 0];\n            redout_75362 = acc_75260;\n            redout_75363 = acc_75261;\n            redout_75364 = acc_75262;\n            for (int64_t i_75365 = 0; i_75365 < residual_input_75206; i_75365++) {\n                int64_t x_75270;\n                float x_75271;\n                bool defunc_0_neq_res_75279;\n                bool defunc_0_neq_res_75280;\n                bool cond_f_res_75281;\n                bool y_75282;\n                bool cond_75283;\n                bool defunc_0_neq_res_75284;\n                bool defunc_0_neq_res_75285;\n                bool cond_t_res_f_res_75286;\n                bool y_75287;\n                bool cond_t_res_75288;\n                bool x_75289;\n                int64_t defunc_0_op_res_75290;\n                float defunc_0_op_res_75291;\n                int64_t defunc_0_op_res_75292;\n                int64_t redout_tmp_76852;\n                float redout_tmp_76853;\n                int64_t redout_tmp_76854;\n                \n                x_75270 = ((__local int64_t *) color_76541)[i_75365];\n                x_75271 = ((__local float *) color_76540)[i_75365];\n                defunc_0_neq_res_75279 = redout_75363 == eta_p_75259;\n                defunc_0_neq_res_75280 = !defunc_0_neq_res_75279;\n                cond_f_res_75281 = slt64(redout_75362, (int64_t) 0);\n                y_75282 = defunc_0_neq_res_75279 && cond_f_res_75281;\n                cond_75283 = defunc_0_neq_res_75280 || y_75282;\n                defunc_0_neq_res_75284 = x_75271 == eta_p_75259;\n                defunc_0_neq_res_75285 = !defunc_0_neq_res_75284;\n                cond_t_res_f_res_75286 = slt64(x_75270, (int64_t) 0);\n                y_75287 = defunc_0_neq_res_75284 && cond_t_res_f_res_75286;\n                cond_t_res_75288 = defunc_0_neq_res_75285 || y_75287;\n             ", "   x_75289 = cond_75283 && cond_t_res_75288;\n                if (x_75289) {\n                    defunc_0_op_res_75290 = (int64_t) -1;\n                    defunc_0_op_res_75291 = eta_p_75259;\n                    defunc_0_op_res_75292 = (int64_t) 0;\n                } else {\n                    int64_t x_75272;\n                    int64_t defunc_0_op_res_f_res_75293;\n                    float defunc_0_op_res_f_res_75294;\n                    int64_t defunc_0_op_res_f_res_75295;\n                    \n                    x_75272 = ((__local int64_t *) color_76539)[i_75365];\n                    if (cond_75283) {\n                        defunc_0_op_res_f_res_75293 = x_75270;\n                        defunc_0_op_res_f_res_75294 = x_75271;\n                        defunc_0_op_res_f_res_75295 = x_75272;\n                    } else {\n                        float defunc_0_op_res_f_res_f_res_75296;\n                        int64_t defunc_0_op_res_f_res_f_res_75297;\n                        int64_t defunc_0_op_res_f_res_f_res_75298;\n                        \n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75296 = redout_75363;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75296 = eta_p_75259;\n                        }\n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75297 = redout_75362;\n                            defunc_0_op_res_f_res_f_res_75298 = redout_75364;\n                        } else {\n                            int64_t min_res_75299;\n                            int64_t tmp_75300;\n                            \n                            min_res_75299 = smin64(x_75270, redout_75362);\n                            tmp_75300 = add64(x_75272, redout_75364);\n                            defunc_0_op_res_f_res_f_res_75297 = min_res_75299;\n                            defunc_0_op_res_f_res_f_res_75298 = tmp_75300;\n                     ", "   }\n                        defunc_0_op_res_f_res_75293 = defunc_0_op_res_f_res_f_res_75297;\n                        defunc_0_op_res_f_res_75294 = defunc_0_op_res_f_res_f_res_75296;\n                        defunc_0_op_res_f_res_75295 = defunc_0_op_res_f_res_f_res_75298;\n                    }\n                    defunc_0_op_res_75290 = defunc_0_op_res_f_res_75293;\n                    defunc_0_op_res_75291 = defunc_0_op_res_f_res_75294;\n                    defunc_0_op_res_75292 = defunc_0_op_res_f_res_75295;\n                }\n                redout_tmp_76852 = defunc_0_op_res_75290;\n                redout_tmp_76853 = defunc_0_op_res_75291;\n                redout_tmp_76854 = defunc_0_op_res_75292;\n                redout_75362 = redout_tmp_76852;\n                redout_75363 = redout_tmp_76853;\n                redout_75364 = redout_tmp_76854;\n            }\n            x_75267 = redout_75362;\n            x_75268 = redout_75363;\n            x_75269 = redout_75364;\n            acc_75264 = x_75267;\n            acc_75266 = x_75269;\n        } else {\n            acc_75264 = acc_75260;\n            acc_75266 = acc_75262;\n        }\n        mem_75613[(int64_t) 0] = acc_75264;\n        mem_75617[(int64_t) 0] = acc_75266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75619[i_17] = mem_75613[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75618[i_18] = mem_75617[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76855 = ext_mem_75619[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75621)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76855;\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76856 = ext_mem_75618[(int64_t) 0];\n        \n        ((__global int64_t *) mem_",
                                    "75623)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76856;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74966\n    #undef bytes_75583\n    #undef bytes_75585\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegscan_72497_dim1, 1, 1)\nvoid inner_SMJ_floatzisegscan_72497(__global int *global_failure, int64_t nR_52195, int64_t num_tblocks_72494, int64_t num_virt_blocks_76924, int64_t num_virt_threads_76925, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *status_flags_mem_76926, __global unsigned char *aggregates_mem_76948, __global unsigned char *incprefixes_mem_76950, __global unsigned char *global_dynid_mem_76952)\n{\n    #define segscan_tblock_sizze_72492 (inner_SMJ_floatzisegscan_72497zisegscan_tblock_sizze_72492)\n    #define chunk_sizze_76923 (inner_SMJ_floatzisegscan_72497zichunk_sizze_76923)\n    \n    volatile __local unsigned char *local_mem_76982_backing_0 = &shared_mem[0];\n    const int64_t local_mem_76982_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72492), chunk_sizze_76923 * segscan_tblock_sizze_72492 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72492), chunk_sizze_76923 * segscan_tblock_sizze_72492 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76975;\n    int32_t tblock_sizze_76978;\n    int32_t wave_sizze_76977;\n    int32_t block_id_76976;\n    int32_t global_tid_76974;\n    int64_t phys_tid_72497;\n    int32_t chunk_sizze_32b_76979;\n    int64_t byte_offsets_76980;\n    int64_t warp_byte_offset_76981;\n    __local unsigned char *local_mem_76982;\n    int64_t trans_arr_len_76983;\n    int64_t phys_block_id_76989;\n    int64_t virtloop_bound_76990;\n    \n    local_tid_76975 = get_local_id(0);\n    tblock_sizze_76978 = get_local_size(0);\n    wave_sizze_76977 = LOCKSTE", "P_WIDTH;\n    block_id_76976 = get_tblock_id(0);\n    global_tid_76974 = block_id_76976 * tblock_sizze_76978 + local_tid_76975;\n    phys_tid_72497 = sext_i32_i64(global_tid_76974);\n    chunk_sizze_32b_76979 = sext_i64_i32(chunk_sizze_76923);\n    byte_offsets_76980 = segscan_tblock_sizze_72492 * (int64_t) 8;\n    warp_byte_offset_76981 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_76982 = (__local unsigned char *) local_mem_76982_backing_0;\n    trans_arr_len_76983 = chunk_sizze_76923 * segscan_tblock_sizze_72492;\n    phys_block_id_76989 = get_tblock_id(0);\n    virtloop_bound_76990 = sdiv_up64(num_virt_blocks_76924 - phys_block_id_76989, num_tblocks_72494);\n    for (int64_t virtloop_i_76991 = 0; virtloop_i_76991 < virtloop_bound_76990; virtloop_i_76991++) {\n        int64_t dynamic_id_76992;\n        int64_t block_offset_76993;\n        int64_t sgm_idx_76994;\n        int32_t boundary_76995;\n        int32_t segsizze_compact_76996;\n        int64_t private_mem_76997[chunk_sizze_76923];\n        int64_t thd_offset_76999;\n        int64_t acc_77015;\n        int64_t prefix_77025;\n        bool block_new_sgm_77026;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_76975 == 0) {\n                dynamic_id_76992 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_76952)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 0] = dynamic_id_76992;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_76992 == num_virt_blocks_76924 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_76952)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_76992 = ((__local int32_t *) ", "local_mem_76982)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_76993 = dynamic_id_76992 * chunk_sizze_76923 * segscan_tblock_sizze_72492;\n        sgm_idx_76994 = smod64(block_offset_76993, nR_52195);\n        boundary_76995 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_72492, nR_52195 - sgm_idx_76994));\n        segsizze_compact_76996 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_72492, nR_52195));\n        thd_offset_76999 = block_offset_76993 + sext_i32_i64(local_tid_76975);\n        // Load and map\n        {\n            for (int64_t i_77000 = 0; i_77000 < chunk_sizze_76923; i_77000++) {\n                int64_t virt_tid_77001 = thd_offset_76999 + i_77000 * segscan_tblock_sizze_72492;\n                int64_t slice_77002 = nR_52195;\n                int64_t gtid_72496 = virt_tid_77001;\n                int64_t remnant_77003 = virt_tid_77001 - gtid_72496;\n                \n                if (slt64(virt_tid_77001, nR_52195)) {\n                    int64_t eta_p_65962 = ((__global int64_t *) ext_mem_75938)[gtid_72496];\n                    bool lifted_lambda_res_65963 = slt64((int64_t) 0, eta_p_65962);\n                    int64_t defunc_0_f_res_65964 = btoi_bool_i64(lifted_lambda_res_65963);\n                    \n                    ((__global int64_t *) mem_75943)[gtid_72496] = defunc_0_f_res_65964;\n                    private_mem_76997[i_77000] = defunc_0_f_res_65964;\n                } else {\n                    private_mem_76997[i_77000] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77004 = 0; i_77004 < chunk_sizze_76923; i_77004++) {\n                int64_t sharedIdx_77005 = sext_i32_i64(local_tid_76975) + i_77004 * segscan_tblock_sizze_72492;\n                int64_t tmp_77006 = private_mem_76997[i_77004];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77005] = tm",
                                    "p_77006;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77007 = 0; i_77007 < chunk_sizze_76923; i_77007++) {\n                int64_t sharedIdx_77008 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77007;\n                int64_t tmp_77009 = ((__local int64_t *) local_mem_76982)[sharedIdx_77008];\n                \n                private_mem_76997[i_77007] = tmp_77009;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77010 = 0; i_77010 < chunk_sizze_76923 - (int64_t) 1; i_77010++) {\n                int64_t eta_p_65673;\n                int64_t eta_p_65674;\n                \n                eta_p_65673 = private_mem_76997[i_77010];\n                eta_p_65674 = private_mem_76997[i_77010 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_65675 = add64(eta_p_65673, eta_p_65674);\n                \n                private_mem_76997[i_77010 + (int64_t) 1] = defunc_0_op_res_65675;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77011 = private_mem_76997[chunk_sizze_76923 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = tmp_77011;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77012;\n            int64_t eta_p_77013;\n            int64_t eta_p_77016;\n            int64_t eta_p_77017;\n            bool ltid_in_bounds_77019 = slt64(sext_i32_i64(local_tid_76975), num_virt_threads_76925);\n            int32_t skip_threads_77020;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77019) {\n                    eta_p_77013 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                    if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n            ", "            eta_p_77012 = eta_p_77013;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77020 = 1;\n                while (slt32(skip_threads_77020, 32)) {\n                    bool thread_active_77021 = sle32(skip_threads_77020, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && ltid_in_bounds_77019;\n                    \n                    if (thread_active_77021) {\n                        // read operands\n                        {\n                            eta_p_77012 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77020)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77021) {\n                            int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                            \n                            eta_p_77012 = defunc_0_op_res_77014;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77021) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77012;\n                            eta_p_77013 = eta_p_77012;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77020 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_76975 - squot32(local_tid_76975", ", 32) * 32) == 31 && ltid_in_bounds_77019) {\n                    ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32))] = eta_p_77012;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77022;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                        eta_p_77017 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                        if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                            eta_p_77016 = eta_p_77017;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77022 = 1;\n                    while (slt32(skip_threads_77022, 32)) {\n                        bool thread_active_77023 = sle32(skip_threads_77022, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019);\n                        \n                        if (thread_active_77023) {\n                            // read operands\n                            {\n                                eta_p_77016 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77022)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77023) {\n                                int64_t defunc_0_op_res_77018 = add64(eta_p_77016, eta_p_77017);\n                                \n                                eta_p_77016 = defunc_0_op_res_77018;\n                            }\n     ",
                                    "                   }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77023) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77016;\n                                eta_p_77017 = eta_p_77016;\n                            }\n                        }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77022 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77024 = squot32(local_tid_76975, 32) == 0 || !ltid_in_bounds_77019;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77024) {\n                        eta_p_77013 = eta_p_77012;\n                        eta_p_77012 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77024) {\n                        int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                        \n                        eta_p_77012 = defunc_0_op_res_77014;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77024) {\n                        ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77012;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            ", "// restore correct values for first block\n            {\n                if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                    ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77013;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_76975 == 0) {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[segscan_tblock_sizze_72492 - (int64_t) 1];\n            } else {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77025 = (int64_t) 0;\n        block_new_sgm_77026 = sgm_idx_76994 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77026 && local_tid_76975 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = acc_77015;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                acc_77015 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77026 && slt32(local_tid_76975, wave_sizze_76977)) {\n                if (local_tid_76975 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_76948)[dynamic_id_76992] = acc_77015;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 1;\n                    \n                    int8_t tmp_77027 = ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_76982)[(int64_t) 0] = tmp_77027;\n                }\n                mem_fence_local();\n                \n                int8_t status_77028 = ((__local int8_t *) local_mem_76982)[(int64_t) 0];\n       ", "         \n                if (status_77028 == (int8_t) 2) {\n                    if (local_tid_76975 == 0) {\n                        prefix_77025 = ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77029 = sext_i64_i32(dynamic_id_76992 - sext_i32_i64(wave_sizze_76977));\n                    \n                    while (slt32(wave_sizze_76977 * -1, readOffset_77029)) {\n                        int32_t read_i_77030 = readOffset_77029 + local_tid_76975;\n                        int64_t aggr_77031 = (int64_t) 0;\n                        int8_t flag_77032 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77030)) {\n                            flag_77032 = ((volatile __global int8_t *) status_flags_mem_76926)[sext_i32_i64(read_i_77030)];\n                            if (flag_77032 == (int8_t) 2) {\n                                aggr_77031 = ((volatile __global int64_t *) incprefixes_mem_76950)[sext_i32_i64(read_i_77030)];\n                            } else if (flag_77032 == (int8_t) 1) {\n                                aggr_77031 = ((volatile __global int64_t *) aggregates_mem_76948)[sext_i32_i64(read_i_77030)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = aggr_77031;\n                        ((__local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flag_77032;\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        if (slt8(flag_77032, (int8_t) 2)) {\n                            int8_t flg_x_77036;\n                            int8_t flg_y_77037;\n                            int64_t eta_p_77033;\n                            int64_t eta_p_77034;\n                            int32_t skip_threads_77038;\n             ",
                                    "               \n                            // read input for in-block scan\n                            {\n                                flg_y_77037 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                                eta_p_77034 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)];\n                                if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                                    eta_p_77033 = eta_p_77034;\n                                    flg_x_77036 = flg_y_77037;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77038 = 1;\n                                while (slt32(skip_threads_77038, 32)) {\n                                    if (sle32(skip_threads_77038, local_tid_76975 - squot32(local_tid_76975, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77036 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038)];\n                                            eta_p_77033 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77037 == (int8_t) 2 || flg_y_77037 == (int8_t) 0) {\n                                                flg_x_77036 = flg_y_77037;\n                                                eta_p_77033 = eta_p_77034;\n                                            } else {\n                                                int64_t defunc_0_op_res_770", "35 = add64(eta_p_77033, eta_p_77034);\n                                                \n                                                eta_p_77033 = defunc_0_op_res_77035;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flg_x_77036;\n                                            flg_y_77037 = flg_x_77036;\n                                            ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = eta_p_77033;\n                                            eta_p_77034 = eta_p_77033;\n                                        }\n                                    }\n                                    skip_threads_77038 *= 2;\n                                }\n                            }\n                        }\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        aggr_77031 = ((__local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(wave_sizze_76977) - (int64_t) 1)];\n                        if (flag_77032 == (int8_t) 2) {\n                            readOffset_77029 = wave_sizze_76977 * -1;\n                        } else if (flag_77032 == (int8_t) 1) {\n                            readOffset_77029 -= wave_sizze_76977;\n                        }\n                        if (slt8((int8_t) 0, flag_77032)) {\n                            int64_t eta_p_77039 = aggr_77031;\n                            int64_t eta_p_77040 = prefix_77025;\n                            int64_t defunc_0_op_res_77041 = add64(eta_p_77039, eta_p_77040);\n                            \n                            prefix_77025 = defunc_0_op_res_77041;\n                        }\n                        mem_fence_local();", "\n                    }\n                }\n                if (local_tid_76975 == 0) {\n                    if (boundary_76995 == sext_i64_i32(segscan_tblock_sizze_72492 * chunk_sizze_76923)) {\n                        int64_t eta_p_77042 = prefix_77025;\n                        int64_t eta_p_77043 = acc_77015;\n                        int64_t defunc_0_op_res_77044 = add64(eta_p_77042, eta_p_77043);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = defunc_0_op_res_77044;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 4] = prefix_77025;\n                    acc_77015 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_76992 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77025 = ((__local int64_t *) local_mem_76982)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77045;\n            int64_t eta_p_77046;\n            int64_t eta_p_77048 = prefix_77025;\n            int64_t eta_p_77049 = acc_77015;\n            \n            if (slt32(local_tid_76975 * chunk_sizze_32b_76979, boundary_76995) && !block_new_sgm_77026) {\n                int64_t defunc_0_op_res_77050 = add64(eta_p_77048, eta_p_77049);\n                \n                eta_p_77045 = defunc_0_op_res_77050;\n            } else {\n                eta_p_77045 = acc_77015;\n            }\n            \n            int32_t stopping_point_77051 = segsizze_compact_76996 - srem32(local_tid_76975 * chunk_sizze_32b_76979 - 1 + segsizze_compact_76996 - boundary_76995, segsizze_compact_76996);\n            \n            for (int64_t i_77052 = 0; i_77052 < chunk_sizze_76923; i_77052++) {\n                if (slt32(",
                                    "sext_i64_i32(i_77052), stopping_point_77051 - 1)) {\n                    eta_p_77046 = private_mem_76997[i_77052];\n                    \n                    int64_t defunc_0_op_res_77047 = add64(eta_p_77045, eta_p_77046);\n                    \n                    private_mem_76997[i_77052] = defunc_0_op_res_77047;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77053 = 0; i_77053 < chunk_sizze_76923; i_77053++) {\n                int64_t sharedIdx_77054 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77053;\n                int64_t tmp_77055 = private_mem_76997[i_77053];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77054] = tmp_77055;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77056 = 0; i_77056 < chunk_sizze_76923; i_77056++) {\n                int64_t flat_idx_77057 = thd_offset_76999 + i_77056 * segscan_tblock_sizze_72492;\n                int64_t slice_77058 = nR_52195;\n                int64_t gtid_72496 = flat_idx_77057;\n                int64_t remnant_77059 = flat_idx_77057 - gtid_72496;\n                \n                if (slt64(flat_idx_77057, nR_52195)) {\n                    int64_t tmp_77060 = ((__local int64_t *) local_mem_76982)[flat_idx_77057 - block_offset_76993];\n                    \n                    ((__global int64_t *) mem_75941)[gtid_72496] = tmp_77060;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_72492\n    #undef chunk_sizze_76923\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_floatzisegscan_72513_dim1, 1, 1)\nvoid inner_SMJ_floatzisegscan_72513(__global int *global_failure, int64_t m_65686, int64_t num_tblocks_72510, int64_t num_virt_blocks_77081, int64_t num_virt_threads_77082, __global unsigned char *mem_75945, __global unsigned char *mem_75955, __global unsigned ", "char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *status_flags_mem_77083, __global unsigned char *aggregates_mem_77085, __global unsigned char *incprefixes_mem_77087, __global unsigned char *aggregates_mem_77089, __global unsigned char *incprefixes_mem_77091, __global unsigned char *global_dynid_mem_77093)\n{\n    #define segscan_tblock_sizze_72508 (inner_SMJ_floatzisegscan_72513zisegscan_tblock_sizze_72508)\n    #define chunk_sizze_77080 (inner_SMJ_floatzisegscan_72513zichunk_sizze_77080)\n    \n    volatile __local unsigned char *local_mem_77105_backing_0 = &shared_mem[0];\n    const int64_t local_mem_77105_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72508, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72508), smax64(chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72508, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72508), smax64(chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77096;\n    int32_t tblock_sizze_77099;\n    int32_t wave_sizze_77098;\n    int32_t block_id_77097;\n    int32_t global_tid_77095;\n    int64_t phys_tid_72513;\n    int32_t chunk_sizze_32b_77100;\n    int64_t byte_offsets_77101;\n    int64_t byte_offsets_77102;\n    int64_t warp_byte_offset_77103;\n    int64_t warp_byte_offset_77104;\n    __local unsigned char *local_mem_77105;\n    int64_t trans_arr_len_77106;\n    int64_t phys_block_id_77115;\n    int64_t virtloop_bound_77116;\n    \n    local_tid_77096 = get_local_id(0);\n    tblock_sizze_77099 = get_local_size(0);\n    wave_sizze_77098 = LOCKSTEP_WIDTH;\n    block_id_77097 = get_tblock_id", "(0);\n    global_tid_77095 = block_id_77097 * tblock_sizze_77099 + local_tid_77096;\n    phys_tid_72513 = sext_i32_i64(global_tid_77095);\n    chunk_sizze_32b_77100 = sext_i64_i32(chunk_sizze_77080);\n    byte_offsets_77101 = segscan_tblock_sizze_72508 * (int64_t) 8;\n    byte_offsets_77102 = sdiv_up64(byte_offsets_77101, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_72508 * (int64_t) 8;\n    warp_byte_offset_77103 = (int64_t) 288;\n    warp_byte_offset_77104 = sdiv_up64(warp_byte_offset_77103, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_77105 = (__local unsigned char *) local_mem_77105_backing_0;\n    trans_arr_len_77106 = chunk_sizze_77080 * segscan_tblock_sizze_72508;\n    phys_block_id_77115 = get_tblock_id(0);\n    virtloop_bound_77116 = sdiv_up64(num_virt_blocks_77081 - phys_block_id_77115, num_tblocks_72510);\n    for (int64_t virtloop_i_77117 = 0; virtloop_i_77117 < virtloop_bound_77116; virtloop_i_77117++) {\n        int64_t dynamic_id_77118;\n        int64_t block_offset_77119;\n        int64_t sgm_idx_77120;\n        int32_t boundary_77121;\n        int32_t segsizze_compact_77122;\n        int64_t private_mem_77123[chunk_sizze_77080];\n        int64_t private_mem_77125[chunk_sizze_77080];\n        int64_t thd_offset_77127;\n        int64_t acc_77153;\n        int64_t acc_77154;\n        int64_t prefix_77167;\n        int64_t prefix_77168;\n        bool block_new_sgm_77169;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_77096 == 0) {\n                dynamic_id_77118 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_77093)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 0] = dynamic_id_77118;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    ",
                                    "if (dynamic_id_77118 == num_virt_blocks_77081 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_77093)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_77118 = ((__local int32_t *) local_mem_77105)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_77119 = dynamic_id_77118 * chunk_sizze_77080 * segscan_tblock_sizze_72508;\n        sgm_idx_77120 = smod64(block_offset_77119, m_65686);\n        boundary_77121 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_72508, m_65686 - sgm_idx_77120));\n        segsizze_compact_77122 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_72508, m_65686));\n        thd_offset_77127 = block_offset_77119 + sext_i32_i64(local_tid_77096);\n        // Load and map\n        {\n            for (int64_t i_77128 = 0; i_77128 < chunk_sizze_77080; i_77128++) {\n                int64_t virt_tid_77129 = thd_offset_77127 + i_77128 * segscan_tblock_sizze_72508;\n                int64_t slice_77130 = m_65686;\n                int64_t gtid_72512 = virt_tid_77129;\n                int64_t remnant_77131 = virt_tid_77129 - gtid_72512;\n                \n                if (slt64(virt_tid_77129, m_65686)) {\n                    int64_t x_65967 = ((__global int64_t *) mem_75945)[gtid_72512];\n                    bool lifted_lambda_res_65969 = slt64((int64_t) 1, x_65967);\n                    int64_t defunc_0_f_res_65970 = btoi_bool_i64(lifted_lambda_res_65969);\n                    \n                    ((__global int64_t *) mem_75959)[gtid_72512] = defunc_0_f_res_65970;\n                    private_mem_77123[i_77128] = x_65967;\n                    private_mem_77125[i_77128] = defunc_0_f_res_65970;\n                } else {\n                    private_mem_77123[i_77128] = (int64_t) 0;\n                    private_mem_77125[i_77128] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL", "_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77132 = 0; i_77132 < chunk_sizze_77080; i_77132++) {\n                int64_t sharedIdx_77133 = sext_i32_i64(local_tid_77096) + i_77132 * segscan_tblock_sizze_72508;\n                int64_t tmp_77134 = private_mem_77123[i_77132];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77133] = tmp_77134;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77135 = 0; i_77135 < chunk_sizze_77080; i_77135++) {\n                int64_t sharedIdx_77136 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77135;\n                int64_t tmp_77137 = ((__local int64_t *) local_mem_77105)[sharedIdx_77136];\n                \n                private_mem_77123[i_77135] = tmp_77137;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77138 = 0; i_77138 < chunk_sizze_77080; i_77138++) {\n                int64_t sharedIdx_77139 = sext_i32_i64(local_tid_77096) + i_77138 * segscan_tblock_sizze_72508;\n                int64_t tmp_77140 = private_mem_77125[i_77138];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77139] = tmp_77140;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77141 = 0; i_77141 < chunk_sizze_77080; i_77141++) {\n                int64_t sharedIdx_77142 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77141;\n                int64_t tmp_77143 = ((__local int64_t *) local_mem_77105)[sharedIdx_77142];\n                \n                private_mem_77125[i_77141] = tmp_77143;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77144 = 0; i_77144 < chunk_sizze_77080 - (int64_t) 1; i_77144++) {\n                int64_t eta_p_65723;\n                int64_t eta_p_65724;\n                \n                eta_p_65723 = private_mem_77123[i_77144];\n                eta_", "p_65724 = private_mem_77123[i_77144 + (int64_t) 1];\n                \n                int64_t eta_p_65816;\n                int64_t eta_p_65817;\n                \n                eta_p_65816 = private_mem_77125[i_77144];\n                eta_p_65817 = private_mem_77125[i_77144 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_65725 = add64(eta_p_65723, eta_p_65724);\n                int64_t defunc_0_op_res_65818 = add64(eta_p_65816, eta_p_65817);\n                \n                private_mem_77123[i_77144 + (int64_t) 1] = lifted_lambda_res_65725;\n                private_mem_77125[i_77144 + (int64_t) 1] = defunc_0_op_res_65818;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77145 = private_mem_77123[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = tmp_77145;\n            \n            int64_t tmp_77146 = private_mem_77125[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = tmp_77146;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77147;\n            int64_t eta_p_77148;\n            int64_t eta_p_77149;\n            int64_t eta_p_77150;\n            int64_t eta_p_77155;\n            int64_t eta_p_77156;\n            int64_t eta_p_77157;\n            int64_t eta_p_77158;\n            bool ltid_in_bounds_77161 = slt64(sext_i32_i64(local_tid_77096), num_virt_threads_77082);\n            int32_t skip_threads_77162;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77161) {\n                    eta_p_77149 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                    eta_p_77150 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte",
                                    "_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                    if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                        eta_p_77147 = eta_p_77149;\n                        eta_p_77148 = eta_p_77150;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77162 = 1;\n                while (slt32(skip_threads_77162, 32)) {\n                    bool thread_active_77163 = sle32(skip_threads_77162, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && ltid_in_bounds_77161;\n                    \n                    if (thread_active_77163) {\n                        // read operands\n                        {\n                            eta_p_77147 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162)];\n                            eta_p_77148 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77163) {\n                            int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                            int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                            \n                            eta_p_77147 = lifted_lambda_res_77151;\n                            eta_p_77148 = defunc_0_op_res_77152;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77163) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local", "_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                            eta_p_77149 = eta_p_77147;\n                            ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                            eta_p_77150 = eta_p_77148;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77162 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 31 && ltid_in_bounds_77161) {\n                    ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77147;\n                    ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77148;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77164;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                        eta_p_77157 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                        eta_p_77158 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                        if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                            eta_p_77155 = eta_p_77157;\n                            eta_p_77156 = eta_p_77", "158;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77164 = 1;\n                    while (slt32(skip_threads_77164, 32)) {\n                        bool thread_active_77165 = sle32(skip_threads_77164, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161);\n                        \n                        if (thread_active_77165) {\n                            // read operands\n                            {\n                                eta_p_77155 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164)];\n                                eta_p_77156 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77165) {\n                                int64_t lifted_lambda_res_77159 = add64(eta_p_77155, eta_p_77157);\n                                int64_t defunc_0_op_res_77160 = add64(eta_p_77156, eta_p_77158);\n                                \n                                eta_p_77155 = lifted_lambda_res_77159;\n                                eta_p_77156 = defunc_0_op_res_77160;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77165) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77155;\n                 ",
                                    "               eta_p_77157 = eta_p_77155;\n                                ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77156;\n                                eta_p_77158 = eta_p_77156;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77164 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77166 = squot32(local_tid_77096, 32) == 0 || !ltid_in_bounds_77161;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77166) {\n                        eta_p_77149 = eta_p_77147;\n                        eta_p_77150 = eta_p_77148;\n                        eta_p_77147 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1];\n                        eta_p_77148 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77166) {\n                        int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                        int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                        \n                        eta_p_77147 = lifted_lambda_res_77151;\n                        eta_p_77148 = defunc_0_op_res_77152;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77166) {\n                        ((__local int64_t *) local_", "mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                        ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                    ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77149;\n                    ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_77096 == 0) {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[segscan_tblock_sizze_72508 - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (segscan_tblock_sizze_72508 - (int64_t) 1)];\n            } else {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77167 = (int64_t) 0;\n        prefix_77168 = (int64_t) 0;\n        block_new_sgm_77169 = sgm_idx_77120 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77169 && local_tid_77096 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = acc_77153;\n                ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118] = acc_77154;\n                mem_fence_global();\n                ((volatile __global int8_t *) stat", "us_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                acc_77153 = (int64_t) 0;\n                acc_77154 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77169 && slt32(local_tid_77096, wave_sizze_77098)) {\n                if (local_tid_77096 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_77085)[dynamic_id_77118] = acc_77153;\n                    ((volatile __global int64_t *) aggregates_mem_77089)[dynamic_id_77118] = acc_77154;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 1;\n                    \n                    int8_t tmp_77170 = ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_77105)[(int64_t) 0] = tmp_77170;\n                }\n                mem_fence_local();\n                \n                int8_t status_77171 = ((__local int8_t *) local_mem_77105)[(int64_t) 0];\n                \n                if (status_77171 == (int8_t) 2) {\n                    if (local_tid_77096 == 0) {\n                        prefix_77167 = ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118 - (int64_t) 1];\n                        prefix_77168 = ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77172 = sext_i64_i32(dynamic_id_77118 - sext_i32_i64(wave_sizze_77098));\n                    \n                    while (slt32(wave_sizze_77098 * -1, readOffset_77172)) {\n                        int32_t read_i_77173 = readOffset_77172 + local_tid_77096;\n                        int64_t aggr_77174 = (int64_t) 0;\n                        int64_t aggr_77175 = (int64_t) 0;\n                        int8_t flag_77176 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_771",
                                    "73)) {\n                            flag_77176 = ((volatile __global int8_t *) status_flags_mem_77083)[sext_i32_i64(read_i_77173)];\n                            if (flag_77176 == (int8_t) 2) {\n                                aggr_77174 = ((volatile __global int64_t *) incprefixes_mem_77087)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) incprefixes_mem_77091)[sext_i32_i64(read_i_77173)];\n                            } else if (flag_77176 == (int8_t) 1) {\n                                aggr_77174 = ((volatile __global int64_t *) aggregates_mem_77085)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) aggregates_mem_77089)[sext_i32_i64(read_i_77173)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = aggr_77174;\n                        ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = aggr_77175;\n                        ((__local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flag_77176;\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze_77098) - (int64_t) 1];\n                        if (slt8(flag_77176, (int8_t) 2)) {\n                            int8_t flg_x_77183;\n                            int8_t flg_y_77184;\n                            int64_t eta_p_77177;\n                            int64_t eta_p_77178;\n                            int64_t eta_p_77179;\n                            int64_t eta_p_77180;\n                            int32_t skip_threads_77185;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77184 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                       ", "         eta_p_77179 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)];\n                                eta_p_77180 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                                    eta_p_77177 = eta_p_77179;\n                                    eta_p_77178 = eta_p_77180;\n                                    flg_x_77183 = flg_y_77184;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77185 = 1;\n                                while (slt32(skip_threads_77185, 32)) {\n                                    if (sle32(skip_threads_77185, local_tid_77096 - squot32(local_tid_77096, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77183 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185)];\n                                            eta_p_77177 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                            eta_p_77178 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77184 == (int8_t) 2 || flg_y_77184 == (int8_t) 0) {\n                                                flg_x_77183 = flg_y_77184;\n", "                                                eta_p_77177 = eta_p_77179;\n                                                eta_p_77178 = eta_p_77180;\n                                            } else {\n                                                int64_t lifted_lambda_res_77181 = add64(eta_p_77177, eta_p_77179);\n                                                int64_t defunc_0_op_res_77182 = add64(eta_p_77178, eta_p_77180);\n                                                \n                                                eta_p_77177 = lifted_lambda_res_77181;\n                                                eta_p_77178 = defunc_0_op_res_77182;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flg_x_77183;\n                                            flg_y_77184 = flg_x_77183;\n                                            ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = eta_p_77177;\n                                            eta_p_77179 = eta_p_77177;\n                                            ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77178;\n                                            eta_p_77180 = eta_p_77178;\n                                        }\n                                    }\n                                    skip_threads_77185 *= 2;\n                                }\n                            }\n                        }\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze_77098) - (int64_t) 1];\n                        aggr_77174 = ((__local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(wave_sizze_77098) - (in",
                                    "t64_t) 1)];\n                        aggr_77175 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(wave_sizze_77098) - (int64_t) 1)];\n                        if (flag_77176 == (int8_t) 2) {\n                            readOffset_77172 = wave_sizze_77098 * -1;\n                        } else if (flag_77176 == (int8_t) 1) {\n                            readOffset_77172 -= wave_sizze_77098;\n                        }\n                        if (slt8((int8_t) 0, flag_77176)) {\n                            int64_t eta_p_77186 = aggr_77174;\n                            int64_t eta_p_77187 = aggr_77175;\n                            int64_t eta_p_77188 = prefix_77167;\n                            int64_t eta_p_77189 = prefix_77168;\n                            int64_t lifted_lambda_res_77190 = add64(eta_p_77186, eta_p_77188);\n                            int64_t defunc_0_op_res_77191 = add64(eta_p_77187, eta_p_77189);\n                            \n                            prefix_77167 = lifted_lambda_res_77190;\n                            prefix_77168 = defunc_0_op_res_77191;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_77096 == 0) {\n                    if (boundary_77121 == sext_i64_i32(segscan_tblock_sizze_72508 * chunk_sizze_77080)) {\n                        int64_t eta_p_77192 = prefix_77167;\n                        int64_t eta_p_77193 = prefix_77168;\n                        int64_t eta_p_77194 = acc_77153;\n                        int64_t eta_p_77195 = acc_77154;\n                        int64_t lifted_lambda_res_77196 = add64(eta_p_77192, eta_p_77194);\n                        int64_t defunc_0_op_res_77197 = add64(eta_p_77193, eta_p_77195);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = lifted_lambda_res_77196;\n                        ((volatile __global int64_t ", "*) incprefixes_mem_77091)[dynamic_id_77118] = defunc_0_op_res_77197;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 4] = prefix_77167;\n                    ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8)] = prefix_77168;\n                    acc_77153 = (int64_t) 0;\n                    acc_77154 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_77118 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77167 = ((__local int64_t *) local_mem_77105)[(int64_t) 4];\n                prefix_77168 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77198;\n            int64_t eta_p_77200;\n            int64_t eta_p_77204 = prefix_77167;\n            int64_t eta_p_77206 = acc_77153;\n            int64_t eta_p_77199;\n            int64_t eta_p_77201;\n            int64_t eta_p_77205 = prefix_77168;\n            int64_t eta_p_77207 = acc_77154;\n            \n            if (slt32(local_tid_77096 * chunk_sizze_32b_77100, boundary_77121) && !block_new_sgm_77169) {\n                int64_t lifted_lambda_res_77208 = add64(eta_p_77204, eta_p_77206);\n                int64_t defunc_0_op_res_77209 = add64(eta_p_77205, eta_p_77207);\n                \n                eta_p_77198 = lifted_lambda_res_77208;\n                eta_p_77199 = defunc_0_op_res_77209;\n            } else {\n                eta_p_77198 = acc_77153;\n                eta_p_77199 = acc_77154;\n            }\n            \n            int32_t stopping_point_77210 = segsizze_compact_77122 - srem32(local_tid_77096 * chunk_sizze_32b_77100 - 1 + segsizze_compact_77122 - boundary_77121,", " segsizze_compact_77122);\n            \n            for (int64_t i_77211 = 0; i_77211 < chunk_sizze_77080; i_77211++) {\n                if (slt32(sext_i64_i32(i_77211), stopping_point_77210 - 1)) {\n                    eta_p_77200 = private_mem_77123[i_77211];\n                    eta_p_77201 = private_mem_77125[i_77211];\n                    \n                    int64_t lifted_lambda_res_77202 = add64(eta_p_77198, eta_p_77200);\n                    int64_t defunc_0_op_res_77203 = add64(eta_p_77199, eta_p_77201);\n                    \n                    private_mem_77123[i_77211] = lifted_lambda_res_77202;\n                    private_mem_77125[i_77211] = defunc_0_op_res_77203;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77212 = 0; i_77212 < chunk_sizze_77080; i_77212++) {\n                int64_t sharedIdx_77213 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77212;\n                int64_t tmp_77214 = private_mem_77123[i_77212];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77213] = tmp_77214;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77215 = 0; i_77215 < chunk_sizze_77080; i_77215++) {\n                int64_t flat_idx_77216 = thd_offset_77127 + i_77215 * segscan_tblock_sizze_72508;\n                int64_t slice_77217 = m_65686;\n                int64_t gtid_72512 = flat_idx_77216;\n                int64_t remnant_77218 = flat_idx_77216 - gtid_72512;\n                \n                if (slt64(flat_idx_77216, m_65686)) {\n                    int64_t tmp_77219 = ((__local int64_t *) local_mem_77105)[flat_idx_77216 - block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75955)[gtid_72512] = tmp_77219;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77220 = 0; i_77220 < chunk_sizze_77080; i_772",
                                    "20++) {\n                int64_t sharedIdx_77221 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77220;\n                int64_t tmp_77222 = private_mem_77125[i_77220];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77221] = tmp_77222;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77223 = 0; i_77223 < chunk_sizze_77080; i_77223++) {\n                int64_t flat_idx_77224 = thd_offset_77127 + i_77223 * segscan_tblock_sizze_72508;\n                int64_t slice_77225 = m_65686;\n                int64_t gtid_72512 = flat_idx_77224;\n                int64_t remnant_77226 = flat_idx_77224 - gtid_72512;\n                \n                if (slt64(flat_idx_77224, m_65686)) {\n                    int64_t tmp_77227 = ((__local int64_t *) local_mem_77105)[flat_idx_77224 - block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75957)[gtid_72512] = tmp_77227;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_72508\n    #undef chunk_sizze_77080\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76566_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76566(__global int *global_failure, int64_t gt_rhs_64823, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75475)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76568;\n    int32_t tblock_sizze_76571;\n    int32_t wave_sizze_76570;\n    int32_t block_id_76569;\n    int32_t global_tid_76567;\n    int64_t tid_76566;\n    int32_t x_75366;\n    \n    local_tid_76568 = get_local_id(0);\n    tblock_sizze_76571 = get_local_size(0);\n    wave_sizze_76570 = LOCKSTEP_WIDTH;\n    block_id_76569 = get_tblock_id(0);\n    global_tid_76567 = block_id_76569 * tblock_sizze_76571 + local_tid_76568;\n    tid_76566 = sext_i32_i64(global_tid_76567);\n    x_75366 = ((__global int32_t *) tR_mem_75467)[gt_rhs_64823];\n    ((__global int32_t *) ", "mem_75475)[(int64_t) 0] = x_75366;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76598_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76598(__global int *global_failure, int64_t tS_start_64840, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75476, __global unsigned char *mem_75483, __global unsigned char *mem_75484)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76600;\n    int32_t tblock_sizze_76603;\n    int32_t wave_sizze_76602;\n    int32_t block_id_76601;\n    int32_t global_tid_76599;\n    int64_t tid_76598;\n    int32_t gt_lhs_75370;\n    int32_t gt_rhs_75372;\n    bool defunc_0_gt_res_75374;\n    \n    local_tid_76600 = get_local_id(0);\n    tblock_sizze_76603 = get_local_size(0);\n    wave_sizze_76602 = LOCKSTEP_WIDTH;\n    block_id_76601 = get_tblock_id(0);\n    global_tid_76599 = block_id_76601 * tblock_sizze_76603 + local_tid_76600;\n    tid_76598 = sext_i32_i64(global_tid_76599);\n    gt_lhs_75370 = ((__global int32_t *) tS_mem_75468)[tS_start_64840];\n    gt_rhs_75372 = ((__global int32_t *) ext_mem_75476)[(int64_t) 0];\n    defunc_0_gt_res_75374 = slt32(gt_rhs_75372, gt_lhs_75370);\n    ((__global int32_t *) mem_75483)[(int64_t) 0] = gt_lhs_75370;\n    ((__global bool *) mem_75484)[(int64_t) 0] = defunc_0_gt_res_75374;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76604_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76604(__global int *global_failure, int64_t i_p_m_t_s_64846, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75750)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76606;\n    int32_t tblock_sizze_76609;\n    int32_t wave_sizze_76608;\n    int32_t block_id_76607;\n    int32_t global_tid_76605;\n    int64_t tid_76604;\n    int32_t x_75376;\n    \n    local_tid_76606 = get_local_id(0);\n    tblock_sizze_76609 = get_local_size(0);\n    wave_sizze_76608 = LOCKSTEP_WIDTH;\n    block_id_76607 = get_tblock_id(0);\n    global_tid_76605 = block_id_", "76607 * tblock_sizze_76609 + local_tid_76606;\n    tid_76604 = sext_i32_i64(global_tid_76605);\n    x_75376 = ((__global int32_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    ((__global int32_t *) mem_75750)[(int64_t) 0] = x_75376;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76620_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76620(__global int *global_failure, int64_t start_66400, int64_t i_p_m_t_s_66406, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75758, __global unsigned char *mem_75759)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76622;\n    int32_t tblock_sizze_76625;\n    int32_t wave_sizze_76624;\n    int32_t block_id_76623;\n    int32_t global_tid_76621;\n    int64_t tid_76620;\n    int32_t r_max_75380;\n    int32_t r_min_75383;\n    \n    local_tid_76622 = get_local_id(0);\n    tblock_sizze_76625 = get_local_size(0);\n    wave_sizze_76624 = LOCKSTEP_WIDTH;\n    block_id_76623 = get_tblock_id(0);\n    global_tid_76621 = block_id_76623 * tblock_sizze_76625 + local_tid_76622;\n    tid_76620 = sext_i32_i64(global_tid_76621);\n    r_max_75380 = ((__global int32_t *) tR_mem_75467)[i_p_m_t_s_66406];\n    r_min_75383 = ((__global int32_t *) tR_mem_75467)[start_66400];\n    ((__global int32_t *) mem_75758)[(int64_t) 0] = r_max_75380;\n    ((__global int32_t *) mem_75759)[(int64_t) 0] = r_min_75383;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76626_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76626(__global int *global_failure, __global unsigned char *mem_75759, __global unsigned char *ext_mem_75760, __global unsigned char *mem_75762)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76628;\n    int32_t tblock_sizze_76631;\n    int32_t wave_sizze_76630;\n    int32_t block_id_76629;\n    int32_t global_tid_76627;\n    int64_t tid_76626;\n    int32_t s_max_75385;\n    int32_t r_min_75386;\n    bool defunc_0_gt_res_75387;\n    \n    local_tid_76628 = get_local_id(0);\n    tblock_sizze_7",
                                    "6631 = get_local_size(0);\n    wave_sizze_76630 = LOCKSTEP_WIDTH;\n    block_id_76629 = get_tblock_id(0);\n    global_tid_76627 = block_id_76629 * tblock_sizze_76631 + local_tid_76628;\n    tid_76626 = sext_i32_i64(global_tid_76627);\n    s_max_75385 = ((__global int32_t *) ext_mem_75760)[(int64_t) 0];\n    r_min_75386 = ((__global int32_t *) mem_75759)[(int64_t) 0];\n    defunc_0_gt_res_75387 = slt32(s_max_75385, r_min_75386);\n    ((__global bool *) mem_75762)[(int64_t) 0] = defunc_0_gt_res_75387;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76632_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76632(__global int *global_failure, __global unsigned char *mem_75758, __global unsigned char *ext_mem_75761, __global unsigned char *mem_75763)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76634;\n    int32_t tblock_sizze_76637;\n    int32_t wave_sizze_76636;\n    int32_t block_id_76635;\n    int32_t global_tid_76633;\n    int64_t tid_76632;\n    int32_t r_max_75390;\n    int32_t s_min_75391;\n    bool defunc_0_gt_res_75392;\n    \n    local_tid_76634 = get_local_id(0);\n    tblock_sizze_76637 = get_local_size(0);\n    wave_sizze_76636 = LOCKSTEP_WIDTH;\n    block_id_76635 = get_tblock_id(0);\n    global_tid_76633 = block_id_76635 * tblock_sizze_76637 + local_tid_76634;\n    tid_76632 = sext_i32_i64(global_tid_76633);\n    r_max_75390 = ((__global int32_t *) mem_75758)[(int64_t) 0];\n    s_min_75391 = ((__global int32_t *) ext_mem_75761)[(int64_t) 0];\n    defunc_0_gt_res_75392 = slt32(r_max_75390, s_min_75391);\n    ((__global bool *) mem_75763)[(int64_t) 0] = defunc_0_gt_res_75392;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76691_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76691(__global int *global_failure, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75490)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76693;\n    int32_t tblock_sizze_76696;\n    int32_t wave_sizze_76695;\n   ", " int32_t block_id_76694;\n    int32_t global_tid_76692;\n    int64_t tid_76691;\n    int32_t x_75394;\n    \n    local_tid_76693 = get_local_id(0);\n    tblock_sizze_76696 = get_local_size(0);\n    wave_sizze_76695 = LOCKSTEP_WIDTH;\n    block_id_76694 = get_tblock_id(0);\n    global_tid_76692 = block_id_76694 * tblock_sizze_76696 + local_tid_76693;\n    tid_76691 = sext_i32_i64(global_tid_76692);\n    x_75394 = ((__global int32_t *) tR_mem_75467)[(int64_t) 0];\n    ((__global int32_t *) mem_75490)[(int64_t) 0] = x_75394;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76697_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76697(__global int *global_failure, __global unsigned char *mem_75483, __global unsigned char *ext_mem_75491, __global unsigned char *mem_75492)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76699;\n    int32_t tblock_sizze_76702;\n    int32_t wave_sizze_76701;\n    int32_t block_id_76700;\n    int32_t global_tid_76698;\n    int64_t tid_76697;\n    int32_t leq_lhs_75398;\n    int32_t gt_lhs_75399;\n    bool defunc_0_leq_res_75400;\n    \n    local_tid_76699 = get_local_id(0);\n    tblock_sizze_76702 = get_local_size(0);\n    wave_sizze_76701 = LOCKSTEP_WIDTH;\n    block_id_76700 = get_tblock_id(0);\n    global_tid_76698 = block_id_76700 * tblock_sizze_76702 + local_tid_76699;\n    tid_76697 = sext_i32_i64(global_tid_76698);\n    leq_lhs_75398 = ((__global int32_t *) ext_mem_75491)[(int64_t) 0];\n    gt_lhs_75399 = ((__global int32_t *) mem_75483)[(int64_t) 0];\n    defunc_0_leq_res_75400 = sle32(leq_lhs_75398, gt_lhs_75399);\n    ((__global bool *) mem_75492)[(int64_t) 0] = defunc_0_leq_res_75400;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76703_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76703(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_42219, unsigned char y_64988_bits, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75483, __glo", "bal unsigned char *mem_75492, __global unsigned char *mem_75494)\n{\n    bool y_64988 = y_64988_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76705;\n    int32_t tblock_sizze_76708;\n    int32_t wave_sizze_76707;\n    int32_t block_id_76706;\n    int32_t global_tid_76704;\n    int64_t tid_76703;\n    bool defunc_0_leq_res_75402;\n    int32_t x_75407;\n    \n    local_tid_76705 = get_local_id(0);\n    tblock_sizze_76708 = get_local_size(0);\n    wave_sizze_76707 = LOCKSTEP_WIDTH;\n    block_id_76706 = get_tblock_id(0);\n    global_tid_76704 = block_id_76706 * tblock_sizze_76708 + local_tid_76705;\n    tid_76703 = sext_i32_i64(global_tid_76704);\n    defunc_0_leq_res_75402 = ((__global bool *) mem_75492)[(int64_t) 0];\n    if (defunc_0_leq_res_75402) {\n        bool index_certs_75403;\n        int32_t lowest_t_res_75404;\n        \n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 74) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_42219;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_75404 = ((__global int32_t *) tR_mem_75467)[(int64_t) 0];\n        x_75407 = lowest_t_res_75404;\n    } else {\n        int32_t gt_lhs_75406;\n        bool index_certs_75405;\n        \n        gt_lhs_75406 = ((__global int32_t *) mem_75483)[(int64_t) 0];\n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 75) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_42219;\n                    ;\n                }\n                return;\n            }\n        }\n        x_75407 = gt_lhs_75406;\n    }\n    ((__global int32_t *) mem_75494)[(int64_t) 0] = x_75407;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76765_dim1, 1, 1)\nvoid ",
                                    "inner_SMJ_intzigpuseq_76765(__global int *global_failure, int64_t slice_65911, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75542)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76767;\n    int32_t tblock_sizze_76770;\n    int32_t wave_sizze_76769;\n    int32_t block_id_76768;\n    int32_t global_tid_76766;\n    int64_t tid_76765;\n    int32_t x_75412;\n    \n    local_tid_76767 = get_local_id(0);\n    tblock_sizze_76770 = get_local_size(0);\n    wave_sizze_76769 = LOCKSTEP_WIDTH;\n    block_id_76768 = get_tblock_id(0);\n    global_tid_76766 = block_id_76768 * tblock_sizze_76770 + local_tid_76767;\n    tid_76765 = sext_i32_i64(global_tid_76766);\n    x_75412 = ((__global int32_t *) tS_mem_75468)[slice_65911];\n    ((__global int32_t *) mem_75542)[(int64_t) 0] = x_75412;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76771_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76771(__global int *global_failure, int64_t slice_66709, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75545)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76773;\n    int32_t tblock_sizze_76776;\n    int32_t wave_sizze_76775;\n    int32_t block_id_76774;\n    int32_t global_tid_76772;\n    int64_t tid_76771;\n    int32_t x_75416;\n    \n    local_tid_76773 = get_local_id(0);\n    tblock_sizze_76776 = get_local_size(0);\n    wave_sizze_76775 = LOCKSTEP_WIDTH;\n    block_id_76774 = get_tblock_id(0);\n    global_tid_76772 = block_id_76774 * tblock_sizze_76776 + local_tid_76773;\n    tid_76771 = sext_i32_i64(global_tid_76772);\n    x_75416 = ((__global int32_t *) tS_mem_75468)[slice_66709];\n    ((__global int32_t *) mem_75545)[(int64_t) 0] = x_75416;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76787_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76787(__global int *global_failure, int64_t slice_65554, int64_t slice_65563, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75553, __glo", "bal unsigned char *mem_75554)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76789;\n    int32_t tblock_sizze_76792;\n    int32_t wave_sizze_76791;\n    int32_t block_id_76790;\n    int32_t global_tid_76788;\n    int64_t tid_76787;\n    int32_t r_max_75420;\n    int32_t r_min_75423;\n    \n    local_tid_76789 = get_local_id(0);\n    tblock_sizze_76792 = get_local_size(0);\n    wave_sizze_76791 = LOCKSTEP_WIDTH;\n    block_id_76790 = get_tblock_id(0);\n    global_tid_76788 = block_id_76790 * tblock_sizze_76792 + local_tid_76789;\n    tid_76787 = sext_i32_i64(global_tid_76788);\n    r_max_75420 = ((__global int32_t *) tR_mem_75467)[slice_65563];\n    r_min_75423 = ((__global int32_t *) tR_mem_75467)[slice_65554];\n    ((__global int32_t *) mem_75553)[(int64_t) 0] = r_max_75420;\n    ((__global int32_t *) mem_75554)[(int64_t) 0] = r_min_75423;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76793_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76793(__global int *global_failure, __global unsigned char *mem_75554, __global unsigned char *ext_mem_75555, __global unsigned char *mem_75557)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76795;\n    int32_t tblock_sizze_76798;\n    int32_t wave_sizze_76797;\n    int32_t block_id_76796;\n    int32_t global_tid_76794;\n    int64_t tid_76793;\n    int32_t s_max_75425;\n    int32_t r_min_75426;\n    bool defunc_0_gt_res_75427;\n    \n    local_tid_76795 = get_local_id(0);\n    tblock_sizze_76798 = get_local_size(0);\n    wave_sizze_76797 = LOCKSTEP_WIDTH;\n    block_id_76796 = get_tblock_id(0);\n    global_tid_76794 = block_id_76796 * tblock_sizze_76798 + local_tid_76795;\n    tid_76793 = sext_i32_i64(global_tid_76794);\n    s_max_75425 = ((__global int32_t *) ext_mem_75555)[(int64_t) 0];\n    r_min_75426 = ((__global int32_t *) mem_75554)[(int64_t) 0];\n    defunc_0_gt_res_75427 = slt32(s_max_75425, r_min_75426);\n    ((__global bool *) mem_75557)[(int64_t) 0] = defunc_0_gt_res_75427;\n    \n  e", "rror_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76799_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76799(__global int *global_failure, __global unsigned char *mem_75553, __global unsigned char *ext_mem_75556, __global unsigned char *mem_75558)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76801;\n    int32_t tblock_sizze_76804;\n    int32_t wave_sizze_76803;\n    int32_t block_id_76802;\n    int32_t global_tid_76800;\n    int64_t tid_76799;\n    int32_t r_max_75430;\n    int32_t s_min_75431;\n    bool defunc_0_gt_res_75432;\n    \n    local_tid_76801 = get_local_id(0);\n    tblock_sizze_76804 = get_local_size(0);\n    wave_sizze_76803 = LOCKSTEP_WIDTH;\n    block_id_76802 = get_tblock_id(0);\n    global_tid_76800 = block_id_76802 * tblock_sizze_76804 + local_tid_76801;\n    tid_76799 = sext_i32_i64(global_tid_76800);\n    r_max_75430 = ((__global int32_t *) mem_75553)[(int64_t) 0];\n    s_min_75431 = ((__global int32_t *) ext_mem_75556)[(int64_t) 0];\n    defunc_0_gt_res_75432 = slt32(r_max_75430, s_min_75431);\n    ((__global bool *) mem_75558)[(int64_t) 0] = defunc_0_gt_res_75432;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_76912_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_76912(__global int *global_failure, int64_t gt_rhs_64823, int64_t i_p_m_t_s_64846, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75926)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76914;\n    int32_t tblock_sizze_76917;\n    int32_t wave_sizze_76916;\n    int32_t block_id_76915;\n    int32_t global_tid_76913;\n    int64_t tid_76912;\n    int32_t leq_lhs_75434;\n    int32_t leq_rhs_75436;\n    bool defunc_0_leq_res_75440;\n    \n    local_tid_76914 = get_local_id(0);\n    tblock_sizze_76917 = get_local_size(0);\n    wave_sizze_76916 = LOCKSTEP_WIDTH;\n    block_id_76915 = get_tblock_id(0);\n    global_tid_76913 = block_id_76915 * tblock_sizze_76917 + local_tid_76914;\n    tid_769",
                                    "12 = sext_i32_i64(global_tid_76913);\n    leq_lhs_75434 = ((__global int32_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    leq_rhs_75436 = ((__global int32_t *) tR_mem_75467)[gt_rhs_64823];\n    defunc_0_leq_res_75440 = sle32(leq_lhs_75434, leq_rhs_75436);\n    ((__global bool *) mem_75926)[(int64_t) 0] = defunc_0_leq_res_75440;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_77217_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_77217(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75962, __global unsigned char *mem_75964)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77219;\n    int32_t tblock_sizze_77222;\n    int32_t wave_sizze_77221;\n    int32_t block_id_77220;\n    int32_t global_tid_77218;\n    int64_t tid_77217;\n    int64_t x_75442;\n    \n    local_tid_77219 = get_local_id(0);\n    tblock_sizze_77222 = get_local_size(0);\n    wave_sizze_77221 = LOCKSTEP_WIDTH;\n    block_id_77220 = get_tblock_id(0);\n    global_tid_77218 = block_id_77220 * tblock_sizze_77222 + local_tid_77219;\n    tid_77217 = sext_i32_i64(global_tid_77218);\n    x_75442 = ((__global int64_t *) mem_75962)[m_65696];\n    ((__global int64_t *) mem_75964)[(int64_t) 0] = x_75442;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_77223_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_77223(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75945, __global unsigned char *mem_75967)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77225;\n    int32_t tblock_sizze_77228;\n    int32_t wave_sizze_77227;\n    int32_t block_id_77226;\n    int32_t global_tid_77224;\n    int64_t tid_77223;\n    int64_t x_75446;\n    \n    local_tid_77225 = get_local_id(0);\n    tblock_sizze_77228 = get_local_size(0);\n    wave_sizze_77227 = LOCKSTEP_WIDTH;\n    block_id_77226 = get_tblock_id(0);\n    global_tid_77224 = block_id_77226 * tblock_sizze_77228 + local_tid_77225;\n    tid_77223 = sext_i32_i64(global_tid_77224);\n   ", " x_75446 = ((__global int64_t *) mem_75945)[m_65696];\n    ((__global int64_t *) mem_75967)[(int64_t) 0] = x_75446;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_77229_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_77229(__global int *global_failure, __global unsigned char *ext_mem_75965, __global unsigned char *ext_mem_75968, __global unsigned char *mem_75974)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77231;\n    int32_t tblock_sizze_77234;\n    int32_t wave_sizze_77233;\n    int32_t block_id_77232;\n    int32_t global_tid_77230;\n    int64_t tid_77229;\n    int64_t zp_lhs_75450;\n    int64_t n_pairs_t_res_75451;\n    int64_t n_pairs_t_res_75452;\n    \n    local_tid_77231 = get_local_id(0);\n    tblock_sizze_77234 = get_local_size(0);\n    wave_sizze_77233 = LOCKSTEP_WIDTH;\n    block_id_77232 = get_tblock_id(0);\n    global_tid_77230 = block_id_77232 * tblock_sizze_77234 + local_tid_77231;\n    tid_77229 = sext_i32_i64(global_tid_77230);\n    zp_lhs_75450 = ((__global int64_t *) ext_mem_75965)[(int64_t) 0];\n    n_pairs_t_res_75451 = ((__global int64_t *) ext_mem_75968)[(int64_t) 0];\n    n_pairs_t_res_75452 = add64(zp_lhs_75450, n_pairs_t_res_75451);\n    ((__global int64_t *) mem_75974)[(int64_t) 0] = n_pairs_t_res_75452;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzigpuseq_77276_dim1, 1, 1)\nvoid inner_SMJ_intzigpuseq_77276(__global int *global_failure, int64_t loopres_65870, __global unsigned char *mem_param_76008, __global unsigned char *mem_param_76011, __global unsigned char *mem_param_76014, __global unsigned char *mem_76021, __global unsigned char *mem_76022, __global unsigned char *mem_76023)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77278;\n    int32_t tblock_sizze_77281;\n    int32_t wave_sizze_77280;\n    int32_t block_id_77279;\n    int32_t global_tid_77277;\n    int64_t tid_77276;\n    int32_t loopres_75454;\n    int64_t loopres_75456;\n    int64_t loopres_75458;\n    \n    l", "ocal_tid_77278 = get_local_id(0);\n    tblock_sizze_77281 = get_local_size(0);\n    wave_sizze_77280 = LOCKSTEP_WIDTH;\n    block_id_77279 = get_tblock_id(0);\n    global_tid_77277 = block_id_77279 * tblock_sizze_77281 + local_tid_77278;\n    tid_77276 = sext_i32_i64(global_tid_77277);\n    loopres_75454 = ((__global int32_t *) mem_param_76008)[loopres_65870];\n    loopres_75456 = ((__global int64_t *) mem_param_76011)[loopres_65870];\n    loopres_75458 = ((__global int64_t *) mem_param_76014)[loopres_65870];\n    ((__global int32_t *) mem_76021)[(int64_t) 0] = loopres_75454;\n    ((__global int64_t *) mem_76022)[(int64_t) 0] = loopres_75456;\n    ((__global int64_t *) mem_76023)[(int64_t) 0] = loopres_75458;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_intzireplicate_77283(int64_t loopres_65871, int64_t replicate_n_77282, int64_t virt_num_tblocks_77288, int64_t num_tblocks_77289, __global unsigned char *mem_76021, __global unsigned char *mem_76025)\n{\n    int32_t replicate_ltid_77284;\n    int32_t tblock_sizze_77286;\n    int32_t replicate_gid_77285;\n    int32_t replicate_gtid_77283;\n    int32_t phys_tblock_id_77290;\n    int32_t iterations_77291;\n    \n    replicate_ltid_77284 = get_local_id(0);\n    tblock_sizze_77286 = get_local_size(0);\n    replicate_gid_77285 = get_tblock_id(0);\n    replicate_gtid_77283 = replicate_gid_77285 * tblock_sizze_77286 + replicate_ltid_77284;\n    phys_tblock_id_77290 = get_tblock_id(0);\n    iterations_77291 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77288) - phys_tblock_id_77290, sext_i64_i32(num_tblocks_77289));\n    for (int32_t i_77292 = 0; i_77292 < iterations_77291; i_77292++) {\n        int32_t virt_tblock_id_77293;\n        int64_t global_tid_77294;\n        int64_t slice_77297;\n        int64_t slice_77298;\n        int64_t rep_i_77295;\n        int64_t remnant_77299;\n        int64_t rep_i_77296;\n        int64_t remnant_77300;\n        \n        virt_tblock_id_77293 = phys_tblock_id_77290 + i_77292 * sext_i64_i32(num_tblocks_77289);\n    ",
                                    "    global_tid_77294 = sext_i32_i64(virt_tblock_id_77293) * sext_i32_i64(tblock_sizze_77286) + sext_i32_i64(replicate_ltid_77284);\n        slice_77297 = (int64_t) 1;\n        slice_77298 = loopres_65871 * slice_77297;\n        rep_i_77295 = squot64(global_tid_77294, slice_77297);\n        remnant_77299 = global_tid_77294 - rep_i_77295 * slice_77297;\n        rep_i_77296 = remnant_77299;\n        remnant_77300 = remnant_77299 - rep_i_77296;\n        if (slt64(global_tid_77294, replicate_n_77282)) {\n            int32_t tmp_77301 = ((__global int32_t *) mem_76021)[rep_i_77296];\n            \n            ((__global int32_t *) mem_76025)[rep_i_77295 + rep_i_77296] = tmp_77301;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_intzireplicate_77303(int64_t loopres_65871, int64_t replicate_n_77302, int64_t virt_num_tblocks_77308, int64_t num_tblocks_77309, __global unsigned char *mem_76022, __global unsigned char *mem_76027)\n{\n    int32_t replicate_ltid_77304;\n    int32_t tblock_sizze_77306;\n    int32_t replicate_gid_77305;\n    int32_t replicate_gtid_77303;\n    int32_t phys_tblock_id_77310;\n    int32_t iterations_77311;\n    \n    replicate_ltid_77304 = get_local_id(0);\n    tblock_sizze_77306 = get_local_size(0);\n    replicate_gid_77305 = get_tblock_id(0);\n    replicate_gtid_77303 = replicate_gid_77305 * tblock_sizze_77306 + replicate_ltid_77304;\n    phys_tblock_id_77310 = get_tblock_id(0);\n    iterations_77311 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77308) - phys_tblock_id_77310, sext_i64_i32(num_tblocks_77309));\n    for (int32_t i_77312 = 0; i_77312 < iterations_77311; i_77312++) {\n        int32_t virt_tblock_id_77313;\n        int64_t global_tid_77314;\n        int64_t slice_77317;\n        int64_t slice_77318;\n        int64_t rep_i_77315;\n        int64_t remnant_77319;\n        int64_t rep_i_77316;\n        int64_t remnant_77320;\n        \n        virt_tblock_id_77313 = phys_tblock_id_77310 + i_77", "312 * sext_i64_i32(num_tblocks_77309);\n        global_tid_77314 = sext_i32_i64(virt_tblock_id_77313) * sext_i32_i64(tblock_sizze_77306) + sext_i32_i64(replicate_ltid_77304);\n        slice_77317 = (int64_t) 1;\n        slice_77318 = loopres_65871 * slice_77317;\n        rep_i_77315 = squot64(global_tid_77314, slice_77317);\n        remnant_77319 = global_tid_77314 - rep_i_77315 * slice_77317;\n        rep_i_77316 = remnant_77319;\n        remnant_77320 = remnant_77319 - rep_i_77316;\n        if (slt64(global_tid_77314, replicate_n_77302)) {\n            int64_t tmp_77321 = ((__global int64_t *) mem_76022)[rep_i_77316];\n            \n            ((__global int64_t *) mem_76027)[rep_i_77315 + rep_i_77316] = tmp_77321;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69035_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69035(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_42219, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t max_res_65013, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, int64_t zt_rhs_65019, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75495, __global unsigned char *mem_75504, __global unsigned char *mem_75506)\n{\n    #define segmap_tblock_sizze_69030 (inner_SMJ_intzisegmap_69035zisegmap_tblock_sizze_69030)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76715;\n    int32_t tblock_sizze_76718;\n    int32_t wave_sizze_76717;\n    int32_t block_id_76716;\n    int32_t global_tid_76714;\n    int64_t phys_tid_69035;\n    int64_t global_tid_76719;\n    int64_t slice_76720;\n    int64_t gtid_69034;\n    int64_t remnant_76721;\n    \n    local_tid_76715 = get_local_id(0);\n    tblock_sizze_76718 = get_local_size(0);\n    wave_sizze_76717 = LOCKSTEP_WIDTH;\n    block_i", "d_76716 = get_tblock_id(0);\n    global_tid_76714 = block_id_76716 * tblock_sizze_76718 + local_tid_76715;\n    phys_tid_69035 = sext_i32_i64(global_tid_76714);\n    global_tid_76719 = sext_i32_i64(block_id_76716) * segmap_tblock_sizze_69030 + sext_i32_i64(local_tid_76715);\n    slice_76720 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;\n    gtid_69034 = global_tid_76719;\n    remnant_76721 = global_tid_76719 - gtid_69034;\n    if (slt64(gtid_69034, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014)) {\n        int32_t lowest_75411;\n        int64_t index_primexp_73897;\n        int64_t zs_lhs_69037;\n        int64_t index_69038;\n        bool cond_69039;\n        int64_t loop_over_69040;\n        int64_t loop_over_69041;\n        int64_t loop_over_69043;\n        bool defunc_0_f_res_69046;\n        int64_t defunc_0_f_res_69047;\n        int64_t defunc_0_f_res_69048;\n        int64_t defunc_0_f_res_69049;\n        bool loop_while_69050;\n        int64_t p_69051;\n        int64_t p_69052;\n        int64_t p_69053;\n        \n        lowest_75411 = ((__global int32_t *) ext_mem_75495)[(int64_t) 0];\n        index_primexp_73897 = add64(max_res_65013, gtid_69034);\n        zs_lhs_69037 = mul64(zt_rhs_65019, index_primexp_73897);\n        index_69038 = sdiv64(zs_lhs_69037, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n        cond_69039 = slt64(nR_42219, index_69038);\n        if (cond_69039) {\n            loop_over_69040 = nR_42219;\n        } else {\n            loop_over_69040 = index_69038;\n        }\n        if (cond_69039) {\n            int64_t loop_over_t_res_69042 = sub64(index_69038, nR_42219);\n            \n            loop_over_69041 = loop_over_t_res_69042;\n        } else {\n            loop_over_69041 = (int64_t) 0;\n        }\n        if (cond_69039) {\n            int64_t zm_lhs_69044;\n            int64_t loop_over_t_res_69045;\n            \n            zm_lhs_69044 = sub64(index_69038, nR_42219);\n            loop_over_t_res_69045 = sub64(zm_lh",
                                    "s_69044, (int64_t) 1);\n            loop_over_69043 = loop_over_t_res_69045;\n        } else {\n            loop_over_69043 = (int64_t) 0;\n        }\n        loop_while_69050 = 1;\n        p_69051 = loop_over_69043;\n        p_69052 = loop_over_69040;\n        p_69053 = loop_over_69041;\n        while (loop_while_69050) {\n            int64_t zs_lhs_69054;\n            int64_t offset_69055;\n            int64_t ai_69056;\n            int64_t max_arg1_69057;\n            int64_t max_res_69058;\n            bool cond_69059;\n            int32_t b_prev_69060;\n            bool cond_69068;\n            int64_t loopres_69069;\n            int64_t loopres_69070;\n            int64_t loopres_69071;\n            bool loopres_69072;\n            bool loop_while_tmp_76722;\n            int64_t p_tmp_76723;\n            int64_t p_tmp_76724;\n            int64_t p_tmp_76725;\n            \n            zs_lhs_69054 = sub64(p_69052, p_69051);\n            offset_69055 = sdiv64(zs_lhs_69054, (int64_t) 2);\n            ai_69056 = sub64(p_69052, offset_69055);\n            max_arg1_69057 = add64(p_69053, offset_69055);\n            max_res_69058 = smax64((int64_t) 0, max_arg1_69057);\n            cond_69059 = slt64((int64_t) 0, max_res_69058);\n            if (cond_69059) {\n                int64_t tmp_69061;\n                bool x_69062;\n                bool y_69063;\n                bool bounds_check_69064;\n                bool index_certs_69065;\n                int64_t slice_69066;\n                int32_t b_prev_t_res_69067;\n                \n                tmp_69061 = sub64(max_res_69058, (int64_t) 1);\n                x_69062 = sle64((int64_t) 0, tmp_69061);\n                y_69063 = slt64(tmp_69061, nR_42219);\n                bounds_check_69064 = x_69062 && y_69063;\n                if (!bounds_check_69064) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 76) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_69061;\n                       ", "     global_failure_args[1] = (int64_t) nR_42219;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_69066 = tS_start_64840 + tmp_69061;\n                b_prev_t_res_69067 = ((__global int32_t *) tS_mem_75468)[slice_69066];\n                b_prev_69060 = b_prev_t_res_69067;\n            } else {\n                b_prev_69060 = lowest_75411;\n            }\n            cond_69068 = sle64(ai_69056, (int64_t) 0);\n            if (cond_69068) {\n                loopres_69069 = p_69051;\n                loopres_69070 = (int64_t) 0;\n                loopres_69071 = max_res_69058;\n                loopres_69072 = 0;\n            } else {\n                bool cond_69073;\n                int64_t loopres_f_res_69074;\n                int64_t loopres_f_res_69075;\n                int64_t loopres_f_res_69076;\n                bool loopres_f_res_69077;\n                \n                cond_69073 = sle64(nR_42219, max_res_69058);\n                if (cond_69073) {\n                    int64_t min_arg1_69078;\n                    int64_t min_res_69079;\n                    bool x_69080;\n                    bool y_69081;\n                    bool bounds_check_69082;\n                    bool index_certs_69083;\n                    bool x_69086;\n                    bool y_69087;\n                    bool bounds_check_69088;\n                    bool index_certs_69089;\n                    int64_t slice_69084;\n                    int32_t leq_lhs_69085;\n                    int32_t leq_rhs_69090;\n                    bool defunc_0_leq_res_69091;\n                    int64_t loopres_f_res_t_res_69092;\n                    bool x_69093;\n                    int64_t loopres_f_res_t_res_69094;\n                    \n                    min_arg1_69078 = sub64(nR_42219, (int64_t) 1);\n                    min_res_69079 = smin64(ai_69056, min_arg1_69078);\n                    x_69080 = sle64((int64_t) 0, min_arg1_69078);\n     ", "               y_69081 = slt64(min_arg1_69078, nR_42219);\n                    bounds_check_69082 = x_69080 && y_69081;\n                    if (!bounds_check_69082) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 77) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_69078;\n                                global_failure_args[1] = (int64_t) nR_42219;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_69086 = sle64((int64_t) 0, min_res_69079);\n                    y_69087 = slt64(min_res_69079, nR_42219);\n                    bounds_check_69088 = x_69086 && y_69087;\n                    if (!bounds_check_69088) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 78) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_69079;\n                                global_failure_args[1] = (int64_t) nR_42219;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_69084 = tS_start_64840 + min_arg1_69078;\n                    leq_lhs_69085 = ((__global int32_t *) tS_mem_75468)[slice_69084];\n                    leq_rhs_69090 = ((__global int32_t *) tR_mem_75467)[min_res_69079];\n                    defunc_0_leq_res_69091 = sle32(leq_lhs_69085, leq_rhs_69090);\n                    if (defunc_0_leq_res_69091) {\n                        loopres_f_res_t_res_69092 = ai_69056;\n                    } else {\n                        loopres_f_res_t_res_69092 = p_69052;\n                    }\n                    x_69093 = !defunc_0_leq_res_69091;\n                    if (defunc_0_leq_res_69091) {\n                        loopres_f_res_t_res_69094 = nR_42219;\n                    } else {\n       ",
                                    "                 int64_t tmp_69095 = sub64(min_arg1_69078, offset_69055);\n                        \n                        loopres_f_res_t_res_69094 = tmp_69095;\n                    }\n                    loopres_f_res_69074 = p_69051;\n                    loopres_f_res_69075 = loopres_f_res_t_res_69092;\n                    loopres_f_res_69076 = loopres_f_res_t_res_69094;\n                    loopres_f_res_69077 = x_69093;\n                } else {\n                    bool cond_69096;\n                    int64_t loopres_f_res_f_res_69097;\n                    int64_t loopres_f_res_f_res_69098;\n                    int64_t loopres_f_res_f_res_69099;\n                    bool loopres_f_res_f_res_69100;\n                    \n                    cond_69096 = sle64(nR_42219, ai_69056);\n                    if (cond_69096) {\n                        int64_t min_arg1_69101;\n                        int64_t min_res_69102;\n                        bool x_69103;\n                        bool y_69104;\n                        bool bounds_check_69105;\n                        bool index_certs_69106;\n                        bool x_69108;\n                        bool y_69109;\n                        bool bounds_check_69110;\n                        bool index_certs_69111;\n                        int32_t leq_lhs_69107;\n                        int64_t slice_69112;\n                        int32_t leq_rhs_69113;\n                        bool defunc_0_leq_res_69114;\n                        int64_t loopres_f_res_f_res_t_res_69115;\n                        bool x_69116;\n                        int64_t loopres_f_res_f_res_t_res_69117;\n                        \n                        min_arg1_69101 = sub64(nR_42219, (int64_t) 1);\n                        min_res_69102 = smin64(max_res_69058, min_arg1_69101);\n                        x_69103 = sle64((int64_t) 0, min_arg1_69101);\n                        y_69104 = slt64(min_arg1_69101, nR_42219);\n                        bounds_check_69105 = x_69103 && y_69104;\n", "                        if (!bounds_check_69105) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 79) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_69101;\n                                    global_failure_args[1] = (int64_t) nR_42219;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_69108 = sle64((int64_t) 0, min_res_69102);\n                        y_69109 = slt64(min_res_69102, nR_42219);\n                        bounds_check_69110 = x_69108 && y_69109;\n                        if (!bounds_check_69110) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 80) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_69102;\n                                    global_failure_args[1] = (int64_t) nR_42219;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_69107 = ((__global int32_t *) tR_mem_75467)[min_arg1_69101];\n                        slice_69112 = tS_start_64840 + min_res_69102;\n                        leq_rhs_69113 = ((__global int32_t *) tS_mem_75468)[slice_69112];\n                        defunc_0_leq_res_69114 = sle32(leq_lhs_69107, leq_rhs_69113);\n                        if (defunc_0_leq_res_69114) {\n                            loopres_f_res_f_res_t_res_69115 = max_res_69058;\n                        } else {\n                            loopres_f_res_f_res_t_res_69115 = p_69053;\n                        }\n                        x_69116 = !defunc_0_leq_res_69114;\n                        if (defunc_0_leq_res_69114) {\n                            loopres_f_res_f_res_t_res_69117 = nR", "_42219;\n                        } else {\n                            loopres_f_res_f_res_t_res_69117 = min_arg1_69101;\n                        }\n                        loopres_f_res_f_res_69097 = p_69051;\n                        loopres_f_res_f_res_69098 = loopres_f_res_f_res_t_res_69117;\n                        loopres_f_res_f_res_69099 = loopres_f_res_f_res_t_res_69115;\n                        loopres_f_res_f_res_69100 = x_69116;\n                    } else {\n                        bool cond_69118;\n                        int64_t loopres_f_res_f_res_f_res_69119;\n                        int64_t loopres_f_res_f_res_f_res_69120;\n                        int64_t loopres_f_res_f_res_f_res_69121;\n                        bool loopres_f_res_f_res_f_res_69122;\n                        \n                        cond_69118 = sle64(p_69052, p_69051);\n                        if (cond_69118) {\n                            bool cond_69123;\n                            int64_t ai_69124;\n                            bool x_69137;\n                            bool y_69138;\n                            bool bounds_check_69139;\n                            bool index_certs_69140;\n                            int32_t b_prev_69126;\n                            int32_t gt_lhs_69141;\n                            bool defunc_0_gt_res_69142;\n                            int64_t defunc_0_partFunc_sequential_search_res_69143;\n                            int64_t defunc_0_partFunc_sequential_search_res_69144;\n                            \n                            cond_69123 = slt64(ai_69056, nR_42219);\n                            if (cond_69123) {\n                                ai_69124 = ai_69056;\n                            } else {\n                                int64_t ai_f_res_69125 = sub64(nR_42219, (int64_t) 1);\n                                \n                                ai_69124 = ai_f_res_69125;\n                            }\n                            x_69137 = sle64((int64_t) 0, ai_691",
                                    "24);\n                            y_69138 = slt64(ai_69124, nR_42219);\n                            bounds_check_69139 = x_69137 && y_69138;\n                            if (!bounds_check_69139) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 81) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_69124;\n                                        global_failure_args[1] = (int64_t) nR_42219;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_69059) {\n                                int64_t tmp_69127;\n                                bool x_69128;\n                                bool y_69129;\n                                bool bounds_check_69130;\n                                bool index_certs_69131;\n                                int64_t slice_69132;\n                                int32_t b_prev_t_res_69133;\n                                \n                                tmp_69127 = sub64(max_res_69058, (int64_t) 1);\n                                x_69128 = sle64((int64_t) 0, tmp_69127);\n                                y_69129 = slt64(tmp_69127, nR_42219);\n                                bounds_check_69130 = x_69128 && y_69129;\n                                if (!bounds_check_69130) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 82) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_69127;\n                                            global_failure_args[1] = (int64_t) nR_42219;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                   ", "             }\n                                slice_69132 = tS_start_64840 + tmp_69127;\n                                b_prev_t_res_69133 = ((__global int32_t *) tS_mem_75468)[slice_69132];\n                                b_prev_69126 = b_prev_t_res_69133;\n                            } else {\n                                bool y_69134;\n                                bool index_certs_69135;\n                                int32_t b_prev_f_res_69136;\n                                \n                                y_69134 = slt64((int64_t) 0, nR_42219);\n                                if (!y_69134) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 83) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_42219;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_69136 = ((__global int32_t *) tS_mem_75468)[tS_start_64840];\n                                b_prev_69126 = b_prev_f_res_69136;\n                            }\n                            gt_lhs_69141 = ((__global int32_t *) tR_mem_75467)[ai_69124];\n                            defunc_0_gt_res_69142 = slt32(b_prev_69126, gt_lhs_69141);\n                            if (defunc_0_gt_res_69142) {\n                                int64_t zl_rhs_69145;\n                                bool loop_cond_69146;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_69147;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_69148;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_69149;\n                                int64_", "t defunc_0_partFunc_sequential_search_res_t_res_69150;\n                                bool loop_while_69151;\n                                int64_t p_69152;\n                                int64_t p_69153;\n                                int64_t p_69154;\n                                \n                                zl_rhs_69145 = sub64(nR_42219, max_res_69058);\n                                loop_cond_69146 = slt64((int64_t) 0, zl_rhs_69145);\n                                loop_while_69151 = loop_cond_69146;\n                                p_69152 = ai_69124;\n                                p_69153 = max_res_69058;\n                                p_69154 = (int64_t) 0;\n                                while (loop_while_69151) {\n                                    int64_t i_a_69155;\n                                    int64_t i_b_69156;\n                                    int64_t leq_lhs_69157;\n                                    bool x_69158;\n                                    bool y_69159;\n                                    bool bounds_check_69160;\n                                    bool index_certs_69161;\n                                    bool x_69163;\n                                    bool y_69164;\n                                    bool bounds_check_69165;\n                                    bool index_certs_69166;\n                                    int32_t leq_lhs_69162;\n                                    int64_t slice_69167;\n                                    int32_t leq_rhs_69168;\n                                    bool defunc_0_leq_res_69169;\n                                    int64_t loopres_69170;\n                                    int64_t loopres_69171;\n                                    int64_t loopres_69172;\n                                    bool loop_cond_69174;\n                                    bool loop_while_tmp_76726;\n                                    int64_t p_tmp_76727;\n                                    int64_t p_tmp_",
                                    "76728;\n                                    int64_t p_tmp_76729;\n                                    \n                                    i_a_69155 = sub64(ai_69124, p_69154);\n                                    i_b_69156 = add64(max_res_69058, p_69154);\n                                    leq_lhs_69157 = sub64(i_a_69155, (int64_t) 1);\n                                    x_69158 = sle64((int64_t) 0, leq_lhs_69157);\n                                    y_69159 = slt64(leq_lhs_69157, nR_42219);\n                                    bounds_check_69160 = x_69158 && y_69159;\n                                    if (!bounds_check_69160) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 84) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_69157;\n                                                global_failure_args[1] = (int64_t) nR_42219;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_69163 = sle64((int64_t) 0, i_b_69156);\n                                    y_69164 = slt64(i_b_69156, nR_42219);\n                                    bounds_check_69165 = x_69163 && y_69164;\n                                    if (!bounds_check_69165) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 85) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_69156;\n                                                global_failure_args[1] = (int64_t) nR_42219;\n                                                ;\n                                            }\n                                            return;\n                     ", "                   }\n                                    }\n                                    leq_lhs_69162 = ((__global int32_t *) tR_mem_75467)[leq_lhs_69157];\n                                    slice_69167 = tS_start_64840 + i_b_69156;\n                                    leq_rhs_69168 = ((__global int32_t *) tS_mem_75468)[slice_69167];\n                                    defunc_0_leq_res_69169 = sle32(leq_lhs_69162, leq_rhs_69168);\n                                    if (defunc_0_leq_res_69169) {\n                                        loopres_69170 = i_a_69155;\n                                    } else {\n                                        loopres_69170 = ai_69124;\n                                    }\n                                    if (defunc_0_leq_res_69169) {\n                                        loopres_69171 = i_b_69156;\n                                    } else {\n                                        loopres_69171 = max_res_69058;\n                                    }\n                                    if (defunc_0_leq_res_69169) {\n                                        loopres_69172 = zl_rhs_69145;\n                                    } else {\n                                        int64_t tmp_69173 = add64((int64_t) 1, p_69154);\n                                        \n                                        loopres_69172 = tmp_69173;\n                                    }\n                                    loop_cond_69174 = slt64(loopres_69172, zl_rhs_69145);\n                                    loop_while_tmp_76726 = loop_cond_69174;\n                                    p_tmp_76727 = loopres_69170;\n                                    p_tmp_76728 = loopres_69171;\n                                    p_tmp_76729 = loopres_69172;\n                                    loop_while_69151 = loop_while_tmp_76726;\n                                    p_69152 = p_tmp_76727;\n                                    p_69153 = p_tmp_76728;\n                  ", "                  p_69154 = p_tmp_76729;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_69147 = loop_while_69151;\n                                defunc_0_partFunc_sequential_search_res_t_res_69148 = p_69152;\n                                defunc_0_partFunc_sequential_search_res_t_res_69149 = p_69153;\n                                defunc_0_partFunc_sequential_search_res_t_res_69150 = p_69154;\n                                defunc_0_partFunc_sequential_search_res_69143 = defunc_0_partFunc_sequential_search_res_t_res_69148;\n                                defunc_0_partFunc_sequential_search_res_69144 = defunc_0_partFunc_sequential_search_res_t_res_69149;\n                            } else {\n                                int64_t zl_rhs_69175;\n                                bool loop_cond_69176;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_69177;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_69178;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_69179;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_69180;\n                                bool loop_while_69181;\n                                int64_t p_69182;\n                                int64_t p_69183;\n                                int64_t p_69184;\n                                \n                                zl_rhs_69175 = sub64(max_res_69058, (int64_t) 1);\n                                loop_cond_69176 = slt64((int64_t) 0, zl_rhs_69175);\n                                loop_while_69181 = loop_cond_69176;\n                                p_69182 = ai_69124;\n                                p_69183 = max_res_69058;\n                                p_69184 = (int64_t) 0;\n                                while (loop_while_69181) {\n                                    int64_t zp_lhs_69185;\n      ",
                                    "                              int64_t hi_a_69186;\n                                    bool cond_69187;\n                                    int64_t i_a_69188;\n                                    int64_t zm_lhs_69190;\n                                    int64_t i_b_69191;\n                                    bool x_69192;\n                                    bool y_69193;\n                                    bool bounds_check_69194;\n                                    bool index_certs_69195;\n                                    bool x_69197;\n                                    bool y_69198;\n                                    bool bounds_check_69199;\n                                    bool index_certs_69200;\n                                    int32_t gt_lhs_69196;\n                                    int64_t slice_69201;\n                                    int32_t gt_rhs_69202;\n                                    bool defunc_0_gt_res_69203;\n                                    int64_t loopres_69204;\n                                    int64_t loopres_69205;\n                                    int64_t loopres_69206;\n                                    bool loop_cond_69208;\n                                    bool loop_while_tmp_76730;\n                                    int64_t p_tmp_76731;\n                                    int64_t p_tmp_76732;\n                                    int64_t p_tmp_76733;\n                                    \n                                    zp_lhs_69185 = add64(ai_69124, p_69184);\n                                    hi_a_69186 = add64((int64_t) 1, zp_lhs_69185);\n                                    cond_69187 = slt64(hi_a_69186, nR_42219);\n                                    if (cond_69187) {\n                                        i_a_69188 = hi_a_69186;\n                                    } else {\n                                        int64_t i_a_f_res_69189 = sub64(nR_42219, (int64_t) 1);\n                                        \n      ", "                                  i_a_69188 = i_a_f_res_69189;\n                                    }\n                                    zm_lhs_69190 = sub64(max_res_69058, p_69184);\n                                    i_b_69191 = sub64(zm_lhs_69190, (int64_t) 1);\n                                    x_69192 = sle64((int64_t) 0, i_a_69188);\n                                    y_69193 = slt64(i_a_69188, nR_42219);\n                                    bounds_check_69194 = x_69192 && y_69193;\n                                    if (!bounds_check_69194) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 86) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_69188;\n                                                global_failure_args[1] = (int64_t) nR_42219;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_69197 = sle64((int64_t) 0, i_b_69191);\n                                    y_69198 = slt64(i_b_69191, nR_42219);\n                                    bounds_check_69199 = x_69197 && y_69198;\n                                    if (!bounds_check_69199) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 87) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_69191;\n                                                global_failure_args[1] = (int64_t) nR_42219;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                         ", "           gt_lhs_69196 = ((__global int32_t *) tR_mem_75467)[i_a_69188];\n                                    slice_69201 = tS_start_64840 + i_b_69191;\n                                    gt_rhs_69202 = ((__global int32_t *) tS_mem_75468)[slice_69201];\n                                    defunc_0_gt_res_69203 = slt32(gt_rhs_69202, gt_lhs_69196);\n                                    if (defunc_0_gt_res_69203) {\n                                        loopres_69204 = i_a_69188;\n                                    } else {\n                                        loopres_69204 = ai_69124;\n                                    }\n                                    if (defunc_0_gt_res_69203) {\n                                        loopres_69205 = zm_lhs_69190;\n                                    } else {\n                                        loopres_69205 = max_res_69058;\n                                    }\n                                    if (defunc_0_gt_res_69203) {\n                                        loopres_69206 = zl_rhs_69175;\n                                    } else {\n                                        int64_t tmp_69207 = add64((int64_t) 1, p_69184);\n                                        \n                                        loopres_69206 = tmp_69207;\n                                    }\n                                    loop_cond_69208 = slt64(loopres_69206, zl_rhs_69175);\n                                    loop_while_tmp_76730 = loop_cond_69208;\n                                    p_tmp_76731 = loopres_69204;\n                                    p_tmp_76732 = loopres_69205;\n                                    p_tmp_76733 = loopres_69206;\n                                    loop_while_69181 = loop_while_tmp_76730;\n                                    p_69182 = p_tmp_76731;\n                                    p_69183 = p_tmp_76732;\n                                    p_69184 = p_tmp_76733;\n                                }\n                  ",
                                    "              defunc_0_partFunc_sequential_search_res_f_res_69177 = loop_while_69181;\n                                defunc_0_partFunc_sequential_search_res_f_res_69178 = p_69182;\n                                defunc_0_partFunc_sequential_search_res_f_res_69179 = p_69183;\n                                defunc_0_partFunc_sequential_search_res_f_res_69180 = p_69184;\n                                defunc_0_partFunc_sequential_search_res_69143 = defunc_0_partFunc_sequential_search_res_f_res_69178;\n                                defunc_0_partFunc_sequential_search_res_69144 = defunc_0_partFunc_sequential_search_res_f_res_69179;\n                            }\n                            loopres_f_res_f_res_f_res_69119 = p_69051;\n                            loopres_f_res_f_res_f_res_69120 = defunc_0_partFunc_sequential_search_res_69143;\n                            loopres_f_res_f_res_f_res_69121 = defunc_0_partFunc_sequential_search_res_69144;\n                            loopres_f_res_f_res_f_res_69122 = 0;\n                        } else {\n                            bool x_69209;\n                            bool y_69210;\n                            bool bounds_check_69211;\n                            bool index_certs_69212;\n                            int32_t gt_lhs_69213;\n                            bool defunc_0_gt_res_69214;\n                            int64_t loopres_f_res_f_res_f_res_f_res_69215;\n                            int64_t loopres_f_res_f_res_f_res_f_res_69216;\n                            int64_t loopres_f_res_f_res_f_res_f_res_69217;\n                            bool loopres_f_res_f_res_f_res_f_res_69218;\n                            \n                            x_69209 = sle64((int64_t) 0, ai_69056);\n                            y_69210 = slt64(ai_69056, nR_42219);\n                            bounds_check_69211 = x_69209 && y_69210;\n                            if (!bounds_check_69211) {\n                                {\n                                  ", "  if (atomic_cmpxchg_i32_global(global_failure, -1, 88) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_69056;\n                                        global_failure_args[1] = (int64_t) nR_42219;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_69213 = ((__global int32_t *) tR_mem_75467)[ai_69056];\n                            defunc_0_gt_res_69214 = slt32(b_prev_69060, gt_lhs_69213);\n                            if (defunc_0_gt_res_69214) {\n                                int64_t leq_lhs_69219;\n                                bool x_69220;\n                                bool y_69221;\n                                bool bounds_check_69222;\n                                bool index_certs_69223;\n                                bool x_69225;\n                                bool y_69226;\n                                bool bounds_check_69227;\n                                bool index_certs_69228;\n                                int32_t leq_lhs_69224;\n                                int64_t slice_69229;\n                                int32_t leq_rhs_69230;\n                                bool defunc_0_leq_res_69231;\n                                bool x_69232;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_69233;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_69234;\n                                \n                                leq_lhs_69219 = sub64(ai_69056, (int64_t) 1);\n                                x_69220 = sle64((int64_t) 0, leq_lhs_69219);\n                                y_69221 = slt64(leq_lhs_69219, nR_42219);\n                                bounds_check_69222 = x_69220 && y_69221;\n                                if (!bounds_check_69222) {\n                                    {\n      ", "                                  if (atomic_cmpxchg_i32_global(global_failure, -1, 89) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_69219;\n                                            global_failure_args[1] = (int64_t) nR_42219;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_69225 = sle64((int64_t) 0, max_res_69058);\n                                y_69226 = slt64(max_res_69058, nR_42219);\n                                bounds_check_69227 = x_69225 && y_69226;\n                                if (!bounds_check_69227) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 90) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_69058;\n                                            global_failure_args[1] = (int64_t) nR_42219;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_69224 = ((__global int32_t *) tR_mem_75467)[leq_lhs_69219];\n                                slice_69229 = tS_start_64840 + max_res_69058;\n                                leq_rhs_69230 = ((__global int32_t *) tS_mem_75468)[slice_69229];\n                                defunc_0_leq_res_69231 = sle32(leq_lhs_69224, leq_rhs_69230);\n                                x_69232 = !defunc_0_leq_res_69231;\n                                if (defunc_0_leq_res_69231) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_69233 = ai_69056;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_r",
                                    "es_t_res_69233 = leq_lhs_69219;\n                                }\n                                if (defunc_0_leq_res_69231) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_69234 = max_res_69058;\n                                } else {\n                                    int64_t tmp_69235 = add64((int64_t) 1, max_res_69058);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_69234 = tmp_69235;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_69215 = p_69051;\n                                loopres_f_res_f_res_f_res_f_res_69216 = loopres_f_res_f_res_f_res_f_res_t_res_69233;\n                                loopres_f_res_f_res_f_res_f_res_69217 = loopres_f_res_f_res_f_res_f_res_t_res_69234;\n                                loopres_f_res_f_res_f_res_f_res_69218 = x_69232;\n                            } else {\n                                int64_t tmp_69236 = add64((int64_t) 1, ai_69056);\n                                \n                                loopres_f_res_f_res_f_res_f_res_69215 = tmp_69236;\n                                loopres_f_res_f_res_f_res_f_res_69216 = p_69052;\n                                loopres_f_res_f_res_f_res_f_res_69217 = p_69053;\n                                loopres_f_res_f_res_f_res_f_res_69218 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_69119 = loopres_f_res_f_res_f_res_f_res_69215;\n                            loopres_f_res_f_res_f_res_69120 = loopres_f_res_f_res_f_res_f_res_69216;\n                            loopres_f_res_f_res_f_res_69121 = loopres_f_res_f_res_f_res_f_res_69217;\n                            loopres_f_res_f_res_f_res_69122 = loopres_f_res_f_res_f_res_f_res_69218;\n                        }\n                        loopres_f_res_f_res_69097 = loopres_f_res_f_res_f_res_69119;\n                        loopres_f_res_f_res_69098 = loopres_f_res_", "f_res_f_res_69120;\n                        loopres_f_res_f_res_69099 = loopres_f_res_f_res_f_res_69121;\n                        loopres_f_res_f_res_69100 = loopres_f_res_f_res_f_res_69122;\n                    }\n                    loopres_f_res_69074 = loopres_f_res_f_res_69097;\n                    loopres_f_res_69075 = loopres_f_res_f_res_69098;\n                    loopres_f_res_69076 = loopres_f_res_f_res_69099;\n                    loopres_f_res_69077 = loopres_f_res_f_res_69100;\n                }\n                loopres_69069 = loopres_f_res_69074;\n                loopres_69070 = loopres_f_res_69075;\n                loopres_69071 = loopres_f_res_69076;\n                loopres_69072 = loopres_f_res_69077;\n            }\n            loop_while_tmp_76722 = loopres_69072;\n            p_tmp_76723 = loopres_69069;\n            p_tmp_76724 = loopres_69070;\n            p_tmp_76725 = loopres_69071;\n            loop_while_69050 = loop_while_tmp_76722;\n            p_69051 = p_tmp_76723;\n            p_69052 = p_tmp_76724;\n            p_69053 = p_tmp_76725;\n        }\n        defunc_0_f_res_69046 = loop_while_69050;\n        defunc_0_f_res_69047 = p_69051;\n        defunc_0_f_res_69048 = p_69052;\n        defunc_0_f_res_69049 = p_69053;\n        ((__global int64_t *) mem_75504)[gtid_69034] = defunc_0_f_res_69048;\n        ((__global int64_t *) mem_75506)[gtid_69034] = defunc_0_f_res_69049;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69030\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69409_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69409(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_42219, int64_t gt_rhs_64823, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t zeze_rhs_65256, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75486, __global unsigned char *mem_75488, __global unsigned char *mem_7552", "2, __global unsigned char *mem_75524)\n{\n    #define segmap_tblock_sizze_69404 (inner_SMJ_intzisegmap_69409zisegmap_tblock_sizze_69404)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76738;\n    int32_t tblock_sizze_76741;\n    int32_t wave_sizze_76740;\n    int32_t block_id_76739;\n    int32_t global_tid_76737;\n    int64_t phys_tid_69409;\n    int64_t global_tid_76742;\n    int64_t slice_76743;\n    int64_t gtid_69408;\n    int64_t remnant_76744;\n    \n    local_tid_76738 = get_local_id(0);\n    tblock_sizze_76741 = get_local_size(0);\n    wave_sizze_76740 = LOCKSTEP_WIDTH;\n    block_id_76739 = get_tblock_id(0);\n    global_tid_76737 = block_id_76739 * tblock_sizze_76741 + local_tid_76738;\n    phys_tid_69409 = sext_i32_i64(global_tid_76737);\n    global_tid_76742 = sext_i32_i64(block_id_76739) * segmap_tblock_sizze_69404 + sext_i32_i64(local_tid_76738);\n    slice_76743 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n    gtid_69408 = global_tid_76742;\n    remnant_76744 = global_tid_76742 - gtid_69408;\n    if (slt64(gtid_69408, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982)) {\n        int64_t eta_p_69411;\n        int64_t min_res_69412;\n        bool x_69413;\n        bool y_69414;\n        bool bounds_check_69415;\n        bool index_certs_69416;\n        bool cond_69418;\n        int64_t ri_next_69419;\n        int64_t max_arg1_69426;\n        int64_t max_res_69427;\n        bool x_69428;\n        bool y_69429;\n        bool bounds_check_69430;\n        bool index_certs_69431;\n        int32_t r_min_69417;\n        int32_t r_max_69432;\n        bool defunc_0_f_res_69433;\n        int64_t defunc_0_f_res_69434;\n        bool loop_while_69435;\n        int64_t fm_69436;\n        bool defunc_0_f_res_69502;\n        int64_t defunc_0_f_res_69503;\n        bool loop_while_69504;\n        int64_t lm_69505;\n        \n        eta_p_69411 = ((__global int64_t *) mem_75486)[gtid_69408];\n        min_res_69412 = smin64(gt_rhs_64823, eta_p_69411);",
                                    "\n        x_69413 = sle64((int64_t) 0, min_res_69412);\n        y_69414 = slt64(min_res_69412, nR_42219);\n        bounds_check_69415 = x_69413 && y_69414;\n        if (!bounds_check_69415) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 91) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_69412;\n                    global_failure_args[1] = (int64_t) nR_42219;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_69418 = gtid_69408 == zeze_rhs_65256;\n        if (cond_69418) {\n            ri_next_69419 = nR_42219;\n        } else {\n            int64_t tmp_69420;\n            bool x_69421;\n            bool y_69422;\n            bool bounds_check_69423;\n            bool index_certs_69424;\n            int64_t ri_next_f_res_69425;\n            \n            tmp_69420 = add64((int64_t) 1, gtid_69408);\n            x_69421 = sle64((int64_t) 0, tmp_69420);\n            y_69422 = slt64(tmp_69420, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_69423 = x_69421 && y_69422;\n            if (!bounds_check_69423) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 92) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_69420;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_69425 = ((__global int64_t *) mem_75486)[tmp_69420];\n            ri_next_69419 = ri_next_f_res_69425;\n        }\n        max_arg1_69426 = sub64(ri_next_69419, (int64_t) 1);\n        max_res_69427 = smax64((int64_t) 0, max_arg1_69426);\n        x_69428 = sle64((int64_t) 0, max_res_69427);\n        y_69429 = slt64(max_res_69427, nR_42219);\n        bounds_check_69430 = x_69428 && y_69429;\n        if (!bounds_check_", "69430) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 93) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_69427;\n                    global_failure_args[1] = (int64_t) nR_42219;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_69417 = ((__global int32_t *) tR_mem_75467)[min_res_69412];\n        r_max_69432 = ((__global int32_t *) tR_mem_75467)[max_res_69427];\n        loop_while_69435 = 1;\n        fm_69436 = gtid_69408;\n        while (loop_while_69435) {\n            bool x_69437;\n            bool y_69438;\n            bool bounds_check_69439;\n            bool index_certs_69440;\n            int64_t loopres_69441;\n            int64_t min_res_69442;\n            bool x_69443;\n            bool y_69444;\n            bool bounds_check_69445;\n            bool index_certs_69446;\n            bool cond_69449;\n            int64_t si_next_69450;\n            int64_t max_arg1_69457;\n            int64_t max_res_69458;\n            bool x_69459;\n            bool y_69460;\n            bool bounds_check_69461;\n            bool index_certs_69462;\n            int64_t min_res_69465;\n            bool x_69466;\n            bool y_69467;\n            bool bounds_check_69468;\n            bool index_certs_69469;\n            int64_t max_arg1_69472;\n            int64_t max_res_69473;\n            bool x_69474;\n            bool y_69475;\n            bool bounds_check_69476;\n            bool index_certs_69477;\n            int64_t slice_69447;\n            int32_t s_min_69448;\n            int64_t slice_69463;\n            int64_t slice_69470;\n            int64_t slice_69478;\n            bool defunc_0_gt_res_69480;\n            bool loopres_69481;\n            int64_t loopres_69482;\n            bool loop_while_tmp_76745;\n            int64_t fm_tmp_76746;\n            \n            x_69437 = sle64((int64_t) 0, fm_69436);\n            y_69438 = slt64(fm_69436, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberO", "fWindowsz7dUzg_64982);\n            bounds_check_69439 = x_69437 && y_69438;\n            if (!bounds_check_69439) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 94) == -1) {\n                        global_failure_args[0] = (int64_t) fm_69436;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_69441 = ((__global int64_t *) mem_75488)[fm_69436];\n            min_res_69442 = smin64(gt_rhs_64823, loopres_69441);\n            x_69443 = sle64((int64_t) 0, min_res_69442);\n            y_69444 = slt64(min_res_69442, nR_42219);\n            bounds_check_69445 = x_69443 && y_69444;\n            if (!bounds_check_69445) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 95) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_69442;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_69449 = sle64(zeze_rhs_65256, fm_69436);\n            if (cond_69449) {\n                si_next_69450 = nR_42219;\n            } else {\n                int64_t tmp_69451;\n                bool x_69452;\n                bool y_69453;\n                bool bounds_check_69454;\n                bool index_certs_69455;\n                int64_t si_next_f_res_69456;\n                \n                tmp_69451 = add64((int64_t) 1, fm_69436);\n                x_69452 = sle64((int64_t) 0, tmp_69451);\n                y_69453 = slt64(tmp_69451, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_69454 = x_69452 && y_69453;\n                if (!bounds_check_69454) {\n                    {\n                        if (atomic_cmpxchg_i32_g",
                                    "lobal(global_failure, -1, 96) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_69451;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_69456 = ((__global int64_t *) mem_75488)[tmp_69451];\n                si_next_69450 = si_next_f_res_69456;\n            }\n            max_arg1_69457 = sub64(si_next_69450, (int64_t) 1);\n            max_res_69458 = smax64(min_res_69442, max_arg1_69457);\n            x_69459 = sle64((int64_t) 0, max_res_69458);\n            y_69460 = slt64(max_res_69458, nR_42219);\n            bounds_check_69461 = x_69459 && y_69460;\n            if (!bounds_check_69461) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 97) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_69458;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_69465 = smin64(zeze_rhs_65256, si_next_69450);\n            x_69466 = sle64((int64_t) 0, min_res_69465);\n            y_69467 = slt64(min_res_69465, nR_42219);\n            bounds_check_69468 = x_69466 && y_69467;\n            if (!bounds_check_69468) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 98) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_69465;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_69472 = sub64(min_res_69442, (int64_t) 1);\n            max_res_69473 = smax64((int64_t) 0, max_arg1_69472);\n            x_69474 = sle64((int64_t) 0,", " max_res_69473);\n            y_69475 = slt64(max_res_69473, nR_42219);\n            bounds_check_69476 = x_69474 && y_69475;\n            if (!bounds_check_69476) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 99) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_69473;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_69447 = tS_start_64840 + min_res_69442;\n            s_min_69448 = ((__global int32_t *) tS_mem_75468)[slice_69447];\n            slice_69463 = tS_start_64840 + max_res_69458;\n            slice_69470 = tS_start_64840 + min_res_69465;\n            slice_69478 = tS_start_64840 + max_res_69473;\n            defunc_0_gt_res_69480 = slt32(s_min_69448, r_min_69417);\n            if (defunc_0_gt_res_69480) {\n                int32_t s_max_69464;\n                bool defunc_0_leq_res_69483;\n                bool loopres_t_res_69484;\n                int64_t loopres_t_res_69485;\n                \n                s_max_69464 = ((__global int32_t *) tS_mem_75468)[slice_69463];\n                defunc_0_leq_res_69483 = sle32(r_min_69417, s_max_69464);\n                if (defunc_0_leq_res_69483) {\n                    loopres_t_res_69484 = 0;\n                    loopres_t_res_69485 = fm_69436;\n                } else {\n                    int32_t s_nextMin_69471;\n                    bool defunc_0_leq_res_69486;\n                    int64_t zgze_lhs_69487;\n                    bool tmp_f_res_69488;\n                    bool x_69489;\n                    bool y_69490;\n                    bool tmp_69491;\n                    bool loopres_t_res_f_res_69492;\n                    \n                    s_nextMin_69471 = ((__global int32_t *) tS_mem_75468)[slice_69470];\n                    defunc_0_leq_res_69486 = sle32(r_min_69417, s_nextMin_69471);\n                    zgze_lhs_694", "87 = add64((int64_t) 1, fm_69436);\n                    tmp_f_res_69488 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zgze_lhs_69487);\n                    x_69489 = !defunc_0_leq_res_69486;\n                    y_69490 = tmp_f_res_69488 && x_69489;\n                    tmp_69491 = defunc_0_leq_res_69486 || y_69490;\n                    loopres_t_res_f_res_69492 = !tmp_69491;\n                    loopres_t_res_69484 = loopres_t_res_f_res_69492;\n                    loopres_t_res_69485 = zgze_lhs_69487;\n                }\n                loopres_69481 = loopres_t_res_69484;\n                loopres_69482 = loopres_t_res_69485;\n            } else {\n                int32_t s_prevMax_69479;\n                bool defunc_0_leq_res_69493;\n                int64_t zlze_lhs_69494;\n                bool tmp_f_res_69495;\n                bool x_69496;\n                bool y_69497;\n                bool tmp_69498;\n                int64_t max_res_69499;\n                bool loopres_f_res_69500;\n                \n                s_prevMax_69479 = ((__global int32_t *) tS_mem_75468)[slice_69478];\n                defunc_0_leq_res_69493 = sle32(s_prevMax_69479, r_min_69417);\n                zlze_lhs_69494 = sub64(fm_69436, (int64_t) 1);\n                tmp_f_res_69495 = sle64(zlze_lhs_69494, (int64_t) 0);\n                x_69496 = !defunc_0_leq_res_69493;\n                y_69497 = tmp_f_res_69495 && x_69496;\n                tmp_69498 = defunc_0_leq_res_69493 || y_69497;\n                max_res_69499 = smax64((int64_t) 0, zlze_lhs_69494);\n                loopres_f_res_69500 = !tmp_69498;\n                loopres_69481 = loopres_f_res_69500;\n                loopres_69482 = max_res_69499;\n            }\n            loop_while_tmp_76745 = loopres_69481;\n            fm_tmp_76746 = loopres_69482;\n            loop_while_69435 = loop_while_tmp_76745;\n            fm_69436 = fm_tmp_76746;\n        }\n        defunc_0_f_res_69433 = loop_while_69435;\n        defunc_0_f_res_69434 = f",
                                    "m_69436;\n        loop_while_69504 = 1;\n        lm_69505 = gtid_69408;\n        while (loop_while_69504) {\n            bool x_69506;\n            bool y_69507;\n            bool bounds_check_69508;\n            bool index_certs_69509;\n            int64_t loopres_69510;\n            int64_t min_res_69511;\n            bool x_69512;\n            bool y_69513;\n            bool bounds_check_69514;\n            bool index_certs_69515;\n            bool cond_69518;\n            int64_t si_next_69519;\n            int64_t max_arg1_69526;\n            int64_t max_res_69527;\n            bool x_69528;\n            bool y_69529;\n            bool bounds_check_69530;\n            bool index_certs_69531;\n            int64_t min_res_69534;\n            bool x_69535;\n            bool y_69536;\n            bool bounds_check_69537;\n            bool index_certs_69538;\n            int64_t max_arg1_69541;\n            int64_t max_res_69542;\n            bool x_69543;\n            bool y_69544;\n            bool bounds_check_69545;\n            bool index_certs_69546;\n            int64_t slice_69516;\n            int64_t slice_69532;\n            int32_t s_max_69533;\n            int64_t slice_69539;\n            int64_t slice_69547;\n            bool defunc_0_gt_res_69549;\n            bool loopres_69550;\n            int64_t loopres_69551;\n            bool loop_cond_t_res_69566;\n            bool x_69567;\n            bool loop_while_tmp_76747;\n            int64_t lm_tmp_76748;\n            \n            x_69506 = sle64((int64_t) 0, lm_69505);\n            y_69507 = slt64(lm_69505, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_69508 = x_69506 && y_69507;\n            if (!bounds_check_69508) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 100) == -1) {\n                        global_failure_args[0] = (int64_t) lm_69505;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindo", "wsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_69510 = ((__global int64_t *) mem_75488)[lm_69505];\n            min_res_69511 = smin64(gt_rhs_64823, loopres_69510);\n            x_69512 = sle64((int64_t) 0, min_res_69511);\n            y_69513 = slt64(min_res_69511, nR_42219);\n            bounds_check_69514 = x_69512 && y_69513;\n            if (!bounds_check_69514) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 101) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_69511;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_69518 = sle64(zeze_rhs_65256, lm_69505);\n            if (cond_69518) {\n                si_next_69519 = nR_42219;\n            } else {\n                int64_t tmp_69520;\n                bool x_69521;\n                bool y_69522;\n                bool bounds_check_69523;\n                bool index_certs_69524;\n                int64_t si_next_f_res_69525;\n                \n                tmp_69520 = add64((int64_t) 1, lm_69505);\n                x_69521 = sle64((int64_t) 0, tmp_69520);\n                y_69522 = slt64(tmp_69520, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_69523 = x_69521 && y_69522;\n                if (!bounds_check_69523) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 102) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_69520;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_nex", "t_f_res_69525 = ((__global int64_t *) mem_75488)[tmp_69520];\n                si_next_69519 = si_next_f_res_69525;\n            }\n            max_arg1_69526 = sub64(si_next_69519, (int64_t) 1);\n            max_res_69527 = smax64(min_res_69511, max_arg1_69526);\n            x_69528 = sle64((int64_t) 0, max_res_69527);\n            y_69529 = slt64(max_res_69527, nR_42219);\n            bounds_check_69530 = x_69528 && y_69529;\n            if (!bounds_check_69530) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 103) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_69527;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_69534 = smin64(zeze_rhs_65256, si_next_69519);\n            x_69535 = sle64((int64_t) 0, min_res_69534);\n            y_69536 = slt64(min_res_69534, nR_42219);\n            bounds_check_69537 = x_69535 && y_69536;\n            if (!bounds_check_69537) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 104) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_69534;\n                        global_failure_args[1] = (int64_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_69541 = sub64(min_res_69511, (int64_t) 1);\n            max_res_69542 = smax64((int64_t) 0, max_arg1_69541);\n            x_69543 = sle64((int64_t) 0, max_res_69542);\n            y_69544 = slt64(max_res_69542, nR_42219);\n            bounds_check_69545 = x_69543 && y_69544;\n            if (!bounds_check_69545) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 105) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_69542;\n                        global_failure_args[1] = (int6",
                                    "4_t) nR_42219;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_69516 = tS_start_64840 + min_res_69511;\n            slice_69532 = tS_start_64840 + max_res_69527;\n            s_max_69533 = ((__global int32_t *) tS_mem_75468)[slice_69532];\n            slice_69539 = tS_start_64840 + min_res_69534;\n            slice_69547 = tS_start_64840 + max_res_69542;\n            defunc_0_gt_res_69549 = slt32(r_max_69432, s_max_69533);\n            if (defunc_0_gt_res_69549) {\n                int32_t s_min_69517;\n                bool defunc_0_leq_res_69552;\n                bool loopres_t_res_69553;\n                int64_t loopres_t_res_69554;\n                \n                s_min_69517 = ((__global int32_t *) tS_mem_75468)[slice_69516];\n                defunc_0_leq_res_69552 = sle32(s_min_69517, r_max_69432);\n                if (defunc_0_leq_res_69552) {\n                    loopres_t_res_69553 = 0;\n                    loopres_t_res_69554 = lm_69505;\n                } else {\n                    int32_t s_prevMax_69548;\n                    bool defunc_0_leq_res_69555;\n                    int64_t zlze_lhs_69556;\n                    bool tmp_f_res_69557;\n                    bool x_69558;\n                    bool y_69559;\n                    bool tmp_69560;\n                    int64_t max_res_69561;\n                    bool loopres_t_res_f_res_69562;\n                    \n                    s_prevMax_69548 = ((__global int32_t *) tS_mem_75468)[slice_69547];\n                    defunc_0_leq_res_69555 = sle32(s_prevMax_69548, r_max_69432);\n                    zlze_lhs_69556 = sub64(lm_69505, (int64_t) 1);\n                    tmp_f_res_69557 = sle64(zlze_lhs_69556, (int64_t) 0);\n                    x_69558 = !defunc_0_leq_res_69555;\n                    y_69559 = tmp_f_res_69557 && x_69558;\n                    tmp_69560 = defunc_0_leq_res_69555 || y_69559;\n                    max_res_69561 = smax64((int64_t) 0, zlze", "_lhs_69556);\n                    loopres_t_res_f_res_69562 = !tmp_69560;\n                    loopres_t_res_69553 = loopres_t_res_f_res_69562;\n                    loopres_t_res_69554 = max_res_69561;\n                }\n                loopres_69550 = loopres_t_res_69553;\n                loopres_69551 = loopres_t_res_69554;\n            } else {\n                int32_t s_nextMin_69540;\n                bool defunc_0_leq_res_69563;\n                int64_t tmp_69564;\n                bool loopres_f_res_69565;\n                \n                s_nextMin_69540 = ((__global int32_t *) tS_mem_75468)[slice_69539];\n                defunc_0_leq_res_69563 = sle32(r_max_69432, s_nextMin_69540);\n                tmp_69564 = add64((int64_t) 1, lm_69505);\n                loopres_f_res_69565 = !defunc_0_leq_res_69563;\n                loopres_69550 = loopres_f_res_69565;\n                loopres_69551 = tmp_69564;\n            }\n            loop_cond_t_res_69566 = slt64(loopres_69551, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            x_69567 = loopres_69550 && loop_cond_t_res_69566;\n            loop_while_tmp_76747 = x_69567;\n            lm_tmp_76748 = loopres_69551;\n            loop_while_69504 = loop_while_tmp_76747;\n            lm_69505 = lm_tmp_76748;\n        }\n        defunc_0_f_res_69502 = loop_while_69504;\n        defunc_0_f_res_69503 = lm_69505;\n        ((__global int64_t *) mem_75522)[gtid_69408] = defunc_0_f_res_69434;\n        ((__global int64_t *) mem_75524)[gtid_69408] = defunc_0_f_res_69503;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69404\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69761_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69761(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75703, int64_t ext_75704, __global unsigned char *mem_param_75540, __global unsigned char *ext_mem_75707, __global unsigned char *mem_75711)\n{\n    #define segmap_tblock_sizze_69757 (inner_SMJ_intziseg", "map_69761zisegmap_tblock_sizze_69757)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76860;\n    int32_t tblock_sizze_76863;\n    int32_t wave_sizze_76862;\n    int32_t block_id_76861;\n    int32_t global_tid_76859;\n    int64_t phys_tid_69761;\n    int64_t global_tid_76864;\n    int64_t slice_76865;\n    int64_t gtid_69760;\n    int64_t remnant_76866;\n    \n    local_tid_76860 = get_local_id(0);\n    tblock_sizze_76863 = get_local_size(0);\n    wave_sizze_76862 = LOCKSTEP_WIDTH;\n    block_id_76861 = get_tblock_id(0);\n    global_tid_76859 = block_id_76861 * tblock_sizze_76863 + local_tid_76860;\n    phys_tid_69761 = sext_i32_i64(global_tid_76859);\n    global_tid_76864 = sext_i32_i64(block_id_76861) * segmap_tblock_sizze_69757 + sext_i32_i64(local_tid_76860);\n    slice_76865 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_69760 = global_tid_76864;\n    remnant_76866 = global_tid_76864 - gtid_69760;\n    if (slt64(gtid_69760, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_69762;\n        bool cond_69764;\n        int64_t lifted_lambda_res_69765;\n        \n        eta_p_69762 = ((__global int64_t *) mem_param_75540)[gtid_69760];\n        cond_69764 = slt64(eta_p_69762, (int64_t) 0);\n        if (cond_69764) {\n            int64_t eta_p_69763 = ((__global int64_t *) ext_mem_75707)[ext_75704 + gtid_69760 * ext_75703];\n            \n            lifted_lambda_res_69765 = eta_p_69763;\n        } else {\n            lifted_lambda_res_69765 = eta_p_69762;\n        }\n        ((__global int64_t *) mem_75711)[gtid_69760] = lifted_lambda_res_69765;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69757\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69782_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69782(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75705, int64_t ext_75706, __global unsigned char *mem_param_75537, __global unsigned char *ext_mem_75708, __global unsigned char *mem_75714",
                                    ")\n{\n    #define segmap_tblock_sizze_69778 (inner_SMJ_intzisegmap_69782zisegmap_tblock_sizze_69778)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76869;\n    int32_t tblock_sizze_76872;\n    int32_t wave_sizze_76871;\n    int32_t block_id_76870;\n    int32_t global_tid_76868;\n    int64_t phys_tid_69782;\n    int64_t global_tid_76873;\n    int64_t slice_76874;\n    int64_t gtid_69781;\n    int64_t remnant_76875;\n    \n    local_tid_76869 = get_local_id(0);\n    tblock_sizze_76872 = get_local_size(0);\n    wave_sizze_76871 = LOCKSTEP_WIDTH;\n    block_id_76870 = get_tblock_id(0);\n    global_tid_76868 = block_id_76870 * tblock_sizze_76872 + local_tid_76869;\n    phys_tid_69782 = sext_i32_i64(global_tid_76868);\n    global_tid_76873 = sext_i32_i64(block_id_76870) * segmap_tblock_sizze_69778 + sext_i32_i64(local_tid_76869);\n    slice_76874 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_69781 = global_tid_76873;\n    remnant_76875 = global_tid_76873 - gtid_69781;\n    if (slt64(gtid_69781, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_69783;\n        int64_t eta_p_69784;\n        int64_t defunc_0_f_res_69785;\n        \n        eta_p_69783 = ((__global int64_t *) mem_param_75537)[gtid_69781];\n        eta_p_69784 = ((__global int64_t *) ext_mem_75708)[ext_75706 + gtid_69781 * ext_75705];\n        defunc_0_f_res_69785 = add64(eta_p_69783, eta_p_69784);\n        ((__global int64_t *) mem_75714)[gtid_69781] = defunc_0_f_res_69785;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69778\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69803_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69803(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75528, int64_t ctx_param_ext_75529, __global unsigned char *mem_param_75530, __global unsigned char *ext_mem_75719, __global unsigned char *mem_75723)\n{\n    #define segmap_tblock_sizze_69799 (inner_SMJ_int", "zisegmap_69803zisegmap_tblock_sizze_69799)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76878;\n    int32_t tblock_sizze_76881;\n    int32_t wave_sizze_76880;\n    int32_t block_id_76879;\n    int32_t global_tid_76877;\n    int64_t phys_tid_69803;\n    int64_t global_tid_76882;\n    int64_t slice_76883;\n    int64_t gtid_69802;\n    int64_t remnant_76884;\n    \n    local_tid_76878 = get_local_id(0);\n    tblock_sizze_76881 = get_local_size(0);\n    wave_sizze_76880 = LOCKSTEP_WIDTH;\n    block_id_76879 = get_tblock_id(0);\n    global_tid_76877 = block_id_76879 * tblock_sizze_76881 + local_tid_76878;\n    phys_tid_69803 = sext_i32_i64(global_tid_76877);\n    global_tid_76882 = sext_i32_i64(block_id_76879) * segmap_tblock_sizze_69799 + sext_i32_i64(local_tid_76878);\n    slice_76883 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_69802 = global_tid_76882;\n    remnant_76884 = global_tid_76882 - gtid_69802;\n    if (slt64(gtid_69802, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73891;\n        int64_t eta_p_69804;\n        bool cond_69806;\n        int64_t lifted_lambda_res_69807;\n        \n        slice_73891 = loopres_f_res_f_res_65435 + gtid_69802;\n        eta_p_69804 = ((__global int64_t *) mem_param_75530)[ctx_param_ext_75528 + slice_73891 * ctx_param_ext_75529];\n        cond_69806 = slt64(eta_p_69804, (int64_t) 0);\n        if (cond_69806) {\n            int64_t eta_p_69805 = ((__global int64_t *) ext_mem_75719)[gtid_69802];\n            \n            lifted_lambda_res_69807 = eta_p_69805;\n        } else {\n            lifted_lambda_res_69807 = eta_p_69804;\n        }\n        ((__global int64_t *) mem_75723)[gtid_69802] = lifted_lambda_res_69807;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69799\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69824_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69824(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450,", " int64_t ctx_param_ext_75525, int64_t ctx_param_ext_75526, __global unsigned char *mem_param_75527, __global unsigned char *ext_mem_75720, __global unsigned char *mem_75726)\n{\n    #define segmap_tblock_sizze_69820 (inner_SMJ_intzisegmap_69824zisegmap_tblock_sizze_69820)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76887;\n    int32_t tblock_sizze_76890;\n    int32_t wave_sizze_76889;\n    int32_t block_id_76888;\n    int32_t global_tid_76886;\n    int64_t phys_tid_69824;\n    int64_t global_tid_76891;\n    int64_t slice_76892;\n    int64_t gtid_69823;\n    int64_t remnant_76893;\n    \n    local_tid_76887 = get_local_id(0);\n    tblock_sizze_76890 = get_local_size(0);\n    wave_sizze_76889 = LOCKSTEP_WIDTH;\n    block_id_76888 = get_tblock_id(0);\n    global_tid_76886 = block_id_76888 * tblock_sizze_76890 + local_tid_76887;\n    phys_tid_69824 = sext_i32_i64(global_tid_76886);\n    global_tid_76891 = sext_i32_i64(block_id_76888) * segmap_tblock_sizze_69820 + sext_i32_i64(local_tid_76887);\n    slice_76892 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_69823 = global_tid_76891;\n    remnant_76893 = global_tid_76891 - gtid_69823;\n    if (slt64(gtid_69823, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73890;\n        int64_t eta_p_69825;\n        int64_t eta_p_69826;\n        int64_t defunc_0_f_res_69827;\n        \n        slice_73890 = loopres_f_res_f_res_65435 + gtid_69823;\n        eta_p_69825 = ((__global int64_t *) mem_param_75527)[ctx_param_ext_75525 + slice_73890 * ctx_param_ext_75526];\n        eta_p_69826 = ((__global int64_t *) ext_mem_75720)[gtid_69823];\n        defunc_0_f_res_69827 = add64(eta_p_69825, eta_p_69826);\n        ((__global int64_t *) mem_75726)[gtid_69823] = defunc_0_f_res_69827;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69820\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69845_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69845(__global int *global_failure, int64_t nR_42219, int64_t ext_759",
                                    "14, int64_t ext_75915, __global unsigned char *mem_param_75482, __global unsigned char *ext_mem_75916, __global unsigned char *mem_75922)\n{\n    #define segmap_tblock_sizze_69841 (inner_SMJ_intzisegmap_69845zisegmap_tblock_sizze_69841)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76896;\n    int32_t tblock_sizze_76899;\n    int32_t wave_sizze_76898;\n    int32_t block_id_76897;\n    int32_t global_tid_76895;\n    int64_t phys_tid_69845;\n    int64_t global_tid_76900;\n    int64_t slice_76901;\n    int64_t gtid_69844;\n    int64_t remnant_76902;\n    \n    local_tid_76896 = get_local_id(0);\n    tblock_sizze_76899 = get_local_size(0);\n    wave_sizze_76898 = LOCKSTEP_WIDTH;\n    block_id_76897 = get_tblock_id(0);\n    global_tid_76895 = block_id_76897 * tblock_sizze_76899 + local_tid_76896;\n    phys_tid_69845 = sext_i32_i64(global_tid_76895);\n    global_tid_76900 = sext_i32_i64(block_id_76897) * segmap_tblock_sizze_69841 + sext_i32_i64(local_tid_76896);\n    slice_76901 = nR_42219;\n    gtid_69844 = global_tid_76900;\n    remnant_76902 = global_tid_76900 - gtid_69844;\n    if (slt64(gtid_69844, nR_42219)) {\n        int64_t eta_p_69846;\n        bool cond_69848;\n        int64_t lifted_lambda_res_69849;\n        \n        eta_p_69846 = ((__global int64_t *) mem_param_75482)[gtid_69844];\n        cond_69848 = slt64(eta_p_69846, (int64_t) 0);\n        if (cond_69848) {\n            int64_t eta_p_69847 = ((__global int64_t *) ext_mem_75916)[ext_75915 + gtid_69844 * ext_75914];\n            \n            lifted_lambda_res_69849 = eta_p_69847;\n        } else {\n            lifted_lambda_res_69849 = eta_p_69846;\n        }\n        ((__global int64_t *) mem_75922)[gtid_69844] = lifted_lambda_res_69849;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69841\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69866_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69866(__global int *global_failure, int64_t nR_42219, int64_t ext_75917, int64_t ext_75918, __global unsigned char *mem", "_param_75479, __global unsigned char *ext_mem_75919, __global unsigned char *mem_75925)\n{\n    #define segmap_tblock_sizze_69862 (inner_SMJ_intzisegmap_69866zisegmap_tblock_sizze_69862)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76905;\n    int32_t tblock_sizze_76908;\n    int32_t wave_sizze_76907;\n    int32_t block_id_76906;\n    int32_t global_tid_76904;\n    int64_t phys_tid_69866;\n    int64_t global_tid_76909;\n    int64_t slice_76910;\n    int64_t gtid_69865;\n    int64_t remnant_76911;\n    \n    local_tid_76905 = get_local_id(0);\n    tblock_sizze_76908 = get_local_size(0);\n    wave_sizze_76907 = LOCKSTEP_WIDTH;\n    block_id_76906 = get_tblock_id(0);\n    global_tid_76904 = block_id_76906 * tblock_sizze_76908 + local_tid_76905;\n    phys_tid_69866 = sext_i32_i64(global_tid_76904);\n    global_tid_76909 = sext_i32_i64(block_id_76906) * segmap_tblock_sizze_69862 + sext_i32_i64(local_tid_76905);\n    slice_76910 = nR_42219;\n    gtid_69865 = global_tid_76909;\n    remnant_76911 = global_tid_76909 - gtid_69865;\n    if (slt64(gtid_69865, nR_42219)) {\n        int64_t eta_p_69867;\n        int64_t eta_p_69868;\n        int64_t defunc_0_f_res_69869;\n        \n        eta_p_69867 = ((__global int64_t *) mem_param_75479)[gtid_69865];\n        eta_p_69868 = ((__global int64_t *) ext_mem_75919)[ext_75918 + gtid_69865 * ext_75917];\n        defunc_0_f_res_69869 = add64(eta_p_69867, eta_p_69868);\n        ((__global int64_t *) mem_75925)[gtid_69865] = defunc_0_f_res_69869;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69862\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69879_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69879(__global int *global_failure, int64_t nR_42219, int64_t m_65686, int64_t num_tblocks_69884, int32_t virt_num_tblocks_77042, __global unsigned char *tR_mem_75467, __global unsigned char *ext_mem_75469, __global unsigned char *ext_mem_75937, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned cha", "r *mem_75943, __global unsigned char *mem_75945, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951)\n{\n    #define segmap_tblock_sizze_69882 (inner_SMJ_intzisegmap_69879zisegmap_tblock_sizze_69882)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77044;\n    int32_t tblock_sizze_77047;\n    int32_t wave_sizze_77046;\n    int32_t block_id_77045;\n    int32_t global_tid_77043;\n    int64_t phys_tid_69879;\n    int32_t phys_tblock_id_77048;\n    int32_t iterations_77049;\n    \n    local_tid_77044 = get_local_id(0);\n    tblock_sizze_77047 = get_local_size(0);\n    wave_sizze_77046 = LOCKSTEP_WIDTH;\n    block_id_77045 = get_tblock_id(0);\n    global_tid_77043 = block_id_77045 * tblock_sizze_77047 + local_tid_77044;\n    phys_tid_69879 = sext_i32_i64(global_tid_77043);\n    phys_tblock_id_77048 = get_tblock_id(0);\n    iterations_77049 = sdiv_up32(virt_num_tblocks_77042 - phys_tblock_id_77048, sext_i64_i32(num_tblocks_69884));\n    for (int32_t i_77050 = 0; i_77050 < iterations_77049; i_77050++) {\n        int32_t virt_tblock_id_77051;\n        int64_t global_tid_77052;\n        int64_t slice_77053;\n        int64_t write_i_69878;\n        int64_t remnant_77054;\n        \n        virt_tblock_id_77051 = phys_tblock_id_77048 + i_77050 * sext_i64_i32(num_tblocks_69884);\n        global_tid_77052 = sext_i32_i64(virt_tblock_id_77051) * segmap_tblock_sizze_69882 + sext_i32_i64(local_tid_77044);\n        slice_77053 = nR_42219;\n        write_i_69878 = global_tid_77052;\n        remnant_77054 = global_tid_77052 - write_i_69878;\n        if (slt64(write_i_69878, nR_42219)) {\n            int64_t eta_p_65951;\n            int32_t write_value_65953;\n            int64_t write_value_65954;\n            int64_t write_value_65955;\n            int64_t write_value_65956;\n            bool cond_65957;\n            int64_t lifted_lambda_res_65958;\n            \n            eta_p_65951 = ((__global int64_t *) mem_75943)[write_i_69878];\n         ",
                                    "   write_value_65953 = ((__global int32_t *) tR_mem_75467)[write_i_69878];\n            write_value_65954 = ((__global int64_t *) ext_mem_75469)[write_i_69878];\n            write_value_65955 = ((__global int64_t *) ext_mem_75937)[write_i_69878];\n            write_value_65956 = ((__global int64_t *) ext_mem_75938)[write_i_69878];\n            cond_65957 = eta_p_65951 == (int64_t) 1;\n            if (cond_65957) {\n                int64_t eta_p_65952;\n                int64_t lifted_lambda_res_t_res_66732;\n                \n                eta_p_65952 = ((__global int64_t *) mem_75941)[write_i_69878];\n                lifted_lambda_res_t_res_66732 = sub64(eta_p_65952, (int64_t) 1);\n                lifted_lambda_res_65958 = lifted_lambda_res_t_res_66732;\n            } else {\n                lifted_lambda_res_65958 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int32_t *) mem_75951)[lifted_lambda_res_65958] = write_value_65953;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75949)[lifted_lambda_res_65958] = write_value_65954;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75947)[lifted_lambda_res_65958] = write_value_65955;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75945)[lifted_lambda_res_65958] = write_value_65956;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_69882\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69913_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69913(__global int *global_failure, int64_t m_65686, __global ", "unsigned char *mem_75955, __global unsigned char *mem_75962)\n{\n    #define segmap_tblock_sizze_69909 (inner_SMJ_intzisegmap_69913zisegmap_tblock_sizze_69909)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77210;\n    int32_t tblock_sizze_77213;\n    int32_t wave_sizze_77212;\n    int32_t block_id_77211;\n    int32_t global_tid_77209;\n    int64_t phys_tid_69913;\n    int64_t global_tid_77214;\n    int64_t slice_77215;\n    int64_t gtid_69912;\n    int64_t remnant_77216;\n    \n    local_tid_77210 = get_local_id(0);\n    tblock_sizze_77213 = get_local_size(0);\n    wave_sizze_77212 = LOCKSTEP_WIDTH;\n    block_id_77211 = get_tblock_id(0);\n    global_tid_77209 = block_id_77211 * tblock_sizze_77213 + local_tid_77210;\n    phys_tid_69913 = sext_i32_i64(global_tid_77209);\n    global_tid_77214 = sext_i32_i64(block_id_77211) * segmap_tblock_sizze_69909 + sext_i32_i64(local_tid_77210);\n    slice_77215 = m_65686;\n    gtid_69912 = global_tid_77214;\n    remnant_77216 = global_tid_77214 - gtid_69912;\n    if (slt64(gtid_69912, m_65686)) {\n        int64_t zv_lhs_69915;\n        int64_t tmp_69916;\n        bool cond_69918;\n        int64_t lifted_lambda_res_69919;\n        \n        zv_lhs_69915 = add64((int64_t) -1, gtid_69912);\n        tmp_69916 = smod64(zv_lhs_69915, m_65686);\n        cond_69918 = gtid_69912 == (int64_t) 0;\n        if (cond_69918) {\n            lifted_lambda_res_69919 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_69917 = ((__global int64_t *) mem_75955)[tmp_69916];\n            \n            lifted_lambda_res_69919 = lifted_lambda_res_69917;\n        }\n        ((__global int64_t *) mem_75962)[gtid_69912] = lifted_lambda_res_69919;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69909\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69921_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69921(__global int *global_failure, int64_t m_65686, int64_t lower_bound_65769, int64_t min_res_65771, int64_t j_m_i_65772, int64_t num_tblocks_6992", "6, int32_t virt_num_tblocks_77255, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951, __global unsigned char *mem_75962, __global unsigned char *mem_75991, __global unsigned char *mem_75993, __global unsigned char *mem_75995)\n{\n    #define segmap_tblock_sizze_69924 (inner_SMJ_intzisegmap_69921zisegmap_tblock_sizze_69924)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77257;\n    int32_t tblock_sizze_77260;\n    int32_t wave_sizze_77259;\n    int32_t block_id_77258;\n    int32_t global_tid_77256;\n    int64_t phys_tid_69921;\n    int32_t phys_tblock_id_77261;\n    int32_t iterations_77262;\n    \n    local_tid_77257 = get_local_id(0);\n    tblock_sizze_77260 = get_local_size(0);\n    wave_sizze_77259 = LOCKSTEP_WIDTH;\n    block_id_77258 = get_tblock_id(0);\n    global_tid_77256 = block_id_77258 * tblock_sizze_77260 + local_tid_77257;\n    phys_tid_69921 = sext_i32_i64(global_tid_77256);\n    phys_tblock_id_77261 = get_tblock_id(0);\n    iterations_77262 = sdiv_up32(virt_num_tblocks_77255 - phys_tblock_id_77261, sext_i64_i32(num_tblocks_69926));\n    for (int32_t i_77263 = 0; i_77263 < iterations_77262; i_77263++) {\n        int32_t virt_tblock_id_77264;\n        int64_t global_tid_77265;\n        int64_t slice_77266;\n        int64_t write_i_69920;\n        int64_t remnant_77267;\n        \n        virt_tblock_id_77264 = phys_tblock_id_77261 + i_77263 * sext_i64_i32(num_tblocks_69926);\n        global_tid_77265 = sext_i32_i64(virt_tblock_id_77264) * segmap_tblock_sizze_69924 + sext_i32_i64(local_tid_77257);\n        slice_77266 = m_65686;\n        write_i_69920 = global_tid_77265;\n        remnant_77267 = global_tid_77265 - write_i_69920;\n        if (slt64(write_i_69920, m_65686)) {\n            int64_t eta_p_66344;\n            int32_t write_value_66345;\n            int64_t write_value_66346;\n            int64_t write_value_66347;\n            bool cond_66348;\n            bool cond_t_res_66349;\n            bool x_663",
                                    "50;\n            int64_t lifted_lambda_res_66351;\n            \n            eta_p_66344 = ((__global int64_t *) mem_75962)[write_i_69920];\n            write_value_66345 = ((__global int32_t *) mem_75951)[write_i_69920];\n            write_value_66346 = ((__global int64_t *) mem_75949)[write_i_69920];\n            write_value_66347 = ((__global int64_t *) mem_75947)[write_i_69920];\n            cond_66348 = sle64(lower_bound_65769, eta_p_66344);\n            cond_t_res_66349 = slt64(eta_p_66344, min_res_65771);\n            x_66350 = cond_66348 && cond_t_res_66349;\n            if (x_66350) {\n                int64_t lifted_lambda_res_t_res_66735 = sub64(eta_p_66344, lower_bound_65769);\n                \n                lifted_lambda_res_66351 = lifted_lambda_res_t_res_66735;\n            } else {\n                lifted_lambda_res_66351 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int32_t *) mem_75991)[lifted_lambda_res_66351] = write_value_66345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75993)[lifted_lambda_res_66351] = write_value_66346;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75995)[lifted_lambda_res_66351] = write_value_66347;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_69924\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69929_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69929(__global int *global_failure, int64_t m_65686, int64_t m_65826, int64_t num_tblocks_69934, int32_t virt_num_tblocks_77237, __global unsigned char *mem_75945, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global u", "nsigned char *mem_75962, __global unsigned char *mem_75970, __global unsigned char *mem_75972)\n{\n    #define segmap_tblock_sizze_69932 (inner_SMJ_intzisegmap_69929zisegmap_tblock_sizze_69932)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77239;\n    int32_t tblock_sizze_77242;\n    int32_t wave_sizze_77241;\n    int32_t block_id_77240;\n    int32_t global_tid_77238;\n    int64_t phys_tid_69929;\n    int32_t phys_tblock_id_77243;\n    int32_t iterations_77244;\n    \n    local_tid_77239 = get_local_id(0);\n    tblock_sizze_77242 = get_local_size(0);\n    wave_sizze_77241 = LOCKSTEP_WIDTH;\n    block_id_77240 = get_tblock_id(0);\n    global_tid_77238 = block_id_77240 * tblock_sizze_77242 + local_tid_77239;\n    phys_tid_69929 = sext_i32_i64(global_tid_77238);\n    phys_tblock_id_77243 = get_tblock_id(0);\n    iterations_77244 = sdiv_up32(virt_num_tblocks_77237 - phys_tblock_id_77243, sext_i64_i32(num_tblocks_69934));\n    for (int32_t i_77245 = 0; i_77245 < iterations_77244; i_77245++) {\n        int32_t virt_tblock_id_77246;\n        int64_t global_tid_77247;\n        int64_t slice_77248;\n        int64_t write_i_69928;\n        int64_t remnant_77249;\n        \n        virt_tblock_id_77246 = phys_tblock_id_77243 + i_77245 * sext_i64_i32(num_tblocks_69934);\n        global_tid_77247 = sext_i32_i64(virt_tblock_id_77246) * segmap_tblock_sizze_69932 + sext_i32_i64(local_tid_77239);\n        slice_77248 = m_65686;\n        write_i_69928 = global_tid_77247;\n        remnant_77249 = global_tid_77247 - write_i_69928;\n        if (slt64(write_i_69928, m_65686)) {\n            int64_t eta_p_65928;\n            int64_t write_value_65930;\n            int64_t write_value_65931;\n            bool cond_65932;\n            int64_t lifted_lambda_res_65933;\n            \n            eta_p_65928 = ((__global int64_t *) mem_75959)[write_i_69928];\n            write_value_65930 = ((__global int64_t *) mem_75962)[write_i_69928];\n            write_value_65931 = ((__global int64_t *) mem_75945)[wr", "ite_i_69928];\n            cond_65932 = eta_p_65928 == (int64_t) 1;\n            if (cond_65932) {\n                int64_t eta_p_65929;\n                int64_t lifted_lambda_res_t_res_66740;\n                \n                eta_p_65929 = ((__global int64_t *) mem_75957)[write_i_69928];\n                lifted_lambda_res_t_res_66740 = sub64(eta_p_65929, (int64_t) 1);\n                lifted_lambda_res_65933 = lifted_lambda_res_t_res_66740;\n            } else {\n                lifted_lambda_res_65933 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75972)[lifted_lambda_res_65933] = write_value_65930;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75970)[lifted_lambda_res_65933] = write_value_65931;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_69932\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_69951_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_69951(__global int *global_failure, int64_t loopres_65870, int64_t loopres_65871, __global unsigned char *mem_76020, __global unsigned char *mem_76023)\n{\n    #define segmap_tblock_sizze_69947 (inner_SMJ_intzisegmap_69951zisegmap_tblock_sizze_69947)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77324;\n    int32_t tblock_sizze_77327;\n    int32_t wave_sizze_77326;\n    int32_t block_id_77325;\n    int32_t global_tid_77323;\n    int64_t phys_tid_69951;\n    int64_t global_tid_77328;\n    int64_t slice_77329;\n    int64_t gtid_69950;\n    int64_t remnant_77330;\n    \n    local_tid_77324 = get_local_id(0);\n    tblock_sizze_77327 = get_local_size(0);\n    wave_sizze_77326 = LOCKSTEP_WIDTH;\n    block_id_77325 = get_tblock_id(0);\n    global_tid_77323 = block_id_77325 * tblock_sizze_77327 ",
                                    "+ local_tid_77324;\n    phys_tid_69951 = sext_i32_i64(global_tid_77323);\n    global_tid_77328 = sext_i32_i64(block_id_77325) * segmap_tblock_sizze_69947 + sext_i32_i64(local_tid_77324);\n    slice_77329 = loopres_65871;\n    gtid_69950 = global_tid_77328;\n    remnant_77330 = global_tid_77328 - gtid_69950;\n    if (slt64(gtid_69950, loopres_65871)) {\n        int64_t loopres_75462;\n        int64_t tmp_69953;\n        \n        loopres_75462 = ((__global int64_t *) mem_76023)[(int64_t) 0];\n        tmp_69953 = add64(gtid_69950, loopres_75462);\n        ((__global int64_t *) mem_76020)[loopres_65870 + gtid_69950] = tmp_69953;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69947\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_73899_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_73899(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_73902, int64_t num_whole_tiles_73917, int64_t residual_input_74141, unsigned char cond_74142_bits, int64_t binop_x_74158, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75887, __global unsigned char *mem_75889)\n{\n    bool cond_74142 = cond_74142_bits;\n    \n    #define tile_sizze_73901 (inner_SMJ_intzisegmap_intrablock_73899zitile_sizze_73901)\n    #define bytes_75849 (inner_SMJ_intzisegmap_intrablock_73899zibytes_75849)\n    #define bytes_75851 (inner_SMJ_intzisegmap_intrablock_73899zibytes_75851)\n    \n    volatile __local unsigned char *color_76532_backing_2 = &shared_mem[0];\n    const int64_t color_76532_backing_2_offset = 0 + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76531_backing_1 = &shared_mem[color_76532_backing_2_offset];\n    const int64_t color_76531_backing_1_offset = color_76532_backing_2_offset + (bytes_75851 + srem64(", "(int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76530_backing_0 = &shared_mem[color_76531_backing_1_offset];\n    const int64_t color_76530_backing_0_offset = color_76531_backing_1_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76641;\n    int32_t tblock_sizze_76644;\n    int32_t wave_sizze_76643;\n    int32_t block_id_76642;\n    int32_t global_tid_76640;\n    int64_t gid_flat_73899;\n    int64_t slice_76646;\n    int64_t ltid_pre_76645;\n    int64_t remnant_76647;\n    int64_t slice_76648;\n    int64_t gid_73898;\n    int64_t remnant_76649;\n    __local unsigned char *color_76530;\n    __local unsigned char *color_76531;\n    __local unsigned char *color_76532;\n    int64_t binop_x_73909;\n    int32_t mem_75833[1];\n    int64_t ltid_flat_73904;\n    int64_t ltid_73903;\n    int64_t gtid_73910;\n    bool cond_73911;\n    int32_t pre_73912;\n    int64_t mem_75837[1];\n    int32_t mem_75841[1];\n    int64_t mem_75845[1];\n    int64_t ltid_flat_73919;\n    int64_t ltid_73918;\n    int64_t gtid_73929;\n    bool cond_73930;\n    int64_t neutral_73931;\n    int32_t neutral_73932;\n    int64_t ext_mem_75869[1];\n    int32_t ext_mem_75868[1];\n    int64_t ext_mem_75867[1];\n    int64_t mem_param_75846[1];\n    int32_t mem_param_75847[1];\n    int64_t mem_param_75848[1];\n    int64_t mem_75879[1];\n    int64_t mem_75883[1];\n    int64_t ext_mem_75885[1];\n    int64_t ext_mem_75884[1];\n    \n    local_tid_76641 = get_local_id(0);\n    tblock_sizze_76644 = get_local_size(0);\n    wave_sizze_76643 = LOCKSTEP_WIDTH;\n    block_id_76642 = get_tblock_id(0);\n    global_tid_76640 = block_id_76642 * tblock_sizze_76644 + local_tid_76641;\n    gid_flat_73899 = sext_i32_i64(block_id_76642);\n    slice_76646 = tile_sizze_73901;\n    ltid_pre_76645 = sext_i32_i64(local_tid_76641);\n    remnant_76647 = sext_i32_i64(local_tid_76641) - ltid_pre_76645;\n    slic", "e_76648 = ldim_73902;\n    gid_73898 = sext_i32_i64(block_id_76642);\n    remnant_76649 = sext_i32_i64(block_id_76642) - gid_73898;\n    color_76530 = (__local unsigned char *) color_76530_backing_0;\n    color_76531 = (__local unsigned char *) color_76531_backing_1;\n    color_76532 = (__local unsigned char *) color_76532_backing_2;\n    binop_x_73909 = gid_73898 * tile_sizze_73901;\n    ltid_flat_73904 = sext_i32_i64(local_tid_76641);\n    ltid_73903 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73910 = ltid_73903 + binop_x_73909;\n    cond_73911 = slt64(gtid_73910, min_res_66402);\n    if (cond_73911) {\n        int64_t slice_73913;\n        int32_t eta_p_73914;\n        \n        slice_73913 = start_66400 + gtid_73910;\n        eta_p_73914 = ((__global int32_t *) tR_mem_75467)[slice_73913];\n        pre_73912 = eta_p_73914;\n    } else {\n        pre_73912 = 0;\n    }\n    mem_75833[(int64_t) 0] = pre_73912;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_73919 = sext_i32_i64(local_tid_76641);\n    ltid_73918 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73929 = binop_x_73909 + ltid_73918;\n    cond_73930 = slt64(gtid_73929, min_res_66402);\n    if (cond_73930) {\n        neutral_73931 = (int64_t) -1;\n    } else {\n        neutral_73931 = (int64_t) 0;\n    }\n    if (cond_73930) {\n        int32_t eta_p_73934 = mem_75833[(int64_t) 0];\n        \n        neutral_73932 = eta_p_73934;\n    } else {\n        neutral_73932 = 0;\n    }\n    mem_75837[(int64_t) 0] = neutral_73931;\n    mem_75841[(int64_t) 0] = neutral_73932;\n    mem_75845[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75846[i_3] = mem_75837[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75847[i_4] = mem_75841[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75848[i_5] = mem_75845[i_5];\n    for (int64_t tile_id_73944 = 0; tile_id_73944 < num_whole_tiles_73917; tile_id_73944++) ",
                                    "{\n        int64_t binop_x_74043;\n        int64_t ltid_flat_74042;\n        int64_t ltid_74041;\n        int64_t j_74044;\n        bool cond_74048;\n        int64_t pre1d_74051;\n        int64_t pre1d_74049;\n        int32_t pre1d_74050;\n        int64_t mem_75858[1];\n        int32_t mem_75862[1];\n        int64_t mem_75866[1];\n        int64_t ltid_flat_74062;\n        int64_t ltid_74061;\n        int64_t gtid_74064;\n        int64_t acc_74066;\n        int32_t acc_74067;\n        int64_t acc_74068;\n        bool cond_74069;\n        int64_t acc_74070;\n        int32_t acc_74071;\n        int64_t acc_74072;\n        int64_t mem_param_tmp_76650[1];\n        int32_t mem_param_tmp_76651[1];\n        int64_t mem_param_tmp_76652[1];\n        \n        binop_x_74043 = tile_sizze_73901 * tile_id_73944;\n        ltid_flat_74042 = sext_i32_i64(local_tid_76641);\n        ltid_74041 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74044 = ltid_74041 + binop_x_74043;\n        cond_74048 = slt64(j_74044, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74051 = btoi_bool_i64(cond_74048);\n        if (cond_74048) {\n            int64_t tile_elem_74052;\n            int64_t slice_75321;\n            int32_t tile_elem_74053;\n            \n            tile_elem_74052 = ((__global int64_t *) ext_mem_75767)[j_74044];\n            slice_75321 = tS_start_64840 + j_74044;\n            tile_elem_74053 = ((__global int32_t *) tS_mem_75468)[slice_75321];\n            pre1d_74049 = tile_elem_74052;\n            pre1d_74050 = tile_elem_74053;\n        } else {\n            pre1d_74049 = (int64_t) 0;\n            pre1d_74050 = 0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74041] = pre1d_74049;\n        ((__local int32_t *) color_76531)[ltid_74041] = pre1d_74050;\n        ((__local int64_t *) color_76530)[ltid_74041] = pre1d_74051;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74062 = sext_i32_i64(local_tid_76641);\n        ltid_74061 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gt", "id_74064 = binop_x_73909 + ltid_74061;\n        acc_74066 = mem_param_75846[(int64_t) 0];\n        acc_74067 = mem_param_75847[(int64_t) 0];\n        acc_74068 = mem_param_75848[(int64_t) 0];\n        cond_74069 = slt64(gtid_74064, min_res_66402);\n        if (cond_74069) {\n            int32_t eta_p_74065;\n            int64_t x_74073;\n            int32_t x_74074;\n            int64_t x_74075;\n            int64_t redout_75334;\n            int32_t redout_75335;\n            int64_t redout_75336;\n            \n            eta_p_74065 = mem_75833[(int64_t) 0];\n            redout_75334 = acc_74066;\n            redout_75335 = acc_74067;\n            redout_75336 = acc_74068;\n            for (int64_t i_75337 = 0; i_75337 < tile_sizze_73901; i_75337++) {\n                int64_t x_74076;\n                int32_t x_74077;\n                bool defunc_0_neq_res_74085;\n                bool defunc_0_neq_res_74086;\n                bool cond_f_res_74087;\n                bool y_74088;\n                bool cond_74089;\n                bool defunc_0_neq_res_74090;\n                bool defunc_0_neq_res_74091;\n                bool cond_t_res_f_res_74092;\n                bool y_74093;\n                bool cond_t_res_74094;\n                bool x_74095;\n                int64_t defunc_0_op_res_74096;\n                int32_t defunc_0_op_res_74097;\n                int64_t defunc_0_op_res_74098;\n                int64_t redout_tmp_76656;\n                int32_t redout_tmp_76657;\n                int64_t redout_tmp_76658;\n                \n                x_74076 = ((__local int64_t *) color_76532)[i_75337];\n                x_74077 = ((__local int32_t *) color_76531)[i_75337];\n                defunc_0_neq_res_74085 = redout_75335 == eta_p_74065;\n                defunc_0_neq_res_74086 = !defunc_0_neq_res_74085;\n                cond_f_res_74087 = slt64(redout_75334, (int64_t) 0);\n                y_74088 = defunc_0_neq_res_74085 && cond_f_res_74087;\n                cond_74089 = defunc_0_neq_res_74086 || y_7408", "8;\n                defunc_0_neq_res_74090 = x_74077 == eta_p_74065;\n                defunc_0_neq_res_74091 = !defunc_0_neq_res_74090;\n                cond_t_res_f_res_74092 = slt64(x_74076, (int64_t) 0);\n                y_74093 = defunc_0_neq_res_74090 && cond_t_res_f_res_74092;\n                cond_t_res_74094 = defunc_0_neq_res_74091 || y_74093;\n                x_74095 = cond_74089 && cond_t_res_74094;\n                if (x_74095) {\n                    defunc_0_op_res_74096 = (int64_t) -1;\n                    defunc_0_op_res_74097 = eta_p_74065;\n                    defunc_0_op_res_74098 = (int64_t) 0;\n                } else {\n                    int64_t x_74078;\n                    int64_t defunc_0_op_res_f_res_74099;\n                    int32_t defunc_0_op_res_f_res_74100;\n                    int64_t defunc_0_op_res_f_res_74101;\n                    \n                    x_74078 = ((__local int64_t *) color_76530)[i_75337];\n                    if (cond_74089) {\n                        defunc_0_op_res_f_res_74099 = x_74076;\n                        defunc_0_op_res_f_res_74100 = x_74077;\n                        defunc_0_op_res_f_res_74101 = x_74078;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74102;\n                        int64_t defunc_0_op_res_f_res_f_res_74103;\n                        int64_t defunc_0_op_res_f_res_f_res_74104;\n                        \n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74102 = redout_75335;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74102 = eta_p_74065;\n                        }\n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74103 = redout_75334;\n                            defunc_0_op_res_f_res_f_res_74104 = redout_75336;\n                        } else {\n                            int64_t min_res_74105;\n                            i",
                                    "nt64_t tmp_74106;\n                            \n                            min_res_74105 = smin64(x_74076, redout_75334);\n                            tmp_74106 = add64(x_74078, redout_75336);\n                            defunc_0_op_res_f_res_f_res_74103 = min_res_74105;\n                            defunc_0_op_res_f_res_f_res_74104 = tmp_74106;\n                        }\n                        defunc_0_op_res_f_res_74099 = defunc_0_op_res_f_res_f_res_74103;\n                        defunc_0_op_res_f_res_74100 = defunc_0_op_res_f_res_f_res_74102;\n                        defunc_0_op_res_f_res_74101 = defunc_0_op_res_f_res_f_res_74104;\n                    }\n                    defunc_0_op_res_74096 = defunc_0_op_res_f_res_74099;\n                    defunc_0_op_res_74097 = defunc_0_op_res_f_res_74100;\n                    defunc_0_op_res_74098 = defunc_0_op_res_f_res_74101;\n                }\n                redout_tmp_76656 = defunc_0_op_res_74096;\n                redout_tmp_76657 = defunc_0_op_res_74097;\n                redout_tmp_76658 = defunc_0_op_res_74098;\n                redout_75334 = redout_tmp_76656;\n                redout_75335 = redout_tmp_76657;\n                redout_75336 = redout_tmp_76658;\n            }\n            x_74073 = redout_75334;\n            x_74074 = redout_75335;\n            x_74075 = redout_75336;\n            acc_74070 = x_74073;\n            acc_74071 = x_74074;\n            acc_74072 = x_74075;\n        } else {\n            acc_74070 = acc_74066;\n            acc_74071 = acc_74067;\n            acc_74072 = acc_74068;\n        }\n        mem_75858[(int64_t) 0] = acc_74070;\n        mem_75862[(int64_t) 0] = acc_74071;\n        mem_75866[(int64_t) 0] = acc_74072;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76650[i_6] = mem_75858[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76651[i_7] = mem_75862[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n          ", "  mem_param_tmp_76652[i_8] = mem_75866[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75846[i_9] = mem_param_tmp_76650[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75847[i_10] = mem_param_tmp_76651[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75848[i_11] = mem_param_tmp_76652[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75869[i_12] = mem_param_75846[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75868[i_13] = mem_param_75847[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75867[i_14] = mem_param_75848[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74142) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75885[i_15] = ext_mem_75869[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75884[i_16] = ext_mem_75867[i_16];\n    } else {\n        int64_t ltid_flat_74144;\n        int64_t ltid_74143;\n        int64_t j_74159;\n        bool cond_74163;\n        int64_t pre1d_74166;\n        int64_t pre1d_74164;\n        int32_t pre1d_74165;\n        int64_t ltid_flat_74180;\n        int64_t ltid_74179;\n        int64_t gtid_74193;\n        int64_t acc_74195;\n        int64_t acc_74197;\n        bool cond_74198;\n        int64_t acc_74199;\n        int64_t acc_74201;\n        \n        ltid_flat_74144 = sext_i32_i64(local_tid_76641);\n        ltid_74143 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74159 = ltid_74143 + binop_x_74158;\n        cond_74163 = slt64(j_74159, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74166 = btoi_bool_i64(cond_74163);\n        if (cond_74163) {\n            int64_t tile_elem_74167;\n            int64_t slice_75320;\n            int32_t tile_elem_74168;\n            \n            tile_elem_74167 = ((__global int64_t *) ext_mem_75767)[j_74159];\n            slice_75320 = tS_start_64840 + j_74159;\n            tile_elem_74168 = ((__global", " int32_t *) tS_mem_75468)[slice_75320];\n            pre1d_74164 = tile_elem_74167;\n            pre1d_74165 = tile_elem_74168;\n        } else {\n            pre1d_74164 = (int64_t) 0;\n            pre1d_74165 = 0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74143] = pre1d_74164;\n        ((__local int32_t *) color_76531)[ltid_74143] = pre1d_74165;\n        ((__local int64_t *) color_76530)[ltid_74143] = pre1d_74166;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74180 = sext_i32_i64(local_tid_76641);\n        ltid_74179 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74193 = binop_x_73909 + ltid_74179;\n        acc_74195 = ext_mem_75869[(int64_t) 0];\n        acc_74197 = ext_mem_75867[(int64_t) 0];\n        cond_74198 = slt64(gtid_74193, min_res_66402);\n        if (cond_74198) {\n            int32_t eta_p_74194;\n            int32_t acc_74196;\n            int64_t x_74202;\n            int32_t x_74203;\n            int64_t x_74204;\n            int64_t redout_75338;\n            int32_t redout_75339;\n            int64_t redout_75340;\n            \n            eta_p_74194 = mem_75833[(int64_t) 0];\n            acc_74196 = ext_mem_75868[(int64_t) 0];\n            redout_75338 = acc_74195;\n            redout_75339 = acc_74196;\n            redout_75340 = acc_74197;\n            for (int64_t i_75341 = 0; i_75341 < residual_input_74141; i_75341++) {\n                int64_t x_74205;\n                int32_t x_74206;\n                bool defunc_0_neq_res_74214;\n                bool defunc_0_neq_res_74215;\n                bool cond_f_res_74216;\n                bool y_74217;\n                bool cond_74218;\n                bool defunc_0_neq_res_74219;\n                bool defunc_0_neq_res_74220;\n                bool cond_t_res_f_res_74221;\n                bool y_74222;\n                bool cond_t_res_74223;\n                bool x_74224;\n                int64_t defunc_0_op_res_74225;\n                int32_t defunc_0_op_res_74226;\n                int64_t defunc_0_op",
                                    "_res_74227;\n                int64_t redout_tmp_76659;\n                int32_t redout_tmp_76660;\n                int64_t redout_tmp_76661;\n                \n                x_74205 = ((__local int64_t *) color_76532)[i_75341];\n                x_74206 = ((__local int32_t *) color_76531)[i_75341];\n                defunc_0_neq_res_74214 = redout_75339 == eta_p_74194;\n                defunc_0_neq_res_74215 = !defunc_0_neq_res_74214;\n                cond_f_res_74216 = slt64(redout_75338, (int64_t) 0);\n                y_74217 = defunc_0_neq_res_74214 && cond_f_res_74216;\n                cond_74218 = defunc_0_neq_res_74215 || y_74217;\n                defunc_0_neq_res_74219 = x_74206 == eta_p_74194;\n                defunc_0_neq_res_74220 = !defunc_0_neq_res_74219;\n                cond_t_res_f_res_74221 = slt64(x_74205, (int64_t) 0);\n                y_74222 = defunc_0_neq_res_74219 && cond_t_res_f_res_74221;\n                cond_t_res_74223 = defunc_0_neq_res_74220 || y_74222;\n                x_74224 = cond_74218 && cond_t_res_74223;\n                if (x_74224) {\n                    defunc_0_op_res_74225 = (int64_t) -1;\n                    defunc_0_op_res_74226 = eta_p_74194;\n                    defunc_0_op_res_74227 = (int64_t) 0;\n                } else {\n                    int64_t x_74207;\n                    int64_t defunc_0_op_res_f_res_74228;\n                    int32_t defunc_0_op_res_f_res_74229;\n                    int64_t defunc_0_op_res_f_res_74230;\n                    \n                    x_74207 = ((__local int64_t *) color_76530)[i_75341];\n                    if (cond_74218) {\n                        defunc_0_op_res_f_res_74228 = x_74205;\n                        defunc_0_op_res_f_res_74229 = x_74206;\n                        defunc_0_op_res_f_res_74230 = x_74207;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74231;\n                        int64_t defunc_0_op_res_f_res_f_res_74232;\n                        int64_t defunc_0", "_op_res_f_res_f_res_74233;\n                        \n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74231 = redout_75339;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74231 = eta_p_74194;\n                        }\n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74232 = redout_75338;\n                            defunc_0_op_res_f_res_f_res_74233 = redout_75340;\n                        } else {\n                            int64_t min_res_74234;\n                            int64_t tmp_74235;\n                            \n                            min_res_74234 = smin64(x_74205, redout_75338);\n                            tmp_74235 = add64(x_74207, redout_75340);\n                            defunc_0_op_res_f_res_f_res_74232 = min_res_74234;\n                            defunc_0_op_res_f_res_f_res_74233 = tmp_74235;\n                        }\n                        defunc_0_op_res_f_res_74228 = defunc_0_op_res_f_res_f_res_74232;\n                        defunc_0_op_res_f_res_74229 = defunc_0_op_res_f_res_f_res_74231;\n                        defunc_0_op_res_f_res_74230 = defunc_0_op_res_f_res_f_res_74233;\n                    }\n                    defunc_0_op_res_74225 = defunc_0_op_res_f_res_74228;\n                    defunc_0_op_res_74226 = defunc_0_op_res_f_res_74229;\n                    defunc_0_op_res_74227 = defunc_0_op_res_f_res_74230;\n                }\n                redout_tmp_76659 = defunc_0_op_res_74225;\n                redout_tmp_76660 = defunc_0_op_res_74226;\n                redout_tmp_76661 = defunc_0_op_res_74227;\n                redout_75338 = redout_tmp_76659;\n                redout_75339 = redout_tmp_76660;\n                redout_75340 = redout_tmp_76661;\n            }\n            x_74202 = redout_75338;\n            x_74203 = redout_75339;\n            x_74204 = redout_75340;\n            acc_74199 = x_74", "202;\n            acc_74201 = x_74204;\n        } else {\n            acc_74199 = acc_74195;\n            acc_74201 = acc_74197;\n        }\n        mem_75879[(int64_t) 0] = acc_74199;\n        mem_75883[(int64_t) 0] = acc_74201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75885[i_17] = mem_75879[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75884[i_18] = mem_75883[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76662 = ext_mem_75885[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75887)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76662;\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76663 = ext_mem_75884[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75889)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76663;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_73901\n    #undef bytes_75849\n    #undef bytes_75851\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_74254_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_74254(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_74257, int64_t num_whole_tiles_74272, int64_t residual_input_74496, unsigned char cond_74497_bits, int64_t binop_x_74513, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75826, __global unsigned char *mem_75828)\n{\n    bool cond_74497 = cond_74497_bits;\n    \n    #define tile_sizze_74256 (inner_SMJ_intzisegmap_intrablock_74254zitile_sizze_74256)\n    #define bytes_75788 (inner_SMJ_intzisegmap_intrablock_74254zib",
                                    "ytes_75788)\n    #define bytes_75790 (inner_SMJ_intzisegmap_intrablock_74254zibytes_75790)\n    \n    volatile __local unsigned char *color_76535_backing_2 = &shared_mem[0];\n    const int64_t color_76535_backing_2_offset = 0 + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76534_backing_1 = &shared_mem[color_76535_backing_2_offset];\n    const int64_t color_76534_backing_1_offset = color_76535_backing_2_offset + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76533_backing_0 = &shared_mem[color_76534_backing_1_offset];\n    const int64_t color_76533_backing_0_offset = color_76534_backing_1_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76667;\n    int32_t tblock_sizze_76670;\n    int32_t wave_sizze_76669;\n    int32_t block_id_76668;\n    int32_t global_tid_76666;\n    int64_t gid_flat_74254;\n    int64_t slice_76672;\n    int64_t ltid_pre_76671;\n    int64_t remnant_76673;\n    int64_t slice_76674;\n    int64_t gid_74253;\n    int64_t remnant_76675;\n    __local unsigned char *color_76533;\n    __local unsigned char *color_76534;\n    __local unsigned char *color_76535;\n    int64_t binop_x_74264;\n    int32_t mem_75772[1];\n    int64_t ltid_flat_74259;\n    int64_t ltid_74258;\n    int64_t gtid_74265;\n    bool cond_74266;\n    int32_t pre_74267;\n    int64_t mem_75776[1];\n    int32_t mem_75780[1];\n    int64_t mem_75784[1];\n    int64_t ltid_flat_74274;\n    int64_t ltid_74273;\n    int64_t gtid_74284;\n    bool cond_74285;\n    int64_t neutral_74286;\n    int32_t neutral_74287;\n    int64_t ext_mem_75808[1];\n    int32_t ext_mem_75807[1];\n    int64_t ext_mem_75806[1];\n    int64_t mem_param_75785[1];\n    int32_t mem_param_75786[1];\n    int64_t mem_param_75787[1];\n    int64_t mem_75818[1];\n    int64_t mem_75822[1];\n    i", "nt64_t ext_mem_75824[1];\n    int64_t ext_mem_75823[1];\n    \n    local_tid_76667 = get_local_id(0);\n    tblock_sizze_76670 = get_local_size(0);\n    wave_sizze_76669 = LOCKSTEP_WIDTH;\n    block_id_76668 = get_tblock_id(0);\n    global_tid_76666 = block_id_76668 * tblock_sizze_76670 + local_tid_76667;\n    gid_flat_74254 = sext_i32_i64(block_id_76668);\n    slice_76672 = tile_sizze_74256;\n    ltid_pre_76671 = sext_i32_i64(local_tid_76667);\n    remnant_76673 = sext_i32_i64(local_tid_76667) - ltid_pre_76671;\n    slice_76674 = ldim_74257;\n    gid_74253 = sext_i32_i64(block_id_76668);\n    remnant_76675 = sext_i32_i64(block_id_76668) - gid_74253;\n    color_76533 = (__local unsigned char *) color_76533_backing_0;\n    color_76534 = (__local unsigned char *) color_76534_backing_1;\n    color_76535 = (__local unsigned char *) color_76535_backing_2;\n    binop_x_74264 = gid_74253 * tile_sizze_74256;\n    ltid_flat_74259 = sext_i32_i64(local_tid_76667);\n    ltid_74258 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74265 = ltid_74258 + binop_x_74264;\n    cond_74266 = slt64(gtid_74265, min_res_66402);\n    if (cond_74266) {\n        int64_t slice_74268;\n        int32_t eta_p_74269;\n        \n        slice_74268 = start_66400 + gtid_74265;\n        eta_p_74269 = ((__global int32_t *) tR_mem_75467)[slice_74268];\n        pre_74267 = eta_p_74269;\n    } else {\n        pre_74267 = 0;\n    }\n    mem_75772[(int64_t) 0] = pre_74267;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74274 = sext_i32_i64(local_tid_76667);\n    ltid_74273 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74284 = binop_x_74264 + ltid_74273;\n    cond_74285 = slt64(gtid_74284, min_res_66402);\n    if (cond_74285) {\n        neutral_74286 = (int64_t) -1;\n    } else {\n        neutral_74286 = (int64_t) 0;\n    }\n    if (cond_74285) {\n        int32_t eta_p_74289 = mem_75772[(int64_t) 0];\n        \n        neutral_74287 = eta_p_74289;\n    } else {\n        neutral_74287 = 0;\n    }\n    mem_75776[(int64_t) 0] = neutral_74286;", "\n    mem_75780[(int64_t) 0] = neutral_74287;\n    mem_75784[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75785[i_3] = mem_75776[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75786[i_4] = mem_75780[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75787[i_5] = mem_75784[i_5];\n    for (int64_t tile_id_74299 = 0; tile_id_74299 < num_whole_tiles_74272; tile_id_74299++) {\n        int64_t binop_x_74398;\n        int64_t ltid_flat_74397;\n        int64_t ltid_74396;\n        int64_t j_74399;\n        bool cond_74403;\n        int64_t pre1d_74406;\n        int64_t pre1d_74404;\n        int32_t pre1d_74405;\n        int64_t mem_75797[1];\n        int32_t mem_75801[1];\n        int64_t mem_75805[1];\n        int64_t ltid_flat_74417;\n        int64_t ltid_74416;\n        int64_t gtid_74419;\n        int64_t acc_74421;\n        int32_t acc_74422;\n        int64_t acc_74423;\n        bool cond_74424;\n        int64_t acc_74425;\n        int32_t acc_74426;\n        int64_t acc_74427;\n        int64_t mem_param_tmp_76676[1];\n        int32_t mem_param_tmp_76677[1];\n        int64_t mem_param_tmp_76678[1];\n        \n        binop_x_74398 = tile_sizze_74256 * tile_id_74299;\n        ltid_flat_74397 = sext_i32_i64(local_tid_76667);\n        ltid_74396 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74399 = ltid_74396 + binop_x_74398;\n        cond_74403 = slt64(j_74399, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74406 = btoi_bool_i64(cond_74403);\n        if (cond_74403) {\n            int64_t tile_elem_74407;\n            int64_t slice_75325;\n            int32_t tile_elem_74408;\n            \n            tile_elem_74407 = ((__global int64_t *) ext_mem_75767)[j_74399];\n            slice_75325 = tS_start_64840 + j_74399;\n            tile_elem_74408 = ((__global int32_t *) tS_mem_75468)[slice_75325];\n            pre1d_74404 = tile_elem_74407;\n ",
                                    "           pre1d_74405 = tile_elem_74408;\n        } else {\n            pre1d_74404 = (int64_t) 0;\n            pre1d_74405 = 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74396] = pre1d_74404;\n        ((__local int32_t *) color_76534)[ltid_74396] = pre1d_74405;\n        ((__local int64_t *) color_76533)[ltid_74396] = pre1d_74406;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74417 = sext_i32_i64(local_tid_76667);\n        ltid_74416 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74419 = binop_x_74264 + ltid_74416;\n        acc_74421 = mem_param_75785[(int64_t) 0];\n        acc_74422 = mem_param_75786[(int64_t) 0];\n        acc_74423 = mem_param_75787[(int64_t) 0];\n        cond_74424 = slt64(gtid_74419, min_res_66402);\n        if (cond_74424) {\n            int32_t eta_p_74420;\n            int64_t x_74428;\n            int32_t x_74429;\n            int64_t x_74430;\n            int64_t redout_75342;\n            int32_t redout_75343;\n            int64_t redout_75344;\n            \n            eta_p_74420 = mem_75772[(int64_t) 0];\n            redout_75342 = acc_74421;\n            redout_75343 = acc_74422;\n            redout_75344 = acc_74423;\n            for (int64_t i_75345 = 0; i_75345 < tile_sizze_74256; i_75345++) {\n                int64_t x_74431;\n                int32_t x_74432;\n                bool defunc_0_neq_res_74440;\n                bool defunc_0_neq_res_74441;\n                bool cond_f_res_74442;\n                bool y_74443;\n                bool cond_74444;\n                bool defunc_0_neq_res_74445;\n                bool defunc_0_neq_res_74446;\n                bool cond_t_res_f_res_74447;\n                bool y_74448;\n                bool cond_t_res_74449;\n                bool x_74450;\n                int64_t defunc_0_op_res_74451;\n                int32_t defunc_0_op_res_74452;\n                int64_t defunc_0_op_res_74453;\n                int64_t redout_tmp_76682;\n                int32_t redout_tmp_76683;\n                int64", "_t redout_tmp_76684;\n                \n                x_74431 = ((__local int64_t *) color_76535)[i_75345];\n                x_74432 = ((__local int32_t *) color_76534)[i_75345];\n                defunc_0_neq_res_74440 = redout_75343 == eta_p_74420;\n                defunc_0_neq_res_74441 = !defunc_0_neq_res_74440;\n                cond_f_res_74442 = slt64(redout_75342, (int64_t) 0);\n                y_74443 = defunc_0_neq_res_74440 && cond_f_res_74442;\n                cond_74444 = defunc_0_neq_res_74441 || y_74443;\n                defunc_0_neq_res_74445 = x_74432 == eta_p_74420;\n                defunc_0_neq_res_74446 = !defunc_0_neq_res_74445;\n                cond_t_res_f_res_74447 = slt64(x_74431, (int64_t) 0);\n                y_74448 = defunc_0_neq_res_74445 && cond_t_res_f_res_74447;\n                cond_t_res_74449 = defunc_0_neq_res_74446 || y_74448;\n                x_74450 = cond_74444 && cond_t_res_74449;\n                if (x_74450) {\n                    defunc_0_op_res_74451 = (int64_t) -1;\n                    defunc_0_op_res_74452 = eta_p_74420;\n                    defunc_0_op_res_74453 = (int64_t) 0;\n                } else {\n                    int64_t x_74433;\n                    int64_t defunc_0_op_res_f_res_74454;\n                    int32_t defunc_0_op_res_f_res_74455;\n                    int64_t defunc_0_op_res_f_res_74456;\n                    \n                    x_74433 = ((__local int64_t *) color_76533)[i_75345];\n                    if (cond_74444) {\n                        defunc_0_op_res_f_res_74454 = x_74431;\n                        defunc_0_op_res_f_res_74455 = x_74432;\n                        defunc_0_op_res_f_res_74456 = x_74433;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74457;\n                        int64_t defunc_0_op_res_f_res_f_res_74458;\n                        int64_t defunc_0_op_res_f_res_f_res_74459;\n                        \n                        if (cond_t_res_74449) {\n                 ", "           defunc_0_op_res_f_res_f_res_74457 = redout_75343;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74457 = eta_p_74420;\n                        }\n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74458 = redout_75342;\n                            defunc_0_op_res_f_res_f_res_74459 = redout_75344;\n                        } else {\n                            int64_t min_res_74460;\n                            int64_t tmp_74461;\n                            \n                            min_res_74460 = smin64(x_74431, redout_75342);\n                            tmp_74461 = add64(x_74433, redout_75344);\n                            defunc_0_op_res_f_res_f_res_74458 = min_res_74460;\n                            defunc_0_op_res_f_res_f_res_74459 = tmp_74461;\n                        }\n                        defunc_0_op_res_f_res_74454 = defunc_0_op_res_f_res_f_res_74458;\n                        defunc_0_op_res_f_res_74455 = defunc_0_op_res_f_res_f_res_74457;\n                        defunc_0_op_res_f_res_74456 = defunc_0_op_res_f_res_f_res_74459;\n                    }\n                    defunc_0_op_res_74451 = defunc_0_op_res_f_res_74454;\n                    defunc_0_op_res_74452 = defunc_0_op_res_f_res_74455;\n                    defunc_0_op_res_74453 = defunc_0_op_res_f_res_74456;\n                }\n                redout_tmp_76682 = defunc_0_op_res_74451;\n                redout_tmp_76683 = defunc_0_op_res_74452;\n                redout_tmp_76684 = defunc_0_op_res_74453;\n                redout_75342 = redout_tmp_76682;\n                redout_75343 = redout_tmp_76683;\n                redout_75344 = redout_tmp_76684;\n            }\n            x_74428 = redout_75342;\n            x_74429 = redout_75343;\n            x_74430 = redout_75344;\n            acc_74425 = x_74428;\n            acc_74426 = x_74429;\n            acc_74427 = x_74430;\n        } else {\n            acc_74425 = acc_7",
                                    "4421;\n            acc_74426 = acc_74422;\n            acc_74427 = acc_74423;\n        }\n        mem_75797[(int64_t) 0] = acc_74425;\n        mem_75801[(int64_t) 0] = acc_74426;\n        mem_75805[(int64_t) 0] = acc_74427;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76676[i_6] = mem_75797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76677[i_7] = mem_75801[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76678[i_8] = mem_75805[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75785[i_9] = mem_param_tmp_76676[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75786[i_10] = mem_param_tmp_76677[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75787[i_11] = mem_param_tmp_76678[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75808[i_12] = mem_param_75785[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75807[i_13] = mem_param_75786[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75806[i_14] = mem_param_75787[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74497) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75824[i_15] = ext_mem_75808[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75823[i_16] = ext_mem_75806[i_16];\n    } else {\n        int64_t ltid_flat_74499;\n        int64_t ltid_74498;\n        int64_t j_74514;\n        bool cond_74518;\n        int64_t pre1d_74521;\n        int64_t pre1d_74519;\n        int32_t pre1d_74520;\n        int64_t ltid_flat_74535;\n        int64_t ltid_74534;\n        int64_t gtid_74548;\n        int64_t acc_74550;\n        int64_t acc_74552;\n        bool cond_74553;\n        int64_t acc_74554;\n        int64_t acc_74556;\n        \n        ltid_flat_74499 = sext_i32_i64(local_tid_76667);\n        ltid_74498 = sext_i32_i64(sext_i64_i32(", "ltid_pre_76671));\n        j_74514 = ltid_74498 + binop_x_74513;\n        cond_74518 = slt64(j_74514, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74521 = btoi_bool_i64(cond_74518);\n        if (cond_74518) {\n            int64_t tile_elem_74522;\n            int64_t slice_75324;\n            int32_t tile_elem_74523;\n            \n            tile_elem_74522 = ((__global int64_t *) ext_mem_75767)[j_74514];\n            slice_75324 = tS_start_64840 + j_74514;\n            tile_elem_74523 = ((__global int32_t *) tS_mem_75468)[slice_75324];\n            pre1d_74519 = tile_elem_74522;\n            pre1d_74520 = tile_elem_74523;\n        } else {\n            pre1d_74519 = (int64_t) 0;\n            pre1d_74520 = 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74498] = pre1d_74519;\n        ((__local int32_t *) color_76534)[ltid_74498] = pre1d_74520;\n        ((__local int64_t *) color_76533)[ltid_74498] = pre1d_74521;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74535 = sext_i32_i64(local_tid_76667);\n        ltid_74534 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74548 = binop_x_74264 + ltid_74534;\n        acc_74550 = ext_mem_75808[(int64_t) 0];\n        acc_74552 = ext_mem_75806[(int64_t) 0];\n        cond_74553 = slt64(gtid_74548, min_res_66402);\n        if (cond_74553) {\n            int32_t eta_p_74549;\n            int32_t acc_74551;\n            int64_t x_74557;\n            int32_t x_74558;\n            int64_t x_74559;\n            int64_t redout_75346;\n            int32_t redout_75347;\n            int64_t redout_75348;\n            \n            eta_p_74549 = mem_75772[(int64_t) 0];\n            acc_74551 = ext_mem_75807[(int64_t) 0];\n            redout_75346 = acc_74550;\n            redout_75347 = acc_74551;\n            redout_75348 = acc_74552;\n            for (int64_t i_75349 = 0; i_75349 < residual_input_74496; i_75349++) {\n                int64_t x_74560;\n                int32_t x_74561;\n                bool defunc_0_neq_res_745", "69;\n                bool defunc_0_neq_res_74570;\n                bool cond_f_res_74571;\n                bool y_74572;\n                bool cond_74573;\n                bool defunc_0_neq_res_74574;\n                bool defunc_0_neq_res_74575;\n                bool cond_t_res_f_res_74576;\n                bool y_74577;\n                bool cond_t_res_74578;\n                bool x_74579;\n                int64_t defunc_0_op_res_74580;\n                int32_t defunc_0_op_res_74581;\n                int64_t defunc_0_op_res_74582;\n                int64_t redout_tmp_76685;\n                int32_t redout_tmp_76686;\n                int64_t redout_tmp_76687;\n                \n                x_74560 = ((__local int64_t *) color_76535)[i_75349];\n                x_74561 = ((__local int32_t *) color_76534)[i_75349];\n                defunc_0_neq_res_74569 = redout_75347 == eta_p_74549;\n                defunc_0_neq_res_74570 = !defunc_0_neq_res_74569;\n                cond_f_res_74571 = slt64(redout_75346, (int64_t) 0);\n                y_74572 = defunc_0_neq_res_74569 && cond_f_res_74571;\n                cond_74573 = defunc_0_neq_res_74570 || y_74572;\n                defunc_0_neq_res_74574 = x_74561 == eta_p_74549;\n                defunc_0_neq_res_74575 = !defunc_0_neq_res_74574;\n                cond_t_res_f_res_74576 = slt64(x_74560, (int64_t) 0);\n                y_74577 = defunc_0_neq_res_74574 && cond_t_res_f_res_74576;\n                cond_t_res_74578 = defunc_0_neq_res_74575 || y_74577;\n                x_74579 = cond_74573 && cond_t_res_74578;\n                if (x_74579) {\n                    defunc_0_op_res_74580 = (int64_t) -1;\n                    defunc_0_op_res_74581 = eta_p_74549;\n                    defunc_0_op_res_74582 = (int64_t) 0;\n                } else {\n                    int64_t x_74562;\n                    int64_t defunc_0_op_res_f_res_74583;\n                    int32_t defunc_0_op_res_f_res_74584;\n                    int64_t defunc_0_op_res_f_res_74585;\n           ",
                                    "         \n                    x_74562 = ((__local int64_t *) color_76533)[i_75349];\n                    if (cond_74573) {\n                        defunc_0_op_res_f_res_74583 = x_74560;\n                        defunc_0_op_res_f_res_74584 = x_74561;\n                        defunc_0_op_res_f_res_74585 = x_74562;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74586;\n                        int64_t defunc_0_op_res_f_res_f_res_74587;\n                        int64_t defunc_0_op_res_f_res_f_res_74588;\n                        \n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74586 = redout_75347;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74586 = eta_p_74549;\n                        }\n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74587 = redout_75346;\n                            defunc_0_op_res_f_res_f_res_74588 = redout_75348;\n                        } else {\n                            int64_t min_res_74589;\n                            int64_t tmp_74590;\n                            \n                            min_res_74589 = smin64(x_74560, redout_75346);\n                            tmp_74590 = add64(x_74562, redout_75348);\n                            defunc_0_op_res_f_res_f_res_74587 = min_res_74589;\n                            defunc_0_op_res_f_res_f_res_74588 = tmp_74590;\n                        }\n                        defunc_0_op_res_f_res_74583 = defunc_0_op_res_f_res_f_res_74587;\n                        defunc_0_op_res_f_res_74584 = defunc_0_op_res_f_res_f_res_74586;\n                        defunc_0_op_res_f_res_74585 = defunc_0_op_res_f_res_f_res_74588;\n                    }\n                    defunc_0_op_res_74580 = defunc_0_op_res_f_res_74583;\n                    defunc_0_op_res_74581 = defunc_0_op_res_f_res_74584;\n                    defunc_0_op_res_74582 = defu", "nc_0_op_res_f_res_74585;\n                }\n                redout_tmp_76685 = defunc_0_op_res_74580;\n                redout_tmp_76686 = defunc_0_op_res_74581;\n                redout_tmp_76687 = defunc_0_op_res_74582;\n                redout_75346 = redout_tmp_76685;\n                redout_75347 = redout_tmp_76686;\n                redout_75348 = redout_tmp_76687;\n            }\n            x_74557 = redout_75346;\n            x_74558 = redout_75347;\n            x_74559 = redout_75348;\n            acc_74554 = x_74557;\n            acc_74556 = x_74559;\n        } else {\n            acc_74554 = acc_74550;\n            acc_74556 = acc_74552;\n        }\n        mem_75818[(int64_t) 0] = acc_74554;\n        mem_75822[(int64_t) 0] = acc_74556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75824[i_17] = mem_75818[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75823[i_18] = mem_75822[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76688 = ext_mem_75824[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75826)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76688;\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76689 = ext_mem_75823[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75828)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76689;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74256\n    #undef bytes_75788\n    #undef bytes_75790\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_74609_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_74609(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74612, int64_t num_whole_tiles_7", "4627, int64_t residual_input_74851, unsigned char cond_74852_bits, int64_t binop_x_74868, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75682, __global unsigned char *mem_75684)\n{\n    bool cond_74852 = cond_74852_bits;\n    \n    #define tile_sizze_74611 (inner_SMJ_intzisegmap_intrablock_74609zitile_sizze_74611)\n    #define bytes_75644 (inner_SMJ_intzisegmap_intrablock_74609zibytes_75644)\n    #define bytes_75646 (inner_SMJ_intzisegmap_intrablock_74609zibytes_75646)\n    \n    volatile __local unsigned char *color_76538_backing_2 = &shared_mem[0];\n    const int64_t color_76538_backing_2_offset = 0 + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76537_backing_1 = &shared_mem[color_76538_backing_2_offset];\n    const int64_t color_76537_backing_1_offset = color_76538_backing_2_offset + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76536_backing_0 = &shared_mem[color_76537_backing_1_offset];\n    const int64_t color_76536_backing_0_offset = color_76537_backing_1_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76808;\n    int32_t tblock_sizze_76811;\n    int32_t wave_sizze_76810;\n    int32_t block_id_76809;\n    int32_t global_tid_76807;\n    int64_t gid_flat_74609;\n    int64_t slice_76813;\n    int64_t ltid_pre_76812;\n    int64_t remnant_76814;\n    int64_t slice_76815;\n    int64_t gid_74608;\n    int64_t remnant_76816;\n    __local unsigned char *color_76536;\n    __local unsigned char *color_76537;\n    __local unsigned char *color_76538;\n    int64_t binop_x_74619;\n    int32_t mem_75628[1];\n    int64_t ltid_flat_74614;\n    int64_t ltid_74613;\n    int64_t gtid_74620;\n    bool cond_74621;\n    int32_t pre_74622",
                                    ";\n    int64_t mem_75632[1];\n    int32_t mem_75636[1];\n    int64_t mem_75640[1];\n    int64_t ltid_flat_74629;\n    int64_t ltid_74628;\n    int64_t gtid_74639;\n    bool cond_74640;\n    int64_t neutral_74641;\n    int32_t neutral_74642;\n    int64_t ext_mem_75664[1];\n    int32_t ext_mem_75663[1];\n    int64_t ext_mem_75662[1];\n    int64_t mem_param_75641[1];\n    int32_t mem_param_75642[1];\n    int64_t mem_param_75643[1];\n    int64_t mem_75674[1];\n    int64_t mem_75678[1];\n    int64_t ext_mem_75680[1];\n    int64_t ext_mem_75679[1];\n    \n    local_tid_76808 = get_local_id(0);\n    tblock_sizze_76811 = get_local_size(0);\n    wave_sizze_76810 = LOCKSTEP_WIDTH;\n    block_id_76809 = get_tblock_id(0);\n    global_tid_76807 = block_id_76809 * tblock_sizze_76811 + local_tid_76808;\n    gid_flat_74609 = sext_i32_i64(block_id_76809);\n    slice_76813 = tile_sizze_74611;\n    ltid_pre_76812 = sext_i32_i64(local_tid_76808);\n    remnant_76814 = sext_i32_i64(local_tid_76808) - ltid_pre_76812;\n    slice_76815 = ldim_74612;\n    gid_74608 = sext_i32_i64(block_id_76809);\n    remnant_76816 = sext_i32_i64(block_id_76809) - gid_74608;\n    color_76536 = (__local unsigned char *) color_76536_backing_0;\n    color_76537 = (__local unsigned char *) color_76537_backing_1;\n    color_76538 = (__local unsigned char *) color_76538_backing_2;\n    binop_x_74619 = gid_74608 * tile_sizze_74611;\n    ltid_flat_74614 = sext_i32_i64(local_tid_76808);\n    ltid_74613 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74620 = ltid_74613 + binop_x_74619;\n    cond_74621 = slt64(gtid_74620, min_res_65540);\n    if (cond_74621) {\n        int64_t slice_74623;\n        int32_t eta_p_74624;\n        \n        slice_74623 = slice_65554 + gtid_74620;\n        eta_p_74624 = ((__global int32_t *) tR_mem_75467)[slice_74623];\n        pre_74622 = eta_p_74624;\n    } else {\n        pre_74622 = 0;\n    }\n    mem_75628[(int64_t) 0] = pre_74622;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74629 = sext_i32_i64(local_tid_76808);\n    ltid_", "74628 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74639 = binop_x_74619 + ltid_74628;\n    cond_74640 = slt64(gtid_74639, min_res_65540);\n    if (cond_74640) {\n        neutral_74641 = (int64_t) -1;\n    } else {\n        neutral_74641 = (int64_t) 0;\n    }\n    if (cond_74640) {\n        int32_t eta_p_74644 = mem_75628[(int64_t) 0];\n        \n        neutral_74642 = eta_p_74644;\n    } else {\n        neutral_74642 = 0;\n    }\n    mem_75632[(int64_t) 0] = neutral_74641;\n    mem_75636[(int64_t) 0] = neutral_74642;\n    mem_75640[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75641[i_3] = mem_75632[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75642[i_4] = mem_75636[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75643[i_5] = mem_75640[i_5];\n    for (int64_t tile_id_74654 = 0; tile_id_74654 < num_whole_tiles_74627; tile_id_74654++) {\n        int64_t binop_x_74753;\n        int64_t ltid_flat_74752;\n        int64_t ltid_74751;\n        int64_t j_74754;\n        bool cond_74758;\n        int64_t pre1d_74761;\n        int64_t pre1d_74759;\n        int32_t pre1d_74760;\n        int64_t mem_75653[1];\n        int32_t mem_75657[1];\n        int64_t mem_75661[1];\n        int64_t ltid_flat_74772;\n        int64_t ltid_74771;\n        int64_t gtid_74774;\n        int64_t acc_74776;\n        int32_t acc_74777;\n        int64_t acc_74778;\n        bool cond_74779;\n        int64_t acc_74780;\n        int32_t acc_74781;\n        int64_t acc_74782;\n        int64_t mem_param_tmp_76817[1];\n        int32_t mem_param_tmp_76818[1];\n        int64_t mem_param_tmp_76819[1];\n        \n        binop_x_74753 = tile_sizze_74611 * tile_id_74654;\n        ltid_flat_74752 = sext_i32_i64(local_tid_76808);\n        ltid_74751 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74754 = ltid_74751 + binop_x_74753;\n        cond_74758 = slt64(j_74754, j_m_i_65502);\n        p", "re1d_74761 = btoi_bool_i64(cond_74758);\n        if (cond_74758) {\n            int64_t tile_elem_74762;\n            int64_t slice_75329;\n            int32_t tile_elem_74763;\n            \n            tile_elem_74762 = ((__global int64_t *) ext_mem_75562)[j_74754];\n            slice_75329 = slice_65911 + j_74754;\n            tile_elem_74763 = ((__global int32_t *) tS_mem_75468)[slice_75329];\n            pre1d_74759 = tile_elem_74762;\n            pre1d_74760 = tile_elem_74763;\n        } else {\n            pre1d_74759 = (int64_t) 0;\n            pre1d_74760 = 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74751] = pre1d_74759;\n        ((__local int32_t *) color_76537)[ltid_74751] = pre1d_74760;\n        ((__local int64_t *) color_76536)[ltid_74751] = pre1d_74761;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74772 = sext_i32_i64(local_tid_76808);\n        ltid_74771 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74774 = binop_x_74619 + ltid_74771;\n        acc_74776 = mem_param_75641[(int64_t) 0];\n        acc_74777 = mem_param_75642[(int64_t) 0];\n        acc_74778 = mem_param_75643[(int64_t) 0];\n        cond_74779 = slt64(gtid_74774, min_res_65540);\n        if (cond_74779) {\n            int32_t eta_p_74775;\n            int64_t x_74783;\n            int32_t x_74784;\n            int64_t x_74785;\n            int64_t redout_75350;\n            int32_t redout_75351;\n            int64_t redout_75352;\n            \n            eta_p_74775 = mem_75628[(int64_t) 0];\n            redout_75350 = acc_74776;\n            redout_75351 = acc_74777;\n            redout_75352 = acc_74778;\n            for (int64_t i_75353 = 0; i_75353 < tile_sizze_74611; i_75353++) {\n                int64_t x_74786;\n                int32_t x_74787;\n                bool defunc_0_neq_res_74795;\n                bool defunc_0_neq_res_74796;\n                bool cond_f_res_74797;\n                bool y_74798;\n                bool cond_74799;\n                bool defunc_0_neq_res_74800;",
                                    "\n                bool defunc_0_neq_res_74801;\n                bool cond_t_res_f_res_74802;\n                bool y_74803;\n                bool cond_t_res_74804;\n                bool x_74805;\n                int64_t defunc_0_op_res_74806;\n                int32_t defunc_0_op_res_74807;\n                int64_t defunc_0_op_res_74808;\n                int64_t redout_tmp_76823;\n                int32_t redout_tmp_76824;\n                int64_t redout_tmp_76825;\n                \n                x_74786 = ((__local int64_t *) color_76538)[i_75353];\n                x_74787 = ((__local int32_t *) color_76537)[i_75353];\n                defunc_0_neq_res_74795 = redout_75351 == eta_p_74775;\n                defunc_0_neq_res_74796 = !defunc_0_neq_res_74795;\n                cond_f_res_74797 = slt64(redout_75350, (int64_t) 0);\n                y_74798 = defunc_0_neq_res_74795 && cond_f_res_74797;\n                cond_74799 = defunc_0_neq_res_74796 || y_74798;\n                defunc_0_neq_res_74800 = x_74787 == eta_p_74775;\n                defunc_0_neq_res_74801 = !defunc_0_neq_res_74800;\n                cond_t_res_f_res_74802 = slt64(x_74786, (int64_t) 0);\n                y_74803 = defunc_0_neq_res_74800 && cond_t_res_f_res_74802;\n                cond_t_res_74804 = defunc_0_neq_res_74801 || y_74803;\n                x_74805 = cond_74799 && cond_t_res_74804;\n                if (x_74805) {\n                    defunc_0_op_res_74806 = (int64_t) -1;\n                    defunc_0_op_res_74807 = eta_p_74775;\n                    defunc_0_op_res_74808 = (int64_t) 0;\n                } else {\n                    int64_t x_74788;\n                    int64_t defunc_0_op_res_f_res_74809;\n                    int32_t defunc_0_op_res_f_res_74810;\n                    int64_t defunc_0_op_res_f_res_74811;\n                    \n                    x_74788 = ((__local int64_t *) color_76536)[i_75353];\n                    if (cond_74799) {\n                        defunc_0_op_res_f_res_74809 = x_74786;\n          ", "              defunc_0_op_res_f_res_74810 = x_74787;\n                        defunc_0_op_res_f_res_74811 = x_74788;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74812;\n                        int64_t defunc_0_op_res_f_res_f_res_74813;\n                        int64_t defunc_0_op_res_f_res_f_res_74814;\n                        \n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74812 = redout_75351;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74812 = eta_p_74775;\n                        }\n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74813 = redout_75350;\n                            defunc_0_op_res_f_res_f_res_74814 = redout_75352;\n                        } else {\n                            int64_t min_res_74815;\n                            int64_t tmp_74816;\n                            \n                            min_res_74815 = smin64(x_74786, redout_75350);\n                            tmp_74816 = add64(x_74788, redout_75352);\n                            defunc_0_op_res_f_res_f_res_74813 = min_res_74815;\n                            defunc_0_op_res_f_res_f_res_74814 = tmp_74816;\n                        }\n                        defunc_0_op_res_f_res_74809 = defunc_0_op_res_f_res_f_res_74813;\n                        defunc_0_op_res_f_res_74810 = defunc_0_op_res_f_res_f_res_74812;\n                        defunc_0_op_res_f_res_74811 = defunc_0_op_res_f_res_f_res_74814;\n                    }\n                    defunc_0_op_res_74806 = defunc_0_op_res_f_res_74809;\n                    defunc_0_op_res_74807 = defunc_0_op_res_f_res_74810;\n                    defunc_0_op_res_74808 = defunc_0_op_res_f_res_74811;\n                }\n                redout_tmp_76823 = defunc_0_op_res_74806;\n                redout_tmp_76824 = defunc_0_op_res_74807;\n                redout_tmp_76825 = d", "efunc_0_op_res_74808;\n                redout_75350 = redout_tmp_76823;\n                redout_75351 = redout_tmp_76824;\n                redout_75352 = redout_tmp_76825;\n            }\n            x_74783 = redout_75350;\n            x_74784 = redout_75351;\n            x_74785 = redout_75352;\n            acc_74780 = x_74783;\n            acc_74781 = x_74784;\n            acc_74782 = x_74785;\n        } else {\n            acc_74780 = acc_74776;\n            acc_74781 = acc_74777;\n            acc_74782 = acc_74778;\n        }\n        mem_75653[(int64_t) 0] = acc_74780;\n        mem_75657[(int64_t) 0] = acc_74781;\n        mem_75661[(int64_t) 0] = acc_74782;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76817[i_6] = mem_75653[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76818[i_7] = mem_75657[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76819[i_8] = mem_75661[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75641[i_9] = mem_param_tmp_76817[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75642[i_10] = mem_param_tmp_76818[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75643[i_11] = mem_param_tmp_76819[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75664[i_12] = mem_param_75641[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75663[i_13] = mem_param_75642[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75662[i_14] = mem_param_75643[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74852) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75680[i_15] = ext_mem_75664[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75679[i_16] = ext_mem_75662[i_16];\n    } else {\n        int64_t ltid_flat_74854;\n        int64_t ltid_74853;\n        int64_t j_74869;\n        boo",
                                    "l cond_74873;\n        int64_t pre1d_74876;\n        int64_t pre1d_74874;\n        int32_t pre1d_74875;\n        int64_t ltid_flat_74890;\n        int64_t ltid_74889;\n        int64_t gtid_74903;\n        int64_t acc_74905;\n        int64_t acc_74907;\n        bool cond_74908;\n        int64_t acc_74909;\n        int64_t acc_74911;\n        \n        ltid_flat_74854 = sext_i32_i64(local_tid_76808);\n        ltid_74853 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74869 = ltid_74853 + binop_x_74868;\n        cond_74873 = slt64(j_74869, j_m_i_65502);\n        pre1d_74876 = btoi_bool_i64(cond_74873);\n        if (cond_74873) {\n            int64_t tile_elem_74877;\n            int64_t slice_75328;\n            int32_t tile_elem_74878;\n            \n            tile_elem_74877 = ((__global int64_t *) ext_mem_75562)[j_74869];\n            slice_75328 = slice_65911 + j_74869;\n            tile_elem_74878 = ((__global int32_t *) tS_mem_75468)[slice_75328];\n            pre1d_74874 = tile_elem_74877;\n            pre1d_74875 = tile_elem_74878;\n        } else {\n            pre1d_74874 = (int64_t) 0;\n            pre1d_74875 = 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74853] = pre1d_74874;\n        ((__local int32_t *) color_76537)[ltid_74853] = pre1d_74875;\n        ((__local int64_t *) color_76536)[ltid_74853] = pre1d_74876;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74890 = sext_i32_i64(local_tid_76808);\n        ltid_74889 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74903 = binop_x_74619 + ltid_74889;\n        acc_74905 = ext_mem_75664[(int64_t) 0];\n        acc_74907 = ext_mem_75662[(int64_t) 0];\n        cond_74908 = slt64(gtid_74903, min_res_65540);\n        if (cond_74908) {\n            int32_t eta_p_74904;\n            int32_t acc_74906;\n            int64_t x_74912;\n            int32_t x_74913;\n            int64_t x_74914;\n            int64_t redout_75354;\n            int32_t redout_75355;\n            int64_t redout_75356;\n            \n         ", "   eta_p_74904 = mem_75628[(int64_t) 0];\n            acc_74906 = ext_mem_75663[(int64_t) 0];\n            redout_75354 = acc_74905;\n            redout_75355 = acc_74906;\n            redout_75356 = acc_74907;\n            for (int64_t i_75357 = 0; i_75357 < residual_input_74851; i_75357++) {\n                int64_t x_74915;\n                int32_t x_74916;\n                bool defunc_0_neq_res_74924;\n                bool defunc_0_neq_res_74925;\n                bool cond_f_res_74926;\n                bool y_74927;\n                bool cond_74928;\n                bool defunc_0_neq_res_74929;\n                bool defunc_0_neq_res_74930;\n                bool cond_t_res_f_res_74931;\n                bool y_74932;\n                bool cond_t_res_74933;\n                bool x_74934;\n                int64_t defunc_0_op_res_74935;\n                int32_t defunc_0_op_res_74936;\n                int64_t defunc_0_op_res_74937;\n                int64_t redout_tmp_76826;\n                int32_t redout_tmp_76827;\n                int64_t redout_tmp_76828;\n                \n                x_74915 = ((__local int64_t *) color_76538)[i_75357];\n                x_74916 = ((__local int32_t *) color_76537)[i_75357];\n                defunc_0_neq_res_74924 = redout_75355 == eta_p_74904;\n                defunc_0_neq_res_74925 = !defunc_0_neq_res_74924;\n                cond_f_res_74926 = slt64(redout_75354, (int64_t) 0);\n                y_74927 = defunc_0_neq_res_74924 && cond_f_res_74926;\n                cond_74928 = defunc_0_neq_res_74925 || y_74927;\n                defunc_0_neq_res_74929 = x_74916 == eta_p_74904;\n                defunc_0_neq_res_74930 = !defunc_0_neq_res_74929;\n                cond_t_res_f_res_74931 = slt64(x_74915, (int64_t) 0);\n                y_74932 = defunc_0_neq_res_74929 && cond_t_res_f_res_74931;\n                cond_t_res_74933 = defunc_0_neq_res_74930 || y_74932;\n                x_74934 = cond_74928 && cond_t_res_74933;\n                if (x_74934) {\n                   ", " defunc_0_op_res_74935 = (int64_t) -1;\n                    defunc_0_op_res_74936 = eta_p_74904;\n                    defunc_0_op_res_74937 = (int64_t) 0;\n                } else {\n                    int64_t x_74917;\n                    int64_t defunc_0_op_res_f_res_74938;\n                    int32_t defunc_0_op_res_f_res_74939;\n                    int64_t defunc_0_op_res_f_res_74940;\n                    \n                    x_74917 = ((__local int64_t *) color_76536)[i_75357];\n                    if (cond_74928) {\n                        defunc_0_op_res_f_res_74938 = x_74915;\n                        defunc_0_op_res_f_res_74939 = x_74916;\n                        defunc_0_op_res_f_res_74940 = x_74917;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_74941;\n                        int64_t defunc_0_op_res_f_res_f_res_74942;\n                        int64_t defunc_0_op_res_f_res_f_res_74943;\n                        \n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74941 = redout_75355;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74941 = eta_p_74904;\n                        }\n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74942 = redout_75354;\n                            defunc_0_op_res_f_res_f_res_74943 = redout_75356;\n                        } else {\n                            int64_t min_res_74944;\n                            int64_t tmp_74945;\n                            \n                            min_res_74944 = smin64(x_74915, redout_75354);\n                            tmp_74945 = add64(x_74917, redout_75356);\n                            defunc_0_op_res_f_res_f_res_74942 = min_res_74944;\n                            defunc_0_op_res_f_res_f_res_74943 = tmp_74945;\n                        }\n                        defunc_0_op_res_f_res_74938 = defunc_0_op_res_f_res_f_res_7494",
                                    "2;\n                        defunc_0_op_res_f_res_74939 = defunc_0_op_res_f_res_f_res_74941;\n                        defunc_0_op_res_f_res_74940 = defunc_0_op_res_f_res_f_res_74943;\n                    }\n                    defunc_0_op_res_74935 = defunc_0_op_res_f_res_74938;\n                    defunc_0_op_res_74936 = defunc_0_op_res_f_res_74939;\n                    defunc_0_op_res_74937 = defunc_0_op_res_f_res_74940;\n                }\n                redout_tmp_76826 = defunc_0_op_res_74935;\n                redout_tmp_76827 = defunc_0_op_res_74936;\n                redout_tmp_76828 = defunc_0_op_res_74937;\n                redout_75354 = redout_tmp_76826;\n                redout_75355 = redout_tmp_76827;\n                redout_75356 = redout_tmp_76828;\n            }\n            x_74912 = redout_75354;\n            x_74913 = redout_75355;\n            x_74914 = redout_75356;\n            acc_74909 = x_74912;\n            acc_74911 = x_74914;\n        } else {\n            acc_74909 = acc_74905;\n            acc_74911 = acc_74907;\n        }\n        mem_75674[(int64_t) 0] = acc_74909;\n        mem_75678[(int64_t) 0] = acc_74911;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75680[i_17] = mem_75674[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75679[i_18] = mem_75678[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76829 = ext_mem_75680[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75682)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76829;\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76830 = ext_mem_75679[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75684)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = t", "mp_76830;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74611\n    #undef bytes_75644\n    #undef bytes_75646\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegmap_intrablock_74964_dim1, 1, 1)\nvoid inner_SMJ_intzisegmap_intrablock_74964(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74967, int64_t num_whole_tiles_74982, int64_t residual_input_75206, unsigned char cond_75207_bits, int64_t binop_x_75223, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75621, __global unsigned char *mem_75623)\n{\n    bool cond_75207 = cond_75207_bits;\n    \n    #define tile_sizze_74966 (inner_SMJ_intzisegmap_intrablock_74964zitile_sizze_74966)\n    #define bytes_75583 (inner_SMJ_intzisegmap_intrablock_74964zibytes_75583)\n    #define bytes_75585 (inner_SMJ_intzisegmap_intrablock_74964zibytes_75585)\n    \n    volatile __local unsigned char *color_76541_backing_2 = &shared_mem[0];\n    const int64_t color_76541_backing_2_offset = 0 + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76540_backing_1 = &shared_mem[color_76541_backing_2_offset];\n    const int64_t color_76540_backing_1_offset = color_76541_backing_2_offset + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76539_backing_0 = &shared_mem[color_76540_backing_1_offset];\n    const int64_t color_76539_backing_0_offset = color_76540_backing_1_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76834;\n    int32_t tblock_sizze_76837;\n    int32_t wave_sizze_76836;\n    int32_t block_id_76835;\n    int32_t global_tid_76833;\n    int64_t gid_flat_74964;\n    int64_t slice_76839;\n    int64_t ltid_pre_7683", "8;\n    int64_t remnant_76840;\n    int64_t slice_76841;\n    int64_t gid_74963;\n    int64_t remnant_76842;\n    __local unsigned char *color_76539;\n    __local unsigned char *color_76540;\n    __local unsigned char *color_76541;\n    int64_t binop_x_74974;\n    int32_t mem_75567[1];\n    int64_t ltid_flat_74969;\n    int64_t ltid_74968;\n    int64_t gtid_74975;\n    bool cond_74976;\n    int32_t pre_74977;\n    int64_t mem_75571[1];\n    int32_t mem_75575[1];\n    int64_t mem_75579[1];\n    int64_t ltid_flat_74984;\n    int64_t ltid_74983;\n    int64_t gtid_74994;\n    bool cond_74995;\n    int64_t neutral_74996;\n    int32_t neutral_74997;\n    int64_t ext_mem_75603[1];\n    int32_t ext_mem_75602[1];\n    int64_t ext_mem_75601[1];\n    int64_t mem_param_75580[1];\n    int32_t mem_param_75581[1];\n    int64_t mem_param_75582[1];\n    int64_t mem_75613[1];\n    int64_t mem_75617[1];\n    int64_t ext_mem_75619[1];\n    int64_t ext_mem_75618[1];\n    \n    local_tid_76834 = get_local_id(0);\n    tblock_sizze_76837 = get_local_size(0);\n    wave_sizze_76836 = LOCKSTEP_WIDTH;\n    block_id_76835 = get_tblock_id(0);\n    global_tid_76833 = block_id_76835 * tblock_sizze_76837 + local_tid_76834;\n    gid_flat_74964 = sext_i32_i64(block_id_76835);\n    slice_76839 = tile_sizze_74966;\n    ltid_pre_76838 = sext_i32_i64(local_tid_76834);\n    remnant_76840 = sext_i32_i64(local_tid_76834) - ltid_pre_76838;\n    slice_76841 = ldim_74967;\n    gid_74963 = sext_i32_i64(block_id_76835);\n    remnant_76842 = sext_i32_i64(block_id_76835) - gid_74963;\n    color_76539 = (__local unsigned char *) color_76539_backing_0;\n    color_76540 = (__local unsigned char *) color_76540_backing_1;\n    color_76541 = (__local unsigned char *) color_76541_backing_2;\n    binop_x_74974 = gid_74963 * tile_sizze_74966;\n    ltid_flat_74969 = sext_i32_i64(local_tid_76834);\n    ltid_74968 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74975 = ltid_74968 + binop_x_74974;\n    cond_74976 = slt64(gtid_74975, min_res_65540);\n    if (cond_74976) {\n ",
                                    "       int64_t slice_74978;\n        int32_t eta_p_74979;\n        \n        slice_74978 = slice_65554 + gtid_74975;\n        eta_p_74979 = ((__global int32_t *) tR_mem_75467)[slice_74978];\n        pre_74977 = eta_p_74979;\n    } else {\n        pre_74977 = 0;\n    }\n    mem_75567[(int64_t) 0] = pre_74977;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74984 = sext_i32_i64(local_tid_76834);\n    ltid_74983 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74994 = binop_x_74974 + ltid_74983;\n    cond_74995 = slt64(gtid_74994, min_res_65540);\n    if (cond_74995) {\n        neutral_74996 = (int64_t) -1;\n    } else {\n        neutral_74996 = (int64_t) 0;\n    }\n    if (cond_74995) {\n        int32_t eta_p_74999 = mem_75567[(int64_t) 0];\n        \n        neutral_74997 = eta_p_74999;\n    } else {\n        neutral_74997 = 0;\n    }\n    mem_75571[(int64_t) 0] = neutral_74996;\n    mem_75575[(int64_t) 0] = neutral_74997;\n    mem_75579[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75580[i_3] = mem_75571[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75581[i_4] = mem_75575[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75582[i_5] = mem_75579[i_5];\n    for (int64_t tile_id_75009 = 0; tile_id_75009 < num_whole_tiles_74982; tile_id_75009++) {\n        int64_t binop_x_75108;\n        int64_t ltid_flat_75107;\n        int64_t ltid_75106;\n        int64_t j_75109;\n        bool cond_75113;\n        int64_t pre1d_75116;\n        int64_t pre1d_75114;\n        int32_t pre1d_75115;\n        int64_t mem_75592[1];\n        int32_t mem_75596[1];\n        int64_t mem_75600[1];\n        int64_t ltid_flat_75127;\n        int64_t ltid_75126;\n        int64_t gtid_75129;\n        int64_t acc_75131;\n        int32_t acc_75132;\n        int64_t acc_75133;\n        bool cond_75134;\n        int64_t acc_75135;\n        int32_t acc_75136;\n        int64_t acc_75137;\n        int64_t m", "em_param_tmp_76843[1];\n        int32_t mem_param_tmp_76844[1];\n        int64_t mem_param_tmp_76845[1];\n        \n        binop_x_75108 = tile_sizze_74966 * tile_id_75009;\n        ltid_flat_75107 = sext_i32_i64(local_tid_76834);\n        ltid_75106 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75109 = ltid_75106 + binop_x_75108;\n        cond_75113 = slt64(j_75109, j_m_i_65502);\n        pre1d_75116 = btoi_bool_i64(cond_75113);\n        if (cond_75113) {\n            int64_t tile_elem_75117;\n            int64_t slice_75333;\n            int32_t tile_elem_75118;\n            \n            tile_elem_75117 = ((__global int64_t *) ext_mem_75562)[j_75109];\n            slice_75333 = slice_65911 + j_75109;\n            tile_elem_75118 = ((__global int32_t *) tS_mem_75468)[slice_75333];\n            pre1d_75114 = tile_elem_75117;\n            pre1d_75115 = tile_elem_75118;\n        } else {\n            pre1d_75114 = (int64_t) 0;\n            pre1d_75115 = 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75106] = pre1d_75114;\n        ((__local int32_t *) color_76540)[ltid_75106] = pre1d_75115;\n        ((__local int64_t *) color_76539)[ltid_75106] = pre1d_75116;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75127 = sext_i32_i64(local_tid_76834);\n        ltid_75126 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75129 = binop_x_74974 + ltid_75126;\n        acc_75131 = mem_param_75580[(int64_t) 0];\n        acc_75132 = mem_param_75581[(int64_t) 0];\n        acc_75133 = mem_param_75582[(int64_t) 0];\n        cond_75134 = slt64(gtid_75129, min_res_65540);\n        if (cond_75134) {\n            int32_t eta_p_75130;\n            int64_t x_75138;\n            int32_t x_75139;\n            int64_t x_75140;\n            int64_t redout_75358;\n            int32_t redout_75359;\n            int64_t redout_75360;\n            \n            eta_p_75130 = mem_75567[(int64_t) 0];\n            redout_75358 = acc_75131;\n            redout_75359 = acc_75132;\n            redout_753", "60 = acc_75133;\n            for (int64_t i_75361 = 0; i_75361 < tile_sizze_74966; i_75361++) {\n                int64_t x_75141;\n                int32_t x_75142;\n                bool defunc_0_neq_res_75150;\n                bool defunc_0_neq_res_75151;\n                bool cond_f_res_75152;\n                bool y_75153;\n                bool cond_75154;\n                bool defunc_0_neq_res_75155;\n                bool defunc_0_neq_res_75156;\n                bool cond_t_res_f_res_75157;\n                bool y_75158;\n                bool cond_t_res_75159;\n                bool x_75160;\n                int64_t defunc_0_op_res_75161;\n                int32_t defunc_0_op_res_75162;\n                int64_t defunc_0_op_res_75163;\n                int64_t redout_tmp_76849;\n                int32_t redout_tmp_76850;\n                int64_t redout_tmp_76851;\n                \n                x_75141 = ((__local int64_t *) color_76541)[i_75361];\n                x_75142 = ((__local int32_t *) color_76540)[i_75361];\n                defunc_0_neq_res_75150 = redout_75359 == eta_p_75130;\n                defunc_0_neq_res_75151 = !defunc_0_neq_res_75150;\n                cond_f_res_75152 = slt64(redout_75358, (int64_t) 0);\n                y_75153 = defunc_0_neq_res_75150 && cond_f_res_75152;\n                cond_75154 = defunc_0_neq_res_75151 || y_75153;\n                defunc_0_neq_res_75155 = x_75142 == eta_p_75130;\n                defunc_0_neq_res_75156 = !defunc_0_neq_res_75155;\n                cond_t_res_f_res_75157 = slt64(x_75141, (int64_t) 0);\n                y_75158 = defunc_0_neq_res_75155 && cond_t_res_f_res_75157;\n                cond_t_res_75159 = defunc_0_neq_res_75156 || y_75158;\n                x_75160 = cond_75154 && cond_t_res_75159;\n                if (x_75160) {\n                    defunc_0_op_res_75161 = (int64_t) -1;\n                    defunc_0_op_res_75162 = eta_p_75130;\n                    defunc_0_op_res_75163 = (int64_t) 0;\n                } else {\n                 ",
                                    "   int64_t x_75143;\n                    int64_t defunc_0_op_res_f_res_75164;\n                    int32_t defunc_0_op_res_f_res_75165;\n                    int64_t defunc_0_op_res_f_res_75166;\n                    \n                    x_75143 = ((__local int64_t *) color_76539)[i_75361];\n                    if (cond_75154) {\n                        defunc_0_op_res_f_res_75164 = x_75141;\n                        defunc_0_op_res_f_res_75165 = x_75142;\n                        defunc_0_op_res_f_res_75166 = x_75143;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_75167;\n                        int64_t defunc_0_op_res_f_res_f_res_75168;\n                        int64_t defunc_0_op_res_f_res_f_res_75169;\n                        \n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75167 = redout_75359;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75167 = eta_p_75130;\n                        }\n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75168 = redout_75358;\n                            defunc_0_op_res_f_res_f_res_75169 = redout_75360;\n                        } else {\n                            int64_t min_res_75170;\n                            int64_t tmp_75171;\n                            \n                            min_res_75170 = smin64(x_75141, redout_75358);\n                            tmp_75171 = add64(x_75143, redout_75360);\n                            defunc_0_op_res_f_res_f_res_75168 = min_res_75170;\n                            defunc_0_op_res_f_res_f_res_75169 = tmp_75171;\n                        }\n                        defunc_0_op_res_f_res_75164 = defunc_0_op_res_f_res_f_res_75168;\n                        defunc_0_op_res_f_res_75165 = defunc_0_op_res_f_res_f_res_75167;\n                        defunc_0_op_res_f_res_75166 = defunc_0_op_res_f_res_f_res_75169;\n              ", "      }\n                    defunc_0_op_res_75161 = defunc_0_op_res_f_res_75164;\n                    defunc_0_op_res_75162 = defunc_0_op_res_f_res_75165;\n                    defunc_0_op_res_75163 = defunc_0_op_res_f_res_75166;\n                }\n                redout_tmp_76849 = defunc_0_op_res_75161;\n                redout_tmp_76850 = defunc_0_op_res_75162;\n                redout_tmp_76851 = defunc_0_op_res_75163;\n                redout_75358 = redout_tmp_76849;\n                redout_75359 = redout_tmp_76850;\n                redout_75360 = redout_tmp_76851;\n            }\n            x_75138 = redout_75358;\n            x_75139 = redout_75359;\n            x_75140 = redout_75360;\n            acc_75135 = x_75138;\n            acc_75136 = x_75139;\n            acc_75137 = x_75140;\n        } else {\n            acc_75135 = acc_75131;\n            acc_75136 = acc_75132;\n            acc_75137 = acc_75133;\n        }\n        mem_75592[(int64_t) 0] = acc_75135;\n        mem_75596[(int64_t) 0] = acc_75136;\n        mem_75600[(int64_t) 0] = acc_75137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76843[i_6] = mem_75592[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76844[i_7] = mem_75596[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76845[i_8] = mem_75600[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75580[i_9] = mem_param_tmp_76843[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75581[i_10] = mem_param_tmp_76844[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75582[i_11] = mem_param_tmp_76845[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75603[i_12] = mem_param_75580[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75602[i_13] = mem_param_75581[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75601[i_14] = ", "mem_param_75582[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_75207) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75619[i_15] = ext_mem_75603[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75618[i_16] = ext_mem_75601[i_16];\n    } else {\n        int64_t ltid_flat_75209;\n        int64_t ltid_75208;\n        int64_t j_75224;\n        bool cond_75228;\n        int64_t pre1d_75231;\n        int64_t pre1d_75229;\n        int32_t pre1d_75230;\n        int64_t ltid_flat_75245;\n        int64_t ltid_75244;\n        int64_t gtid_75258;\n        int64_t acc_75260;\n        int64_t acc_75262;\n        bool cond_75263;\n        int64_t acc_75264;\n        int64_t acc_75266;\n        \n        ltid_flat_75209 = sext_i32_i64(local_tid_76834);\n        ltid_75208 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75224 = ltid_75208 + binop_x_75223;\n        cond_75228 = slt64(j_75224, j_m_i_65502);\n        pre1d_75231 = btoi_bool_i64(cond_75228);\n        if (cond_75228) {\n            int64_t tile_elem_75232;\n            int64_t slice_75332;\n            int32_t tile_elem_75233;\n            \n            tile_elem_75232 = ((__global int64_t *) ext_mem_75562)[j_75224];\n            slice_75332 = slice_65911 + j_75224;\n            tile_elem_75233 = ((__global int32_t *) tS_mem_75468)[slice_75332];\n            pre1d_75229 = tile_elem_75232;\n            pre1d_75230 = tile_elem_75233;\n        } else {\n            pre1d_75229 = (int64_t) 0;\n            pre1d_75230 = 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75208] = pre1d_75229;\n        ((__local int32_t *) color_76540)[ltid_75208] = pre1d_75230;\n        ((__local int64_t *) color_76539)[ltid_75208] = pre1d_75231;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75245 = sext_i32_i64(local_tid_76834);\n        ltid_75244 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75258 = binop_x_74974 + ltid_75244;\n        acc_75260 = ext_mem_75603[(int64_t) 0];\n       ",
                                    " acc_75262 = ext_mem_75601[(int64_t) 0];\n        cond_75263 = slt64(gtid_75258, min_res_65540);\n        if (cond_75263) {\n            int32_t eta_p_75259;\n            int32_t acc_75261;\n            int64_t x_75267;\n            int32_t x_75268;\n            int64_t x_75269;\n            int64_t redout_75362;\n            int32_t redout_75363;\n            int64_t redout_75364;\n            \n            eta_p_75259 = mem_75567[(int64_t) 0];\n            acc_75261 = ext_mem_75602[(int64_t) 0];\n            redout_75362 = acc_75260;\n            redout_75363 = acc_75261;\n            redout_75364 = acc_75262;\n            for (int64_t i_75365 = 0; i_75365 < residual_input_75206; i_75365++) {\n                int64_t x_75270;\n                int32_t x_75271;\n                bool defunc_0_neq_res_75279;\n                bool defunc_0_neq_res_75280;\n                bool cond_f_res_75281;\n                bool y_75282;\n                bool cond_75283;\n                bool defunc_0_neq_res_75284;\n                bool defunc_0_neq_res_75285;\n                bool cond_t_res_f_res_75286;\n                bool y_75287;\n                bool cond_t_res_75288;\n                bool x_75289;\n                int64_t defunc_0_op_res_75290;\n                int32_t defunc_0_op_res_75291;\n                int64_t defunc_0_op_res_75292;\n                int64_t redout_tmp_76852;\n                int32_t redout_tmp_76853;\n                int64_t redout_tmp_76854;\n                \n                x_75270 = ((__local int64_t *) color_76541)[i_75365];\n                x_75271 = ((__local int32_t *) color_76540)[i_75365];\n                defunc_0_neq_res_75279 = redout_75363 == eta_p_75259;\n                defunc_0_neq_res_75280 = !defunc_0_neq_res_75279;\n                cond_f_res_75281 = slt64(redout_75362, (int64_t) 0);\n                y_75282 = defunc_0_neq_res_75279 && cond_f_res_75281;\n                cond_75283 = defunc_0_neq_res_75280 || y_75282;\n                defunc_0_neq_res_75284 = x_75271 == eta_p_", "75259;\n                defunc_0_neq_res_75285 = !defunc_0_neq_res_75284;\n                cond_t_res_f_res_75286 = slt64(x_75270, (int64_t) 0);\n                y_75287 = defunc_0_neq_res_75284 && cond_t_res_f_res_75286;\n                cond_t_res_75288 = defunc_0_neq_res_75285 || y_75287;\n                x_75289 = cond_75283 && cond_t_res_75288;\n                if (x_75289) {\n                    defunc_0_op_res_75290 = (int64_t) -1;\n                    defunc_0_op_res_75291 = eta_p_75259;\n                    defunc_0_op_res_75292 = (int64_t) 0;\n                } else {\n                    int64_t x_75272;\n                    int64_t defunc_0_op_res_f_res_75293;\n                    int32_t defunc_0_op_res_f_res_75294;\n                    int64_t defunc_0_op_res_f_res_75295;\n                    \n                    x_75272 = ((__local int64_t *) color_76539)[i_75365];\n                    if (cond_75283) {\n                        defunc_0_op_res_f_res_75293 = x_75270;\n                        defunc_0_op_res_f_res_75294 = x_75271;\n                        defunc_0_op_res_f_res_75295 = x_75272;\n                    } else {\n                        int32_t defunc_0_op_res_f_res_f_res_75296;\n                        int64_t defunc_0_op_res_f_res_f_res_75297;\n                        int64_t defunc_0_op_res_f_res_f_res_75298;\n                        \n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75296 = redout_75363;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75296 = eta_p_75259;\n                        }\n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75297 = redout_75362;\n                            defunc_0_op_res_f_res_f_res_75298 = redout_75364;\n                        } else {\n                            int64_t min_res_75299;\n                            int64_t tmp_75300;\n                            \n              ", "              min_res_75299 = smin64(x_75270, redout_75362);\n                            tmp_75300 = add64(x_75272, redout_75364);\n                            defunc_0_op_res_f_res_f_res_75297 = min_res_75299;\n                            defunc_0_op_res_f_res_f_res_75298 = tmp_75300;\n                        }\n                        defunc_0_op_res_f_res_75293 = defunc_0_op_res_f_res_f_res_75297;\n                        defunc_0_op_res_f_res_75294 = defunc_0_op_res_f_res_f_res_75296;\n                        defunc_0_op_res_f_res_75295 = defunc_0_op_res_f_res_f_res_75298;\n                    }\n                    defunc_0_op_res_75290 = defunc_0_op_res_f_res_75293;\n                    defunc_0_op_res_75291 = defunc_0_op_res_f_res_75294;\n                    defunc_0_op_res_75292 = defunc_0_op_res_f_res_75295;\n                }\n                redout_tmp_76852 = defunc_0_op_res_75290;\n                redout_tmp_76853 = defunc_0_op_res_75291;\n                redout_tmp_76854 = defunc_0_op_res_75292;\n                redout_75362 = redout_tmp_76852;\n                redout_75363 = redout_tmp_76853;\n                redout_75364 = redout_tmp_76854;\n            }\n            x_75267 = redout_75362;\n            x_75268 = redout_75363;\n            x_75269 = redout_75364;\n            acc_75264 = x_75267;\n            acc_75266 = x_75269;\n        } else {\n            acc_75264 = acc_75260;\n            acc_75266 = acc_75262;\n        }\n        mem_75613[(int64_t) 0] = acc_75264;\n        mem_75617[(int64_t) 0] = acc_75266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75619[i_17] = mem_75613[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75618[i_18] = mem_75617[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76855 = ext_mem_75619[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75621)[sext_i",
                                    "32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76855;\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76856 = ext_mem_75618[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75623)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76856;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74966\n    #undef bytes_75583\n    #undef bytes_75585\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_intzisegscan_69877_dim1, 1, 1)\nvoid inner_SMJ_intzisegscan_69877(__global int *global_failure, int64_t nR_42219, int64_t num_tblocks_69874, int64_t num_virt_blocks_76924, int64_t num_virt_threads_76925, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *status_flags_mem_76926, __global unsigned char *aggregates_mem_76948, __global unsigned char *incprefixes_mem_76950, __global unsigned char *global_dynid_mem_76952)\n{\n    #define segscan_tblock_sizze_69872 (inner_SMJ_intzisegscan_69877zisegscan_tblock_sizze_69872)\n    #define chunk_sizze_76923 (inner_SMJ_intzisegscan_69877zichunk_sizze_76923)\n    \n    volatile __local unsigned char *local_mem_76962_backing_0 = &shared_mem[0];\n    const int64_t local_mem_76962_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69872), chunk_sizze_76923 * segscan_tblock_sizze_69872 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69872), chunk_sizze_76923 * segscan_tblock_sizze_69872 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76955;\n    int32_t tblock_sizze_76958;\n    int32_t wave_sizze_76957;\n    int32_t block_id_76956;\n    int32_t global_tid_76954;\n    int64_t phys_tid_69877;\n    int32_t chunk_sizze_32b_76959;\n    int64_t byte_offsets_76960;\n", "    int64_t warp_byte_offset_76961;\n    __local unsigned char *local_mem_76962;\n    int64_t trans_arr_len_76963;\n    int64_t phys_block_id_76969;\n    int64_t virtloop_bound_76970;\n    \n    local_tid_76955 = get_local_id(0);\n    tblock_sizze_76958 = get_local_size(0);\n    wave_sizze_76957 = LOCKSTEP_WIDTH;\n    block_id_76956 = get_tblock_id(0);\n    global_tid_76954 = block_id_76956 * tblock_sizze_76958 + local_tid_76955;\n    phys_tid_69877 = sext_i32_i64(global_tid_76954);\n    chunk_sizze_32b_76959 = sext_i64_i32(chunk_sizze_76923);\n    byte_offsets_76960 = segscan_tblock_sizze_69872 * (int64_t) 8;\n    warp_byte_offset_76961 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_76962 = (__local unsigned char *) local_mem_76962_backing_0;\n    trans_arr_len_76963 = chunk_sizze_76923 * segscan_tblock_sizze_69872;\n    phys_block_id_76969 = get_tblock_id(0);\n    virtloop_bound_76970 = sdiv_up64(num_virt_blocks_76924 - phys_block_id_76969, num_tblocks_69874);\n    for (int64_t virtloop_i_76971 = 0; virtloop_i_76971 < virtloop_bound_76970; virtloop_i_76971++) {\n        int64_t dynamic_id_76972;\n        int64_t block_offset_76973;\n        int64_t sgm_idx_76974;\n        int32_t boundary_76975;\n        int32_t segsizze_compact_76976;\n        int64_t private_mem_76977[chunk_sizze_76923];\n        int64_t thd_offset_76979;\n        int64_t acc_76995;\n        int64_t prefix_77005;\n        bool block_new_sgm_77006;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_76955 == 0) {\n                dynamic_id_76972 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_76952)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_76962)[(int64_t) 0] = dynamic_id_76972;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if ", "(dynamic_id_76972 == num_virt_blocks_76924 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_76952)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_76972 = ((__local int32_t *) local_mem_76962)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_76973 = dynamic_id_76972 * chunk_sizze_76923 * segscan_tblock_sizze_69872;\n        sgm_idx_76974 = smod64(block_offset_76973, nR_42219);\n        boundary_76975 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_69872, nR_42219 - sgm_idx_76974));\n        segsizze_compact_76976 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_69872, nR_42219));\n        thd_offset_76979 = block_offset_76973 + sext_i32_i64(local_tid_76955);\n        // Load and map\n        {\n            for (int64_t i_76980 = 0; i_76980 < chunk_sizze_76923; i_76980++) {\n                int64_t virt_tid_76981 = thd_offset_76979 + i_76980 * segscan_tblock_sizze_69872;\n                int64_t slice_76982 = nR_42219;\n                int64_t gtid_69876 = virt_tid_76981;\n                int64_t remnant_76983 = virt_tid_76981 - gtid_69876;\n                \n                if (slt64(virt_tid_76981, nR_42219)) {\n                    int64_t eta_p_65962 = ((__global int64_t *) ext_mem_75938)[gtid_69876];\n                    bool lifted_lambda_res_65963 = slt64((int64_t) 0, eta_p_65962);\n                    int64_t defunc_0_f_res_65964 = btoi_bool_i64(lifted_lambda_res_65963);\n                    \n                    ((__global int64_t *) mem_75943)[gtid_69876] = defunc_0_f_res_65964;\n                    private_mem_76977[i_76980] = defunc_0_f_res_65964;\n                } else {\n                    private_mem_76977[i_76980] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_76984 = 0; i_76984 < ch",
                                    "unk_sizze_76923; i_76984++) {\n                int64_t sharedIdx_76985 = sext_i32_i64(local_tid_76955) + i_76984 * segscan_tblock_sizze_69872;\n                int64_t tmp_76986 = private_mem_76977[i_76984];\n                \n                ((__local int64_t *) local_mem_76962)[sharedIdx_76985] = tmp_76986;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_76987 = 0; i_76987 < chunk_sizze_76923; i_76987++) {\n                int64_t sharedIdx_76988 = sext_i32_i64(local_tid_76955) * chunk_sizze_76923 + i_76987;\n                int64_t tmp_76989 = ((__local int64_t *) local_mem_76962)[sharedIdx_76988];\n                \n                private_mem_76977[i_76987] = tmp_76989;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_76990 = 0; i_76990 < chunk_sizze_76923 - (int64_t) 1; i_76990++) {\n                int64_t eta_p_65673;\n                int64_t eta_p_65674;\n                \n                eta_p_65673 = private_mem_76977[i_76990];\n                eta_p_65674 = private_mem_76977[i_76990 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_65675 = add64(eta_p_65673, eta_p_65674);\n                \n                private_mem_76977[i_76990 + (int64_t) 1] = defunc_0_op_res_65675;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_76991 = private_mem_76977[chunk_sizze_76923 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = tmp_76991;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_76992;\n            int64_t eta_p_76993;\n            int64_t eta_p_76996;\n            int64_t eta_p_76997;\n            bool ltid_in_bounds_76999 = slt64(sext_i32_i64(local_tid_76955), num_virt_threads_76925);\n            int32_t skip_threads_77000;\n            \n            // ", "read input for in-block scan\n            {\n                if (ltid_in_bounds_76999) {\n                    eta_p_76993 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                    if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                        eta_p_76992 = eta_p_76993;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77000 = 1;\n                while (slt32(skip_threads_77000, 32)) {\n                    bool thread_active_77001 = sle32(skip_threads_77000, local_tid_76955 - squot32(local_tid_76955, 32) * 32) && ltid_in_bounds_76999;\n                    \n                    if (thread_active_77001) {\n                        // read operands\n                        {\n                            eta_p_76992 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77000)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77001) {\n                            int64_t defunc_0_op_res_76994 = add64(eta_p_76992, eta_p_76993);\n                            \n                            eta_p_76992 = defunc_0_op_res_76994;\n                        }\n                    }\n                    if (sle32(wave_sizze_76957, skip_threads_77000)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77001) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76992;\n                            eta_p_76993 = eta_p_76992;\n                        }\n                    }\n                    if (sle32(wave_sizze_76957, skip_threads_77000)) {\n                        barrier(CLK_LOCAL_MEM", "_FENCE);\n                    }\n                    skip_threads_77000 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 31 && ltid_in_bounds_76999) {\n                    ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(squot32(local_tid_76955, 32))] = eta_p_76992;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77002;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999) {\n                        eta_p_76997 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                        if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                            eta_p_76996 = eta_p_76997;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77002 = 1;\n                    while (slt32(skip_threads_77002, 32)) {\n                        bool thread_active_77003 = sle32(skip_threads_77002, local_tid_76955 - squot32(local_tid_76955, 32) * 32) && (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999);\n                        \n                        if (thread_active_77003) {\n                            // read operands\n                            {\n                                eta_p_76996 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77002)];\n                            }\n                        }\n                        // perform operation\n                 ",
                                    "       {\n                            if (thread_active_77003) {\n                                int64_t defunc_0_op_res_76998 = add64(eta_p_76996, eta_p_76997);\n                                \n                                eta_p_76996 = defunc_0_op_res_76998;\n                            }\n                        }\n                        if (sle32(wave_sizze_76957, skip_threads_77002)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77003) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76996;\n                                eta_p_76997 = eta_p_76996;\n                            }\n                        }\n                        if (sle32(wave_sizze_76957, skip_threads_77002)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77002 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77004 = squot32(local_tid_76955, 32) == 0 || !ltid_in_bounds_76999;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77004) {\n                        eta_p_76993 = eta_p_76992;\n                        eta_p_76992 = ((__local int64_t *) local_mem_76962)[sext_i32_i64(squot32(local_tid_76955, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77004) {\n                        int64_t defunc_0_op_res_76994 = add64(eta_p_76992, eta_p_76993);\n                        \n                        eta_p_76992 = defunc_0_op_res_76994;\n                    }\n                }\n                // w", "rite final result\n                {\n                    if (!no_carry_in_77004) {\n                        ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76992;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999) {\n                    ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76993;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_76955 == 0) {\n                acc_76995 = ((__local int64_t *) local_mem_76962)[segscan_tblock_sizze_69872 - (int64_t) 1];\n            } else {\n                acc_76995 = ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77005 = (int64_t) 0;\n        block_new_sgm_77006 = sgm_idx_76974 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77006 && local_tid_76955 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76972] = acc_76995;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76972] = (int8_t) 2;\n                acc_76995 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77006 && slt32(local_tid_76955, wave_sizze_76957)) {\n                if (local_tid_76955 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_76948)[dynamic_id_76972] = acc_76995;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76972] = (int8_t) 1;\n                    \n                    int8_t tmp_77007 = ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_769", "72 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_76962)[(int64_t) 0] = tmp_77007;\n                }\n                mem_fence_local();\n                \n                int8_t status_77008 = ((__local int8_t *) local_mem_76962)[(int64_t) 0];\n                \n                if (status_77008 == (int8_t) 2) {\n                    if (local_tid_76955 == 0) {\n                        prefix_77005 = ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76972 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77009 = sext_i64_i32(dynamic_id_76972 - sext_i32_i64(wave_sizze_76957));\n                    \n                    while (slt32(wave_sizze_76957 * -1, readOffset_77009)) {\n                        int32_t read_i_77010 = readOffset_77009 + local_tid_76955;\n                        int64_t aggr_77011 = (int64_t) 0;\n                        int8_t flag_77012 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77010)) {\n                            flag_77012 = ((volatile __global int8_t *) status_flags_mem_76926)[sext_i32_i64(read_i_77010)];\n                            if (flag_77012 == (int8_t) 2) {\n                                aggr_77011 = ((volatile __global int64_t *) incprefixes_mem_76950)[sext_i32_i64(read_i_77010)];\n                            } else if (flag_77012 == (int8_t) 1) {\n                                aggr_77011 = ((volatile __global int64_t *) aggregates_mem_76948)[sext_i32_i64(read_i_77010)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)] = aggr_77011;\n                        ((__local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = flag_77012;\n                        flag_77012 = ((__local int8_t *) local_mem_76962)[sext_i32_i64(wave_sizze_76957) - (int64_t) 1];\n                        i",
                                    "f (slt8(flag_77012, (int8_t) 2)) {\n                            int8_t flg_x_77016;\n                            int8_t flg_y_77017;\n                            int64_t eta_p_77013;\n                            int64_t eta_p_77014;\n                            int32_t skip_threads_77018;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77017 = ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                                eta_p_77014 = ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)];\n                                if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                                    eta_p_77013 = eta_p_77014;\n                                    flg_x_77016 = flg_y_77017;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77018 = 1;\n                                while (slt32(skip_threads_77018, 32)) {\n                                    if (sle32(skip_threads_77018, local_tid_76955 - squot32(local_tid_76955, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77016 = ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77018)];\n                                            eta_p_77013 = ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + (sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77018))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77017 == (int8_t) 2 || flg_y_770", "17 == (int8_t) 0) {\n                                                flg_x_77016 = flg_y_77017;\n                                                eta_p_77013 = eta_p_77014;\n                                            } else {\n                                                int64_t defunc_0_op_res_77015 = add64(eta_p_77013, eta_p_77014);\n                                                \n                                                eta_p_77013 = defunc_0_op_res_77015;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = flg_x_77016;\n                                            flg_y_77017 = flg_x_77016;\n                                            ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)] = eta_p_77013;\n                                            eta_p_77014 = eta_p_77013;\n                                        }\n                                    }\n                                    skip_threads_77018 *= 2;\n                                }\n                            }\n                        }\n                        flag_77012 = ((__local int8_t *) local_mem_76962)[sext_i32_i64(wave_sizze_76957) - (int64_t) 1];\n                        aggr_77011 = ((__local int64_t *) local_mem_76962)[(int64_t) 4 + (sext_i32_i64(wave_sizze_76957) - (int64_t) 1)];\n                        if (flag_77012 == (int8_t) 2) {\n                            readOffset_77009 = wave_sizze_76957 * -1;\n                        } else if (flag_77012 == (int8_t) 1) {\n                            readOffset_77009 -= wave_sizze_76957;\n                        }\n                        if (slt8((int8_t) 0, flag_77012)) {\n                            int64_t eta_p_77019 = aggr_77011;\n                      ", "      int64_t eta_p_77020 = prefix_77005;\n                            int64_t defunc_0_op_res_77021 = add64(eta_p_77019, eta_p_77020);\n                            \n                            prefix_77005 = defunc_0_op_res_77021;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_76955 == 0) {\n                    if (boundary_76975 == sext_i64_i32(segscan_tblock_sizze_69872 * chunk_sizze_76923)) {\n                        int64_t eta_p_77022 = prefix_77005;\n                        int64_t eta_p_77023 = acc_76995;\n                        int64_t defunc_0_op_res_77024 = add64(eta_p_77022, eta_p_77023);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76972] = defunc_0_op_res_77024;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76972] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_76962)[(int64_t) 4] = prefix_77005;\n                    acc_76995 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_76972 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77005 = ((__local int64_t *) local_mem_76962)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77025;\n            int64_t eta_p_77026;\n            int64_t eta_p_77028 = prefix_77005;\n            int64_t eta_p_77029 = acc_76995;\n            \n            if (slt32(local_tid_76955 * chunk_sizze_32b_76959, boundary_76975) && !block_new_sgm_77006) {\n                int64_t defunc_0_op_res_77030 = add64(eta_p_77028, eta_p_77029);\n                \n                eta_p_77025 = defunc_0_op_res_77030;\n            } else {\n                eta_p_77025 = acc_76995;\n            }\n            \n        ",
                                    "    int32_t stopping_point_77031 = segsizze_compact_76976 - srem32(local_tid_76955 * chunk_sizze_32b_76959 - 1 + segsizze_compact_76976 - boundary_76975, segsizze_compact_76976);\n            \n            for (int64_t i_77032 = 0; i_77032 < chunk_sizze_76923; i_77032++) {\n                if (slt32(sext_i64_i32(i_77032), stopping_point_77031 - 1)) {\n                    eta_p_77026 = private_mem_76977[i_77032];\n                    \n                    int64_t defunc_0_op_res_77027 = add64(eta_p_77025, eta_p_77026);\n                    \n                    private_mem_76977[i_77032] = defunc_0_op_res_77027;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77033 = 0; i_77033 < chunk_sizze_76923; i_77033++) {\n                int64_t sharedIdx_77034 = sext_i32_i64(local_tid_76955) * chunk_sizze_76923 + i_77033;\n                int64_t tmp_77035 = private_mem_76977[i_77033];\n                \n                ((__local int64_t *) local_mem_76962)[sharedIdx_77034] = tmp_77035;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77036 = 0; i_77036 < chunk_sizze_76923; i_77036++) {\n                int64_t flat_idx_77037 = thd_offset_76979 + i_77036 * segscan_tblock_sizze_69872;\n                int64_t slice_77038 = nR_42219;\n                int64_t gtid_69876 = flat_idx_77037;\n                int64_t remnant_77039 = flat_idx_77037 - gtid_69876;\n                \n                if (slt64(flat_idx_77037, nR_42219)) {\n                    int64_t tmp_77040 = ((__local int64_t *) local_mem_76962)[flat_idx_77037 - block_offset_76973];\n                    \n                    ((__global int64_t *) mem_75941)[gtid_69876] = tmp_77040;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_69872\n    #undef chunk_sizze_76923\n}\nFUTHARK_KERNEL_SIZED(inner_", "SMJ_intzisegscan_69893_dim1, 1, 1)\nvoid inner_SMJ_intzisegscan_69893(__global int *global_failure, int64_t m_65686, int64_t num_tblocks_69890, int64_t num_virt_blocks_77061, int64_t num_virt_threads_77062, __global unsigned char *mem_75945, __global unsigned char *mem_75955, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *status_flags_mem_77063, __global unsigned char *aggregates_mem_77065, __global unsigned char *incprefixes_mem_77067, __global unsigned char *aggregates_mem_77069, __global unsigned char *incprefixes_mem_77071, __global unsigned char *global_dynid_mem_77073)\n{\n    #define segscan_tblock_sizze_69888 (inner_SMJ_intzisegscan_69893zisegscan_tblock_sizze_69888)\n    #define chunk_sizze_77060 (inner_SMJ_intzisegscan_69893zichunk_sizze_77060)\n    \n    volatile __local unsigned char *local_mem_77085_backing_0 = &shared_mem[0];\n    const int64_t local_mem_77085_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_69888, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_69888), smax64(chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_69888, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_69888), smax64(chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77076;\n    int32_t tblock_sizze_77079;\n    int32_t wave_sizze_77078;\n    int32_t block_id_77077;\n    int32_t global_tid_77075;\n    int64_t phys_tid_69893;\n    int32_t chunk_sizze_32b_77080;\n    int64_t byte_offsets_77081;\n    int64_t byte_offsets_77082;\n    int64_t warp_byte_offset_77083;\n    int64_t warp_byte_offset_77084;\n    __local uns", "igned char *local_mem_77085;\n    int64_t trans_arr_len_77086;\n    int64_t phys_block_id_77095;\n    int64_t virtloop_bound_77096;\n    \n    local_tid_77076 = get_local_id(0);\n    tblock_sizze_77079 = get_local_size(0);\n    wave_sizze_77078 = LOCKSTEP_WIDTH;\n    block_id_77077 = get_tblock_id(0);\n    global_tid_77075 = block_id_77077 * tblock_sizze_77079 + local_tid_77076;\n    phys_tid_69893 = sext_i32_i64(global_tid_77075);\n    chunk_sizze_32b_77080 = sext_i64_i32(chunk_sizze_77060);\n    byte_offsets_77081 = segscan_tblock_sizze_69888 * (int64_t) 8;\n    byte_offsets_77082 = sdiv_up64(byte_offsets_77081, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_69888 * (int64_t) 8;\n    warp_byte_offset_77083 = (int64_t) 288;\n    warp_byte_offset_77084 = sdiv_up64(warp_byte_offset_77083, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_77085 = (__local unsigned char *) local_mem_77085_backing_0;\n    trans_arr_len_77086 = chunk_sizze_77060 * segscan_tblock_sizze_69888;\n    phys_block_id_77095 = get_tblock_id(0);\n    virtloop_bound_77096 = sdiv_up64(num_virt_blocks_77061 - phys_block_id_77095, num_tblocks_69890);\n    for (int64_t virtloop_i_77097 = 0; virtloop_i_77097 < virtloop_bound_77096; virtloop_i_77097++) {\n        int64_t dynamic_id_77098;\n        int64_t block_offset_77099;\n        int64_t sgm_idx_77100;\n        int32_t boundary_77101;\n        int32_t segsizze_compact_77102;\n        int64_t private_mem_77103[chunk_sizze_77060];\n        int64_t private_mem_77105[chunk_sizze_77060];\n        int64_t thd_offset_77107;\n        int64_t acc_77133;\n        int64_t acc_77134;\n        int64_t prefix_77147;\n        int64_t prefix_77148;\n        bool block_new_sgm_77149;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_77076 == 0) {\n                dynamic_id_77098 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_77073)[(int64_t) 0], (int) 1);\n     ",
                                    "           // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_77085)[(int64_t) 0] = dynamic_id_77098;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_77098 == num_virt_blocks_77061 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_77073)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_77098 = ((__local int32_t *) local_mem_77085)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_77099 = dynamic_id_77098 * chunk_sizze_77060 * segscan_tblock_sizze_69888;\n        sgm_idx_77100 = smod64(block_offset_77099, m_65686);\n        boundary_77101 = sext_i64_i32(smin64(chunk_sizze_77060 * segscan_tblock_sizze_69888, m_65686 - sgm_idx_77100));\n        segsizze_compact_77102 = sext_i64_i32(smin64(chunk_sizze_77060 * segscan_tblock_sizze_69888, m_65686));\n        thd_offset_77107 = block_offset_77099 + sext_i32_i64(local_tid_77076);\n        // Load and map\n        {\n            for (int64_t i_77108 = 0; i_77108 < chunk_sizze_77060; i_77108++) {\n                int64_t virt_tid_77109 = thd_offset_77107 + i_77108 * segscan_tblock_sizze_69888;\n                int64_t slice_77110 = m_65686;\n                int64_t gtid_69892 = virt_tid_77109;\n                int64_t remnant_77111 = virt_tid_77109 - gtid_69892;\n                \n                if (slt64(virt_tid_77109, m_65686)) {\n                    int64_t x_65967 = ((__global int64_t *) mem_75945)[gtid_69892];\n                    bool lifted_lambda_res_65969 = slt64((int64_t) 1, x_65967);\n                    int64_t defunc_0_f_res_65970 = btoi_bool_i64(lifted_lambda_res_65969);\n                    \n                    ((__global int64_t *) mem_75959)[gtid_69892] = defunc_0_f_res_65970;\n                    private_mem_77103[i_77108] = x_6596", "7;\n                    private_mem_77105[i_77108] = defunc_0_f_res_65970;\n                } else {\n                    private_mem_77103[i_77108] = (int64_t) 0;\n                    private_mem_77105[i_77108] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77112 = 0; i_77112 < chunk_sizze_77060; i_77112++) {\n                int64_t sharedIdx_77113 = sext_i32_i64(local_tid_77076) + i_77112 * segscan_tblock_sizze_69888;\n                int64_t tmp_77114 = private_mem_77103[i_77112];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77113] = tmp_77114;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77115 = 0; i_77115 < chunk_sizze_77060; i_77115++) {\n                int64_t sharedIdx_77116 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77115;\n                int64_t tmp_77117 = ((__local int64_t *) local_mem_77085)[sharedIdx_77116];\n                \n                private_mem_77103[i_77115] = tmp_77117;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77118 = 0; i_77118 < chunk_sizze_77060; i_77118++) {\n                int64_t sharedIdx_77119 = sext_i32_i64(local_tid_77076) + i_77118 * segscan_tblock_sizze_69888;\n                int64_t tmp_77120 = private_mem_77105[i_77118];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77119] = tmp_77120;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77121 = 0; i_77121 < chunk_sizze_77060; i_77121++) {\n                int64_t sharedIdx_77122 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77121;\n                int64_t tmp_77123 = ((__local int64_t *) local_mem_77085)[sharedIdx_77122];\n                \n                private_mem_77105[i_77121] = tmp_77123;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        //", " Per thread scan\n        {\n            for (int64_t i_77124 = 0; i_77124 < chunk_sizze_77060 - (int64_t) 1; i_77124++) {\n                int64_t eta_p_65723;\n                int64_t eta_p_65724;\n                \n                eta_p_65723 = private_mem_77103[i_77124];\n                eta_p_65724 = private_mem_77103[i_77124 + (int64_t) 1];\n                \n                int64_t eta_p_65816;\n                int64_t eta_p_65817;\n                \n                eta_p_65816 = private_mem_77105[i_77124];\n                eta_p_65817 = private_mem_77105[i_77124 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_65725 = add64(eta_p_65723, eta_p_65724);\n                int64_t defunc_0_op_res_65818 = add64(eta_p_65816, eta_p_65817);\n                \n                private_mem_77103[i_77124 + (int64_t) 1] = lifted_lambda_res_65725;\n                private_mem_77105[i_77124 + (int64_t) 1] = defunc_0_op_res_65818;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77125 = private_mem_77103[chunk_sizze_77060 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = tmp_77125;\n            \n            int64_t tmp_77126 = private_mem_77105[chunk_sizze_77060 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = tmp_77126;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77127;\n            int64_t eta_p_77128;\n            int64_t eta_p_77129;\n            int64_t eta_p_77130;\n            int64_t eta_p_77135;\n            int64_t eta_p_77136;\n            int64_t eta_p_77137;\n            int64_t eta_p_77138;\n            bool ltid_in_bounds_77141 = slt64(sext_i32_i64(local_tid_77076), num_virt_threads_77062);\n            int32_t skip_threads_77142;\n            \n            // rea",
                                    "d input for in-block scan\n            {\n                if (ltid_in_bounds_77141) {\n                    eta_p_77129 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                    eta_p_77130 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                    if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                        eta_p_77127 = eta_p_77129;\n                        eta_p_77128 = eta_p_77130;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77142 = 1;\n                while (slt32(skip_threads_77142, 32)) {\n                    bool thread_active_77143 = sle32(skip_threads_77142, local_tid_77076 - squot32(local_tid_77076, 32) * 32) && ltid_in_bounds_77141;\n                    \n                    if (thread_active_77143) {\n                        // read operands\n                        {\n                            eta_p_77127 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77142)];\n                            eta_p_77128 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77142))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77143) {\n                            int64_t lifted_lambda_res_77131 = add64(eta_p_77127, eta_p_77129);\n                            int64_t defunc_0_op_res_77132 = add64(eta_p_77128, eta_p_77130);\n                            \n                            eta_p_77127 = lifted_lambda_res_77131;\n                            eta_p_77128 = defunc_0_op_res_77132;\n                        }\n                    }\n                    if (sle32(wav", "e_sizze_77078, skip_threads_77142)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77143) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77127;\n                            eta_p_77129 = eta_p_77127;\n                            ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77128;\n                            eta_p_77130 = eta_p_77128;\n                        }\n                    }\n                    if (sle32(wave_sizze_77078, skip_threads_77142)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77142 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 31 && ltid_in_bounds_77141) {\n                    ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(squot32(local_tid_77076, 32))] = eta_p_77127;\n                    ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(squot32(local_tid_77076, 32))] = eta_p_77128;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77144;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141) {\n                        eta_p_77137 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                        eta_p_77138 = ((volatile __local int64_t ", "*) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                        if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                            eta_p_77135 = eta_p_77137;\n                            eta_p_77136 = eta_p_77138;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77144 = 1;\n                    while (slt32(skip_threads_77144, 32)) {\n                        bool thread_active_77145 = sle32(skip_threads_77144, local_tid_77076 - squot32(local_tid_77076, 32) * 32) && (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141);\n                        \n                        if (thread_active_77145) {\n                            // read operands\n                            {\n                                eta_p_77135 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77144)];\n                                eta_p_77136 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77144))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77145) {\n                                int64_t lifted_lambda_res_77139 = add64(eta_p_77135, eta_p_77137);\n                                int64_t defunc_0_op_res_77140 = add64(eta_p_77136, eta_p_77138);\n                                \n                                eta_p_77135 = lifted_lambda_res_77139;\n                                eta_p_77136 = defunc_0_op_res_77140;\n                            }\n                        }\n                        if (sle32(wave_sizze_77078, skip_threads_77144)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n   ",
                                    "                     }\n                        if (thread_active_77145) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77135;\n                                eta_p_77137 = eta_p_77135;\n                                ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77136;\n                                eta_p_77138 = eta_p_77136;\n                            }\n                        }\n                        if (sle32(wave_sizze_77078, skip_threads_77144)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77144 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77146 = squot32(local_tid_77076, 32) == 0 || !ltid_in_bounds_77141;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77146) {\n                        eta_p_77129 = eta_p_77127;\n                        eta_p_77130 = eta_p_77128;\n                        eta_p_77127 = ((__local int64_t *) local_mem_77085)[sext_i32_i64(squot32(local_tid_77076, 32)) - (int64_t) 1];\n                        eta_p_77128 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_77076, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77146) {\n                        int64_t lifted_lambda_res_77131 = add64(eta_p_77127, eta_p_77129);\n                        int64_t defunc_0_op_res_77132 = add64(eta_p_77128, eta_p_77130);\n                        \n                        eta", "_p_77127 = lifted_lambda_res_77131;\n                        eta_p_77128 = defunc_0_op_res_77132;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77146) {\n                        ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77127;\n                        ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77128;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141) {\n                    ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77129;\n                    ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77130;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_77076 == 0) {\n                acc_77133 = ((__local int64_t *) local_mem_77085)[segscan_tblock_sizze_69888 - (int64_t) 1];\n                acc_77134 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (segscan_tblock_sizze_69888 - (int64_t) 1)];\n            } else {\n                acc_77133 = ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - (int64_t) 1];\n                acc_77134 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77147 = (int64_t) 0;\n        prefix_77148 = (int64_t) 0;\n        block_new_sgm_77149 = sgm_idx_77100 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77149 && local_tid_77076 == 0) ", "{\n                ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098] = acc_77133;\n                ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098] = acc_77134;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 2;\n                acc_77133 = (int64_t) 0;\n                acc_77134 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77149 && slt32(local_tid_77076, wave_sizze_77078)) {\n                if (local_tid_77076 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_77065)[dynamic_id_77098] = acc_77133;\n                    ((volatile __global int64_t *) aggregates_mem_77069)[dynamic_id_77098] = acc_77134;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 1;\n                    \n                    int8_t tmp_77150 = ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_77085)[(int64_t) 0] = tmp_77150;\n                }\n                mem_fence_local();\n                \n                int8_t status_77151 = ((__local int8_t *) local_mem_77085)[(int64_t) 0];\n                \n                if (status_77151 == (int8_t) 2) {\n                    if (local_tid_77076 == 0) {\n                        prefix_77147 = ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098 - (int64_t) 1];\n                        prefix_77148 = ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77152 = sext_i64_i32(dynamic_id_77098 - sext_i32_i64(wave_sizze_77078));\n                    \n                    while (slt32(wave_sizze_77078 * -1, readOffset_77152)) {\n                        int32_t read_",
                                    "i_77153 = readOffset_77152 + local_tid_77076;\n                        int64_t aggr_77154 = (int64_t) 0;\n                        int64_t aggr_77155 = (int64_t) 0;\n                        int8_t flag_77156 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77153)) {\n                            flag_77156 = ((volatile __global int8_t *) status_flags_mem_77063)[sext_i32_i64(read_i_77153)];\n                            if (flag_77156 == (int8_t) 2) {\n                                aggr_77154 = ((volatile __global int64_t *) incprefixes_mem_77067)[sext_i32_i64(read_i_77153)];\n                                aggr_77155 = ((volatile __global int64_t *) incprefixes_mem_77071)[sext_i32_i64(read_i_77153)];\n                            } else if (flag_77156 == (int8_t) 1) {\n                                aggr_77154 = ((volatile __global int64_t *) aggregates_mem_77065)[sext_i32_i64(read_i_77153)];\n                                aggr_77155 = ((volatile __global int64_t *) aggregates_mem_77069)[sext_i32_i64(read_i_77153)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)] = aggr_77154;\n                        ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = aggr_77155;\n                        ((__local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = flag_77156;\n                        flag_77156 = ((__local int8_t *) local_mem_77085)[sext_i32_i64(wave_sizze_77078) - (int64_t) 1];\n                        if (slt8(flag_77156, (int8_t) 2)) {\n                            int8_t flg_x_77163;\n                            int8_t flg_y_77164;\n                            int64_t eta_p_77157;\n                            int64_t eta_p_77158;\n                            int64_t eta_p_77159;\n                            int64_t eta_p_77160;\n                            int3", "2_t skip_threads_77165;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77164 = ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                                eta_p_77159 = ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)];\n                                eta_p_77160 = ((volatile __local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                                if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                                    eta_p_77157 = eta_p_77159;\n                                    eta_p_77158 = eta_p_77160;\n                                    flg_x_77163 = flg_y_77164;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77165 = 1;\n                                while (slt32(skip_threads_77165, 32)) {\n                                    if (sle32(skip_threads_77165, local_tid_77076 - squot32(local_tid_77076, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77163 = ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165)];\n                                            eta_p_77157 = ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165))];\n                                            eta_p_77158 = ((volatile __local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165))];\n                                    ", "    }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77164 == (int8_t) 2 || flg_y_77164 == (int8_t) 0) {\n                                                flg_x_77163 = flg_y_77164;\n                                                eta_p_77157 = eta_p_77159;\n                                                eta_p_77158 = eta_p_77160;\n                                            } else {\n                                                int64_t lifted_lambda_res_77161 = add64(eta_p_77157, eta_p_77159);\n                                                int64_t defunc_0_op_res_77162 = add64(eta_p_77158, eta_p_77160);\n                                                \n                                                eta_p_77157 = lifted_lambda_res_77161;\n                                                eta_p_77158 = defunc_0_op_res_77162;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = flg_x_77163;\n                                            flg_y_77164 = flg_x_77163;\n                                            ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)] = eta_p_77157;\n                                            eta_p_77159 = eta_p_77157;\n                                            ((volatile __local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77158;\n                                            eta_p_77160 = eta_p_77158;\n                                        }\n                                    }\n                                    skip_threads_77165 *= 2;\n                                }\n             ",
                                    "               }\n                        }\n                        flag_77156 = ((__local int8_t *) local_mem_77085)[sext_i32_i64(wave_sizze_77078) - (int64_t) 1];\n                        aggr_77154 = ((__local int64_t *) local_mem_77085)[(int64_t) 4 + (sext_i32_i64(wave_sizze_77078) - (int64_t) 1)];\n                        aggr_77155 = ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + (sext_i32_i64(wave_sizze_77078) - (int64_t) 1)];\n                        if (flag_77156 == (int8_t) 2) {\n                            readOffset_77152 = wave_sizze_77078 * -1;\n                        } else if (flag_77156 == (int8_t) 1) {\n                            readOffset_77152 -= wave_sizze_77078;\n                        }\n                        if (slt8((int8_t) 0, flag_77156)) {\n                            int64_t eta_p_77166 = aggr_77154;\n                            int64_t eta_p_77167 = aggr_77155;\n                            int64_t eta_p_77168 = prefix_77147;\n                            int64_t eta_p_77169 = prefix_77148;\n                            int64_t lifted_lambda_res_77170 = add64(eta_p_77166, eta_p_77168);\n                            int64_t defunc_0_op_res_77171 = add64(eta_p_77167, eta_p_77169);\n                            \n                            prefix_77147 = lifted_lambda_res_77170;\n                            prefix_77148 = defunc_0_op_res_77171;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_77076 == 0) {\n                    if (boundary_77101 == sext_i64_i32(segscan_tblock_sizze_69888 * chunk_sizze_77060)) {\n                        int64_t eta_p_77172 = prefix_77147;\n                        int64_t eta_p_77173 = prefix_77148;\n                        int64_t eta_p_77174 = acc_77133;\n                        int64_t eta_p_77175 = acc_77134;\n                        int64_t lifted_lambda_res_77176 = add64(eta_p_77172, eta_p_77174);", "\n                        int64_t defunc_0_op_res_77177 = add64(eta_p_77173, eta_p_77175);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098] = lifted_lambda_res_77176;\n                        ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098] = defunc_0_op_res_77177;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_77085)[(int64_t) 4] = prefix_77147;\n                    ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8)] = prefix_77148;\n                    acc_77133 = (int64_t) 0;\n                    acc_77134 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_77098 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77147 = ((__local int64_t *) local_mem_77085)[(int64_t) 4];\n                prefix_77148 = ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77178;\n            int64_t eta_p_77180;\n            int64_t eta_p_77184 = prefix_77147;\n            int64_t eta_p_77186 = acc_77133;\n            int64_t eta_p_77179;\n            int64_t eta_p_77181;\n            int64_t eta_p_77185 = prefix_77148;\n            int64_t eta_p_77187 = acc_77134;\n            \n            if (slt32(local_tid_77076 * chunk_sizze_32b_77080, boundary_77101) && !block_new_sgm_77149) {\n                int64_t lifted_lambda_res_77188 = add64(eta_p_77184, eta_p_77186);\n                int64_t defunc_0_op_res_77189 = add64(eta_p_77185, eta_p_77187);\n                \n                eta_p_77178 = lifted_lambda_res_77188;\n                eta_p_77179 = defunc_0_op_res_77189;\n ", "           } else {\n                eta_p_77178 = acc_77133;\n                eta_p_77179 = acc_77134;\n            }\n            \n            int32_t stopping_point_77190 = segsizze_compact_77102 - srem32(local_tid_77076 * chunk_sizze_32b_77080 - 1 + segsizze_compact_77102 - boundary_77101, segsizze_compact_77102);\n            \n            for (int64_t i_77191 = 0; i_77191 < chunk_sizze_77060; i_77191++) {\n                if (slt32(sext_i64_i32(i_77191), stopping_point_77190 - 1)) {\n                    eta_p_77180 = private_mem_77103[i_77191];\n                    eta_p_77181 = private_mem_77105[i_77191];\n                    \n                    int64_t lifted_lambda_res_77182 = add64(eta_p_77178, eta_p_77180);\n                    int64_t defunc_0_op_res_77183 = add64(eta_p_77179, eta_p_77181);\n                    \n                    private_mem_77103[i_77191] = lifted_lambda_res_77182;\n                    private_mem_77105[i_77191] = defunc_0_op_res_77183;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77192 = 0; i_77192 < chunk_sizze_77060; i_77192++) {\n                int64_t sharedIdx_77193 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77192;\n                int64_t tmp_77194 = private_mem_77103[i_77192];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77193] = tmp_77194;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77195 = 0; i_77195 < chunk_sizze_77060; i_77195++) {\n                int64_t flat_idx_77196 = thd_offset_77107 + i_77195 * segscan_tblock_sizze_69888;\n                int64_t slice_77197 = m_65686;\n                int64_t gtid_69892 = flat_idx_77196;\n                int64_t remnant_77198 = flat_idx_77196 - gtid_69892;\n                \n                if (slt64(flat_idx_77196, m_65686)) {\n                    int64_t tmp_77199 = ((__local int64_t *) local_mem_",
                                    "77085)[flat_idx_77196 - block_offset_77099];\n                    \n                    ((__global int64_t *) mem_75955)[gtid_69892] = tmp_77199;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77200 = 0; i_77200 < chunk_sizze_77060; i_77200++) {\n                int64_t sharedIdx_77201 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77200;\n                int64_t tmp_77202 = private_mem_77105[i_77200];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77201] = tmp_77202;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77203 = 0; i_77203 < chunk_sizze_77060; i_77203++) {\n                int64_t flat_idx_77204 = thd_offset_77107 + i_77203 * segscan_tblock_sizze_69888;\n                int64_t slice_77205 = m_65686;\n                int64_t gtid_69892 = flat_idx_77204;\n                int64_t remnant_77206 = flat_idx_77204 - gtid_69892;\n                \n                if (slt64(flat_idx_77204, m_65686)) {\n                    int64_t tmp_77207 = ((__local int64_t *) local_mem_77085)[flat_idx_77204 - block_offset_77099];\n                    \n                    ((__global int64_t *) mem_75957)[gtid_69892] = tmp_77207;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_69888\n    #undef chunk_sizze_77060\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76566_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76566(__global int *global_failure, int64_t gt_rhs_64823, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75475)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76568;\n    int32_t tblock_sizze_76571;\n    int32_t wave_sizze_76570;\n    int32_t block_id_76569;\n    int32_t global_tid_76567;\n    int64_t tid_76566;\n    int64_t x_75366;\n    \n    local_tid_76568 = get_local_id(0);\n    tblock_sizze_76571 = get_local_size(0);\n   ", " wave_sizze_76570 = LOCKSTEP_WIDTH;\n    block_id_76569 = get_tblock_id(0);\n    global_tid_76567 = block_id_76569 * tblock_sizze_76571 + local_tid_76568;\n    tid_76566 = sext_i32_i64(global_tid_76567);\n    x_75366 = ((__global int64_t *) tR_mem_75467)[gt_rhs_64823];\n    ((__global int64_t *) mem_75475)[(int64_t) 0] = x_75366;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76578_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76578(__global int *global_failure, int64_t tS_start_64840, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75476, __global unsigned char *mem_75483, __global unsigned char *mem_75484)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76580;\n    int32_t tblock_sizze_76583;\n    int32_t wave_sizze_76582;\n    int32_t block_id_76581;\n    int32_t global_tid_76579;\n    int64_t tid_76578;\n    int64_t gt_lhs_75370;\n    int64_t gt_rhs_75372;\n    bool defunc_0_gt_res_75374;\n    \n    local_tid_76580 = get_local_id(0);\n    tblock_sizze_76583 = get_local_size(0);\n    wave_sizze_76582 = LOCKSTEP_WIDTH;\n    block_id_76581 = get_tblock_id(0);\n    global_tid_76579 = block_id_76581 * tblock_sizze_76583 + local_tid_76580;\n    tid_76578 = sext_i32_i64(global_tid_76579);\n    gt_lhs_75370 = ((__global int64_t *) tS_mem_75468)[tS_start_64840];\n    gt_rhs_75372 = ((__global int64_t *) ext_mem_75476)[(int64_t) 0];\n    defunc_0_gt_res_75374 = slt64(gt_rhs_75372, gt_lhs_75370);\n    ((__global int64_t *) mem_75483)[(int64_t) 0] = gt_lhs_75370;\n    ((__global bool *) mem_75484)[(int64_t) 0] = defunc_0_gt_res_75374;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76584_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76584(__global int *global_failure, int64_t i_p_m_t_s_64846, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75750)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76586;\n    int32_t tblock_sizze_76589;\n    int32_t wave_sizze_76588;\n    ", "int32_t block_id_76587;\n    int32_t global_tid_76585;\n    int64_t tid_76584;\n    int64_t x_75376;\n    \n    local_tid_76586 = get_local_id(0);\n    tblock_sizze_76589 = get_local_size(0);\n    wave_sizze_76588 = LOCKSTEP_WIDTH;\n    block_id_76587 = get_tblock_id(0);\n    global_tid_76585 = block_id_76587 * tblock_sizze_76589 + local_tid_76586;\n    tid_76584 = sext_i32_i64(global_tid_76585);\n    x_75376 = ((__global int64_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    ((__global int64_t *) mem_75750)[(int64_t) 0] = x_75376;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76600_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76600(__global int *global_failure, int64_t start_66400, int64_t i_p_m_t_s_66406, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75758, __global unsigned char *mem_75759)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76602;\n    int32_t tblock_sizze_76605;\n    int32_t wave_sizze_76604;\n    int32_t block_id_76603;\n    int32_t global_tid_76601;\n    int64_t tid_76600;\n    int64_t r_max_75380;\n    int64_t r_min_75383;\n    \n    local_tid_76602 = get_local_id(0);\n    tblock_sizze_76605 = get_local_size(0);\n    wave_sizze_76604 = LOCKSTEP_WIDTH;\n    block_id_76603 = get_tblock_id(0);\n    global_tid_76601 = block_id_76603 * tblock_sizze_76605 + local_tid_76602;\n    tid_76600 = sext_i32_i64(global_tid_76601);\n    r_max_75380 = ((__global int64_t *) tR_mem_75467)[i_p_m_t_s_66406];\n    r_min_75383 = ((__global int64_t *) tR_mem_75467)[start_66400];\n    ((__global int64_t *) mem_75758)[(int64_t) 0] = r_max_75380;\n    ((__global int64_t *) mem_75759)[(int64_t) 0] = r_min_75383;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76606_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76606(__global int *global_failure, __global unsigned char *mem_75759, __global unsigned char *ext_mem_75760, __global unsigned char *mem_75762)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t loca",
                                    "l_tid_76608;\n    int32_t tblock_sizze_76611;\n    int32_t wave_sizze_76610;\n    int32_t block_id_76609;\n    int32_t global_tid_76607;\n    int64_t tid_76606;\n    int64_t s_max_75385;\n    int64_t r_min_75386;\n    bool defunc_0_gt_res_75387;\n    \n    local_tid_76608 = get_local_id(0);\n    tblock_sizze_76611 = get_local_size(0);\n    wave_sizze_76610 = LOCKSTEP_WIDTH;\n    block_id_76609 = get_tblock_id(0);\n    global_tid_76607 = block_id_76609 * tblock_sizze_76611 + local_tid_76608;\n    tid_76606 = sext_i32_i64(global_tid_76607);\n    s_max_75385 = ((__global int64_t *) ext_mem_75760)[(int64_t) 0];\n    r_min_75386 = ((__global int64_t *) mem_75759)[(int64_t) 0];\n    defunc_0_gt_res_75387 = slt64(s_max_75385, r_min_75386);\n    ((__global bool *) mem_75762)[(int64_t) 0] = defunc_0_gt_res_75387;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76612_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76612(__global int *global_failure, __global unsigned char *mem_75758, __global unsigned char *ext_mem_75761, __global unsigned char *mem_75763)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76614;\n    int32_t tblock_sizze_76617;\n    int32_t wave_sizze_76616;\n    int32_t block_id_76615;\n    int32_t global_tid_76613;\n    int64_t tid_76612;\n    int64_t r_max_75390;\n    int64_t s_min_75391;\n    bool defunc_0_gt_res_75392;\n    \n    local_tid_76614 = get_local_id(0);\n    tblock_sizze_76617 = get_local_size(0);\n    wave_sizze_76616 = LOCKSTEP_WIDTH;\n    block_id_76615 = get_tblock_id(0);\n    global_tid_76613 = block_id_76615 * tblock_sizze_76617 + local_tid_76614;\n    tid_76612 = sext_i32_i64(global_tid_76613);\n    r_max_75390 = ((__global int64_t *) mem_75758)[(int64_t) 0];\n    s_min_75391 = ((__global int64_t *) ext_mem_75761)[(int64_t) 0];\n    defunc_0_gt_res_75392 = slt64(r_max_75390, s_min_75391);\n    ((__global bool *) mem_75763)[(int64_t) 0] = defunc_0_gt_res_75392;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuse", "q_76671_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76671(__global int *global_failure, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75490)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76673;\n    int32_t tblock_sizze_76676;\n    int32_t wave_sizze_76675;\n    int32_t block_id_76674;\n    int32_t global_tid_76672;\n    int64_t tid_76671;\n    int64_t x_75394;\n    \n    local_tid_76673 = get_local_id(0);\n    tblock_sizze_76676 = get_local_size(0);\n    wave_sizze_76675 = LOCKSTEP_WIDTH;\n    block_id_76674 = get_tblock_id(0);\n    global_tid_76672 = block_id_76674 * tblock_sizze_76676 + local_tid_76673;\n    tid_76671 = sext_i32_i64(global_tid_76672);\n    x_75394 = ((__global int64_t *) tR_mem_75467)[(int64_t) 0];\n    ((__global int64_t *) mem_75490)[(int64_t) 0] = x_75394;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76677_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76677(__global int *global_failure, __global unsigned char *mem_75483, __global unsigned char *ext_mem_75491, __global unsigned char *mem_75492)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76679;\n    int32_t tblock_sizze_76682;\n    int32_t wave_sizze_76681;\n    int32_t block_id_76680;\n    int32_t global_tid_76678;\n    int64_t tid_76677;\n    int64_t leq_lhs_75398;\n    int64_t gt_lhs_75399;\n    bool defunc_0_leq_res_75400;\n    \n    local_tid_76679 = get_local_id(0);\n    tblock_sizze_76682 = get_local_size(0);\n    wave_sizze_76681 = LOCKSTEP_WIDTH;\n    block_id_76680 = get_tblock_id(0);\n    global_tid_76678 = block_id_76680 * tblock_sizze_76682 + local_tid_76679;\n    tid_76677 = sext_i32_i64(global_tid_76678);\n    leq_lhs_75398 = ((__global int64_t *) ext_mem_75491)[(int64_t) 0];\n    gt_lhs_75399 = ((__global int64_t *) mem_75483)[(int64_t) 0];\n    defunc_0_leq_res_75400 = sle64(leq_lhs_75398, gt_lhs_75399);\n    ((__global bool *) mem_75492)[(int64_t) 0] = defunc_0_leq_res_75400;\n    \n  error_0:\n    return;\n}\nFUTHARK", "_KERNEL_SIZED(inner_SMJ_longzigpuseq_76683_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76683(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_47166, unsigned char y_64988_bits, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75483, __global unsigned char *mem_75492, __global unsigned char *mem_75494)\n{\n    bool y_64988 = y_64988_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76685;\n    int32_t tblock_sizze_76688;\n    int32_t wave_sizze_76687;\n    int32_t block_id_76686;\n    int32_t global_tid_76684;\n    int64_t tid_76683;\n    bool defunc_0_leq_res_75402;\n    int64_t x_75407;\n    \n    local_tid_76685 = get_local_id(0);\n    tblock_sizze_76688 = get_local_size(0);\n    wave_sizze_76687 = LOCKSTEP_WIDTH;\n    block_id_76686 = get_tblock_id(0);\n    global_tid_76684 = block_id_76686 * tblock_sizze_76688 + local_tid_76685;\n    tid_76683 = sext_i32_i64(global_tid_76684);\n    defunc_0_leq_res_75402 = ((__global bool *) mem_75492)[(int64_t) 0];\n    if (defunc_0_leq_res_75402) {\n        bool index_certs_75403;\n        int64_t lowest_t_res_75404;\n        \n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 106) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_47166;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_75404 = ((__global int64_t *) tR_mem_75467)[(int64_t) 0];\n        x_75407 = lowest_t_res_75404;\n    } else {\n        int64_t gt_lhs_75406;\n        bool index_certs_75405;\n        \n        gt_lhs_75406 = ((__global int64_t *) mem_75483)[(int64_t) 0];\n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 107) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_arg",
                                    "s[1] = (int64_t) nR_47166;\n                    ;\n                }\n                return;\n            }\n        }\n        x_75407 = gt_lhs_75406;\n    }\n    ((__global int64_t *) mem_75494)[(int64_t) 0] = x_75407;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76745_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76745(__global int *global_failure, int64_t slice_65911, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75542)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76747;\n    int32_t tblock_sizze_76750;\n    int32_t wave_sizze_76749;\n    int32_t block_id_76748;\n    int32_t global_tid_76746;\n    int64_t tid_76745;\n    int64_t x_75412;\n    \n    local_tid_76747 = get_local_id(0);\n    tblock_sizze_76750 = get_local_size(0);\n    wave_sizze_76749 = LOCKSTEP_WIDTH;\n    block_id_76748 = get_tblock_id(0);\n    global_tid_76746 = block_id_76748 * tblock_sizze_76750 + local_tid_76747;\n    tid_76745 = sext_i32_i64(global_tid_76746);\n    x_75412 = ((__global int64_t *) tS_mem_75468)[slice_65911];\n    ((__global int64_t *) mem_75542)[(int64_t) 0] = x_75412;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76751_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76751(__global int *global_failure, int64_t slice_66709, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75545)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76753;\n    int32_t tblock_sizze_76756;\n    int32_t wave_sizze_76755;\n    int32_t block_id_76754;\n    int32_t global_tid_76752;\n    int64_t tid_76751;\n    int64_t x_75416;\n    \n    local_tid_76753 = get_local_id(0);\n    tblock_sizze_76756 = get_local_size(0);\n    wave_sizze_76755 = LOCKSTEP_WIDTH;\n    block_id_76754 = get_tblock_id(0);\n    global_tid_76752 = block_id_76754 * tblock_sizze_76756 + local_tid_76753;\n    tid_76751 = sext_i32_i64(global_tid_76752);\n    x_75416 = ((__global int64_t *) tS_mem_75468)[slice_66709];\n    ((__global int64_", "t *) mem_75545)[(int64_t) 0] = x_75416;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76767_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76767(__global int *global_failure, int64_t slice_65554, int64_t slice_65563, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75553, __global unsigned char *mem_75554)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76769;\n    int32_t tblock_sizze_76772;\n    int32_t wave_sizze_76771;\n    int32_t block_id_76770;\n    int32_t global_tid_76768;\n    int64_t tid_76767;\n    int64_t r_max_75420;\n    int64_t r_min_75423;\n    \n    local_tid_76769 = get_local_id(0);\n    tblock_sizze_76772 = get_local_size(0);\n    wave_sizze_76771 = LOCKSTEP_WIDTH;\n    block_id_76770 = get_tblock_id(0);\n    global_tid_76768 = block_id_76770 * tblock_sizze_76772 + local_tid_76769;\n    tid_76767 = sext_i32_i64(global_tid_76768);\n    r_max_75420 = ((__global int64_t *) tR_mem_75467)[slice_65563];\n    r_min_75423 = ((__global int64_t *) tR_mem_75467)[slice_65554];\n    ((__global int64_t *) mem_75553)[(int64_t) 0] = r_max_75420;\n    ((__global int64_t *) mem_75554)[(int64_t) 0] = r_min_75423;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76773_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76773(__global int *global_failure, __global unsigned char *mem_75554, __global unsigned char *ext_mem_75555, __global unsigned char *mem_75557)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76775;\n    int32_t tblock_sizze_76778;\n    int32_t wave_sizze_76777;\n    int32_t block_id_76776;\n    int32_t global_tid_76774;\n    int64_t tid_76773;\n    int64_t s_max_75425;\n    int64_t r_min_75426;\n    bool defunc_0_gt_res_75427;\n    \n    local_tid_76775 = get_local_id(0);\n    tblock_sizze_76778 = get_local_size(0);\n    wave_sizze_76777 = LOCKSTEP_WIDTH;\n    block_id_76776 = get_tblock_id(0);\n    global_tid_76774 = block_id_76776 * tblock_sizze_76778 + local_tid_76775;\n    t", "id_76773 = sext_i32_i64(global_tid_76774);\n    s_max_75425 = ((__global int64_t *) ext_mem_75555)[(int64_t) 0];\n    r_min_75426 = ((__global int64_t *) mem_75554)[(int64_t) 0];\n    defunc_0_gt_res_75427 = slt64(s_max_75425, r_min_75426);\n    ((__global bool *) mem_75557)[(int64_t) 0] = defunc_0_gt_res_75427;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76779_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76779(__global int *global_failure, __global unsigned char *mem_75553, __global unsigned char *ext_mem_75556, __global unsigned char *mem_75558)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76781;\n    int32_t tblock_sizze_76784;\n    int32_t wave_sizze_76783;\n    int32_t block_id_76782;\n    int32_t global_tid_76780;\n    int64_t tid_76779;\n    int64_t r_max_75430;\n    int64_t s_min_75431;\n    bool defunc_0_gt_res_75432;\n    \n    local_tid_76781 = get_local_id(0);\n    tblock_sizze_76784 = get_local_size(0);\n    wave_sizze_76783 = LOCKSTEP_WIDTH;\n    block_id_76782 = get_tblock_id(0);\n    global_tid_76780 = block_id_76782 * tblock_sizze_76784 + local_tid_76781;\n    tid_76779 = sext_i32_i64(global_tid_76780);\n    r_max_75430 = ((__global int64_t *) mem_75553)[(int64_t) 0];\n    s_min_75431 = ((__global int64_t *) ext_mem_75556)[(int64_t) 0];\n    defunc_0_gt_res_75432 = slt64(r_max_75430, s_min_75431);\n    ((__global bool *) mem_75558)[(int64_t) 0] = defunc_0_gt_res_75432;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_76892_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_76892(__global int *global_failure, int64_t gt_rhs_64823, int64_t i_p_m_t_s_64846, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75926)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76894;\n    int32_t tblock_sizze_76897;\n    int32_t wave_sizze_76896;\n    int32_t block_id_76895;\n    int32_t global_tid_76893;\n    int64_t tid_76892;\n    int64_t leq_lhs_",
                                    "75434;\n    int64_t leq_rhs_75436;\n    bool defunc_0_leq_res_75440;\n    \n    local_tid_76894 = get_local_id(0);\n    tblock_sizze_76897 = get_local_size(0);\n    wave_sizze_76896 = LOCKSTEP_WIDTH;\n    block_id_76895 = get_tblock_id(0);\n    global_tid_76893 = block_id_76895 * tblock_sizze_76897 + local_tid_76894;\n    tid_76892 = sext_i32_i64(global_tid_76893);\n    leq_lhs_75434 = ((__global int64_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    leq_rhs_75436 = ((__global int64_t *) tR_mem_75467)[gt_rhs_64823];\n    defunc_0_leq_res_75440 = sle64(leq_lhs_75434, leq_rhs_75436);\n    ((__global bool *) mem_75926)[(int64_t) 0] = defunc_0_leq_res_75440;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_77217_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_77217(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75962, __global unsigned char *mem_75964)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77219;\n    int32_t tblock_sizze_77222;\n    int32_t wave_sizze_77221;\n    int32_t block_id_77220;\n    int32_t global_tid_77218;\n    int64_t tid_77217;\n    int64_t x_75442;\n    \n    local_tid_77219 = get_local_id(0);\n    tblock_sizze_77222 = get_local_size(0);\n    wave_sizze_77221 = LOCKSTEP_WIDTH;\n    block_id_77220 = get_tblock_id(0);\n    global_tid_77218 = block_id_77220 * tblock_sizze_77222 + local_tid_77219;\n    tid_77217 = sext_i32_i64(global_tid_77218);\n    x_75442 = ((__global int64_t *) mem_75962)[m_65696];\n    ((__global int64_t *) mem_75964)[(int64_t) 0] = x_75442;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_77223_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_77223(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75945, __global unsigned char *mem_75967)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77225;\n    int32_t tblock_sizze_77228;\n    int32_t wave_sizze_77227;\n    int32_t block_id_77226;\n    int32_t global_tid_77224;\n    int64_t t", "id_77223;\n    int64_t x_75446;\n    \n    local_tid_77225 = get_local_id(0);\n    tblock_sizze_77228 = get_local_size(0);\n    wave_sizze_77227 = LOCKSTEP_WIDTH;\n    block_id_77226 = get_tblock_id(0);\n    global_tid_77224 = block_id_77226 * tblock_sizze_77228 + local_tid_77225;\n    tid_77223 = sext_i32_i64(global_tid_77224);\n    x_75446 = ((__global int64_t *) mem_75945)[m_65696];\n    ((__global int64_t *) mem_75967)[(int64_t) 0] = x_75446;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_77229_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_77229(__global int *global_failure, __global unsigned char *ext_mem_75965, __global unsigned char *ext_mem_75968, __global unsigned char *mem_75974)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77231;\n    int32_t tblock_sizze_77234;\n    int32_t wave_sizze_77233;\n    int32_t block_id_77232;\n    int32_t global_tid_77230;\n    int64_t tid_77229;\n    int64_t zp_lhs_75450;\n    int64_t n_pairs_t_res_75451;\n    int64_t n_pairs_t_res_75452;\n    \n    local_tid_77231 = get_local_id(0);\n    tblock_sizze_77234 = get_local_size(0);\n    wave_sizze_77233 = LOCKSTEP_WIDTH;\n    block_id_77232 = get_tblock_id(0);\n    global_tid_77230 = block_id_77232 * tblock_sizze_77234 + local_tid_77231;\n    tid_77229 = sext_i32_i64(global_tid_77230);\n    zp_lhs_75450 = ((__global int64_t *) ext_mem_75965)[(int64_t) 0];\n    n_pairs_t_res_75451 = ((__global int64_t *) ext_mem_75968)[(int64_t) 0];\n    n_pairs_t_res_75452 = add64(zp_lhs_75450, n_pairs_t_res_75451);\n    ((__global int64_t *) mem_75974)[(int64_t) 0] = n_pairs_t_res_75452;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzigpuseq_77276_dim1, 1, 1)\nvoid inner_SMJ_longzigpuseq_77276(__global int *global_failure, int64_t loopres_65870, __global unsigned char *mem_param_76008, __global unsigned char *mem_param_76011, __global unsigned char *mem_param_76014, __global unsigned char *mem_76021, __global unsigned char *mem_76022, __global unsigned cha", "r *mem_76023)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77278;\n    int32_t tblock_sizze_77281;\n    int32_t wave_sizze_77280;\n    int32_t block_id_77279;\n    int32_t global_tid_77277;\n    int64_t tid_77276;\n    int64_t loopres_75454;\n    int64_t loopres_75456;\n    int64_t loopres_75458;\n    \n    local_tid_77278 = get_local_id(0);\n    tblock_sizze_77281 = get_local_size(0);\n    wave_sizze_77280 = LOCKSTEP_WIDTH;\n    block_id_77279 = get_tblock_id(0);\n    global_tid_77277 = block_id_77279 * tblock_sizze_77281 + local_tid_77278;\n    tid_77276 = sext_i32_i64(global_tid_77277);\n    loopres_75454 = ((__global int64_t *) mem_param_76008)[loopres_65870];\n    loopres_75456 = ((__global int64_t *) mem_param_76011)[loopres_65870];\n    loopres_75458 = ((__global int64_t *) mem_param_76014)[loopres_65870];\n    ((__global int64_t *) mem_76021)[(int64_t) 0] = loopres_75454;\n    ((__global int64_t *) mem_76022)[(int64_t) 0] = loopres_75456;\n    ((__global int64_t *) mem_76023)[(int64_t) 0] = loopres_75458;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_longzireplicate_77283(int64_t loopres_65871, int64_t replicate_n_77282, int64_t virt_num_tblocks_77288, int64_t num_tblocks_77289, __global unsigned char *mem_76021, __global unsigned char *mem_76025)\n{\n    int32_t replicate_ltid_77284;\n    int32_t tblock_sizze_77286;\n    int32_t replicate_gid_77285;\n    int32_t replicate_gtid_77283;\n    int32_t phys_tblock_id_77290;\n    int32_t iterations_77291;\n    \n    replicate_ltid_77284 = get_local_id(0);\n    tblock_sizze_77286 = get_local_size(0);\n    replicate_gid_77285 = get_tblock_id(0);\n    replicate_gtid_77283 = replicate_gid_77285 * tblock_sizze_77286 + replicate_ltid_77284;\n    phys_tblock_id_77290 = get_tblock_id(0);\n    iterations_77291 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77288) - phys_tblock_id_77290, sext_i64_i32(num_tblocks_77289));\n    for (int32_t i_77292 = 0; i_77292 < iterations_77291; i_77292++) {\n        int32_t virt_tblock_i",
                                    "d_77293;\n        int64_t global_tid_77294;\n        int64_t slice_77297;\n        int64_t slice_77298;\n        int64_t rep_i_77295;\n        int64_t remnant_77299;\n        int64_t rep_i_77296;\n        int64_t remnant_77300;\n        \n        virt_tblock_id_77293 = phys_tblock_id_77290 + i_77292 * sext_i64_i32(num_tblocks_77289);\n        global_tid_77294 = sext_i32_i64(virt_tblock_id_77293) * sext_i32_i64(tblock_sizze_77286) + sext_i32_i64(replicate_ltid_77284);\n        slice_77297 = (int64_t) 1;\n        slice_77298 = loopres_65871 * slice_77297;\n        rep_i_77295 = squot64(global_tid_77294, slice_77297);\n        remnant_77299 = global_tid_77294 - rep_i_77295 * slice_77297;\n        rep_i_77296 = remnant_77299;\n        remnant_77300 = remnant_77299 - rep_i_77296;\n        if (slt64(global_tid_77294, replicate_n_77282)) {\n            int64_t tmp_77301 = ((__global int64_t *) mem_76021)[rep_i_77296];\n            \n            ((__global int64_t *) mem_76025)[rep_i_77295 + rep_i_77296] = tmp_77301;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_longzireplicate_77303(int64_t loopres_65871, int64_t replicate_n_77302, int64_t virt_num_tblocks_77308, int64_t num_tblocks_77309, __global unsigned char *mem_76022, __global unsigned char *mem_76027)\n{\n    int32_t replicate_ltid_77304;\n    int32_t tblock_sizze_77306;\n    int32_t replicate_gid_77305;\n    int32_t replicate_gtid_77303;\n    int32_t phys_tblock_id_77310;\n    int32_t iterations_77311;\n    \n    replicate_ltid_77304 = get_local_id(0);\n    tblock_sizze_77306 = get_local_size(0);\n    replicate_gid_77305 = get_tblock_id(0);\n    replicate_gtid_77303 = replicate_gid_77305 * tblock_sizze_77306 + replicate_ltid_77304;\n    phys_tblock_id_77310 = get_tblock_id(0);\n    iterations_77311 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77308) - phys_tblock_id_77310, sext_i64_i32(num_tblocks_77309));\n    for (int32_t i_77312 = 0; i_77312 < iterations_77311", "; i_77312++) {\n        int32_t virt_tblock_id_77313;\n        int64_t global_tid_77314;\n        int64_t slice_77317;\n        int64_t slice_77318;\n        int64_t rep_i_77315;\n        int64_t remnant_77319;\n        int64_t rep_i_77316;\n        int64_t remnant_77320;\n        \n        virt_tblock_id_77313 = phys_tblock_id_77310 + i_77312 * sext_i64_i32(num_tblocks_77309);\n        global_tid_77314 = sext_i32_i64(virt_tblock_id_77313) * sext_i32_i64(tblock_sizze_77306) + sext_i32_i64(replicate_ltid_77304);\n        slice_77317 = (int64_t) 1;\n        slice_77318 = loopres_65871 * slice_77317;\n        rep_i_77315 = squot64(global_tid_77314, slice_77317);\n        remnant_77319 = global_tid_77314 - rep_i_77315 * slice_77317;\n        rep_i_77316 = remnant_77319;\n        remnant_77320 = remnant_77319 - rep_i_77316;\n        if (slt64(global_tid_77314, replicate_n_77302)) {\n            int64_t tmp_77321 = ((__global int64_t *) mem_76022)[rep_i_77316];\n            \n            ((__global int64_t *) mem_76027)[rep_i_77315 + rep_i_77316] = tmp_77321;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_70345_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_70345(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_47166, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t max_res_65013, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, int64_t zt_rhs_65019, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75495, __global unsigned char *mem_75504, __global unsigned char *mem_75506)\n{\n    #define segmap_tblock_sizze_70340 (inner_SMJ_longzisegmap_70345zisegmap_tblock_sizze_70340)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76695;\n    int32_t tblock_sizze_76698;\n    int32_t wave_sizze_76", "697;\n    int32_t block_id_76696;\n    int32_t global_tid_76694;\n    int64_t phys_tid_70345;\n    int64_t global_tid_76699;\n    int64_t slice_76700;\n    int64_t gtid_70344;\n    int64_t remnant_76701;\n    \n    local_tid_76695 = get_local_id(0);\n    tblock_sizze_76698 = get_local_size(0);\n    wave_sizze_76697 = LOCKSTEP_WIDTH;\n    block_id_76696 = get_tblock_id(0);\n    global_tid_76694 = block_id_76696 * tblock_sizze_76698 + local_tid_76695;\n    phys_tid_70345 = sext_i32_i64(global_tid_76694);\n    global_tid_76699 = sext_i32_i64(block_id_76696) * segmap_tblock_sizze_70340 + sext_i32_i64(local_tid_76695);\n    slice_76700 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;\n    gtid_70344 = global_tid_76699;\n    remnant_76701 = global_tid_76699 - gtid_70344;\n    if (slt64(gtid_70344, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014)) {\n        int64_t lowest_75411;\n        int64_t index_primexp_73897;\n        int64_t zs_lhs_70347;\n        int64_t index_70348;\n        bool cond_70349;\n        int64_t loop_over_70350;\n        int64_t loop_over_70351;\n        int64_t loop_over_70353;\n        bool defunc_0_f_res_70356;\n        int64_t defunc_0_f_res_70357;\n        int64_t defunc_0_f_res_70358;\n        int64_t defunc_0_f_res_70359;\n        bool loop_while_70360;\n        int64_t p_70361;\n        int64_t p_70362;\n        int64_t p_70363;\n        \n        lowest_75411 = ((__global int64_t *) ext_mem_75495)[(int64_t) 0];\n        index_primexp_73897 = add64(max_res_65013, gtid_70344);\n        zs_lhs_70347 = mul64(zt_rhs_65019, index_primexp_73897);\n        index_70348 = sdiv64(zs_lhs_70347, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n        cond_70349 = slt64(nR_47166, index_70348);\n        if (cond_70349) {\n            loop_over_70350 = nR_47166;\n        } else {\n            loop_over_70350 = index_70348;\n        }\n        if (cond_70349) {\n            int64_t loop_over_t_res_70352 = sub64(index_70348, nR_47166);\n            \n        ",
                                    "    loop_over_70351 = loop_over_t_res_70352;\n        } else {\n            loop_over_70351 = (int64_t) 0;\n        }\n        if (cond_70349) {\n            int64_t zm_lhs_70354;\n            int64_t loop_over_t_res_70355;\n            \n            zm_lhs_70354 = sub64(index_70348, nR_47166);\n            loop_over_t_res_70355 = sub64(zm_lhs_70354, (int64_t) 1);\n            loop_over_70353 = loop_over_t_res_70355;\n        } else {\n            loop_over_70353 = (int64_t) 0;\n        }\n        loop_while_70360 = 1;\n        p_70361 = loop_over_70353;\n        p_70362 = loop_over_70350;\n        p_70363 = loop_over_70351;\n        while (loop_while_70360) {\n            int64_t zs_lhs_70364;\n            int64_t offset_70365;\n            int64_t ai_70366;\n            int64_t max_arg1_70367;\n            int64_t max_res_70368;\n            bool cond_70369;\n            int64_t b_prev_70370;\n            bool cond_70378;\n            int64_t loopres_70379;\n            int64_t loopres_70380;\n            int64_t loopres_70381;\n            bool loopres_70382;\n            bool loop_while_tmp_76702;\n            int64_t p_tmp_76703;\n            int64_t p_tmp_76704;\n            int64_t p_tmp_76705;\n            \n            zs_lhs_70364 = sub64(p_70362, p_70361);\n            offset_70365 = sdiv64(zs_lhs_70364, (int64_t) 2);\n            ai_70366 = sub64(p_70362, offset_70365);\n            max_arg1_70367 = add64(p_70363, offset_70365);\n            max_res_70368 = smax64((int64_t) 0, max_arg1_70367);\n            cond_70369 = slt64((int64_t) 0, max_res_70368);\n            if (cond_70369) {\n                int64_t tmp_70371;\n                bool x_70372;\n                bool y_70373;\n                bool bounds_check_70374;\n                bool index_certs_70375;\n                int64_t slice_70376;\n                int64_t b_prev_t_res_70377;\n                \n                tmp_70371 = sub64(max_res_70368, (int64_t) 1);\n                x_70372 = sle64((int64_t) 0, tmp_70371);\n                y_70373 =", " slt64(tmp_70371, nR_47166);\n                bounds_check_70374 = x_70372 && y_70373;\n                if (!bounds_check_70374) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 108) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_70371;\n                            global_failure_args[1] = (int64_t) nR_47166;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_70376 = tS_start_64840 + tmp_70371;\n                b_prev_t_res_70377 = ((__global int64_t *) tS_mem_75468)[slice_70376];\n                b_prev_70370 = b_prev_t_res_70377;\n            } else {\n                b_prev_70370 = lowest_75411;\n            }\n            cond_70378 = sle64(ai_70366, (int64_t) 0);\n            if (cond_70378) {\n                loopres_70379 = p_70361;\n                loopres_70380 = (int64_t) 0;\n                loopres_70381 = max_res_70368;\n                loopres_70382 = 0;\n            } else {\n                bool cond_70383;\n                int64_t loopres_f_res_70384;\n                int64_t loopres_f_res_70385;\n                int64_t loopres_f_res_70386;\n                bool loopres_f_res_70387;\n                \n                cond_70383 = sle64(nR_47166, max_res_70368);\n                if (cond_70383) {\n                    int64_t min_arg1_70388;\n                    int64_t min_res_70389;\n                    bool x_70390;\n                    bool y_70391;\n                    bool bounds_check_70392;\n                    bool index_certs_70393;\n                    bool x_70396;\n                    bool y_70397;\n                    bool bounds_check_70398;\n                    bool index_certs_70399;\n                    int64_t slice_70394;\n                    int64_t leq_lhs_70395;\n                    int64_t leq_rhs_70400;\n                    bool defunc_0_leq_res_70401;\n                    int64_t loopres_f", "_res_t_res_70402;\n                    bool x_70403;\n                    int64_t loopres_f_res_t_res_70404;\n                    \n                    min_arg1_70388 = sub64(nR_47166, (int64_t) 1);\n                    min_res_70389 = smin64(ai_70366, min_arg1_70388);\n                    x_70390 = sle64((int64_t) 0, min_arg1_70388);\n                    y_70391 = slt64(min_arg1_70388, nR_47166);\n                    bounds_check_70392 = x_70390 && y_70391;\n                    if (!bounds_check_70392) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 109) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_70388;\n                                global_failure_args[1] = (int64_t) nR_47166;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_70396 = sle64((int64_t) 0, min_res_70389);\n                    y_70397 = slt64(min_res_70389, nR_47166);\n                    bounds_check_70398 = x_70396 && y_70397;\n                    if (!bounds_check_70398) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 110) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_70389;\n                                global_failure_args[1] = (int64_t) nR_47166;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_70394 = tS_start_64840 + min_arg1_70388;\n                    leq_lhs_70395 = ((__global int64_t *) tS_mem_75468)[slice_70394];\n                    leq_rhs_70400 = ((__global int64_t *) tR_mem_75467)[min_res_70389];\n                    defunc_0_leq_res_70401 = sle64(leq_lhs_70395, leq_rhs_70400);\n                    if (defunc_0_leq_res_70401) {\n                        loopres_f_res_t",
                                    "_res_70402 = ai_70366;\n                    } else {\n                        loopres_f_res_t_res_70402 = p_70362;\n                    }\n                    x_70403 = !defunc_0_leq_res_70401;\n                    if (defunc_0_leq_res_70401) {\n                        loopres_f_res_t_res_70404 = nR_47166;\n                    } else {\n                        int64_t tmp_70405 = sub64(min_arg1_70388, offset_70365);\n                        \n                        loopres_f_res_t_res_70404 = tmp_70405;\n                    }\n                    loopres_f_res_70384 = p_70361;\n                    loopres_f_res_70385 = loopres_f_res_t_res_70402;\n                    loopres_f_res_70386 = loopres_f_res_t_res_70404;\n                    loopres_f_res_70387 = x_70403;\n                } else {\n                    bool cond_70406;\n                    int64_t loopres_f_res_f_res_70407;\n                    int64_t loopres_f_res_f_res_70408;\n                    int64_t loopres_f_res_f_res_70409;\n                    bool loopres_f_res_f_res_70410;\n                    \n                    cond_70406 = sle64(nR_47166, ai_70366);\n                    if (cond_70406) {\n                        int64_t min_arg1_70411;\n                        int64_t min_res_70412;\n                        bool x_70413;\n                        bool y_70414;\n                        bool bounds_check_70415;\n                        bool index_certs_70416;\n                        bool x_70418;\n                        bool y_70419;\n                        bool bounds_check_70420;\n                        bool index_certs_70421;\n                        int64_t leq_lhs_70417;\n                        int64_t slice_70422;\n                        int64_t leq_rhs_70423;\n                        bool defunc_0_leq_res_70424;\n                        int64_t loopres_f_res_f_res_t_res_70425;\n                        bool x_70426;\n                        int64_t loopres_f_res_f_res_t_res_70427;\n                        \n              ", "          min_arg1_70411 = sub64(nR_47166, (int64_t) 1);\n                        min_res_70412 = smin64(max_res_70368, min_arg1_70411);\n                        x_70413 = sle64((int64_t) 0, min_arg1_70411);\n                        y_70414 = slt64(min_arg1_70411, nR_47166);\n                        bounds_check_70415 = x_70413 && y_70414;\n                        if (!bounds_check_70415) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 111) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_70411;\n                                    global_failure_args[1] = (int64_t) nR_47166;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_70418 = sle64((int64_t) 0, min_res_70412);\n                        y_70419 = slt64(min_res_70412, nR_47166);\n                        bounds_check_70420 = x_70418 && y_70419;\n                        if (!bounds_check_70420) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 112) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_70412;\n                                    global_failure_args[1] = (int64_t) nR_47166;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_70417 = ((__global int64_t *) tR_mem_75467)[min_arg1_70411];\n                        slice_70422 = tS_start_64840 + min_res_70412;\n                        leq_rhs_70423 = ((__global int64_t *) tS_mem_75468)[slice_70422];\n                        defunc_0_leq_res_70424 = sle64(leq_lhs_70417, leq_rhs_70423);\n                        if (defunc_0_leq_res_70424) {\n                            loopres_f_res_f_", "res_t_res_70425 = max_res_70368;\n                        } else {\n                            loopres_f_res_f_res_t_res_70425 = p_70363;\n                        }\n                        x_70426 = !defunc_0_leq_res_70424;\n                        if (defunc_0_leq_res_70424) {\n                            loopres_f_res_f_res_t_res_70427 = nR_47166;\n                        } else {\n                            loopres_f_res_f_res_t_res_70427 = min_arg1_70411;\n                        }\n                        loopres_f_res_f_res_70407 = p_70361;\n                        loopres_f_res_f_res_70408 = loopres_f_res_f_res_t_res_70427;\n                        loopres_f_res_f_res_70409 = loopres_f_res_f_res_t_res_70425;\n                        loopres_f_res_f_res_70410 = x_70426;\n                    } else {\n                        bool cond_70428;\n                        int64_t loopres_f_res_f_res_f_res_70429;\n                        int64_t loopres_f_res_f_res_f_res_70430;\n                        int64_t loopres_f_res_f_res_f_res_70431;\n                        bool loopres_f_res_f_res_f_res_70432;\n                        \n                        cond_70428 = sle64(p_70362, p_70361);\n                        if (cond_70428) {\n                            bool cond_70433;\n                            int64_t ai_70434;\n                            bool x_70447;\n                            bool y_70448;\n                            bool bounds_check_70449;\n                            bool index_certs_70450;\n                            int64_t b_prev_70436;\n                            int64_t gt_lhs_70451;\n                            bool defunc_0_gt_res_70452;\n                            int64_t defunc_0_partFunc_sequential_search_res_70453;\n                            int64_t defunc_0_partFunc_sequential_search_res_70454;\n                            \n                            cond_70433 = slt64(ai_70366, nR_47166);\n                            if (cond_70433) {\n                      ",
                                    "          ai_70434 = ai_70366;\n                            } else {\n                                int64_t ai_f_res_70435 = sub64(nR_47166, (int64_t) 1);\n                                \n                                ai_70434 = ai_f_res_70435;\n                            }\n                            x_70447 = sle64((int64_t) 0, ai_70434);\n                            y_70448 = slt64(ai_70434, nR_47166);\n                            bounds_check_70449 = x_70447 && y_70448;\n                            if (!bounds_check_70449) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 113) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_70434;\n                                        global_failure_args[1] = (int64_t) nR_47166;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_70369) {\n                                int64_t tmp_70437;\n                                bool x_70438;\n                                bool y_70439;\n                                bool bounds_check_70440;\n                                bool index_certs_70441;\n                                int64_t slice_70442;\n                                int64_t b_prev_t_res_70443;\n                                \n                                tmp_70437 = sub64(max_res_70368, (int64_t) 1);\n                                x_70438 = sle64((int64_t) 0, tmp_70437);\n                                y_70439 = slt64(tmp_70437, nR_47166);\n                                bounds_check_70440 = x_70438 && y_70439;\n                                if (!bounds_check_70440) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 114) == -1) {\n                              ", "              global_failure_args[0] = (int64_t) tmp_70437;\n                                            global_failure_args[1] = (int64_t) nR_47166;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_70442 = tS_start_64840 + tmp_70437;\n                                b_prev_t_res_70443 = ((__global int64_t *) tS_mem_75468)[slice_70442];\n                                b_prev_70436 = b_prev_t_res_70443;\n                            } else {\n                                bool y_70444;\n                                bool index_certs_70445;\n                                int64_t b_prev_f_res_70446;\n                                \n                                y_70444 = slt64((int64_t) 0, nR_47166);\n                                if (!y_70444) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 115) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_47166;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_70446 = ((__global int64_t *) tS_mem_75468)[tS_start_64840];\n                                b_prev_70436 = b_prev_f_res_70446;\n                            }\n                            gt_lhs_70451 = ((__global int64_t *) tR_mem_75467)[ai_70434];\n                            defunc_0_gt_res_70452 = slt64(b_prev_70436, gt_lhs_70451);\n                            if (defunc_0_gt_res_70452) {\n                                int64_t zl_rhs_70455;\n                         ", "       bool loop_cond_70456;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_70457;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_70458;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_70459;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_70460;\n                                bool loop_while_70461;\n                                int64_t p_70462;\n                                int64_t p_70463;\n                                int64_t p_70464;\n                                \n                                zl_rhs_70455 = sub64(nR_47166, max_res_70368);\n                                loop_cond_70456 = slt64((int64_t) 0, zl_rhs_70455);\n                                loop_while_70461 = loop_cond_70456;\n                                p_70462 = ai_70434;\n                                p_70463 = max_res_70368;\n                                p_70464 = (int64_t) 0;\n                                while (loop_while_70461) {\n                                    int64_t i_a_70465;\n                                    int64_t i_b_70466;\n                                    int64_t leq_lhs_70467;\n                                    bool x_70468;\n                                    bool y_70469;\n                                    bool bounds_check_70470;\n                                    bool index_certs_70471;\n                                    bool x_70473;\n                                    bool y_70474;\n                                    bool bounds_check_70475;\n                                    bool index_certs_70476;\n                                    int64_t leq_lhs_70472;\n                                    int64_t slice_70477;\n                                    int64_t leq_rhs_70478;\n                                    bool defunc_0_leq_res_70479;\n                                    int64_t loopres_70480;\n   ",
                                    "                                 int64_t loopres_70481;\n                                    int64_t loopres_70482;\n                                    bool loop_cond_70484;\n                                    bool loop_while_tmp_76706;\n                                    int64_t p_tmp_76707;\n                                    int64_t p_tmp_76708;\n                                    int64_t p_tmp_76709;\n                                    \n                                    i_a_70465 = sub64(ai_70434, p_70464);\n                                    i_b_70466 = add64(max_res_70368, p_70464);\n                                    leq_lhs_70467 = sub64(i_a_70465, (int64_t) 1);\n                                    x_70468 = sle64((int64_t) 0, leq_lhs_70467);\n                                    y_70469 = slt64(leq_lhs_70467, nR_47166);\n                                    bounds_check_70470 = x_70468 && y_70469;\n                                    if (!bounds_check_70470) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 116) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_70467;\n                                                global_failure_args[1] = (int64_t) nR_47166;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_70473 = sle64((int64_t) 0, i_b_70466);\n                                    y_70474 = slt64(i_b_70466, nR_47166);\n                                    bounds_check_70475 = x_70473 && y_70474;\n                                    if (!bounds_check_70475) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 117) == -1) {\n           ", "                                     global_failure_args[0] = (int64_t) i_b_70466;\n                                                global_failure_args[1] = (int64_t) nR_47166;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_70472 = ((__global int64_t *) tR_mem_75467)[leq_lhs_70467];\n                                    slice_70477 = tS_start_64840 + i_b_70466;\n                                    leq_rhs_70478 = ((__global int64_t *) tS_mem_75468)[slice_70477];\n                                    defunc_0_leq_res_70479 = sle64(leq_lhs_70472, leq_rhs_70478);\n                                    if (defunc_0_leq_res_70479) {\n                                        loopres_70480 = i_a_70465;\n                                    } else {\n                                        loopres_70480 = ai_70434;\n                                    }\n                                    if (defunc_0_leq_res_70479) {\n                                        loopres_70481 = i_b_70466;\n                                    } else {\n                                        loopres_70481 = max_res_70368;\n                                    }\n                                    if (defunc_0_leq_res_70479) {\n                                        loopres_70482 = zl_rhs_70455;\n                                    } else {\n                                        int64_t tmp_70483 = add64((int64_t) 1, p_70464);\n                                        \n                                        loopres_70482 = tmp_70483;\n                                    }\n                                    loop_cond_70484 = slt64(loopres_70482, zl_rhs_70455);\n                                    loop_while_tmp_76706 = loop_cond_70484;\n                                    p_tmp_76707 = loopres_70480", ";\n                                    p_tmp_76708 = loopres_70481;\n                                    p_tmp_76709 = loopres_70482;\n                                    loop_while_70461 = loop_while_tmp_76706;\n                                    p_70462 = p_tmp_76707;\n                                    p_70463 = p_tmp_76708;\n                                    p_70464 = p_tmp_76709;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_70457 = loop_while_70461;\n                                defunc_0_partFunc_sequential_search_res_t_res_70458 = p_70462;\n                                defunc_0_partFunc_sequential_search_res_t_res_70459 = p_70463;\n                                defunc_0_partFunc_sequential_search_res_t_res_70460 = p_70464;\n                                defunc_0_partFunc_sequential_search_res_70453 = defunc_0_partFunc_sequential_search_res_t_res_70458;\n                                defunc_0_partFunc_sequential_search_res_70454 = defunc_0_partFunc_sequential_search_res_t_res_70459;\n                            } else {\n                                int64_t zl_rhs_70485;\n                                bool loop_cond_70486;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_70487;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70488;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70489;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_70490;\n                                bool loop_while_70491;\n                                int64_t p_70492;\n                                int64_t p_70493;\n                                int64_t p_70494;\n                                \n                                zl_rhs_70485 = sub64(max_res_70368, (int64_t) 1);\n                                loop_cond_70486 = slt64((int64_t) 0, zl_rhs_70485);\n          ",
                                    "                      loop_while_70491 = loop_cond_70486;\n                                p_70492 = ai_70434;\n                                p_70493 = max_res_70368;\n                                p_70494 = (int64_t) 0;\n                                while (loop_while_70491) {\n                                    int64_t zp_lhs_70495;\n                                    int64_t hi_a_70496;\n                                    bool cond_70497;\n                                    int64_t i_a_70498;\n                                    int64_t zm_lhs_70500;\n                                    int64_t i_b_70501;\n                                    bool x_70502;\n                                    bool y_70503;\n                                    bool bounds_check_70504;\n                                    bool index_certs_70505;\n                                    bool x_70507;\n                                    bool y_70508;\n                                    bool bounds_check_70509;\n                                    bool index_certs_70510;\n                                    int64_t gt_lhs_70506;\n                                    int64_t slice_70511;\n                                    int64_t gt_rhs_70512;\n                                    bool defunc_0_gt_res_70513;\n                                    int64_t loopres_70514;\n                                    int64_t loopres_70515;\n                                    int64_t loopres_70516;\n                                    bool loop_cond_70518;\n                                    bool loop_while_tmp_76710;\n                                    int64_t p_tmp_76711;\n                                    int64_t p_tmp_76712;\n                                    int64_t p_tmp_76713;\n                                    \n                                    zp_lhs_70495 = add64(ai_70434, p_70494);\n                                    hi_a_70496 = add64((int64_t) 1, zp_lhs_70495);\n                                    con", "d_70497 = slt64(hi_a_70496, nR_47166);\n                                    if (cond_70497) {\n                                        i_a_70498 = hi_a_70496;\n                                    } else {\n                                        int64_t i_a_f_res_70499 = sub64(nR_47166, (int64_t) 1);\n                                        \n                                        i_a_70498 = i_a_f_res_70499;\n                                    }\n                                    zm_lhs_70500 = sub64(max_res_70368, p_70494);\n                                    i_b_70501 = sub64(zm_lhs_70500, (int64_t) 1);\n                                    x_70502 = sle64((int64_t) 0, i_a_70498);\n                                    y_70503 = slt64(i_a_70498, nR_47166);\n                                    bounds_check_70504 = x_70502 && y_70503;\n                                    if (!bounds_check_70504) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 118) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_70498;\n                                                global_failure_args[1] = (int64_t) nR_47166;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_70507 = sle64((int64_t) 0, i_b_70501);\n                                    y_70508 = slt64(i_b_70501, nR_47166);\n                                    bounds_check_70509 = x_70507 && y_70508;\n                                    if (!bounds_check_70509) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 119) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_70501;", "\n                                                global_failure_args[1] = (int64_t) nR_47166;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_70506 = ((__global int64_t *) tR_mem_75467)[i_a_70498];\n                                    slice_70511 = tS_start_64840 + i_b_70501;\n                                    gt_rhs_70512 = ((__global int64_t *) tS_mem_75468)[slice_70511];\n                                    defunc_0_gt_res_70513 = slt64(gt_rhs_70512, gt_lhs_70506);\n                                    if (defunc_0_gt_res_70513) {\n                                        loopres_70514 = i_a_70498;\n                                    } else {\n                                        loopres_70514 = ai_70434;\n                                    }\n                                    if (defunc_0_gt_res_70513) {\n                                        loopres_70515 = zm_lhs_70500;\n                                    } else {\n                                        loopres_70515 = max_res_70368;\n                                    }\n                                    if (defunc_0_gt_res_70513) {\n                                        loopres_70516 = zl_rhs_70485;\n                                    } else {\n                                        int64_t tmp_70517 = add64((int64_t) 1, p_70494);\n                                        \n                                        loopres_70516 = tmp_70517;\n                                    }\n                                    loop_cond_70518 = slt64(loopres_70516, zl_rhs_70485);\n                                    loop_while_tmp_76710 = loop_cond_70518;\n                                    p_tmp_76711 = loopres_70514;\n                                    p_tmp_76712 = loopres_70515;\n                        ",
                                    "            p_tmp_76713 = loopres_70516;\n                                    loop_while_70491 = loop_while_tmp_76710;\n                                    p_70492 = p_tmp_76711;\n                                    p_70493 = p_tmp_76712;\n                                    p_70494 = p_tmp_76713;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_70487 = loop_while_70491;\n                                defunc_0_partFunc_sequential_search_res_f_res_70488 = p_70492;\n                                defunc_0_partFunc_sequential_search_res_f_res_70489 = p_70493;\n                                defunc_0_partFunc_sequential_search_res_f_res_70490 = p_70494;\n                                defunc_0_partFunc_sequential_search_res_70453 = defunc_0_partFunc_sequential_search_res_f_res_70488;\n                                defunc_0_partFunc_sequential_search_res_70454 = defunc_0_partFunc_sequential_search_res_f_res_70489;\n                            }\n                            loopres_f_res_f_res_f_res_70429 = p_70361;\n                            loopres_f_res_f_res_f_res_70430 = defunc_0_partFunc_sequential_search_res_70453;\n                            loopres_f_res_f_res_f_res_70431 = defunc_0_partFunc_sequential_search_res_70454;\n                            loopres_f_res_f_res_f_res_70432 = 0;\n                        } else {\n                            bool x_70519;\n                            bool y_70520;\n                            bool bounds_check_70521;\n                            bool index_certs_70522;\n                            int64_t gt_lhs_70523;\n                            bool defunc_0_gt_res_70524;\n                            int64_t loopres_f_res_f_res_f_res_f_res_70525;\n                            int64_t loopres_f_res_f_res_f_res_f_res_70526;\n                            int64_t loopres_f_res_f_res_f_res_f_res_70527;\n                            bool loopres_f_res_f_res_f_res_f_res_70528;\n       ", "                     \n                            x_70519 = sle64((int64_t) 0, ai_70366);\n                            y_70520 = slt64(ai_70366, nR_47166);\n                            bounds_check_70521 = x_70519 && y_70520;\n                            if (!bounds_check_70521) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 120) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_70366;\n                                        global_failure_args[1] = (int64_t) nR_47166;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_70523 = ((__global int64_t *) tR_mem_75467)[ai_70366];\n                            defunc_0_gt_res_70524 = slt64(b_prev_70370, gt_lhs_70523);\n                            if (defunc_0_gt_res_70524) {\n                                int64_t leq_lhs_70529;\n                                bool x_70530;\n                                bool y_70531;\n                                bool bounds_check_70532;\n                                bool index_certs_70533;\n                                bool x_70535;\n                                bool y_70536;\n                                bool bounds_check_70537;\n                                bool index_certs_70538;\n                                int64_t leq_lhs_70534;\n                                int64_t slice_70539;\n                                int64_t leq_rhs_70540;\n                                bool defunc_0_leq_res_70541;\n                                bool x_70542;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_70543;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_70544;\n                                \n                                leq_lhs_70529 = sub64(ai_", "70366, (int64_t) 1);\n                                x_70530 = sle64((int64_t) 0, leq_lhs_70529);\n                                y_70531 = slt64(leq_lhs_70529, nR_47166);\n                                bounds_check_70532 = x_70530 && y_70531;\n                                if (!bounds_check_70532) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 121) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_70529;\n                                            global_failure_args[1] = (int64_t) nR_47166;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_70535 = sle64((int64_t) 0, max_res_70368);\n                                y_70536 = slt64(max_res_70368, nR_47166);\n                                bounds_check_70537 = x_70535 && y_70536;\n                                if (!bounds_check_70537) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 122) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_70368;\n                                            global_failure_args[1] = (int64_t) nR_47166;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_70534 = ((__global int64_t *) tR_mem_75467)[leq_lhs_70529];\n                                slice_70539 = tS_start_64840 + max_res_70368;\n                                leq_rhs_70540 = ((__global int64_t *) tS_mem_75468)[slice_70539];\n                                defunc_0_leq_res_70541 = sle64(leq_lhs_",
                                    "70534, leq_rhs_70540);\n                                x_70542 = !defunc_0_leq_res_70541;\n                                if (defunc_0_leq_res_70541) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70543 = ai_70366;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70543 = leq_lhs_70529;\n                                }\n                                if (defunc_0_leq_res_70541) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_70544 = max_res_70368;\n                                } else {\n                                    int64_t tmp_70545 = add64((int64_t) 1, max_res_70368);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_70544 = tmp_70545;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_70525 = p_70361;\n                                loopres_f_res_f_res_f_res_f_res_70526 = loopres_f_res_f_res_f_res_f_res_t_res_70543;\n                                loopres_f_res_f_res_f_res_f_res_70527 = loopres_f_res_f_res_f_res_f_res_t_res_70544;\n                                loopres_f_res_f_res_f_res_f_res_70528 = x_70542;\n                            } else {\n                                int64_t tmp_70546 = add64((int64_t) 1, ai_70366);\n                                \n                                loopres_f_res_f_res_f_res_f_res_70525 = tmp_70546;\n                                loopres_f_res_f_res_f_res_f_res_70526 = p_70362;\n                                loopres_f_res_f_res_f_res_f_res_70527 = p_70363;\n                                loopres_f_res_f_res_f_res_f_res_70528 = 1;\n                            }\n                            loopres_f_res_f_res_f_res_70429 = loopres_f_res_f_res_f_res_f_res_70525;\n                            loopres_f_res_f_res_f_res_70430 = loopres_f_res_f_res_f_res_f_res_70526;\n                            l", "oopres_f_res_f_res_f_res_70431 = loopres_f_res_f_res_f_res_f_res_70527;\n                            loopres_f_res_f_res_f_res_70432 = loopres_f_res_f_res_f_res_f_res_70528;\n                        }\n                        loopres_f_res_f_res_70407 = loopres_f_res_f_res_f_res_70429;\n                        loopres_f_res_f_res_70408 = loopres_f_res_f_res_f_res_70430;\n                        loopres_f_res_f_res_70409 = loopres_f_res_f_res_f_res_70431;\n                        loopres_f_res_f_res_70410 = loopres_f_res_f_res_f_res_70432;\n                    }\n                    loopres_f_res_70384 = loopres_f_res_f_res_70407;\n                    loopres_f_res_70385 = loopres_f_res_f_res_70408;\n                    loopres_f_res_70386 = loopres_f_res_f_res_70409;\n                    loopres_f_res_70387 = loopres_f_res_f_res_70410;\n                }\n                loopres_70379 = loopres_f_res_70384;\n                loopres_70380 = loopres_f_res_70385;\n                loopres_70381 = loopres_f_res_70386;\n                loopres_70382 = loopres_f_res_70387;\n            }\n            loop_while_tmp_76702 = loopres_70382;\n            p_tmp_76703 = loopres_70379;\n            p_tmp_76704 = loopres_70380;\n            p_tmp_76705 = loopres_70381;\n            loop_while_70360 = loop_while_tmp_76702;\n            p_70361 = p_tmp_76703;\n            p_70362 = p_tmp_76704;\n            p_70363 = p_tmp_76705;\n        }\n        defunc_0_f_res_70356 = loop_while_70360;\n        defunc_0_f_res_70357 = p_70361;\n        defunc_0_f_res_70358 = p_70362;\n        defunc_0_f_res_70359 = p_70363;\n        ((__global int64_t *) mem_75504)[gtid_70344] = defunc_0_f_res_70358;\n        ((__global int64_t *) mem_75506)[gtid_70344] = defunc_0_f_res_70359;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70340\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_70719_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_70719(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failu", "re_args, int64_t nR_47166, int64_t gt_rhs_64823, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t zeze_rhs_65256, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75486, __global unsigned char *mem_75488, __global unsigned char *mem_75522, __global unsigned char *mem_75524)\n{\n    #define segmap_tblock_sizze_70714 (inner_SMJ_longzisegmap_70719zisegmap_tblock_sizze_70714)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76718;\n    int32_t tblock_sizze_76721;\n    int32_t wave_sizze_76720;\n    int32_t block_id_76719;\n    int32_t global_tid_76717;\n    int64_t phys_tid_70719;\n    int64_t global_tid_76722;\n    int64_t slice_76723;\n    int64_t gtid_70718;\n    int64_t remnant_76724;\n    \n    local_tid_76718 = get_local_id(0);\n    tblock_sizze_76721 = get_local_size(0);\n    wave_sizze_76720 = LOCKSTEP_WIDTH;\n    block_id_76719 = get_tblock_id(0);\n    global_tid_76717 = block_id_76719 * tblock_sizze_76721 + local_tid_76718;\n    phys_tid_70719 = sext_i32_i64(global_tid_76717);\n    global_tid_76722 = sext_i32_i64(block_id_76719) * segmap_tblock_sizze_70714 + sext_i32_i64(local_tid_76718);\n    slice_76723 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n    gtid_70718 = global_tid_76722;\n    remnant_76724 = global_tid_76722 - gtid_70718;\n    if (slt64(gtid_70718, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982)) {\n        int64_t eta_p_70721;\n        int64_t min_res_70722;\n        bool x_70723;\n        bool y_70724;\n        bool bounds_check_70725;\n        bool index_certs_70726;\n        bool cond_70728;\n        int64_t ri_next_70729;\n        int64_t max_arg1_70736;\n        int64_t max_res_70737;\n        bool x_70738;\n        bool y_70739;\n        bool bounds_check_70740;\n        bool index_certs_70741;\n        int64_t r_min_70727;\n        int64_t r_max_70742;\n        bool defunc_0_f_res_70743;\n       ",
                                    " int64_t defunc_0_f_res_70744;\n        bool loop_while_70745;\n        int64_t fm_70746;\n        bool defunc_0_f_res_70812;\n        int64_t defunc_0_f_res_70813;\n        bool loop_while_70814;\n        int64_t lm_70815;\n        \n        eta_p_70721 = ((__global int64_t *) mem_75486)[gtid_70718];\n        min_res_70722 = smin64(gt_rhs_64823, eta_p_70721);\n        x_70723 = sle64((int64_t) 0, min_res_70722);\n        y_70724 = slt64(min_res_70722, nR_47166);\n        bounds_check_70725 = x_70723 && y_70724;\n        if (!bounds_check_70725) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 123) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_70722;\n                    global_failure_args[1] = (int64_t) nR_47166;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_70728 = gtid_70718 == zeze_rhs_65256;\n        if (cond_70728) {\n            ri_next_70729 = nR_47166;\n        } else {\n            int64_t tmp_70730;\n            bool x_70731;\n            bool y_70732;\n            bool bounds_check_70733;\n            bool index_certs_70734;\n            int64_t ri_next_f_res_70735;\n            \n            tmp_70730 = add64((int64_t) 1, gtid_70718);\n            x_70731 = sle64((int64_t) 0, tmp_70730);\n            y_70732 = slt64(tmp_70730, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_70733 = x_70731 && y_70732;\n            if (!bounds_check_70733) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 124) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_70730;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_70735 = ((__global int64_t *) mem_75486)[tmp_70730];\n   ", "         ri_next_70729 = ri_next_f_res_70735;\n        }\n        max_arg1_70736 = sub64(ri_next_70729, (int64_t) 1);\n        max_res_70737 = smax64((int64_t) 0, max_arg1_70736);\n        x_70738 = sle64((int64_t) 0, max_res_70737);\n        y_70739 = slt64(max_res_70737, nR_47166);\n        bounds_check_70740 = x_70738 && y_70739;\n        if (!bounds_check_70740) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 125) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_70737;\n                    global_failure_args[1] = (int64_t) nR_47166;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_70727 = ((__global int64_t *) tR_mem_75467)[min_res_70722];\n        r_max_70742 = ((__global int64_t *) tR_mem_75467)[max_res_70737];\n        loop_while_70745 = 1;\n        fm_70746 = gtid_70718;\n        while (loop_while_70745) {\n            bool x_70747;\n            bool y_70748;\n            bool bounds_check_70749;\n            bool index_certs_70750;\n            int64_t loopres_70751;\n            int64_t min_res_70752;\n            bool x_70753;\n            bool y_70754;\n            bool bounds_check_70755;\n            bool index_certs_70756;\n            bool cond_70759;\n            int64_t si_next_70760;\n            int64_t max_arg1_70767;\n            int64_t max_res_70768;\n            bool x_70769;\n            bool y_70770;\n            bool bounds_check_70771;\n            bool index_certs_70772;\n            int64_t min_res_70775;\n            bool x_70776;\n            bool y_70777;\n            bool bounds_check_70778;\n            bool index_certs_70779;\n            int64_t max_arg1_70782;\n            int64_t max_res_70783;\n            bool x_70784;\n            bool y_70785;\n            bool bounds_check_70786;\n            bool index_certs_70787;\n            int64_t slice_70757;\n            int64_t s_min_70758;\n            int64_t slice_70773;\n            int64_t slice_70780;\n       ", "     int64_t slice_70788;\n            bool defunc_0_gt_res_70790;\n            bool loopres_70791;\n            int64_t loopres_70792;\n            bool loop_while_tmp_76725;\n            int64_t fm_tmp_76726;\n            \n            x_70747 = sle64((int64_t) 0, fm_70746);\n            y_70748 = slt64(fm_70746, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_70749 = x_70747 && y_70748;\n            if (!bounds_check_70749) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 126) == -1) {\n                        global_failure_args[0] = (int64_t) fm_70746;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_70751 = ((__global int64_t *) mem_75488)[fm_70746];\n            min_res_70752 = smin64(gt_rhs_64823, loopres_70751);\n            x_70753 = sle64((int64_t) 0, min_res_70752);\n            y_70754 = slt64(min_res_70752, nR_47166);\n            bounds_check_70755 = x_70753 && y_70754;\n            if (!bounds_check_70755) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 127) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70752;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_70759 = sle64(zeze_rhs_65256, fm_70746);\n            if (cond_70759) {\n                si_next_70760 = nR_47166;\n            } else {\n                int64_t tmp_70761;\n                bool x_70762;\n                bool y_70763;\n                bool bounds_check_70764;\n                bool index_certs_70765;\n                int64_t si_next_f_res_70766;\n                \n                tmp_70761 = add64((int64",
                                    "_t) 1, fm_70746);\n                x_70762 = sle64((int64_t) 0, tmp_70761);\n                y_70763 = slt64(tmp_70761, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_70764 = x_70762 && y_70763;\n                if (!bounds_check_70764) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 128) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_70761;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_70766 = ((__global int64_t *) mem_75488)[tmp_70761];\n                si_next_70760 = si_next_f_res_70766;\n            }\n            max_arg1_70767 = sub64(si_next_70760, (int64_t) 1);\n            max_res_70768 = smax64(min_res_70752, max_arg1_70767);\n            x_70769 = sle64((int64_t) 0, max_res_70768);\n            y_70770 = slt64(max_res_70768, nR_47166);\n            bounds_check_70771 = x_70769 && y_70770;\n            if (!bounds_check_70771) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 129) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70768;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_70775 = smin64(zeze_rhs_65256, si_next_70760);\n            x_70776 = sle64((int64_t) 0, min_res_70775);\n            y_70777 = slt64(min_res_70775, nR_47166);\n            bounds_check_70778 = x_70776 && y_70777;\n            if (!bounds_check_70778) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 130) == -1) {\n                        global_failure_args[0] = (int64_t) ", "min_res_70775;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_70782 = sub64(min_res_70752, (int64_t) 1);\n            max_res_70783 = smax64((int64_t) 0, max_arg1_70782);\n            x_70784 = sle64((int64_t) 0, max_res_70783);\n            y_70785 = slt64(max_res_70783, nR_47166);\n            bounds_check_70786 = x_70784 && y_70785;\n            if (!bounds_check_70786) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 131) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70783;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_70757 = tS_start_64840 + min_res_70752;\n            s_min_70758 = ((__global int64_t *) tS_mem_75468)[slice_70757];\n            slice_70773 = tS_start_64840 + max_res_70768;\n            slice_70780 = tS_start_64840 + min_res_70775;\n            slice_70788 = tS_start_64840 + max_res_70783;\n            defunc_0_gt_res_70790 = slt64(s_min_70758, r_min_70727);\n            if (defunc_0_gt_res_70790) {\n                int64_t s_max_70774;\n                bool defunc_0_leq_res_70793;\n                bool loopres_t_res_70794;\n                int64_t loopres_t_res_70795;\n                \n                s_max_70774 = ((__global int64_t *) tS_mem_75468)[slice_70773];\n                defunc_0_leq_res_70793 = sle64(r_min_70727, s_max_70774);\n                if (defunc_0_leq_res_70793) {\n                    loopres_t_res_70794 = 0;\n                    loopres_t_res_70795 = fm_70746;\n                } else {\n                    int64_t s_nextMin_70781;\n                    bool defunc_0_leq_res_70796;\n                    int64_t zgze_lhs_70797;\n                    bool tmp_f_res_70798;\n                 ", "   bool x_70799;\n                    bool y_70800;\n                    bool tmp_70801;\n                    bool loopres_t_res_f_res_70802;\n                    \n                    s_nextMin_70781 = ((__global int64_t *) tS_mem_75468)[slice_70780];\n                    defunc_0_leq_res_70796 = sle64(r_min_70727, s_nextMin_70781);\n                    zgze_lhs_70797 = add64((int64_t) 1, fm_70746);\n                    tmp_f_res_70798 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zgze_lhs_70797);\n                    x_70799 = !defunc_0_leq_res_70796;\n                    y_70800 = tmp_f_res_70798 && x_70799;\n                    tmp_70801 = defunc_0_leq_res_70796 || y_70800;\n                    loopres_t_res_f_res_70802 = !tmp_70801;\n                    loopres_t_res_70794 = loopres_t_res_f_res_70802;\n                    loopres_t_res_70795 = zgze_lhs_70797;\n                }\n                loopres_70791 = loopres_t_res_70794;\n                loopres_70792 = loopres_t_res_70795;\n            } else {\n                int64_t s_prevMax_70789;\n                bool defunc_0_leq_res_70803;\n                int64_t zlze_lhs_70804;\n                bool tmp_f_res_70805;\n                bool x_70806;\n                bool y_70807;\n                bool tmp_70808;\n                int64_t max_res_70809;\n                bool loopres_f_res_70810;\n                \n                s_prevMax_70789 = ((__global int64_t *) tS_mem_75468)[slice_70788];\n                defunc_0_leq_res_70803 = sle64(s_prevMax_70789, r_min_70727);\n                zlze_lhs_70804 = sub64(fm_70746, (int64_t) 1);\n                tmp_f_res_70805 = sle64(zlze_lhs_70804, (int64_t) 0);\n                x_70806 = !defunc_0_leq_res_70803;\n                y_70807 = tmp_f_res_70805 && x_70806;\n                tmp_70808 = defunc_0_leq_res_70803 || y_70807;\n                max_res_70809 = smax64((int64_t) 0, zlze_lhs_70804);\n                loopres_f_res_70810 = !tmp_70808;\n                loopres_7",
                                    "0791 = loopres_f_res_70810;\n                loopres_70792 = max_res_70809;\n            }\n            loop_while_tmp_76725 = loopres_70791;\n            fm_tmp_76726 = loopres_70792;\n            loop_while_70745 = loop_while_tmp_76725;\n            fm_70746 = fm_tmp_76726;\n        }\n        defunc_0_f_res_70743 = loop_while_70745;\n        defunc_0_f_res_70744 = fm_70746;\n        loop_while_70814 = 1;\n        lm_70815 = gtid_70718;\n        while (loop_while_70814) {\n            bool x_70816;\n            bool y_70817;\n            bool bounds_check_70818;\n            bool index_certs_70819;\n            int64_t loopres_70820;\n            int64_t min_res_70821;\n            bool x_70822;\n            bool y_70823;\n            bool bounds_check_70824;\n            bool index_certs_70825;\n            bool cond_70828;\n            int64_t si_next_70829;\n            int64_t max_arg1_70836;\n            int64_t max_res_70837;\n            bool x_70838;\n            bool y_70839;\n            bool bounds_check_70840;\n            bool index_certs_70841;\n            int64_t min_res_70844;\n            bool x_70845;\n            bool y_70846;\n            bool bounds_check_70847;\n            bool index_certs_70848;\n            int64_t max_arg1_70851;\n            int64_t max_res_70852;\n            bool x_70853;\n            bool y_70854;\n            bool bounds_check_70855;\n            bool index_certs_70856;\n            int64_t slice_70826;\n            int64_t slice_70842;\n            int64_t s_max_70843;\n            int64_t slice_70849;\n            int64_t slice_70857;\n            bool defunc_0_gt_res_70859;\n            bool loopres_70860;\n            int64_t loopres_70861;\n            bool loop_cond_t_res_70876;\n            bool x_70877;\n            bool loop_while_tmp_76727;\n            int64_t lm_tmp_76728;\n            \n            x_70816 = sle64((int64_t) 0, lm_70815);\n            y_70817 = slt64(lm_70815, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            b", "ounds_check_70818 = x_70816 && y_70817;\n            if (!bounds_check_70818) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 132) == -1) {\n                        global_failure_args[0] = (int64_t) lm_70815;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_70820 = ((__global int64_t *) mem_75488)[lm_70815];\n            min_res_70821 = smin64(gt_rhs_64823, loopres_70820);\n            x_70822 = sle64((int64_t) 0, min_res_70821);\n            y_70823 = slt64(min_res_70821, nR_47166);\n            bounds_check_70824 = x_70822 && y_70823;\n            if (!bounds_check_70824) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 133) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70821;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_70828 = sle64(zeze_rhs_65256, lm_70815);\n            if (cond_70828) {\n                si_next_70829 = nR_47166;\n            } else {\n                int64_t tmp_70830;\n                bool x_70831;\n                bool y_70832;\n                bool bounds_check_70833;\n                bool index_certs_70834;\n                int64_t si_next_f_res_70835;\n                \n                tmp_70830 = add64((int64_t) 1, lm_70815);\n                x_70831 = sle64((int64_t) 0, tmp_70830);\n                y_70832 = slt64(tmp_70830, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_70833 = x_70831 && y_70832;\n                if (!bounds_check_70833) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 134) == ", "-1) {\n                            global_failure_args[0] = (int64_t) tmp_70830;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_70835 = ((__global int64_t *) mem_75488)[tmp_70830];\n                si_next_70829 = si_next_f_res_70835;\n            }\n            max_arg1_70836 = sub64(si_next_70829, (int64_t) 1);\n            max_res_70837 = smax64(min_res_70821, max_arg1_70836);\n            x_70838 = sle64((int64_t) 0, max_res_70837);\n            y_70839 = slt64(max_res_70837, nR_47166);\n            bounds_check_70840 = x_70838 && y_70839;\n            if (!bounds_check_70840) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 135) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70837;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_70844 = smin64(zeze_rhs_65256, si_next_70829);\n            x_70845 = sle64((int64_t) 0, min_res_70844);\n            y_70846 = slt64(min_res_70844, nR_47166);\n            bounds_check_70847 = x_70845 && y_70846;\n            if (!bounds_check_70847) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 136) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_70844;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_70851 = sub64(min_res_70821, (int64_t) 1);\n            max_res_70852 = smax64((int64_t) 0, max_arg1_70851);\n            x_70853 = sle64((int64_t) 0, max_res_70852);\n            y_",
                                    "70854 = slt64(max_res_70852, nR_47166);\n            bounds_check_70855 = x_70853 && y_70854;\n            if (!bounds_check_70855) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 137) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_70852;\n                        global_failure_args[1] = (int64_t) nR_47166;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_70826 = tS_start_64840 + min_res_70821;\n            slice_70842 = tS_start_64840 + max_res_70837;\n            s_max_70843 = ((__global int64_t *) tS_mem_75468)[slice_70842];\n            slice_70849 = tS_start_64840 + min_res_70844;\n            slice_70857 = tS_start_64840 + max_res_70852;\n            defunc_0_gt_res_70859 = slt64(r_max_70742, s_max_70843);\n            if (defunc_0_gt_res_70859) {\n                int64_t s_min_70827;\n                bool defunc_0_leq_res_70862;\n                bool loopres_t_res_70863;\n                int64_t loopres_t_res_70864;\n                \n                s_min_70827 = ((__global int64_t *) tS_mem_75468)[slice_70826];\n                defunc_0_leq_res_70862 = sle64(s_min_70827, r_max_70742);\n                if (defunc_0_leq_res_70862) {\n                    loopres_t_res_70863 = 0;\n                    loopres_t_res_70864 = lm_70815;\n                } else {\n                    int64_t s_prevMax_70858;\n                    bool defunc_0_leq_res_70865;\n                    int64_t zlze_lhs_70866;\n                    bool tmp_f_res_70867;\n                    bool x_70868;\n                    bool y_70869;\n                    bool tmp_70870;\n                    int64_t max_res_70871;\n                    bool loopres_t_res_f_res_70872;\n                    \n                    s_prevMax_70858 = ((__global int64_t *) tS_mem_75468)[slice_70857];\n                    defunc_0_leq_res_70865 = sle64(s_prevMax_70858, r_max_70742);\n                   ", " zlze_lhs_70866 = sub64(lm_70815, (int64_t) 1);\n                    tmp_f_res_70867 = sle64(zlze_lhs_70866, (int64_t) 0);\n                    x_70868 = !defunc_0_leq_res_70865;\n                    y_70869 = tmp_f_res_70867 && x_70868;\n                    tmp_70870 = defunc_0_leq_res_70865 || y_70869;\n                    max_res_70871 = smax64((int64_t) 0, zlze_lhs_70866);\n                    loopres_t_res_f_res_70872 = !tmp_70870;\n                    loopres_t_res_70863 = loopres_t_res_f_res_70872;\n                    loopres_t_res_70864 = max_res_70871;\n                }\n                loopres_70860 = loopres_t_res_70863;\n                loopres_70861 = loopres_t_res_70864;\n            } else {\n                int64_t s_nextMin_70850;\n                bool defunc_0_leq_res_70873;\n                int64_t tmp_70874;\n                bool loopres_f_res_70875;\n                \n                s_nextMin_70850 = ((__global int64_t *) tS_mem_75468)[slice_70849];\n                defunc_0_leq_res_70873 = sle64(r_max_70742, s_nextMin_70850);\n                tmp_70874 = add64((int64_t) 1, lm_70815);\n                loopres_f_res_70875 = !defunc_0_leq_res_70873;\n                loopres_70860 = loopres_f_res_70875;\n                loopres_70861 = tmp_70874;\n            }\n            loop_cond_t_res_70876 = slt64(loopres_70861, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            x_70877 = loopres_70860 && loop_cond_t_res_70876;\n            loop_while_tmp_76727 = x_70877;\n            lm_tmp_76728 = loopres_70861;\n            loop_while_70814 = loop_while_tmp_76727;\n            lm_70815 = lm_tmp_76728;\n        }\n        defunc_0_f_res_70812 = loop_while_70814;\n        defunc_0_f_res_70813 = lm_70815;\n        ((__global int64_t *) mem_75522)[gtid_70718] = defunc_0_f_res_70744;\n        ((__global int64_t *) mem_75524)[gtid_70718] = defunc_0_f_res_70813;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70714\n}\nFUTHARK_KERNEL_SIZED(inner_SM", "J_longzisegmap_71071_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71071(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75703, int64_t ext_75704, __global unsigned char *mem_param_75540, __global unsigned char *ext_mem_75707, __global unsigned char *mem_75711)\n{\n    #define segmap_tblock_sizze_71067 (inner_SMJ_longzisegmap_71071zisegmap_tblock_sizze_71067)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76840;\n    int32_t tblock_sizze_76843;\n    int32_t wave_sizze_76842;\n    int32_t block_id_76841;\n    int32_t global_tid_76839;\n    int64_t phys_tid_71071;\n    int64_t global_tid_76844;\n    int64_t slice_76845;\n    int64_t gtid_71070;\n    int64_t remnant_76846;\n    \n    local_tid_76840 = get_local_id(0);\n    tblock_sizze_76843 = get_local_size(0);\n    wave_sizze_76842 = LOCKSTEP_WIDTH;\n    block_id_76841 = get_tblock_id(0);\n    global_tid_76839 = block_id_76841 * tblock_sizze_76843 + local_tid_76840;\n    phys_tid_71071 = sext_i32_i64(global_tid_76839);\n    global_tid_76844 = sext_i32_i64(block_id_76841) * segmap_tblock_sizze_71067 + sext_i32_i64(local_tid_76840);\n    slice_76845 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_71070 = global_tid_76844;\n    remnant_76846 = global_tid_76844 - gtid_71070;\n    if (slt64(gtid_71070, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_71072;\n        bool cond_71074;\n        int64_t lifted_lambda_res_71075;\n        \n        eta_p_71072 = ((__global int64_t *) mem_param_75540)[gtid_71070];\n        cond_71074 = slt64(eta_p_71072, (int64_t) 0);\n        if (cond_71074) {\n            int64_t eta_p_71073 = ((__global int64_t *) ext_mem_75707)[ext_75704 + gtid_71070 * ext_75703];\n            \n            lifted_lambda_res_71075 = eta_p_71073;\n        } else {\n            lifted_lambda_res_71075 = eta_p_71072;\n        }\n        ((__global int64_t *) mem_75711)[gtid_71070] = lifted_lambda_res_71075;\n    }\n    \n  error_0:\n    return;\n    ",
                                    "#undef segmap_tblock_sizze_71067\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71092_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71092(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75705, int64_t ext_75706, __global unsigned char *mem_param_75537, __global unsigned char *ext_mem_75708, __global unsigned char *mem_75714)\n{\n    #define segmap_tblock_sizze_71088 (inner_SMJ_longzisegmap_71092zisegmap_tblock_sizze_71088)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76849;\n    int32_t tblock_sizze_76852;\n    int32_t wave_sizze_76851;\n    int32_t block_id_76850;\n    int32_t global_tid_76848;\n    int64_t phys_tid_71092;\n    int64_t global_tid_76853;\n    int64_t slice_76854;\n    int64_t gtid_71091;\n    int64_t remnant_76855;\n    \n    local_tid_76849 = get_local_id(0);\n    tblock_sizze_76852 = get_local_size(0);\n    wave_sizze_76851 = LOCKSTEP_WIDTH;\n    block_id_76850 = get_tblock_id(0);\n    global_tid_76848 = block_id_76850 * tblock_sizze_76852 + local_tid_76849;\n    phys_tid_71092 = sext_i32_i64(global_tid_76848);\n    global_tid_76853 = sext_i32_i64(block_id_76850) * segmap_tblock_sizze_71088 + sext_i32_i64(local_tid_76849);\n    slice_76854 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_71091 = global_tid_76853;\n    remnant_76855 = global_tid_76853 - gtid_71091;\n    if (slt64(gtid_71091, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_71093;\n        int64_t eta_p_71094;\n        int64_t defunc_0_f_res_71095;\n        \n        eta_p_71093 = ((__global int64_t *) mem_param_75537)[gtid_71091];\n        eta_p_71094 = ((__global int64_t *) ext_mem_75708)[ext_75706 + gtid_71091 * ext_75705];\n        defunc_0_f_res_71095 = add64(eta_p_71093, eta_p_71094);\n        ((__global int64_t *) mem_75714)[gtid_71091] = defunc_0_f_res_71095;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71088\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71113_dim1, 1, 1)\nvoid inner_", "SMJ_longzisegmap_71113(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75528, int64_t ctx_param_ext_75529, __global unsigned char *mem_param_75530, __global unsigned char *ext_mem_75719, __global unsigned char *mem_75723)\n{\n    #define segmap_tblock_sizze_71109 (inner_SMJ_longzisegmap_71113zisegmap_tblock_sizze_71109)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76858;\n    int32_t tblock_sizze_76861;\n    int32_t wave_sizze_76860;\n    int32_t block_id_76859;\n    int32_t global_tid_76857;\n    int64_t phys_tid_71113;\n    int64_t global_tid_76862;\n    int64_t slice_76863;\n    int64_t gtid_71112;\n    int64_t remnant_76864;\n    \n    local_tid_76858 = get_local_id(0);\n    tblock_sizze_76861 = get_local_size(0);\n    wave_sizze_76860 = LOCKSTEP_WIDTH;\n    block_id_76859 = get_tblock_id(0);\n    global_tid_76857 = block_id_76859 * tblock_sizze_76861 + local_tid_76858;\n    phys_tid_71113 = sext_i32_i64(global_tid_76857);\n    global_tid_76862 = sext_i32_i64(block_id_76859) * segmap_tblock_sizze_71109 + sext_i32_i64(local_tid_76858);\n    slice_76863 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_71112 = global_tid_76862;\n    remnant_76864 = global_tid_76862 - gtid_71112;\n    if (slt64(gtid_71112, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73891;\n        int64_t eta_p_71114;\n        bool cond_71116;\n        int64_t lifted_lambda_res_71117;\n        \n        slice_73891 = loopres_f_res_f_res_65435 + gtid_71112;\n        eta_p_71114 = ((__global int64_t *) mem_param_75530)[ctx_param_ext_75528 + slice_73891 * ctx_param_ext_75529];\n        cond_71116 = slt64(eta_p_71114, (int64_t) 0);\n        if (cond_71116) {\n            int64_t eta_p_71115 = ((__global int64_t *) ext_mem_75719)[gtid_71112];\n            \n            lifted_lambda_res_71117 = eta_p_71115;\n        } else {\n            lifted_lambda_res_71117 = eta_p_71114;\n     ", "   }\n        ((__global int64_t *) mem_75723)[gtid_71112] = lifted_lambda_res_71117;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71109\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71134_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71134(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75525, int64_t ctx_param_ext_75526, __global unsigned char *mem_param_75527, __global unsigned char *ext_mem_75720, __global unsigned char *mem_75726)\n{\n    #define segmap_tblock_sizze_71130 (inner_SMJ_longzisegmap_71134zisegmap_tblock_sizze_71130)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76867;\n    int32_t tblock_sizze_76870;\n    int32_t wave_sizze_76869;\n    int32_t block_id_76868;\n    int32_t global_tid_76866;\n    int64_t phys_tid_71134;\n    int64_t global_tid_76871;\n    int64_t slice_76872;\n    int64_t gtid_71133;\n    int64_t remnant_76873;\n    \n    local_tid_76867 = get_local_id(0);\n    tblock_sizze_76870 = get_local_size(0);\n    wave_sizze_76869 = LOCKSTEP_WIDTH;\n    block_id_76868 = get_tblock_id(0);\n    global_tid_76866 = block_id_76868 * tblock_sizze_76870 + local_tid_76867;\n    phys_tid_71134 = sext_i32_i64(global_tid_76866);\n    global_tid_76871 = sext_i32_i64(block_id_76868) * segmap_tblock_sizze_71130 + sext_i32_i64(local_tid_76867);\n    slice_76872 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_71133 = global_tid_76871;\n    remnant_76873 = global_tid_76871 - gtid_71133;\n    if (slt64(gtid_71133, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73890;\n        int64_t eta_p_71135;\n        int64_t eta_p_71136;\n        int64_t defunc_0_f_res_71137;\n        \n        slice_73890 = loopres_f_res_f_res_65435 + gtid_71133;\n        eta_p_71135 = ((__global int64_t *) mem_param_75527)[ctx_param_ext_75525 + slice_73890 * ctx_param_ext_75526];\n        eta_p_71136 = ((__global int64_t *) ext_mem_75720)[gtid_71133",
                                    "];\n        defunc_0_f_res_71137 = add64(eta_p_71135, eta_p_71136);\n        ((__global int64_t *) mem_75726)[gtid_71133] = defunc_0_f_res_71137;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71130\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71155_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71155(__global int *global_failure, int64_t nR_47166, int64_t ext_75914, int64_t ext_75915, __global unsigned char *mem_param_75482, __global unsigned char *ext_mem_75916, __global unsigned char *mem_75922)\n{\n    #define segmap_tblock_sizze_71151 (inner_SMJ_longzisegmap_71155zisegmap_tblock_sizze_71151)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76876;\n    int32_t tblock_sizze_76879;\n    int32_t wave_sizze_76878;\n    int32_t block_id_76877;\n    int32_t global_tid_76875;\n    int64_t phys_tid_71155;\n    int64_t global_tid_76880;\n    int64_t slice_76881;\n    int64_t gtid_71154;\n    int64_t remnant_76882;\n    \n    local_tid_76876 = get_local_id(0);\n    tblock_sizze_76879 = get_local_size(0);\n    wave_sizze_76878 = LOCKSTEP_WIDTH;\n    block_id_76877 = get_tblock_id(0);\n    global_tid_76875 = block_id_76877 * tblock_sizze_76879 + local_tid_76876;\n    phys_tid_71155 = sext_i32_i64(global_tid_76875);\n    global_tid_76880 = sext_i32_i64(block_id_76877) * segmap_tblock_sizze_71151 + sext_i32_i64(local_tid_76876);\n    slice_76881 = nR_47166;\n    gtid_71154 = global_tid_76880;\n    remnant_76882 = global_tid_76880 - gtid_71154;\n    if (slt64(gtid_71154, nR_47166)) {\n        int64_t eta_p_71156;\n        bool cond_71158;\n        int64_t lifted_lambda_res_71159;\n        \n        eta_p_71156 = ((__global int64_t *) mem_param_75482)[gtid_71154];\n        cond_71158 = slt64(eta_p_71156, (int64_t) 0);\n        if (cond_71158) {\n            int64_t eta_p_71157 = ((__global int64_t *) ext_mem_75916)[ext_75915 + gtid_71154 * ext_75914];\n            \n            lifted_lambda_res_71159 = eta_p_71157;\n        } else {\n            lifted_lambda_res_71159 = eta_p_", "71156;\n        }\n        ((__global int64_t *) mem_75922)[gtid_71154] = lifted_lambda_res_71159;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71151\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71176_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71176(__global int *global_failure, int64_t nR_47166, int64_t ext_75917, int64_t ext_75918, __global unsigned char *mem_param_75479, __global unsigned char *ext_mem_75919, __global unsigned char *mem_75925)\n{\n    #define segmap_tblock_sizze_71172 (inner_SMJ_longzisegmap_71176zisegmap_tblock_sizze_71172)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76885;\n    int32_t tblock_sizze_76888;\n    int32_t wave_sizze_76887;\n    int32_t block_id_76886;\n    int32_t global_tid_76884;\n    int64_t phys_tid_71176;\n    int64_t global_tid_76889;\n    int64_t slice_76890;\n    int64_t gtid_71175;\n    int64_t remnant_76891;\n    \n    local_tid_76885 = get_local_id(0);\n    tblock_sizze_76888 = get_local_size(0);\n    wave_sizze_76887 = LOCKSTEP_WIDTH;\n    block_id_76886 = get_tblock_id(0);\n    global_tid_76884 = block_id_76886 * tblock_sizze_76888 + local_tid_76885;\n    phys_tid_71176 = sext_i32_i64(global_tid_76884);\n    global_tid_76889 = sext_i32_i64(block_id_76886) * segmap_tblock_sizze_71172 + sext_i32_i64(local_tid_76885);\n    slice_76890 = nR_47166;\n    gtid_71175 = global_tid_76889;\n    remnant_76891 = global_tid_76889 - gtid_71175;\n    if (slt64(gtid_71175, nR_47166)) {\n        int64_t eta_p_71177;\n        int64_t eta_p_71178;\n        int64_t defunc_0_f_res_71179;\n        \n        eta_p_71177 = ((__global int64_t *) mem_param_75479)[gtid_71175];\n        eta_p_71178 = ((__global int64_t *) ext_mem_75919)[ext_75918 + gtid_71175 * ext_75917];\n        defunc_0_f_res_71179 = add64(eta_p_71177, eta_p_71178);\n        ((__global int64_t *) mem_75925)[gtid_71175] = defunc_0_f_res_71179;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71172\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71189", "_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71189(__global int *global_failure, int64_t nR_47166, int64_t m_65686, int64_t num_tblocks_71194, int32_t virt_num_tblocks_77042, __global unsigned char *tR_mem_75467, __global unsigned char *ext_mem_75469, __global unsigned char *ext_mem_75937, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *mem_75945, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951)\n{\n    #define segmap_tblock_sizze_71192 (inner_SMJ_longzisegmap_71189zisegmap_tblock_sizze_71192)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77044;\n    int32_t tblock_sizze_77047;\n    int32_t wave_sizze_77046;\n    int32_t block_id_77045;\n    int32_t global_tid_77043;\n    int64_t phys_tid_71189;\n    int32_t phys_tblock_id_77048;\n    int32_t iterations_77049;\n    \n    local_tid_77044 = get_local_id(0);\n    tblock_sizze_77047 = get_local_size(0);\n    wave_sizze_77046 = LOCKSTEP_WIDTH;\n    block_id_77045 = get_tblock_id(0);\n    global_tid_77043 = block_id_77045 * tblock_sizze_77047 + local_tid_77044;\n    phys_tid_71189 = sext_i32_i64(global_tid_77043);\n    phys_tblock_id_77048 = get_tblock_id(0);\n    iterations_77049 = sdiv_up32(virt_num_tblocks_77042 - phys_tblock_id_77048, sext_i64_i32(num_tblocks_71194));\n    for (int32_t i_77050 = 0; i_77050 < iterations_77049; i_77050++) {\n        int32_t virt_tblock_id_77051;\n        int64_t global_tid_77052;\n        int64_t slice_77053;\n        int64_t write_i_71188;\n        int64_t remnant_77054;\n        \n        virt_tblock_id_77051 = phys_tblock_id_77048 + i_77050 * sext_i64_i32(num_tblocks_71194);\n        global_tid_77052 = sext_i32_i64(virt_tblock_id_77051) * segmap_tblock_sizze_71192 + sext_i32_i64(local_tid_77044);\n        slice_77053 = nR_47166;\n        write_i_71188 = global_tid_77052;\n        remnant_77054 = global_tid_77052 - write_i_71188;\n        if (slt64(write",
                                    "_i_71188, nR_47166)) {\n            int64_t eta_p_65951;\n            int64_t write_value_65953;\n            int64_t write_value_65954;\n            int64_t write_value_65955;\n            int64_t write_value_65956;\n            bool cond_65957;\n            int64_t lifted_lambda_res_65958;\n            \n            eta_p_65951 = ((__global int64_t *) mem_75943)[write_i_71188];\n            write_value_65953 = ((__global int64_t *) tR_mem_75467)[write_i_71188];\n            write_value_65954 = ((__global int64_t *) ext_mem_75469)[write_i_71188];\n            write_value_65955 = ((__global int64_t *) ext_mem_75937)[write_i_71188];\n            write_value_65956 = ((__global int64_t *) ext_mem_75938)[write_i_71188];\n            cond_65957 = eta_p_65951 == (int64_t) 1;\n            if (cond_65957) {\n                int64_t eta_p_65952;\n                int64_t lifted_lambda_res_t_res_66732;\n                \n                eta_p_65952 = ((__global int64_t *) mem_75941)[write_i_71188];\n                lifted_lambda_res_t_res_66732 = sub64(eta_p_65952, (int64_t) 1);\n                lifted_lambda_res_65958 = lifted_lambda_res_t_res_66732;\n            } else {\n                lifted_lambda_res_65958 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75951)[lifted_lambda_res_65958] = write_value_65953;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75949)[lifted_lambda_res_65958] = write_value_65954;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75947)[lifted_lambda_res_65958] = write_value_65955;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__", "global int64_t *) mem_75945)[lifted_lambda_res_65958] = write_value_65956;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_71192\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71223_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71223(__global int *global_failure, int64_t m_65686, __global unsigned char *mem_75955, __global unsigned char *mem_75962)\n{\n    #define segmap_tblock_sizze_71219 (inner_SMJ_longzisegmap_71223zisegmap_tblock_sizze_71219)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77210;\n    int32_t tblock_sizze_77213;\n    int32_t wave_sizze_77212;\n    int32_t block_id_77211;\n    int32_t global_tid_77209;\n    int64_t phys_tid_71223;\n    int64_t global_tid_77214;\n    int64_t slice_77215;\n    int64_t gtid_71222;\n    int64_t remnant_77216;\n    \n    local_tid_77210 = get_local_id(0);\n    tblock_sizze_77213 = get_local_size(0);\n    wave_sizze_77212 = LOCKSTEP_WIDTH;\n    block_id_77211 = get_tblock_id(0);\n    global_tid_77209 = block_id_77211 * tblock_sizze_77213 + local_tid_77210;\n    phys_tid_71223 = sext_i32_i64(global_tid_77209);\n    global_tid_77214 = sext_i32_i64(block_id_77211) * segmap_tblock_sizze_71219 + sext_i32_i64(local_tid_77210);\n    slice_77215 = m_65686;\n    gtid_71222 = global_tid_77214;\n    remnant_77216 = global_tid_77214 - gtid_71222;\n    if (slt64(gtid_71222, m_65686)) {\n        int64_t zv_lhs_71225;\n        int64_t tmp_71226;\n        bool cond_71228;\n        int64_t lifted_lambda_res_71229;\n        \n        zv_lhs_71225 = add64((int64_t) -1, gtid_71222);\n        tmp_71226 = smod64(zv_lhs_71225, m_65686);\n        cond_71228 = gtid_71222 == (int64_t) 0;\n        if (cond_71228) {\n            lifted_lambda_res_71229 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_71227 = ((__global int64_t *) mem_75955)[tmp_71226];\n            \n            lifted_lambda_res_71229 = lifted_lambda_res_71227;\n        }\n   ", "     ((__global int64_t *) mem_75962)[gtid_71222] = lifted_lambda_res_71229;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71219\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71231_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71231(__global int *global_failure, int64_t m_65686, int64_t lower_bound_65769, int64_t min_res_65771, int64_t j_m_i_65772, int64_t num_tblocks_71236, int32_t virt_num_tblocks_77255, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951, __global unsigned char *mem_75962, __global unsigned char *mem_75991, __global unsigned char *mem_75993, __global unsigned char *mem_75995)\n{\n    #define segmap_tblock_sizze_71234 (inner_SMJ_longzisegmap_71231zisegmap_tblock_sizze_71234)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77257;\n    int32_t tblock_sizze_77260;\n    int32_t wave_sizze_77259;\n    int32_t block_id_77258;\n    int32_t global_tid_77256;\n    int64_t phys_tid_71231;\n    int32_t phys_tblock_id_77261;\n    int32_t iterations_77262;\n    \n    local_tid_77257 = get_local_id(0);\n    tblock_sizze_77260 = get_local_size(0);\n    wave_sizze_77259 = LOCKSTEP_WIDTH;\n    block_id_77258 = get_tblock_id(0);\n    global_tid_77256 = block_id_77258 * tblock_sizze_77260 + local_tid_77257;\n    phys_tid_71231 = sext_i32_i64(global_tid_77256);\n    phys_tblock_id_77261 = get_tblock_id(0);\n    iterations_77262 = sdiv_up32(virt_num_tblocks_77255 - phys_tblock_id_77261, sext_i64_i32(num_tblocks_71236));\n    for (int32_t i_77263 = 0; i_77263 < iterations_77262; i_77263++) {\n        int32_t virt_tblock_id_77264;\n        int64_t global_tid_77265;\n        int64_t slice_77266;\n        int64_t write_i_71230;\n        int64_t remnant_77267;\n        \n        virt_tblock_id_77264 = phys_tblock_id_77261 + i_77263 * sext_i64_i32(num_tblocks_71236);\n        global_tid_77265 = sext_i32_i64(virt_tblock_id_77264) * segmap_tblock_sizze_71234 + sext_i32_i64(local_tid_77257);\n        slice_77266 = m",
                                    "_65686;\n        write_i_71230 = global_tid_77265;\n        remnant_77267 = global_tid_77265 - write_i_71230;\n        if (slt64(write_i_71230, m_65686)) {\n            int64_t eta_p_66344;\n            int64_t write_value_66345;\n            int64_t write_value_66346;\n            int64_t write_value_66347;\n            bool cond_66348;\n            bool cond_t_res_66349;\n            bool x_66350;\n            int64_t lifted_lambda_res_66351;\n            \n            eta_p_66344 = ((__global int64_t *) mem_75962)[write_i_71230];\n            write_value_66345 = ((__global int64_t *) mem_75951)[write_i_71230];\n            write_value_66346 = ((__global int64_t *) mem_75949)[write_i_71230];\n            write_value_66347 = ((__global int64_t *) mem_75947)[write_i_71230];\n            cond_66348 = sle64(lower_bound_65769, eta_p_66344);\n            cond_t_res_66349 = slt64(eta_p_66344, min_res_65771);\n            x_66350 = cond_66348 && cond_t_res_66349;\n            if (x_66350) {\n                int64_t lifted_lambda_res_t_res_66735 = sub64(eta_p_66344, lower_bound_65769);\n                \n                lifted_lambda_res_66351 = lifted_lambda_res_t_res_66735;\n            } else {\n                lifted_lambda_res_66351 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75991)[lifted_lambda_res_66351] = write_value_66345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75993)[lifted_lambda_res_66351] = write_value_66346;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75995)[lifted_lambda_res_66351] = write_value_66347;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  err", "or_1:\n    return;\n    #undef segmap_tblock_sizze_71234\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71239_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71239(__global int *global_failure, int64_t m_65686, int64_t m_65826, int64_t num_tblocks_71244, int32_t virt_num_tblocks_77237, __global unsigned char *mem_75945, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *mem_75962, __global unsigned char *mem_75970, __global unsigned char *mem_75972)\n{\n    #define segmap_tblock_sizze_71242 (inner_SMJ_longzisegmap_71239zisegmap_tblock_sizze_71242)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77239;\n    int32_t tblock_sizze_77242;\n    int32_t wave_sizze_77241;\n    int32_t block_id_77240;\n    int32_t global_tid_77238;\n    int64_t phys_tid_71239;\n    int32_t phys_tblock_id_77243;\n    int32_t iterations_77244;\n    \n    local_tid_77239 = get_local_id(0);\n    tblock_sizze_77242 = get_local_size(0);\n    wave_sizze_77241 = LOCKSTEP_WIDTH;\n    block_id_77240 = get_tblock_id(0);\n    global_tid_77238 = block_id_77240 * tblock_sizze_77242 + local_tid_77239;\n    phys_tid_71239 = sext_i32_i64(global_tid_77238);\n    phys_tblock_id_77243 = get_tblock_id(0);\n    iterations_77244 = sdiv_up32(virt_num_tblocks_77237 - phys_tblock_id_77243, sext_i64_i32(num_tblocks_71244));\n    for (int32_t i_77245 = 0; i_77245 < iterations_77244; i_77245++) {\n        int32_t virt_tblock_id_77246;\n        int64_t global_tid_77247;\n        int64_t slice_77248;\n        int64_t write_i_71238;\n        int64_t remnant_77249;\n        \n        virt_tblock_id_77246 = phys_tblock_id_77243 + i_77245 * sext_i64_i32(num_tblocks_71244);\n        global_tid_77247 = sext_i32_i64(virt_tblock_id_77246) * segmap_tblock_sizze_71242 + sext_i32_i64(local_tid_77239);\n        slice_77248 = m_65686;\n        write_i_71238 = global_tid_77247;\n        remnant_77249 = global_tid_77247 - write_i_71238;\n        if (slt64(write_i_71238, m_65686)) {\n            int64_t eta_p_659", "28;\n            int64_t write_value_65930;\n            int64_t write_value_65931;\n            bool cond_65932;\n            int64_t lifted_lambda_res_65933;\n            \n            eta_p_65928 = ((__global int64_t *) mem_75959)[write_i_71238];\n            write_value_65930 = ((__global int64_t *) mem_75962)[write_i_71238];\n            write_value_65931 = ((__global int64_t *) mem_75945)[write_i_71238];\n            cond_65932 = eta_p_65928 == (int64_t) 1;\n            if (cond_65932) {\n                int64_t eta_p_65929;\n                int64_t lifted_lambda_res_t_res_66740;\n                \n                eta_p_65929 = ((__global int64_t *) mem_75957)[write_i_71238];\n                lifted_lambda_res_t_res_66740 = sub64(eta_p_65929, (int64_t) 1);\n                lifted_lambda_res_65933 = lifted_lambda_res_t_res_66740;\n            } else {\n                lifted_lambda_res_65933 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75972)[lifted_lambda_res_65933] = write_value_65930;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75970)[lifted_lambda_res_65933] = write_value_65931;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_71242\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_71261_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_71261(__global int *global_failure, int64_t loopres_65870, int64_t loopres_65871, __global unsigned char *mem_76020, __global unsigned char *mem_76023)\n{\n    #define segmap_tblock_sizze_71257 (inner_SMJ_longzisegmap_71261zisegmap_tblock_sizze_71257)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77324;\n    int32_t tblock_sizze_77327;\n    int32_t wave_sizze_77326;\n    int32_t block_id_7",
                                    "7325;\n    int32_t global_tid_77323;\n    int64_t phys_tid_71261;\n    int64_t global_tid_77328;\n    int64_t slice_77329;\n    int64_t gtid_71260;\n    int64_t remnant_77330;\n    \n    local_tid_77324 = get_local_id(0);\n    tblock_sizze_77327 = get_local_size(0);\n    wave_sizze_77326 = LOCKSTEP_WIDTH;\n    block_id_77325 = get_tblock_id(0);\n    global_tid_77323 = block_id_77325 * tblock_sizze_77327 + local_tid_77324;\n    phys_tid_71261 = sext_i32_i64(global_tid_77323);\n    global_tid_77328 = sext_i32_i64(block_id_77325) * segmap_tblock_sizze_71257 + sext_i32_i64(local_tid_77324);\n    slice_77329 = loopres_65871;\n    gtid_71260 = global_tid_77328;\n    remnant_77330 = global_tid_77328 - gtid_71260;\n    if (slt64(gtid_71260, loopres_65871)) {\n        int64_t loopres_75462;\n        int64_t tmp_71263;\n        \n        loopres_75462 = ((__global int64_t *) mem_76023)[(int64_t) 0];\n        tmp_71263 = add64(gtid_71260, loopres_75462);\n        ((__global int64_t *) mem_76020)[loopres_65870 + gtid_71260] = tmp_71263;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71257\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_73899_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_73899(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_73902, int64_t num_whole_tiles_73917, int64_t residual_input_74141, unsigned char cond_74142_bits, int64_t binop_x_74158, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75887, __global unsigned char *mem_75889)\n{\n    bool cond_74142 = cond_74142_bits;\n    \n    #define tile_sizze_73901 (inner_SMJ_longzisegmap_intrablock_73899zitile_sizze_73901)\n    #define bytes_75849 (inner_SMJ_longzisegmap_intrablock_73899zibytes_75849)\n    \n    volatile __local unsigned char *color_76532_backing_2 = &shared_mem[0];\n    const int64_t colo", "r_76532_backing_2_offset = 0 + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76531_backing_1 = &shared_mem[color_76532_backing_2_offset];\n    const int64_t color_76531_backing_1_offset = color_76532_backing_2_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76530_backing_0 = &shared_mem[color_76531_backing_1_offset];\n    const int64_t color_76530_backing_0_offset = color_76531_backing_1_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76621;\n    int32_t tblock_sizze_76624;\n    int32_t wave_sizze_76623;\n    int32_t block_id_76622;\n    int32_t global_tid_76620;\n    int64_t gid_flat_73899;\n    int64_t slice_76626;\n    int64_t ltid_pre_76625;\n    int64_t remnant_76627;\n    int64_t slice_76628;\n    int64_t gid_73898;\n    int64_t remnant_76629;\n    __local unsigned char *color_76530;\n    __local unsigned char *color_76531;\n    __local unsigned char *color_76532;\n    int64_t binop_x_73909;\n    int64_t mem_75833[1];\n    int64_t ltid_flat_73904;\n    int64_t ltid_73903;\n    int64_t gtid_73910;\n    bool cond_73911;\n    int64_t pre_73912;\n    int64_t mem_75837[1];\n    int64_t mem_75841[1];\n    int64_t mem_75845[1];\n    int64_t ltid_flat_73919;\n    int64_t ltid_73918;\n    int64_t gtid_73929;\n    bool cond_73930;\n    int64_t neutral_73931;\n    int64_t neutral_73932;\n    int64_t ext_mem_75869[1];\n    int64_t ext_mem_75868[1];\n    int64_t ext_mem_75867[1];\n    int64_t mem_param_75846[1];\n    int64_t mem_param_75847[1];\n    int64_t mem_param_75848[1];\n    int64_t mem_75879[1];\n    int64_t mem_75883[1];\n    int64_t ext_mem_75885[1];\n    int64_t ext_mem_75884[1];\n    \n    local_tid_76621 = get_local_id(0);\n    tblock_sizze_76624 = get_local_size(0);\n    wave_sizze_76623 = LOCKSTEP_WIDTH;\n    block_i", "d_76622 = get_tblock_id(0);\n    global_tid_76620 = block_id_76622 * tblock_sizze_76624 + local_tid_76621;\n    gid_flat_73899 = sext_i32_i64(block_id_76622);\n    slice_76626 = tile_sizze_73901;\n    ltid_pre_76625 = sext_i32_i64(local_tid_76621);\n    remnant_76627 = sext_i32_i64(local_tid_76621) - ltid_pre_76625;\n    slice_76628 = ldim_73902;\n    gid_73898 = sext_i32_i64(block_id_76622);\n    remnant_76629 = sext_i32_i64(block_id_76622) - gid_73898;\n    color_76530 = (__local unsigned char *) color_76530_backing_0;\n    color_76531 = (__local unsigned char *) color_76531_backing_1;\n    color_76532 = (__local unsigned char *) color_76532_backing_2;\n    binop_x_73909 = gid_73898 * tile_sizze_73901;\n    ltid_flat_73904 = sext_i32_i64(local_tid_76621);\n    ltid_73903 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n    gtid_73910 = ltid_73903 + binop_x_73909;\n    cond_73911 = slt64(gtid_73910, min_res_66402);\n    if (cond_73911) {\n        int64_t slice_73913;\n        int64_t eta_p_73914;\n        \n        slice_73913 = start_66400 + gtid_73910;\n        eta_p_73914 = ((__global int64_t *) tR_mem_75467)[slice_73913];\n        pre_73912 = eta_p_73914;\n    } else {\n        pre_73912 = (int64_t) 0;\n    }\n    mem_75833[(int64_t) 0] = pre_73912;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_73919 = sext_i32_i64(local_tid_76621);\n    ltid_73918 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n    gtid_73929 = binop_x_73909 + ltid_73918;\n    cond_73930 = slt64(gtid_73929, min_res_66402);\n    if (cond_73930) {\n        neutral_73931 = (int64_t) -1;\n    } else {\n        neutral_73931 = (int64_t) 0;\n    }\n    if (cond_73930) {\n        int64_t eta_p_73934 = mem_75833[(int64_t) 0];\n        \n        neutral_73932 = eta_p_73934;\n    } else {\n        neutral_73932 = (int64_t) 0;\n    }\n    mem_75837[(int64_t) 0] = neutral_73931;\n    mem_75841[(int64_t) 0] = neutral_73932;\n    mem_75845[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i",
                                    "_3 = 0; i_3 < 1; i_3++)\n        mem_param_75846[i_3] = mem_75837[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75847[i_4] = mem_75841[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75848[i_5] = mem_75845[i_5];\n    for (int64_t tile_id_73944 = 0; tile_id_73944 < num_whole_tiles_73917; tile_id_73944++) {\n        int64_t binop_x_74043;\n        int64_t ltid_flat_74042;\n        int64_t ltid_74041;\n        int64_t j_74044;\n        bool cond_74048;\n        int64_t pre1d_74051;\n        int64_t pre1d_74049;\n        int64_t pre1d_74050;\n        int64_t mem_75858[1];\n        int64_t mem_75862[1];\n        int64_t mem_75866[1];\n        int64_t ltid_flat_74062;\n        int64_t ltid_74061;\n        int64_t gtid_74064;\n        int64_t acc_74066;\n        int64_t acc_74067;\n        int64_t acc_74068;\n        bool cond_74069;\n        int64_t acc_74070;\n        int64_t acc_74071;\n        int64_t acc_74072;\n        int64_t mem_param_tmp_76630[1];\n        int64_t mem_param_tmp_76631[1];\n        int64_t mem_param_tmp_76632[1];\n        \n        binop_x_74043 = tile_sizze_73901 * tile_id_73944;\n        ltid_flat_74042 = sext_i32_i64(local_tid_76621);\n        ltid_74041 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n        j_74044 = ltid_74041 + binop_x_74043;\n        cond_74048 = slt64(j_74044, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74051 = btoi_bool_i64(cond_74048);\n        if (cond_74048) {\n            int64_t tile_elem_74052;\n            int64_t slice_75321;\n            int64_t tile_elem_74053;\n            \n            tile_elem_74052 = ((__global int64_t *) ext_mem_75767)[j_74044];\n            slice_75321 = tS_start_64840 + j_74044;\n            tile_elem_74053 = ((__global int64_t *) tS_mem_75468)[slice_75321];\n            pre1d_74049 = tile_elem_74052;\n            pre1d_74050 = tile_elem_74053;\n        } else {\n            pre1d_74049 = (int64_t) 0;\n            pre1d_74050 = (int64_t) 0;\n        }\n        ((__local int64_t ", "*) color_76532)[ltid_74041] = pre1d_74049;\n        ((__local int64_t *) color_76531)[ltid_74041] = pre1d_74050;\n        ((__local int64_t *) color_76530)[ltid_74041] = pre1d_74051;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74062 = sext_i32_i64(local_tid_76621);\n        ltid_74061 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n        gtid_74064 = binop_x_73909 + ltid_74061;\n        acc_74066 = mem_param_75846[(int64_t) 0];\n        acc_74067 = mem_param_75847[(int64_t) 0];\n        acc_74068 = mem_param_75848[(int64_t) 0];\n        cond_74069 = slt64(gtid_74064, min_res_66402);\n        if (cond_74069) {\n            int64_t eta_p_74065;\n            int64_t x_74073;\n            int64_t x_74074;\n            int64_t x_74075;\n            int64_t redout_75334;\n            int64_t redout_75335;\n            int64_t redout_75336;\n            \n            eta_p_74065 = mem_75833[(int64_t) 0];\n            redout_75334 = acc_74066;\n            redout_75335 = acc_74067;\n            redout_75336 = acc_74068;\n            for (int64_t i_75337 = 0; i_75337 < tile_sizze_73901; i_75337++) {\n                int64_t x_74076;\n                int64_t x_74077;\n                bool defunc_0_neq_res_74085;\n                bool defunc_0_neq_res_74086;\n                bool cond_f_res_74087;\n                bool y_74088;\n                bool cond_74089;\n                bool defunc_0_neq_res_74090;\n                bool defunc_0_neq_res_74091;\n                bool cond_t_res_f_res_74092;\n                bool y_74093;\n                bool cond_t_res_74094;\n                bool x_74095;\n                int64_t defunc_0_op_res_74096;\n                int64_t defunc_0_op_res_74097;\n                int64_t defunc_0_op_res_74098;\n                int64_t redout_tmp_76636;\n                int64_t redout_tmp_76637;\n                int64_t redout_tmp_76638;\n                \n                x_74076 = ((__local int64_t *) color_76532)[i_75337];\n                x_74077 = ((__local int64_t *) color_76", "531)[i_75337];\n                defunc_0_neq_res_74085 = redout_75335 == eta_p_74065;\n                defunc_0_neq_res_74086 = !defunc_0_neq_res_74085;\n                cond_f_res_74087 = slt64(redout_75334, (int64_t) 0);\n                y_74088 = defunc_0_neq_res_74085 && cond_f_res_74087;\n                cond_74089 = defunc_0_neq_res_74086 || y_74088;\n                defunc_0_neq_res_74090 = x_74077 == eta_p_74065;\n                defunc_0_neq_res_74091 = !defunc_0_neq_res_74090;\n                cond_t_res_f_res_74092 = slt64(x_74076, (int64_t) 0);\n                y_74093 = defunc_0_neq_res_74090 && cond_t_res_f_res_74092;\n                cond_t_res_74094 = defunc_0_neq_res_74091 || y_74093;\n                x_74095 = cond_74089 && cond_t_res_74094;\n                if (x_74095) {\n                    defunc_0_op_res_74096 = (int64_t) -1;\n                    defunc_0_op_res_74097 = eta_p_74065;\n                    defunc_0_op_res_74098 = (int64_t) 0;\n                } else {\n                    int64_t x_74078;\n                    int64_t defunc_0_op_res_f_res_74099;\n                    int64_t defunc_0_op_res_f_res_74100;\n                    int64_t defunc_0_op_res_f_res_74101;\n                    \n                    x_74078 = ((__local int64_t *) color_76530)[i_75337];\n                    if (cond_74089) {\n                        defunc_0_op_res_f_res_74099 = x_74076;\n                        defunc_0_op_res_f_res_74100 = x_74077;\n                        defunc_0_op_res_f_res_74101 = x_74078;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_74102;\n                        int64_t defunc_0_op_res_f_res_f_res_74103;\n                        int64_t defunc_0_op_res_f_res_f_res_74104;\n                        \n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74102 = redout_75335;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74102 = eta_p",
                                    "_74065;\n                        }\n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74103 = redout_75334;\n                            defunc_0_op_res_f_res_f_res_74104 = redout_75336;\n                        } else {\n                            int64_t min_res_74105;\n                            int64_t tmp_74106;\n                            \n                            min_res_74105 = smin64(x_74076, redout_75334);\n                            tmp_74106 = add64(x_74078, redout_75336);\n                            defunc_0_op_res_f_res_f_res_74103 = min_res_74105;\n                            defunc_0_op_res_f_res_f_res_74104 = tmp_74106;\n                        }\n                        defunc_0_op_res_f_res_74099 = defunc_0_op_res_f_res_f_res_74103;\n                        defunc_0_op_res_f_res_74100 = defunc_0_op_res_f_res_f_res_74102;\n                        defunc_0_op_res_f_res_74101 = defunc_0_op_res_f_res_f_res_74104;\n                    }\n                    defunc_0_op_res_74096 = defunc_0_op_res_f_res_74099;\n                    defunc_0_op_res_74097 = defunc_0_op_res_f_res_74100;\n                    defunc_0_op_res_74098 = defunc_0_op_res_f_res_74101;\n                }\n                redout_tmp_76636 = defunc_0_op_res_74096;\n                redout_tmp_76637 = defunc_0_op_res_74097;\n                redout_tmp_76638 = defunc_0_op_res_74098;\n                redout_75334 = redout_tmp_76636;\n                redout_75335 = redout_tmp_76637;\n                redout_75336 = redout_tmp_76638;\n            }\n            x_74073 = redout_75334;\n            x_74074 = redout_75335;\n            x_74075 = redout_75336;\n            acc_74070 = x_74073;\n            acc_74071 = x_74074;\n            acc_74072 = x_74075;\n        } else {\n            acc_74070 = acc_74066;\n            acc_74071 = acc_74067;\n            acc_74072 = acc_74068;\n        }\n        mem_75858[(int64_t) 0] = acc_74070;\n        mem_75862[(int64_t) 0] = ", "acc_74071;\n        mem_75866[(int64_t) 0] = acc_74072;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76630[i_6] = mem_75858[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76631[i_7] = mem_75862[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76632[i_8] = mem_75866[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75846[i_9] = mem_param_tmp_76630[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75847[i_10] = mem_param_tmp_76631[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75848[i_11] = mem_param_tmp_76632[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75869[i_12] = mem_param_75846[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75868[i_13] = mem_param_75847[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75867[i_14] = mem_param_75848[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74142) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75885[i_15] = ext_mem_75869[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75884[i_16] = ext_mem_75867[i_16];\n    } else {\n        int64_t ltid_flat_74144;\n        int64_t ltid_74143;\n        int64_t j_74159;\n        bool cond_74163;\n        int64_t pre1d_74166;\n        int64_t pre1d_74164;\n        int64_t pre1d_74165;\n        int64_t ltid_flat_74180;\n        int64_t ltid_74179;\n        int64_t gtid_74193;\n        int64_t acc_74195;\n        int64_t acc_74197;\n        bool cond_74198;\n        int64_t acc_74199;\n        int64_t acc_74201;\n        \n        ltid_flat_74144 = sext_i32_i64(local_tid_76621);\n        ltid_74143 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n        j_74159 = ltid_74143 + binop_x_74158;\n        cond_74163 = slt64(j_74159, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d", "_74166 = btoi_bool_i64(cond_74163);\n        if (cond_74163) {\n            int64_t tile_elem_74167;\n            int64_t slice_75320;\n            int64_t tile_elem_74168;\n            \n            tile_elem_74167 = ((__global int64_t *) ext_mem_75767)[j_74159];\n            slice_75320 = tS_start_64840 + j_74159;\n            tile_elem_74168 = ((__global int64_t *) tS_mem_75468)[slice_75320];\n            pre1d_74164 = tile_elem_74167;\n            pre1d_74165 = tile_elem_74168;\n        } else {\n            pre1d_74164 = (int64_t) 0;\n            pre1d_74165 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74143] = pre1d_74164;\n        ((__local int64_t *) color_76531)[ltid_74143] = pre1d_74165;\n        ((__local int64_t *) color_76530)[ltid_74143] = pre1d_74166;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74180 = sext_i32_i64(local_tid_76621);\n        ltid_74179 = sext_i32_i64(sext_i64_i32(ltid_pre_76625));\n        gtid_74193 = binop_x_73909 + ltid_74179;\n        acc_74195 = ext_mem_75869[(int64_t) 0];\n        acc_74197 = ext_mem_75867[(int64_t) 0];\n        cond_74198 = slt64(gtid_74193, min_res_66402);\n        if (cond_74198) {\n            int64_t eta_p_74194;\n            int64_t acc_74196;\n            int64_t x_74202;\n            int64_t x_74203;\n            int64_t x_74204;\n            int64_t redout_75338;\n            int64_t redout_75339;\n            int64_t redout_75340;\n            \n            eta_p_74194 = mem_75833[(int64_t) 0];\n            acc_74196 = ext_mem_75868[(int64_t) 0];\n            redout_75338 = acc_74195;\n            redout_75339 = acc_74196;\n            redout_75340 = acc_74197;\n            for (int64_t i_75341 = 0; i_75341 < residual_input_74141; i_75341++) {\n                int64_t x_74205;\n                int64_t x_74206;\n                bool defunc_0_neq_res_74214;\n                bool defunc_0_neq_res_74215;\n                bool cond_f_res_74216;\n                bool y_74217;\n                bool cond_74218;\n  ",
                                    "              bool defunc_0_neq_res_74219;\n                bool defunc_0_neq_res_74220;\n                bool cond_t_res_f_res_74221;\n                bool y_74222;\n                bool cond_t_res_74223;\n                bool x_74224;\n                int64_t defunc_0_op_res_74225;\n                int64_t defunc_0_op_res_74226;\n                int64_t defunc_0_op_res_74227;\n                int64_t redout_tmp_76639;\n                int64_t redout_tmp_76640;\n                int64_t redout_tmp_76641;\n                \n                x_74205 = ((__local int64_t *) color_76532)[i_75341];\n                x_74206 = ((__local int64_t *) color_76531)[i_75341];\n                defunc_0_neq_res_74214 = redout_75339 == eta_p_74194;\n                defunc_0_neq_res_74215 = !defunc_0_neq_res_74214;\n                cond_f_res_74216 = slt64(redout_75338, (int64_t) 0);\n                y_74217 = defunc_0_neq_res_74214 && cond_f_res_74216;\n                cond_74218 = defunc_0_neq_res_74215 || y_74217;\n                defunc_0_neq_res_74219 = x_74206 == eta_p_74194;\n                defunc_0_neq_res_74220 = !defunc_0_neq_res_74219;\n                cond_t_res_f_res_74221 = slt64(x_74205, (int64_t) 0);\n                y_74222 = defunc_0_neq_res_74219 && cond_t_res_f_res_74221;\n                cond_t_res_74223 = defunc_0_neq_res_74220 || y_74222;\n                x_74224 = cond_74218 && cond_t_res_74223;\n                if (x_74224) {\n                    defunc_0_op_res_74225 = (int64_t) -1;\n                    defunc_0_op_res_74226 = eta_p_74194;\n                    defunc_0_op_res_74227 = (int64_t) 0;\n                } else {\n                    int64_t x_74207;\n                    int64_t defunc_0_op_res_f_res_74228;\n                    int64_t defunc_0_op_res_f_res_74229;\n                    int64_t defunc_0_op_res_f_res_74230;\n                    \n                    x_74207 = ((__local int64_t *) color_76530)[i_75341];\n                    if (cond_74218) {\n                        defunc_", "0_op_res_f_res_74228 = x_74205;\n                        defunc_0_op_res_f_res_74229 = x_74206;\n                        defunc_0_op_res_f_res_74230 = x_74207;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_74231;\n                        int64_t defunc_0_op_res_f_res_f_res_74232;\n                        int64_t defunc_0_op_res_f_res_f_res_74233;\n                        \n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74231 = redout_75339;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74231 = eta_p_74194;\n                        }\n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74232 = redout_75338;\n                            defunc_0_op_res_f_res_f_res_74233 = redout_75340;\n                        } else {\n                            int64_t min_res_74234;\n                            int64_t tmp_74235;\n                            \n                            min_res_74234 = smin64(x_74205, redout_75338);\n                            tmp_74235 = add64(x_74207, redout_75340);\n                            defunc_0_op_res_f_res_f_res_74232 = min_res_74234;\n                            defunc_0_op_res_f_res_f_res_74233 = tmp_74235;\n                        }\n                        defunc_0_op_res_f_res_74228 = defunc_0_op_res_f_res_f_res_74232;\n                        defunc_0_op_res_f_res_74229 = defunc_0_op_res_f_res_f_res_74231;\n                        defunc_0_op_res_f_res_74230 = defunc_0_op_res_f_res_f_res_74233;\n                    }\n                    defunc_0_op_res_74225 = defunc_0_op_res_f_res_74228;\n                    defunc_0_op_res_74226 = defunc_0_op_res_f_res_74229;\n                    defunc_0_op_res_74227 = defunc_0_op_res_f_res_74230;\n                }\n                redout_tmp_76639 = defunc_0_op_res_74225;\n                redout_tmp_76640 = defunc_0_op_res_7", "4226;\n                redout_tmp_76641 = defunc_0_op_res_74227;\n                redout_75338 = redout_tmp_76639;\n                redout_75339 = redout_tmp_76640;\n                redout_75340 = redout_tmp_76641;\n            }\n            x_74202 = redout_75338;\n            x_74203 = redout_75339;\n            x_74204 = redout_75340;\n            acc_74199 = x_74202;\n            acc_74201 = x_74204;\n        } else {\n            acc_74199 = acc_74195;\n            acc_74201 = acc_74197;\n        }\n        mem_75879[(int64_t) 0] = acc_74199;\n        mem_75883[(int64_t) 0] = acc_74201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75885[i_17] = mem_75879[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75884[i_18] = mem_75883[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76621) + tile_sizze_73901 * sext_i32_i64(block_id_76622), min_res_66402)) {\n        int64_t tmp_76642 = ext_mem_75885[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75887)[sext_i32_i64(local_tid_76621) + tile_sizze_73901 * sext_i32_i64(block_id_76622)] = tmp_76642;\n    }\n    if (slt64(sext_i32_i64(local_tid_76621) + tile_sizze_73901 * sext_i32_i64(block_id_76622), min_res_66402)) {\n        int64_t tmp_76643 = ext_mem_75884[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75889)[sext_i32_i64(local_tid_76621) + tile_sizze_73901 * sext_i32_i64(block_id_76622)] = tmp_76643;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_73901\n    #undef bytes_75849\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_74254_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_74254(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_74257, int64_t num_whole_tiles_74272, int64_t residual_input_74496, unsigned char cond_74497_bits, int64_t binop_x_74513, __global unsigned char *tR_mem_75467, __globa",
                                    "l unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75826, __global unsigned char *mem_75828)\n{\n    bool cond_74497 = cond_74497_bits;\n    \n    #define tile_sizze_74256 (inner_SMJ_longzisegmap_intrablock_74254zitile_sizze_74256)\n    #define bytes_75788 (inner_SMJ_longzisegmap_intrablock_74254zibytes_75788)\n    \n    volatile __local unsigned char *color_76535_backing_2 = &shared_mem[0];\n    const int64_t color_76535_backing_2_offset = 0 + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76534_backing_1 = &shared_mem[color_76535_backing_2_offset];\n    const int64_t color_76534_backing_1_offset = color_76535_backing_2_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76533_backing_0 = &shared_mem[color_76534_backing_1_offset];\n    const int64_t color_76533_backing_0_offset = color_76534_backing_1_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76647;\n    int32_t tblock_sizze_76650;\n    int32_t wave_sizze_76649;\n    int32_t block_id_76648;\n    int32_t global_tid_76646;\n    int64_t gid_flat_74254;\n    int64_t slice_76652;\n    int64_t ltid_pre_76651;\n    int64_t remnant_76653;\n    int64_t slice_76654;\n    int64_t gid_74253;\n    int64_t remnant_76655;\n    __local unsigned char *color_76533;\n    __local unsigned char *color_76534;\n    __local unsigned char *color_76535;\n    int64_t binop_x_74264;\n    int64_t mem_75772[1];\n    int64_t ltid_flat_74259;\n    int64_t ltid_74258;\n    int64_t gtid_74265;\n    bool cond_74266;\n    int64_t pre_74267;\n    int64_t mem_75776[1];\n    int64_t mem_75780[1];\n    int64_t mem_75784[1];\n    int64_t ltid_flat_74274;\n    int64_t ltid_74273;\n    int64_t gtid_74284;\n    bool cond_74285;\n    int64_t neutral_74286;\n    in", "t64_t neutral_74287;\n    int64_t ext_mem_75808[1];\n    int64_t ext_mem_75807[1];\n    int64_t ext_mem_75806[1];\n    int64_t mem_param_75785[1];\n    int64_t mem_param_75786[1];\n    int64_t mem_param_75787[1];\n    int64_t mem_75818[1];\n    int64_t mem_75822[1];\n    int64_t ext_mem_75824[1];\n    int64_t ext_mem_75823[1];\n    \n    local_tid_76647 = get_local_id(0);\n    tblock_sizze_76650 = get_local_size(0);\n    wave_sizze_76649 = LOCKSTEP_WIDTH;\n    block_id_76648 = get_tblock_id(0);\n    global_tid_76646 = block_id_76648 * tblock_sizze_76650 + local_tid_76647;\n    gid_flat_74254 = sext_i32_i64(block_id_76648);\n    slice_76652 = tile_sizze_74256;\n    ltid_pre_76651 = sext_i32_i64(local_tid_76647);\n    remnant_76653 = sext_i32_i64(local_tid_76647) - ltid_pre_76651;\n    slice_76654 = ldim_74257;\n    gid_74253 = sext_i32_i64(block_id_76648);\n    remnant_76655 = sext_i32_i64(block_id_76648) - gid_74253;\n    color_76533 = (__local unsigned char *) color_76533_backing_0;\n    color_76534 = (__local unsigned char *) color_76534_backing_1;\n    color_76535 = (__local unsigned char *) color_76535_backing_2;\n    binop_x_74264 = gid_74253 * tile_sizze_74256;\n    ltid_flat_74259 = sext_i32_i64(local_tid_76647);\n    ltid_74258 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n    gtid_74265 = ltid_74258 + binop_x_74264;\n    cond_74266 = slt64(gtid_74265, min_res_66402);\n    if (cond_74266) {\n        int64_t slice_74268;\n        int64_t eta_p_74269;\n        \n        slice_74268 = start_66400 + gtid_74265;\n        eta_p_74269 = ((__global int64_t *) tR_mem_75467)[slice_74268];\n        pre_74267 = eta_p_74269;\n    } else {\n        pre_74267 = (int64_t) 0;\n    }\n    mem_75772[(int64_t) 0] = pre_74267;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74274 = sext_i32_i64(local_tid_76647);\n    ltid_74273 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n    gtid_74284 = binop_x_74264 + ltid_74273;\n    cond_74285 = slt64(gtid_74284, min_res_66402);\n    if (cond_74285) {\n        neutral_74286 = (int64_", "t) -1;\n    } else {\n        neutral_74286 = (int64_t) 0;\n    }\n    if (cond_74285) {\n        int64_t eta_p_74289 = mem_75772[(int64_t) 0];\n        \n        neutral_74287 = eta_p_74289;\n    } else {\n        neutral_74287 = (int64_t) 0;\n    }\n    mem_75776[(int64_t) 0] = neutral_74286;\n    mem_75780[(int64_t) 0] = neutral_74287;\n    mem_75784[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75785[i_3] = mem_75776[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75786[i_4] = mem_75780[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75787[i_5] = mem_75784[i_5];\n    for (int64_t tile_id_74299 = 0; tile_id_74299 < num_whole_tiles_74272; tile_id_74299++) {\n        int64_t binop_x_74398;\n        int64_t ltid_flat_74397;\n        int64_t ltid_74396;\n        int64_t j_74399;\n        bool cond_74403;\n        int64_t pre1d_74406;\n        int64_t pre1d_74404;\n        int64_t pre1d_74405;\n        int64_t mem_75797[1];\n        int64_t mem_75801[1];\n        int64_t mem_75805[1];\n        int64_t ltid_flat_74417;\n        int64_t ltid_74416;\n        int64_t gtid_74419;\n        int64_t acc_74421;\n        int64_t acc_74422;\n        int64_t acc_74423;\n        bool cond_74424;\n        int64_t acc_74425;\n        int64_t acc_74426;\n        int64_t acc_74427;\n        int64_t mem_param_tmp_76656[1];\n        int64_t mem_param_tmp_76657[1];\n        int64_t mem_param_tmp_76658[1];\n        \n        binop_x_74398 = tile_sizze_74256 * tile_id_74299;\n        ltid_flat_74397 = sext_i32_i64(local_tid_76647);\n        ltid_74396 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n        j_74399 = ltid_74396 + binop_x_74398;\n        cond_74403 = slt64(j_74399, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74406 = btoi_bool_i64(cond_74403);\n        if (cond_74403) {\n            int64_t tile_elem_74407;\n            int64_t slice_75325;\n            int64_t",
                                    " tile_elem_74408;\n            \n            tile_elem_74407 = ((__global int64_t *) ext_mem_75767)[j_74399];\n            slice_75325 = tS_start_64840 + j_74399;\n            tile_elem_74408 = ((__global int64_t *) tS_mem_75468)[slice_75325];\n            pre1d_74404 = tile_elem_74407;\n            pre1d_74405 = tile_elem_74408;\n        } else {\n            pre1d_74404 = (int64_t) 0;\n            pre1d_74405 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74396] = pre1d_74404;\n        ((__local int64_t *) color_76534)[ltid_74396] = pre1d_74405;\n        ((__local int64_t *) color_76533)[ltid_74396] = pre1d_74406;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74417 = sext_i32_i64(local_tid_76647);\n        ltid_74416 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n        gtid_74419 = binop_x_74264 + ltid_74416;\n        acc_74421 = mem_param_75785[(int64_t) 0];\n        acc_74422 = mem_param_75786[(int64_t) 0];\n        acc_74423 = mem_param_75787[(int64_t) 0];\n        cond_74424 = slt64(gtid_74419, min_res_66402);\n        if (cond_74424) {\n            int64_t eta_p_74420;\n            int64_t x_74428;\n            int64_t x_74429;\n            int64_t x_74430;\n            int64_t redout_75342;\n            int64_t redout_75343;\n            int64_t redout_75344;\n            \n            eta_p_74420 = mem_75772[(int64_t) 0];\n            redout_75342 = acc_74421;\n            redout_75343 = acc_74422;\n            redout_75344 = acc_74423;\n            for (int64_t i_75345 = 0; i_75345 < tile_sizze_74256; i_75345++) {\n                int64_t x_74431;\n                int64_t x_74432;\n                bool defunc_0_neq_res_74440;\n                bool defunc_0_neq_res_74441;\n                bool cond_f_res_74442;\n                bool y_74443;\n                bool cond_74444;\n                bool defunc_0_neq_res_74445;\n                bool defunc_0_neq_res_74446;\n                bool cond_t_res_f_res_74447;\n                bool y_74448;\n                bool ", "cond_t_res_74449;\n                bool x_74450;\n                int64_t defunc_0_op_res_74451;\n                int64_t defunc_0_op_res_74452;\n                int64_t defunc_0_op_res_74453;\n                int64_t redout_tmp_76662;\n                int64_t redout_tmp_76663;\n                int64_t redout_tmp_76664;\n                \n                x_74431 = ((__local int64_t *) color_76535)[i_75345];\n                x_74432 = ((__local int64_t *) color_76534)[i_75345];\n                defunc_0_neq_res_74440 = redout_75343 == eta_p_74420;\n                defunc_0_neq_res_74441 = !defunc_0_neq_res_74440;\n                cond_f_res_74442 = slt64(redout_75342, (int64_t) 0);\n                y_74443 = defunc_0_neq_res_74440 && cond_f_res_74442;\n                cond_74444 = defunc_0_neq_res_74441 || y_74443;\n                defunc_0_neq_res_74445 = x_74432 == eta_p_74420;\n                defunc_0_neq_res_74446 = !defunc_0_neq_res_74445;\n                cond_t_res_f_res_74447 = slt64(x_74431, (int64_t) 0);\n                y_74448 = defunc_0_neq_res_74445 && cond_t_res_f_res_74447;\n                cond_t_res_74449 = defunc_0_neq_res_74446 || y_74448;\n                x_74450 = cond_74444 && cond_t_res_74449;\n                if (x_74450) {\n                    defunc_0_op_res_74451 = (int64_t) -1;\n                    defunc_0_op_res_74452 = eta_p_74420;\n                    defunc_0_op_res_74453 = (int64_t) 0;\n                } else {\n                    int64_t x_74433;\n                    int64_t defunc_0_op_res_f_res_74454;\n                    int64_t defunc_0_op_res_f_res_74455;\n                    int64_t defunc_0_op_res_f_res_74456;\n                    \n                    x_74433 = ((__local int64_t *) color_76533)[i_75345];\n                    if (cond_74444) {\n                        defunc_0_op_res_f_res_74454 = x_74431;\n                        defunc_0_op_res_f_res_74455 = x_74432;\n                        defunc_0_op_res_f_res_74456 = x_74433;\n                    } else", " {\n                        int64_t defunc_0_op_res_f_res_f_res_74457;\n                        int64_t defunc_0_op_res_f_res_f_res_74458;\n                        int64_t defunc_0_op_res_f_res_f_res_74459;\n                        \n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74457 = redout_75343;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74457 = eta_p_74420;\n                        }\n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74458 = redout_75342;\n                            defunc_0_op_res_f_res_f_res_74459 = redout_75344;\n                        } else {\n                            int64_t min_res_74460;\n                            int64_t tmp_74461;\n                            \n                            min_res_74460 = smin64(x_74431, redout_75342);\n                            tmp_74461 = add64(x_74433, redout_75344);\n                            defunc_0_op_res_f_res_f_res_74458 = min_res_74460;\n                            defunc_0_op_res_f_res_f_res_74459 = tmp_74461;\n                        }\n                        defunc_0_op_res_f_res_74454 = defunc_0_op_res_f_res_f_res_74458;\n                        defunc_0_op_res_f_res_74455 = defunc_0_op_res_f_res_f_res_74457;\n                        defunc_0_op_res_f_res_74456 = defunc_0_op_res_f_res_f_res_74459;\n                    }\n                    defunc_0_op_res_74451 = defunc_0_op_res_f_res_74454;\n                    defunc_0_op_res_74452 = defunc_0_op_res_f_res_74455;\n                    defunc_0_op_res_74453 = defunc_0_op_res_f_res_74456;\n                }\n                redout_tmp_76662 = defunc_0_op_res_74451;\n                redout_tmp_76663 = defunc_0_op_res_74452;\n                redout_tmp_76664 = defunc_0_op_res_74453;\n                redout_75342 = redout_tmp_76662;\n                redout_75343 = redout_tmp_76663;\n                redout",
                                    "_75344 = redout_tmp_76664;\n            }\n            x_74428 = redout_75342;\n            x_74429 = redout_75343;\n            x_74430 = redout_75344;\n            acc_74425 = x_74428;\n            acc_74426 = x_74429;\n            acc_74427 = x_74430;\n        } else {\n            acc_74425 = acc_74421;\n            acc_74426 = acc_74422;\n            acc_74427 = acc_74423;\n        }\n        mem_75797[(int64_t) 0] = acc_74425;\n        mem_75801[(int64_t) 0] = acc_74426;\n        mem_75805[(int64_t) 0] = acc_74427;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76656[i_6] = mem_75797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76657[i_7] = mem_75801[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76658[i_8] = mem_75805[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75785[i_9] = mem_param_tmp_76656[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75786[i_10] = mem_param_tmp_76657[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75787[i_11] = mem_param_tmp_76658[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75808[i_12] = mem_param_75785[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75807[i_13] = mem_param_75786[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75806[i_14] = mem_param_75787[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74497) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75824[i_15] = ext_mem_75808[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75823[i_16] = ext_mem_75806[i_16];\n    } else {\n        int64_t ltid_flat_74499;\n        int64_t ltid_74498;\n        int64_t j_74514;\n        bool cond_74518;\n        int64_t pre1d_74521;\n        int64_t pre1d_74519;\n        int64_t pre1d_74520;\n        int64_t ltid_flat_74535;\n        ", "int64_t ltid_74534;\n        int64_t gtid_74548;\n        int64_t acc_74550;\n        int64_t acc_74552;\n        bool cond_74553;\n        int64_t acc_74554;\n        int64_t acc_74556;\n        \n        ltid_flat_74499 = sext_i32_i64(local_tid_76647);\n        ltid_74498 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n        j_74514 = ltid_74498 + binop_x_74513;\n        cond_74518 = slt64(j_74514, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74521 = btoi_bool_i64(cond_74518);\n        if (cond_74518) {\n            int64_t tile_elem_74522;\n            int64_t slice_75324;\n            int64_t tile_elem_74523;\n            \n            tile_elem_74522 = ((__global int64_t *) ext_mem_75767)[j_74514];\n            slice_75324 = tS_start_64840 + j_74514;\n            tile_elem_74523 = ((__global int64_t *) tS_mem_75468)[slice_75324];\n            pre1d_74519 = tile_elem_74522;\n            pre1d_74520 = tile_elem_74523;\n        } else {\n            pre1d_74519 = (int64_t) 0;\n            pre1d_74520 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74498] = pre1d_74519;\n        ((__local int64_t *) color_76534)[ltid_74498] = pre1d_74520;\n        ((__local int64_t *) color_76533)[ltid_74498] = pre1d_74521;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74535 = sext_i32_i64(local_tid_76647);\n        ltid_74534 = sext_i32_i64(sext_i64_i32(ltid_pre_76651));\n        gtid_74548 = binop_x_74264 + ltid_74534;\n        acc_74550 = ext_mem_75808[(int64_t) 0];\n        acc_74552 = ext_mem_75806[(int64_t) 0];\n        cond_74553 = slt64(gtid_74548, min_res_66402);\n        if (cond_74553) {\n            int64_t eta_p_74549;\n            int64_t acc_74551;\n            int64_t x_74557;\n            int64_t x_74558;\n            int64_t x_74559;\n            int64_t redout_75346;\n            int64_t redout_75347;\n            int64_t redout_75348;\n            \n            eta_p_74549 = mem_75772[(int64_t) 0];\n            acc_74551 = ext_mem_75807[(int64_t) 0];\n", "            redout_75346 = acc_74550;\n            redout_75347 = acc_74551;\n            redout_75348 = acc_74552;\n            for (int64_t i_75349 = 0; i_75349 < residual_input_74496; i_75349++) {\n                int64_t x_74560;\n                int64_t x_74561;\n                bool defunc_0_neq_res_74569;\n                bool defunc_0_neq_res_74570;\n                bool cond_f_res_74571;\n                bool y_74572;\n                bool cond_74573;\n                bool defunc_0_neq_res_74574;\n                bool defunc_0_neq_res_74575;\n                bool cond_t_res_f_res_74576;\n                bool y_74577;\n                bool cond_t_res_74578;\n                bool x_74579;\n                int64_t defunc_0_op_res_74580;\n                int64_t defunc_0_op_res_74581;\n                int64_t defunc_0_op_res_74582;\n                int64_t redout_tmp_76665;\n                int64_t redout_tmp_76666;\n                int64_t redout_tmp_76667;\n                \n                x_74560 = ((__local int64_t *) color_76535)[i_75349];\n                x_74561 = ((__local int64_t *) color_76534)[i_75349];\n                defunc_0_neq_res_74569 = redout_75347 == eta_p_74549;\n                defunc_0_neq_res_74570 = !defunc_0_neq_res_74569;\n                cond_f_res_74571 = slt64(redout_75346, (int64_t) 0);\n                y_74572 = defunc_0_neq_res_74569 && cond_f_res_74571;\n                cond_74573 = defunc_0_neq_res_74570 || y_74572;\n                defunc_0_neq_res_74574 = x_74561 == eta_p_74549;\n                defunc_0_neq_res_74575 = !defunc_0_neq_res_74574;\n                cond_t_res_f_res_74576 = slt64(x_74560, (int64_t) 0);\n                y_74577 = defunc_0_neq_res_74574 && cond_t_res_f_res_74576;\n                cond_t_res_74578 = defunc_0_neq_res_74575 || y_74577;\n                x_74579 = cond_74573 && cond_t_res_74578;\n                if (x_74579) {\n                    defunc_0_op_res_74580 = (int64_t) -1;\n                    defunc_0_op_res_74581 = eta_p_7454",
                                    "9;\n                    defunc_0_op_res_74582 = (int64_t) 0;\n                } else {\n                    int64_t x_74562;\n                    int64_t defunc_0_op_res_f_res_74583;\n                    int64_t defunc_0_op_res_f_res_74584;\n                    int64_t defunc_0_op_res_f_res_74585;\n                    \n                    x_74562 = ((__local int64_t *) color_76533)[i_75349];\n                    if (cond_74573) {\n                        defunc_0_op_res_f_res_74583 = x_74560;\n                        defunc_0_op_res_f_res_74584 = x_74561;\n                        defunc_0_op_res_f_res_74585 = x_74562;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_74586;\n                        int64_t defunc_0_op_res_f_res_f_res_74587;\n                        int64_t defunc_0_op_res_f_res_f_res_74588;\n                        \n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74586 = redout_75347;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74586 = eta_p_74549;\n                        }\n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74587 = redout_75346;\n                            defunc_0_op_res_f_res_f_res_74588 = redout_75348;\n                        } else {\n                            int64_t min_res_74589;\n                            int64_t tmp_74590;\n                            \n                            min_res_74589 = smin64(x_74560, redout_75346);\n                            tmp_74590 = add64(x_74562, redout_75348);\n                            defunc_0_op_res_f_res_f_res_74587 = min_res_74589;\n                            defunc_0_op_res_f_res_f_res_74588 = tmp_74590;\n                        }\n                        defunc_0_op_res_f_res_74583 = defunc_0_op_res_f_res_f_res_74587;\n                        defunc_0_op_res_f_res_74584 = defunc_0_op_res_f_res_f_res_74586;\n ", "                       defunc_0_op_res_f_res_74585 = defunc_0_op_res_f_res_f_res_74588;\n                    }\n                    defunc_0_op_res_74580 = defunc_0_op_res_f_res_74583;\n                    defunc_0_op_res_74581 = defunc_0_op_res_f_res_74584;\n                    defunc_0_op_res_74582 = defunc_0_op_res_f_res_74585;\n                }\n                redout_tmp_76665 = defunc_0_op_res_74580;\n                redout_tmp_76666 = defunc_0_op_res_74581;\n                redout_tmp_76667 = defunc_0_op_res_74582;\n                redout_75346 = redout_tmp_76665;\n                redout_75347 = redout_tmp_76666;\n                redout_75348 = redout_tmp_76667;\n            }\n            x_74557 = redout_75346;\n            x_74558 = redout_75347;\n            x_74559 = redout_75348;\n            acc_74554 = x_74557;\n            acc_74556 = x_74559;\n        } else {\n            acc_74554 = acc_74550;\n            acc_74556 = acc_74552;\n        }\n        mem_75818[(int64_t) 0] = acc_74554;\n        mem_75822[(int64_t) 0] = acc_74556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75824[i_17] = mem_75818[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75823[i_18] = mem_75822[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76647) + tile_sizze_74256 * sext_i32_i64(block_id_76648), min_res_66402)) {\n        int64_t tmp_76668 = ext_mem_75824[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75826)[sext_i32_i64(local_tid_76647) + tile_sizze_74256 * sext_i32_i64(block_id_76648)] = tmp_76668;\n    }\n    if (slt64(sext_i32_i64(local_tid_76647) + tile_sizze_74256 * sext_i32_i64(block_id_76648), min_res_66402)) {\n        int64_t tmp_76669 = ext_mem_75823[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75828)[sext_i32_i64(local_tid_76647) + tile_sizze_74256 * sext_i32_i64(block_id_76648)] = tmp_76669;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74256\n    #undef bytes_7578", "8\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_74609_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_74609(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74612, int64_t num_whole_tiles_74627, int64_t residual_input_74851, unsigned char cond_74852_bits, int64_t binop_x_74868, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75682, __global unsigned char *mem_75684)\n{\n    bool cond_74852 = cond_74852_bits;\n    \n    #define tile_sizze_74611 (inner_SMJ_longzisegmap_intrablock_74609zitile_sizze_74611)\n    #define bytes_75644 (inner_SMJ_longzisegmap_intrablock_74609zibytes_75644)\n    \n    volatile __local unsigned char *color_76538_backing_2 = &shared_mem[0];\n    const int64_t color_76538_backing_2_offset = 0 + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76537_backing_1 = &shared_mem[color_76538_backing_2_offset];\n    const int64_t color_76537_backing_1_offset = color_76538_backing_2_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76536_backing_0 = &shared_mem[color_76537_backing_1_offset];\n    const int64_t color_76536_backing_0_offset = color_76537_backing_1_offset + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76788;\n    int32_t tblock_sizze_76791;\n    int32_t wave_sizze_76790;\n    int32_t block_id_76789;\n    int32_t global_tid_76787;\n    int64_t gid_flat_74609;\n    int64_t slice_76793;\n    int64_t ltid_pre_76792;\n    int64_t remnant_76794;\n    int64_t slice_76795;\n    int64_t gid_74608;\n    int64_t remnant_76796;\n    __local unsigned char *color_76536;\n    __local unsigned char *color_76537;\n    _",
                                    "_local unsigned char *color_76538;\n    int64_t binop_x_74619;\n    int64_t mem_75628[1];\n    int64_t ltid_flat_74614;\n    int64_t ltid_74613;\n    int64_t gtid_74620;\n    bool cond_74621;\n    int64_t pre_74622;\n    int64_t mem_75632[1];\n    int64_t mem_75636[1];\n    int64_t mem_75640[1];\n    int64_t ltid_flat_74629;\n    int64_t ltid_74628;\n    int64_t gtid_74639;\n    bool cond_74640;\n    int64_t neutral_74641;\n    int64_t neutral_74642;\n    int64_t ext_mem_75664[1];\n    int64_t ext_mem_75663[1];\n    int64_t ext_mem_75662[1];\n    int64_t mem_param_75641[1];\n    int64_t mem_param_75642[1];\n    int64_t mem_param_75643[1];\n    int64_t mem_75674[1];\n    int64_t mem_75678[1];\n    int64_t ext_mem_75680[1];\n    int64_t ext_mem_75679[1];\n    \n    local_tid_76788 = get_local_id(0);\n    tblock_sizze_76791 = get_local_size(0);\n    wave_sizze_76790 = LOCKSTEP_WIDTH;\n    block_id_76789 = get_tblock_id(0);\n    global_tid_76787 = block_id_76789 * tblock_sizze_76791 + local_tid_76788;\n    gid_flat_74609 = sext_i32_i64(block_id_76789);\n    slice_76793 = tile_sizze_74611;\n    ltid_pre_76792 = sext_i32_i64(local_tid_76788);\n    remnant_76794 = sext_i32_i64(local_tid_76788) - ltid_pre_76792;\n    slice_76795 = ldim_74612;\n    gid_74608 = sext_i32_i64(block_id_76789);\n    remnant_76796 = sext_i32_i64(block_id_76789) - gid_74608;\n    color_76536 = (__local unsigned char *) color_76536_backing_0;\n    color_76537 = (__local unsigned char *) color_76537_backing_1;\n    color_76538 = (__local unsigned char *) color_76538_backing_2;\n    binop_x_74619 = gid_74608 * tile_sizze_74611;\n    ltid_flat_74614 = sext_i32_i64(local_tid_76788);\n    ltid_74613 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n    gtid_74620 = ltid_74613 + binop_x_74619;\n    cond_74621 = slt64(gtid_74620, min_res_65540);\n    if (cond_74621) {\n        int64_t slice_74623;\n        int64_t eta_p_74624;\n        \n        slice_74623 = slice_65554 + gtid_74620;\n        eta_p_74624 = ((__global int64_t *) tR_mem_75467)[slice_74623];\n    ", "    pre_74622 = eta_p_74624;\n    } else {\n        pre_74622 = (int64_t) 0;\n    }\n    mem_75628[(int64_t) 0] = pre_74622;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74629 = sext_i32_i64(local_tid_76788);\n    ltid_74628 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n    gtid_74639 = binop_x_74619 + ltid_74628;\n    cond_74640 = slt64(gtid_74639, min_res_65540);\n    if (cond_74640) {\n        neutral_74641 = (int64_t) -1;\n    } else {\n        neutral_74641 = (int64_t) 0;\n    }\n    if (cond_74640) {\n        int64_t eta_p_74644 = mem_75628[(int64_t) 0];\n        \n        neutral_74642 = eta_p_74644;\n    } else {\n        neutral_74642 = (int64_t) 0;\n    }\n    mem_75632[(int64_t) 0] = neutral_74641;\n    mem_75636[(int64_t) 0] = neutral_74642;\n    mem_75640[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75641[i_3] = mem_75632[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75642[i_4] = mem_75636[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75643[i_5] = mem_75640[i_5];\n    for (int64_t tile_id_74654 = 0; tile_id_74654 < num_whole_tiles_74627; tile_id_74654++) {\n        int64_t binop_x_74753;\n        int64_t ltid_flat_74752;\n        int64_t ltid_74751;\n        int64_t j_74754;\n        bool cond_74758;\n        int64_t pre1d_74761;\n        int64_t pre1d_74759;\n        int64_t pre1d_74760;\n        int64_t mem_75653[1];\n        int64_t mem_75657[1];\n        int64_t mem_75661[1];\n        int64_t ltid_flat_74772;\n        int64_t ltid_74771;\n        int64_t gtid_74774;\n        int64_t acc_74776;\n        int64_t acc_74777;\n        int64_t acc_74778;\n        bool cond_74779;\n        int64_t acc_74780;\n        int64_t acc_74781;\n        int64_t acc_74782;\n        int64_t mem_param_tmp_76797[1];\n        int64_t mem_param_tmp_76798[1];\n        int64_t mem_param_tmp_76799[1];\n        \n        binop_x_74753 = tile_sizze_74611 * tile_id_74654;\n", "        ltid_flat_74752 = sext_i32_i64(local_tid_76788);\n        ltid_74751 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n        j_74754 = ltid_74751 + binop_x_74753;\n        cond_74758 = slt64(j_74754, j_m_i_65502);\n        pre1d_74761 = btoi_bool_i64(cond_74758);\n        if (cond_74758) {\n            int64_t tile_elem_74762;\n            int64_t slice_75329;\n            int64_t tile_elem_74763;\n            \n            tile_elem_74762 = ((__global int64_t *) ext_mem_75562)[j_74754];\n            slice_75329 = slice_65911 + j_74754;\n            tile_elem_74763 = ((__global int64_t *) tS_mem_75468)[slice_75329];\n            pre1d_74759 = tile_elem_74762;\n            pre1d_74760 = tile_elem_74763;\n        } else {\n            pre1d_74759 = (int64_t) 0;\n            pre1d_74760 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74751] = pre1d_74759;\n        ((__local int64_t *) color_76537)[ltid_74751] = pre1d_74760;\n        ((__local int64_t *) color_76536)[ltid_74751] = pre1d_74761;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74772 = sext_i32_i64(local_tid_76788);\n        ltid_74771 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n        gtid_74774 = binop_x_74619 + ltid_74771;\n        acc_74776 = mem_param_75641[(int64_t) 0];\n        acc_74777 = mem_param_75642[(int64_t) 0];\n        acc_74778 = mem_param_75643[(int64_t) 0];\n        cond_74779 = slt64(gtid_74774, min_res_65540);\n        if (cond_74779) {\n            int64_t eta_p_74775;\n            int64_t x_74783;\n            int64_t x_74784;\n            int64_t x_74785;\n            int64_t redout_75350;\n            int64_t redout_75351;\n            int64_t redout_75352;\n            \n            eta_p_74775 = mem_75628[(int64_t) 0];\n            redout_75350 = acc_74776;\n            redout_75351 = acc_74777;\n            redout_75352 = acc_74778;\n            for (int64_t i_75353 = 0; i_75353 < tile_sizze_74611; i_75353++) {\n                int64_t x_74786;\n                int64_t x_74787;",
                                    "\n                bool defunc_0_neq_res_74795;\n                bool defunc_0_neq_res_74796;\n                bool cond_f_res_74797;\n                bool y_74798;\n                bool cond_74799;\n                bool defunc_0_neq_res_74800;\n                bool defunc_0_neq_res_74801;\n                bool cond_t_res_f_res_74802;\n                bool y_74803;\n                bool cond_t_res_74804;\n                bool x_74805;\n                int64_t defunc_0_op_res_74806;\n                int64_t defunc_0_op_res_74807;\n                int64_t defunc_0_op_res_74808;\n                int64_t redout_tmp_76803;\n                int64_t redout_tmp_76804;\n                int64_t redout_tmp_76805;\n                \n                x_74786 = ((__local int64_t *) color_76538)[i_75353];\n                x_74787 = ((__local int64_t *) color_76537)[i_75353];\n                defunc_0_neq_res_74795 = redout_75351 == eta_p_74775;\n                defunc_0_neq_res_74796 = !defunc_0_neq_res_74795;\n                cond_f_res_74797 = slt64(redout_75350, (int64_t) 0);\n                y_74798 = defunc_0_neq_res_74795 && cond_f_res_74797;\n                cond_74799 = defunc_0_neq_res_74796 || y_74798;\n                defunc_0_neq_res_74800 = x_74787 == eta_p_74775;\n                defunc_0_neq_res_74801 = !defunc_0_neq_res_74800;\n                cond_t_res_f_res_74802 = slt64(x_74786, (int64_t) 0);\n                y_74803 = defunc_0_neq_res_74800 && cond_t_res_f_res_74802;\n                cond_t_res_74804 = defunc_0_neq_res_74801 || y_74803;\n                x_74805 = cond_74799 && cond_t_res_74804;\n                if (x_74805) {\n                    defunc_0_op_res_74806 = (int64_t) -1;\n                    defunc_0_op_res_74807 = eta_p_74775;\n                    defunc_0_op_res_74808 = (int64_t) 0;\n                } else {\n                    int64_t x_74788;\n                    int64_t defunc_0_op_res_f_res_74809;\n                    int64_t defunc_0_op_res_f_res_74810;\n                    int64_", "t defunc_0_op_res_f_res_74811;\n                    \n                    x_74788 = ((__local int64_t *) color_76536)[i_75353];\n                    if (cond_74799) {\n                        defunc_0_op_res_f_res_74809 = x_74786;\n                        defunc_0_op_res_f_res_74810 = x_74787;\n                        defunc_0_op_res_f_res_74811 = x_74788;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_74812;\n                        int64_t defunc_0_op_res_f_res_f_res_74813;\n                        int64_t defunc_0_op_res_f_res_f_res_74814;\n                        \n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74812 = redout_75351;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74812 = eta_p_74775;\n                        }\n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74813 = redout_75350;\n                            defunc_0_op_res_f_res_f_res_74814 = redout_75352;\n                        } else {\n                            int64_t min_res_74815;\n                            int64_t tmp_74816;\n                            \n                            min_res_74815 = smin64(x_74786, redout_75350);\n                            tmp_74816 = add64(x_74788, redout_75352);\n                            defunc_0_op_res_f_res_f_res_74813 = min_res_74815;\n                            defunc_0_op_res_f_res_f_res_74814 = tmp_74816;\n                        }\n                        defunc_0_op_res_f_res_74809 = defunc_0_op_res_f_res_f_res_74813;\n                        defunc_0_op_res_f_res_74810 = defunc_0_op_res_f_res_f_res_74812;\n                        defunc_0_op_res_f_res_74811 = defunc_0_op_res_f_res_f_res_74814;\n                    }\n                    defunc_0_op_res_74806 = defunc_0_op_res_f_res_74809;\n                    defunc_0_op_res_74807 = defunc_0_op_res_f_res_74810;\n      ", "              defunc_0_op_res_74808 = defunc_0_op_res_f_res_74811;\n                }\n                redout_tmp_76803 = defunc_0_op_res_74806;\n                redout_tmp_76804 = defunc_0_op_res_74807;\n                redout_tmp_76805 = defunc_0_op_res_74808;\n                redout_75350 = redout_tmp_76803;\n                redout_75351 = redout_tmp_76804;\n                redout_75352 = redout_tmp_76805;\n            }\n            x_74783 = redout_75350;\n            x_74784 = redout_75351;\n            x_74785 = redout_75352;\n            acc_74780 = x_74783;\n            acc_74781 = x_74784;\n            acc_74782 = x_74785;\n        } else {\n            acc_74780 = acc_74776;\n            acc_74781 = acc_74777;\n            acc_74782 = acc_74778;\n        }\n        mem_75653[(int64_t) 0] = acc_74780;\n        mem_75657[(int64_t) 0] = acc_74781;\n        mem_75661[(int64_t) 0] = acc_74782;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76797[i_6] = mem_75653[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76798[i_7] = mem_75657[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76799[i_8] = mem_75661[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75641[i_9] = mem_param_tmp_76797[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75642[i_10] = mem_param_tmp_76798[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75643[i_11] = mem_param_tmp_76799[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75664[i_12] = mem_param_75641[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75663[i_13] = mem_param_75642[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75662[i_14] = mem_param_75643[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74852) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75680[i_15] ",
                                    "= ext_mem_75664[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75679[i_16] = ext_mem_75662[i_16];\n    } else {\n        int64_t ltid_flat_74854;\n        int64_t ltid_74853;\n        int64_t j_74869;\n        bool cond_74873;\n        int64_t pre1d_74876;\n        int64_t pre1d_74874;\n        int64_t pre1d_74875;\n        int64_t ltid_flat_74890;\n        int64_t ltid_74889;\n        int64_t gtid_74903;\n        int64_t acc_74905;\n        int64_t acc_74907;\n        bool cond_74908;\n        int64_t acc_74909;\n        int64_t acc_74911;\n        \n        ltid_flat_74854 = sext_i32_i64(local_tid_76788);\n        ltid_74853 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n        j_74869 = ltid_74853 + binop_x_74868;\n        cond_74873 = slt64(j_74869, j_m_i_65502);\n        pre1d_74876 = btoi_bool_i64(cond_74873);\n        if (cond_74873) {\n            int64_t tile_elem_74877;\n            int64_t slice_75328;\n            int64_t tile_elem_74878;\n            \n            tile_elem_74877 = ((__global int64_t *) ext_mem_75562)[j_74869];\n            slice_75328 = slice_65911 + j_74869;\n            tile_elem_74878 = ((__global int64_t *) tS_mem_75468)[slice_75328];\n            pre1d_74874 = tile_elem_74877;\n            pre1d_74875 = tile_elem_74878;\n        } else {\n            pre1d_74874 = (int64_t) 0;\n            pre1d_74875 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74853] = pre1d_74874;\n        ((__local int64_t *) color_76537)[ltid_74853] = pre1d_74875;\n        ((__local int64_t *) color_76536)[ltid_74853] = pre1d_74876;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74890 = sext_i32_i64(local_tid_76788);\n        ltid_74889 = sext_i32_i64(sext_i64_i32(ltid_pre_76792));\n        gtid_74903 = binop_x_74619 + ltid_74889;\n        acc_74905 = ext_mem_75664[(int64_t) 0];\n        acc_74907 = ext_mem_75662[(int64_t) 0];\n        cond_74908 = slt64(gtid_74903, min_res_65540);\n        if (cond_74908) {\n            int64_t eta_p_74", "904;\n            int64_t acc_74906;\n            int64_t x_74912;\n            int64_t x_74913;\n            int64_t x_74914;\n            int64_t redout_75354;\n            int64_t redout_75355;\n            int64_t redout_75356;\n            \n            eta_p_74904 = mem_75628[(int64_t) 0];\n            acc_74906 = ext_mem_75663[(int64_t) 0];\n            redout_75354 = acc_74905;\n            redout_75355 = acc_74906;\n            redout_75356 = acc_74907;\n            for (int64_t i_75357 = 0; i_75357 < residual_input_74851; i_75357++) {\n                int64_t x_74915;\n                int64_t x_74916;\n                bool defunc_0_neq_res_74924;\n                bool defunc_0_neq_res_74925;\n                bool cond_f_res_74926;\n                bool y_74927;\n                bool cond_74928;\n                bool defunc_0_neq_res_74929;\n                bool defunc_0_neq_res_74930;\n                bool cond_t_res_f_res_74931;\n                bool y_74932;\n                bool cond_t_res_74933;\n                bool x_74934;\n                int64_t defunc_0_op_res_74935;\n                int64_t defunc_0_op_res_74936;\n                int64_t defunc_0_op_res_74937;\n                int64_t redout_tmp_76806;\n                int64_t redout_tmp_76807;\n                int64_t redout_tmp_76808;\n                \n                x_74915 = ((__local int64_t *) color_76538)[i_75357];\n                x_74916 = ((__local int64_t *) color_76537)[i_75357];\n                defunc_0_neq_res_74924 = redout_75355 == eta_p_74904;\n                defunc_0_neq_res_74925 = !defunc_0_neq_res_74924;\n                cond_f_res_74926 = slt64(redout_75354, (int64_t) 0);\n                y_74927 = defunc_0_neq_res_74924 && cond_f_res_74926;\n                cond_74928 = defunc_0_neq_res_74925 || y_74927;\n                defunc_0_neq_res_74929 = x_74916 == eta_p_74904;\n                defunc_0_neq_res_74930 = !defunc_0_neq_res_74929;\n                cond_t_res_f_res_74931 = slt64(x_74915, (int64_t) 0);\n       ", "         y_74932 = defunc_0_neq_res_74929 && cond_t_res_f_res_74931;\n                cond_t_res_74933 = defunc_0_neq_res_74930 || y_74932;\n                x_74934 = cond_74928 && cond_t_res_74933;\n                if (x_74934) {\n                    defunc_0_op_res_74935 = (int64_t) -1;\n                    defunc_0_op_res_74936 = eta_p_74904;\n                    defunc_0_op_res_74937 = (int64_t) 0;\n                } else {\n                    int64_t x_74917;\n                    int64_t defunc_0_op_res_f_res_74938;\n                    int64_t defunc_0_op_res_f_res_74939;\n                    int64_t defunc_0_op_res_f_res_74940;\n                    \n                    x_74917 = ((__local int64_t *) color_76536)[i_75357];\n                    if (cond_74928) {\n                        defunc_0_op_res_f_res_74938 = x_74915;\n                        defunc_0_op_res_f_res_74939 = x_74916;\n                        defunc_0_op_res_f_res_74940 = x_74917;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_74941;\n                        int64_t defunc_0_op_res_f_res_f_res_74942;\n                        int64_t defunc_0_op_res_f_res_f_res_74943;\n                        \n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74941 = redout_75355;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74941 = eta_p_74904;\n                        }\n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74942 = redout_75354;\n                            defunc_0_op_res_f_res_f_res_74943 = redout_75356;\n                        } else {\n                            int64_t min_res_74944;\n                            int64_t tmp_74945;\n                            \n                            min_res_74944 = smin64(x_74915, redout_75354);\n                            tmp_74945 = add64(x_74917, redout_75356);\n                   ",
                                    "         defunc_0_op_res_f_res_f_res_74942 = min_res_74944;\n                            defunc_0_op_res_f_res_f_res_74943 = tmp_74945;\n                        }\n                        defunc_0_op_res_f_res_74938 = defunc_0_op_res_f_res_f_res_74942;\n                        defunc_0_op_res_f_res_74939 = defunc_0_op_res_f_res_f_res_74941;\n                        defunc_0_op_res_f_res_74940 = defunc_0_op_res_f_res_f_res_74943;\n                    }\n                    defunc_0_op_res_74935 = defunc_0_op_res_f_res_74938;\n                    defunc_0_op_res_74936 = defunc_0_op_res_f_res_74939;\n                    defunc_0_op_res_74937 = defunc_0_op_res_f_res_74940;\n                }\n                redout_tmp_76806 = defunc_0_op_res_74935;\n                redout_tmp_76807 = defunc_0_op_res_74936;\n                redout_tmp_76808 = defunc_0_op_res_74937;\n                redout_75354 = redout_tmp_76806;\n                redout_75355 = redout_tmp_76807;\n                redout_75356 = redout_tmp_76808;\n            }\n            x_74912 = redout_75354;\n            x_74913 = redout_75355;\n            x_74914 = redout_75356;\n            acc_74909 = x_74912;\n            acc_74911 = x_74914;\n        } else {\n            acc_74909 = acc_74905;\n            acc_74911 = acc_74907;\n        }\n        mem_75674[(int64_t) 0] = acc_74909;\n        mem_75678[(int64_t) 0] = acc_74911;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75680[i_17] = mem_75674[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75679[i_18] = mem_75678[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76788) + tile_sizze_74611 * sext_i32_i64(block_id_76789), min_res_65540)) {\n        int64_t tmp_76809 = ext_mem_75680[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75682)[sext_i32_i64(local_tid_76788) + tile_sizze_74611 * sext_i32_i64(block_id_76789)] = tmp_76809;\n    }\n    if (slt64(sext_i32_i64(local_tid_76788) + tile_sizze", "_74611 * sext_i32_i64(block_id_76789), min_res_65540)) {\n        int64_t tmp_76810 = ext_mem_75679[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75684)[sext_i32_i64(local_tid_76788) + tile_sizze_74611 * sext_i32_i64(block_id_76789)] = tmp_76810;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74611\n    #undef bytes_75644\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegmap_intrablock_74964_dim1, 1, 1)\nvoid inner_SMJ_longzisegmap_intrablock_74964(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74967, int64_t num_whole_tiles_74982, int64_t residual_input_75206, unsigned char cond_75207_bits, int64_t binop_x_75223, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75621, __global unsigned char *mem_75623)\n{\n    bool cond_75207 = cond_75207_bits;\n    \n    #define tile_sizze_74966 (inner_SMJ_longzisegmap_intrablock_74964zitile_sizze_74966)\n    #define bytes_75583 (inner_SMJ_longzisegmap_intrablock_74964zibytes_75583)\n    \n    volatile __local unsigned char *color_76541_backing_2 = &shared_mem[0];\n    const int64_t color_76541_backing_2_offset = 0 + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76540_backing_1 = &shared_mem[color_76541_backing_2_offset];\n    const int64_t color_76540_backing_1_offset = color_76541_backing_2_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76539_backing_0 = &shared_mem[color_76540_backing_1_offset];\n    const int64_t color_76539_backing_0_offset = color_76540_backing_1_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76814;\n    int32_t tblock_sizze_76817;\n    int32_t wave", "_sizze_76816;\n    int32_t block_id_76815;\n    int32_t global_tid_76813;\n    int64_t gid_flat_74964;\n    int64_t slice_76819;\n    int64_t ltid_pre_76818;\n    int64_t remnant_76820;\n    int64_t slice_76821;\n    int64_t gid_74963;\n    int64_t remnant_76822;\n    __local unsigned char *color_76539;\n    __local unsigned char *color_76540;\n    __local unsigned char *color_76541;\n    int64_t binop_x_74974;\n    int64_t mem_75567[1];\n    int64_t ltid_flat_74969;\n    int64_t ltid_74968;\n    int64_t gtid_74975;\n    bool cond_74976;\n    int64_t pre_74977;\n    int64_t mem_75571[1];\n    int64_t mem_75575[1];\n    int64_t mem_75579[1];\n    int64_t ltid_flat_74984;\n    int64_t ltid_74983;\n    int64_t gtid_74994;\n    bool cond_74995;\n    int64_t neutral_74996;\n    int64_t neutral_74997;\n    int64_t ext_mem_75603[1];\n    int64_t ext_mem_75602[1];\n    int64_t ext_mem_75601[1];\n    int64_t mem_param_75580[1];\n    int64_t mem_param_75581[1];\n    int64_t mem_param_75582[1];\n    int64_t mem_75613[1];\n    int64_t mem_75617[1];\n    int64_t ext_mem_75619[1];\n    int64_t ext_mem_75618[1];\n    \n    local_tid_76814 = get_local_id(0);\n    tblock_sizze_76817 = get_local_size(0);\n    wave_sizze_76816 = LOCKSTEP_WIDTH;\n    block_id_76815 = get_tblock_id(0);\n    global_tid_76813 = block_id_76815 * tblock_sizze_76817 + local_tid_76814;\n    gid_flat_74964 = sext_i32_i64(block_id_76815);\n    slice_76819 = tile_sizze_74966;\n    ltid_pre_76818 = sext_i32_i64(local_tid_76814);\n    remnant_76820 = sext_i32_i64(local_tid_76814) - ltid_pre_76818;\n    slice_76821 = ldim_74967;\n    gid_74963 = sext_i32_i64(block_id_76815);\n    remnant_76822 = sext_i32_i64(block_id_76815) - gid_74963;\n    color_76539 = (__local unsigned char *) color_76539_backing_0;\n    color_76540 = (__local unsigned char *) color_76540_backing_1;\n    color_76541 = (__local unsigned char *) color_76541_backing_2;\n    binop_x_74974 = gid_74963 * tile_sizze_74966;\n    ltid_flat_74969 = sext_i32_i64(local_tid_76814);\n    ltid_74968 = sext_i32_i64(",
                                    "sext_i64_i32(ltid_pre_76818));\n    gtid_74975 = ltid_74968 + binop_x_74974;\n    cond_74976 = slt64(gtid_74975, min_res_65540);\n    if (cond_74976) {\n        int64_t slice_74978;\n        int64_t eta_p_74979;\n        \n        slice_74978 = slice_65554 + gtid_74975;\n        eta_p_74979 = ((__global int64_t *) tR_mem_75467)[slice_74978];\n        pre_74977 = eta_p_74979;\n    } else {\n        pre_74977 = (int64_t) 0;\n    }\n    mem_75567[(int64_t) 0] = pre_74977;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74984 = sext_i32_i64(local_tid_76814);\n    ltid_74983 = sext_i32_i64(sext_i64_i32(ltid_pre_76818));\n    gtid_74994 = binop_x_74974 + ltid_74983;\n    cond_74995 = slt64(gtid_74994, min_res_65540);\n    if (cond_74995) {\n        neutral_74996 = (int64_t) -1;\n    } else {\n        neutral_74996 = (int64_t) 0;\n    }\n    if (cond_74995) {\n        int64_t eta_p_74999 = mem_75567[(int64_t) 0];\n        \n        neutral_74997 = eta_p_74999;\n    } else {\n        neutral_74997 = (int64_t) 0;\n    }\n    mem_75571[(int64_t) 0] = neutral_74996;\n    mem_75575[(int64_t) 0] = neutral_74997;\n    mem_75579[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75580[i_3] = mem_75571[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75581[i_4] = mem_75575[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75582[i_5] = mem_75579[i_5];\n    for (int64_t tile_id_75009 = 0; tile_id_75009 < num_whole_tiles_74982; tile_id_75009++) {\n        int64_t binop_x_75108;\n        int64_t ltid_flat_75107;\n        int64_t ltid_75106;\n        int64_t j_75109;\n        bool cond_75113;\n        int64_t pre1d_75116;\n        int64_t pre1d_75114;\n        int64_t pre1d_75115;\n        int64_t mem_75592[1];\n        int64_t mem_75596[1];\n        int64_t mem_75600[1];\n        int64_t ltid_flat_75127;\n        int64_t ltid_75126;\n        int64_t gtid_75129;\n        int64_t acc_75131;\n       ", " int64_t acc_75132;\n        int64_t acc_75133;\n        bool cond_75134;\n        int64_t acc_75135;\n        int64_t acc_75136;\n        int64_t acc_75137;\n        int64_t mem_param_tmp_76823[1];\n        int64_t mem_param_tmp_76824[1];\n        int64_t mem_param_tmp_76825[1];\n        \n        binop_x_75108 = tile_sizze_74966 * tile_id_75009;\n        ltid_flat_75107 = sext_i32_i64(local_tid_76814);\n        ltid_75106 = sext_i32_i64(sext_i64_i32(ltid_pre_76818));\n        j_75109 = ltid_75106 + binop_x_75108;\n        cond_75113 = slt64(j_75109, j_m_i_65502);\n        pre1d_75116 = btoi_bool_i64(cond_75113);\n        if (cond_75113) {\n            int64_t tile_elem_75117;\n            int64_t slice_75333;\n            int64_t tile_elem_75118;\n            \n            tile_elem_75117 = ((__global int64_t *) ext_mem_75562)[j_75109];\n            slice_75333 = slice_65911 + j_75109;\n            tile_elem_75118 = ((__global int64_t *) tS_mem_75468)[slice_75333];\n            pre1d_75114 = tile_elem_75117;\n            pre1d_75115 = tile_elem_75118;\n        } else {\n            pre1d_75114 = (int64_t) 0;\n            pre1d_75115 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75106] = pre1d_75114;\n        ((__local int64_t *) color_76540)[ltid_75106] = pre1d_75115;\n        ((__local int64_t *) color_76539)[ltid_75106] = pre1d_75116;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75127 = sext_i32_i64(local_tid_76814);\n        ltid_75126 = sext_i32_i64(sext_i64_i32(ltid_pre_76818));\n        gtid_75129 = binop_x_74974 + ltid_75126;\n        acc_75131 = mem_param_75580[(int64_t) 0];\n        acc_75132 = mem_param_75581[(int64_t) 0];\n        acc_75133 = mem_param_75582[(int64_t) 0];\n        cond_75134 = slt64(gtid_75129, min_res_65540);\n        if (cond_75134) {\n            int64_t eta_p_75130;\n            int64_t x_75138;\n            int64_t x_75139;\n            int64_t x_75140;\n            int64_t redout_75358;\n            int64_t redout_75359;\n            int", "64_t redout_75360;\n            \n            eta_p_75130 = mem_75567[(int64_t) 0];\n            redout_75358 = acc_75131;\n            redout_75359 = acc_75132;\n            redout_75360 = acc_75133;\n            for (int64_t i_75361 = 0; i_75361 < tile_sizze_74966; i_75361++) {\n                int64_t x_75141;\n                int64_t x_75142;\n                bool defunc_0_neq_res_75150;\n                bool defunc_0_neq_res_75151;\n                bool cond_f_res_75152;\n                bool y_75153;\n                bool cond_75154;\n                bool defunc_0_neq_res_75155;\n                bool defunc_0_neq_res_75156;\n                bool cond_t_res_f_res_75157;\n                bool y_75158;\n                bool cond_t_res_75159;\n                bool x_75160;\n                int64_t defunc_0_op_res_75161;\n                int64_t defunc_0_op_res_75162;\n                int64_t defunc_0_op_res_75163;\n                int64_t redout_tmp_76829;\n                int64_t redout_tmp_76830;\n                int64_t redout_tmp_76831;\n                \n                x_75141 = ((__local int64_t *) color_76541)[i_75361];\n                x_75142 = ((__local int64_t *) color_76540)[i_75361];\n                defunc_0_neq_res_75150 = redout_75359 == eta_p_75130;\n                defunc_0_neq_res_75151 = !defunc_0_neq_res_75150;\n                cond_f_res_75152 = slt64(redout_75358, (int64_t) 0);\n                y_75153 = defunc_0_neq_res_75150 && cond_f_res_75152;\n                cond_75154 = defunc_0_neq_res_75151 || y_75153;\n                defunc_0_neq_res_75155 = x_75142 == eta_p_75130;\n                defunc_0_neq_res_75156 = !defunc_0_neq_res_75155;\n                cond_t_res_f_res_75157 = slt64(x_75141, (int64_t) 0);\n                y_75158 = defunc_0_neq_res_75155 && cond_t_res_f_res_75157;\n                cond_t_res_75159 = defunc_0_neq_res_75156 || y_75158;\n                x_75160 = cond_75154 && cond_t_res_75159;\n                if (x_75160) {\n                    defunc_0_op_re",
                                    "s_75161 = (int64_t) -1;\n                    defunc_0_op_res_75162 = eta_p_75130;\n                    defunc_0_op_res_75163 = (int64_t) 0;\n                } else {\n                    int64_t x_75143;\n                    int64_t defunc_0_op_res_f_res_75164;\n                    int64_t defunc_0_op_res_f_res_75165;\n                    int64_t defunc_0_op_res_f_res_75166;\n                    \n                    x_75143 = ((__local int64_t *) color_76539)[i_75361];\n                    if (cond_75154) {\n                        defunc_0_op_res_f_res_75164 = x_75141;\n                        defunc_0_op_res_f_res_75165 = x_75142;\n                        defunc_0_op_res_f_res_75166 = x_75143;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_75167;\n                        int64_t defunc_0_op_res_f_res_f_res_75168;\n                        int64_t defunc_0_op_res_f_res_f_res_75169;\n                        \n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75167 = redout_75359;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75167 = eta_p_75130;\n                        }\n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75168 = redout_75358;\n                            defunc_0_op_res_f_res_f_res_75169 = redout_75360;\n                        } else {\n                            int64_t min_res_75170;\n                            int64_t tmp_75171;\n                            \n                            min_res_75170 = smin64(x_75141, redout_75358);\n                            tmp_75171 = add64(x_75143, redout_75360);\n                            defunc_0_op_res_f_res_f_res_75168 = min_res_75170;\n                            defunc_0_op_res_f_res_f_res_75169 = tmp_75171;\n                        }\n                        defunc_0_op_res_f_res_75164 = defunc_0_op_res_f_res_f_res_75168;\n            ", "            defunc_0_op_res_f_res_75165 = defunc_0_op_res_f_res_f_res_75167;\n                        defunc_0_op_res_f_res_75166 = defunc_0_op_res_f_res_f_res_75169;\n                    }\n                    defunc_0_op_res_75161 = defunc_0_op_res_f_res_75164;\n                    defunc_0_op_res_75162 = defunc_0_op_res_f_res_75165;\n                    defunc_0_op_res_75163 = defunc_0_op_res_f_res_75166;\n                }\n                redout_tmp_76829 = defunc_0_op_res_75161;\n                redout_tmp_76830 = defunc_0_op_res_75162;\n                redout_tmp_76831 = defunc_0_op_res_75163;\n                redout_75358 = redout_tmp_76829;\n                redout_75359 = redout_tmp_76830;\n                redout_75360 = redout_tmp_76831;\n            }\n            x_75138 = redout_75358;\n            x_75139 = redout_75359;\n            x_75140 = redout_75360;\n            acc_75135 = x_75138;\n            acc_75136 = x_75139;\n            acc_75137 = x_75140;\n        } else {\n            acc_75135 = acc_75131;\n            acc_75136 = acc_75132;\n            acc_75137 = acc_75133;\n        }\n        mem_75592[(int64_t) 0] = acc_75135;\n        mem_75596[(int64_t) 0] = acc_75136;\n        mem_75600[(int64_t) 0] = acc_75137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76823[i_6] = mem_75592[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76824[i_7] = mem_75596[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76825[i_8] = mem_75600[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75580[i_9] = mem_param_tmp_76823[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75581[i_10] = mem_param_tmp_76824[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75582[i_11] = mem_param_tmp_76825[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75603[i_12] = mem_param_75580[", "i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75602[i_13] = mem_param_75581[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75601[i_14] = mem_param_75582[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_75207) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75619[i_15] = ext_mem_75603[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75618[i_16] = ext_mem_75601[i_16];\n    } else {\n        int64_t ltid_flat_75209;\n        int64_t ltid_75208;\n        int64_t j_75224;\n        bool cond_75228;\n        int64_t pre1d_75231;\n        int64_t pre1d_75229;\n        int64_t pre1d_75230;\n        int64_t ltid_flat_75245;\n        int64_t ltid_75244;\n        int64_t gtid_75258;\n        int64_t acc_75260;\n        int64_t acc_75262;\n        bool cond_75263;\n        int64_t acc_75264;\n        int64_t acc_75266;\n        \n        ltid_flat_75209 = sext_i32_i64(local_tid_76814);\n        ltid_75208 = sext_i32_i64(sext_i64_i32(ltid_pre_76818));\n        j_75224 = ltid_75208 + binop_x_75223;\n        cond_75228 = slt64(j_75224, j_m_i_65502);\n        pre1d_75231 = btoi_bool_i64(cond_75228);\n        if (cond_75228) {\n            int64_t tile_elem_75232;\n            int64_t slice_75332;\n            int64_t tile_elem_75233;\n            \n            tile_elem_75232 = ((__global int64_t *) ext_mem_75562)[j_75224];\n            slice_75332 = slice_65911 + j_75224;\n            tile_elem_75233 = ((__global int64_t *) tS_mem_75468)[slice_75332];\n            pre1d_75229 = tile_elem_75232;\n            pre1d_75230 = tile_elem_75233;\n        } else {\n            pre1d_75229 = (int64_t) 0;\n            pre1d_75230 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75208] = pre1d_75229;\n        ((__local int64_t *) color_76540)[ltid_75208] = pre1d_75230;\n        ((__local int64_t *) color_76539)[ltid_75208] = pre1d_75231;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75245 = sext_i32_i",
                                    "64(local_tid_76814);\n        ltid_75244 = sext_i32_i64(sext_i64_i32(ltid_pre_76818));\n        gtid_75258 = binop_x_74974 + ltid_75244;\n        acc_75260 = ext_mem_75603[(int64_t) 0];\n        acc_75262 = ext_mem_75601[(int64_t) 0];\n        cond_75263 = slt64(gtid_75258, min_res_65540);\n        if (cond_75263) {\n            int64_t eta_p_75259;\n            int64_t acc_75261;\n            int64_t x_75267;\n            int64_t x_75268;\n            int64_t x_75269;\n            int64_t redout_75362;\n            int64_t redout_75363;\n            int64_t redout_75364;\n            \n            eta_p_75259 = mem_75567[(int64_t) 0];\n            acc_75261 = ext_mem_75602[(int64_t) 0];\n            redout_75362 = acc_75260;\n            redout_75363 = acc_75261;\n            redout_75364 = acc_75262;\n            for (int64_t i_75365 = 0; i_75365 < residual_input_75206; i_75365++) {\n                int64_t x_75270;\n                int64_t x_75271;\n                bool defunc_0_neq_res_75279;\n                bool defunc_0_neq_res_75280;\n                bool cond_f_res_75281;\n                bool y_75282;\n                bool cond_75283;\n                bool defunc_0_neq_res_75284;\n                bool defunc_0_neq_res_75285;\n                bool cond_t_res_f_res_75286;\n                bool y_75287;\n                bool cond_t_res_75288;\n                bool x_75289;\n                int64_t defunc_0_op_res_75290;\n                int64_t defunc_0_op_res_75291;\n                int64_t defunc_0_op_res_75292;\n                int64_t redout_tmp_76832;\n                int64_t redout_tmp_76833;\n                int64_t redout_tmp_76834;\n                \n                x_75270 = ((__local int64_t *) color_76541)[i_75365];\n                x_75271 = ((__local int64_t *) color_76540)[i_75365];\n                defunc_0_neq_res_75279 = redout_75363 == eta_p_75259;\n                defunc_0_neq_res_75280 = !defunc_0_neq_res_75279;\n                cond_f_res_75281 = slt64(redout_75362, (int64_t) 0);\n  ", "              y_75282 = defunc_0_neq_res_75279 && cond_f_res_75281;\n                cond_75283 = defunc_0_neq_res_75280 || y_75282;\n                defunc_0_neq_res_75284 = x_75271 == eta_p_75259;\n                defunc_0_neq_res_75285 = !defunc_0_neq_res_75284;\n                cond_t_res_f_res_75286 = slt64(x_75270, (int64_t) 0);\n                y_75287 = defunc_0_neq_res_75284 && cond_t_res_f_res_75286;\n                cond_t_res_75288 = defunc_0_neq_res_75285 || y_75287;\n                x_75289 = cond_75283 && cond_t_res_75288;\n                if (x_75289) {\n                    defunc_0_op_res_75290 = (int64_t) -1;\n                    defunc_0_op_res_75291 = eta_p_75259;\n                    defunc_0_op_res_75292 = (int64_t) 0;\n                } else {\n                    int64_t x_75272;\n                    int64_t defunc_0_op_res_f_res_75293;\n                    int64_t defunc_0_op_res_f_res_75294;\n                    int64_t defunc_0_op_res_f_res_75295;\n                    \n                    x_75272 = ((__local int64_t *) color_76539)[i_75365];\n                    if (cond_75283) {\n                        defunc_0_op_res_f_res_75293 = x_75270;\n                        defunc_0_op_res_f_res_75294 = x_75271;\n                        defunc_0_op_res_f_res_75295 = x_75272;\n                    } else {\n                        int64_t defunc_0_op_res_f_res_f_res_75296;\n                        int64_t defunc_0_op_res_f_res_f_res_75297;\n                        int64_t defunc_0_op_res_f_res_f_res_75298;\n                        \n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75296 = redout_75363;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75296 = eta_p_75259;\n                        }\n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75297 = redout_75362;\n                            defunc_0_op_res_f_res_f_res_75298 ", "= redout_75364;\n                        } else {\n                            int64_t min_res_75299;\n                            int64_t tmp_75300;\n                            \n                            min_res_75299 = smin64(x_75270, redout_75362);\n                            tmp_75300 = add64(x_75272, redout_75364);\n                            defunc_0_op_res_f_res_f_res_75297 = min_res_75299;\n                            defunc_0_op_res_f_res_f_res_75298 = tmp_75300;\n                        }\n                        defunc_0_op_res_f_res_75293 = defunc_0_op_res_f_res_f_res_75297;\n                        defunc_0_op_res_f_res_75294 = defunc_0_op_res_f_res_f_res_75296;\n                        defunc_0_op_res_f_res_75295 = defunc_0_op_res_f_res_f_res_75298;\n                    }\n                    defunc_0_op_res_75290 = defunc_0_op_res_f_res_75293;\n                    defunc_0_op_res_75291 = defunc_0_op_res_f_res_75294;\n                    defunc_0_op_res_75292 = defunc_0_op_res_f_res_75295;\n                }\n                redout_tmp_76832 = defunc_0_op_res_75290;\n                redout_tmp_76833 = defunc_0_op_res_75291;\n                redout_tmp_76834 = defunc_0_op_res_75292;\n                redout_75362 = redout_tmp_76832;\n                redout_75363 = redout_tmp_76833;\n                redout_75364 = redout_tmp_76834;\n            }\n            x_75267 = redout_75362;\n            x_75268 = redout_75363;\n            x_75269 = redout_75364;\n            acc_75264 = x_75267;\n            acc_75266 = x_75269;\n        } else {\n            acc_75264 = acc_75260;\n            acc_75266 = acc_75262;\n        }\n        mem_75613[(int64_t) 0] = acc_75264;\n        mem_75617[(int64_t) 0] = acc_75266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75619[i_17] = mem_75613[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75618[i_18] = mem_75617[i_18];\n    }\n    if (slt64(sext_i32_i64(local_ti",
                                    "d_76814) + tile_sizze_74966 * sext_i32_i64(block_id_76815), min_res_65540)) {\n        int64_t tmp_76835 = ext_mem_75619[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75621)[sext_i32_i64(local_tid_76814) + tile_sizze_74966 * sext_i32_i64(block_id_76815)] = tmp_76835;\n    }\n    if (slt64(sext_i32_i64(local_tid_76814) + tile_sizze_74966 * sext_i32_i64(block_id_76815), min_res_65540)) {\n        int64_t tmp_76836 = ext_mem_75618[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75623)[sext_i32_i64(local_tid_76814) + tile_sizze_74966 * sext_i32_i64(block_id_76815)] = tmp_76836;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74966\n    #undef bytes_75583\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegscan_71187_dim1, 1, 1)\nvoid inner_SMJ_longzisegscan_71187(__global int *global_failure, int64_t nR_47166, int64_t num_tblocks_71184, int64_t num_virt_blocks_76904, int64_t num_virt_threads_76905, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *status_flags_mem_76906, __global unsigned char *aggregates_mem_76928, __global unsigned char *incprefixes_mem_76930, __global unsigned char *global_dynid_mem_76932)\n{\n    #define segscan_tblock_sizze_71182 (inner_SMJ_longzisegscan_71187zisegscan_tblock_sizze_71182)\n    #define chunk_sizze_76903 (inner_SMJ_longzisegscan_71187zichunk_sizze_76903)\n    \n    volatile __local unsigned char *local_mem_76962_backing_0 = &shared_mem[0];\n    const int64_t local_mem_76962_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_71182), chunk_sizze_76903 * segscan_tblock_sizze_71182 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_71182), chunk_sizze_76903 * segscan_tblock_sizze_71182 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76955;\n    int32_t tblock_sizze_76958;\n    int32_t ", "wave_sizze_76957;\n    int32_t block_id_76956;\n    int32_t global_tid_76954;\n    int64_t phys_tid_71187;\n    int32_t chunk_sizze_32b_76959;\n    int64_t byte_offsets_76960;\n    int64_t warp_byte_offset_76961;\n    __local unsigned char *local_mem_76962;\n    int64_t trans_arr_len_76963;\n    int64_t phys_block_id_76969;\n    int64_t virtloop_bound_76970;\n    \n    local_tid_76955 = get_local_id(0);\n    tblock_sizze_76958 = get_local_size(0);\n    wave_sizze_76957 = LOCKSTEP_WIDTH;\n    block_id_76956 = get_tblock_id(0);\n    global_tid_76954 = block_id_76956 * tblock_sizze_76958 + local_tid_76955;\n    phys_tid_71187 = sext_i32_i64(global_tid_76954);\n    chunk_sizze_32b_76959 = sext_i64_i32(chunk_sizze_76903);\n    byte_offsets_76960 = segscan_tblock_sizze_71182 * (int64_t) 8;\n    warp_byte_offset_76961 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_76962 = (__local unsigned char *) local_mem_76962_backing_0;\n    trans_arr_len_76963 = chunk_sizze_76903 * segscan_tblock_sizze_71182;\n    phys_block_id_76969 = get_tblock_id(0);\n    virtloop_bound_76970 = sdiv_up64(num_virt_blocks_76904 - phys_block_id_76969, num_tblocks_71184);\n    for (int64_t virtloop_i_76971 = 0; virtloop_i_76971 < virtloop_bound_76970; virtloop_i_76971++) {\n        int64_t dynamic_id_76972;\n        int64_t block_offset_76973;\n        int64_t sgm_idx_76974;\n        int32_t boundary_76975;\n        int32_t segsizze_compact_76976;\n        int64_t private_mem_76977[chunk_sizze_76903];\n        int64_t thd_offset_76979;\n        int64_t acc_76995;\n        int64_t prefix_77005;\n        bool block_new_sgm_77006;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_76955 == 0) {\n                dynamic_id_76972 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_76932)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_76962)[(i", "nt64_t) 0] = dynamic_id_76972;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_76972 == num_virt_blocks_76904 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_76932)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_76972 = ((__local int32_t *) local_mem_76962)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_76973 = dynamic_id_76972 * chunk_sizze_76903 * segscan_tblock_sizze_71182;\n        sgm_idx_76974 = smod64(block_offset_76973, nR_47166);\n        boundary_76975 = sext_i64_i32(smin64(chunk_sizze_76903 * segscan_tblock_sizze_71182, nR_47166 - sgm_idx_76974));\n        segsizze_compact_76976 = sext_i64_i32(smin64(chunk_sizze_76903 * segscan_tblock_sizze_71182, nR_47166));\n        thd_offset_76979 = block_offset_76973 + sext_i32_i64(local_tid_76955);\n        // Load and map\n        {\n            for (int64_t i_76980 = 0; i_76980 < chunk_sizze_76903; i_76980++) {\n                int64_t virt_tid_76981 = thd_offset_76979 + i_76980 * segscan_tblock_sizze_71182;\n                int64_t slice_76982 = nR_47166;\n                int64_t gtid_71186 = virt_tid_76981;\n                int64_t remnant_76983 = virt_tid_76981 - gtid_71186;\n                \n                if (slt64(virt_tid_76981, nR_47166)) {\n                    int64_t eta_p_65962 = ((__global int64_t *) ext_mem_75938)[gtid_71186];\n                    bool lifted_lambda_res_65963 = slt64((int64_t) 0, eta_p_65962);\n                    int64_t defunc_0_f_res_65964 = btoi_bool_i64(lifted_lambda_res_65963);\n                    \n                    ((__global int64_t *) mem_75943)[gtid_71186] = defunc_0_f_res_65964;\n                    private_mem_76977[i_76980] = defunc_0_f_res_65964;\n                } else {\n                    private_mem_76977[i_76980] = (int64_t) 0;\n  ",
                                    "              }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_76984 = 0; i_76984 < chunk_sizze_76903; i_76984++) {\n                int64_t sharedIdx_76985 = sext_i32_i64(local_tid_76955) + i_76984 * segscan_tblock_sizze_71182;\n                int64_t tmp_76986 = private_mem_76977[i_76984];\n                \n                ((__local int64_t *) local_mem_76962)[sharedIdx_76985] = tmp_76986;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_76987 = 0; i_76987 < chunk_sizze_76903; i_76987++) {\n                int64_t sharedIdx_76988 = sext_i32_i64(local_tid_76955) * chunk_sizze_76903 + i_76987;\n                int64_t tmp_76989 = ((__local int64_t *) local_mem_76962)[sharedIdx_76988];\n                \n                private_mem_76977[i_76987] = tmp_76989;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_76990 = 0; i_76990 < chunk_sizze_76903 - (int64_t) 1; i_76990++) {\n                int64_t eta_p_65673;\n                int64_t eta_p_65674;\n                \n                eta_p_65673 = private_mem_76977[i_76990];\n                eta_p_65674 = private_mem_76977[i_76990 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_65675 = add64(eta_p_65673, eta_p_65674);\n                \n                private_mem_76977[i_76990 + (int64_t) 1] = defunc_0_op_res_65675;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_76991 = private_mem_76977[chunk_sizze_76903 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = tmp_76991;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_76992;\n            int64_t eta_p_76993;\n            int64_t eta_p_76996;\n            int64_t eta_p_76997;", "\n            bool ltid_in_bounds_76999 = slt64(sext_i32_i64(local_tid_76955), num_virt_threads_76905);\n            int32_t skip_threads_77000;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_76999) {\n                    eta_p_76993 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                    if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                        eta_p_76992 = eta_p_76993;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77000 = 1;\n                while (slt32(skip_threads_77000, 32)) {\n                    bool thread_active_77001 = sle32(skip_threads_77000, local_tid_76955 - squot32(local_tid_76955, 32) * 32) && ltid_in_bounds_76999;\n                    \n                    if (thread_active_77001) {\n                        // read operands\n                        {\n                            eta_p_76992 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77000)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77001) {\n                            int64_t defunc_0_op_res_76994 = add64(eta_p_76992, eta_p_76993);\n                            \n                            eta_p_76992 = defunc_0_op_res_76994;\n                        }\n                    }\n                    if (sle32(wave_sizze_76957, skip_threads_77000)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77001) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76992;\n                            eta_p_76993 = eta_p_", "76992;\n                        }\n                    }\n                    if (sle32(wave_sizze_76957, skip_threads_77000)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77000 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 31 && ltid_in_bounds_76999) {\n                    ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(squot32(local_tid_76955, 32))] = eta_p_76992;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77002;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999) {\n                        eta_p_76997 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                        if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                            eta_p_76996 = eta_p_76997;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77002 = 1;\n                    while (slt32(skip_threads_77002, 32)) {\n                        bool thread_active_77003 = sle32(skip_threads_77002, local_tid_76955 - squot32(local_tid_76955, 32) * 32) && (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999);\n                        \n                        if (thread_active_77003) {\n                            // read operands\n                            {\n                                eta_p_76996 = ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(l",
                                    "ocal_tid_76955) - sext_i32_i64(skip_threads_77002)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77003) {\n                                int64_t defunc_0_op_res_76998 = add64(eta_p_76996, eta_p_76997);\n                                \n                                eta_p_76996 = defunc_0_op_res_76998;\n                            }\n                        }\n                        if (sle32(wave_sizze_76957, skip_threads_77002)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77003) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76996;\n                                eta_p_76997 = eta_p_76996;\n                            }\n                        }\n                        if (sle32(wave_sizze_76957, skip_threads_77002)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77002 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77004 = squot32(local_tid_76955, 32) == 0 || !ltid_in_bounds_76999;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77004) {\n                        eta_p_76993 = eta_p_76992;\n                        eta_p_76992 = ((__local int64_t *) local_mem_76962)[sext_i32_i64(squot32(local_tid_76955, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77004) {\n                        int64_t defunc_0_op_res_76994 = add64(et", "a_p_76992, eta_p_76993);\n                        \n                        eta_p_76992 = defunc_0_op_res_76994;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77004) {\n                        ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76992;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_76955, 32) == 0 && ltid_in_bounds_76999) {\n                    ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = eta_p_76993;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_76955 == 0) {\n                acc_76995 = ((__local int64_t *) local_mem_76962)[segscan_tblock_sizze_71182 - (int64_t) 1];\n            } else {\n                acc_76995 = ((__local int64_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77005 = (int64_t) 0;\n        block_new_sgm_77006 = sgm_idx_76974 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77006 && local_tid_76955 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_76930)[dynamic_id_76972] = acc_76995;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_76906)[dynamic_id_76972] = (int8_t) 2;\n                acc_76995 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77006 && slt32(local_tid_76955, wave_sizze_76957)) {\n                if (local_tid_76955 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_76928)[dynamic_id_76972] = acc_76995;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_", "mem_76906)[dynamic_id_76972] = (int8_t) 1;\n                    \n                    int8_t tmp_77007 = ((volatile __global int8_t *) status_flags_mem_76906)[dynamic_id_76972 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_76962)[(int64_t) 0] = tmp_77007;\n                }\n                mem_fence_local();\n                \n                int8_t status_77008 = ((__local int8_t *) local_mem_76962)[(int64_t) 0];\n                \n                if (status_77008 == (int8_t) 2) {\n                    if (local_tid_76955 == 0) {\n                        prefix_77005 = ((volatile __global int64_t *) incprefixes_mem_76930)[dynamic_id_76972 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77009 = sext_i64_i32(dynamic_id_76972 - sext_i32_i64(wave_sizze_76957));\n                    \n                    while (slt32(wave_sizze_76957 * -1, readOffset_77009)) {\n                        int32_t read_i_77010 = readOffset_77009 + local_tid_76955;\n                        int64_t aggr_77011 = (int64_t) 0;\n                        int8_t flag_77012 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77010)) {\n                            flag_77012 = ((volatile __global int8_t *) status_flags_mem_76906)[sext_i32_i64(read_i_77010)];\n                            if (flag_77012 == (int8_t) 2) {\n                                aggr_77011 = ((volatile __global int64_t *) incprefixes_mem_76930)[sext_i32_i64(read_i_77010)];\n                            } else if (flag_77012 == (int8_t) 1) {\n                                aggr_77011 = ((volatile __global int64_t *) aggregates_mem_76928)[sext_i32_i64(read_i_77010)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)] = aggr_77011;\n                        ((__local int8_t *) local_mem_76962)[sext_i32_i64(local_t",
                                    "id_76955)] = flag_77012;\n                        flag_77012 = ((__local int8_t *) local_mem_76962)[sext_i32_i64(wave_sizze_76957) - (int64_t) 1];\n                        if (slt8(flag_77012, (int8_t) 2)) {\n                            int8_t flg_x_77016;\n                            int8_t flg_y_77017;\n                            int64_t eta_p_77013;\n                            int64_t eta_p_77014;\n                            int32_t skip_threads_77018;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77017 = ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)];\n                                eta_p_77014 = ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)];\n                                if ((local_tid_76955 - squot32(local_tid_76955, 32) * 32) == 0) {\n                                    eta_p_77013 = eta_p_77014;\n                                    flg_x_77016 = flg_y_77017;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77018 = 1;\n                                while (slt32(skip_threads_77018, 32)) {\n                                    if (sle32(skip_threads_77018, local_tid_76955 - squot32(local_tid_76955, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77016 = ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77018)];\n                                            eta_p_77013 = ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + (sext_i32_i64(local_tid_76955) - sext_i32_i64(skip_threads_77018))];\n                                        }\n                  ", "                      // perform operation\n                                        {\n                                            if (flg_y_77017 == (int8_t) 2 || flg_y_77017 == (int8_t) 0) {\n                                                flg_x_77016 = flg_y_77017;\n                                                eta_p_77013 = eta_p_77014;\n                                            } else {\n                                                int64_t defunc_0_op_res_77015 = add64(eta_p_77013, eta_p_77014);\n                                                \n                                                eta_p_77013 = defunc_0_op_res_77015;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_76962)[sext_i32_i64(local_tid_76955)] = flg_x_77016;\n                                            flg_y_77017 = flg_x_77016;\n                                            ((volatile __local int64_t *) local_mem_76962)[(int64_t) 4 + sext_i32_i64(local_tid_76955)] = eta_p_77013;\n                                            eta_p_77014 = eta_p_77013;\n                                        }\n                                    }\n                                    skip_threads_77018 *= 2;\n                                }\n                            }\n                        }\n                        flag_77012 = ((__local int8_t *) local_mem_76962)[sext_i32_i64(wave_sizze_76957) - (int64_t) 1];\n                        aggr_77011 = ((__local int64_t *) local_mem_76962)[(int64_t) 4 + (sext_i32_i64(wave_sizze_76957) - (int64_t) 1)];\n                        if (flag_77012 == (int8_t) 2) {\n                            readOffset_77009 = wave_sizze_76957 * -1;\n                        } else if (flag_77012 == (int8_t) 1) {\n                            readOffset_77009 -= wave_sizze_76957;", "\n                        }\n                        if (slt8((int8_t) 0, flag_77012)) {\n                            int64_t eta_p_77019 = aggr_77011;\n                            int64_t eta_p_77020 = prefix_77005;\n                            int64_t defunc_0_op_res_77021 = add64(eta_p_77019, eta_p_77020);\n                            \n                            prefix_77005 = defunc_0_op_res_77021;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_76955 == 0) {\n                    if (boundary_76975 == sext_i64_i32(segscan_tblock_sizze_71182 * chunk_sizze_76903)) {\n                        int64_t eta_p_77022 = prefix_77005;\n                        int64_t eta_p_77023 = acc_76995;\n                        int64_t defunc_0_op_res_77024 = add64(eta_p_77022, eta_p_77023);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_76930)[dynamic_id_76972] = defunc_0_op_res_77024;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_76906)[dynamic_id_76972] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_76962)[(int64_t) 4] = prefix_77005;\n                    acc_76995 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_76972 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77005 = ((__local int64_t *) local_mem_76962)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77025;\n            int64_t eta_p_77026;\n            int64_t eta_p_77028 = prefix_77005;\n            int64_t eta_p_77029 = acc_76995;\n            \n            if (slt32(local_tid_76955 * chunk_sizze_32b_76959, boundary_76975) && !block_new_sgm_77006) {\n                int64_t defunc_0_op_res_77030 = add64(eta_p_77028, eta_p_7702",
                                    "9);\n                \n                eta_p_77025 = defunc_0_op_res_77030;\n            } else {\n                eta_p_77025 = acc_76995;\n            }\n            \n            int32_t stopping_point_77031 = segsizze_compact_76976 - srem32(local_tid_76955 * chunk_sizze_32b_76959 - 1 + segsizze_compact_76976 - boundary_76975, segsizze_compact_76976);\n            \n            for (int64_t i_77032 = 0; i_77032 < chunk_sizze_76903; i_77032++) {\n                if (slt32(sext_i64_i32(i_77032), stopping_point_77031 - 1)) {\n                    eta_p_77026 = private_mem_76977[i_77032];\n                    \n                    int64_t defunc_0_op_res_77027 = add64(eta_p_77025, eta_p_77026);\n                    \n                    private_mem_76977[i_77032] = defunc_0_op_res_77027;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77033 = 0; i_77033 < chunk_sizze_76903; i_77033++) {\n                int64_t sharedIdx_77034 = sext_i32_i64(local_tid_76955) * chunk_sizze_76903 + i_77033;\n                int64_t tmp_77035 = private_mem_76977[i_77033];\n                \n                ((__local int64_t *) local_mem_76962)[sharedIdx_77034] = tmp_77035;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77036 = 0; i_77036 < chunk_sizze_76903; i_77036++) {\n                int64_t flat_idx_77037 = thd_offset_76979 + i_77036 * segscan_tblock_sizze_71182;\n                int64_t slice_77038 = nR_47166;\n                int64_t gtid_71186 = flat_idx_77037;\n                int64_t remnant_77039 = flat_idx_77037 - gtid_71186;\n                \n                if (slt64(flat_idx_77037, nR_47166)) {\n                    int64_t tmp_77040 = ((__local int64_t *) local_mem_76962)[flat_idx_77037 - block_offset_76973];\n                    \n                    ((__global int64_t *) mem_75941)[gtid_71186] = tmp_77040;\n                }\n            }\n           ", " barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_71182\n    #undef chunk_sizze_76903\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_longzisegscan_71203_dim1, 1, 1)\nvoid inner_SMJ_longzisegscan_71203(__global int *global_failure, int64_t m_65686, int64_t num_tblocks_71200, int64_t num_virt_blocks_77061, int64_t num_virt_threads_77062, __global unsigned char *mem_75945, __global unsigned char *mem_75955, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *status_flags_mem_77063, __global unsigned char *aggregates_mem_77065, __global unsigned char *incprefixes_mem_77067, __global unsigned char *aggregates_mem_77069, __global unsigned char *incprefixes_mem_77071, __global unsigned char *global_dynid_mem_77073)\n{\n    #define segscan_tblock_sizze_71198 (inner_SMJ_longzisegscan_71203zisegscan_tblock_sizze_71198)\n    #define chunk_sizze_77060 (inner_SMJ_longzisegscan_71203zichunk_sizze_77060)\n    \n    volatile __local unsigned char *local_mem_77085_backing_0 = &shared_mem[0];\n    const int64_t local_mem_77085_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_71198, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_71198), smax64(chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_71198, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_71198), smax64(chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77076;\n    int32_t tblock_sizze_77079;\n    int32_t wave_sizze_77078;\n    int32_t block_id_77077;\n    int32_t global_tid_77075;\n    int64_t phys_tid_71203;\n    int32_t", " chunk_sizze_32b_77080;\n    int64_t byte_offsets_77081;\n    int64_t byte_offsets_77082;\n    int64_t warp_byte_offset_77083;\n    int64_t warp_byte_offset_77084;\n    __local unsigned char *local_mem_77085;\n    int64_t trans_arr_len_77086;\n    int64_t phys_block_id_77095;\n    int64_t virtloop_bound_77096;\n    \n    local_tid_77076 = get_local_id(0);\n    tblock_sizze_77079 = get_local_size(0);\n    wave_sizze_77078 = LOCKSTEP_WIDTH;\n    block_id_77077 = get_tblock_id(0);\n    global_tid_77075 = block_id_77077 * tblock_sizze_77079 + local_tid_77076;\n    phys_tid_71203 = sext_i32_i64(global_tid_77075);\n    chunk_sizze_32b_77080 = sext_i64_i32(chunk_sizze_77060);\n    byte_offsets_77081 = segscan_tblock_sizze_71198 * (int64_t) 8;\n    byte_offsets_77082 = sdiv_up64(byte_offsets_77081, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_71198 * (int64_t) 8;\n    warp_byte_offset_77083 = (int64_t) 288;\n    warp_byte_offset_77084 = sdiv_up64(warp_byte_offset_77083, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_77085 = (__local unsigned char *) local_mem_77085_backing_0;\n    trans_arr_len_77086 = chunk_sizze_77060 * segscan_tblock_sizze_71198;\n    phys_block_id_77095 = get_tblock_id(0);\n    virtloop_bound_77096 = sdiv_up64(num_virt_blocks_77061 - phys_block_id_77095, num_tblocks_71200);\n    for (int64_t virtloop_i_77097 = 0; virtloop_i_77097 < virtloop_bound_77096; virtloop_i_77097++) {\n        int64_t dynamic_id_77098;\n        int64_t block_offset_77099;\n        int64_t sgm_idx_77100;\n        int32_t boundary_77101;\n        int32_t segsizze_compact_77102;\n        int64_t private_mem_77103[chunk_sizze_77060];\n        int64_t private_mem_77105[chunk_sizze_77060];\n        int64_t thd_offset_77107;\n        int64_t acc_77133;\n        int64_t acc_77134;\n        int64_t prefix_77147;\n        int64_t prefix_77148;\n        bool block_new_sgm_77149;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n   ",
                                    "         if (local_tid_77076 == 0) {\n                dynamic_id_77098 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_77073)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_77085)[(int64_t) 0] = dynamic_id_77098;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_77098 == num_virt_blocks_77061 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_77073)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_77098 = ((__local int32_t *) local_mem_77085)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_77099 = dynamic_id_77098 * chunk_sizze_77060 * segscan_tblock_sizze_71198;\n        sgm_idx_77100 = smod64(block_offset_77099, m_65686);\n        boundary_77101 = sext_i64_i32(smin64(chunk_sizze_77060 * segscan_tblock_sizze_71198, m_65686 - sgm_idx_77100));\n        segsizze_compact_77102 = sext_i64_i32(smin64(chunk_sizze_77060 * segscan_tblock_sizze_71198, m_65686));\n        thd_offset_77107 = block_offset_77099 + sext_i32_i64(local_tid_77076);\n        // Load and map\n        {\n            for (int64_t i_77108 = 0; i_77108 < chunk_sizze_77060; i_77108++) {\n                int64_t virt_tid_77109 = thd_offset_77107 + i_77108 * segscan_tblock_sizze_71198;\n                int64_t slice_77110 = m_65686;\n                int64_t gtid_71202 = virt_tid_77109;\n                int64_t remnant_77111 = virt_tid_77109 - gtid_71202;\n                \n                if (slt64(virt_tid_77109, m_65686)) {\n                    int64_t x_65967 = ((__global int64_t *) mem_75945)[gtid_71202];\n                    bool lifted_lambda_res_65969 = slt64((int64_t) 1, x_65967);\n                    int64_t defunc_0_f_res_65970 = btoi_bool_i64(lifted_lambda_re", "s_65969);\n                    \n                    ((__global int64_t *) mem_75959)[gtid_71202] = defunc_0_f_res_65970;\n                    private_mem_77103[i_77108] = x_65967;\n                    private_mem_77105[i_77108] = defunc_0_f_res_65970;\n                } else {\n                    private_mem_77103[i_77108] = (int64_t) 0;\n                    private_mem_77105[i_77108] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77112 = 0; i_77112 < chunk_sizze_77060; i_77112++) {\n                int64_t sharedIdx_77113 = sext_i32_i64(local_tid_77076) + i_77112 * segscan_tblock_sizze_71198;\n                int64_t tmp_77114 = private_mem_77103[i_77112];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77113] = tmp_77114;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77115 = 0; i_77115 < chunk_sizze_77060; i_77115++) {\n                int64_t sharedIdx_77116 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77115;\n                int64_t tmp_77117 = ((__local int64_t *) local_mem_77085)[sharedIdx_77116];\n                \n                private_mem_77103[i_77115] = tmp_77117;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77118 = 0; i_77118 < chunk_sizze_77060; i_77118++) {\n                int64_t sharedIdx_77119 = sext_i32_i64(local_tid_77076) + i_77118 * segscan_tblock_sizze_71198;\n                int64_t tmp_77120 = private_mem_77105[i_77118];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77119] = tmp_77120;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77121 = 0; i_77121 < chunk_sizze_77060; i_77121++) {\n                int64_t sharedIdx_77122 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77121;\n                int64_t tmp_77123 = ((__local int64_t *) local_mem", "_77085)[sharedIdx_77122];\n                \n                private_mem_77105[i_77121] = tmp_77123;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77124 = 0; i_77124 < chunk_sizze_77060 - (int64_t) 1; i_77124++) {\n                int64_t eta_p_65723;\n                int64_t eta_p_65724;\n                \n                eta_p_65723 = private_mem_77103[i_77124];\n                eta_p_65724 = private_mem_77103[i_77124 + (int64_t) 1];\n                \n                int64_t eta_p_65816;\n                int64_t eta_p_65817;\n                \n                eta_p_65816 = private_mem_77105[i_77124];\n                eta_p_65817 = private_mem_77105[i_77124 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_65725 = add64(eta_p_65723, eta_p_65724);\n                int64_t defunc_0_op_res_65818 = add64(eta_p_65816, eta_p_65817);\n                \n                private_mem_77103[i_77124 + (int64_t) 1] = lifted_lambda_res_65725;\n                private_mem_77105[i_77124 + (int64_t) 1] = defunc_0_op_res_65818;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77125 = private_mem_77103[chunk_sizze_77060 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = tmp_77125;\n            \n            int64_t tmp_77126 = private_mem_77105[chunk_sizze_77060 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = tmp_77126;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77127;\n            int64_t eta_p_77128;\n            int64_t eta_p_77129;\n            int64_t eta_p_77130;\n            int64_t eta_p_77135;\n            int64_t eta_p_77136;\n            int64_t eta_p_77137;\n            int64_t eta_p_77138",
                                    ";\n            bool ltid_in_bounds_77141 = slt64(sext_i32_i64(local_tid_77076), num_virt_threads_77062);\n            int32_t skip_threads_77142;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77141) {\n                    eta_p_77129 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                    eta_p_77130 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                    if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                        eta_p_77127 = eta_p_77129;\n                        eta_p_77128 = eta_p_77130;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77142 = 1;\n                while (slt32(skip_threads_77142, 32)) {\n                    bool thread_active_77143 = sle32(skip_threads_77142, local_tid_77076 - squot32(local_tid_77076, 32) * 32) && ltid_in_bounds_77141;\n                    \n                    if (thread_active_77143) {\n                        // read operands\n                        {\n                            eta_p_77127 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77142)];\n                            eta_p_77128 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77142))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77143) {\n                            int64_t lifted_lambda_res_77131 = add64(eta_p_77127, eta_p_77129);\n                            int64_t defunc_0_op_res_77132 = add64(eta_p_77128, eta_p_77130);\n                            \n                            eta_p_7712", "7 = lifted_lambda_res_77131;\n                            eta_p_77128 = defunc_0_op_res_77132;\n                        }\n                    }\n                    if (sle32(wave_sizze_77078, skip_threads_77142)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77143) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77127;\n                            eta_p_77129 = eta_p_77127;\n                            ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77128;\n                            eta_p_77130 = eta_p_77128;\n                        }\n                    }\n                    if (sle32(wave_sizze_77078, skip_threads_77142)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77142 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 31 && ltid_in_bounds_77141) {\n                    ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(squot32(local_tid_77076, 32))] = eta_p_77127;\n                    ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(squot32(local_tid_77076, 32))] = eta_p_77128;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77144;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141) {\n       ", "                 eta_p_77137 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                        eta_p_77138 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                        if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                            eta_p_77135 = eta_p_77137;\n                            eta_p_77136 = eta_p_77138;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77144 = 1;\n                    while (slt32(skip_threads_77144, 32)) {\n                        bool thread_active_77145 = sle32(skip_threads_77144, local_tid_77076 - squot32(local_tid_77076, 32) * 32) && (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141);\n                        \n                        if (thread_active_77145) {\n                            // read operands\n                            {\n                                eta_p_77135 = ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77144)];\n                                eta_p_77136 = ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77144))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77145) {\n                                int64_t lifted_lambda_res_77139 = add64(eta_p_77135, eta_p_77137);\n                                int64_t defunc_0_op_res_77140 = add64(eta_p_77136, eta_p_77138);\n                                \n                                eta_p_77135 = lifted_lambda_res_77139;\n                                eta_p_77136 = defunc_0_op_res_77140;\n                 ",
                                    "           }\n                        }\n                        if (sle32(wave_sizze_77078, skip_threads_77144)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77145) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77135;\n                                eta_p_77137 = eta_p_77135;\n                                ((volatile __local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77136;\n                                eta_p_77138 = eta_p_77136;\n                            }\n                        }\n                        if (sle32(wave_sizze_77078, skip_threads_77144)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77144 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77146 = squot32(local_tid_77076, 32) == 0 || !ltid_in_bounds_77141;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77146) {\n                        eta_p_77129 = eta_p_77127;\n                        eta_p_77130 = eta_p_77128;\n                        eta_p_77127 = ((__local int64_t *) local_mem_77085)[sext_i32_i64(squot32(local_tid_77076, 32)) - (int64_t) 1];\n                        eta_p_77128 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_77076, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77146) {\n                        int64_t lifted_lambda_res_77131 =", " add64(eta_p_77127, eta_p_77129);\n                        int64_t defunc_0_op_res_77132 = add64(eta_p_77128, eta_p_77130);\n                        \n                        eta_p_77127 = lifted_lambda_res_77131;\n                        eta_p_77128 = defunc_0_op_res_77132;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77146) {\n                        ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77127;\n                        ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77128;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_77076, 32) == 0 && ltid_in_bounds_77141) {\n                    ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = eta_p_77129;\n                    ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77130;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_77076 == 0) {\n                acc_77133 = ((__local int64_t *) local_mem_77085)[segscan_tblock_sizze_71198 - (int64_t) 1];\n                acc_77134 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (segscan_tblock_sizze_71198 - (int64_t) 1)];\n            } else {\n                acc_77133 = ((__local int64_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - (int64_t) 1];\n                acc_77134 = ((__local int64_t *) local_mem_77085)[squot64(byte_offsets_77081, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77147 = (int64_t) 0;\n        prefix_77148", " = (int64_t) 0;\n        block_new_sgm_77149 = sgm_idx_77100 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77149 && local_tid_77076 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098] = acc_77133;\n                ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098] = acc_77134;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 2;\n                acc_77133 = (int64_t) 0;\n                acc_77134 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77149 && slt32(local_tid_77076, wave_sizze_77078)) {\n                if (local_tid_77076 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_77065)[dynamic_id_77098] = acc_77133;\n                    ((volatile __global int64_t *) aggregates_mem_77069)[dynamic_id_77098] = acc_77134;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 1;\n                    \n                    int8_t tmp_77150 = ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_77085)[(int64_t) 0] = tmp_77150;\n                }\n                mem_fence_local();\n                \n                int8_t status_77151 = ((__local int8_t *) local_mem_77085)[(int64_t) 0];\n                \n                if (status_77151 == (int8_t) 2) {\n                    if (local_tid_77076 == 0) {\n                        prefix_77147 = ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098 - (int64_t) 1];\n                        prefix_77148 = ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77152 = sext_i64_i32(dynamic_id_7",
                                    "7098 - sext_i32_i64(wave_sizze_77078));\n                    \n                    while (slt32(wave_sizze_77078 * -1, readOffset_77152)) {\n                        int32_t read_i_77153 = readOffset_77152 + local_tid_77076;\n                        int64_t aggr_77154 = (int64_t) 0;\n                        int64_t aggr_77155 = (int64_t) 0;\n                        int8_t flag_77156 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77153)) {\n                            flag_77156 = ((volatile __global int8_t *) status_flags_mem_77063)[sext_i32_i64(read_i_77153)];\n                            if (flag_77156 == (int8_t) 2) {\n                                aggr_77154 = ((volatile __global int64_t *) incprefixes_mem_77067)[sext_i32_i64(read_i_77153)];\n                                aggr_77155 = ((volatile __global int64_t *) incprefixes_mem_77071)[sext_i32_i64(read_i_77153)];\n                            } else if (flag_77156 == (int8_t) 1) {\n                                aggr_77154 = ((volatile __global int64_t *) aggregates_mem_77065)[sext_i32_i64(read_i_77153)];\n                                aggr_77155 = ((volatile __global int64_t *) aggregates_mem_77069)[sext_i32_i64(read_i_77153)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)] = aggr_77154;\n                        ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = aggr_77155;\n                        ((__local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = flag_77156;\n                        flag_77156 = ((__local int8_t *) local_mem_77085)[sext_i32_i64(wave_sizze_77078) - (int64_t) 1];\n                        if (slt8(flag_77156, (int8_t) 2)) {\n                            int8_t flg_x_77163;\n                            int8_t flg_y_77164;\n                            int64_t eta_p_77157;\n    ", "                        int64_t eta_p_77158;\n                            int64_t eta_p_77159;\n                            int64_t eta_p_77160;\n                            int32_t skip_threads_77165;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77164 = ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)];\n                                eta_p_77159 = ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)];\n                                eta_p_77160 = ((volatile __local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)];\n                                if ((local_tid_77076 - squot32(local_tid_77076, 32) * 32) == 0) {\n                                    eta_p_77157 = eta_p_77159;\n                                    eta_p_77158 = eta_p_77160;\n                                    flg_x_77163 = flg_y_77164;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77165 = 1;\n                                while (slt32(skip_threads_77165, 32)) {\n                                    if (sle32(skip_threads_77165, local_tid_77076 - squot32(local_tid_77076, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77163 = ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165)];\n                                            eta_p_77157 = ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165))];\n                                            eta_p_77158 = ((volatile __local int64", "_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + (sext_i32_i64(local_tid_77076) - sext_i32_i64(skip_threads_77165))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77164 == (int8_t) 2 || flg_y_77164 == (int8_t) 0) {\n                                                flg_x_77163 = flg_y_77164;\n                                                eta_p_77157 = eta_p_77159;\n                                                eta_p_77158 = eta_p_77160;\n                                            } else {\n                                                int64_t lifted_lambda_res_77161 = add64(eta_p_77157, eta_p_77159);\n                                                int64_t defunc_0_op_res_77162 = add64(eta_p_77158, eta_p_77160);\n                                                \n                                                eta_p_77157 = lifted_lambda_res_77161;\n                                                eta_p_77158 = defunc_0_op_res_77162;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_77085)[sext_i32_i64(local_tid_77076)] = flg_x_77163;\n                                            flg_y_77164 = flg_x_77163;\n                                            ((volatile __local int64_t *) local_mem_77085)[(int64_t) 4 + sext_i32_i64(local_tid_77076)] = eta_p_77157;\n                                            eta_p_77159 = eta_p_77157;\n                                            ((volatile __local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + sext_i32_i64(local_tid_77076)] = eta_p_77158;\n                                            eta_p_77160 = eta_p_77158;\n             ",
                                    "                           }\n                                    }\n                                    skip_threads_77165 *= 2;\n                                }\n                            }\n                        }\n                        flag_77156 = ((__local int8_t *) local_mem_77085)[sext_i32_i64(wave_sizze_77078) - (int64_t) 1];\n                        aggr_77154 = ((__local int64_t *) local_mem_77085)[(int64_t) 4 + (sext_i32_i64(wave_sizze_77078) - (int64_t) 1)];\n                        aggr_77155 = ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8) + (sext_i32_i64(wave_sizze_77078) - (int64_t) 1)];\n                        if (flag_77156 == (int8_t) 2) {\n                            readOffset_77152 = wave_sizze_77078 * -1;\n                        } else if (flag_77156 == (int8_t) 1) {\n                            readOffset_77152 -= wave_sizze_77078;\n                        }\n                        if (slt8((int8_t) 0, flag_77156)) {\n                            int64_t eta_p_77166 = aggr_77154;\n                            int64_t eta_p_77167 = aggr_77155;\n                            int64_t eta_p_77168 = prefix_77147;\n                            int64_t eta_p_77169 = prefix_77148;\n                            int64_t lifted_lambda_res_77170 = add64(eta_p_77166, eta_p_77168);\n                            int64_t defunc_0_op_res_77171 = add64(eta_p_77167, eta_p_77169);\n                            \n                            prefix_77147 = lifted_lambda_res_77170;\n                            prefix_77148 = defunc_0_op_res_77171;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_77076 == 0) {\n                    if (boundary_77101 == sext_i64_i32(segscan_tblock_sizze_71198 * chunk_sizze_77060)) {\n                        int64_t eta_p_77172 = prefix_77147;\n                        int64_t eta_p_77173 = prefix_77148;\n                        int64", "_t eta_p_77174 = acc_77133;\n                        int64_t eta_p_77175 = acc_77134;\n                        int64_t lifted_lambda_res_77176 = add64(eta_p_77172, eta_p_77174);\n                        int64_t defunc_0_op_res_77177 = add64(eta_p_77173, eta_p_77175);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_77067)[dynamic_id_77098] = lifted_lambda_res_77176;\n                        ((volatile __global int64_t *) incprefixes_mem_77071)[dynamic_id_77098] = defunc_0_op_res_77177;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_77063)[dynamic_id_77098] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_77085)[(int64_t) 4] = prefix_77147;\n                    ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8)] = prefix_77148;\n                    acc_77133 = (int64_t) 0;\n                    acc_77134 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_77098 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77147 = ((__local int64_t *) local_mem_77085)[(int64_t) 4];\n                prefix_77148 = ((__local int64_t *) local_mem_77085)[squot64(warp_byte_offset_77083, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77178;\n            int64_t eta_p_77180;\n            int64_t eta_p_77184 = prefix_77147;\n            int64_t eta_p_77186 = acc_77133;\n            int64_t eta_p_77179;\n            int64_t eta_p_77181;\n            int64_t eta_p_77185 = prefix_77148;\n            int64_t eta_p_77187 = acc_77134;\n            \n            if (slt32(local_tid_77076 * chunk_sizze_32b_77080, boundary_77101) && !block_new_sgm_77149) {\n                int64_t lifted_lambda_res_77188 = add64(eta_p_77184, eta_p_77186);\n                int64_t defunc_0", "_op_res_77189 = add64(eta_p_77185, eta_p_77187);\n                \n                eta_p_77178 = lifted_lambda_res_77188;\n                eta_p_77179 = defunc_0_op_res_77189;\n            } else {\n                eta_p_77178 = acc_77133;\n                eta_p_77179 = acc_77134;\n            }\n            \n            int32_t stopping_point_77190 = segsizze_compact_77102 - srem32(local_tid_77076 * chunk_sizze_32b_77080 - 1 + segsizze_compact_77102 - boundary_77101, segsizze_compact_77102);\n            \n            for (int64_t i_77191 = 0; i_77191 < chunk_sizze_77060; i_77191++) {\n                if (slt32(sext_i64_i32(i_77191), stopping_point_77190 - 1)) {\n                    eta_p_77180 = private_mem_77103[i_77191];\n                    eta_p_77181 = private_mem_77105[i_77191];\n                    \n                    int64_t lifted_lambda_res_77182 = add64(eta_p_77178, eta_p_77180);\n                    int64_t defunc_0_op_res_77183 = add64(eta_p_77179, eta_p_77181);\n                    \n                    private_mem_77103[i_77191] = lifted_lambda_res_77182;\n                    private_mem_77105[i_77191] = defunc_0_op_res_77183;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77192 = 0; i_77192 < chunk_sizze_77060; i_77192++) {\n                int64_t sharedIdx_77193 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77192;\n                int64_t tmp_77194 = private_mem_77103[i_77192];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77193] = tmp_77194;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77195 = 0; i_77195 < chunk_sizze_77060; i_77195++) {\n                int64_t flat_idx_77196 = thd_offset_77107 + i_77195 * segscan_tblock_sizze_71198;\n                int64_t slice_77197 = m_65686;\n                int64_t gtid_71202 = flat_idx_77196;\n                int64_t remnant_7719",
                                    "8 = flat_idx_77196 - gtid_71202;\n                \n                if (slt64(flat_idx_77196, m_65686)) {\n                    int64_t tmp_77199 = ((__local int64_t *) local_mem_77085)[flat_idx_77196 - block_offset_77099];\n                    \n                    ((__global int64_t *) mem_75955)[gtid_71202] = tmp_77199;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77200 = 0; i_77200 < chunk_sizze_77060; i_77200++) {\n                int64_t sharedIdx_77201 = sext_i32_i64(local_tid_77076) * chunk_sizze_77060 + i_77200;\n                int64_t tmp_77202 = private_mem_77105[i_77200];\n                \n                ((__local int64_t *) local_mem_77085)[sharedIdx_77201] = tmp_77202;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77203 = 0; i_77203 < chunk_sizze_77060; i_77203++) {\n                int64_t flat_idx_77204 = thd_offset_77107 + i_77203 * segscan_tblock_sizze_71198;\n                int64_t slice_77205 = m_65686;\n                int64_t gtid_71202 = flat_idx_77204;\n                int64_t remnant_77206 = flat_idx_77204 - gtid_71202;\n                \n                if (slt64(flat_idx_77204, m_65686)) {\n                    int64_t tmp_77207 = ((__local int64_t *) local_mem_77085)[flat_idx_77204 - block_offset_77099];\n                    \n                    ((__global int64_t *) mem_75957)[gtid_71202] = tmp_77207;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_71198\n    #undef chunk_sizze_77060\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76566_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76566(__global int *global_failure, int64_t gt_rhs_64823, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75475)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76568;\n    int32_t tblock_sizze_76571;\n    int32_t wave_sizze_76570;\n    int32_t bloc", "k_id_76569;\n    int32_t global_tid_76567;\n    int64_t tid_76566;\n    int16_t x_75366;\n    \n    local_tid_76568 = get_local_id(0);\n    tblock_sizze_76571 = get_local_size(0);\n    wave_sizze_76570 = LOCKSTEP_WIDTH;\n    block_id_76569 = get_tblock_id(0);\n    global_tid_76567 = block_id_76569 * tblock_sizze_76571 + local_tid_76568;\n    tid_76566 = sext_i32_i64(global_tid_76567);\n    x_75366 = ((__global int16_t *) tR_mem_75467)[gt_rhs_64823];\n    ((__global int16_t *) mem_75475)[(int64_t) 0] = x_75366;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76598_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76598(__global int *global_failure, int64_t tS_start_64840, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75476, __global unsigned char *mem_75483, __global unsigned char *mem_75484)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76600;\n    int32_t tblock_sizze_76603;\n    int32_t wave_sizze_76602;\n    int32_t block_id_76601;\n    int32_t global_tid_76599;\n    int64_t tid_76598;\n    int16_t gt_lhs_75370;\n    int16_t gt_rhs_75372;\n    bool defunc_0_gt_res_75374;\n    \n    local_tid_76600 = get_local_id(0);\n    tblock_sizze_76603 = get_local_size(0);\n    wave_sizze_76602 = LOCKSTEP_WIDTH;\n    block_id_76601 = get_tblock_id(0);\n    global_tid_76599 = block_id_76601 * tblock_sizze_76603 + local_tid_76600;\n    tid_76598 = sext_i32_i64(global_tid_76599);\n    gt_lhs_75370 = ((__global int16_t *) tS_mem_75468)[tS_start_64840];\n    gt_rhs_75372 = ((__global int16_t *) ext_mem_75476)[(int64_t) 0];\n    defunc_0_gt_res_75374 = slt16(gt_rhs_75372, gt_lhs_75370);\n    ((__global int16_t *) mem_75483)[(int64_t) 0] = gt_lhs_75370;\n    ((__global bool *) mem_75484)[(int64_t) 0] = defunc_0_gt_res_75374;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76604_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76604(__global int *global_failure, int64_t i_p_m_t_s_64846, __global unsigned char *tS_mem_75468, __", "global unsigned char *mem_75750)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76606;\n    int32_t tblock_sizze_76609;\n    int32_t wave_sizze_76608;\n    int32_t block_id_76607;\n    int32_t global_tid_76605;\n    int64_t tid_76604;\n    int16_t x_75376;\n    \n    local_tid_76606 = get_local_id(0);\n    tblock_sizze_76609 = get_local_size(0);\n    wave_sizze_76608 = LOCKSTEP_WIDTH;\n    block_id_76607 = get_tblock_id(0);\n    global_tid_76605 = block_id_76607 * tblock_sizze_76609 + local_tid_76606;\n    tid_76604 = sext_i32_i64(global_tid_76605);\n    x_75376 = ((__global int16_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    ((__global int16_t *) mem_75750)[(int64_t) 0] = x_75376;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76620_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76620(__global int *global_failure, int64_t start_66400, int64_t i_p_m_t_s_66406, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75758, __global unsigned char *mem_75759)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76622;\n    int32_t tblock_sizze_76625;\n    int32_t wave_sizze_76624;\n    int32_t block_id_76623;\n    int32_t global_tid_76621;\n    int64_t tid_76620;\n    int16_t r_max_75380;\n    int16_t r_min_75383;\n    \n    local_tid_76622 = get_local_id(0);\n    tblock_sizze_76625 = get_local_size(0);\n    wave_sizze_76624 = LOCKSTEP_WIDTH;\n    block_id_76623 = get_tblock_id(0);\n    global_tid_76621 = block_id_76623 * tblock_sizze_76625 + local_tid_76622;\n    tid_76620 = sext_i32_i64(global_tid_76621);\n    r_max_75380 = ((__global int16_t *) tR_mem_75467)[i_p_m_t_s_66406];\n    r_min_75383 = ((__global int16_t *) tR_mem_75467)[start_66400];\n    ((__global int16_t *) mem_75758)[(int64_t) 0] = r_max_75380;\n    ((__global int16_t *) mem_75759)[(int64_t) 0] = r_min_75383;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76626_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76626(__global int *global_fa",
                                    "ilure, __global unsigned char *mem_75759, __global unsigned char *ext_mem_75760, __global unsigned char *mem_75762)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76628;\n    int32_t tblock_sizze_76631;\n    int32_t wave_sizze_76630;\n    int32_t block_id_76629;\n    int32_t global_tid_76627;\n    int64_t tid_76626;\n    int16_t s_max_75385;\n    int16_t r_min_75386;\n    bool defunc_0_gt_res_75387;\n    \n    local_tid_76628 = get_local_id(0);\n    tblock_sizze_76631 = get_local_size(0);\n    wave_sizze_76630 = LOCKSTEP_WIDTH;\n    block_id_76629 = get_tblock_id(0);\n    global_tid_76627 = block_id_76629 * tblock_sizze_76631 + local_tid_76628;\n    tid_76626 = sext_i32_i64(global_tid_76627);\n    s_max_75385 = ((__global int16_t *) ext_mem_75760)[(int64_t) 0];\n    r_min_75386 = ((__global int16_t *) mem_75759)[(int64_t) 0];\n    defunc_0_gt_res_75387 = slt16(s_max_75385, r_min_75386);\n    ((__global bool *) mem_75762)[(int64_t) 0] = defunc_0_gt_res_75387;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76632_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76632(__global int *global_failure, __global unsigned char *mem_75758, __global unsigned char *ext_mem_75761, __global unsigned char *mem_75763)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76634;\n    int32_t tblock_sizze_76637;\n    int32_t wave_sizze_76636;\n    int32_t block_id_76635;\n    int32_t global_tid_76633;\n    int64_t tid_76632;\n    int16_t r_max_75390;\n    int16_t s_min_75391;\n    bool defunc_0_gt_res_75392;\n    \n    local_tid_76634 = get_local_id(0);\n    tblock_sizze_76637 = get_local_size(0);\n    wave_sizze_76636 = LOCKSTEP_WIDTH;\n    block_id_76635 = get_tblock_id(0);\n    global_tid_76633 = block_id_76635 * tblock_sizze_76637 + local_tid_76634;\n    tid_76632 = sext_i32_i64(global_tid_76633);\n    r_max_75390 = ((__global int16_t *) mem_75758)[(int64_t) 0];\n    s_min_75391 = ((__global int16_t *) ext_mem_75761)[(int64_t) 0];\n    defunc_0_gt_re", "s_75392 = slt16(r_max_75390, s_min_75391);\n    ((__global bool *) mem_75763)[(int64_t) 0] = defunc_0_gt_res_75392;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76691_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76691(__global int *global_failure, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75490)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76693;\n    int32_t tblock_sizze_76696;\n    int32_t wave_sizze_76695;\n    int32_t block_id_76694;\n    int32_t global_tid_76692;\n    int64_t tid_76691;\n    int16_t x_75394;\n    \n    local_tid_76693 = get_local_id(0);\n    tblock_sizze_76696 = get_local_size(0);\n    wave_sizze_76695 = LOCKSTEP_WIDTH;\n    block_id_76694 = get_tblock_id(0);\n    global_tid_76692 = block_id_76694 * tblock_sizze_76696 + local_tid_76693;\n    tid_76691 = sext_i32_i64(global_tid_76692);\n    x_75394 = ((__global int16_t *) tR_mem_75467)[(int64_t) 0];\n    ((__global int16_t *) mem_75490)[(int64_t) 0] = x_75394;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76697_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76697(__global int *global_failure, __global unsigned char *mem_75483, __global unsigned char *ext_mem_75491, __global unsigned char *mem_75492)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76699;\n    int32_t tblock_sizze_76702;\n    int32_t wave_sizze_76701;\n    int32_t block_id_76700;\n    int32_t global_tid_76698;\n    int64_t tid_76697;\n    int16_t leq_lhs_75398;\n    int16_t gt_lhs_75399;\n    bool defunc_0_leq_res_75400;\n    \n    local_tid_76699 = get_local_id(0);\n    tblock_sizze_76702 = get_local_size(0);\n    wave_sizze_76701 = LOCKSTEP_WIDTH;\n    block_id_76700 = get_tblock_id(0);\n    global_tid_76698 = block_id_76700 * tblock_sizze_76702 + local_tid_76699;\n    tid_76697 = sext_i32_i64(global_tid_76698);\n    leq_lhs_75398 = ((__global int16_t *) ext_mem_75491)[(int64_t) 0];\n    gt_lhs_75399 = ((__global int16_t *) mem_75483", ")[(int64_t) 0];\n    defunc_0_leq_res_75400 = sle16(leq_lhs_75398, gt_lhs_75399);\n    ((__global bool *) mem_75492)[(int64_t) 0] = defunc_0_leq_res_75400;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76703_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76703(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_37190, unsigned char y_64988_bits, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75483, __global unsigned char *mem_75492, __global unsigned char *mem_75494)\n{\n    bool y_64988 = y_64988_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76705;\n    int32_t tblock_sizze_76708;\n    int32_t wave_sizze_76707;\n    int32_t block_id_76706;\n    int32_t global_tid_76704;\n    int64_t tid_76703;\n    bool defunc_0_leq_res_75402;\n    int16_t x_75407;\n    \n    local_tid_76705 = get_local_id(0);\n    tblock_sizze_76708 = get_local_size(0);\n    wave_sizze_76707 = LOCKSTEP_WIDTH;\n    block_id_76706 = get_tblock_id(0);\n    global_tid_76704 = block_id_76706 * tblock_sizze_76708 + local_tid_76705;\n    tid_76703 = sext_i32_i64(global_tid_76704);\n    defunc_0_leq_res_75402 = ((__global bool *) mem_75492)[(int64_t) 0];\n    if (defunc_0_leq_res_75402) {\n        bool index_certs_75403;\n        int16_t lowest_t_res_75404;\n        \n        if (!y_64988) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 138) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_37190;\n                    ;\n                }\n                return;\n            }\n        }\n        lowest_t_res_75404 = ((__global int16_t *) tR_mem_75467)[(int64_t) 0];\n        x_75407 = lowest_t_res_75404;\n    } else {\n        int16_t gt_lhs_75406;\n        bool index_certs_75405;\n        \n        gt_lhs_75406 = ((__global int16_t *) mem_75483)[(int64_t) 0];\n        if (!y_64988) {\n       ",
                                    "     {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 139) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) nR_37190;\n                    ;\n                }\n                return;\n            }\n        }\n        x_75407 = gt_lhs_75406;\n    }\n    ((__global int16_t *) mem_75494)[(int64_t) 0] = x_75407;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76765_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76765(__global int *global_failure, int64_t slice_65911, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75542)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76767;\n    int32_t tblock_sizze_76770;\n    int32_t wave_sizze_76769;\n    int32_t block_id_76768;\n    int32_t global_tid_76766;\n    int64_t tid_76765;\n    int16_t x_75412;\n    \n    local_tid_76767 = get_local_id(0);\n    tblock_sizze_76770 = get_local_size(0);\n    wave_sizze_76769 = LOCKSTEP_WIDTH;\n    block_id_76768 = get_tblock_id(0);\n    global_tid_76766 = block_id_76768 * tblock_sizze_76770 + local_tid_76767;\n    tid_76765 = sext_i32_i64(global_tid_76766);\n    x_75412 = ((__global int16_t *) tS_mem_75468)[slice_65911];\n    ((__global int16_t *) mem_75542)[(int64_t) 0] = x_75412;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76771_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76771(__global int *global_failure, int64_t slice_66709, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75545)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76773;\n    int32_t tblock_sizze_76776;\n    int32_t wave_sizze_76775;\n    int32_t block_id_76774;\n    int32_t global_tid_76772;\n    int64_t tid_76771;\n    int16_t x_75416;\n    \n    local_tid_76773 = get_local_id(0);\n    tblock_sizze_76776 = get_local_size(0);\n    wave_sizze_76775 = LOCKSTEP_WIDTH;\n    block_id_76774 = get_tblock_id(0);\n    global_tid", "_76772 = block_id_76774 * tblock_sizze_76776 + local_tid_76773;\n    tid_76771 = sext_i32_i64(global_tid_76772);\n    x_75416 = ((__global int16_t *) tS_mem_75468)[slice_66709];\n    ((__global int16_t *) mem_75545)[(int64_t) 0] = x_75416;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76787_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76787(__global int *global_failure, int64_t slice_65554, int64_t slice_65563, __global unsigned char *tR_mem_75467, __global unsigned char *mem_75553, __global unsigned char *mem_75554)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76789;\n    int32_t tblock_sizze_76792;\n    int32_t wave_sizze_76791;\n    int32_t block_id_76790;\n    int32_t global_tid_76788;\n    int64_t tid_76787;\n    int16_t r_max_75420;\n    int16_t r_min_75423;\n    \n    local_tid_76789 = get_local_id(0);\n    tblock_sizze_76792 = get_local_size(0);\n    wave_sizze_76791 = LOCKSTEP_WIDTH;\n    block_id_76790 = get_tblock_id(0);\n    global_tid_76788 = block_id_76790 * tblock_sizze_76792 + local_tid_76789;\n    tid_76787 = sext_i32_i64(global_tid_76788);\n    r_max_75420 = ((__global int16_t *) tR_mem_75467)[slice_65563];\n    r_min_75423 = ((__global int16_t *) tR_mem_75467)[slice_65554];\n    ((__global int16_t *) mem_75553)[(int64_t) 0] = r_max_75420;\n    ((__global int16_t *) mem_75554)[(int64_t) 0] = r_min_75423;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76793_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76793(__global int *global_failure, __global unsigned char *mem_75554, __global unsigned char *ext_mem_75555, __global unsigned char *mem_75557)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76795;\n    int32_t tblock_sizze_76798;\n    int32_t wave_sizze_76797;\n    int32_t block_id_76796;\n    int32_t global_tid_76794;\n    int64_t tid_76793;\n    int16_t s_max_75425;\n    int16_t r_min_75426;\n    bool defunc_0_gt_res_75427;\n    \n    local_tid_76795 = get_local_id(0);\n    ", "tblock_sizze_76798 = get_local_size(0);\n    wave_sizze_76797 = LOCKSTEP_WIDTH;\n    block_id_76796 = get_tblock_id(0);\n    global_tid_76794 = block_id_76796 * tblock_sizze_76798 + local_tid_76795;\n    tid_76793 = sext_i32_i64(global_tid_76794);\n    s_max_75425 = ((__global int16_t *) ext_mem_75555)[(int64_t) 0];\n    r_min_75426 = ((__global int16_t *) mem_75554)[(int64_t) 0];\n    defunc_0_gt_res_75427 = slt16(s_max_75425, r_min_75426);\n    ((__global bool *) mem_75557)[(int64_t) 0] = defunc_0_gt_res_75427;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76799_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76799(__global int *global_failure, __global unsigned char *mem_75553, __global unsigned char *ext_mem_75556, __global unsigned char *mem_75558)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76801;\n    int32_t tblock_sizze_76804;\n    int32_t wave_sizze_76803;\n    int32_t block_id_76802;\n    int32_t global_tid_76800;\n    int64_t tid_76799;\n    int16_t r_max_75430;\n    int16_t s_min_75431;\n    bool defunc_0_gt_res_75432;\n    \n    local_tid_76801 = get_local_id(0);\n    tblock_sizze_76804 = get_local_size(0);\n    wave_sizze_76803 = LOCKSTEP_WIDTH;\n    block_id_76802 = get_tblock_id(0);\n    global_tid_76800 = block_id_76802 * tblock_sizze_76804 + local_tid_76801;\n    tid_76799 = sext_i32_i64(global_tid_76800);\n    r_max_75430 = ((__global int16_t *) mem_75553)[(int64_t) 0];\n    s_min_75431 = ((__global int16_t *) ext_mem_75556)[(int64_t) 0];\n    defunc_0_gt_res_75432 = slt16(r_max_75430, s_min_75431);\n    ((__global bool *) mem_75558)[(int64_t) 0] = defunc_0_gt_res_75432;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_76912_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_76912(__global int *global_failure, int64_t gt_rhs_64823, int64_t i_p_m_t_s_64846, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75926)\n{\n    if (*global_failure >= 0)\n        ",
                                    "return;\n    \n    int32_t local_tid_76914;\n    int32_t tblock_sizze_76917;\n    int32_t wave_sizze_76916;\n    int32_t block_id_76915;\n    int32_t global_tid_76913;\n    int64_t tid_76912;\n    int16_t leq_lhs_75434;\n    int16_t leq_rhs_75436;\n    bool defunc_0_leq_res_75440;\n    \n    local_tid_76914 = get_local_id(0);\n    tblock_sizze_76917 = get_local_size(0);\n    wave_sizze_76916 = LOCKSTEP_WIDTH;\n    block_id_76915 = get_tblock_id(0);\n    global_tid_76913 = block_id_76915 * tblock_sizze_76917 + local_tid_76914;\n    tid_76912 = sext_i32_i64(global_tid_76913);\n    leq_lhs_75434 = ((__global int16_t *) tS_mem_75468)[i_p_m_t_s_64846];\n    leq_rhs_75436 = ((__global int16_t *) tR_mem_75467)[gt_rhs_64823];\n    defunc_0_leq_res_75440 = sle16(leq_lhs_75434, leq_rhs_75436);\n    ((__global bool *) mem_75926)[(int64_t) 0] = defunc_0_leq_res_75440;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_77237_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_77237(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75962, __global unsigned char *mem_75964)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77239;\n    int32_t tblock_sizze_77242;\n    int32_t wave_sizze_77241;\n    int32_t block_id_77240;\n    int32_t global_tid_77238;\n    int64_t tid_77237;\n    int64_t x_75442;\n    \n    local_tid_77239 = get_local_id(0);\n    tblock_sizze_77242 = get_local_size(0);\n    wave_sizze_77241 = LOCKSTEP_WIDTH;\n    block_id_77240 = get_tblock_id(0);\n    global_tid_77238 = block_id_77240 * tblock_sizze_77242 + local_tid_77239;\n    tid_77237 = sext_i32_i64(global_tid_77238);\n    x_75442 = ((__global int64_t *) mem_75962)[m_65696];\n    ((__global int64_t *) mem_75964)[(int64_t) 0] = x_75442;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_77243_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_77243(__global int *global_failure, int64_t m_65696, __global unsigned char *mem_75945, __global unsigned char *mem_75967)\n{\n    ", "if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77245;\n    int32_t tblock_sizze_77248;\n    int32_t wave_sizze_77247;\n    int32_t block_id_77246;\n    int32_t global_tid_77244;\n    int64_t tid_77243;\n    int64_t x_75446;\n    \n    local_tid_77245 = get_local_id(0);\n    tblock_sizze_77248 = get_local_size(0);\n    wave_sizze_77247 = LOCKSTEP_WIDTH;\n    block_id_77246 = get_tblock_id(0);\n    global_tid_77244 = block_id_77246 * tblock_sizze_77248 + local_tid_77245;\n    tid_77243 = sext_i32_i64(global_tid_77244);\n    x_75446 = ((__global int64_t *) mem_75945)[m_65696];\n    ((__global int64_t *) mem_75967)[(int64_t) 0] = x_75446;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_77249_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_77249(__global int *global_failure, __global unsigned char *ext_mem_75965, __global unsigned char *ext_mem_75968, __global unsigned char *mem_75974)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77251;\n    int32_t tblock_sizze_77254;\n    int32_t wave_sizze_77253;\n    int32_t block_id_77252;\n    int32_t global_tid_77250;\n    int64_t tid_77249;\n    int64_t zp_lhs_75450;\n    int64_t n_pairs_t_res_75451;\n    int64_t n_pairs_t_res_75452;\n    \n    local_tid_77251 = get_local_id(0);\n    tblock_sizze_77254 = get_local_size(0);\n    wave_sizze_77253 = LOCKSTEP_WIDTH;\n    block_id_77252 = get_tblock_id(0);\n    global_tid_77250 = block_id_77252 * tblock_sizze_77254 + local_tid_77251;\n    tid_77249 = sext_i32_i64(global_tid_77250);\n    zp_lhs_75450 = ((__global int64_t *) ext_mem_75965)[(int64_t) 0];\n    n_pairs_t_res_75451 = ((__global int64_t *) ext_mem_75968)[(int64_t) 0];\n    n_pairs_t_res_75452 = add64(zp_lhs_75450, n_pairs_t_res_75451);\n    ((__global int64_t *) mem_75974)[(int64_t) 0] = n_pairs_t_res_75452;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzigpuseq_77296_dim1, 1, 1)\nvoid inner_SMJ_shortzigpuseq_77296(__global int *global_failure, int64_t loopres_65870, _", "_global unsigned char *mem_param_76008, __global unsigned char *mem_param_76011, __global unsigned char *mem_param_76014, __global unsigned char *mem_76021, __global unsigned char *mem_76022, __global unsigned char *mem_76023)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77298;\n    int32_t tblock_sizze_77301;\n    int32_t wave_sizze_77300;\n    int32_t block_id_77299;\n    int32_t global_tid_77297;\n    int64_t tid_77296;\n    int16_t loopres_75454;\n    int64_t loopres_75456;\n    int64_t loopres_75458;\n    \n    local_tid_77298 = get_local_id(0);\n    tblock_sizze_77301 = get_local_size(0);\n    wave_sizze_77300 = LOCKSTEP_WIDTH;\n    block_id_77299 = get_tblock_id(0);\n    global_tid_77297 = block_id_77299 * tblock_sizze_77301 + local_tid_77298;\n    tid_77296 = sext_i32_i64(global_tid_77297);\n    loopres_75454 = ((__global int16_t *) mem_param_76008)[loopres_65870];\n    loopres_75456 = ((__global int64_t *) mem_param_76011)[loopres_65870];\n    loopres_75458 = ((__global int64_t *) mem_param_76014)[loopres_65870];\n    ((__global int16_t *) mem_76021)[(int64_t) 0] = loopres_75454;\n    ((__global int64_t *) mem_76022)[(int64_t) 0] = loopres_75456;\n    ((__global int64_t *) mem_76023)[(int64_t) 0] = loopres_75458;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_shortzireplicate_77303(int64_t loopres_65871, int64_t replicate_n_77302, int64_t virt_num_tblocks_77308, int64_t num_tblocks_77309, __global unsigned char *mem_76021, __global unsigned char *mem_76025)\n{\n    int32_t replicate_ltid_77304;\n    int32_t tblock_sizze_77306;\n    int32_t replicate_gid_77305;\n    int32_t replicate_gtid_77303;\n    int32_t phys_tblock_id_77310;\n    int32_t iterations_77311;\n    \n    replicate_ltid_77304 = get_local_id(0);\n    tblock_sizze_77306 = get_local_size(0);\n    replicate_gid_77305 = get_tblock_id(0);\n    replicate_gtid_77303 = replicate_gid_77305 * tblock_sizze_77306 + replicate_ltid_77304;\n    phys_tblock_id_77310 = get_tblock_id(0);\n    iterations",
                                    "_77311 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77308) - phys_tblock_id_77310, sext_i64_i32(num_tblocks_77309));\n    for (int32_t i_77312 = 0; i_77312 < iterations_77311; i_77312++) {\n        int32_t virt_tblock_id_77313;\n        int64_t global_tid_77314;\n        int64_t slice_77317;\n        int64_t slice_77318;\n        int64_t rep_i_77315;\n        int64_t remnant_77319;\n        int64_t rep_i_77316;\n        int64_t remnant_77320;\n        \n        virt_tblock_id_77313 = phys_tblock_id_77310 + i_77312 * sext_i64_i32(num_tblocks_77309);\n        global_tid_77314 = sext_i32_i64(virt_tblock_id_77313) * sext_i32_i64(tblock_sizze_77306) + sext_i32_i64(replicate_ltid_77304);\n        slice_77317 = (int64_t) 1;\n        slice_77318 = loopres_65871 * slice_77317;\n        rep_i_77315 = squot64(global_tid_77314, slice_77317);\n        remnant_77319 = global_tid_77314 - rep_i_77315 * slice_77317;\n        rep_i_77316 = remnant_77319;\n        remnant_77320 = remnant_77319 - rep_i_77316;\n        if (slt64(global_tid_77314, replicate_n_77302)) {\n            int16_t tmp_77321 = ((__global int16_t *) mem_76021)[rep_i_77316];\n            \n            ((__global int16_t *) mem_76025)[rep_i_77315 + rep_i_77316] = tmp_77321;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid inner_SMJ_shortzireplicate_77323(int64_t loopres_65871, int64_t replicate_n_77322, int64_t virt_num_tblocks_77328, int64_t num_tblocks_77329, __global unsigned char *mem_76022, __global unsigned char *mem_76027)\n{\n    int32_t replicate_ltid_77324;\n    int32_t tblock_sizze_77326;\n    int32_t replicate_gid_77325;\n    int32_t replicate_gtid_77323;\n    int32_t phys_tblock_id_77330;\n    int32_t iterations_77331;\n    \n    replicate_ltid_77324 = get_local_id(0);\n    tblock_sizze_77326 = get_local_size(0);\n    replicate_gid_77325 = get_tblock_id(0);\n    replicate_gtid_77323 = replicate_gid_77325 * tblock_sizze_77326 + replicate_ltid_77324;\n    phys_tbloc", "k_id_77330 = get_tblock_id(0);\n    iterations_77331 = sdiv_up32(sext_i64_i32(virt_num_tblocks_77328) - phys_tblock_id_77330, sext_i64_i32(num_tblocks_77329));\n    for (int32_t i_77332 = 0; i_77332 < iterations_77331; i_77332++) {\n        int32_t virt_tblock_id_77333;\n        int64_t global_tid_77334;\n        int64_t slice_77337;\n        int64_t slice_77338;\n        int64_t rep_i_77335;\n        int64_t remnant_77339;\n        int64_t rep_i_77336;\n        int64_t remnant_77340;\n        \n        virt_tblock_id_77333 = phys_tblock_id_77330 + i_77332 * sext_i64_i32(num_tblocks_77329);\n        global_tid_77334 = sext_i32_i64(virt_tblock_id_77333) * sext_i32_i64(tblock_sizze_77326) + sext_i32_i64(replicate_ltid_77324);\n        slice_77337 = (int64_t) 1;\n        slice_77338 = loopres_65871 * slice_77337;\n        rep_i_77335 = squot64(global_tid_77334, slice_77337);\n        remnant_77339 = global_tid_77334 - rep_i_77335 * slice_77337;\n        rep_i_77336 = remnant_77339;\n        remnant_77340 = remnant_77339 - rep_i_77336;\n        if (slt64(global_tid_77334, replicate_n_77322)) {\n            int64_t tmp_77341 = ((__global int64_t *) mem_76022)[rep_i_77336];\n            \n            ((__global int64_t *) mem_76027)[rep_i_77335 + rep_i_77336] = tmp_77341;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_67725_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_67725(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_37190, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t max_res_65013, int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, int64_t zt_rhs_65019, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75495, __global unsigned char *mem_75504, __global unsigned char *mem_75506)\n{\n    #define segm", "ap_tblock_sizze_67720 (inner_SMJ_shortzisegmap_67725zisegmap_tblock_sizze_67720)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76715;\n    int32_t tblock_sizze_76718;\n    int32_t wave_sizze_76717;\n    int32_t block_id_76716;\n    int32_t global_tid_76714;\n    int64_t phys_tid_67725;\n    int64_t global_tid_76719;\n    int64_t slice_76720;\n    int64_t gtid_67724;\n    int64_t remnant_76721;\n    \n    local_tid_76715 = get_local_id(0);\n    tblock_sizze_76718 = get_local_size(0);\n    wave_sizze_76717 = LOCKSTEP_WIDTH;\n    block_id_76716 = get_tblock_id(0);\n    global_tid_76714 = block_id_76716 * tblock_sizze_76718 + local_tid_76715;\n    phys_tid_67725 = sext_i32_i64(global_tid_76714);\n    global_tid_76719 = sext_i32_i64(block_id_76716) * segmap_tblock_sizze_67720 + sext_i32_i64(local_tid_76715);\n    slice_76720 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;\n    gtid_67724 = global_tid_76719;\n    remnant_76721 = global_tid_76719 - gtid_67724;\n    if (slt64(gtid_67724, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014)) {\n        int16_t lowest_75411;\n        int64_t index_primexp_73897;\n        int64_t zs_lhs_67727;\n        int64_t index_67728;\n        bool cond_67729;\n        int64_t loop_over_67730;\n        int64_t loop_over_67731;\n        int64_t loop_over_67733;\n        bool defunc_0_f_res_67736;\n        int64_t defunc_0_f_res_67737;\n        int64_t defunc_0_f_res_67738;\n        int64_t defunc_0_f_res_67739;\n        bool loop_while_67740;\n        int64_t p_67741;\n        int64_t p_67742;\n        int64_t p_67743;\n        \n        lowest_75411 = ((__global int16_t *) ext_mem_75495)[(int64_t) 0];\n        index_primexp_73897 = add64(max_res_65013, gtid_67724);\n        zs_lhs_67727 = mul64(zt_rhs_65019, index_primexp_73897);\n        index_67728 = sdiv64(zs_lhs_67727, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n        cond_67729 = slt64(nR_37190, index_67728);\n        if (cond_67729) {\n            l",
                                    "oop_over_67730 = nR_37190;\n        } else {\n            loop_over_67730 = index_67728;\n        }\n        if (cond_67729) {\n            int64_t loop_over_t_res_67732 = sub64(index_67728, nR_37190);\n            \n            loop_over_67731 = loop_over_t_res_67732;\n        } else {\n            loop_over_67731 = (int64_t) 0;\n        }\n        if (cond_67729) {\n            int64_t zm_lhs_67734;\n            int64_t loop_over_t_res_67735;\n            \n            zm_lhs_67734 = sub64(index_67728, nR_37190);\n            loop_over_t_res_67735 = sub64(zm_lhs_67734, (int64_t) 1);\n            loop_over_67733 = loop_over_t_res_67735;\n        } else {\n            loop_over_67733 = (int64_t) 0;\n        }\n        loop_while_67740 = 1;\n        p_67741 = loop_over_67733;\n        p_67742 = loop_over_67730;\n        p_67743 = loop_over_67731;\n        while (loop_while_67740) {\n            int64_t zs_lhs_67744;\n            int64_t offset_67745;\n            int64_t ai_67746;\n            int64_t max_arg1_67747;\n            int64_t max_res_67748;\n            bool cond_67749;\n            int16_t b_prev_67750;\n            bool cond_67758;\n            int64_t loopres_67759;\n            int64_t loopres_67760;\n            int64_t loopres_67761;\n            bool loopres_67762;\n            bool loop_while_tmp_76722;\n            int64_t p_tmp_76723;\n            int64_t p_tmp_76724;\n            int64_t p_tmp_76725;\n            \n            zs_lhs_67744 = sub64(p_67742, p_67741);\n            offset_67745 = sdiv64(zs_lhs_67744, (int64_t) 2);\n            ai_67746 = sub64(p_67742, offset_67745);\n            max_arg1_67747 = add64(p_67743, offset_67745);\n            max_res_67748 = smax64((int64_t) 0, max_arg1_67747);\n            cond_67749 = slt64((int64_t) 0, max_res_67748);\n            if (cond_67749) {\n                int64_t tmp_67751;\n                bool x_67752;\n                bool y_67753;\n                bool bounds_check_67754;\n                bool index_certs_67755;\n                int64_t s", "lice_67756;\n                int16_t b_prev_t_res_67757;\n                \n                tmp_67751 = sub64(max_res_67748, (int64_t) 1);\n                x_67752 = sle64((int64_t) 0, tmp_67751);\n                y_67753 = slt64(tmp_67751, nR_37190);\n                bounds_check_67754 = x_67752 && y_67753;\n                if (!bounds_check_67754) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 140) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_67751;\n                            global_failure_args[1] = (int64_t) nR_37190;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                slice_67756 = tS_start_64840 + tmp_67751;\n                b_prev_t_res_67757 = ((__global int16_t *) tS_mem_75468)[slice_67756];\n                b_prev_67750 = b_prev_t_res_67757;\n            } else {\n                b_prev_67750 = lowest_75411;\n            }\n            cond_67758 = sle64(ai_67746, (int64_t) 0);\n            if (cond_67758) {\n                loopres_67759 = p_67741;\n                loopres_67760 = (int64_t) 0;\n                loopres_67761 = max_res_67748;\n                loopres_67762 = 0;\n            } else {\n                bool cond_67763;\n                int64_t loopres_f_res_67764;\n                int64_t loopres_f_res_67765;\n                int64_t loopres_f_res_67766;\n                bool loopres_f_res_67767;\n                \n                cond_67763 = sle64(nR_37190, max_res_67748);\n                if (cond_67763) {\n                    int64_t min_arg1_67768;\n                    int64_t min_res_67769;\n                    bool x_67770;\n                    bool y_67771;\n                    bool bounds_check_67772;\n                    bool index_certs_67773;\n                    bool x_67776;\n                    bool y_67777;\n                    bool bounds_check_67778;\n                    bool index_certs_67", "779;\n                    int64_t slice_67774;\n                    int16_t leq_lhs_67775;\n                    int16_t leq_rhs_67780;\n                    bool defunc_0_leq_res_67781;\n                    int64_t loopres_f_res_t_res_67782;\n                    bool x_67783;\n                    int64_t loopres_f_res_t_res_67784;\n                    \n                    min_arg1_67768 = sub64(nR_37190, (int64_t) 1);\n                    min_res_67769 = smin64(ai_67746, min_arg1_67768);\n                    x_67770 = sle64((int64_t) 0, min_arg1_67768);\n                    y_67771 = slt64(min_arg1_67768, nR_37190);\n                    bounds_check_67772 = x_67770 && y_67771;\n                    if (!bounds_check_67772) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 141) == -1) {\n                                global_failure_args[0] = (int64_t) min_arg1_67768;\n                                global_failure_args[1] = (int64_t) nR_37190;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    x_67776 = sle64((int64_t) 0, min_res_67769);\n                    y_67777 = slt64(min_res_67769, nR_37190);\n                    bounds_check_67778 = x_67776 && y_67777;\n                    if (!bounds_check_67778) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 142) == -1) {\n                                global_failure_args[0] = (int64_t) min_res_67769;\n                                global_failure_args[1] = (int64_t) nR_37190;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    slice_67774 = tS_start_64840 + min_arg1_67768;\n                    leq_lhs_67775 = ((__global int16_t *) tS_mem_75468)[slice_67774];\n                    leq_rhs_67780 = ((__g",
                                    "lobal int16_t *) tR_mem_75467)[min_res_67769];\n                    defunc_0_leq_res_67781 = sle16(leq_lhs_67775, leq_rhs_67780);\n                    if (defunc_0_leq_res_67781) {\n                        loopres_f_res_t_res_67782 = ai_67746;\n                    } else {\n                        loopres_f_res_t_res_67782 = p_67742;\n                    }\n                    x_67783 = !defunc_0_leq_res_67781;\n                    if (defunc_0_leq_res_67781) {\n                        loopres_f_res_t_res_67784 = nR_37190;\n                    } else {\n                        int64_t tmp_67785 = sub64(min_arg1_67768, offset_67745);\n                        \n                        loopres_f_res_t_res_67784 = tmp_67785;\n                    }\n                    loopres_f_res_67764 = p_67741;\n                    loopres_f_res_67765 = loopres_f_res_t_res_67782;\n                    loopres_f_res_67766 = loopres_f_res_t_res_67784;\n                    loopres_f_res_67767 = x_67783;\n                } else {\n                    bool cond_67786;\n                    int64_t loopres_f_res_f_res_67787;\n                    int64_t loopres_f_res_f_res_67788;\n                    int64_t loopres_f_res_f_res_67789;\n                    bool loopres_f_res_f_res_67790;\n                    \n                    cond_67786 = sle64(nR_37190, ai_67746);\n                    if (cond_67786) {\n                        int64_t min_arg1_67791;\n                        int64_t min_res_67792;\n                        bool x_67793;\n                        bool y_67794;\n                        bool bounds_check_67795;\n                        bool index_certs_67796;\n                        bool x_67798;\n                        bool y_67799;\n                        bool bounds_check_67800;\n                        bool index_certs_67801;\n                        int16_t leq_lhs_67797;\n                        int64_t slice_67802;\n                        int16_t leq_rhs_67803;\n                        bool defunc_0_leq_", "res_67804;\n                        int64_t loopres_f_res_f_res_t_res_67805;\n                        bool x_67806;\n                        int64_t loopres_f_res_f_res_t_res_67807;\n                        \n                        min_arg1_67791 = sub64(nR_37190, (int64_t) 1);\n                        min_res_67792 = smin64(max_res_67748, min_arg1_67791);\n                        x_67793 = sle64((int64_t) 0, min_arg1_67791);\n                        y_67794 = slt64(min_arg1_67791, nR_37190);\n                        bounds_check_67795 = x_67793 && y_67794;\n                        if (!bounds_check_67795) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 143) == -1) {\n                                    global_failure_args[0] = (int64_t) min_arg1_67791;\n                                    global_failure_args[1] = (int64_t) nR_37190;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_67798 = sle64((int64_t) 0, min_res_67792);\n                        y_67799 = slt64(min_res_67792, nR_37190);\n                        bounds_check_67800 = x_67798 && y_67799;\n                        if (!bounds_check_67800) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 144) == -1) {\n                                    global_failure_args[0] = (int64_t) min_res_67792;\n                                    global_failure_args[1] = (int64_t) nR_37190;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        leq_lhs_67797 = ((__global int16_t *) tR_mem_75467)[min_arg1_67791];\n                        slice_67802 = tS_start_64840 + min_res_67792;\n                        leq_rhs_67803 = ((__global int16", "_t *) tS_mem_75468)[slice_67802];\n                        defunc_0_leq_res_67804 = sle16(leq_lhs_67797, leq_rhs_67803);\n                        if (defunc_0_leq_res_67804) {\n                            loopres_f_res_f_res_t_res_67805 = max_res_67748;\n                        } else {\n                            loopres_f_res_f_res_t_res_67805 = p_67743;\n                        }\n                        x_67806 = !defunc_0_leq_res_67804;\n                        if (defunc_0_leq_res_67804) {\n                            loopres_f_res_f_res_t_res_67807 = nR_37190;\n                        } else {\n                            loopres_f_res_f_res_t_res_67807 = min_arg1_67791;\n                        }\n                        loopres_f_res_f_res_67787 = p_67741;\n                        loopres_f_res_f_res_67788 = loopres_f_res_f_res_t_res_67807;\n                        loopres_f_res_f_res_67789 = loopres_f_res_f_res_t_res_67805;\n                        loopres_f_res_f_res_67790 = x_67806;\n                    } else {\n                        bool cond_67808;\n                        int64_t loopres_f_res_f_res_f_res_67809;\n                        int64_t loopres_f_res_f_res_f_res_67810;\n                        int64_t loopres_f_res_f_res_f_res_67811;\n                        bool loopres_f_res_f_res_f_res_67812;\n                        \n                        cond_67808 = sle64(p_67742, p_67741);\n                        if (cond_67808) {\n                            bool cond_67813;\n                            int64_t ai_67814;\n                            bool x_67827;\n                            bool y_67828;\n                            bool bounds_check_67829;\n                            bool index_certs_67830;\n                            int16_t b_prev_67816;\n                            int16_t gt_lhs_67831;\n                            bool defunc_0_gt_res_67832;\n                            int64_t defunc_0_partFunc_sequential_search_res_67833;\n                            in",
                                    "t64_t defunc_0_partFunc_sequential_search_res_67834;\n                            \n                            cond_67813 = slt64(ai_67746, nR_37190);\n                            if (cond_67813) {\n                                ai_67814 = ai_67746;\n                            } else {\n                                int64_t ai_f_res_67815 = sub64(nR_37190, (int64_t) 1);\n                                \n                                ai_67814 = ai_f_res_67815;\n                            }\n                            x_67827 = sle64((int64_t) 0, ai_67814);\n                            y_67828 = slt64(ai_67814, nR_37190);\n                            bounds_check_67829 = x_67827 && y_67828;\n                            if (!bounds_check_67829) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 145) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_67814;\n                                        global_failure_args[1] = (int64_t) nR_37190;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            if (cond_67749) {\n                                int64_t tmp_67817;\n                                bool x_67818;\n                                bool y_67819;\n                                bool bounds_check_67820;\n                                bool index_certs_67821;\n                                int64_t slice_67822;\n                                int16_t b_prev_t_res_67823;\n                                \n                                tmp_67817 = sub64(max_res_67748, (int64_t) 1);\n                                x_67818 = sle64((int64_t) 0, tmp_67817);\n                                y_67819 = slt64(tmp_67817, nR_37190);\n                                bounds_check_67820 = x_67818 && y_67819;\n             ", "                   if (!bounds_check_67820) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 146) == -1) {\n                                            global_failure_args[0] = (int64_t) tmp_67817;\n                                            global_failure_args[1] = (int64_t) nR_37190;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                slice_67822 = tS_start_64840 + tmp_67817;\n                                b_prev_t_res_67823 = ((__global int16_t *) tS_mem_75468)[slice_67822];\n                                b_prev_67816 = b_prev_t_res_67823;\n                            } else {\n                                bool y_67824;\n                                bool index_certs_67825;\n                                int16_t b_prev_f_res_67826;\n                                \n                                y_67824 = slt64((int64_t) 0, nR_37190);\n                                if (!y_67824) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 147) == -1) {\n                                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                                            global_failure_args[1] = (int64_t) nR_37190;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                b_prev_f_res_67826 = ((__global int16_t *) tS_mem_75468)[tS_start_64840];\n                                b_prev_67816 = b_prev_f_res_67826;\n                            }\n                            gt_lhs_67831 = ((__global int16_t *) tR_mem_75467)[ai_67814];\n     ", "                       defunc_0_gt_res_67832 = slt16(b_prev_67816, gt_lhs_67831);\n                            if (defunc_0_gt_res_67832) {\n                                int64_t zl_rhs_67835;\n                                bool loop_cond_67836;\n                                bool defunc_0_partFunc_sequential_search_res_t_res_67837;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_67838;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_67839;\n                                int64_t defunc_0_partFunc_sequential_search_res_t_res_67840;\n                                bool loop_while_67841;\n                                int64_t p_67842;\n                                int64_t p_67843;\n                                int64_t p_67844;\n                                \n                                zl_rhs_67835 = sub64(nR_37190, max_res_67748);\n                                loop_cond_67836 = slt64((int64_t) 0, zl_rhs_67835);\n                                loop_while_67841 = loop_cond_67836;\n                                p_67842 = ai_67814;\n                                p_67843 = max_res_67748;\n                                p_67844 = (int64_t) 0;\n                                while (loop_while_67841) {\n                                    int64_t i_a_67845;\n                                    int64_t i_b_67846;\n                                    int64_t leq_lhs_67847;\n                                    bool x_67848;\n                                    bool y_67849;\n                                    bool bounds_check_67850;\n                                    bool index_certs_67851;\n                                    bool x_67853;\n                                    bool y_67854;\n                                    bool bounds_check_67855;\n                                    bool index_certs_67856;\n                                    int16_t leq_lhs_67852;\n                         ",
                                    "           int64_t slice_67857;\n                                    int16_t leq_rhs_67858;\n                                    bool defunc_0_leq_res_67859;\n                                    int64_t loopres_67860;\n                                    int64_t loopres_67861;\n                                    int64_t loopres_67862;\n                                    bool loop_cond_67864;\n                                    bool loop_while_tmp_76726;\n                                    int64_t p_tmp_76727;\n                                    int64_t p_tmp_76728;\n                                    int64_t p_tmp_76729;\n                                    \n                                    i_a_67845 = sub64(ai_67814, p_67844);\n                                    i_b_67846 = add64(max_res_67748, p_67844);\n                                    leq_lhs_67847 = sub64(i_a_67845, (int64_t) 1);\n                                    x_67848 = sle64((int64_t) 0, leq_lhs_67847);\n                                    y_67849 = slt64(leq_lhs_67847, nR_37190);\n                                    bounds_check_67850 = x_67848 && y_67849;\n                                    if (!bounds_check_67850) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 148) == -1) {\n                                                global_failure_args[0] = (int64_t) leq_lhs_67847;\n                                                global_failure_args[1] = (int64_t) nR_37190;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_67853 = sle64((int64_t) 0, i_b_67846);\n                                    y_67854 = slt64(i_b_67846, nR_37190);\n                                    bounds_check_67855 = x_67853 && y_67854;\n      ", "                              if (!bounds_check_67855) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 149) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_67846;\n                                                global_failure_args[1] = (int64_t) nR_37190;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    leq_lhs_67852 = ((__global int16_t *) tR_mem_75467)[leq_lhs_67847];\n                                    slice_67857 = tS_start_64840 + i_b_67846;\n                                    leq_rhs_67858 = ((__global int16_t *) tS_mem_75468)[slice_67857];\n                                    defunc_0_leq_res_67859 = sle16(leq_lhs_67852, leq_rhs_67858);\n                                    if (defunc_0_leq_res_67859) {\n                                        loopres_67860 = i_a_67845;\n                                    } else {\n                                        loopres_67860 = ai_67814;\n                                    }\n                                    if (defunc_0_leq_res_67859) {\n                                        loopres_67861 = i_b_67846;\n                                    } else {\n                                        loopres_67861 = max_res_67748;\n                                    }\n                                    if (defunc_0_leq_res_67859) {\n                                        loopres_67862 = zl_rhs_67835;\n                                    } else {\n                                        int64_t tmp_67863 = add64((int64_t) 1, p_67844);\n                                        \n                                        loopres_67862 = tmp_67863;\n                                    }\n           ", "                         loop_cond_67864 = slt64(loopres_67862, zl_rhs_67835);\n                                    loop_while_tmp_76726 = loop_cond_67864;\n                                    p_tmp_76727 = loopres_67860;\n                                    p_tmp_76728 = loopres_67861;\n                                    p_tmp_76729 = loopres_67862;\n                                    loop_while_67841 = loop_while_tmp_76726;\n                                    p_67842 = p_tmp_76727;\n                                    p_67843 = p_tmp_76728;\n                                    p_67844 = p_tmp_76729;\n                                }\n                                defunc_0_partFunc_sequential_search_res_t_res_67837 = loop_while_67841;\n                                defunc_0_partFunc_sequential_search_res_t_res_67838 = p_67842;\n                                defunc_0_partFunc_sequential_search_res_t_res_67839 = p_67843;\n                                defunc_0_partFunc_sequential_search_res_t_res_67840 = p_67844;\n                                defunc_0_partFunc_sequential_search_res_67833 = defunc_0_partFunc_sequential_search_res_t_res_67838;\n                                defunc_0_partFunc_sequential_search_res_67834 = defunc_0_partFunc_sequential_search_res_t_res_67839;\n                            } else {\n                                int64_t zl_rhs_67865;\n                                bool loop_cond_67866;\n                                bool defunc_0_partFunc_sequential_search_res_f_res_67867;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_67868;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_67869;\n                                int64_t defunc_0_partFunc_sequential_search_res_f_res_67870;\n                                bool loop_while_67871;\n                                int64_t p_67872;\n                                int64_t p_67873;\n                                int64_t ",
                                    "p_67874;\n                                \n                                zl_rhs_67865 = sub64(max_res_67748, (int64_t) 1);\n                                loop_cond_67866 = slt64((int64_t) 0, zl_rhs_67865);\n                                loop_while_67871 = loop_cond_67866;\n                                p_67872 = ai_67814;\n                                p_67873 = max_res_67748;\n                                p_67874 = (int64_t) 0;\n                                while (loop_while_67871) {\n                                    int64_t zp_lhs_67875;\n                                    int64_t hi_a_67876;\n                                    bool cond_67877;\n                                    int64_t i_a_67878;\n                                    int64_t zm_lhs_67880;\n                                    int64_t i_b_67881;\n                                    bool x_67882;\n                                    bool y_67883;\n                                    bool bounds_check_67884;\n                                    bool index_certs_67885;\n                                    bool x_67887;\n                                    bool y_67888;\n                                    bool bounds_check_67889;\n                                    bool index_certs_67890;\n                                    int16_t gt_lhs_67886;\n                                    int64_t slice_67891;\n                                    int16_t gt_rhs_67892;\n                                    bool defunc_0_gt_res_67893;\n                                    int64_t loopres_67894;\n                                    int64_t loopres_67895;\n                                    int64_t loopres_67896;\n                                    bool loop_cond_67898;\n                                    bool loop_while_tmp_76730;\n                                    int64_t p_tmp_76731;\n                                    int64_t p_tmp_76732;\n                                    int64_t p_tmp_76733;\n                  ", "                  \n                                    zp_lhs_67875 = add64(ai_67814, p_67874);\n                                    hi_a_67876 = add64((int64_t) 1, zp_lhs_67875);\n                                    cond_67877 = slt64(hi_a_67876, nR_37190);\n                                    if (cond_67877) {\n                                        i_a_67878 = hi_a_67876;\n                                    } else {\n                                        int64_t i_a_f_res_67879 = sub64(nR_37190, (int64_t) 1);\n                                        \n                                        i_a_67878 = i_a_f_res_67879;\n                                    }\n                                    zm_lhs_67880 = sub64(max_res_67748, p_67874);\n                                    i_b_67881 = sub64(zm_lhs_67880, (int64_t) 1);\n                                    x_67882 = sle64((int64_t) 0, i_a_67878);\n                                    y_67883 = slt64(i_a_67878, nR_37190);\n                                    bounds_check_67884 = x_67882 && y_67883;\n                                    if (!bounds_check_67884) {\n                                        {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 150) == -1) {\n                                                global_failure_args[0] = (int64_t) i_a_67878;\n                                                global_failure_args[1] = (int64_t) nR_37190;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    x_67887 = sle64((int64_t) 0, i_b_67881);\n                                    y_67888 = slt64(i_b_67881, nR_37190);\n                                    bounds_check_67889 = x_67887 && y_67888;\n                                    if (!bounds_check_67889) {\n                         ", "               {\n                                            if (atomic_cmpxchg_i32_global(global_failure, -1, 151) == -1) {\n                                                global_failure_args[0] = (int64_t) i_b_67881;\n                                                global_failure_args[1] = (int64_t) nR_37190;\n                                                ;\n                                            }\n                                            return;\n                                        }\n                                    }\n                                    gt_lhs_67886 = ((__global int16_t *) tR_mem_75467)[i_a_67878];\n                                    slice_67891 = tS_start_64840 + i_b_67881;\n                                    gt_rhs_67892 = ((__global int16_t *) tS_mem_75468)[slice_67891];\n                                    defunc_0_gt_res_67893 = slt16(gt_rhs_67892, gt_lhs_67886);\n                                    if (defunc_0_gt_res_67893) {\n                                        loopres_67894 = i_a_67878;\n                                    } else {\n                                        loopres_67894 = ai_67814;\n                                    }\n                                    if (defunc_0_gt_res_67893) {\n                                        loopres_67895 = zm_lhs_67880;\n                                    } else {\n                                        loopres_67895 = max_res_67748;\n                                    }\n                                    if (defunc_0_gt_res_67893) {\n                                        loopres_67896 = zl_rhs_67865;\n                                    } else {\n                                        int64_t tmp_67897 = add64((int64_t) 1, p_67874);\n                                        \n                                        loopres_67896 = tmp_67897;\n                                    }\n                                    loop_cond_67898 = slt64(loopres_67896, zl_rhs_67865);\n            ",
                                    "                        loop_while_tmp_76730 = loop_cond_67898;\n                                    p_tmp_76731 = loopres_67894;\n                                    p_tmp_76732 = loopres_67895;\n                                    p_tmp_76733 = loopres_67896;\n                                    loop_while_67871 = loop_while_tmp_76730;\n                                    p_67872 = p_tmp_76731;\n                                    p_67873 = p_tmp_76732;\n                                    p_67874 = p_tmp_76733;\n                                }\n                                defunc_0_partFunc_sequential_search_res_f_res_67867 = loop_while_67871;\n                                defunc_0_partFunc_sequential_search_res_f_res_67868 = p_67872;\n                                defunc_0_partFunc_sequential_search_res_f_res_67869 = p_67873;\n                                defunc_0_partFunc_sequential_search_res_f_res_67870 = p_67874;\n                                defunc_0_partFunc_sequential_search_res_67833 = defunc_0_partFunc_sequential_search_res_f_res_67868;\n                                defunc_0_partFunc_sequential_search_res_67834 = defunc_0_partFunc_sequential_search_res_f_res_67869;\n                            }\n                            loopres_f_res_f_res_f_res_67809 = p_67741;\n                            loopres_f_res_f_res_f_res_67810 = defunc_0_partFunc_sequential_search_res_67833;\n                            loopres_f_res_f_res_f_res_67811 = defunc_0_partFunc_sequential_search_res_67834;\n                            loopres_f_res_f_res_f_res_67812 = 0;\n                        } else {\n                            bool x_67899;\n                            bool y_67900;\n                            bool bounds_check_67901;\n                            bool index_certs_67902;\n                            int16_t gt_lhs_67903;\n                            bool defunc_0_gt_res_67904;\n                            int64_t loopres_f_res_f_res_f_res_f_res_67905;\n           ", "                 int64_t loopres_f_res_f_res_f_res_f_res_67906;\n                            int64_t loopres_f_res_f_res_f_res_f_res_67907;\n                            bool loopres_f_res_f_res_f_res_f_res_67908;\n                            \n                            x_67899 = sle64((int64_t) 0, ai_67746);\n                            y_67900 = slt64(ai_67746, nR_37190);\n                            bounds_check_67901 = x_67899 && y_67900;\n                            if (!bounds_check_67901) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 152) == -1) {\n                                        global_failure_args[0] = (int64_t) ai_67746;\n                                        global_failure_args[1] = (int64_t) nR_37190;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            gt_lhs_67903 = ((__global int16_t *) tR_mem_75467)[ai_67746];\n                            defunc_0_gt_res_67904 = slt16(b_prev_67750, gt_lhs_67903);\n                            if (defunc_0_gt_res_67904) {\n                                int64_t leq_lhs_67909;\n                                bool x_67910;\n                                bool y_67911;\n                                bool bounds_check_67912;\n                                bool index_certs_67913;\n                                bool x_67915;\n                                bool y_67916;\n                                bool bounds_check_67917;\n                                bool index_certs_67918;\n                                int16_t leq_lhs_67914;\n                                int64_t slice_67919;\n                                int16_t leq_rhs_67920;\n                                bool defunc_0_leq_res_67921;\n                                bool x_67922;\n                                int64_t lo", "opres_f_res_f_res_f_res_f_res_t_res_67923;\n                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_67924;\n                                \n                                leq_lhs_67909 = sub64(ai_67746, (int64_t) 1);\n                                x_67910 = sle64((int64_t) 0, leq_lhs_67909);\n                                y_67911 = slt64(leq_lhs_67909, nR_37190);\n                                bounds_check_67912 = x_67910 && y_67911;\n                                if (!bounds_check_67912) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 153) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_lhs_67909;\n                                            global_failure_args[1] = (int64_t) nR_37190;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                x_67915 = sle64((int64_t) 0, max_res_67748);\n                                y_67916 = slt64(max_res_67748, nR_37190);\n                                bounds_check_67917 = x_67915 && y_67916;\n                                if (!bounds_check_67917) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 154) == -1) {\n                                            global_failure_args[0] = (int64_t) max_res_67748;\n                                            global_failure_args[1] = (int64_t) nR_37190;\n                                            ;\n                                        }\n                                        return;\n                                    }\n                                }\n                                leq_lhs_67914 = ((__global int16_t *) tR_mem_75467)[leq_lhs_67909];\n                             ",
                                    "   slice_67919 = tS_start_64840 + max_res_67748;\n                                leq_rhs_67920 = ((__global int16_t *) tS_mem_75468)[slice_67919];\n                                defunc_0_leq_res_67921 = sle16(leq_lhs_67914, leq_rhs_67920);\n                                x_67922 = !defunc_0_leq_res_67921;\n                                if (defunc_0_leq_res_67921) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_67923 = ai_67746;\n                                } else {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_67923 = leq_lhs_67909;\n                                }\n                                if (defunc_0_leq_res_67921) {\n                                    loopres_f_res_f_res_f_res_f_res_t_res_67924 = max_res_67748;\n                                } else {\n                                    int64_t tmp_67925 = add64((int64_t) 1, max_res_67748);\n                                    \n                                    loopres_f_res_f_res_f_res_f_res_t_res_67924 = tmp_67925;\n                                }\n                                loopres_f_res_f_res_f_res_f_res_67905 = p_67741;\n                                loopres_f_res_f_res_f_res_f_res_67906 = loopres_f_res_f_res_f_res_f_res_t_res_67923;\n                                loopres_f_res_f_res_f_res_f_res_67907 = loopres_f_res_f_res_f_res_f_res_t_res_67924;\n                                loopres_f_res_f_res_f_res_f_res_67908 = x_67922;\n                            } else {\n                                int64_t tmp_67926 = add64((int64_t) 1, ai_67746);\n                                \n                                loopres_f_res_f_res_f_res_f_res_67905 = tmp_67926;\n                                loopres_f_res_f_res_f_res_f_res_67906 = p_67742;\n                                loopres_f_res_f_res_f_res_f_res_67907 = p_67743;\n                                loopres_f_res_f_res_f_res_f_res_67908 = 1;\n                            }\n             ", "               loopres_f_res_f_res_f_res_67809 = loopres_f_res_f_res_f_res_f_res_67905;\n                            loopres_f_res_f_res_f_res_67810 = loopres_f_res_f_res_f_res_f_res_67906;\n                            loopres_f_res_f_res_f_res_67811 = loopres_f_res_f_res_f_res_f_res_67907;\n                            loopres_f_res_f_res_f_res_67812 = loopres_f_res_f_res_f_res_f_res_67908;\n                        }\n                        loopres_f_res_f_res_67787 = loopres_f_res_f_res_f_res_67809;\n                        loopres_f_res_f_res_67788 = loopres_f_res_f_res_f_res_67810;\n                        loopres_f_res_f_res_67789 = loopres_f_res_f_res_f_res_67811;\n                        loopres_f_res_f_res_67790 = loopres_f_res_f_res_f_res_67812;\n                    }\n                    loopres_f_res_67764 = loopres_f_res_f_res_67787;\n                    loopres_f_res_67765 = loopres_f_res_f_res_67788;\n                    loopres_f_res_67766 = loopres_f_res_f_res_67789;\n                    loopres_f_res_67767 = loopres_f_res_f_res_67790;\n                }\n                loopres_67759 = loopres_f_res_67764;\n                loopres_67760 = loopres_f_res_67765;\n                loopres_67761 = loopres_f_res_67766;\n                loopres_67762 = loopres_f_res_67767;\n            }\n            loop_while_tmp_76722 = loopres_67762;\n            p_tmp_76723 = loopres_67759;\n            p_tmp_76724 = loopres_67760;\n            p_tmp_76725 = loopres_67761;\n            loop_while_67740 = loop_while_tmp_76722;\n            p_67741 = p_tmp_76723;\n            p_67742 = p_tmp_76724;\n            p_67743 = p_tmp_76725;\n        }\n        defunc_0_f_res_67736 = loop_while_67740;\n        defunc_0_f_res_67737 = p_67741;\n        defunc_0_f_res_67738 = p_67742;\n        defunc_0_f_res_67739 = p_67743;\n        ((__global int64_t *) mem_75504)[gtid_67724] = defunc_0_f_res_67738;\n        ((__global int64_t *) mem_75506)[gtid_67724] = defunc_0_f_res_67739;\n    }\n    \n  error_0:\n    return;\n   ", " #undef segmap_tblock_sizze_67720\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68099_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68099(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t nR_37190, int64_t gt_rhs_64823, int64_t tS_start_64840, int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, int64_t zeze_rhs_65256, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *mem_75486, __global unsigned char *mem_75488, __global unsigned char *mem_75522, __global unsigned char *mem_75524)\n{\n    #define segmap_tblock_sizze_68094 (inner_SMJ_shortzisegmap_68099zisegmap_tblock_sizze_68094)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76738;\n    int32_t tblock_sizze_76741;\n    int32_t wave_sizze_76740;\n    int32_t block_id_76739;\n    int32_t global_tid_76737;\n    int64_t phys_tid_68099;\n    int64_t global_tid_76742;\n    int64_t slice_76743;\n    int64_t gtid_68098;\n    int64_t remnant_76744;\n    \n    local_tid_76738 = get_local_id(0);\n    tblock_sizze_76741 = get_local_size(0);\n    wave_sizze_76740 = LOCKSTEP_WIDTH;\n    block_id_76739 = get_tblock_id(0);\n    global_tid_76737 = block_id_76739 * tblock_sizze_76741 + local_tid_76738;\n    phys_tid_68099 = sext_i32_i64(global_tid_76737);\n    global_tid_76742 = sext_i32_i64(block_id_76739) * segmap_tblock_sizze_68094 + sext_i32_i64(local_tid_76738);\n    slice_76743 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n    gtid_68098 = global_tid_76742;\n    remnant_76744 = global_tid_76742 - gtid_68098;\n    if (slt64(gtid_68098, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982)) {\n        int64_t eta_p_68101;\n        int64_t min_res_68102;\n        bool x_68103;\n        bool y_68104;\n        bool bounds_check_68105;\n        bool index_certs_68106;\n        bool cond_68108;\n        int64_t ri_next_68109;\n        int64_t max_arg1_68116;\n        int64_t max",
                                    "_res_68117;\n        bool x_68118;\n        bool y_68119;\n        bool bounds_check_68120;\n        bool index_certs_68121;\n        int16_t r_min_68107;\n        int16_t r_max_68122;\n        bool defunc_0_f_res_68123;\n        int64_t defunc_0_f_res_68124;\n        bool loop_while_68125;\n        int64_t fm_68126;\n        bool defunc_0_f_res_68192;\n        int64_t defunc_0_f_res_68193;\n        bool loop_while_68194;\n        int64_t lm_68195;\n        \n        eta_p_68101 = ((__global int64_t *) mem_75486)[gtid_68098];\n        min_res_68102 = smin64(gt_rhs_64823, eta_p_68101);\n        x_68103 = sle64((int64_t) 0, min_res_68102);\n        y_68104 = slt64(min_res_68102, nR_37190);\n        bounds_check_68105 = x_68103 && y_68104;\n        if (!bounds_check_68105) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 155) == -1) {\n                    global_failure_args[0] = (int64_t) min_res_68102;\n                    global_failure_args[1] = (int64_t) nR_37190;\n                    ;\n                }\n                return;\n            }\n        }\n        cond_68108 = gtid_68098 == zeze_rhs_65256;\n        if (cond_68108) {\n            ri_next_68109 = nR_37190;\n        } else {\n            int64_t tmp_68110;\n            bool x_68111;\n            bool y_68112;\n            bool bounds_check_68113;\n            bool index_certs_68114;\n            int64_t ri_next_f_res_68115;\n            \n            tmp_68110 = add64((int64_t) 1, gtid_68098);\n            x_68111 = sle64((int64_t) 0, tmp_68110);\n            y_68112 = slt64(tmp_68110, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_68113 = x_68111 && y_68112;\n            if (!bounds_check_68113) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 156) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_68110;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz2", "0UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            ri_next_f_res_68115 = ((__global int64_t *) mem_75486)[tmp_68110];\n            ri_next_68109 = ri_next_f_res_68115;\n        }\n        max_arg1_68116 = sub64(ri_next_68109, (int64_t) 1);\n        max_res_68117 = smax64((int64_t) 0, max_arg1_68116);\n        x_68118 = sle64((int64_t) 0, max_res_68117);\n        y_68119 = slt64(max_res_68117, nR_37190);\n        bounds_check_68120 = x_68118 && y_68119;\n        if (!bounds_check_68120) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 157) == -1) {\n                    global_failure_args[0] = (int64_t) max_res_68117;\n                    global_failure_args[1] = (int64_t) nR_37190;\n                    ;\n                }\n                return;\n            }\n        }\n        r_min_68107 = ((__global int16_t *) tR_mem_75467)[min_res_68102];\n        r_max_68122 = ((__global int16_t *) tR_mem_75467)[max_res_68117];\n        loop_while_68125 = 1;\n        fm_68126 = gtid_68098;\n        while (loop_while_68125) {\n            bool x_68127;\n            bool y_68128;\n            bool bounds_check_68129;\n            bool index_certs_68130;\n            int64_t loopres_68131;\n            int64_t min_res_68132;\n            bool x_68133;\n            bool y_68134;\n            bool bounds_check_68135;\n            bool index_certs_68136;\n            bool cond_68139;\n            int64_t si_next_68140;\n            int64_t max_arg1_68147;\n            int64_t max_res_68148;\n            bool x_68149;\n            bool y_68150;\n            bool bounds_check_68151;\n            bool index_certs_68152;\n            int64_t min_res_68155;\n            bool x_68156;\n            bool y_68157;\n            bool bounds_check_68158;\n            bool index_certs_68159;\n            int64_t max_arg1_68162;\n            int64_t max_res_68163;\n            bool x_68164;\n            bool ", "y_68165;\n            bool bounds_check_68166;\n            bool index_certs_68167;\n            int64_t slice_68137;\n            int16_t s_min_68138;\n            int64_t slice_68153;\n            int64_t slice_68160;\n            int64_t slice_68168;\n            bool defunc_0_gt_res_68170;\n            bool loopres_68171;\n            int64_t loopres_68172;\n            bool loop_while_tmp_76745;\n            int64_t fm_tmp_76746;\n            \n            x_68127 = sle64((int64_t) 0, fm_68126);\n            y_68128 = slt64(fm_68126, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_68129 = x_68127 && y_68128;\n            if (!bounds_check_68129) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 158) == -1) {\n                        global_failure_args[0] = (int64_t) fm_68126;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_68131 = ((__global int64_t *) mem_75488)[fm_68126];\n            min_res_68132 = smin64(gt_rhs_64823, loopres_68131);\n            x_68133 = sle64((int64_t) 0, min_res_68132);\n            y_68134 = slt64(min_res_68132, nR_37190);\n            bounds_check_68135 = x_68133 && y_68134;\n            if (!bounds_check_68135) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 159) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_68132;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_68139 = sle64(zeze_rhs_65256, fm_68126);\n            if (cond_68139) {\n                si_next_68140 = nR_37190;\n            } else {\n                int64_t tmp_68141;\n                bool x",
                                    "_68142;\n                bool y_68143;\n                bool bounds_check_68144;\n                bool index_certs_68145;\n                int64_t si_next_f_res_68146;\n                \n                tmp_68141 = add64((int64_t) 1, fm_68126);\n                x_68142 = sle64((int64_t) 0, tmp_68141);\n                y_68143 = slt64(tmp_68141, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n                bounds_check_68144 = x_68142 && y_68143;\n                if (!bounds_check_68144) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 160) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_68141;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_68146 = ((__global int64_t *) mem_75488)[tmp_68141];\n                si_next_68140 = si_next_f_res_68146;\n            }\n            max_arg1_68147 = sub64(si_next_68140, (int64_t) 1);\n            max_res_68148 = smax64(min_res_68132, max_arg1_68147);\n            x_68149 = sle64((int64_t) 0, max_res_68148);\n            y_68150 = slt64(max_res_68148, nR_37190);\n            bounds_check_68151 = x_68149 && y_68150;\n            if (!bounds_check_68151) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 161) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_68148;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_68155 = smin64(zeze_rhs_65256, si_next_68140);\n            x_68156 = sle64((int64_t) 0, min_res_68155);\n            y_68157 = slt64(min_res_68155, nR_37190);\n            bounds_check_68158 =", " x_68156 && y_68157;\n            if (!bounds_check_68158) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 162) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_68155;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            max_arg1_68162 = sub64(min_res_68132, (int64_t) 1);\n            max_res_68163 = smax64((int64_t) 0, max_arg1_68162);\n            x_68164 = sle64((int64_t) 0, max_res_68163);\n            y_68165 = slt64(max_res_68163, nR_37190);\n            bounds_check_68166 = x_68164 && y_68165;\n            if (!bounds_check_68166) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 163) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_68163;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_68137 = tS_start_64840 + min_res_68132;\n            s_min_68138 = ((__global int16_t *) tS_mem_75468)[slice_68137];\n            slice_68153 = tS_start_64840 + max_res_68148;\n            slice_68160 = tS_start_64840 + min_res_68155;\n            slice_68168 = tS_start_64840 + max_res_68163;\n            defunc_0_gt_res_68170 = slt16(s_min_68138, r_min_68107);\n            if (defunc_0_gt_res_68170) {\n                int16_t s_max_68154;\n                bool defunc_0_leq_res_68173;\n                bool loopres_t_res_68174;\n                int64_t loopres_t_res_68175;\n                \n                s_max_68154 = ((__global int16_t *) tS_mem_75468)[slice_68153];\n                defunc_0_leq_res_68173 = sle16(r_min_68107, s_max_68154);\n                if (defunc_0_leq_res_68173) {\n                    loopres_t_res_68174 = 0;\n                    loopres_t_res_68175 = fm_68126;\n ", "               } else {\n                    int16_t s_nextMin_68161;\n                    bool defunc_0_leq_res_68176;\n                    int64_t zgze_lhs_68177;\n                    bool tmp_f_res_68178;\n                    bool x_68179;\n                    bool y_68180;\n                    bool tmp_68181;\n                    bool loopres_t_res_f_res_68182;\n                    \n                    s_nextMin_68161 = ((__global int16_t *) tS_mem_75468)[slice_68160];\n                    defunc_0_leq_res_68176 = sle16(r_min_68107, s_nextMin_68161);\n                    zgze_lhs_68177 = add64((int64_t) 1, fm_68126);\n                    tmp_f_res_68178 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zgze_lhs_68177);\n                    x_68179 = !defunc_0_leq_res_68176;\n                    y_68180 = tmp_f_res_68178 && x_68179;\n                    tmp_68181 = defunc_0_leq_res_68176 || y_68180;\n                    loopres_t_res_f_res_68182 = !tmp_68181;\n                    loopres_t_res_68174 = loopres_t_res_f_res_68182;\n                    loopres_t_res_68175 = zgze_lhs_68177;\n                }\n                loopres_68171 = loopres_t_res_68174;\n                loopres_68172 = loopres_t_res_68175;\n            } else {\n                int16_t s_prevMax_68169;\n                bool defunc_0_leq_res_68183;\n                int64_t zlze_lhs_68184;\n                bool tmp_f_res_68185;\n                bool x_68186;\n                bool y_68187;\n                bool tmp_68188;\n                int64_t max_res_68189;\n                bool loopres_f_res_68190;\n                \n                s_prevMax_68169 = ((__global int16_t *) tS_mem_75468)[slice_68168];\n                defunc_0_leq_res_68183 = sle16(s_prevMax_68169, r_min_68107);\n                zlze_lhs_68184 = sub64(fm_68126, (int64_t) 1);\n                tmp_f_res_68185 = sle64(zlze_lhs_68184, (int64_t) 0);\n                x_68186 = !defunc_0_leq_res_68183;\n                y_68187 = tmp_f_res_6818",
                                    "5 && x_68186;\n                tmp_68188 = defunc_0_leq_res_68183 || y_68187;\n                max_res_68189 = smax64((int64_t) 0, zlze_lhs_68184);\n                loopres_f_res_68190 = !tmp_68188;\n                loopres_68171 = loopres_f_res_68190;\n                loopres_68172 = max_res_68189;\n            }\n            loop_while_tmp_76745 = loopres_68171;\n            fm_tmp_76746 = loopres_68172;\n            loop_while_68125 = loop_while_tmp_76745;\n            fm_68126 = fm_tmp_76746;\n        }\n        defunc_0_f_res_68123 = loop_while_68125;\n        defunc_0_f_res_68124 = fm_68126;\n        loop_while_68194 = 1;\n        lm_68195 = gtid_68098;\n        while (loop_while_68194) {\n            bool x_68196;\n            bool y_68197;\n            bool bounds_check_68198;\n            bool index_certs_68199;\n            int64_t loopres_68200;\n            int64_t min_res_68201;\n            bool x_68202;\n            bool y_68203;\n            bool bounds_check_68204;\n            bool index_certs_68205;\n            bool cond_68208;\n            int64_t si_next_68209;\n            int64_t max_arg1_68216;\n            int64_t max_res_68217;\n            bool x_68218;\n            bool y_68219;\n            bool bounds_check_68220;\n            bool index_certs_68221;\n            int64_t min_res_68224;\n            bool x_68225;\n            bool y_68226;\n            bool bounds_check_68227;\n            bool index_certs_68228;\n            int64_t max_arg1_68231;\n            int64_t max_res_68232;\n            bool x_68233;\n            bool y_68234;\n            bool bounds_check_68235;\n            bool index_certs_68236;\n            int64_t slice_68206;\n            int64_t slice_68222;\n            int16_t s_max_68223;\n            int64_t slice_68229;\n            int64_t slice_68237;\n            bool defunc_0_gt_res_68239;\n            bool loopres_68240;\n            int64_t loopres_68241;\n            bool loop_cond_t_res_68256;\n            bool x_68257;\n            bool loop_while_tmp_76747;", "\n            int64_t lm_tmp_76748;\n            \n            x_68196 = sle64((int64_t) 0, lm_68195);\n            y_68197 = slt64(lm_68195, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            bounds_check_68198 = x_68196 && y_68197;\n            if (!bounds_check_68198) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 164) == -1) {\n                        global_failure_args[0] = (int64_t) lm_68195;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                        ;\n                    }\n                    return;\n                }\n            }\n            loopres_68200 = ((__global int64_t *) mem_75488)[lm_68195];\n            min_res_68201 = smin64(gt_rhs_64823, loopres_68200);\n            x_68202 = sle64((int64_t) 0, min_res_68201);\n            y_68203 = slt64(min_res_68201, nR_37190);\n            bounds_check_68204 = x_68202 && y_68203;\n            if (!bounds_check_68204) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 165) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_68201;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cond_68208 = sle64(zeze_rhs_65256, lm_68195);\n            if (cond_68208) {\n                si_next_68209 = nR_37190;\n            } else {\n                int64_t tmp_68210;\n                bool x_68211;\n                bool y_68212;\n                bool bounds_check_68213;\n                bool index_certs_68214;\n                int64_t si_next_f_res_68215;\n                \n                tmp_68210 = add64((int64_t) 1, lm_68195);\n                x_68211 = sle64((int64_t) 0, tmp_68210);\n                y_68212 = slt64(tmp_68210, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindo", "wsz7dUzg_64982);\n                bounds_check_68213 = x_68211 && y_68212;\n                if (!bounds_check_68213) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 166) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_68210;\n                            global_failure_args[1] = (int64_t) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                si_next_f_res_68215 = ((__global int64_t *) mem_75488)[tmp_68210];\n                si_next_68209 = si_next_f_res_68215;\n            }\n            max_arg1_68216 = sub64(si_next_68209, (int64_t) 1);\n            max_res_68217 = smax64(min_res_68201, max_arg1_68216);\n            x_68218 = sle64((int64_t) 0, max_res_68217);\n            y_68219 = slt64(max_res_68217, nR_37190);\n            bounds_check_68220 = x_68218 && y_68219;\n            if (!bounds_check_68220) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 167) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_68217;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            min_res_68224 = smin64(zeze_rhs_65256, si_next_68209);\n            x_68225 = sle64((int64_t) 0, min_res_68224);\n            y_68226 = slt64(min_res_68224, nR_37190);\n            bounds_check_68227 = x_68225 && y_68226;\n            if (!bounds_check_68227) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 168) == -1) {\n                        global_failure_args[0] = (int64_t) min_res_68224;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n           ",
                                    "     }\n            }\n            max_arg1_68231 = sub64(min_res_68201, (int64_t) 1);\n            max_res_68232 = smax64((int64_t) 0, max_arg1_68231);\n            x_68233 = sle64((int64_t) 0, max_res_68232);\n            y_68234 = slt64(max_res_68232, nR_37190);\n            bounds_check_68235 = x_68233 && y_68234;\n            if (!bounds_check_68235) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 169) == -1) {\n                        global_failure_args[0] = (int64_t) max_res_68232;\n                        global_failure_args[1] = (int64_t) nR_37190;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_68206 = tS_start_64840 + min_res_68201;\n            slice_68222 = tS_start_64840 + max_res_68217;\n            s_max_68223 = ((__global int16_t *) tS_mem_75468)[slice_68222];\n            slice_68229 = tS_start_64840 + min_res_68224;\n            slice_68237 = tS_start_64840 + max_res_68232;\n            defunc_0_gt_res_68239 = slt16(r_max_68122, s_max_68223);\n            if (defunc_0_gt_res_68239) {\n                int16_t s_min_68207;\n                bool defunc_0_leq_res_68242;\n                bool loopres_t_res_68243;\n                int64_t loopres_t_res_68244;\n                \n                s_min_68207 = ((__global int16_t *) tS_mem_75468)[slice_68206];\n                defunc_0_leq_res_68242 = sle16(s_min_68207, r_max_68122);\n                if (defunc_0_leq_res_68242) {\n                    loopres_t_res_68243 = 0;\n                    loopres_t_res_68244 = lm_68195;\n                } else {\n                    int16_t s_prevMax_68238;\n                    bool defunc_0_leq_res_68245;\n                    int64_t zlze_lhs_68246;\n                    bool tmp_f_res_68247;\n                    bool x_68248;\n                    bool y_68249;\n                    bool tmp_68250;\n                    int64_t max_res_68251;\n                    bool loopres_t_res_f_", "res_68252;\n                    \n                    s_prevMax_68238 = ((__global int16_t *) tS_mem_75468)[slice_68237];\n                    defunc_0_leq_res_68245 = sle16(s_prevMax_68238, r_max_68122);\n                    zlze_lhs_68246 = sub64(lm_68195, (int64_t) 1);\n                    tmp_f_res_68247 = sle64(zlze_lhs_68246, (int64_t) 0);\n                    x_68248 = !defunc_0_leq_res_68245;\n                    y_68249 = tmp_f_res_68247 && x_68248;\n                    tmp_68250 = defunc_0_leq_res_68245 || y_68249;\n                    max_res_68251 = smax64((int64_t) 0, zlze_lhs_68246);\n                    loopres_t_res_f_res_68252 = !tmp_68250;\n                    loopres_t_res_68243 = loopres_t_res_f_res_68252;\n                    loopres_t_res_68244 = max_res_68251;\n                }\n                loopres_68240 = loopres_t_res_68243;\n                loopres_68241 = loopres_t_res_68244;\n            } else {\n                int16_t s_nextMin_68230;\n                bool defunc_0_leq_res_68253;\n                int64_t tmp_68254;\n                bool loopres_f_res_68255;\n                \n                s_nextMin_68230 = ((__global int16_t *) tS_mem_75468)[slice_68229];\n                defunc_0_leq_res_68253 = sle16(r_max_68122, s_nextMin_68230);\n                tmp_68254 = add64((int64_t) 1, lm_68195);\n                loopres_f_res_68255 = !defunc_0_leq_res_68253;\n                loopres_68240 = loopres_f_res_68255;\n                loopres_68241 = tmp_68254;\n            }\n            loop_cond_t_res_68256 = slt64(loopres_68241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);\n            x_68257 = loopres_68240 && loop_cond_t_res_68256;\n            loop_while_tmp_76747 = x_68257;\n            lm_tmp_76748 = loopres_68241;\n            loop_while_68194 = loop_while_tmp_76747;\n            lm_68195 = lm_tmp_76748;\n        }\n        defunc_0_f_res_68192 = loop_while_68194;\n        defunc_0_f_res_68193 = lm_68195;\n        ((__global int64_t *) mem_7", "5522)[gtid_68098] = defunc_0_f_res_68124;\n        ((__global int64_t *) mem_75524)[gtid_68098] = defunc_0_f_res_68193;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68094\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68451_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68451(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75703, int64_t ext_75704, __global unsigned char *mem_param_75540, __global unsigned char *ext_mem_75707, __global unsigned char *mem_75711)\n{\n    #define segmap_tblock_sizze_68447 (inner_SMJ_shortzisegmap_68451zisegmap_tblock_sizze_68447)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76860;\n    int32_t tblock_sizze_76863;\n    int32_t wave_sizze_76862;\n    int32_t block_id_76861;\n    int32_t global_tid_76859;\n    int64_t phys_tid_68451;\n    int64_t global_tid_76864;\n    int64_t slice_76865;\n    int64_t gtid_68450;\n    int64_t remnant_76866;\n    \n    local_tid_76860 = get_local_id(0);\n    tblock_sizze_76863 = get_local_size(0);\n    wave_sizze_76862 = LOCKSTEP_WIDTH;\n    block_id_76861 = get_tblock_id(0);\n    global_tid_76859 = block_id_76861 * tblock_sizze_76863 + local_tid_76860;\n    phys_tid_68451 = sext_i32_i64(global_tid_76859);\n    global_tid_76864 = sext_i32_i64(block_id_76861) * segmap_tblock_sizze_68447 + sext_i32_i64(local_tid_76860);\n    slice_76865 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_68450 = global_tid_76864;\n    remnant_76866 = global_tid_76864 - gtid_68450;\n    if (slt64(gtid_68450, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_68452;\n        bool cond_68454;\n        int64_t lifted_lambda_res_68455;\n        \n        eta_p_68452 = ((__global int64_t *) mem_param_75540)[gtid_68450];\n        cond_68454 = slt64(eta_p_68452, (int64_t) 0);\n        if (cond_68454) {\n            int64_t eta_p_68453 = ((__global int64_t *) ext_mem_75707)[ext_75704 + gtid_68450 * ext_75703];\n            \n            lifted_lamb",
                                    "da_res_68455 = eta_p_68453;\n        } else {\n            lifted_lambda_res_68455 = eta_p_68452;\n        }\n        ((__global int64_t *) mem_75711)[gtid_68450] = lifted_lambda_res_68455;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68447\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68472_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68472(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ext_75705, int64_t ext_75706, __global unsigned char *mem_param_75537, __global unsigned char *ext_mem_75708, __global unsigned char *mem_75714)\n{\n    #define segmap_tblock_sizze_68468 (inner_SMJ_shortzisegmap_68472zisegmap_tblock_sizze_68468)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76869;\n    int32_t tblock_sizze_76872;\n    int32_t wave_sizze_76871;\n    int32_t block_id_76870;\n    int32_t global_tid_76868;\n    int64_t phys_tid_68472;\n    int64_t global_tid_76873;\n    int64_t slice_76874;\n    int64_t gtid_68471;\n    int64_t remnant_76875;\n    \n    local_tid_76869 = get_local_id(0);\n    tblock_sizze_76872 = get_local_size(0);\n    wave_sizze_76871 = LOCKSTEP_WIDTH;\n    block_id_76870 = get_tblock_id(0);\n    global_tid_76868 = block_id_76870 * tblock_sizze_76872 + local_tid_76869;\n    phys_tid_68472 = sext_i32_i64(global_tid_76868);\n    global_tid_76873 = sext_i32_i64(block_id_76870) * segmap_tblock_sizze_68468 + sext_i32_i64(local_tid_76869);\n    slice_76874 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_68471 = global_tid_76873;\n    remnant_76875 = global_tid_76873 - gtid_68471;\n    if (slt64(gtid_68471, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t eta_p_68473;\n        int64_t eta_p_68474;\n        int64_t defunc_0_f_res_68475;\n        \n        eta_p_68473 = ((__global int64_t *) mem_param_75537)[gtid_68471];\n        eta_p_68474 = ((__global int64_t *) ext_mem_75708)[ext_75706 + gtid_68471 * ext_75705];\n        defunc_0_f_res_68475 = add64(eta_p_68473, eta_p_6847", "4);\n        ((__global int64_t *) mem_75714)[gtid_68471] = defunc_0_f_res_68475;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68468\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68493_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68493(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75528, int64_t ctx_param_ext_75529, __global unsigned char *mem_param_75530, __global unsigned char *ext_mem_75719, __global unsigned char *mem_75723)\n{\n    #define segmap_tblock_sizze_68489 (inner_SMJ_shortzisegmap_68493zisegmap_tblock_sizze_68489)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76878;\n    int32_t tblock_sizze_76881;\n    int32_t wave_sizze_76880;\n    int32_t block_id_76879;\n    int32_t global_tid_76877;\n    int64_t phys_tid_68493;\n    int64_t global_tid_76882;\n    int64_t slice_76883;\n    int64_t gtid_68492;\n    int64_t remnant_76884;\n    \n    local_tid_76878 = get_local_id(0);\n    tblock_sizze_76881 = get_local_size(0);\n    wave_sizze_76880 = LOCKSTEP_WIDTH;\n    block_id_76879 = get_tblock_id(0);\n    global_tid_76877 = block_id_76879 * tblock_sizze_76881 + local_tid_76878;\n    phys_tid_68493 = sext_i32_i64(global_tid_76877);\n    global_tid_76882 = sext_i32_i64(block_id_76879) * segmap_tblock_sizze_68489 + sext_i32_i64(local_tid_76878);\n    slice_76883 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_68492 = global_tid_76882;\n    remnant_76884 = global_tid_76882 - gtid_68492;\n    if (slt64(gtid_68492, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73891;\n        int64_t eta_p_68494;\n        bool cond_68496;\n        int64_t lifted_lambda_res_68497;\n        \n        slice_73891 = loopres_f_res_f_res_65435 + gtid_68492;\n        eta_p_68494 = ((__global int64_t *) mem_param_75530)[ctx_param_ext_75528 + slice_73891 * ctx_param_ext_75529];\n        cond_68496 = slt64(eta_p_68494, (int64_t) 0);\n        if (cond_", "68496) {\n            int64_t eta_p_68495 = ((__global int64_t *) ext_mem_75719)[gtid_68492];\n            \n            lifted_lambda_res_68497 = eta_p_68495;\n        } else {\n            lifted_lambda_res_68497 = eta_p_68494;\n        }\n        ((__global int64_t *) mem_75723)[gtid_68492] = lifted_lambda_res_68497;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68489\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68514_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68514(__global int *global_failure, int64_t loopres_f_res_f_res_65435, int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, int64_t ctx_param_ext_75525, int64_t ctx_param_ext_75526, __global unsigned char *mem_param_75527, __global unsigned char *ext_mem_75720, __global unsigned char *mem_75726)\n{\n    #define segmap_tblock_sizze_68510 (inner_SMJ_shortzisegmap_68514zisegmap_tblock_sizze_68510)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76887;\n    int32_t tblock_sizze_76890;\n    int32_t wave_sizze_76889;\n    int32_t block_id_76888;\n    int32_t global_tid_76886;\n    int64_t phys_tid_68514;\n    int64_t global_tid_76891;\n    int64_t slice_76892;\n    int64_t gtid_68513;\n    int64_t remnant_76893;\n    \n    local_tid_76887 = get_local_id(0);\n    tblock_sizze_76890 = get_local_size(0);\n    wave_sizze_76889 = LOCKSTEP_WIDTH;\n    block_id_76888 = get_tblock_id(0);\n    global_tid_76886 = block_id_76888 * tblock_sizze_76890 + local_tid_76887;\n    phys_tid_68514 = sext_i32_i64(global_tid_76886);\n    global_tid_76891 = sext_i32_i64(block_id_76888) * segmap_tblock_sizze_68510 + sext_i32_i64(local_tid_76887);\n    slice_76892 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;\n    gtid_68513 = global_tid_76891;\n    remnant_76893 = global_tid_76891 - gtid_68513;\n    if (slt64(gtid_68513, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450)) {\n        int64_t slice_73890;\n        int64_t eta_p_68515;\n        int64_t eta_p_68516;\n        int64_t defunc_0_f_res_68517;\n        \n        slice_738",
                                    "90 = loopres_f_res_f_res_65435 + gtid_68513;\n        eta_p_68515 = ((__global int64_t *) mem_param_75527)[ctx_param_ext_75525 + slice_73890 * ctx_param_ext_75526];\n        eta_p_68516 = ((__global int64_t *) ext_mem_75720)[gtid_68513];\n        defunc_0_f_res_68517 = add64(eta_p_68515, eta_p_68516);\n        ((__global int64_t *) mem_75726)[gtid_68513] = defunc_0_f_res_68517;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68510\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68535_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68535(__global int *global_failure, int64_t nR_37190, int64_t ext_75914, int64_t ext_75915, __global unsigned char *mem_param_75482, __global unsigned char *ext_mem_75916, __global unsigned char *mem_75922)\n{\n    #define segmap_tblock_sizze_68531 (inner_SMJ_shortzisegmap_68535zisegmap_tblock_sizze_68531)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76896;\n    int32_t tblock_sizze_76899;\n    int32_t wave_sizze_76898;\n    int32_t block_id_76897;\n    int32_t global_tid_76895;\n    int64_t phys_tid_68535;\n    int64_t global_tid_76900;\n    int64_t slice_76901;\n    int64_t gtid_68534;\n    int64_t remnant_76902;\n    \n    local_tid_76896 = get_local_id(0);\n    tblock_sizze_76899 = get_local_size(0);\n    wave_sizze_76898 = LOCKSTEP_WIDTH;\n    block_id_76897 = get_tblock_id(0);\n    global_tid_76895 = block_id_76897 * tblock_sizze_76899 + local_tid_76896;\n    phys_tid_68535 = sext_i32_i64(global_tid_76895);\n    global_tid_76900 = sext_i32_i64(block_id_76897) * segmap_tblock_sizze_68531 + sext_i32_i64(local_tid_76896);\n    slice_76901 = nR_37190;\n    gtid_68534 = global_tid_76900;\n    remnant_76902 = global_tid_76900 - gtid_68534;\n    if (slt64(gtid_68534, nR_37190)) {\n        int64_t eta_p_68536;\n        bool cond_68538;\n        int64_t lifted_lambda_res_68539;\n        \n        eta_p_68536 = ((__global int64_t *) mem_param_75482)[gtid_68534];\n        cond_68538 = slt64(eta_p_68536, (int64_t) 0);\n        if (cond_68538)", " {\n            int64_t eta_p_68537 = ((__global int64_t *) ext_mem_75916)[ext_75915 + gtid_68534 * ext_75914];\n            \n            lifted_lambda_res_68539 = eta_p_68537;\n        } else {\n            lifted_lambda_res_68539 = eta_p_68536;\n        }\n        ((__global int64_t *) mem_75922)[gtid_68534] = lifted_lambda_res_68539;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68531\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68556_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68556(__global int *global_failure, int64_t nR_37190, int64_t ext_75917, int64_t ext_75918, __global unsigned char *mem_param_75479, __global unsigned char *ext_mem_75919, __global unsigned char *mem_75925)\n{\n    #define segmap_tblock_sizze_68552 (inner_SMJ_shortzisegmap_68556zisegmap_tblock_sizze_68552)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76905;\n    int32_t tblock_sizze_76908;\n    int32_t wave_sizze_76907;\n    int32_t block_id_76906;\n    int32_t global_tid_76904;\n    int64_t phys_tid_68556;\n    int64_t global_tid_76909;\n    int64_t slice_76910;\n    int64_t gtid_68555;\n    int64_t remnant_76911;\n    \n    local_tid_76905 = get_local_id(0);\n    tblock_sizze_76908 = get_local_size(0);\n    wave_sizze_76907 = LOCKSTEP_WIDTH;\n    block_id_76906 = get_tblock_id(0);\n    global_tid_76904 = block_id_76906 * tblock_sizze_76908 + local_tid_76905;\n    phys_tid_68556 = sext_i32_i64(global_tid_76904);\n    global_tid_76909 = sext_i32_i64(block_id_76906) * segmap_tblock_sizze_68552 + sext_i32_i64(local_tid_76905);\n    slice_76910 = nR_37190;\n    gtid_68555 = global_tid_76909;\n    remnant_76911 = global_tid_76909 - gtid_68555;\n    if (slt64(gtid_68555, nR_37190)) {\n        int64_t eta_p_68557;\n        int64_t eta_p_68558;\n        int64_t defunc_0_f_res_68559;\n        \n        eta_p_68557 = ((__global int64_t *) mem_param_75479)[gtid_68555];\n        eta_p_68558 = ((__global int64_t *) ext_mem_75919)[ext_75918 + gtid_68555 * ext_75917];\n        defunc_0_f_res_6", "8559 = add64(eta_p_68557, eta_p_68558);\n        ((__global int64_t *) mem_75925)[gtid_68555] = defunc_0_f_res_68559;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68552\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68569_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68569(__global int *global_failure, int64_t nR_37190, int64_t m_65686, int64_t num_tblocks_68574, int32_t virt_num_tblocks_77062, __global unsigned char *tR_mem_75467, __global unsigned char *ext_mem_75469, __global unsigned char *ext_mem_75937, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *mem_75945, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951)\n{\n    #define segmap_tblock_sizze_68572 (inner_SMJ_shortzisegmap_68569zisegmap_tblock_sizze_68572)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77064;\n    int32_t tblock_sizze_77067;\n    int32_t wave_sizze_77066;\n    int32_t block_id_77065;\n    int32_t global_tid_77063;\n    int64_t phys_tid_68569;\n    int32_t phys_tblock_id_77068;\n    int32_t iterations_77069;\n    \n    local_tid_77064 = get_local_id(0);\n    tblock_sizze_77067 = get_local_size(0);\n    wave_sizze_77066 = LOCKSTEP_WIDTH;\n    block_id_77065 = get_tblock_id(0);\n    global_tid_77063 = block_id_77065 * tblock_sizze_77067 + local_tid_77064;\n    phys_tid_68569 = sext_i32_i64(global_tid_77063);\n    phys_tblock_id_77068 = get_tblock_id(0);\n    iterations_77069 = sdiv_up32(virt_num_tblocks_77062 - phys_tblock_id_77068, sext_i64_i32(num_tblocks_68574));\n    for (int32_t i_77070 = 0; i_77070 < iterations_77069; i_77070++) {\n        int32_t virt_tblock_id_77071;\n        int64_t global_tid_77072;\n        int64_t slice_77073;\n        int64_t write_i_68568;\n        int64_t remnant_77074;\n        \n        virt_tblock_id_77071 = phys_tblock_id_77068 + i_77070 * sext_i64_i32(num_tblocks_68574);\n        global_tid_77072 = sext_i32_",
                                    "i64(virt_tblock_id_77071) * segmap_tblock_sizze_68572 + sext_i32_i64(local_tid_77064);\n        slice_77073 = nR_37190;\n        write_i_68568 = global_tid_77072;\n        remnant_77074 = global_tid_77072 - write_i_68568;\n        if (slt64(write_i_68568, nR_37190)) {\n            int64_t eta_p_65951;\n            int16_t write_value_65953;\n            int64_t write_value_65954;\n            int64_t write_value_65955;\n            int64_t write_value_65956;\n            bool cond_65957;\n            int64_t lifted_lambda_res_65958;\n            \n            eta_p_65951 = ((__global int64_t *) mem_75943)[write_i_68568];\n            write_value_65953 = ((__global int16_t *) tR_mem_75467)[write_i_68568];\n            write_value_65954 = ((__global int64_t *) ext_mem_75469)[write_i_68568];\n            write_value_65955 = ((__global int64_t *) ext_mem_75937)[write_i_68568];\n            write_value_65956 = ((__global int64_t *) ext_mem_75938)[write_i_68568];\n            cond_65957 = eta_p_65951 == (int64_t) 1;\n            if (cond_65957) {\n                int64_t eta_p_65952;\n                int64_t lifted_lambda_res_t_res_66732;\n                \n                eta_p_65952 = ((__global int64_t *) mem_75941)[write_i_68568];\n                lifted_lambda_res_t_res_66732 = sub64(eta_p_65952, (int64_t) 1);\n                lifted_lambda_res_65958 = lifted_lambda_res_t_res_66732;\n            } else {\n                lifted_lambda_res_65958 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int16_t *) mem_75951)[lifted_lambda_res_65958] = write_value_65953;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75949)[lifted_lambda_res_65958] = write_value_65954;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_656", "86)) {\n                ((__global int64_t *) mem_75947)[lifted_lambda_res_65958] = write_value_65955;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65958) && slt64(lifted_lambda_res_65958, m_65686)) {\n                ((__global int64_t *) mem_75945)[lifted_lambda_res_65958] = write_value_65956;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_68572\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68603_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68603(__global int *global_failure, int64_t m_65686, __global unsigned char *mem_75955, __global unsigned char *mem_75962)\n{\n    #define segmap_tblock_sizze_68599 (inner_SMJ_shortzisegmap_68603zisegmap_tblock_sizze_68599)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77230;\n    int32_t tblock_sizze_77233;\n    int32_t wave_sizze_77232;\n    int32_t block_id_77231;\n    int32_t global_tid_77229;\n    int64_t phys_tid_68603;\n    int64_t global_tid_77234;\n    int64_t slice_77235;\n    int64_t gtid_68602;\n    int64_t remnant_77236;\n    \n    local_tid_77230 = get_local_id(0);\n    tblock_sizze_77233 = get_local_size(0);\n    wave_sizze_77232 = LOCKSTEP_WIDTH;\n    block_id_77231 = get_tblock_id(0);\n    global_tid_77229 = block_id_77231 * tblock_sizze_77233 + local_tid_77230;\n    phys_tid_68603 = sext_i32_i64(global_tid_77229);\n    global_tid_77234 = sext_i32_i64(block_id_77231) * segmap_tblock_sizze_68599 + sext_i32_i64(local_tid_77230);\n    slice_77235 = m_65686;\n    gtid_68602 = global_tid_77234;\n    remnant_77236 = global_tid_77234 - gtid_68602;\n    if (slt64(gtid_68602, m_65686)) {\n        int64_t zv_lhs_68605;\n        int64_t tmp_68606;\n        bool cond_68608;\n        int64_t lifted_lambda_res_68609;\n        \n        zv_lhs_68605 = add64((int64_t) -1, gtid_68602);\n        tmp_68606 = smod64(zv_lhs_68605, m_65686);\n        cond_68608 = gtid_68602 == (int64_t) 0;\n        if (cond_68608) {\n   ", "         lifted_lambda_res_68609 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_68607 = ((__global int64_t *) mem_75955)[tmp_68606];\n            \n            lifted_lambda_res_68609 = lifted_lambda_res_68607;\n        }\n        ((__global int64_t *) mem_75962)[gtid_68602] = lifted_lambda_res_68609;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68599\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68611_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68611(__global int *global_failure, int64_t m_65686, int64_t lower_bound_65769, int64_t min_res_65771, int64_t j_m_i_65772, int64_t num_tblocks_68616, int32_t virt_num_tblocks_77275, __global unsigned char *mem_75947, __global unsigned char *mem_75949, __global unsigned char *mem_75951, __global unsigned char *mem_75962, __global unsigned char *mem_75991, __global unsigned char *mem_75993, __global unsigned char *mem_75995)\n{\n    #define segmap_tblock_sizze_68614 (inner_SMJ_shortzisegmap_68611zisegmap_tblock_sizze_68614)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77277;\n    int32_t tblock_sizze_77280;\n    int32_t wave_sizze_77279;\n    int32_t block_id_77278;\n    int32_t global_tid_77276;\n    int64_t phys_tid_68611;\n    int32_t phys_tblock_id_77281;\n    int32_t iterations_77282;\n    \n    local_tid_77277 = get_local_id(0);\n    tblock_sizze_77280 = get_local_size(0);\n    wave_sizze_77279 = LOCKSTEP_WIDTH;\n    block_id_77278 = get_tblock_id(0);\n    global_tid_77276 = block_id_77278 * tblock_sizze_77280 + local_tid_77277;\n    phys_tid_68611 = sext_i32_i64(global_tid_77276);\n    phys_tblock_id_77281 = get_tblock_id(0);\n    iterations_77282 = sdiv_up32(virt_num_tblocks_77275 - phys_tblock_id_77281, sext_i64_i32(num_tblocks_68616));\n    for (int32_t i_77283 = 0; i_77283 < iterations_77282; i_77283++) {\n        int32_t virt_tblock_id_77284;\n        int64_t global_tid_77285;\n        int64_t slice_77286;\n        int64_t write_i_68610;\n        int64_t remnant_77287;\n    ",
                                    "    \n        virt_tblock_id_77284 = phys_tblock_id_77281 + i_77283 * sext_i64_i32(num_tblocks_68616);\n        global_tid_77285 = sext_i32_i64(virt_tblock_id_77284) * segmap_tblock_sizze_68614 + sext_i32_i64(local_tid_77277);\n        slice_77286 = m_65686;\n        write_i_68610 = global_tid_77285;\n        remnant_77287 = global_tid_77285 - write_i_68610;\n        if (slt64(write_i_68610, m_65686)) {\n            int64_t eta_p_66344;\n            int16_t write_value_66345;\n            int64_t write_value_66346;\n            int64_t write_value_66347;\n            bool cond_66348;\n            bool cond_t_res_66349;\n            bool x_66350;\n            int64_t lifted_lambda_res_66351;\n            \n            eta_p_66344 = ((__global int64_t *) mem_75962)[write_i_68610];\n            write_value_66345 = ((__global int16_t *) mem_75951)[write_i_68610];\n            write_value_66346 = ((__global int64_t *) mem_75949)[write_i_68610];\n            write_value_66347 = ((__global int64_t *) mem_75947)[write_i_68610];\n            cond_66348 = sle64(lower_bound_65769, eta_p_66344);\n            cond_t_res_66349 = slt64(eta_p_66344, min_res_65771);\n            x_66350 = cond_66348 && cond_t_res_66349;\n            if (x_66350) {\n                int64_t lifted_lambda_res_t_res_66735 = sub64(eta_p_66344, lower_bound_65769);\n                \n                lifted_lambda_res_66351 = lifted_lambda_res_t_res_66735;\n            } else {\n                lifted_lambda_res_66351 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int16_t *) mem_75991)[lifted_lambda_res_66351] = write_value_66345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351) && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75993)[lifted_lambda_res_66351] = write_value_66346;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66351", ") && slt64(lifted_lambda_res_66351, j_m_i_65772)) {\n                ((__global int64_t *) mem_75995)[lifted_lambda_res_66351] = write_value_66347;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_68614\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68619_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68619(__global int *global_failure, int64_t m_65686, int64_t m_65826, int64_t num_tblocks_68624, int32_t virt_num_tblocks_77257, __global unsigned char *mem_75945, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *mem_75962, __global unsigned char *mem_75970, __global unsigned char *mem_75972)\n{\n    #define segmap_tblock_sizze_68622 (inner_SMJ_shortzisegmap_68619zisegmap_tblock_sizze_68622)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77259;\n    int32_t tblock_sizze_77262;\n    int32_t wave_sizze_77261;\n    int32_t block_id_77260;\n    int32_t global_tid_77258;\n    int64_t phys_tid_68619;\n    int32_t phys_tblock_id_77263;\n    int32_t iterations_77264;\n    \n    local_tid_77259 = get_local_id(0);\n    tblock_sizze_77262 = get_local_size(0);\n    wave_sizze_77261 = LOCKSTEP_WIDTH;\n    block_id_77260 = get_tblock_id(0);\n    global_tid_77258 = block_id_77260 * tblock_sizze_77262 + local_tid_77259;\n    phys_tid_68619 = sext_i32_i64(global_tid_77258);\n    phys_tblock_id_77263 = get_tblock_id(0);\n    iterations_77264 = sdiv_up32(virt_num_tblocks_77257 - phys_tblock_id_77263, sext_i64_i32(num_tblocks_68624));\n    for (int32_t i_77265 = 0; i_77265 < iterations_77264; i_77265++) {\n        int32_t virt_tblock_id_77266;\n        int64_t global_tid_77267;\n        int64_t slice_77268;\n        int64_t write_i_68618;\n        int64_t remnant_77269;\n        \n        virt_tblock_id_77266 = phys_tblock_id_77263 + i_77265 * sext_i64_i32(num_tblocks_68624);\n        global_tid_77267 = sext_i32_i64(virt_tblock_id_77266) * segmap_tblock", "_sizze_68622 + sext_i32_i64(local_tid_77259);\n        slice_77268 = m_65686;\n        write_i_68618 = global_tid_77267;\n        remnant_77269 = global_tid_77267 - write_i_68618;\n        if (slt64(write_i_68618, m_65686)) {\n            int64_t eta_p_65928;\n            int64_t write_value_65930;\n            int64_t write_value_65931;\n            bool cond_65932;\n            int64_t lifted_lambda_res_65933;\n            \n            eta_p_65928 = ((__global int64_t *) mem_75959)[write_i_68618];\n            write_value_65930 = ((__global int64_t *) mem_75962)[write_i_68618];\n            write_value_65931 = ((__global int64_t *) mem_75945)[write_i_68618];\n            cond_65932 = eta_p_65928 == (int64_t) 1;\n            if (cond_65932) {\n                int64_t eta_p_65929;\n                int64_t lifted_lambda_res_t_res_66740;\n                \n                eta_p_65929 = ((__global int64_t *) mem_75957)[write_i_68618];\n                lifted_lambda_res_t_res_66740 = sub64(eta_p_65929, (int64_t) 1);\n                lifted_lambda_res_65933 = lifted_lambda_res_t_res_66740;\n            } else {\n                lifted_lambda_res_65933 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75972)[lifted_lambda_res_65933] = write_value_65930;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65933) && slt64(lifted_lambda_res_65933, m_65826)) {\n                ((__global int64_t *) mem_75970)[lifted_lambda_res_65933] = write_value_65931;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_68622\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_68641_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_68641(__global int *global_failure, int64_t loopres_65870, int64_t loopres_65871, __global unsigned char *mem_76020, __global unsigned char *mem_76023)\n{\n    #de",
                                    "fine segmap_tblock_sizze_68637 (inner_SMJ_shortzisegmap_68641zisegmap_tblock_sizze_68637)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77344;\n    int32_t tblock_sizze_77347;\n    int32_t wave_sizze_77346;\n    int32_t block_id_77345;\n    int32_t global_tid_77343;\n    int64_t phys_tid_68641;\n    int64_t global_tid_77348;\n    int64_t slice_77349;\n    int64_t gtid_68640;\n    int64_t remnant_77350;\n    \n    local_tid_77344 = get_local_id(0);\n    tblock_sizze_77347 = get_local_size(0);\n    wave_sizze_77346 = LOCKSTEP_WIDTH;\n    block_id_77345 = get_tblock_id(0);\n    global_tid_77343 = block_id_77345 * tblock_sizze_77347 + local_tid_77344;\n    phys_tid_68641 = sext_i32_i64(global_tid_77343);\n    global_tid_77348 = sext_i32_i64(block_id_77345) * segmap_tblock_sizze_68637 + sext_i32_i64(local_tid_77344);\n    slice_77349 = loopres_65871;\n    gtid_68640 = global_tid_77348;\n    remnant_77350 = global_tid_77348 - gtid_68640;\n    if (slt64(gtid_68640, loopres_65871)) {\n        int64_t loopres_75462;\n        int64_t tmp_68643;\n        \n        loopres_75462 = ((__global int64_t *) mem_76023)[(int64_t) 0];\n        tmp_68643 = add64(gtid_68640, loopres_75462);\n        ((__global int64_t *) mem_76020)[loopres_65870 + gtid_68640] = tmp_68643;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_68637\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_73899_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_73899(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_73902, int64_t num_whole_tiles_73917, int64_t residual_input_74141, unsigned char cond_74142_bits, int64_t binop_x_74158, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75887, __global unsigned char *mem_75889)\n{\n    bool cond_74142 = cond_74142_bits;\n    \n    #define til", "e_sizze_73901 (inner_SMJ_shortzisegmap_intrablock_73899zitile_sizze_73901)\n    #define bytes_75849 (inner_SMJ_shortzisegmap_intrablock_73899zibytes_75849)\n    #define bytes_75851 (inner_SMJ_shortzisegmap_intrablock_73899zibytes_75851)\n    \n    volatile __local unsigned char *color_76532_backing_2 = &shared_mem[0];\n    const int64_t color_76532_backing_2_offset = 0 + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76531_backing_1 = &shared_mem[color_76532_backing_2_offset];\n    const int64_t color_76531_backing_1_offset = color_76532_backing_2_offset + (bytes_75851 + srem64((int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76530_backing_0 = &shared_mem[color_76531_backing_1_offset];\n    const int64_t color_76530_backing_0_offset = color_76531_backing_1_offset + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76641;\n    int32_t tblock_sizze_76644;\n    int32_t wave_sizze_76643;\n    int32_t block_id_76642;\n    int32_t global_tid_76640;\n    int64_t gid_flat_73899;\n    int64_t slice_76646;\n    int64_t ltid_pre_76645;\n    int64_t remnant_76647;\n    int64_t slice_76648;\n    int64_t gid_73898;\n    int64_t remnant_76649;\n    __local unsigned char *color_76530;\n    __local unsigned char *color_76531;\n    __local unsigned char *color_76532;\n    int64_t binop_x_73909;\n    int16_t mem_75833[1];\n    int64_t ltid_flat_73904;\n    int64_t ltid_73903;\n    int64_t gtid_73910;\n    bool cond_73911;\n    int16_t pre_73912;\n    int64_t mem_75837[1];\n    int16_t mem_75841[1];\n    int64_t mem_75845[1];\n    int64_t ltid_flat_73919;\n    int64_t ltid_73918;\n    int64_t gtid_73929;\n    bool cond_73930;\n    int64_t neutral_73931;\n    int16_t neutral_73932;\n    int64_t ext_mem_75869[1];\n    int16_t ext_mem_75868[1];\n    int64_t ext_mem_75867[1];\n    int6", "4_t mem_param_75846[1];\n    int16_t mem_param_75847[1];\n    int64_t mem_param_75848[1];\n    int64_t mem_75879[1];\n    int64_t mem_75883[1];\n    int64_t ext_mem_75885[1];\n    int64_t ext_mem_75884[1];\n    \n    local_tid_76641 = get_local_id(0);\n    tblock_sizze_76644 = get_local_size(0);\n    wave_sizze_76643 = LOCKSTEP_WIDTH;\n    block_id_76642 = get_tblock_id(0);\n    global_tid_76640 = block_id_76642 * tblock_sizze_76644 + local_tid_76641;\n    gid_flat_73899 = sext_i32_i64(block_id_76642);\n    slice_76646 = tile_sizze_73901;\n    ltid_pre_76645 = sext_i32_i64(local_tid_76641);\n    remnant_76647 = sext_i32_i64(local_tid_76641) - ltid_pre_76645;\n    slice_76648 = ldim_73902;\n    gid_73898 = sext_i32_i64(block_id_76642);\n    remnant_76649 = sext_i32_i64(block_id_76642) - gid_73898;\n    color_76530 = (__local unsigned char *) color_76530_backing_0;\n    color_76531 = (__local unsigned char *) color_76531_backing_1;\n    color_76532 = (__local unsigned char *) color_76532_backing_2;\n    binop_x_73909 = gid_73898 * tile_sizze_73901;\n    ltid_flat_73904 = sext_i32_i64(local_tid_76641);\n    ltid_73903 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73910 = ltid_73903 + binop_x_73909;\n    cond_73911 = slt64(gtid_73910, min_res_66402);\n    if (cond_73911) {\n        int64_t slice_73913;\n        int16_t eta_p_73914;\n        \n        slice_73913 = start_66400 + gtid_73910;\n        eta_p_73914 = ((__global int16_t *) tR_mem_75467)[slice_73913];\n        pre_73912 = eta_p_73914;\n    } else {\n        pre_73912 = (int16_t) 0;\n    }\n    mem_75833[(int64_t) 0] = pre_73912;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_73919 = sext_i32_i64(local_tid_76641);\n    ltid_73918 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n    gtid_73929 = binop_x_73909 + ltid_73918;\n    cond_73930 = slt64(gtid_73929, min_res_66402);\n    if (cond_73930) {\n        neutral_73931 = (int64_t) -1;\n    } else {\n        neutral_73931 = (int64_t) 0;\n    }\n    if (cond_73930) {\n        int16_t eta_p_73934 = mem_",
                                    "75833[(int64_t) 0];\n        \n        neutral_73932 = eta_p_73934;\n    } else {\n        neutral_73932 = (int16_t) 0;\n    }\n    mem_75837[(int64_t) 0] = neutral_73931;\n    mem_75841[(int64_t) 0] = neutral_73932;\n    mem_75845[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75846[i_3] = mem_75837[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75847[i_4] = mem_75841[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75848[i_5] = mem_75845[i_5];\n    for (int64_t tile_id_73944 = 0; tile_id_73944 < num_whole_tiles_73917; tile_id_73944++) {\n        int64_t binop_x_74043;\n        int64_t ltid_flat_74042;\n        int64_t ltid_74041;\n        int64_t j_74044;\n        bool cond_74048;\n        int64_t pre1d_74051;\n        int64_t pre1d_74049;\n        int16_t pre1d_74050;\n        int64_t mem_75858[1];\n        int16_t mem_75862[1];\n        int64_t mem_75866[1];\n        int64_t ltid_flat_74062;\n        int64_t ltid_74061;\n        int64_t gtid_74064;\n        int64_t acc_74066;\n        int16_t acc_74067;\n        int64_t acc_74068;\n        bool cond_74069;\n        int64_t acc_74070;\n        int16_t acc_74071;\n        int64_t acc_74072;\n        int64_t mem_param_tmp_76650[1];\n        int16_t mem_param_tmp_76651[1];\n        int64_t mem_param_tmp_76652[1];\n        \n        binop_x_74043 = tile_sizze_73901 * tile_id_73944;\n        ltid_flat_74042 = sext_i32_i64(local_tid_76641);\n        ltid_74041 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74044 = ltid_74041 + binop_x_74043;\n        cond_74048 = slt64(j_74044, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74051 = btoi_bool_i64(cond_74048);\n        if (cond_74048) {\n            int64_t tile_elem_74052;\n            int64_t slice_75321;\n            int16_t tile_elem_74053;\n            \n            tile_elem_74052 = ((__global int64_t *) ext_mem_75767)[j_74044];\n           ", " slice_75321 = tS_start_64840 + j_74044;\n            tile_elem_74053 = ((__global int16_t *) tS_mem_75468)[slice_75321];\n            pre1d_74049 = tile_elem_74052;\n            pre1d_74050 = tile_elem_74053;\n        } else {\n            pre1d_74049 = (int64_t) 0;\n            pre1d_74050 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74041] = pre1d_74049;\n        ((__local int16_t *) color_76531)[ltid_74041] = pre1d_74050;\n        ((__local int64_t *) color_76530)[ltid_74041] = pre1d_74051;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74062 = sext_i32_i64(local_tid_76641);\n        ltid_74061 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74064 = binop_x_73909 + ltid_74061;\n        acc_74066 = mem_param_75846[(int64_t) 0];\n        acc_74067 = mem_param_75847[(int64_t) 0];\n        acc_74068 = mem_param_75848[(int64_t) 0];\n        cond_74069 = slt64(gtid_74064, min_res_66402);\n        if (cond_74069) {\n            int16_t eta_p_74065;\n            int64_t x_74073;\n            int16_t x_74074;\n            int64_t x_74075;\n            int64_t redout_75334;\n            int16_t redout_75335;\n            int64_t redout_75336;\n            \n            eta_p_74065 = mem_75833[(int64_t) 0];\n            redout_75334 = acc_74066;\n            redout_75335 = acc_74067;\n            redout_75336 = acc_74068;\n            for (int64_t i_75337 = 0; i_75337 < tile_sizze_73901; i_75337++) {\n                int64_t x_74076;\n                int16_t x_74077;\n                bool defunc_0_neq_res_74085;\n                bool defunc_0_neq_res_74086;\n                bool cond_f_res_74087;\n                bool y_74088;\n                bool cond_74089;\n                bool defunc_0_neq_res_74090;\n                bool defunc_0_neq_res_74091;\n                bool cond_t_res_f_res_74092;\n                bool y_74093;\n                bool cond_t_res_74094;\n                bool x_74095;\n                int64_t defunc_0_op_res_74096;\n                int16_t ", "defunc_0_op_res_74097;\n                int64_t defunc_0_op_res_74098;\n                int64_t redout_tmp_76656;\n                int16_t redout_tmp_76657;\n                int64_t redout_tmp_76658;\n                \n                x_74076 = ((__local int64_t *) color_76532)[i_75337];\n                x_74077 = ((__local int16_t *) color_76531)[i_75337];\n                defunc_0_neq_res_74085 = redout_75335 == eta_p_74065;\n                defunc_0_neq_res_74086 = !defunc_0_neq_res_74085;\n                cond_f_res_74087 = slt64(redout_75334, (int64_t) 0);\n                y_74088 = defunc_0_neq_res_74085 && cond_f_res_74087;\n                cond_74089 = defunc_0_neq_res_74086 || y_74088;\n                defunc_0_neq_res_74090 = x_74077 == eta_p_74065;\n                defunc_0_neq_res_74091 = !defunc_0_neq_res_74090;\n                cond_t_res_f_res_74092 = slt64(x_74076, (int64_t) 0);\n                y_74093 = defunc_0_neq_res_74090 && cond_t_res_f_res_74092;\n                cond_t_res_74094 = defunc_0_neq_res_74091 || y_74093;\n                x_74095 = cond_74089 && cond_t_res_74094;\n                if (x_74095) {\n                    defunc_0_op_res_74096 = (int64_t) -1;\n                    defunc_0_op_res_74097 = eta_p_74065;\n                    defunc_0_op_res_74098 = (int64_t) 0;\n                } else {\n                    int64_t x_74078;\n                    int64_t defunc_0_op_res_f_res_74099;\n                    int16_t defunc_0_op_res_f_res_74100;\n                    int64_t defunc_0_op_res_f_res_74101;\n                    \n                    x_74078 = ((__local int64_t *) color_76530)[i_75337];\n                    if (cond_74089) {\n                        defunc_0_op_res_f_res_74099 = x_74076;\n                        defunc_0_op_res_f_res_74100 = x_74077;\n                        defunc_0_op_res_f_res_74101 = x_74078;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74102;\n                        int64_t defunc_0_op_res_f",
                                    "_res_f_res_74103;\n                        int64_t defunc_0_op_res_f_res_f_res_74104;\n                        \n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74102 = redout_75335;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74102 = eta_p_74065;\n                        }\n                        if (cond_t_res_74094) {\n                            defunc_0_op_res_f_res_f_res_74103 = redout_75334;\n                            defunc_0_op_res_f_res_f_res_74104 = redout_75336;\n                        } else {\n                            int64_t min_res_74105;\n                            int64_t tmp_74106;\n                            \n                            min_res_74105 = smin64(x_74076, redout_75334);\n                            tmp_74106 = add64(x_74078, redout_75336);\n                            defunc_0_op_res_f_res_f_res_74103 = min_res_74105;\n                            defunc_0_op_res_f_res_f_res_74104 = tmp_74106;\n                        }\n                        defunc_0_op_res_f_res_74099 = defunc_0_op_res_f_res_f_res_74103;\n                        defunc_0_op_res_f_res_74100 = defunc_0_op_res_f_res_f_res_74102;\n                        defunc_0_op_res_f_res_74101 = defunc_0_op_res_f_res_f_res_74104;\n                    }\n                    defunc_0_op_res_74096 = defunc_0_op_res_f_res_74099;\n                    defunc_0_op_res_74097 = defunc_0_op_res_f_res_74100;\n                    defunc_0_op_res_74098 = defunc_0_op_res_f_res_74101;\n                }\n                redout_tmp_76656 = defunc_0_op_res_74096;\n                redout_tmp_76657 = defunc_0_op_res_74097;\n                redout_tmp_76658 = defunc_0_op_res_74098;\n                redout_75334 = redout_tmp_76656;\n                redout_75335 = redout_tmp_76657;\n                redout_75336 = redout_tmp_76658;\n            }\n            x_74073 = redout_75334;\n            x_74074 = redout_75335;\n      ", "      x_74075 = redout_75336;\n            acc_74070 = x_74073;\n            acc_74071 = x_74074;\n            acc_74072 = x_74075;\n        } else {\n            acc_74070 = acc_74066;\n            acc_74071 = acc_74067;\n            acc_74072 = acc_74068;\n        }\n        mem_75858[(int64_t) 0] = acc_74070;\n        mem_75862[(int64_t) 0] = acc_74071;\n        mem_75866[(int64_t) 0] = acc_74072;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76650[i_6] = mem_75858[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76651[i_7] = mem_75862[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76652[i_8] = mem_75866[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75846[i_9] = mem_param_tmp_76650[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75847[i_10] = mem_param_tmp_76651[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75848[i_11] = mem_param_tmp_76652[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75869[i_12] = mem_param_75846[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75868[i_13] = mem_param_75847[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75867[i_14] = mem_param_75848[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74142) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75885[i_15] = ext_mem_75869[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75884[i_16] = ext_mem_75867[i_16];\n    } else {\n        int64_t ltid_flat_74144;\n        int64_t ltid_74143;\n        int64_t j_74159;\n        bool cond_74163;\n        int64_t pre1d_74166;\n        int64_t pre1d_74164;\n        int16_t pre1d_74165;\n        int64_t ltid_flat_74180;\n        int64_t ltid_74179;\n        int64_t gtid_74193;\n        int64_t acc_74195;\n        int64_t acc_74197;\n        bool cond", "_74198;\n        int64_t acc_74199;\n        int64_t acc_74201;\n        \n        ltid_flat_74144 = sext_i32_i64(local_tid_76641);\n        ltid_74143 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        j_74159 = ltid_74143 + binop_x_74158;\n        cond_74163 = slt64(j_74159, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74166 = btoi_bool_i64(cond_74163);\n        if (cond_74163) {\n            int64_t tile_elem_74167;\n            int64_t slice_75320;\n            int16_t tile_elem_74168;\n            \n            tile_elem_74167 = ((__global int64_t *) ext_mem_75767)[j_74159];\n            slice_75320 = tS_start_64840 + j_74159;\n            tile_elem_74168 = ((__global int16_t *) tS_mem_75468)[slice_75320];\n            pre1d_74164 = tile_elem_74167;\n            pre1d_74165 = tile_elem_74168;\n        } else {\n            pre1d_74164 = (int64_t) 0;\n            pre1d_74165 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76532)[ltid_74143] = pre1d_74164;\n        ((__local int16_t *) color_76531)[ltid_74143] = pre1d_74165;\n        ((__local int64_t *) color_76530)[ltid_74143] = pre1d_74166;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74180 = sext_i32_i64(local_tid_76641);\n        ltid_74179 = sext_i32_i64(sext_i64_i32(ltid_pre_76645));\n        gtid_74193 = binop_x_73909 + ltid_74179;\n        acc_74195 = ext_mem_75869[(int64_t) 0];\n        acc_74197 = ext_mem_75867[(int64_t) 0];\n        cond_74198 = slt64(gtid_74193, min_res_66402);\n        if (cond_74198) {\n            int16_t eta_p_74194;\n            int16_t acc_74196;\n            int64_t x_74202;\n            int16_t x_74203;\n            int64_t x_74204;\n            int64_t redout_75338;\n            int16_t redout_75339;\n            int64_t redout_75340;\n            \n            eta_p_74194 = mem_75833[(int64_t) 0];\n            acc_74196 = ext_mem_75868[(int64_t) 0];\n            redout_75338 = acc_74195;\n            redout_75339 = acc_74196;\n            redout_75340 = acc_74197;\n     ",
                                    "       for (int64_t i_75341 = 0; i_75341 < residual_input_74141; i_75341++) {\n                int64_t x_74205;\n                int16_t x_74206;\n                bool defunc_0_neq_res_74214;\n                bool defunc_0_neq_res_74215;\n                bool cond_f_res_74216;\n                bool y_74217;\n                bool cond_74218;\n                bool defunc_0_neq_res_74219;\n                bool defunc_0_neq_res_74220;\n                bool cond_t_res_f_res_74221;\n                bool y_74222;\n                bool cond_t_res_74223;\n                bool x_74224;\n                int64_t defunc_0_op_res_74225;\n                int16_t defunc_0_op_res_74226;\n                int64_t defunc_0_op_res_74227;\n                int64_t redout_tmp_76659;\n                int16_t redout_tmp_76660;\n                int64_t redout_tmp_76661;\n                \n                x_74205 = ((__local int64_t *) color_76532)[i_75341];\n                x_74206 = ((__local int16_t *) color_76531)[i_75341];\n                defunc_0_neq_res_74214 = redout_75339 == eta_p_74194;\n                defunc_0_neq_res_74215 = !defunc_0_neq_res_74214;\n                cond_f_res_74216 = slt64(redout_75338, (int64_t) 0);\n                y_74217 = defunc_0_neq_res_74214 && cond_f_res_74216;\n                cond_74218 = defunc_0_neq_res_74215 || y_74217;\n                defunc_0_neq_res_74219 = x_74206 == eta_p_74194;\n                defunc_0_neq_res_74220 = !defunc_0_neq_res_74219;\n                cond_t_res_f_res_74221 = slt64(x_74205, (int64_t) 0);\n                y_74222 = defunc_0_neq_res_74219 && cond_t_res_f_res_74221;\n                cond_t_res_74223 = defunc_0_neq_res_74220 || y_74222;\n                x_74224 = cond_74218 && cond_t_res_74223;\n                if (x_74224) {\n                    defunc_0_op_res_74225 = (int64_t) -1;\n                    defunc_0_op_res_74226 = eta_p_74194;\n                    defunc_0_op_res_74227 = (int64_t) 0;\n                } else {\n                    int64_t x_7420", "7;\n                    int64_t defunc_0_op_res_f_res_74228;\n                    int16_t defunc_0_op_res_f_res_74229;\n                    int64_t defunc_0_op_res_f_res_74230;\n                    \n                    x_74207 = ((__local int64_t *) color_76530)[i_75341];\n                    if (cond_74218) {\n                        defunc_0_op_res_f_res_74228 = x_74205;\n                        defunc_0_op_res_f_res_74229 = x_74206;\n                        defunc_0_op_res_f_res_74230 = x_74207;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74231;\n                        int64_t defunc_0_op_res_f_res_f_res_74232;\n                        int64_t defunc_0_op_res_f_res_f_res_74233;\n                        \n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74231 = redout_75339;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74231 = eta_p_74194;\n                        }\n                        if (cond_t_res_74223) {\n                            defunc_0_op_res_f_res_f_res_74232 = redout_75338;\n                            defunc_0_op_res_f_res_f_res_74233 = redout_75340;\n                        } else {\n                            int64_t min_res_74234;\n                            int64_t tmp_74235;\n                            \n                            min_res_74234 = smin64(x_74205, redout_75338);\n                            tmp_74235 = add64(x_74207, redout_75340);\n                            defunc_0_op_res_f_res_f_res_74232 = min_res_74234;\n                            defunc_0_op_res_f_res_f_res_74233 = tmp_74235;\n                        }\n                        defunc_0_op_res_f_res_74228 = defunc_0_op_res_f_res_f_res_74232;\n                        defunc_0_op_res_f_res_74229 = defunc_0_op_res_f_res_f_res_74231;\n                        defunc_0_op_res_f_res_74230 = defunc_0_op_res_f_res_f_res_74233;\n                    }\n         ", "           defunc_0_op_res_74225 = defunc_0_op_res_f_res_74228;\n                    defunc_0_op_res_74226 = defunc_0_op_res_f_res_74229;\n                    defunc_0_op_res_74227 = defunc_0_op_res_f_res_74230;\n                }\n                redout_tmp_76659 = defunc_0_op_res_74225;\n                redout_tmp_76660 = defunc_0_op_res_74226;\n                redout_tmp_76661 = defunc_0_op_res_74227;\n                redout_75338 = redout_tmp_76659;\n                redout_75339 = redout_tmp_76660;\n                redout_75340 = redout_tmp_76661;\n            }\n            x_74202 = redout_75338;\n            x_74203 = redout_75339;\n            x_74204 = redout_75340;\n            acc_74199 = x_74202;\n            acc_74201 = x_74204;\n        } else {\n            acc_74199 = acc_74195;\n            acc_74201 = acc_74197;\n        }\n        mem_75879[(int64_t) 0] = acc_74199;\n        mem_75883[(int64_t) 0] = acc_74201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75885[i_17] = mem_75879[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75884[i_18] = mem_75883[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76662 = ext_mem_75885[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75887)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76662;\n    }\n    if (slt64(sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642), min_res_66402)) {\n        int64_t tmp_76663 = ext_mem_75884[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75889)[sext_i32_i64(local_tid_76641) + tile_sizze_73901 * sext_i32_i64(block_id_76642)] = tmp_76663;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_73901\n    #undef bytes_75849\n    #undef bytes_75851\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_74254_dim1, 1, 1)\nvoid inner_SMJ_sho",
                                    "rtzisegmap_intrablock_74254(__global int *global_failure, int64_t tS_start_64840, int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, int64_t start_66400, int64_t min_res_66402, int64_t ldim_74257, int64_t num_whole_tiles_74272, int64_t residual_input_74496, unsigned char cond_74497_bits, int64_t binop_x_74513, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75767, __global unsigned char *mem_75826, __global unsigned char *mem_75828)\n{\n    bool cond_74497 = cond_74497_bits;\n    \n    #define tile_sizze_74256 (inner_SMJ_shortzisegmap_intrablock_74254zitile_sizze_74256)\n    #define bytes_75788 (inner_SMJ_shortzisegmap_intrablock_74254zibytes_75788)\n    #define bytes_75790 (inner_SMJ_shortzisegmap_intrablock_74254zibytes_75790)\n    \n    volatile __local unsigned char *color_76535_backing_2 = &shared_mem[0];\n    const int64_t color_76535_backing_2_offset = 0 + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76534_backing_1 = &shared_mem[color_76535_backing_2_offset];\n    const int64_t color_76534_backing_1_offset = color_76535_backing_2_offset + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76533_backing_0 = &shared_mem[color_76534_backing_1_offset];\n    const int64_t color_76533_backing_0_offset = color_76534_backing_1_offset + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76667;\n    int32_t tblock_sizze_76670;\n    int32_t wave_sizze_76669;\n    int32_t block_id_76668;\n    int32_t global_tid_76666;\n    int64_t gid_flat_74254;\n    int64_t slice_76672;\n    int64_t ltid_pre_76671;\n    int64_t remnant_76673;\n    int64_t slice_76674;\n    int64_t gid_74253;\n    int64_t remnant_76675;\n    __local unsigned char *color_76533;\n    __local unsign", "ed char *color_76534;\n    __local unsigned char *color_76535;\n    int64_t binop_x_74264;\n    int16_t mem_75772[1];\n    int64_t ltid_flat_74259;\n    int64_t ltid_74258;\n    int64_t gtid_74265;\n    bool cond_74266;\n    int16_t pre_74267;\n    int64_t mem_75776[1];\n    int16_t mem_75780[1];\n    int64_t mem_75784[1];\n    int64_t ltid_flat_74274;\n    int64_t ltid_74273;\n    int64_t gtid_74284;\n    bool cond_74285;\n    int64_t neutral_74286;\n    int16_t neutral_74287;\n    int64_t ext_mem_75808[1];\n    int16_t ext_mem_75807[1];\n    int64_t ext_mem_75806[1];\n    int64_t mem_param_75785[1];\n    int16_t mem_param_75786[1];\n    int64_t mem_param_75787[1];\n    int64_t mem_75818[1];\n    int64_t mem_75822[1];\n    int64_t ext_mem_75824[1];\n    int64_t ext_mem_75823[1];\n    \n    local_tid_76667 = get_local_id(0);\n    tblock_sizze_76670 = get_local_size(0);\n    wave_sizze_76669 = LOCKSTEP_WIDTH;\n    block_id_76668 = get_tblock_id(0);\n    global_tid_76666 = block_id_76668 * tblock_sizze_76670 + local_tid_76667;\n    gid_flat_74254 = sext_i32_i64(block_id_76668);\n    slice_76672 = tile_sizze_74256;\n    ltid_pre_76671 = sext_i32_i64(local_tid_76667);\n    remnant_76673 = sext_i32_i64(local_tid_76667) - ltid_pre_76671;\n    slice_76674 = ldim_74257;\n    gid_74253 = sext_i32_i64(block_id_76668);\n    remnant_76675 = sext_i32_i64(block_id_76668) - gid_74253;\n    color_76533 = (__local unsigned char *) color_76533_backing_0;\n    color_76534 = (__local unsigned char *) color_76534_backing_1;\n    color_76535 = (__local unsigned char *) color_76535_backing_2;\n    binop_x_74264 = gid_74253 * tile_sizze_74256;\n    ltid_flat_74259 = sext_i32_i64(local_tid_76667);\n    ltid_74258 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74265 = ltid_74258 + binop_x_74264;\n    cond_74266 = slt64(gtid_74265, min_res_66402);\n    if (cond_74266) {\n        int64_t slice_74268;\n        int16_t eta_p_74269;\n        \n        slice_74268 = start_66400 + gtid_74265;\n        eta_p_74269 = ((__global int16_t *) tR_me", "m_75467)[slice_74268];\n        pre_74267 = eta_p_74269;\n    } else {\n        pre_74267 = (int16_t) 0;\n    }\n    mem_75772[(int64_t) 0] = pre_74267;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74274 = sext_i32_i64(local_tid_76667);\n    ltid_74273 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n    gtid_74284 = binop_x_74264 + ltid_74273;\n    cond_74285 = slt64(gtid_74284, min_res_66402);\n    if (cond_74285) {\n        neutral_74286 = (int64_t) -1;\n    } else {\n        neutral_74286 = (int64_t) 0;\n    }\n    if (cond_74285) {\n        int16_t eta_p_74289 = mem_75772[(int64_t) 0];\n        \n        neutral_74287 = eta_p_74289;\n    } else {\n        neutral_74287 = (int16_t) 0;\n    }\n    mem_75776[(int64_t) 0] = neutral_74286;\n    mem_75780[(int64_t) 0] = neutral_74287;\n    mem_75784[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75785[i_3] = mem_75776[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75786[i_4] = mem_75780[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75787[i_5] = mem_75784[i_5];\n    for (int64_t tile_id_74299 = 0; tile_id_74299 < num_whole_tiles_74272; tile_id_74299++) {\n        int64_t binop_x_74398;\n        int64_t ltid_flat_74397;\n        int64_t ltid_74396;\n        int64_t j_74399;\n        bool cond_74403;\n        int64_t pre1d_74406;\n        int64_t pre1d_74404;\n        int16_t pre1d_74405;\n        int64_t mem_75797[1];\n        int16_t mem_75801[1];\n        int64_t mem_75805[1];\n        int64_t ltid_flat_74417;\n        int64_t ltid_74416;\n        int64_t gtid_74419;\n        int64_t acc_74421;\n        int16_t acc_74422;\n        int64_t acc_74423;\n        bool cond_74424;\n        int64_t acc_74425;\n        int16_t acc_74426;\n        int64_t acc_74427;\n        int64_t mem_param_tmp_76676[1];\n        int16_t mem_param_tmp_76677[1];\n        int64_t mem_param_tmp_76678[1];\n        \n        binop_x_74398 = tile_si",
                                    "zze_74256 * tile_id_74299;\n        ltid_flat_74397 = sext_i32_i64(local_tid_76667);\n        ltid_74396 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74399 = ltid_74396 + binop_x_74398;\n        cond_74403 = slt64(j_74399, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74406 = btoi_bool_i64(cond_74403);\n        if (cond_74403) {\n            int64_t tile_elem_74407;\n            int64_t slice_75325;\n            int16_t tile_elem_74408;\n            \n            tile_elem_74407 = ((__global int64_t *) ext_mem_75767)[j_74399];\n            slice_75325 = tS_start_64840 + j_74399;\n            tile_elem_74408 = ((__global int16_t *) tS_mem_75468)[slice_75325];\n            pre1d_74404 = tile_elem_74407;\n            pre1d_74405 = tile_elem_74408;\n        } else {\n            pre1d_74404 = (int64_t) 0;\n            pre1d_74405 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74396] = pre1d_74404;\n        ((__local int16_t *) color_76534)[ltid_74396] = pre1d_74405;\n        ((__local int64_t *) color_76533)[ltid_74396] = pre1d_74406;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74417 = sext_i32_i64(local_tid_76667);\n        ltid_74416 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74419 = binop_x_74264 + ltid_74416;\n        acc_74421 = mem_param_75785[(int64_t) 0];\n        acc_74422 = mem_param_75786[(int64_t) 0];\n        acc_74423 = mem_param_75787[(int64_t) 0];\n        cond_74424 = slt64(gtid_74419, min_res_66402);\n        if (cond_74424) {\n            int16_t eta_p_74420;\n            int64_t x_74428;\n            int16_t x_74429;\n            int64_t x_74430;\n            int64_t redout_75342;\n            int16_t redout_75343;\n            int64_t redout_75344;\n            \n            eta_p_74420 = mem_75772[(int64_t) 0];\n            redout_75342 = acc_74421;\n            redout_75343 = acc_74422;\n            redout_75344 = acc_74423;\n            for (int64_t i_75345 = 0; i_75345 < tile_sizze_74256; i_75345++) {", "\n                int64_t x_74431;\n                int16_t x_74432;\n                bool defunc_0_neq_res_74440;\n                bool defunc_0_neq_res_74441;\n                bool cond_f_res_74442;\n                bool y_74443;\n                bool cond_74444;\n                bool defunc_0_neq_res_74445;\n                bool defunc_0_neq_res_74446;\n                bool cond_t_res_f_res_74447;\n                bool y_74448;\n                bool cond_t_res_74449;\n                bool x_74450;\n                int64_t defunc_0_op_res_74451;\n                int16_t defunc_0_op_res_74452;\n                int64_t defunc_0_op_res_74453;\n                int64_t redout_tmp_76682;\n                int16_t redout_tmp_76683;\n                int64_t redout_tmp_76684;\n                \n                x_74431 = ((__local int64_t *) color_76535)[i_75345];\n                x_74432 = ((__local int16_t *) color_76534)[i_75345];\n                defunc_0_neq_res_74440 = redout_75343 == eta_p_74420;\n                defunc_0_neq_res_74441 = !defunc_0_neq_res_74440;\n                cond_f_res_74442 = slt64(redout_75342, (int64_t) 0);\n                y_74443 = defunc_0_neq_res_74440 && cond_f_res_74442;\n                cond_74444 = defunc_0_neq_res_74441 || y_74443;\n                defunc_0_neq_res_74445 = x_74432 == eta_p_74420;\n                defunc_0_neq_res_74446 = !defunc_0_neq_res_74445;\n                cond_t_res_f_res_74447 = slt64(x_74431, (int64_t) 0);\n                y_74448 = defunc_0_neq_res_74445 && cond_t_res_f_res_74447;\n                cond_t_res_74449 = defunc_0_neq_res_74446 || y_74448;\n                x_74450 = cond_74444 && cond_t_res_74449;\n                if (x_74450) {\n                    defunc_0_op_res_74451 = (int64_t) -1;\n                    defunc_0_op_res_74452 = eta_p_74420;\n                    defunc_0_op_res_74453 = (int64_t) 0;\n                } else {\n                    int64_t x_74433;\n                    int64_t defunc_0_op_res_f_res_74454;\n                 ", "   int16_t defunc_0_op_res_f_res_74455;\n                    int64_t defunc_0_op_res_f_res_74456;\n                    \n                    x_74433 = ((__local int64_t *) color_76533)[i_75345];\n                    if (cond_74444) {\n                        defunc_0_op_res_f_res_74454 = x_74431;\n                        defunc_0_op_res_f_res_74455 = x_74432;\n                        defunc_0_op_res_f_res_74456 = x_74433;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74457;\n                        int64_t defunc_0_op_res_f_res_f_res_74458;\n                        int64_t defunc_0_op_res_f_res_f_res_74459;\n                        \n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74457 = redout_75343;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74457 = eta_p_74420;\n                        }\n                        if (cond_t_res_74449) {\n                            defunc_0_op_res_f_res_f_res_74458 = redout_75342;\n                            defunc_0_op_res_f_res_f_res_74459 = redout_75344;\n                        } else {\n                            int64_t min_res_74460;\n                            int64_t tmp_74461;\n                            \n                            min_res_74460 = smin64(x_74431, redout_75342);\n                            tmp_74461 = add64(x_74433, redout_75344);\n                            defunc_0_op_res_f_res_f_res_74458 = min_res_74460;\n                            defunc_0_op_res_f_res_f_res_74459 = tmp_74461;\n                        }\n                        defunc_0_op_res_f_res_74454 = defunc_0_op_res_f_res_f_res_74458;\n                        defunc_0_op_res_f_res_74455 = defunc_0_op_res_f_res_f_res_74457;\n                        defunc_0_op_res_f_res_74456 = defunc_0_op_res_f_res_f_res_74459;\n                    }\n                    defunc_0_op_res_74451 = defunc_0_op_res_f_res_74454;\n             ",
                                    "       defunc_0_op_res_74452 = defunc_0_op_res_f_res_74455;\n                    defunc_0_op_res_74453 = defunc_0_op_res_f_res_74456;\n                }\n                redout_tmp_76682 = defunc_0_op_res_74451;\n                redout_tmp_76683 = defunc_0_op_res_74452;\n                redout_tmp_76684 = defunc_0_op_res_74453;\n                redout_75342 = redout_tmp_76682;\n                redout_75343 = redout_tmp_76683;\n                redout_75344 = redout_tmp_76684;\n            }\n            x_74428 = redout_75342;\n            x_74429 = redout_75343;\n            x_74430 = redout_75344;\n            acc_74425 = x_74428;\n            acc_74426 = x_74429;\n            acc_74427 = x_74430;\n        } else {\n            acc_74425 = acc_74421;\n            acc_74426 = acc_74422;\n            acc_74427 = acc_74423;\n        }\n        mem_75797[(int64_t) 0] = acc_74425;\n        mem_75801[(int64_t) 0] = acc_74426;\n        mem_75805[(int64_t) 0] = acc_74427;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76676[i_6] = mem_75797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76677[i_7] = mem_75801[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76678[i_8] = mem_75805[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75785[i_9] = mem_param_tmp_76676[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75786[i_10] = mem_param_tmp_76677[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75787[i_11] = mem_param_tmp_76678[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75808[i_12] = mem_param_75785[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75807[i_13] = mem_param_75786[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75806[i_14] = mem_param_75787[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74497) {\n        for (in", "t32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75824[i_15] = ext_mem_75808[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75823[i_16] = ext_mem_75806[i_16];\n    } else {\n        int64_t ltid_flat_74499;\n        int64_t ltid_74498;\n        int64_t j_74514;\n        bool cond_74518;\n        int64_t pre1d_74521;\n        int64_t pre1d_74519;\n        int16_t pre1d_74520;\n        int64_t ltid_flat_74535;\n        int64_t ltid_74534;\n        int64_t gtid_74548;\n        int64_t acc_74550;\n        int64_t acc_74552;\n        bool cond_74553;\n        int64_t acc_74554;\n        int64_t acc_74556;\n        \n        ltid_flat_74499 = sext_i32_i64(local_tid_76667);\n        ltid_74498 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        j_74514 = ltid_74498 + binop_x_74513;\n        cond_74518 = slt64(j_74514, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);\n        pre1d_74521 = btoi_bool_i64(cond_74518);\n        if (cond_74518) {\n            int64_t tile_elem_74522;\n            int64_t slice_75324;\n            int16_t tile_elem_74523;\n            \n            tile_elem_74522 = ((__global int64_t *) ext_mem_75767)[j_74514];\n            slice_75324 = tS_start_64840 + j_74514;\n            tile_elem_74523 = ((__global int16_t *) tS_mem_75468)[slice_75324];\n            pre1d_74519 = tile_elem_74522;\n            pre1d_74520 = tile_elem_74523;\n        } else {\n            pre1d_74519 = (int64_t) 0;\n            pre1d_74520 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76535)[ltid_74498] = pre1d_74519;\n        ((__local int16_t *) color_76534)[ltid_74498] = pre1d_74520;\n        ((__local int64_t *) color_76533)[ltid_74498] = pre1d_74521;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74535 = sext_i32_i64(local_tid_76667);\n        ltid_74534 = sext_i32_i64(sext_i64_i32(ltid_pre_76671));\n        gtid_74548 = binop_x_74264 + ltid_74534;\n        acc_74550 = ext_mem_75808[(int64_t) 0];\n        acc_74552 = ext_mem_75806[(int64_t) 0];\n    ", "    cond_74553 = slt64(gtid_74548, min_res_66402);\n        if (cond_74553) {\n            int16_t eta_p_74549;\n            int16_t acc_74551;\n            int64_t x_74557;\n            int16_t x_74558;\n            int64_t x_74559;\n            int64_t redout_75346;\n            int16_t redout_75347;\n            int64_t redout_75348;\n            \n            eta_p_74549 = mem_75772[(int64_t) 0];\n            acc_74551 = ext_mem_75807[(int64_t) 0];\n            redout_75346 = acc_74550;\n            redout_75347 = acc_74551;\n            redout_75348 = acc_74552;\n            for (int64_t i_75349 = 0; i_75349 < residual_input_74496; i_75349++) {\n                int64_t x_74560;\n                int16_t x_74561;\n                bool defunc_0_neq_res_74569;\n                bool defunc_0_neq_res_74570;\n                bool cond_f_res_74571;\n                bool y_74572;\n                bool cond_74573;\n                bool defunc_0_neq_res_74574;\n                bool defunc_0_neq_res_74575;\n                bool cond_t_res_f_res_74576;\n                bool y_74577;\n                bool cond_t_res_74578;\n                bool x_74579;\n                int64_t defunc_0_op_res_74580;\n                int16_t defunc_0_op_res_74581;\n                int64_t defunc_0_op_res_74582;\n                int64_t redout_tmp_76685;\n                int16_t redout_tmp_76686;\n                int64_t redout_tmp_76687;\n                \n                x_74560 = ((__local int64_t *) color_76535)[i_75349];\n                x_74561 = ((__local int16_t *) color_76534)[i_75349];\n                defunc_0_neq_res_74569 = redout_75347 == eta_p_74549;\n                defunc_0_neq_res_74570 = !defunc_0_neq_res_74569;\n                cond_f_res_74571 = slt64(redout_75346, (int64_t) 0);\n                y_74572 = defunc_0_neq_res_74569 && cond_f_res_74571;\n                cond_74573 = defunc_0_neq_res_74570 || y_74572;\n                defunc_0_neq_res_74574 = x_74561 == eta_p_74549;\n                defunc_0_neq_res_74575",
                                    " = !defunc_0_neq_res_74574;\n                cond_t_res_f_res_74576 = slt64(x_74560, (int64_t) 0);\n                y_74577 = defunc_0_neq_res_74574 && cond_t_res_f_res_74576;\n                cond_t_res_74578 = defunc_0_neq_res_74575 || y_74577;\n                x_74579 = cond_74573 && cond_t_res_74578;\n                if (x_74579) {\n                    defunc_0_op_res_74580 = (int64_t) -1;\n                    defunc_0_op_res_74581 = eta_p_74549;\n                    defunc_0_op_res_74582 = (int64_t) 0;\n                } else {\n                    int64_t x_74562;\n                    int64_t defunc_0_op_res_f_res_74583;\n                    int16_t defunc_0_op_res_f_res_74584;\n                    int64_t defunc_0_op_res_f_res_74585;\n                    \n                    x_74562 = ((__local int64_t *) color_76533)[i_75349];\n                    if (cond_74573) {\n                        defunc_0_op_res_f_res_74583 = x_74560;\n                        defunc_0_op_res_f_res_74584 = x_74561;\n                        defunc_0_op_res_f_res_74585 = x_74562;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74586;\n                        int64_t defunc_0_op_res_f_res_f_res_74587;\n                        int64_t defunc_0_op_res_f_res_f_res_74588;\n                        \n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74586 = redout_75347;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74586 = eta_p_74549;\n                        }\n                        if (cond_t_res_74578) {\n                            defunc_0_op_res_f_res_f_res_74587 = redout_75346;\n                            defunc_0_op_res_f_res_f_res_74588 = redout_75348;\n                        } else {\n                            int64_t min_res_74589;\n                            int64_t tmp_74590;\n                            \n                            min_res_74589 = smin64(x_74560,", " redout_75346);\n                            tmp_74590 = add64(x_74562, redout_75348);\n                            defunc_0_op_res_f_res_f_res_74587 = min_res_74589;\n                            defunc_0_op_res_f_res_f_res_74588 = tmp_74590;\n                        }\n                        defunc_0_op_res_f_res_74583 = defunc_0_op_res_f_res_f_res_74587;\n                        defunc_0_op_res_f_res_74584 = defunc_0_op_res_f_res_f_res_74586;\n                        defunc_0_op_res_f_res_74585 = defunc_0_op_res_f_res_f_res_74588;\n                    }\n                    defunc_0_op_res_74580 = defunc_0_op_res_f_res_74583;\n                    defunc_0_op_res_74581 = defunc_0_op_res_f_res_74584;\n                    defunc_0_op_res_74582 = defunc_0_op_res_f_res_74585;\n                }\n                redout_tmp_76685 = defunc_0_op_res_74580;\n                redout_tmp_76686 = defunc_0_op_res_74581;\n                redout_tmp_76687 = defunc_0_op_res_74582;\n                redout_75346 = redout_tmp_76685;\n                redout_75347 = redout_tmp_76686;\n                redout_75348 = redout_tmp_76687;\n            }\n            x_74557 = redout_75346;\n            x_74558 = redout_75347;\n            x_74559 = redout_75348;\n            acc_74554 = x_74557;\n            acc_74556 = x_74559;\n        } else {\n            acc_74554 = acc_74550;\n            acc_74556 = acc_74552;\n        }\n        mem_75818[(int64_t) 0] = acc_74554;\n        mem_75822[(int64_t) 0] = acc_74556;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75824[i_17] = mem_75818[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75823[i_18] = mem_75822[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76688 = ext_mem_75824[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75826)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * ", "sext_i32_i64(block_id_76668)] = tmp_76688;\n    }\n    if (slt64(sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668), min_res_66402)) {\n        int64_t tmp_76689 = ext_mem_75823[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75828)[sext_i32_i64(local_tid_76667) + tile_sizze_74256 * sext_i32_i64(block_id_76668)] = tmp_76689;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74256\n    #undef bytes_75788\n    #undef bytes_75790\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_74609_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_74609(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74612, int64_t num_whole_tiles_74627, int64_t residual_input_74851, unsigned char cond_74852_bits, int64_t binop_x_74868, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75682, __global unsigned char *mem_75684)\n{\n    bool cond_74852 = cond_74852_bits;\n    \n    #define tile_sizze_74611 (inner_SMJ_shortzisegmap_intrablock_74609zitile_sizze_74611)\n    #define bytes_75644 (inner_SMJ_shortzisegmap_intrablock_74609zibytes_75644)\n    #define bytes_75646 (inner_SMJ_shortzisegmap_intrablock_74609zibytes_75646)\n    \n    volatile __local unsigned char *color_76538_backing_2 = &shared_mem[0];\n    const int64_t color_76538_backing_2_offset = 0 + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76537_backing_1 = &shared_mem[color_76538_backing_2_offset];\n    const int64_t color_76537_backing_1_offset = color_76538_backing_2_offset + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76536_backing_0 = &shared_mem[color_76537_backing_1_offset];\n    const int64_t color_76536_backing_0_offset = color_76537_backing_1_offset + (bytes",
                                    "_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76808;\n    int32_t tblock_sizze_76811;\n    int32_t wave_sizze_76810;\n    int32_t block_id_76809;\n    int32_t global_tid_76807;\n    int64_t gid_flat_74609;\n    int64_t slice_76813;\n    int64_t ltid_pre_76812;\n    int64_t remnant_76814;\n    int64_t slice_76815;\n    int64_t gid_74608;\n    int64_t remnant_76816;\n    __local unsigned char *color_76536;\n    __local unsigned char *color_76537;\n    __local unsigned char *color_76538;\n    int64_t binop_x_74619;\n    int16_t mem_75628[1];\n    int64_t ltid_flat_74614;\n    int64_t ltid_74613;\n    int64_t gtid_74620;\n    bool cond_74621;\n    int16_t pre_74622;\n    int64_t mem_75632[1];\n    int16_t mem_75636[1];\n    int64_t mem_75640[1];\n    int64_t ltid_flat_74629;\n    int64_t ltid_74628;\n    int64_t gtid_74639;\n    bool cond_74640;\n    int64_t neutral_74641;\n    int16_t neutral_74642;\n    int64_t ext_mem_75664[1];\n    int16_t ext_mem_75663[1];\n    int64_t ext_mem_75662[1];\n    int64_t mem_param_75641[1];\n    int16_t mem_param_75642[1];\n    int64_t mem_param_75643[1];\n    int64_t mem_75674[1];\n    int64_t mem_75678[1];\n    int64_t ext_mem_75680[1];\n    int64_t ext_mem_75679[1];\n    \n    local_tid_76808 = get_local_id(0);\n    tblock_sizze_76811 = get_local_size(0);\n    wave_sizze_76810 = LOCKSTEP_WIDTH;\n    block_id_76809 = get_tblock_id(0);\n    global_tid_76807 = block_id_76809 * tblock_sizze_76811 + local_tid_76808;\n    gid_flat_74609 = sext_i32_i64(block_id_76809);\n    slice_76813 = tile_sizze_74611;\n    ltid_pre_76812 = sext_i32_i64(local_tid_76808);\n    remnant_76814 = sext_i32_i64(local_tid_76808) - ltid_pre_76812;\n    slice_76815 = ldim_74612;\n    gid_74608 = sext_i32_i64(block_id_76809);\n    remnant_76816 = sext_i32_i64(block_id_76809) - gid_74608;\n    color_76536 = (__local unsigned char *) color_76536_backing_0;\n    color_76537 = (__local unsigned char *) color_76537", "_backing_1;\n    color_76538 = (__local unsigned char *) color_76538_backing_2;\n    binop_x_74619 = gid_74608 * tile_sizze_74611;\n    ltid_flat_74614 = sext_i32_i64(local_tid_76808);\n    ltid_74613 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74620 = ltid_74613 + binop_x_74619;\n    cond_74621 = slt64(gtid_74620, min_res_65540);\n    if (cond_74621) {\n        int64_t slice_74623;\n        int16_t eta_p_74624;\n        \n        slice_74623 = slice_65554 + gtid_74620;\n        eta_p_74624 = ((__global int16_t *) tR_mem_75467)[slice_74623];\n        pre_74622 = eta_p_74624;\n    } else {\n        pre_74622 = (int16_t) 0;\n    }\n    mem_75628[(int64_t) 0] = pre_74622;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74629 = sext_i32_i64(local_tid_76808);\n    ltid_74628 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n    gtid_74639 = binop_x_74619 + ltid_74628;\n    cond_74640 = slt64(gtid_74639, min_res_65540);\n    if (cond_74640) {\n        neutral_74641 = (int64_t) -1;\n    } else {\n        neutral_74641 = (int64_t) 0;\n    }\n    if (cond_74640) {\n        int16_t eta_p_74644 = mem_75628[(int64_t) 0];\n        \n        neutral_74642 = eta_p_74644;\n    } else {\n        neutral_74642 = (int16_t) 0;\n    }\n    mem_75632[(int64_t) 0] = neutral_74641;\n    mem_75636[(int64_t) 0] = neutral_74642;\n    mem_75640[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75641[i_3] = mem_75632[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_75642[i_4] = mem_75636[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75643[i_5] = mem_75640[i_5];\n    for (int64_t tile_id_74654 = 0; tile_id_74654 < num_whole_tiles_74627; tile_id_74654++) {\n        int64_t binop_x_74753;\n        int64_t ltid_flat_74752;\n        int64_t ltid_74751;\n        int64_t j_74754;\n        bool cond_74758;\n        int64_t pre1d_74761;\n        int64_t pre1d_74759;\n        int16_t pre1d_74760;\n ", "       int64_t mem_75653[1];\n        int16_t mem_75657[1];\n        int64_t mem_75661[1];\n        int64_t ltid_flat_74772;\n        int64_t ltid_74771;\n        int64_t gtid_74774;\n        int64_t acc_74776;\n        int16_t acc_74777;\n        int64_t acc_74778;\n        bool cond_74779;\n        int64_t acc_74780;\n        int16_t acc_74781;\n        int64_t acc_74782;\n        int64_t mem_param_tmp_76817[1];\n        int16_t mem_param_tmp_76818[1];\n        int64_t mem_param_tmp_76819[1];\n        \n        binop_x_74753 = tile_sizze_74611 * tile_id_74654;\n        ltid_flat_74752 = sext_i32_i64(local_tid_76808);\n        ltid_74751 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74754 = ltid_74751 + binop_x_74753;\n        cond_74758 = slt64(j_74754, j_m_i_65502);\n        pre1d_74761 = btoi_bool_i64(cond_74758);\n        if (cond_74758) {\n            int64_t tile_elem_74762;\n            int64_t slice_75329;\n            int16_t tile_elem_74763;\n            \n            tile_elem_74762 = ((__global int64_t *) ext_mem_75562)[j_74754];\n            slice_75329 = slice_65911 + j_74754;\n            tile_elem_74763 = ((__global int16_t *) tS_mem_75468)[slice_75329];\n            pre1d_74759 = tile_elem_74762;\n            pre1d_74760 = tile_elem_74763;\n        } else {\n            pre1d_74759 = (int64_t) 0;\n            pre1d_74760 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74751] = pre1d_74759;\n        ((__local int16_t *) color_76537)[ltid_74751] = pre1d_74760;\n        ((__local int64_t *) color_76536)[ltid_74751] = pre1d_74761;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74772 = sext_i32_i64(local_tid_76808);\n        ltid_74771 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74774 = binop_x_74619 + ltid_74771;\n        acc_74776 = mem_param_75641[(int64_t) 0];\n        acc_74777 = mem_param_75642[(int64_t) 0];\n        acc_74778 = mem_param_75643[(int64_t) 0];\n        cond_74779 = slt64(gtid_74774, min_res_65540);\n        if (cond_",
                                    "74779) {\n            int16_t eta_p_74775;\n            int64_t x_74783;\n            int16_t x_74784;\n            int64_t x_74785;\n            int64_t redout_75350;\n            int16_t redout_75351;\n            int64_t redout_75352;\n            \n            eta_p_74775 = mem_75628[(int64_t) 0];\n            redout_75350 = acc_74776;\n            redout_75351 = acc_74777;\n            redout_75352 = acc_74778;\n            for (int64_t i_75353 = 0; i_75353 < tile_sizze_74611; i_75353++) {\n                int64_t x_74786;\n                int16_t x_74787;\n                bool defunc_0_neq_res_74795;\n                bool defunc_0_neq_res_74796;\n                bool cond_f_res_74797;\n                bool y_74798;\n                bool cond_74799;\n                bool defunc_0_neq_res_74800;\n                bool defunc_0_neq_res_74801;\n                bool cond_t_res_f_res_74802;\n                bool y_74803;\n                bool cond_t_res_74804;\n                bool x_74805;\n                int64_t defunc_0_op_res_74806;\n                int16_t defunc_0_op_res_74807;\n                int64_t defunc_0_op_res_74808;\n                int64_t redout_tmp_76823;\n                int16_t redout_tmp_76824;\n                int64_t redout_tmp_76825;\n                \n                x_74786 = ((__local int64_t *) color_76538)[i_75353];\n                x_74787 = ((__local int16_t *) color_76537)[i_75353];\n                defunc_0_neq_res_74795 = redout_75351 == eta_p_74775;\n                defunc_0_neq_res_74796 = !defunc_0_neq_res_74795;\n                cond_f_res_74797 = slt64(redout_75350, (int64_t) 0);\n                y_74798 = defunc_0_neq_res_74795 && cond_f_res_74797;\n                cond_74799 = defunc_0_neq_res_74796 || y_74798;\n                defunc_0_neq_res_74800 = x_74787 == eta_p_74775;\n                defunc_0_neq_res_74801 = !defunc_0_neq_res_74800;\n                cond_t_res_f_res_74802 = slt64(x_74786, (int64_t) 0);\n                y_74803 = defunc_0_neq_res_74800 && cond_", "t_res_f_res_74802;\n                cond_t_res_74804 = defunc_0_neq_res_74801 || y_74803;\n                x_74805 = cond_74799 && cond_t_res_74804;\n                if (x_74805) {\n                    defunc_0_op_res_74806 = (int64_t) -1;\n                    defunc_0_op_res_74807 = eta_p_74775;\n                    defunc_0_op_res_74808 = (int64_t) 0;\n                } else {\n                    int64_t x_74788;\n                    int64_t defunc_0_op_res_f_res_74809;\n                    int16_t defunc_0_op_res_f_res_74810;\n                    int64_t defunc_0_op_res_f_res_74811;\n                    \n                    x_74788 = ((__local int64_t *) color_76536)[i_75353];\n                    if (cond_74799) {\n                        defunc_0_op_res_f_res_74809 = x_74786;\n                        defunc_0_op_res_f_res_74810 = x_74787;\n                        defunc_0_op_res_f_res_74811 = x_74788;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74812;\n                        int64_t defunc_0_op_res_f_res_f_res_74813;\n                        int64_t defunc_0_op_res_f_res_f_res_74814;\n                        \n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74812 = redout_75351;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74812 = eta_p_74775;\n                        }\n                        if (cond_t_res_74804) {\n                            defunc_0_op_res_f_res_f_res_74813 = redout_75350;\n                            defunc_0_op_res_f_res_f_res_74814 = redout_75352;\n                        } else {\n                            int64_t min_res_74815;\n                            int64_t tmp_74816;\n                            \n                            min_res_74815 = smin64(x_74786, redout_75350);\n                            tmp_74816 = add64(x_74788, redout_75352);\n                            defunc_0_op_res_f_res_f_res_74813 = min_r", "es_74815;\n                            defunc_0_op_res_f_res_f_res_74814 = tmp_74816;\n                        }\n                        defunc_0_op_res_f_res_74809 = defunc_0_op_res_f_res_f_res_74813;\n                        defunc_0_op_res_f_res_74810 = defunc_0_op_res_f_res_f_res_74812;\n                        defunc_0_op_res_f_res_74811 = defunc_0_op_res_f_res_f_res_74814;\n                    }\n                    defunc_0_op_res_74806 = defunc_0_op_res_f_res_74809;\n                    defunc_0_op_res_74807 = defunc_0_op_res_f_res_74810;\n                    defunc_0_op_res_74808 = defunc_0_op_res_f_res_74811;\n                }\n                redout_tmp_76823 = defunc_0_op_res_74806;\n                redout_tmp_76824 = defunc_0_op_res_74807;\n                redout_tmp_76825 = defunc_0_op_res_74808;\n                redout_75350 = redout_tmp_76823;\n                redout_75351 = redout_tmp_76824;\n                redout_75352 = redout_tmp_76825;\n            }\n            x_74783 = redout_75350;\n            x_74784 = redout_75351;\n            x_74785 = redout_75352;\n            acc_74780 = x_74783;\n            acc_74781 = x_74784;\n            acc_74782 = x_74785;\n        } else {\n            acc_74780 = acc_74776;\n            acc_74781 = acc_74777;\n            acc_74782 = acc_74778;\n        }\n        mem_75653[(int64_t) 0] = acc_74780;\n        mem_75657[(int64_t) 0] = acc_74781;\n        mem_75661[(int64_t) 0] = acc_74782;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_76817[i_6] = mem_75653[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76818[i_7] = mem_75657[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76819[i_8] = mem_75661[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75641[i_9] = mem_param_tmp_76817[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75642[i_10] = mem_param_tmp_76818[i_10",
                                    "];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75643[i_11] = mem_param_tmp_76819[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75664[i_12] = mem_param_75641[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75663[i_13] = mem_param_75642[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75662[i_14] = mem_param_75643[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_74852) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75680[i_15] = ext_mem_75664[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75679[i_16] = ext_mem_75662[i_16];\n    } else {\n        int64_t ltid_flat_74854;\n        int64_t ltid_74853;\n        int64_t j_74869;\n        bool cond_74873;\n        int64_t pre1d_74876;\n        int64_t pre1d_74874;\n        int16_t pre1d_74875;\n        int64_t ltid_flat_74890;\n        int64_t ltid_74889;\n        int64_t gtid_74903;\n        int64_t acc_74905;\n        int64_t acc_74907;\n        bool cond_74908;\n        int64_t acc_74909;\n        int64_t acc_74911;\n        \n        ltid_flat_74854 = sext_i32_i64(local_tid_76808);\n        ltid_74853 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        j_74869 = ltid_74853 + binop_x_74868;\n        cond_74873 = slt64(j_74869, j_m_i_65502);\n        pre1d_74876 = btoi_bool_i64(cond_74873);\n        if (cond_74873) {\n            int64_t tile_elem_74877;\n            int64_t slice_75328;\n            int16_t tile_elem_74878;\n            \n            tile_elem_74877 = ((__global int64_t *) ext_mem_75562)[j_74869];\n            slice_75328 = slice_65911 + j_74869;\n            tile_elem_74878 = ((__global int16_t *) tS_mem_75468)[slice_75328];\n            pre1d_74874 = tile_elem_74877;\n            pre1d_74875 = tile_elem_74878;\n        } else {\n            pre1d_74874 = (int64_t) 0;\n            pre1d_74875 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76538)[ltid_74853] = pre1d_74874;\n", "        ((__local int16_t *) color_76537)[ltid_74853] = pre1d_74875;\n        ((__local int64_t *) color_76536)[ltid_74853] = pre1d_74876;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_74890 = sext_i32_i64(local_tid_76808);\n        ltid_74889 = sext_i32_i64(sext_i64_i32(ltid_pre_76812));\n        gtid_74903 = binop_x_74619 + ltid_74889;\n        acc_74905 = ext_mem_75664[(int64_t) 0];\n        acc_74907 = ext_mem_75662[(int64_t) 0];\n        cond_74908 = slt64(gtid_74903, min_res_65540);\n        if (cond_74908) {\n            int16_t eta_p_74904;\n            int16_t acc_74906;\n            int64_t x_74912;\n            int16_t x_74913;\n            int64_t x_74914;\n            int64_t redout_75354;\n            int16_t redout_75355;\n            int64_t redout_75356;\n            \n            eta_p_74904 = mem_75628[(int64_t) 0];\n            acc_74906 = ext_mem_75663[(int64_t) 0];\n            redout_75354 = acc_74905;\n            redout_75355 = acc_74906;\n            redout_75356 = acc_74907;\n            for (int64_t i_75357 = 0; i_75357 < residual_input_74851; i_75357++) {\n                int64_t x_74915;\n                int16_t x_74916;\n                bool defunc_0_neq_res_74924;\n                bool defunc_0_neq_res_74925;\n                bool cond_f_res_74926;\n                bool y_74927;\n                bool cond_74928;\n                bool defunc_0_neq_res_74929;\n                bool defunc_0_neq_res_74930;\n                bool cond_t_res_f_res_74931;\n                bool y_74932;\n                bool cond_t_res_74933;\n                bool x_74934;\n                int64_t defunc_0_op_res_74935;\n                int16_t defunc_0_op_res_74936;\n                int64_t defunc_0_op_res_74937;\n                int64_t redout_tmp_76826;\n                int16_t redout_tmp_76827;\n                int64_t redout_tmp_76828;\n                \n                x_74915 = ((__local int64_t *) color_76538)[i_75357];\n                x_74916 = ((__local int16_t *) color_76537)[i_753", "57];\n                defunc_0_neq_res_74924 = redout_75355 == eta_p_74904;\n                defunc_0_neq_res_74925 = !defunc_0_neq_res_74924;\n                cond_f_res_74926 = slt64(redout_75354, (int64_t) 0);\n                y_74927 = defunc_0_neq_res_74924 && cond_f_res_74926;\n                cond_74928 = defunc_0_neq_res_74925 || y_74927;\n                defunc_0_neq_res_74929 = x_74916 == eta_p_74904;\n                defunc_0_neq_res_74930 = !defunc_0_neq_res_74929;\n                cond_t_res_f_res_74931 = slt64(x_74915, (int64_t) 0);\n                y_74932 = defunc_0_neq_res_74929 && cond_t_res_f_res_74931;\n                cond_t_res_74933 = defunc_0_neq_res_74930 || y_74932;\n                x_74934 = cond_74928 && cond_t_res_74933;\n                if (x_74934) {\n                    defunc_0_op_res_74935 = (int64_t) -1;\n                    defunc_0_op_res_74936 = eta_p_74904;\n                    defunc_0_op_res_74937 = (int64_t) 0;\n                } else {\n                    int64_t x_74917;\n                    int64_t defunc_0_op_res_f_res_74938;\n                    int16_t defunc_0_op_res_f_res_74939;\n                    int64_t defunc_0_op_res_f_res_74940;\n                    \n                    x_74917 = ((__local int64_t *) color_76536)[i_75357];\n                    if (cond_74928) {\n                        defunc_0_op_res_f_res_74938 = x_74915;\n                        defunc_0_op_res_f_res_74939 = x_74916;\n                        defunc_0_op_res_f_res_74940 = x_74917;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_74941;\n                        int64_t defunc_0_op_res_f_res_f_res_74942;\n                        int64_t defunc_0_op_res_f_res_f_res_74943;\n                        \n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74941 = redout_75355;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_74941 = eta_p_74904;\n  ",
                                    "                      }\n                        if (cond_t_res_74933) {\n                            defunc_0_op_res_f_res_f_res_74942 = redout_75354;\n                            defunc_0_op_res_f_res_f_res_74943 = redout_75356;\n                        } else {\n                            int64_t min_res_74944;\n                            int64_t tmp_74945;\n                            \n                            min_res_74944 = smin64(x_74915, redout_75354);\n                            tmp_74945 = add64(x_74917, redout_75356);\n                            defunc_0_op_res_f_res_f_res_74942 = min_res_74944;\n                            defunc_0_op_res_f_res_f_res_74943 = tmp_74945;\n                        }\n                        defunc_0_op_res_f_res_74938 = defunc_0_op_res_f_res_f_res_74942;\n                        defunc_0_op_res_f_res_74939 = defunc_0_op_res_f_res_f_res_74941;\n                        defunc_0_op_res_f_res_74940 = defunc_0_op_res_f_res_f_res_74943;\n                    }\n                    defunc_0_op_res_74935 = defunc_0_op_res_f_res_74938;\n                    defunc_0_op_res_74936 = defunc_0_op_res_f_res_74939;\n                    defunc_0_op_res_74937 = defunc_0_op_res_f_res_74940;\n                }\n                redout_tmp_76826 = defunc_0_op_res_74935;\n                redout_tmp_76827 = defunc_0_op_res_74936;\n                redout_tmp_76828 = defunc_0_op_res_74937;\n                redout_75354 = redout_tmp_76826;\n                redout_75355 = redout_tmp_76827;\n                redout_75356 = redout_tmp_76828;\n            }\n            x_74912 = redout_75354;\n            x_74913 = redout_75355;\n            x_74914 = redout_75356;\n            acc_74909 = x_74912;\n            acc_74911 = x_74914;\n        } else {\n            acc_74909 = acc_74905;\n            acc_74911 = acc_74907;\n        }\n        mem_75674[(int64_t) 0] = acc_74909;\n        mem_75678[(int64_t) 0] = acc_74911;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0", "; i_17 < 1; i_17++)\n            ext_mem_75680[i_17] = mem_75674[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75679[i_18] = mem_75678[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76829 = ext_mem_75680[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75682)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76829;\n    }\n    if (slt64(sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809), min_res_65540)) {\n        int64_t tmp_76830 = ext_mem_75679[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75684)[sext_i32_i64(local_tid_76808) + tile_sizze_74611 * sext_i32_i64(block_id_76809)] = tmp_76830;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74611\n    #undef bytes_75644\n    #undef bytes_75646\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegmap_intrablock_74964_dim1, 1, 1)\nvoid inner_SMJ_shortzisegmap_intrablock_74964(__global int *global_failure, int64_t j_m_i_65502, int64_t min_res_65540, int64_t slice_65554, int64_t slice_65911, int64_t ldim_74967, int64_t num_whole_tiles_74982, int64_t residual_input_75206, unsigned char cond_75207_bits, int64_t binop_x_75223, __global unsigned char *tR_mem_75467, __global unsigned char *tS_mem_75468, __global unsigned char *ext_mem_75562, __global unsigned char *mem_75621, __global unsigned char *mem_75623)\n{\n    bool cond_75207 = cond_75207_bits;\n    \n    #define tile_sizze_74966 (inner_SMJ_shortzisegmap_intrablock_74964zitile_sizze_74966)\n    #define bytes_75583 (inner_SMJ_shortzisegmap_intrablock_74964zibytes_75583)\n    #define bytes_75585 (inner_SMJ_shortzisegmap_intrablock_74964zibytes_75585)\n    \n    volatile __local unsigned char *color_76541_backing_2 = &shared_mem[0];\n    const int64_t color_76541_backing_2_offset = 0 + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    volati", "le __local unsigned char *color_76540_backing_1 = &shared_mem[color_76541_backing_2_offset];\n    const int64_t color_76540_backing_1_offset = color_76541_backing_2_offset + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_76539_backing_0 = &shared_mem[color_76540_backing_1_offset];\n    const int64_t color_76539_backing_0_offset = color_76540_backing_1_offset + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76834;\n    int32_t tblock_sizze_76837;\n    int32_t wave_sizze_76836;\n    int32_t block_id_76835;\n    int32_t global_tid_76833;\n    int64_t gid_flat_74964;\n    int64_t slice_76839;\n    int64_t ltid_pre_76838;\n    int64_t remnant_76840;\n    int64_t slice_76841;\n    int64_t gid_74963;\n    int64_t remnant_76842;\n    __local unsigned char *color_76539;\n    __local unsigned char *color_76540;\n    __local unsigned char *color_76541;\n    int64_t binop_x_74974;\n    int16_t mem_75567[1];\n    int64_t ltid_flat_74969;\n    int64_t ltid_74968;\n    int64_t gtid_74975;\n    bool cond_74976;\n    int16_t pre_74977;\n    int64_t mem_75571[1];\n    int16_t mem_75575[1];\n    int64_t mem_75579[1];\n    int64_t ltid_flat_74984;\n    int64_t ltid_74983;\n    int64_t gtid_74994;\n    bool cond_74995;\n    int64_t neutral_74996;\n    int16_t neutral_74997;\n    int64_t ext_mem_75603[1];\n    int16_t ext_mem_75602[1];\n    int64_t ext_mem_75601[1];\n    int64_t mem_param_75580[1];\n    int16_t mem_param_75581[1];\n    int64_t mem_param_75582[1];\n    int64_t mem_75613[1];\n    int64_t mem_75617[1];\n    int64_t ext_mem_75619[1];\n    int64_t ext_mem_75618[1];\n    \n    local_tid_76834 = get_local_id(0);\n    tblock_sizze_76837 = get_local_size(0);\n    wave_sizze_76836 = LOCKSTEP_WIDTH;\n    block_id_76835 = get_tblock_id(0);\n    global_tid_76833 = block_id_76835 * tblock_sizze_76837 + local_tid_76834;\n    gid_flat_74964 =",
                                    " sext_i32_i64(block_id_76835);\n    slice_76839 = tile_sizze_74966;\n    ltid_pre_76838 = sext_i32_i64(local_tid_76834);\n    remnant_76840 = sext_i32_i64(local_tid_76834) - ltid_pre_76838;\n    slice_76841 = ldim_74967;\n    gid_74963 = sext_i32_i64(block_id_76835);\n    remnant_76842 = sext_i32_i64(block_id_76835) - gid_74963;\n    color_76539 = (__local unsigned char *) color_76539_backing_0;\n    color_76540 = (__local unsigned char *) color_76540_backing_1;\n    color_76541 = (__local unsigned char *) color_76541_backing_2;\n    binop_x_74974 = gid_74963 * tile_sizze_74966;\n    ltid_flat_74969 = sext_i32_i64(local_tid_76834);\n    ltid_74968 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74975 = ltid_74968 + binop_x_74974;\n    cond_74976 = slt64(gtid_74975, min_res_65540);\n    if (cond_74976) {\n        int64_t slice_74978;\n        int16_t eta_p_74979;\n        \n        slice_74978 = slice_65554 + gtid_74975;\n        eta_p_74979 = ((__global int16_t *) tR_mem_75467)[slice_74978];\n        pre_74977 = eta_p_74979;\n    } else {\n        pre_74977 = (int16_t) 0;\n    }\n    mem_75567[(int64_t) 0] = pre_74977;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_74984 = sext_i32_i64(local_tid_76834);\n    ltid_74983 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n    gtid_74994 = binop_x_74974 + ltid_74983;\n    cond_74995 = slt64(gtid_74994, min_res_65540);\n    if (cond_74995) {\n        neutral_74996 = (int64_t) -1;\n    } else {\n        neutral_74996 = (int64_t) 0;\n    }\n    if (cond_74995) {\n        int16_t eta_p_74999 = mem_75567[(int64_t) 0];\n        \n        neutral_74997 = eta_p_74999;\n    } else {\n        neutral_74997 = (int16_t) 0;\n    }\n    mem_75571[(int64_t) 0] = neutral_74996;\n    mem_75575[(int64_t) 0] = neutral_74997;\n    mem_75579[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_75580[i_3] = mem_75571[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_p", "aram_75581[i_4] = mem_75575[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_75582[i_5] = mem_75579[i_5];\n    for (int64_t tile_id_75009 = 0; tile_id_75009 < num_whole_tiles_74982; tile_id_75009++) {\n        int64_t binop_x_75108;\n        int64_t ltid_flat_75107;\n        int64_t ltid_75106;\n        int64_t j_75109;\n        bool cond_75113;\n        int64_t pre1d_75116;\n        int64_t pre1d_75114;\n        int16_t pre1d_75115;\n        int64_t mem_75592[1];\n        int16_t mem_75596[1];\n        int64_t mem_75600[1];\n        int64_t ltid_flat_75127;\n        int64_t ltid_75126;\n        int64_t gtid_75129;\n        int64_t acc_75131;\n        int16_t acc_75132;\n        int64_t acc_75133;\n        bool cond_75134;\n        int64_t acc_75135;\n        int16_t acc_75136;\n        int64_t acc_75137;\n        int64_t mem_param_tmp_76843[1];\n        int16_t mem_param_tmp_76844[1];\n        int64_t mem_param_tmp_76845[1];\n        \n        binop_x_75108 = tile_sizze_74966 * tile_id_75009;\n        ltid_flat_75107 = sext_i32_i64(local_tid_76834);\n        ltid_75106 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75109 = ltid_75106 + binop_x_75108;\n        cond_75113 = slt64(j_75109, j_m_i_65502);\n        pre1d_75116 = btoi_bool_i64(cond_75113);\n        if (cond_75113) {\n            int64_t tile_elem_75117;\n            int64_t slice_75333;\n            int16_t tile_elem_75118;\n            \n            tile_elem_75117 = ((__global int64_t *) ext_mem_75562)[j_75109];\n            slice_75333 = slice_65911 + j_75109;\n            tile_elem_75118 = ((__global int16_t *) tS_mem_75468)[slice_75333];\n            pre1d_75114 = tile_elem_75117;\n            pre1d_75115 = tile_elem_75118;\n        } else {\n            pre1d_75114 = (int64_t) 0;\n            pre1d_75115 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75106] = pre1d_75114;\n        ((__local int16_t *) color_76540)[ltid_75106] = pre1d_75115;\n        ((__local int64_t *) color_76539)[ltid_75106]", " = pre1d_75116;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75127 = sext_i32_i64(local_tid_76834);\n        ltid_75126 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75129 = binop_x_74974 + ltid_75126;\n        acc_75131 = mem_param_75580[(int64_t) 0];\n        acc_75132 = mem_param_75581[(int64_t) 0];\n        acc_75133 = mem_param_75582[(int64_t) 0];\n        cond_75134 = slt64(gtid_75129, min_res_65540);\n        if (cond_75134) {\n            int16_t eta_p_75130;\n            int64_t x_75138;\n            int16_t x_75139;\n            int64_t x_75140;\n            int64_t redout_75358;\n            int16_t redout_75359;\n            int64_t redout_75360;\n            \n            eta_p_75130 = mem_75567[(int64_t) 0];\n            redout_75358 = acc_75131;\n            redout_75359 = acc_75132;\n            redout_75360 = acc_75133;\n            for (int64_t i_75361 = 0; i_75361 < tile_sizze_74966; i_75361++) {\n                int64_t x_75141;\n                int16_t x_75142;\n                bool defunc_0_neq_res_75150;\n                bool defunc_0_neq_res_75151;\n                bool cond_f_res_75152;\n                bool y_75153;\n                bool cond_75154;\n                bool defunc_0_neq_res_75155;\n                bool defunc_0_neq_res_75156;\n                bool cond_t_res_f_res_75157;\n                bool y_75158;\n                bool cond_t_res_75159;\n                bool x_75160;\n                int64_t defunc_0_op_res_75161;\n                int16_t defunc_0_op_res_75162;\n                int64_t defunc_0_op_res_75163;\n                int64_t redout_tmp_76849;\n                int16_t redout_tmp_76850;\n                int64_t redout_tmp_76851;\n                \n                x_75141 = ((__local int64_t *) color_76541)[i_75361];\n                x_75142 = ((__local int16_t *) color_76540)[i_75361];\n                defunc_0_neq_res_75150 = redout_75359 == eta_p_75130;\n                defunc_0_neq_res_75151 = !defunc_0_neq_res_75150;\n              ",
                                    "  cond_f_res_75152 = slt64(redout_75358, (int64_t) 0);\n                y_75153 = defunc_0_neq_res_75150 && cond_f_res_75152;\n                cond_75154 = defunc_0_neq_res_75151 || y_75153;\n                defunc_0_neq_res_75155 = x_75142 == eta_p_75130;\n                defunc_0_neq_res_75156 = !defunc_0_neq_res_75155;\n                cond_t_res_f_res_75157 = slt64(x_75141, (int64_t) 0);\n                y_75158 = defunc_0_neq_res_75155 && cond_t_res_f_res_75157;\n                cond_t_res_75159 = defunc_0_neq_res_75156 || y_75158;\n                x_75160 = cond_75154 && cond_t_res_75159;\n                if (x_75160) {\n                    defunc_0_op_res_75161 = (int64_t) -1;\n                    defunc_0_op_res_75162 = eta_p_75130;\n                    defunc_0_op_res_75163 = (int64_t) 0;\n                } else {\n                    int64_t x_75143;\n                    int64_t defunc_0_op_res_f_res_75164;\n                    int16_t defunc_0_op_res_f_res_75165;\n                    int64_t defunc_0_op_res_f_res_75166;\n                    \n                    x_75143 = ((__local int64_t *) color_76539)[i_75361];\n                    if (cond_75154) {\n                        defunc_0_op_res_f_res_75164 = x_75141;\n                        defunc_0_op_res_f_res_75165 = x_75142;\n                        defunc_0_op_res_f_res_75166 = x_75143;\n                    } else {\n                        int16_t defunc_0_op_res_f_res_f_res_75167;\n                        int64_t defunc_0_op_res_f_res_f_res_75168;\n                        int64_t defunc_0_op_res_f_res_f_res_75169;\n                        \n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75167 = redout_75359;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75167 = eta_p_75130;\n                        }\n                        if (cond_t_res_75159) {\n                            defunc_0_op_res_f_res_f_res_75168 = redout_75358;\n     ", "                       defunc_0_op_res_f_res_f_res_75169 = redout_75360;\n                        } else {\n                            int64_t min_res_75170;\n                            int64_t tmp_75171;\n                            \n                            min_res_75170 = smin64(x_75141, redout_75358);\n                            tmp_75171 = add64(x_75143, redout_75360);\n                            defunc_0_op_res_f_res_f_res_75168 = min_res_75170;\n                            defunc_0_op_res_f_res_f_res_75169 = tmp_75171;\n                        }\n                        defunc_0_op_res_f_res_75164 = defunc_0_op_res_f_res_f_res_75168;\n                        defunc_0_op_res_f_res_75165 = defunc_0_op_res_f_res_f_res_75167;\n                        defunc_0_op_res_f_res_75166 = defunc_0_op_res_f_res_f_res_75169;\n                    }\n                    defunc_0_op_res_75161 = defunc_0_op_res_f_res_75164;\n                    defunc_0_op_res_75162 = defunc_0_op_res_f_res_75165;\n                    defunc_0_op_res_75163 = defunc_0_op_res_f_res_75166;\n                }\n                redout_tmp_76849 = defunc_0_op_res_75161;\n                redout_tmp_76850 = defunc_0_op_res_75162;\n                redout_tmp_76851 = defunc_0_op_res_75163;\n                redout_75358 = redout_tmp_76849;\n                redout_75359 = redout_tmp_76850;\n                redout_75360 = redout_tmp_76851;\n            }\n            x_75138 = redout_75358;\n            x_75139 = redout_75359;\n            x_75140 = redout_75360;\n            acc_75135 = x_75138;\n            acc_75136 = x_75139;\n            acc_75137 = x_75140;\n        } else {\n            acc_75135 = acc_75131;\n            acc_75136 = acc_75132;\n            acc_75137 = acc_75133;\n        }\n        mem_75592[(int64_t) 0] = acc_75135;\n        mem_75596[(int64_t) 0] = acc_75136;\n        mem_75600[(int64_t) 0] = acc_75137;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_", "76843[i_6] = mem_75592[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_76844[i_7] = mem_75596[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_76845[i_8] = mem_75600[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_75580[i_9] = mem_param_tmp_76843[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_75581[i_10] = mem_param_tmp_76844[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_75582[i_11] = mem_param_tmp_76845[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_75603[i_12] = mem_param_75580[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_75602[i_13] = mem_param_75581[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_75601[i_14] = mem_param_75582[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_75207) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_75619[i_15] = ext_mem_75603[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_75618[i_16] = ext_mem_75601[i_16];\n    } else {\n        int64_t ltid_flat_75209;\n        int64_t ltid_75208;\n        int64_t j_75224;\n        bool cond_75228;\n        int64_t pre1d_75231;\n        int64_t pre1d_75229;\n        int16_t pre1d_75230;\n        int64_t ltid_flat_75245;\n        int64_t ltid_75244;\n        int64_t gtid_75258;\n        int64_t acc_75260;\n        int64_t acc_75262;\n        bool cond_75263;\n        int64_t acc_75264;\n        int64_t acc_75266;\n        \n        ltid_flat_75209 = sext_i32_i64(local_tid_76834);\n        ltid_75208 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        j_75224 = ltid_75208 + binop_x_75223;\n        cond_75228 = slt64(j_75224, j_m_i_65502);\n        pre1d_75231 = btoi_bool_i64(cond_75228);\n        if (cond_75228) {\n            int64_t tile_elem_75232;\n            int64_t slice_75332;\n            int16_t tile_elem_75233;\n            \n            tile_el",
                                    "em_75232 = ((__global int64_t *) ext_mem_75562)[j_75224];\n            slice_75332 = slice_65911 + j_75224;\n            tile_elem_75233 = ((__global int16_t *) tS_mem_75468)[slice_75332];\n            pre1d_75229 = tile_elem_75232;\n            pre1d_75230 = tile_elem_75233;\n        } else {\n            pre1d_75229 = (int64_t) 0;\n            pre1d_75230 = (int16_t) 0;\n        }\n        ((__local int64_t *) color_76541)[ltid_75208] = pre1d_75229;\n        ((__local int16_t *) color_76540)[ltid_75208] = pre1d_75230;\n        ((__local int64_t *) color_76539)[ltid_75208] = pre1d_75231;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_75245 = sext_i32_i64(local_tid_76834);\n        ltid_75244 = sext_i32_i64(sext_i64_i32(ltid_pre_76838));\n        gtid_75258 = binop_x_74974 + ltid_75244;\n        acc_75260 = ext_mem_75603[(int64_t) 0];\n        acc_75262 = ext_mem_75601[(int64_t) 0];\n        cond_75263 = slt64(gtid_75258, min_res_65540);\n        if (cond_75263) {\n            int16_t eta_p_75259;\n            int16_t acc_75261;\n            int64_t x_75267;\n            int16_t x_75268;\n            int64_t x_75269;\n            int64_t redout_75362;\n            int16_t redout_75363;\n            int64_t redout_75364;\n            \n            eta_p_75259 = mem_75567[(int64_t) 0];\n            acc_75261 = ext_mem_75602[(int64_t) 0];\n            redout_75362 = acc_75260;\n            redout_75363 = acc_75261;\n            redout_75364 = acc_75262;\n            for (int64_t i_75365 = 0; i_75365 < residual_input_75206; i_75365++) {\n                int64_t x_75270;\n                int16_t x_75271;\n                bool defunc_0_neq_res_75279;\n                bool defunc_0_neq_res_75280;\n                bool cond_f_res_75281;\n                bool y_75282;\n                bool cond_75283;\n                bool defunc_0_neq_res_75284;\n                bool defunc_0_neq_res_75285;\n                bool cond_t_res_f_res_75286;\n                bool y_75287;\n                bool cond_t_res_75288;\n  ", "              bool x_75289;\n                int64_t defunc_0_op_res_75290;\n                int16_t defunc_0_op_res_75291;\n                int64_t defunc_0_op_res_75292;\n                int64_t redout_tmp_76852;\n                int16_t redout_tmp_76853;\n                int64_t redout_tmp_76854;\n                \n                x_75270 = ((__local int64_t *) color_76541)[i_75365];\n                x_75271 = ((__local int16_t *) color_76540)[i_75365];\n                defunc_0_neq_res_75279 = redout_75363 == eta_p_75259;\n                defunc_0_neq_res_75280 = !defunc_0_neq_res_75279;\n                cond_f_res_75281 = slt64(redout_75362, (int64_t) 0);\n                y_75282 = defunc_0_neq_res_75279 && cond_f_res_75281;\n                cond_75283 = defunc_0_neq_res_75280 || y_75282;\n                defunc_0_neq_res_75284 = x_75271 == eta_p_75259;\n                defunc_0_neq_res_75285 = !defunc_0_neq_res_75284;\n                cond_t_res_f_res_75286 = slt64(x_75270, (int64_t) 0);\n                y_75287 = defunc_0_neq_res_75284 && cond_t_res_f_res_75286;\n                cond_t_res_75288 = defunc_0_neq_res_75285 || y_75287;\n                x_75289 = cond_75283 && cond_t_res_75288;\n                if (x_75289) {\n                    defunc_0_op_res_75290 = (int64_t) -1;\n                    defunc_0_op_res_75291 = eta_p_75259;\n                    defunc_0_op_res_75292 = (int64_t) 0;\n                } else {\n                    int64_t x_75272;\n                    int64_t defunc_0_op_res_f_res_75293;\n                    int16_t defunc_0_op_res_f_res_75294;\n                    int64_t defunc_0_op_res_f_res_75295;\n                    \n                    x_75272 = ((__local int64_t *) color_76539)[i_75365];\n                    if (cond_75283) {\n                        defunc_0_op_res_f_res_75293 = x_75270;\n                        defunc_0_op_res_f_res_75294 = x_75271;\n                        defunc_0_op_res_f_res_75295 = x_75272;\n                    } else {\n                 ", "       int16_t defunc_0_op_res_f_res_f_res_75296;\n                        int64_t defunc_0_op_res_f_res_f_res_75297;\n                        int64_t defunc_0_op_res_f_res_f_res_75298;\n                        \n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75296 = redout_75363;\n                        } else {\n                            defunc_0_op_res_f_res_f_res_75296 = eta_p_75259;\n                        }\n                        if (cond_t_res_75288) {\n                            defunc_0_op_res_f_res_f_res_75297 = redout_75362;\n                            defunc_0_op_res_f_res_f_res_75298 = redout_75364;\n                        } else {\n                            int64_t min_res_75299;\n                            int64_t tmp_75300;\n                            \n                            min_res_75299 = smin64(x_75270, redout_75362);\n                            tmp_75300 = add64(x_75272, redout_75364);\n                            defunc_0_op_res_f_res_f_res_75297 = min_res_75299;\n                            defunc_0_op_res_f_res_f_res_75298 = tmp_75300;\n                        }\n                        defunc_0_op_res_f_res_75293 = defunc_0_op_res_f_res_f_res_75297;\n                        defunc_0_op_res_f_res_75294 = defunc_0_op_res_f_res_f_res_75296;\n                        defunc_0_op_res_f_res_75295 = defunc_0_op_res_f_res_f_res_75298;\n                    }\n                    defunc_0_op_res_75290 = defunc_0_op_res_f_res_75293;\n                    defunc_0_op_res_75291 = defunc_0_op_res_f_res_75294;\n                    defunc_0_op_res_75292 = defunc_0_op_res_f_res_75295;\n                }\n                redout_tmp_76852 = defunc_0_op_res_75290;\n                redout_tmp_76853 = defunc_0_op_res_75291;\n                redout_tmp_76854 = defunc_0_op_res_75292;\n                redout_75362 = redout_tmp_76852;\n                redout_75363 = redout_tmp_76853;\n                redout_75364 = redout_tmp_",
                                    "76854;\n            }\n            x_75267 = redout_75362;\n            x_75268 = redout_75363;\n            x_75269 = redout_75364;\n            acc_75264 = x_75267;\n            acc_75266 = x_75269;\n        } else {\n            acc_75264 = acc_75260;\n            acc_75266 = acc_75262;\n        }\n        mem_75613[(int64_t) 0] = acc_75264;\n        mem_75617[(int64_t) 0] = acc_75266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_75619[i_17] = mem_75613[i_17];\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_75618[i_18] = mem_75617[i_18];\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76855 = ext_mem_75619[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75621)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76855;\n    }\n    if (slt64(sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835), min_res_65540)) {\n        int64_t tmp_76856 = ext_mem_75618[(int64_t) 0];\n        \n        ((__global int64_t *) mem_75623)[sext_i32_i64(local_tid_76834) + tile_sizze_74966 * sext_i32_i64(block_id_76835)] = tmp_76856;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_74966\n    #undef bytes_75583\n    #undef bytes_75585\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegscan_68567_dim1, 1, 1)\nvoid inner_SMJ_shortzisegscan_68567(__global int *global_failure, int64_t nR_37190, int64_t num_tblocks_68564, int64_t num_virt_blocks_76924, int64_t num_virt_threads_76925, __global unsigned char *ext_mem_75938, __global unsigned char *mem_75941, __global unsigned char *mem_75943, __global unsigned char *status_flags_mem_76926, __global unsigned char *aggregates_mem_76948, __global unsigned char *incprefixes_mem_76950, __global unsigned char *global_dynid_mem_76952)\n{\n    #define segscan_tblock_sizze_68562 (inner_SMJ_shortzisegscan_68567zisegscan_tblock_sizze_685", "62)\n    #define chunk_sizze_76923 (inner_SMJ_shortzisegscan_68567zichunk_sizze_76923)\n    \n    volatile __local unsigned char *local_mem_76982_backing_0 = &shared_mem[0];\n    const int64_t local_mem_76982_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_68562), chunk_sizze_76923 * segscan_tblock_sizze_68562 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_68562), chunk_sizze_76923 * segscan_tblock_sizze_68562 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76975;\n    int32_t tblock_sizze_76978;\n    int32_t wave_sizze_76977;\n    int32_t block_id_76976;\n    int32_t global_tid_76974;\n    int64_t phys_tid_68567;\n    int32_t chunk_sizze_32b_76979;\n    int64_t byte_offsets_76980;\n    int64_t warp_byte_offset_76981;\n    __local unsigned char *local_mem_76982;\n    int64_t trans_arr_len_76983;\n    int64_t phys_block_id_76989;\n    int64_t virtloop_bound_76990;\n    \n    local_tid_76975 = get_local_id(0);\n    tblock_sizze_76978 = get_local_size(0);\n    wave_sizze_76977 = LOCKSTEP_WIDTH;\n    block_id_76976 = get_tblock_id(0);\n    global_tid_76974 = block_id_76976 * tblock_sizze_76978 + local_tid_76975;\n    phys_tid_68567 = sext_i32_i64(global_tid_76974);\n    chunk_sizze_32b_76979 = sext_i64_i32(chunk_sizze_76923);\n    byte_offsets_76980 = segscan_tblock_sizze_68562 * (int64_t) 8;\n    warp_byte_offset_76981 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_76982 = (__local unsigned char *) local_mem_76982_backing_0;\n    trans_arr_len_76983 = chunk_sizze_76923 * segscan_tblock_sizze_68562;\n    phys_block_id_76989 = get_tblock_id(0);\n    virtloop_bound_76990 = sdiv_up64(num_virt_blocks_76924 - phys_block_id_76989, num_tblocks_68564);\n    for (int64_t virtloop_i_76991 = 0; virtloop_i_76991 < virtloop_bound_76990; virtloop_i_76991++) {\n        int64_t dynamic_id_76992;\n        int64_t ", "block_offset_76993;\n        int64_t sgm_idx_76994;\n        int32_t boundary_76995;\n        int32_t segsizze_compact_76996;\n        int64_t private_mem_76997[chunk_sizze_76923];\n        int64_t thd_offset_76999;\n        int64_t acc_77015;\n        int64_t prefix_77025;\n        bool block_new_sgm_77026;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_76975 == 0) {\n                dynamic_id_76992 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_76952)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 0] = dynamic_id_76992;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_76992 == num_virt_blocks_76924 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_76952)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_76992 = ((__local int32_t *) local_mem_76982)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_76993 = dynamic_id_76992 * chunk_sizze_76923 * segscan_tblock_sizze_68562;\n        sgm_idx_76994 = smod64(block_offset_76993, nR_37190);\n        boundary_76995 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_68562, nR_37190 - sgm_idx_76994));\n        segsizze_compact_76996 = sext_i64_i32(smin64(chunk_sizze_76923 * segscan_tblock_sizze_68562, nR_37190));\n        thd_offset_76999 = block_offset_76993 + sext_i32_i64(local_tid_76975);\n        // Load and map\n        {\n            for (int64_t i_77000 = 0; i_77000 < chunk_sizze_76923; i_77000++) {\n                int64_t virt_tid_77001 = thd_offset_76999 + i_77000 * segscan_tblock_sizze_68562;\n                int64_t slice_77002 = nR_37190;\n                int64_t gtid_68566 = virt_tid",
                                    "_77001;\n                int64_t remnant_77003 = virt_tid_77001 - gtid_68566;\n                \n                if (slt64(virt_tid_77001, nR_37190)) {\n                    int64_t eta_p_65962 = ((__global int64_t *) ext_mem_75938)[gtid_68566];\n                    bool lifted_lambda_res_65963 = slt64((int64_t) 0, eta_p_65962);\n                    int64_t defunc_0_f_res_65964 = btoi_bool_i64(lifted_lambda_res_65963);\n                    \n                    ((__global int64_t *) mem_75943)[gtid_68566] = defunc_0_f_res_65964;\n                    private_mem_76997[i_77000] = defunc_0_f_res_65964;\n                } else {\n                    private_mem_76997[i_77000] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77004 = 0; i_77004 < chunk_sizze_76923; i_77004++) {\n                int64_t sharedIdx_77005 = sext_i32_i64(local_tid_76975) + i_77004 * segscan_tblock_sizze_68562;\n                int64_t tmp_77006 = private_mem_76997[i_77004];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77005] = tmp_77006;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77007 = 0; i_77007 < chunk_sizze_76923; i_77007++) {\n                int64_t sharedIdx_77008 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77007;\n                int64_t tmp_77009 = ((__local int64_t *) local_mem_76982)[sharedIdx_77008];\n                \n                private_mem_76997[i_77007] = tmp_77009;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77010 = 0; i_77010 < chunk_sizze_76923 - (int64_t) 1; i_77010++) {\n                int64_t eta_p_65673;\n                int64_t eta_p_65674;\n                \n                eta_p_65673 = private_mem_76997[i_77010];\n                eta_p_65674 = private_mem_76997[i_77010 + (int64_t) 1];\n              ", "  \n                int64_t defunc_0_op_res_65675 = add64(eta_p_65673, eta_p_65674);\n                \n                private_mem_76997[i_77010 + (int64_t) 1] = defunc_0_op_res_65675;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77011 = private_mem_76997[chunk_sizze_76923 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = tmp_77011;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77012;\n            int64_t eta_p_77013;\n            int64_t eta_p_77016;\n            int64_t eta_p_77017;\n            bool ltid_in_bounds_77019 = slt64(sext_i32_i64(local_tid_76975), num_virt_threads_76925);\n            int32_t skip_threads_77020;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77019) {\n                    eta_p_77013 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                    if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                        eta_p_77012 = eta_p_77013;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77020 = 1;\n                while (slt32(skip_threads_77020, 32)) {\n                    bool thread_active_77021 = sle32(skip_threads_77020, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && ltid_in_bounds_77019;\n                    \n                    if (thread_active_77021) {\n                        // read operands\n                        {\n                            eta_p_77012 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77020)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (t", "hread_active_77021) {\n                            int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                            \n                            eta_p_77012 = defunc_0_op_res_77014;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77021) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77012;\n                            eta_p_77013 = eta_p_77012;\n                        }\n                    }\n                    if (sle32(wave_sizze_76977, skip_threads_77020)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77020 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 31 && ltid_in_bounds_77019) {\n                    ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32))] = eta_p_77012;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77022;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                        eta_p_77017 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                        if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                            eta_p_77016 = eta_p_77017;\n                  ",
                                    "      }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77022 = 1;\n                    while (slt32(skip_threads_77022, 32)) {\n                        bool thread_active_77023 = sle32(skip_threads_77022, local_tid_76975 - squot32(local_tid_76975, 32) * 32) && (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019);\n                        \n                        if (thread_active_77023) {\n                            // read operands\n                            {\n                                eta_p_77016 = ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77022)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77023) {\n                                int64_t defunc_0_op_res_77018 = add64(eta_p_77016, eta_p_77017);\n                                \n                                eta_p_77016 = defunc_0_op_res_77018;\n                            }\n                        }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77023) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77016;\n                                eta_p_77017 = eta_p_77016;\n                            }\n                        }\n                        if (sle32(wave_sizze_76977, skip_threads_77022)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77022 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENC", "E);\n            \n            bool no_carry_in_77024 = squot32(local_tid_76975, 32) == 0 || !ltid_in_bounds_77019;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_77024) {\n                        eta_p_77013 = eta_p_77012;\n                        eta_p_77012 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(squot32(local_tid_76975, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77024) {\n                        int64_t defunc_0_op_res_77014 = add64(eta_p_77012, eta_p_77013);\n                        \n                        eta_p_77012 = defunc_0_op_res_77014;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77024) {\n                        ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77012;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_76975, 32) == 0 && ltid_in_bounds_77019) {\n                    ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = eta_p_77013;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_76975 == 0) {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[segscan_tblock_sizze_68562 - (int64_t) 1];\n            } else {\n                acc_77015 = ((__local int64_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77025 = (int64_t) 0;\n        block_new_sgm_77026 = sgm_idx_76994 == (int64_t) 0;\n        // Perform lookback\n        {\n      ", "      if (block_new_sgm_77026 && local_tid_76975 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = acc_77015;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                acc_77015 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77026 && slt32(local_tid_76975, wave_sizze_76977)) {\n                if (local_tid_76975 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_76948)[dynamic_id_76992] = acc_77015;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 1;\n                    \n                    int8_t tmp_77027 = ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_76982)[(int64_t) 0] = tmp_77027;\n                }\n                mem_fence_local();\n                \n                int8_t status_77028 = ((__local int8_t *) local_mem_76982)[(int64_t) 0];\n                \n                if (status_77028 == (int8_t) 2) {\n                    if (local_tid_76975 == 0) {\n                        prefix_77025 = ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77029 = sext_i64_i32(dynamic_id_76992 - sext_i32_i64(wave_sizze_76977));\n                    \n                    while (slt32(wave_sizze_76977 * -1, readOffset_77029)) {\n                        int32_t read_i_77030 = readOffset_77029 + local_tid_76975;\n                        int64_t aggr_77031 = (int64_t) 0;\n                        int8_t flag_77032 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77030)) {\n                            flag_77032 = ((volatile __global int8_t *) status_",
                                    "flags_mem_76926)[sext_i32_i64(read_i_77030)];\n                            if (flag_77032 == (int8_t) 2) {\n                                aggr_77031 = ((volatile __global int64_t *) incprefixes_mem_76950)[sext_i32_i64(read_i_77030)];\n                            } else if (flag_77032 == (int8_t) 1) {\n                                aggr_77031 = ((volatile __global int64_t *) aggregates_mem_76948)[sext_i32_i64(read_i_77030)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = aggr_77031;\n                        ((__local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flag_77032;\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        if (slt8(flag_77032, (int8_t) 2)) {\n                            int8_t flg_x_77036;\n                            int8_t flg_y_77037;\n                            int64_t eta_p_77033;\n                            int64_t eta_p_77034;\n                            int32_t skip_threads_77038;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77037 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)];\n                                eta_p_77034 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)];\n                                if ((local_tid_76975 - squot32(local_tid_76975, 32) * 32) == 0) {\n                                    eta_p_77033 = eta_p_77034;\n                                    flg_x_77036 = flg_y_77037;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77038 = 1;\n                          ", "      while (slt32(skip_threads_77038, 32)) {\n                                    if (sle32(skip_threads_77038, local_tid_76975 - squot32(local_tid_76975, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77036 = ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038)];\n                                            eta_p_77033 = ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(local_tid_76975) - sext_i32_i64(skip_threads_77038))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77037 == (int8_t) 2 || flg_y_77037 == (int8_t) 0) {\n                                                flg_x_77036 = flg_y_77037;\n                                                eta_p_77033 = eta_p_77034;\n                                            } else {\n                                                int64_t defunc_0_op_res_77035 = add64(eta_p_77033, eta_p_77034);\n                                                \n                                                eta_p_77033 = defunc_0_op_res_77035;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_76982)[sext_i32_i64(local_tid_76975)] = flg_x_77036;\n                                            flg_y_77037 = flg_x_77036;\n                                            ((volatile __local int64_t *) local_mem_76982)[(int64_t) 4 + sext_i32_i64(local_tid_76975)] = eta_p_77033;\n                                            eta_p_77034 = eta_p_77033;\n                                        }\n                ", "                    }\n                                    skip_threads_77038 *= 2;\n                                }\n                            }\n                        }\n                        flag_77032 = ((__local int8_t *) local_mem_76982)[sext_i32_i64(wave_sizze_76977) - (int64_t) 1];\n                        aggr_77031 = ((__local int64_t *) local_mem_76982)[(int64_t) 4 + (sext_i32_i64(wave_sizze_76977) - (int64_t) 1)];\n                        if (flag_77032 == (int8_t) 2) {\n                            readOffset_77029 = wave_sizze_76977 * -1;\n                        } else if (flag_77032 == (int8_t) 1) {\n                            readOffset_77029 -= wave_sizze_76977;\n                        }\n                        if (slt8((int8_t) 0, flag_77032)) {\n                            int64_t eta_p_77039 = aggr_77031;\n                            int64_t eta_p_77040 = prefix_77025;\n                            int64_t defunc_0_op_res_77041 = add64(eta_p_77039, eta_p_77040);\n                            \n                            prefix_77025 = defunc_0_op_res_77041;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_76975 == 0) {\n                    if (boundary_76995 == sext_i64_i32(segscan_tblock_sizze_68562 * chunk_sizze_76923)) {\n                        int64_t eta_p_77042 = prefix_77025;\n                        int64_t eta_p_77043 = acc_77015;\n                        int64_t defunc_0_op_res_77044 = add64(eta_p_77042, eta_p_77043);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_76950)[dynamic_id_76992] = defunc_0_op_res_77044;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_76926)[dynamic_id_76992] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_76982)[(int64_t) 4] = prefix_77025;\n                    acc_77015 = (int64_",
                                    "t) 0;\n                }\n            }\n            if (!(dynamic_id_76992 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77025 = ((__local int64_t *) local_mem_76982)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77045;\n            int64_t eta_p_77046;\n            int64_t eta_p_77048 = prefix_77025;\n            int64_t eta_p_77049 = acc_77015;\n            \n            if (slt32(local_tid_76975 * chunk_sizze_32b_76979, boundary_76995) && !block_new_sgm_77026) {\n                int64_t defunc_0_op_res_77050 = add64(eta_p_77048, eta_p_77049);\n                \n                eta_p_77045 = defunc_0_op_res_77050;\n            } else {\n                eta_p_77045 = acc_77015;\n            }\n            \n            int32_t stopping_point_77051 = segsizze_compact_76996 - srem32(local_tid_76975 * chunk_sizze_32b_76979 - 1 + segsizze_compact_76996 - boundary_76995, segsizze_compact_76996);\n            \n            for (int64_t i_77052 = 0; i_77052 < chunk_sizze_76923; i_77052++) {\n                if (slt32(sext_i64_i32(i_77052), stopping_point_77051 - 1)) {\n                    eta_p_77046 = private_mem_76997[i_77052];\n                    \n                    int64_t defunc_0_op_res_77047 = add64(eta_p_77045, eta_p_77046);\n                    \n                    private_mem_76997[i_77052] = defunc_0_op_res_77047;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_77053 = 0; i_77053 < chunk_sizze_76923; i_77053++) {\n                int64_t sharedIdx_77054 = sext_i32_i64(local_tid_76975) * chunk_sizze_76923 + i_77053;\n                int64_t tmp_77055 = private_mem_76997[i_77053];\n                \n                ((__local int64_t *) local_mem_76982)[sharedIdx_77054] = tmp_77055;\n            }\n            barrier(CLK_LOCAL_MEM_", "FENCE);\n            for (int64_t i_77056 = 0; i_77056 < chunk_sizze_76923; i_77056++) {\n                int64_t flat_idx_77057 = thd_offset_76999 + i_77056 * segscan_tblock_sizze_68562;\n                int64_t slice_77058 = nR_37190;\n                int64_t gtid_68566 = flat_idx_77057;\n                int64_t remnant_77059 = flat_idx_77057 - gtid_68566;\n                \n                if (slt64(flat_idx_77057, nR_37190)) {\n                    int64_t tmp_77060 = ((__local int64_t *) local_mem_76982)[flat_idx_77057 - block_offset_76993];\n                    \n                    ((__global int64_t *) mem_75941)[gtid_68566] = tmp_77060;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_68562\n    #undef chunk_sizze_76923\n}\nFUTHARK_KERNEL_SIZED(inner_SMJ_shortzisegscan_68583_dim1, 1, 1)\nvoid inner_SMJ_shortzisegscan_68583(__global int *global_failure, int64_t m_65686, int64_t num_tblocks_68580, int64_t num_virt_blocks_77081, int64_t num_virt_threads_77082, __global unsigned char *mem_75945, __global unsigned char *mem_75955, __global unsigned char *mem_75957, __global unsigned char *mem_75959, __global unsigned char *status_flags_mem_77083, __global unsigned char *aggregates_mem_77085, __global unsigned char *incprefixes_mem_77087, __global unsigned char *aggregates_mem_77089, __global unsigned char *incprefixes_mem_77091, __global unsigned char *global_dynid_mem_77093)\n{\n    #define segscan_tblock_sizze_68578 (inner_SMJ_shortzisegscan_68583zisegscan_tblock_sizze_68578)\n    #define chunk_sizze_77080 (inner_SMJ_shortzisegscan_68583zichunk_sizze_77080)\n    \n    volatile __local unsigned char *local_mem_77105_backing_0 = &shared_mem[0];\n    const int64_t local_mem_77105_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_68578, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_68578), smax64(chunk_sizze_77080 * segs", "can_tblock_sizze_68578 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_68578, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_68578), smax64(chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_77096;\n    int32_t tblock_sizze_77099;\n    int32_t wave_sizze_77098;\n    int32_t block_id_77097;\n    int32_t global_tid_77095;\n    int64_t phys_tid_68583;\n    int32_t chunk_sizze_32b_77100;\n    int64_t byte_offsets_77101;\n    int64_t byte_offsets_77102;\n    int64_t warp_byte_offset_77103;\n    int64_t warp_byte_offset_77104;\n    __local unsigned char *local_mem_77105;\n    int64_t trans_arr_len_77106;\n    int64_t phys_block_id_77115;\n    int64_t virtloop_bound_77116;\n    \n    local_tid_77096 = get_local_id(0);\n    tblock_sizze_77099 = get_local_size(0);\n    wave_sizze_77098 = LOCKSTEP_WIDTH;\n    block_id_77097 = get_tblock_id(0);\n    global_tid_77095 = block_id_77097 * tblock_sizze_77099 + local_tid_77096;\n    phys_tid_68583 = sext_i32_i64(global_tid_77095);\n    chunk_sizze_32b_77100 = sext_i64_i32(chunk_sizze_77080);\n    byte_offsets_77101 = segscan_tblock_sizze_68578 * (int64_t) 8;\n    byte_offsets_77102 = sdiv_up64(byte_offsets_77101, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_68578 * (int64_t) 8;\n    warp_byte_offset_77103 = (int64_t) 288;\n    warp_byte_offset_77104 = sdiv_up64(warp_byte_offset_77103, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_77105 = (__local unsigned char *) local_mem_77105_backing_0;\n    trans_arr_len_77106 = chunk_sizze_77080 * segscan_tblock_sizze_68578;\n    phys_block_id_77115 = get_tblock_id(0);\n    virtloop_bound_77116 = sdiv_up64(num_virt_blocks_77081 - phy",
                                    "s_block_id_77115, num_tblocks_68580);\n    for (int64_t virtloop_i_77117 = 0; virtloop_i_77117 < virtloop_bound_77116; virtloop_i_77117++) {\n        int64_t dynamic_id_77118;\n        int64_t block_offset_77119;\n        int64_t sgm_idx_77120;\n        int32_t boundary_77121;\n        int32_t segsizze_compact_77122;\n        int64_t private_mem_77123[chunk_sizze_77080];\n        int64_t private_mem_77125[chunk_sizze_77080];\n        int64_t thd_offset_77127;\n        int64_t acc_77153;\n        int64_t acc_77154;\n        int64_t prefix_77167;\n        int64_t prefix_77168;\n        bool block_new_sgm_77169;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_77096 == 0) {\n                dynamic_id_77118 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_77093)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 0] = dynamic_id_77118;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_77118 == num_virt_blocks_77081 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_77093)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_77118 = ((__local int32_t *) local_mem_77105)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_77119 = dynamic_id_77118 * chunk_sizze_77080 * segscan_tblock_sizze_68578;\n        sgm_idx_77120 = smod64(block_offset_77119, m_65686);\n        boundary_77121 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_68578, m_65686 - sgm_idx_77120));\n        segsizze_compact_77122 = sext_i64_i32(smin64(chunk_sizze_77080 * segscan_tblock_sizze_68578, m_65686));\n        thd_offset_77127 = block_offset_77119 + sext_i32_i64(local_tid_77096);\n       ", " // Load and map\n        {\n            for (int64_t i_77128 = 0; i_77128 < chunk_sizze_77080; i_77128++) {\n                int64_t virt_tid_77129 = thd_offset_77127 + i_77128 * segscan_tblock_sizze_68578;\n                int64_t slice_77130 = m_65686;\n                int64_t gtid_68582 = virt_tid_77129;\n                int64_t remnant_77131 = virt_tid_77129 - gtid_68582;\n                \n                if (slt64(virt_tid_77129, m_65686)) {\n                    int64_t x_65967 = ((__global int64_t *) mem_75945)[gtid_68582];\n                    bool lifted_lambda_res_65969 = slt64((int64_t) 1, x_65967);\n                    int64_t defunc_0_f_res_65970 = btoi_bool_i64(lifted_lambda_res_65969);\n                    \n                    ((__global int64_t *) mem_75959)[gtid_68582] = defunc_0_f_res_65970;\n                    private_mem_77123[i_77128] = x_65967;\n                    private_mem_77125[i_77128] = defunc_0_f_res_65970;\n                } else {\n                    private_mem_77123[i_77128] = (int64_t) 0;\n                    private_mem_77125[i_77128] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_77132 = 0; i_77132 < chunk_sizze_77080; i_77132++) {\n                int64_t sharedIdx_77133 = sext_i32_i64(local_tid_77096) + i_77132 * segscan_tblock_sizze_68578;\n                int64_t tmp_77134 = private_mem_77123[i_77132];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77133] = tmp_77134;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77135 = 0; i_77135 < chunk_sizze_77080; i_77135++) {\n                int64_t sharedIdx_77136 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77135;\n                int64_t tmp_77137 = ((__local int64_t *) local_mem_77105)[sharedIdx_77136];\n                \n                private_mem_77123[i_77135] = tmp_77137;\n            }\n            ba", "rrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77138 = 0; i_77138 < chunk_sizze_77080; i_77138++) {\n                int64_t sharedIdx_77139 = sext_i32_i64(local_tid_77096) + i_77138 * segscan_tblock_sizze_68578;\n                int64_t tmp_77140 = private_mem_77125[i_77138];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77139] = tmp_77140;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77141 = 0; i_77141 < chunk_sizze_77080; i_77141++) {\n                int64_t sharedIdx_77142 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77141;\n                int64_t tmp_77143 = ((__local int64_t *) local_mem_77105)[sharedIdx_77142];\n                \n                private_mem_77125[i_77141] = tmp_77143;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_77144 = 0; i_77144 < chunk_sizze_77080 - (int64_t) 1; i_77144++) {\n                int64_t eta_p_65723;\n                int64_t eta_p_65724;\n                \n                eta_p_65723 = private_mem_77123[i_77144];\n                eta_p_65724 = private_mem_77123[i_77144 + (int64_t) 1];\n                \n                int64_t eta_p_65816;\n                int64_t eta_p_65817;\n                \n                eta_p_65816 = private_mem_77125[i_77144];\n                eta_p_65817 = private_mem_77125[i_77144 + (int64_t) 1];\n                \n                int64_t lifted_lambda_res_65725 = add64(eta_p_65723, eta_p_65724);\n                int64_t defunc_0_op_res_65818 = add64(eta_p_65816, eta_p_65817);\n                \n                private_mem_77123[i_77144 + (int64_t) 1] = lifted_lambda_res_65725;\n                private_mem_77125[i_77144 + (int64_t) 1] = defunc_0_op_res_65818;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_77145 = private_mem_77123[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__",
                                    "local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = tmp_77145;\n            \n            int64_t tmp_77146 = private_mem_77125[chunk_sizze_77080 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = tmp_77146;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_77147;\n            int64_t eta_p_77148;\n            int64_t eta_p_77149;\n            int64_t eta_p_77150;\n            int64_t eta_p_77155;\n            int64_t eta_p_77156;\n            int64_t eta_p_77157;\n            int64_t eta_p_77158;\n            bool ltid_in_bounds_77161 = slt64(sext_i32_i64(local_tid_77096), num_virt_threads_77082);\n            int32_t skip_threads_77162;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_77161) {\n                    eta_p_77149 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                    eta_p_77150 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                    if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                        eta_p_77147 = eta_p_77149;\n                        eta_p_77148 = eta_p_77150;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_77162 = 1;\n                while (slt32(skip_threads_77162, 32)) {\n                    bool thread_active_77163 = sle32(skip_threads_77162, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && ltid_in_bounds_77161;\n                    \n                    if (thread_active_77163) {\n                        // read operands\n                        {\n                            eta_p_77147 = ((volatile __local int64_t *) local_mem_77", "105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162)];\n                            eta_p_77148 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77162))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_77163) {\n                            int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                            int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                            \n                            eta_p_77147 = lifted_lambda_res_77151;\n                            eta_p_77148 = defunc_0_op_res_77152;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_77163) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                            eta_p_77149 = eta_p_77147;\n                            ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                            eta_p_77150 = eta_p_77148;\n                        }\n                    }\n                    if (sle32(wave_sizze_77098, skip_threads_77162)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_77162 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 31 && ltid_in_bounds_77161) {\n      ", "              ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77147;\n                    ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(squot32(local_tid_77096, 32))] = eta_p_77148;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_77164;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                        eta_p_77157 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                        eta_p_77158 = ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                        if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                            eta_p_77155 = eta_p_77157;\n                            eta_p_77156 = eta_p_77158;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_77164 = 1;\n                    while (slt32(skip_threads_77164, 32)) {\n                        bool thread_active_77165 = sle32(skip_threads_77164, local_tid_77096 - squot32(local_tid_77096, 32) * 32) && (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161);\n                        \n                        if (thread_active_77165) {\n                            // read operands\n                            {\n                                eta_p_77155 = ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164)];\n                                eta_p_77156 = ((volatile __local int64_t *) local_m",
                                    "em_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77164))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_77165) {\n                                int64_t lifted_lambda_res_77159 = add64(eta_p_77155, eta_p_77157);\n                                int64_t defunc_0_op_res_77160 = add64(eta_p_77156, eta_p_77158);\n                                \n                                eta_p_77155 = lifted_lambda_res_77159;\n                                eta_p_77156 = defunc_0_op_res_77160;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_77165) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77155;\n                                eta_p_77157 = eta_p_77155;\n                                ((volatile __local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77156;\n                                eta_p_77158 = eta_p_77156;\n                            }\n                        }\n                        if (sle32(wave_sizze_77098, skip_threads_77164)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_77164 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_77166 = squot32(local_tid_77096, 32) == 0 || !ltid_in_bounds_77161;\n            \n            // carry-in for every block except the first\n            {\n                // rea", "d operands\n                {\n                    if (!no_carry_in_77166) {\n                        eta_p_77149 = eta_p_77147;\n                        eta_p_77150 = eta_p_77148;\n                        eta_p_77147 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1];\n                        eta_p_77148 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_77096, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_77166) {\n                        int64_t lifted_lambda_res_77151 = add64(eta_p_77147, eta_p_77149);\n                        int64_t defunc_0_op_res_77152 = add64(eta_p_77148, eta_p_77150);\n                        \n                        eta_p_77147 = lifted_lambda_res_77151;\n                        eta_p_77148 = defunc_0_op_res_77152;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_77166) {\n                        ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77147;\n                        ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77148;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_77096, 32) == 0 && ltid_in_bounds_77161) {\n                    ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = eta_p_77149;\n                    ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid", "_77096 == 0) {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[segscan_tblock_sizze_68578 - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (segscan_tblock_sizze_68578 - (int64_t) 1)];\n            } else {\n                acc_77153 = ((__local int64_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - (int64_t) 1];\n                acc_77154 = ((__local int64_t *) local_mem_77105)[squot64(byte_offsets_77101, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_77167 = (int64_t) 0;\n        prefix_77168 = (int64_t) 0;\n        block_new_sgm_77169 = sgm_idx_77120 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_77169 && local_tid_77096 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = acc_77153;\n                ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118] = acc_77154;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                acc_77153 = (int64_t) 0;\n                acc_77154 = (int64_t) 0;\n            }\n            if (!block_new_sgm_77169 && slt32(local_tid_77096, wave_sizze_77098)) {\n                if (local_tid_77096 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_77085)[dynamic_id_77118] = acc_77153;\n                    ((volatile __global int64_t *) aggregates_mem_77089)[dynamic_id_77118] = acc_77154;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 1;\n                    \n                    int8_t tmp_77170 = ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *",
                                    ") local_mem_77105)[(int64_t) 0] = tmp_77170;\n                }\n                mem_fence_local();\n                \n                int8_t status_77171 = ((__local int8_t *) local_mem_77105)[(int64_t) 0];\n                \n                if (status_77171 == (int8_t) 2) {\n                    if (local_tid_77096 == 0) {\n                        prefix_77167 = ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118 - (int64_t) 1];\n                        prefix_77168 = ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_77172 = sext_i64_i32(dynamic_id_77118 - sext_i32_i64(wave_sizze_77098));\n                    \n                    while (slt32(wave_sizze_77098 * -1, readOffset_77172)) {\n                        int32_t read_i_77173 = readOffset_77172 + local_tid_77096;\n                        int64_t aggr_77174 = (int64_t) 0;\n                        int64_t aggr_77175 = (int64_t) 0;\n                        int8_t flag_77176 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_77173)) {\n                            flag_77176 = ((volatile __global int8_t *) status_flags_mem_77083)[sext_i32_i64(read_i_77173)];\n                            if (flag_77176 == (int8_t) 2) {\n                                aggr_77174 = ((volatile __global int64_t *) incprefixes_mem_77087)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) incprefixes_mem_77091)[sext_i32_i64(read_i_77173)];\n                            } else if (flag_77176 == (int8_t) 1) {\n                                aggr_77174 = ((volatile __global int64_t *) aggregates_mem_77085)[sext_i32_i64(read_i_77173)];\n                                aggr_77175 = ((volatile __global int64_t *) aggregates_mem_77089)[sext_i32_i64(read_i_77173)];\n                            }\n                        }\n                     ", "   ((__local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = aggr_77174;\n                        ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = aggr_77175;\n                        ((__local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flag_77176;\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze_77098) - (int64_t) 1];\n                        if (slt8(flag_77176, (int8_t) 2)) {\n                            int8_t flg_x_77183;\n                            int8_t flg_y_77184;\n                            int64_t eta_p_77177;\n                            int64_t eta_p_77178;\n                            int64_t eta_p_77179;\n                            int64_t eta_p_77180;\n                            int32_t skip_threads_77185;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_77184 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)];\n                                eta_p_77179 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)];\n                                eta_p_77180 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)];\n                                if ((local_tid_77096 - squot32(local_tid_77096, 32) * 32) == 0) {\n                                    eta_p_77177 = eta_p_77179;\n                                    eta_p_77178 = eta_p_77180;\n                                    flg_x_77183 = flg_y_77184;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_77185 = 1;\n                                while (slt32", "(skip_threads_77185, 32)) {\n                                    if (sle32(skip_threads_77185, local_tid_77096 - squot32(local_tid_77096, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_77183 = ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185)];\n                                            eta_p_77177 = ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                            eta_p_77178 = ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(local_tid_77096) - sext_i32_i64(skip_threads_77185))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_77184 == (int8_t) 2 || flg_y_77184 == (int8_t) 0) {\n                                                flg_x_77183 = flg_y_77184;\n                                                eta_p_77177 = eta_p_77179;\n                                                eta_p_77178 = eta_p_77180;\n                                            } else {\n                                                int64_t lifted_lambda_res_77181 = add64(eta_p_77177, eta_p_77179);\n                                                int64_t defunc_0_op_res_77182 = add64(eta_p_77178, eta_p_77180);\n                                                \n                                                eta_p_77177 = lifted_lambda_res_77181;\n                                                eta_p_77178 = defunc_0_op_res_77182;\n                                            }\n                                        }\n                                        // write result\n                                        {\n       ",
                                    "                                     ((volatile __local int8_t *) local_mem_77105)[sext_i32_i64(local_tid_77096)] = flg_x_77183;\n                                            flg_y_77184 = flg_x_77183;\n                                            ((volatile __local int64_t *) local_mem_77105)[(int64_t) 4 + sext_i32_i64(local_tid_77096)] = eta_p_77177;\n                                            eta_p_77179 = eta_p_77177;\n                                            ((volatile __local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + sext_i32_i64(local_tid_77096)] = eta_p_77178;\n                                            eta_p_77180 = eta_p_77178;\n                                        }\n                                    }\n                                    skip_threads_77185 *= 2;\n                                }\n                            }\n                        }\n                        flag_77176 = ((__local int8_t *) local_mem_77105)[sext_i32_i64(wave_sizze_77098) - (int64_t) 1];\n                        aggr_77174 = ((__local int64_t *) local_mem_77105)[(int64_t) 4 + (sext_i32_i64(wave_sizze_77098) - (int64_t) 1)];\n                        aggr_77175 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8) + (sext_i32_i64(wave_sizze_77098) - (int64_t) 1)];\n                        if (flag_77176 == (int8_t) 2) {\n                            readOffset_77172 = wave_sizze_77098 * -1;\n                        } else if (flag_77176 == (int8_t) 1) {\n                            readOffset_77172 -= wave_sizze_77098;\n                        }\n                        if (slt8((int8_t) 0, flag_77176)) {\n                            int64_t eta_p_77186 = aggr_77174;\n                            int64_t eta_p_77187 = aggr_77175;\n                            int64_t eta_p_77188 = prefix_77167;\n                            int64_t eta_p_77189 = prefix_77168;\n                            int64_t lifted_lambda_res_77190 = add64(e", "ta_p_77186, eta_p_77188);\n                            int64_t defunc_0_op_res_77191 = add64(eta_p_77187, eta_p_77189);\n                            \n                            prefix_77167 = lifted_lambda_res_77190;\n                            prefix_77168 = defunc_0_op_res_77191;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_77096 == 0) {\n                    if (boundary_77121 == sext_i64_i32(segscan_tblock_sizze_68578 * chunk_sizze_77080)) {\n                        int64_t eta_p_77192 = prefix_77167;\n                        int64_t eta_p_77193 = prefix_77168;\n                        int64_t eta_p_77194 = acc_77153;\n                        int64_t eta_p_77195 = acc_77154;\n                        int64_t lifted_lambda_res_77196 = add64(eta_p_77192, eta_p_77194);\n                        int64_t defunc_0_op_res_77197 = add64(eta_p_77193, eta_p_77195);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_77087)[dynamic_id_77118] = lifted_lambda_res_77196;\n                        ((volatile __global int64_t *) incprefixes_mem_77091)[dynamic_id_77118] = defunc_0_op_res_77197;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_77083)[dynamic_id_77118] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_77105)[(int64_t) 4] = prefix_77167;\n                    ((__local int64_t *) local_mem_77105)[squot64(warp_byte_offset_77103, (int64_t) 8)] = prefix_77168;\n                    acc_77153 = (int64_t) 0;\n                    acc_77154 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_77118 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_77167 = ((__local int64_t *) local_mem_77105)[(int64_t) 4];\n                prefix_77168 = ((__local int64_t *) local_mem_77105)[squot64(warp_byte_o", "ffset_77103, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_77198;\n            int64_t eta_p_77200;\n            int64_t eta_p_77204 = prefix_77167;\n            int64_t eta_p_77206 = acc_77153;\n            int64_t eta_p_77199;\n            int64_t eta_p_77201;\n            int64_t eta_p_77205 = prefix_77168;\n            int64_t eta_p_77207 = acc_77154;\n            \n            if (slt32(local_tid_77096 * chunk_sizze_32b_77100, boundary_77121) && !block_new_sgm_77169) {\n                int64_t lifted_lambda_res_77208 = add64(eta_p_77204, eta_p_77206);\n                int64_t defunc_0_op_res_77209 = add64(eta_p_77205, eta_p_77207);\n                \n                eta_p_77198 = lifted_lambda_res_77208;\n                eta_p_77199 = defunc_0_op_res_77209;\n            } else {\n                eta_p_77198 = acc_77153;\n                eta_p_77199 = acc_77154;\n            }\n            \n            int32_t stopping_point_77210 = segsizze_compact_77122 - srem32(local_tid_77096 * chunk_sizze_32b_77100 - 1 + segsizze_compact_77122 - boundary_77121, segsizze_compact_77122);\n            \n            for (int64_t i_77211 = 0; i_77211 < chunk_sizze_77080; i_77211++) {\n                if (slt32(sext_i64_i32(i_77211), stopping_point_77210 - 1)) {\n                    eta_p_77200 = private_mem_77123[i_77211];\n                    eta_p_77201 = private_mem_77125[i_77211];\n                    \n                    int64_t lifted_lambda_res_77202 = add64(eta_p_77198, eta_p_77200);\n                    int64_t defunc_0_op_res_77203 = add64(eta_p_77199, eta_p_77201);\n                    \n                    private_mem_77123[i_77211] = lifted_lambda_res_77202;\n                    private_mem_77125[i_77211] = defunc_0_op_res_77203;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_7",
                                    "7212 = 0; i_77212 < chunk_sizze_77080; i_77212++) {\n                int64_t sharedIdx_77213 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77212;\n                int64_t tmp_77214 = private_mem_77123[i_77212];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77213] = tmp_77214;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77215 = 0; i_77215 < chunk_sizze_77080; i_77215++) {\n                int64_t flat_idx_77216 = thd_offset_77127 + i_77215 * segscan_tblock_sizze_68578;\n                int64_t slice_77217 = m_65686;\n                int64_t gtid_68582 = flat_idx_77216;\n                int64_t remnant_77218 = flat_idx_77216 - gtid_68582;\n                \n                if (slt64(flat_idx_77216, m_65686)) {\n                    int64_t tmp_77219 = ((__local int64_t *) local_mem_77105)[flat_idx_77216 - block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75955)[gtid_68582] = tmp_77219;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77220 = 0; i_77220 < chunk_sizze_77080; i_77220++) {\n                int64_t sharedIdx_77221 = sext_i32_i64(local_tid_77096) * chunk_sizze_77080 + i_77220;\n                int64_t tmp_77222 = private_mem_77125[i_77220];\n                \n                ((__local int64_t *) local_mem_77105)[sharedIdx_77221] = tmp_77222;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_77223 = 0; i_77223 < chunk_sizze_77080; i_77223++) {\n                int64_t flat_idx_77224 = thd_offset_77127 + i_77223 * segscan_tblock_sizze_68578;\n                int64_t slice_77225 = m_65686;\n                int64_t gtid_68582 = flat_idx_77224;\n                int64_t remnant_77226 = flat_idx_77224 - gtid_68582;\n                \n                if (slt64(flat_idx_77224, m_65686)) {\n                    int64_t tmp_77227 = ((__local int64_t *) local_mem_77105)[flat_idx_77224 - ", "block_offset_77119];\n                    \n                    ((__global int64_t *) mem_75957)[gtid_68582] = tmp_77227;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_68578\n    #undef chunk_sizze_77080\n}\nFUTHARK_KERNEL_SIZED(max_idxzisegred_nonseg_66773_dim1, 1, 1)\nvoid max_idxzisegred_nonseg_66773(__global int *global_failure, int64_t nz2080U_60458, int64_t num_tblocks_66768, int64_t num_threads_76569, __global unsigned char *eta_p_mem_75467, __global unsigned char *mem_75469, __global unsigned char *counters_mem_76545, __global unsigned char *segred_tmp_mem_76567)\n{\n    #define segred_tblock_sizze_66766 (max_idxzisegred_nonseg_66773zisegred_tblock_sizze_66766)\n    #define chunk_sizze_76544 (max_idxzisegred_nonseg_66773zichunk_sizze_76544)\n    \n    volatile __local unsigned char *sync_arr_mem_76577_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_76577_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_76575_backing_0 = &shared_mem[sync_arr_mem_76577_backing_1_offset];\n    const int64_t red_arr_i64_mem_76575_backing_0_offset = sync_arr_mem_76577_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_66766 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66766, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76571;\n    int32_t tblock_sizze_76574;\n    int32_t wave_sizze_76573;\n    int32_t block_id_76572;\n    int32_t global_tid_76570;\n    int64_t phys_tid_66773;\n    __local unsigned char *red_arr_i64_mem_76575;\n    __local unsigned char *sync_arr_mem_76577;\n    int64_t dummy_66771;\n    int64_t gtid_66772;\n    int64_t q_76579;\n    int64_t eta_p_block_res_acc_76580;\n    int64_t eta_p_61345;\n    int64_t eta_p_61346;\n    int64_t tblock_id_in_segment_76584;\n    int64_t block_base_offset_76585;\n    int32_t offset_76588;\n    int32_t skip_waves_76589;\n    int64_t eta", "_p_76581;\n    int64_t eta_p_76582;\n    int32_t old_counter_76590;\n    bool is_last_block_76591;\n    \n    local_tid_76571 = get_local_id(0);\n    tblock_sizze_76574 = get_local_size(0);\n    wave_sizze_76573 = LOCKSTEP_WIDTH;\n    block_id_76572 = get_tblock_id(0);\n    global_tid_76570 = block_id_76572 * tblock_sizze_76574 + local_tid_76571;\n    phys_tid_66773 = sext_i32_i64(global_tid_76570);\n    red_arr_i64_mem_76575 = (__local unsigned char *) red_arr_i64_mem_76575_backing_0;\n    sync_arr_mem_76577 = (__local unsigned char *) sync_arr_mem_76577_backing_1;\n    dummy_66771 = (int64_t) 0;\n    gtid_66772 = (int64_t) 0;\n    q_76579 = sdiv_up64(nz2080U_60458, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_66766 * num_tblocks_66768)) * chunk_sizze_76544);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_76580 = (int64_t) -9223372036854775808;\n    }\n    tblock_id_in_segment_76584 = squot64(phys_tid_66773, segred_tblock_sizze_66766);\n    block_base_offset_76585 = tblock_id_in_segment_76584 * q_76579 * segred_tblock_sizze_66766;\n    for (int64_t i_76586 = 0; i_76586 < q_76579; i_76586++) {\n        int64_t block_offset_76587 = block_base_offset_76585 + i_76586 * segred_tblock_sizze_66766;\n        \n        gtid_66772 = phys_tid_66773 + num_threads_76569 * i_76586;\n        if (slt64(gtid_66772, nz2080U_60458)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_61344 = ((__global int64_t *) eta_p_mem_75467)[gtid_66772];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_61345 = eta_p_block_res_acc_76580;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_61346 = x_61344;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t max_res_61347 = smax64(eta_p_6",
                                    "1345, eta_p_61346);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_76580 = max_res_61347;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_block_res_acc_76580;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_76589 = 1;\n    offset_76588 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_76571, sext_i64_i32(segred_tblock_sizze_66766))) {\n            eta_p_76581 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n        }\n    }\n    offset_76588 = 1;\n    while (slt32(offset_76588, wave_sizze_76573)) {\n        if (slt32(local_tid_76571 + offset_76588, sext_i64_i32(segred_tblock_sizze_66766)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) & (2 * offset_76588 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_76582 = ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_76583 = smax64(eta_p_76581, eta_p_76582);\n                \n                eta_p_76581 = max_res_76583;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n            }\n        }\n        offset_76588 *= 2;\n    }\n    while (slt32(skip_waves_76589, squot32(sext_i64_i32(segred_tblock_sizze_66766) + wave_sizze_76573 - 1, wave_sizze_76573))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_76588 = skip_waves_76589 * wave_siz", "ze_76573;\n        if (slt32(local_tid_76571 + offset_76588, sext_i64_i32(segred_tblock_sizze_66766)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) == 0 && (squot32(local_tid_76571, wave_sizze_76573) & (2 * skip_waves_76589 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_76582 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_76583 = smax64(eta_p_76581, eta_p_76582);\n                \n                eta_p_76581 = max_res_76583;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n            }\n        }\n        skip_waves_76589 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_76571) == (int64_t) 0) {\n            eta_p_block_res_acc_76580 = eta_p_76581;\n        } else {\n            eta_p_block_res_acc_76580 = (int64_t) -9223372036854775808;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_76571 == 0) {\n            ((__global int64_t *) segred_tmp_mem_76567)[sext_i32_i64(block_id_76572)] = eta_p_block_res_acc_76580;\n            mem_fence_global();\n            old_counter_76590 = atomic_add_i32_global(&((volatile __global int *) counters_mem_76545)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_76577)[(int64_t) 0] = old_counter_76590 == sext_i64_i32(num_tblocks_66768 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_76591 = ((__local bool *) sync_arr_mem_76577)[(int64_t) 0];\n    if (is_last_block_76591) {\n        if (local_tid_76571 == 0) {\n            old_counter_76590 ", "= atomic_add_i32_global(&((volatile __global int *) counters_mem_76545)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_66768));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_76592 = sdiv_up64(num_tblocks_66768, segred_tblock_sizze_66766);\n            \n            eta_p_61345 = (int64_t) -9223372036854775808;\n            for (int64_t i_76593 = 0; i_76593 < read_per_thread_76592; i_76593++) {\n                int64_t block_res_id_76594 = sext_i32_i64(local_tid_76571) * read_per_thread_76592 + i_76593;\n                int64_t index_of_block_res_76595 = block_res_id_76594;\n                \n                if (slt64(block_res_id_76594, num_tblocks_66768)) {\n                    eta_p_61346 = ((__global int64_t *) segred_tmp_mem_76567)[index_of_block_res_76595];\n                    \n                    int64_t max_res_61347 = smax64(eta_p_61345, eta_p_61346);\n                    \n                    eta_p_61345 = max_res_61347;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_61345;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_76596;\n            int32_t skip_waves_76597 = 1;\n            int64_t eta_p_76581;\n            int64_t eta_p_76582;\n            \n            offset_76596 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_76571, sext_i64_i32(segred_tblock_sizze_66766))) {\n                    eta_p_76581 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                }\n            }\n            offset_76596 = 1;\n            while (slt32(offset_76596, wave_sizze_76573)) {\n                if (slt32(local_tid_76571 + offset_76596, sext_i64_i32(segred_tblock_sizze_66766)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76",
                                    "573) & (2 * offset_76596 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_76582 = ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_76583 = smax64(eta_p_76581, eta_p_76582);\n                        \n                        eta_p_76581 = max_res_76583;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n                    }\n                }\n                offset_76596 *= 2;\n            }\n            while (slt32(skip_waves_76597, squot32(sext_i64_i32(segred_tblock_sizze_66766) + wave_sizze_76573 - 1, wave_sizze_76573))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_76596 = skip_waves_76597 * wave_sizze_76573;\n                if (slt32(local_tid_76571 + offset_76596, sext_i64_i32(segred_tblock_sizze_66766)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) == 0 && (squot32(local_tid_76571, wave_sizze_76573) & (2 * skip_waves_76597 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_76582 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_76583 = smax64(eta_p_76581, eta_p_76582);\n                        \n                        eta_p_76581 = max_res_76583;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n                    }", "\n                }\n                skip_waves_76597 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_76571 == 0) {\n                    ((__global int64_t *) mem_75469)[(int64_t) 0] = eta_p_76581;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_66766\n    #undef chunk_sizze_76544\n}\nFUTHARK_KERNEL_SIZED(min_idxzisegred_nonseg_66763_dim1, 1, 1)\nvoid min_idxzisegred_nonseg_66763(__global int *global_failure, int64_t nz2080U_60421, int64_t num_tblocks_66758, int64_t num_threads_76569, __global unsigned char *eta_p_mem_75467, __global unsigned char *mem_75469, __global unsigned char *counters_mem_76545, __global unsigned char *segred_tmp_mem_76567)\n{\n    #define segred_tblock_sizze_66756 (min_idxzisegred_nonseg_66763zisegred_tblock_sizze_66756)\n    #define chunk_sizze_76544 (min_idxzisegred_nonseg_66763zichunk_sizze_76544)\n    \n    volatile __local unsigned char *sync_arr_mem_76577_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_76577_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_76575_backing_0 = &shared_mem[sync_arr_mem_76577_backing_1_offset];\n    const int64_t red_arr_i64_mem_76575_backing_0_offset = sync_arr_mem_76577_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_66756 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66756, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_76571;\n    int32_t tblock_sizze_76574;\n    int32_t wave_sizze_76573;\n    int32_t block_id_76572;\n    int32_t global_tid_76570;\n    int64_t phys_tid_66763;\n    __local unsigned char *red_arr_i64_mem_76575;\n    __local unsigned char *sync_arr_mem_76577;\n    int64_t dummy_66761;\n    int64_t gtid_66762;\n    int64_t q_76579;\n    int64_t eta_p_block_res_acc_76580;\n    int64_t eta_p_61345;\n    int64_t eta_p_61346;\n  ", "  int64_t tblock_id_in_segment_76584;\n    int64_t block_base_offset_76585;\n    int32_t offset_76588;\n    int32_t skip_waves_76589;\n    int64_t eta_p_76581;\n    int64_t eta_p_76582;\n    int32_t old_counter_76590;\n    bool is_last_block_76591;\n    \n    local_tid_76571 = get_local_id(0);\n    tblock_sizze_76574 = get_local_size(0);\n    wave_sizze_76573 = LOCKSTEP_WIDTH;\n    block_id_76572 = get_tblock_id(0);\n    global_tid_76570 = block_id_76572 * tblock_sizze_76574 + local_tid_76571;\n    phys_tid_66763 = sext_i32_i64(global_tid_76570);\n    red_arr_i64_mem_76575 = (__local unsigned char *) red_arr_i64_mem_76575_backing_0;\n    sync_arr_mem_76577 = (__local unsigned char *) sync_arr_mem_76577_backing_1;\n    dummy_66761 = (int64_t) 0;\n    gtid_66762 = (int64_t) 0;\n    q_76579 = sdiv_up64(nz2080U_60421, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_66756 * num_tblocks_66758)) * chunk_sizze_76544);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_76580 = (int64_t) 9223372036854775807;\n    }\n    tblock_id_in_segment_76584 = squot64(phys_tid_66763, segred_tblock_sizze_66756);\n    block_base_offset_76585 = tblock_id_in_segment_76584 * q_76579 * segred_tblock_sizze_66756;\n    for (int64_t i_76586 = 0; i_76586 < q_76579; i_76586++) {\n        int64_t block_offset_76587 = block_base_offset_76585 + i_76586 * segred_tblock_sizze_66756;\n        \n        gtid_66762 = phys_tid_66763 + num_threads_76569 * i_76586;\n        if (slt64(gtid_66762, nz2080U_60421)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_61344 = ((__global int64_t *) eta_p_mem_75467)[gtid_66762];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_61345 = eta_p_block_res_acc_76580;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_61346 = x_61344;\n            ",
                                    "        }\n                    // apply reduction operator(s)\n                    {\n                        int64_t min_res_61347 = smin64(eta_p_61345, eta_p_61346);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_76580 = min_res_61347;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_block_res_acc_76580;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_76589 = 1;\n    offset_76588 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_76571, sext_i64_i32(segred_tblock_sizze_66756))) {\n            eta_p_76581 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n        }\n    }\n    offset_76588 = 1;\n    while (slt32(offset_76588, wave_sizze_76573)) {\n        if (slt32(local_tid_76571 + offset_76588, sext_i64_i32(segred_tblock_sizze_66756)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) & (2 * offset_76588 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_76582 = ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n            }\n            // apply reduction operation\n            {\n                int64_t min_res_76583 = smin64(eta_p_76581, eta_p_76582);\n                \n                eta_p_76581 = min_res_76583;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n            }\n        }\n        offset_76588 *= 2;\n    }\n    while (slt32(skip_waves_76589, squot32(sext_i64_i32(segred_tblock_si", "zze_66756) + wave_sizze_76573 - 1, wave_sizze_76573))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_76588 = skip_waves_76589 * wave_sizze_76573;\n        if (slt32(local_tid_76571 + offset_76588, sext_i64_i32(segred_tblock_sizze_66756)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) == 0 && (squot32(local_tid_76571, wave_sizze_76573) & (2 * skip_waves_76589 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_76582 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76588)];\n            }\n            // apply reduction operation\n            {\n                int64_t min_res_76583 = smin64(eta_p_76581, eta_p_76582);\n                \n                eta_p_76581 = min_res_76583;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n            }\n        }\n        skip_waves_76589 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_76571) == (int64_t) 0) {\n            eta_p_block_res_acc_76580 = eta_p_76581;\n        } else {\n            eta_p_block_res_acc_76580 = (int64_t) 9223372036854775807;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_76571 == 0) {\n            ((__global int64_t *) segred_tmp_mem_76567)[sext_i32_i64(block_id_76572)] = eta_p_block_res_acc_76580;\n            mem_fence_global();\n            old_counter_76590 = atomic_add_i32_global(&((volatile __global int *) counters_mem_76545)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_76577)[(int64_t) 0] = old_counter_76590 == sext_i64_i32(num_tblocks_66758 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_76591 = ((__l", "ocal bool *) sync_arr_mem_76577)[(int64_t) 0];\n    if (is_last_block_76591) {\n        if (local_tid_76571 == 0) {\n            old_counter_76590 = atomic_add_i32_global(&((volatile __global int *) counters_mem_76545)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_66758));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_76592 = sdiv_up64(num_tblocks_66758, segred_tblock_sizze_66756);\n            \n            eta_p_61345 = (int64_t) 9223372036854775807;\n            for (int64_t i_76593 = 0; i_76593 < read_per_thread_76592; i_76593++) {\n                int64_t block_res_id_76594 = sext_i32_i64(local_tid_76571) * read_per_thread_76592 + i_76593;\n                int64_t index_of_block_res_76595 = block_res_id_76594;\n                \n                if (slt64(block_res_id_76594, num_tblocks_66758)) {\n                    eta_p_61346 = ((__global int64_t *) segred_tmp_mem_76567)[index_of_block_res_76595];\n                    \n                    int64_t min_res_61347 = smin64(eta_p_61345, eta_p_61346);\n                    \n                    eta_p_61345 = min_res_61347;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_61345;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_76596;\n            int32_t skip_waves_76597 = 1;\n            int64_t eta_p_76581;\n            int64_t eta_p_76582;\n            \n            offset_76596 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_76571, sext_i64_i32(segred_tblock_sizze_66756))) {\n                    eta_p_76581 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                }\n            }\n            offset_76596 = 1;\n            while (slt32(offset_76596, wave_sizze_76573)) {\n                if (slt32(local_tid_7",
                                    "6571 + offset_76596, sext_i64_i32(segred_tblock_sizze_66756)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) & (2 * offset_76596 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_76582 = ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t min_res_76583 = smin64(eta_p_76581, eta_p_76582);\n                        \n                        eta_p_76581 = min_res_76583;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n                    }\n                }\n                offset_76596 *= 2;\n            }\n            while (slt32(skip_waves_76597, squot32(sext_i64_i32(segred_tblock_sizze_66756) + wave_sizze_76573 - 1, wave_sizze_76573))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_76596 = skip_waves_76597 * wave_sizze_76573;\n                if (slt32(local_tid_76571 + offset_76596, sext_i64_i32(segred_tblock_sizze_66756)) && ((local_tid_76571 - squot32(local_tid_76571, wave_sizze_76573) * wave_sizze_76573) == 0 && (squot32(local_tid_76571, wave_sizze_76573) & (2 * skip_waves_76597 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_76582 = ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571 + offset_76596)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t min_res_76583 = smin64(eta_p_76581, eta_p_76582);\n                        \n                        eta_p_76581 = min_res_76583;\n                    }\n                    // write result of operation\n              ", "      {\n                        ((__local int64_t *) red_arr_i64_mem_76575)[sext_i32_i64(local_tid_76571)] = eta_p_76581;\n                    }\n                }\n                skip_waves_76597 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_76571 == 0) {\n                    ((__global int64_t *) mem_75469)[(int64_t) 0] = eta_p_76581;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_66756\n    #undef chunk_sizze_76544\n}\n", NULL};
// Start of gpu_prototypes.h

// Constants used for transpositions.  In principle these should be configurable.
#define TR_BLOCK_DIM 16
#define TR_TILE_DIM (TR_BLOCK_DIM*2)
#define TR_ELEMS_PER_THREAD 8

// Config stuff included in every GPU backend.
struct gpu_config {
  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_cache;
  size_t default_shared_memory;
  size_t default_registers;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;
};

// The following are dummy sizes that mean the concrete defaults
// will be set during initialisation via hardware-inspection-based
// heuristics.
struct gpu_config gpu_config_initial = {
  0
};

// Must be defined by the user.
static int gpu_macros(struct futhark_context *ctx, char*** names, int64_t** values);

static void gpu_init_log(struct futhark_context *ctx);
struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);
static int gpu_free_all(struct futhark_context *ctx);

// End of gpu_prototypes.h

// Start of backends/cuda.h.

// Forward declarations.
// Invoked by setup_opencl() after the platform and device has been
// found, but before the program is loaded.  Its intended use is to
// tune constants based on the selected platform and device.
static void set_tuning_params(struct futhark_context* ctx);
static char* get_failure_msg(int failure_idx, int64_t args[]);

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_FATAL(x) nvrtc_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_NONFATAL(x) nvrtc_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
// Take care not to override an existing error.
#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                               \
      if (!ctx->error) {                        \
        ctx->error = serror;                    \
      } else {                                  \
        free(serror);                           \
      }                                         \
      return bad;                               \
    }                                           \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
                                          const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
                                       const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed_fatal(nvrtcResult res, const char *call,
                                           const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* nvrtc_api_succeed_nonfatal(nvrtcResult res, const char *call,
                                        const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    return msgprintf("%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char* cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  char* program;
  int num_nvrtc_opts;
  char* *nvrtc_opts;

  char* preferred_device;
  int preferred_device_num;

  int unified_memory;

  char* dump_ptx_to;
  char* load_ptx_from;

  struct gpu_config gpu;
};

static void backend_context_config_setup(struct futhark_context_config *cfg) {
  cfg->num_nvrtc_opts = 0;
  cfg->nvrtc_opts = (char**) malloc(sizeof(char*));
  cfg->nvrtc_opts[0] = NULL;

  cfg->program = strconcat(gpu_program);

  cfg->preferred_device_num = 0;
  cfg->preferred_device = strdup("");

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->unified_memory = 2;

  cfg->gpu = gpu_config_initial;
  cfg->gpu.default_block_size = 256;
  cfg->gpu.default_tile_size = 32;
  cfg->gpu.default_reg_tile_size = 2;
  cfg->gpu.default_threshold = 32*1024;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  for (int i = 0; i < cfg->num_nvrtc_opts; i++) {
    free(cfg->nvrtc_opts[i]);
  }
  free(cfg->nvrtc_opts);
  free(cfg->dump_ptx_to);
  free(cfg->load_ptx_from);
  free(cfg->preferred_device);
  free(cfg->program);
}

void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt) {
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = strdup(opt);
  cfg->num_nvrtc_opts++;
  cfg->nvrtc_opts = (char **) realloc(cfg->nvrtc_opts, (cfg->num_nvrtc_opts + 1) * sizeof(char *));
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}

void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  free(cfg->preferred_device);
  cfg->preferred_device = strdup(s);
  cfg->preferred_device_num = x;
}

const char* futhark_context_config_get_program(struct futhark_context_config *cfg) {
  return cfg->program;
}

void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s) {
  free(cfg->program);
  cfg->program = strdup(s);
}

void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *path) {
  free(cfg->dump_ptx_to);
  cfg->dump_ptx_to = strdup(path);
}

void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *path) {
  free(cfg->load_ptx_from);
  cfg->load_ptx_from = strdup(path);
}

void futhark_context_config_set_unified_memory(struct futhark_context_config* cfg, int flag) {
  cfg->unified_memory = flag;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  const char *name;
};

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
  // Uniform fields above.

  CUdeviceptr global_failure;
  CUdeviceptr global_failure_args;
  struct tuning_params tuning_params;
  // True if a potentially failing kernel has been enqueued.
  int32_t failure_is_an_option;
  int total_runs;
  long int total_runtime;
  int64_t peak_mem_usage_device;
  int64_t cur_mem_usage_device;

  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;
  CUstream stream;

  struct free_list gpu_free_list;

  size_t max_thread_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;
  size_t max_registers;
  size_t max_cache;

  size_t lockstep_width;

  struct builtin_kernels* kernels;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static int cuda_device_setup(struct futhark_context *ctx) {
  struct futhark_context_config *cfg = ctx->cfg;
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best = 0, cc_minor_best = 0;
  int cc_major = 0, cc_minor = 0;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (cfg->logging) {
      fprintf(ctx->log, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
              i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (cfg->logging) {
        fprintf(ctx->log, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, cfg->preferred_device) != NULL &&
        num_device_matches++ == cfg->preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (cfg->logging) {
    fprintf(ctx->log, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  static struct {
    int major;
    int minor;
    const char *arch_str;
  } const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" },
    { 8, 6, "compute_80" },
    { 8, 7, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  int num_archs = sizeof(x)/sizeof(x[0]);
  for (int i = 0; i < num_archs; i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static void cuda_nvrtc_mk_build_options(struct futhark_context *ctx, const char *extra_opts[],
                                        char*** opts_out, size_t *n_opts) {
  int arch_set = 0, num_extra_opts;
  struct futhark_context_config *cfg = ctx->cfg;

  char** macro_names;
  int64_t* macro_vals;
  int num_macros = gpu_macros(ctx, &macro_names, &macro_vals);

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t i = 0, n_opts_alloc = 20 + num_macros + num_extra_opts + cfg->num_tuning_params;
  char **opts = (char**) malloc(n_opts_alloc * sizeof(char *));
  if (!arch_set) {
    opts[i++] = strdup("-arch");
    opts[i++] = strdup(cuda_nvrtc_get_arch(ctx->dev));
  }
  opts[i++] = strdup("-default-device");
  if (cfg->debugging) {
    opts[i++] = strdup("-G");
    opts[i++] = strdup("-lineinfo");
  } else {
    opts[i++] = strdup("--disable-warnings");
  }
  opts[i++] = msgprintf("-D%s=%d",
                        "max_thread_block_size",
                        (int)ctx->max_thread_block_size);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_shared_memory",
                        (int)ctx->max_shared_memory);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_registers",
                        (int)ctx->max_registers);

  for (int j = 0; j < num_macros; j++) {
    opts[i++] = msgprintf("-D%s=%zu", macro_names[j], macro_vals[j]);
  }

  for (int j = 0; j < cfg->num_tuning_params; j++) {
    opts[i++] = msgprintf("-D%s=%zu", cfg->tuning_param_vars[j],
                          cfg->tuning_params[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_thread_block_size);

  // Time for the best lines of the code in the entire compiler.
  if (getenv("CUDA_HOME") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_HOME"));
  }
  if (getenv("CUDA_ROOT") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_ROOT"));
  }
  if (getenv("CUDA_PATH") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_PATH"));
  }
  opts[i++] = msgprintf("-I/usr/local/cuda/include");
  opts[i++] = msgprintf("-I/usr/include");

  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = strdup(extra_opts[j]);
  }

  opts[i++] = msgprintf("-DTR_BLOCK_DIM=%d", TR_BLOCK_DIM);
  opts[i++] = msgprintf("-DTR_TILE_DIM=%d", TR_TILE_DIM);
  opts[i++] = msgprintf("-DTR_ELEMS_PER_THREAD=%d", TR_ELEMS_PER_THREAD);

  free(macro_names);
  free(macro_vals);

  *n_opts = i;
  *opts_out = opts;
}

static char* cuda_nvrtc_build(const char *src, const char *opts[], size_t n_opts,
                              char **ptx) {
  nvrtcProgram prog;
  char *problem = NULL;

  problem = NVRTC_SUCCEED_NONFATAL(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));

  if (problem) {
    return problem;
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        problem = msgprintf("NVRTC compilation failed.\n\n%s\n", log);
      } else {
        problem = msgprintf("Could not retrieve compilation log\n");
      }
      free(log);
    }
    return problem;
  }

  size_t ptx_size;
  NVRTC_SUCCEED_FATAL(nvrtcGetPTXSize(prog, &ptx_size));
  *ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED_FATAL(nvrtcGetPTX(prog, *ptx));

  NVRTC_SUCCEED_FATAL(nvrtcDestroyProgram(&prog));

  return NULL;
}

static void cuda_load_ptx_from_cache(struct futhark_context_config *cfg,
                                     const char *src,
                                     const char *opts[], size_t n_opts,
                                     struct cache_hash *h, const char *cache_fname,
                                     char **ptx) {
  if (cfg->logging) {
    fprintf(stderr, "Restoring cache from from %s...\n", cache_fname);
  }
  cache_hash_init(h);
  for (size_t i = 0; i < n_opts; i++) {
    cache_hash(h, opts[i], strlen(opts[i]));
  }
  cache_hash(h, src, strlen(src));
  size_t ptxsize;
  errno = 0;
  if (cache_restore(cache_fname, h, (unsigned char**)ptx, &ptxsize) != 0) {
    if (cfg->logging) {
      fprintf(stderr, "Failed to restore cache (errno: %s)\n", strerror(errno));
    }
  }
}

static void cuda_size_setup(struct futhark_context *ctx)
{
  struct futhark_context_config *cfg = ctx->cfg;
  if (cfg->gpu.default_block_size > ctx->max_thread_block_size) {
    if (cfg->gpu.default_block_size_changed) {
      fprintf(stderr,
              "Note: Device limits default block size to %zu (down from %zu).\n",
              ctx->max_thread_block_size, cfg->gpu.default_block_size);
    }
    cfg->gpu.default_block_size = ctx->max_thread_block_size;
  }
  if (cfg->gpu.default_grid_size > ctx->max_grid_size) {
    if (cfg->gpu.default_grid_size_changed) {
      fprintf(stderr,
              "Note: Device limits default grid size to %zu (down from %zu).\n",
              ctx->max_grid_size, cfg->gpu.default_grid_size);
    }
    cfg->gpu.default_grid_size = ctx->max_grid_size;
  }
  if (cfg->gpu.default_tile_size > ctx->max_tile_size) {
    if (cfg->gpu.default_tile_size_changed) {
      fprintf(stderr,
              "Note: Device limits default tile size to %zu (down from %zu).\n",
              ctx->max_tile_size, cfg->gpu.default_tile_size);
    }
    cfg->gpu.default_tile_size = ctx->max_tile_size;
  }

  if (!cfg->gpu.default_grid_size_changed) {
    cfg->gpu.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / cfg->gpu.default_block_size;
  }

  for (int i = 0; i < cfg->num_tuning_params; i++) {
    const char *size_class = cfg->tuning_param_classes[i];
    int64_t *size_value = &cfg->tuning_params[i];
    const char* size_name = cfg->tuning_param_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "thread_block_size") == size_class) {
      max_value = ctx->max_thread_block_size;
      default_value = cfg->gpu.default_block_size;
    } else if (strstr(size_class, "grid_size") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = cfg->gpu.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = cfg->gpu.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = cfg->gpu.default_reg_tile_size;
    } else if (strstr(size_class, "shared_memory") == size_class) {
      max_value = ctx->max_shared_memory;
      default_value = ctx->max_shared_memory;
    } else if (strstr(size_class, "cache") == size_class) {
      max_value = ctx->max_cache;
      default_value = ctx->max_cache;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = cfg->gpu.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static char* cuda_module_setup(struct futhark_context *ctx,
                               const char *src,
                               const char *extra_opts[],
                               const char* cache_fname) {
  char *ptx = NULL;
  struct futhark_context_config *cfg = ctx->cfg;

  if (cfg->load_ptx_from) {
    ptx = slurp_file(cfg->load_ptx_from, NULL);
  }

  char **opts;
  size_t n_opts;
  cuda_nvrtc_mk_build_options(ctx, extra_opts, &opts, &n_opts);

  if (cfg->logging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  struct cache_hash h;
  int loaded_ptx_from_cache = 0;
  if (cache_fname != NULL) {
    cuda_load_ptx_from_cache(cfg, src, (const char**)opts, n_opts, &h, cache_fname, &ptx);

    if (ptx != NULL) {
      if (cfg->logging) {
        fprintf(stderr, "Restored PTX from cache; now loading module...\n");
      }
      if (cuModuleLoadData(&ctx->module, ptx) == CUDA_SUCCESS) {
        if (cfg->logging) {
          fprintf(stderr, "Success!\n");
        }
        loaded_ptx_from_cache = 1;
      } else {
        if (cfg->logging) {
          fprintf(stderr, "Failed!\n");
        }
        free(ptx);
        ptx = NULL;
      }
    }
  }

  if (ptx == NULL) {
    char* problem = cuda_nvrtc_build(src, (const char**)opts, n_opts, &ptx);
    if (problem != NULL) {
      return problem;
    }
  }

  if (cfg->dump_ptx_to != NULL) {
    dump_file(cfg->dump_ptx_to, ptx, strlen(ptx));
  }

  if (!loaded_ptx_from_cache) {
    CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));
  }

  if (cache_fname != NULL && !loaded_ptx_from_cache) {
    if (cfg->logging) {
      fprintf(stderr, "Caching PTX in %s...\n", cache_fname);
    }
    errno = 0;
    if (cache_store(cache_fname, &h, (const unsigned char*)ptx, strlen(ptx)) != 0) {
      fprintf(stderr, "Failed to cache PTX: %s\n", strerror(errno));
    }
  }

  for (size_t i = 0; i < n_opts; i++) {
    free((char *)opts[i]);
  }
  free(opts);
  free(ptx);

  return NULL;
}

struct cuda_event {
  cudaEvent_t start;
  cudaEvent_t end;
};

static struct cuda_event* cuda_event_new(struct futhark_context* ctx) {
  if (ctx->profiling && !ctx->profiling_paused) {
    struct cuda_event* e = malloc(sizeof(struct cuda_event));
    cudaEventCreate(&e->start);
    cudaEventCreate(&e->end);
    return e;
  } else {
    return NULL;
  }
}

static int cuda_event_report(struct str_builder* sb, struct cuda_event* e) {
  float ms;
  CUresult err;
  if ((err = cuEventElapsedTime(&ms, e->start, e->end)) != CUDA_SUCCESS) {
    return err;
  }

  // CUDA provides milisecond resolution, but we want microseconds.
  str_builder(sb, ",\"duration\":%f", ms*1000);

  if ((err = cuEventDestroy(e->start)) != CUDA_SUCCESS) {
    return 1;
  }

  if ((err = cuEventDestroy(e->end)) != CUDA_SUCCESS) {
    return 1;
  }

  free(e);

  return 0;
}

int futhark_context_sync(struct futhark_context* ctx) {
  CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cu_ctx));
  CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
  if (ctx->failure_is_an_option) {
    // Check for any delayed error.
    int32_t failure_idx;
    CUDA_SUCCEED_OR_RETURN(
                           cuMemcpyDtoH(&failure_idx,
                                        ctx->global_failure,
                                        sizeof(int32_t)));
    ctx->failure_is_an_option = 0;

    if (failure_idx >= 0) {
      // We have to clear global_failure so that the next entry point
      // is not considered a failure from the start.
      int32_t no_failure = -1;
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyHtoD(ctx->global_failure,
                                          &no_failure,
                                          sizeof(int32_t)));

      int64_t args[max_failure_args+1];
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyDtoH(&args,
                                          ctx->global_failure_args,
                                          sizeof(args)));

      ctx->error = get_failure_msg(failure_idx, args);

      return FUTHARK_PROGRAM_ERROR;
    }
  }

  CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cu_ctx));
  return 0;
}

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);

int backend_context_setup(struct futhark_context* ctx) {
  ctx->failure_is_an_option = 0;
  ctx->total_runs = 0;
  ctx->total_runtime = 0;
  ctx->peak_mem_usage_device = 0;
  ctx->cur_mem_usage_device = 0;
  ctx->kernels = NULL;

  CUDA_SUCCEED_FATAL(cuInit(0));
  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->gpu_free_list);

  if (ctx->cfg->unified_memory == 2) {
    ctx->cfg->unified_memory = device_query(ctx->dev, MANAGED_MEMORY);
  }

  if (ctx->cfg->logging) {
    if (ctx->cfg->unified_memory) {
      fprintf(ctx->log, "Using managed memory\n");
    } else {
      fprintf(ctx->log, "Using unmanaged memory\n");
    }
  }

  ctx->max_thread_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_thread_block_size);
  ctx->max_threshold = 1U<<31; // No limit.
  ctx->max_bespoke = 1U<<31; // No limit.

  if (ctx->cfg->gpu.default_registers != 0) {
    ctx->max_registers = ctx->cfg->gpu.default_registers;
  } else {
    ctx->max_registers = device_query(ctx->dev, MAX_REGISTERS_PER_BLOCK);
  }

  if (ctx->cfg->gpu.default_shared_memory != 0) {
    ctx->max_shared_memory = ctx->cfg->gpu.default_shared_memory;
  } else {
    // MAX_SHARED_MEMORY_PER_BLOCK gives bogus numbers (48KiB); probably
    // for backwards compatibility.  Add _OPTIN and you seem to get the
    // right number.
    ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK_OPTIN);
#if CUDART_VERSION >= 12000
    ctx->max_shared_memory -= device_query(ctx->dev, RESERVED_SHARED_MEMORY_PER_BLOCK);
#endif
  }

  if (ctx->cfg->gpu.default_cache != 0) {
    ctx->max_cache = ctx->cfg->gpu.default_cache;
  } else {
    ctx->max_cache = device_query(ctx->dev, L2_CACHE_SIZE);
  }

  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);
  CUDA_SUCCEED_FATAL(cuStreamCreate(&ctx->stream, CU_STREAM_DEFAULT));
  cuda_size_setup(ctx);

  gpu_init_log(ctx);

  ctx->error = cuda_module_setup(ctx,
                                 ctx->cfg->program,
                                 (const char**)ctx->cfg->nvrtc_opts,
                                 ctx->cfg->cache_fname);

  if (ctx->error != NULL) {
    futhark_panic(1, "During CUDA initialisation:\n%s\n", ctx->error);
  }

  int32_t no_error = -1;
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
  CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error, sizeof(no_error)));
  // The +1 is to avoid zero-byte allocations.
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t)*(max_failure_args+1)));

  if ((ctx->kernels = init_builtin_kernels(ctx)) == NULL) {
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  if (ctx->kernels != NULL) {
    free_builtin_kernels(ctx, ctx->kernels);
    cuMemFree(ctx->global_failure);
    cuMemFree(ctx->global_failure_args);
    CUDA_SUCCEED_FATAL(gpu_free_all(ctx));
    CUDA_SUCCEED_FATAL(cuStreamDestroy(ctx->stream));
    CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
    CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
  }
  free_list_destroy(&ctx->gpu_free_list);
}

// GPU ABSTRACTION LAYER

// Types.

typedef CUfunction gpu_kernel;
typedef CUdeviceptr gpu_mem;

static void gpu_create_kernel(struct futhark_context *ctx,
                              gpu_kernel* kernel,
                              const char* name) {
  if (ctx->debugging) {
    fprintf(ctx->log, "Creating kernel %s.\n", name);
  }
  CUDA_SUCCEED_FATAL(cuModuleGetFunction(kernel, ctx->module, name));
  // Unless the below is set, the kernel is limited to 48KiB of memory.
  CUDA_SUCCEED_FATAL(cuFuncSetAttribute(*kernel,
                                        cudaFuncAttributeMaxDynamicSharedMemorySize,
                                        ctx->max_shared_memory));
}

static void gpu_free_kernel(struct futhark_context *ctx,
                            gpu_kernel kernel) {
  (void)ctx;
  (void)kernel;
}

static int gpu_scalar_to_device(struct futhark_context* ctx,
                                gpu_mem dst, size_t offset, size_t size,
                                void *src) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(dst + offset, src, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_scalar_from_device(struct futhark_context* ctx,
                                  void *dst,
                                  gpu_mem src, size_t offset, size_t size) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_from_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(dst, src + offset, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_memcpy(struct futhark_context* ctx,
                      gpu_mem dst, int64_t dst_offset,
                      gpu_mem src, int64_t src_offset,
                      int64_t nbytes) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_dev_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyAsync(dst+dst_offset, src+src_offset, nbytes, ctx->stream));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_host2gpu(struct futhark_context* ctx, bool sync,
                           gpu_mem dst, int64_t dst_offset,
                           const unsigned char* src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_host_to_dev",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoD(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoDAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_gpu2host(struct futhark_context* ctx, bool sync,
                           unsigned char* dst, int64_t dst_offset,
                           gpu_mem src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_dev_to_host",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoH(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoHAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
    if (sync &&
        ctx->failure_is_an_option &&
        futhark_context_sync(ctx) != 0) {
      return 1;
    }
  }
  return FUTHARK_SUCCESS;
}

static int gpu_launch_kernel(struct futhark_context* ctx,
                             gpu_kernel kernel, const char *name,
                             const int32_t grid[3],
                             const int32_t block[3],
                             unsigned int shared_mem_bytes,
                             int num_args,
                             void* args[num_args],
                             size_t args_sizes[num_args]) {
  (void) args_sizes;

  if (shared_mem_bytes > ctx->max_shared_memory) {
    set_error(ctx, msgprintf("Kernel %s with %d bytes of memory exceeds device limit of %d\n",
                             name, shared_mem_bytes, (int)ctx->max_shared_memory));
    return 1;
  }

  int64_t time_start = 0, time_end = 0;
  if (ctx->debugging) {
    time_start = get_wall_time();
  }

  struct cuda_event *event = cuda_event_new(ctx);

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    add_event(ctx,
              name,
              msgprintf("Kernel %s with\n"
                        "  grid=(%d,%d,%d)\n"
                        "  block=(%d,%d,%d)\n"
                        "  shared memory=%d",
                        name,
                        grid[0], grid[1], grid[2],
                        block[0], block[1], block[2],
                        shared_mem_bytes),
              event,
              (event_report_fn)cuda_event_report);
  }

  CUDA_SUCCEED_OR_RETURN
    (cuLaunchKernel(kernel,
                    grid[0], grid[1], grid[2],
                    block[0], block[1], block[2],
                    shared_mem_bytes, ctx->stream,
                    args, NULL));

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }

  if (ctx->debugging) {
    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
    time_end = get_wall_time();
    long int time_diff = time_end - time_start;
    fprintf(ctx->log, "  runtime: %ldus\n", time_diff);
  }
  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return FUTHARK_SUCCESS;
}

static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out) {
  CUresult res;
  if (ctx->cfg->unified_memory) {
    res = cuMemAllocManaged(mem_out, size, CU_MEM_ATTACH_GLOBAL);
  } else {
    res = cuMemAlloc(mem_out, size);
  }

  if (res == CUDA_ERROR_OUT_OF_MEMORY) {
    return FUTHARK_OUT_OF_MEMORY;
  }

  CUDA_SUCCEED_OR_RETURN(res);
  return FUTHARK_SUCCESS;
}

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem) {
  (void)ctx;
  CUDA_SUCCEED_OR_RETURN(cuMemFree(mem));
  return FUTHARK_SUCCESS;
}

// End of backends/cuda.h.

// Start of gpu.h

// Generic functions that use our tiny GPU abstraction layer.  The
// entire context must be defined before this header is included.  In
// particular we expect the following functions to be available:

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem);
static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out);
int gpu_launch_kernel(struct futhark_context* ctx,
                      gpu_kernel kernel, const char *name,
                      const int32_t grid[3],
                      const int32_t block[3],
                      unsigned int shared_mem_bytes,
                      int num_args,
                      void* args[num_args],
                      size_t args_sizes[num_args]);
int gpu_memcpy(struct futhark_context* ctx,
               gpu_mem dst, int64_t dst_offset,
               gpu_mem src, int64_t src_offset,
               int64_t nbytes);
int gpu_scalar_from_device(struct futhark_context* ctx,
                           void *dst,
                           gpu_mem src, size_t offset, size_t size);
int gpu_scalar_to_device(struct futhark_context* ctx,
                         gpu_mem dst, size_t offset, size_t size,
                         void *src);
void gpu_create_kernel(struct futhark_context *ctx,
                       gpu_kernel* kernel,
                       const char* name);

static void gpu_init_log(struct futhark_context *ctx) {
  if (ctx->cfg->logging) {
    fprintf(ctx->log, "Default block size: %ld\n", (long)ctx->cfg->gpu.default_block_size);
    fprintf(ctx->log, "Default grid size: %ld\n", (long)ctx->cfg->gpu.default_grid_size);
    fprintf(ctx->log, "Default tile size: %ld\n", (long)ctx->cfg->gpu.default_tile_size);
    fprintf(ctx->log, "Default register tile size: %ld\n", (long)ctx->cfg->gpu.default_reg_tile_size);
    fprintf(ctx->log, "Default cache: %ld\n", (long)ctx->cfg->gpu.default_cache);
    fprintf(ctx->log, "Default registers: %ld\n", (long)ctx->cfg->gpu.default_registers);
    fprintf(ctx->log, "Default threshold: %ld\n", (long)ctx->cfg->gpu.default_threshold);
    fprintf(ctx->log, "Max thread block size: %ld\n", (long)ctx->max_thread_block_size);
    fprintf(ctx->log, "Max grid size: %ld\n", (long)ctx->max_grid_size);
    fprintf(ctx->log, "Max tile size: %ld\n", (long)ctx->max_tile_size);
    fprintf(ctx->log, "Max threshold: %ld\n", (long)ctx->max_threshold);
    fprintf(ctx->log, "Max shared memory: %ld\n", (long)ctx->max_shared_memory);
    fprintf(ctx->log, "Max registers: %ld\n", (long)ctx->max_registers);
    fprintf(ctx->log, "Max cache: %ld\n", (long)ctx->max_cache);
    fprintf(ctx->log, "Lockstep width: %ld\n", (long)ctx->lockstep_width);
  }
}

// Generic GPU command line options.

void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_block_size = size;
  cfg->gpu.default_block_size_changed = 1;
}

void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size) {
  futhark_context_config_set_default_thread_block_size(cfg, size);
}

void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int num) {
  cfg->gpu.default_grid_size = num;
  cfg->gpu.default_grid_size_changed = 1;
}

void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int num) {
  futhark_context_config_set_default_grid_size(cfg, num);
}

void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_tile_size = size;
  cfg->gpu.default_tile_size_changed = 1;
}

void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_reg_tile_size = size;
}

void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_cache = size;
}

void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_registers = size;
}

void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_threshold = size;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t new_value) {
  for (int i = 0; i < cfg->num_tuning_params; i++) {
    if (strcmp(param_name, cfg->tuning_param_names[i]) == 0) {
      cfg->tuning_params[i] = new_value;
      return 0;
    }
  }
  if (strcmp(param_name, "default_thread_block_size") == 0 ||
      strcmp(param_name, "default_group_size") == 0) {
    cfg->gpu.default_block_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_grid_size") == 0 ||
      strcmp(param_name, "default_num_groups") == 0) {
    cfg->gpu.default_grid_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_threshold") == 0) {
    cfg->gpu.default_threshold = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_tile_size") == 0) {
    cfg->gpu.default_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_reg_tile_size") == 0) {
    cfg->gpu.default_reg_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_cache") == 0) {
    cfg->gpu.default_cache = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_shared_memory") == 0) {
    cfg->gpu.default_shared_memory = new_value;
    return 0;
  }

  return 1;
}

// End of GPU command line optiopns.

// Max number of thead blocks we allow along the second or third
// dimension for transpositions.
#define MAX_TR_THREAD_BLOCKS 65535

struct builtin_kernels {
  // We have a lot of ways to transpose arrays.
  gpu_kernel map_transpose_1b;
  gpu_kernel map_transpose_1b_low_height;
  gpu_kernel map_transpose_1b_low_width;
  gpu_kernel map_transpose_1b_small;
  gpu_kernel map_transpose_1b_large;
  gpu_kernel map_transpose_2b;
  gpu_kernel map_transpose_2b_low_height;
  gpu_kernel map_transpose_2b_low_width;
  gpu_kernel map_transpose_2b_small;
  gpu_kernel map_transpose_2b_large;
  gpu_kernel map_transpose_4b;
  gpu_kernel map_transpose_4b_low_height;
  gpu_kernel map_transpose_4b_low_width;
  gpu_kernel map_transpose_4b_small;
  gpu_kernel map_transpose_4b_large;
  gpu_kernel map_transpose_8b;
  gpu_kernel map_transpose_8b_low_height;
  gpu_kernel map_transpose_8b_low_width;
  gpu_kernel map_transpose_8b_small;
  gpu_kernel map_transpose_8b_large;

  // And a few ways of copying.
  gpu_kernel lmad_copy_1b;
  gpu_kernel lmad_copy_2b;
  gpu_kernel lmad_copy_4b;
  gpu_kernel lmad_copy_8b;
};

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx) {
  struct builtin_kernels *kernels = malloc(sizeof(struct builtin_kernels));
  gpu_create_kernel(ctx, &kernels->map_transpose_1b, "map_transpose_1b");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_large, "map_transpose_1b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_height, "map_transpose_1b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_width, "map_transpose_1b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_small, "map_transpose_1b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_2b, "map_transpose_2b");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_large, "map_transpose_2b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_height, "map_transpose_2b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_width, "map_transpose_2b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_small, "map_transpose_2b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_4b, "map_transpose_4b");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_large, "map_transpose_4b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_height, "map_transpose_4b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_width, "map_transpose_4b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_small, "map_transpose_4b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_8b, "map_transpose_8b");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_large, "map_transpose_8b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_height, "map_transpose_8b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_width, "map_transpose_8b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_small, "map_transpose_8b_small");

  gpu_create_kernel(ctx, &kernels->lmad_copy_1b, "lmad_copy_1b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_2b, "lmad_copy_2b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_4b, "lmad_copy_4b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_8b, "lmad_copy_8b");

  return kernels;
}

void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels) {
  gpu_free_kernel(ctx, kernels->map_transpose_1b);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_2b);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_4b);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_8b);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_small);

  gpu_free_kernel(ctx, kernels->lmad_copy_1b);
  gpu_free_kernel(ctx, kernels->lmad_copy_2b);
  gpu_free_kernel(ctx, kernels->lmad_copy_4b);
  gpu_free_kernel(ctx, kernels->lmad_copy_8b);

  free(kernels);
}

static int gpu_alloc(struct futhark_context *ctx, FILE *log,
                     size_t min_size, const char *tag,
                     gpu_mem *mem_out, size_t *size_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  gpu_mem* memptr;
  if (free_list_find(&ctx->gpu_free_list, min_size, tag, size_out, (fl_mem*)&memptr) == 0) {
    // Successfully found a free block.  Is it big enough?
    if (*size_out >= min_size) {
      if (ctx->cfg->debugging) {
        fprintf(log, "No need to allocate: Found a block in the free list.\n");
      }
      *mem_out = *memptr;
      free(memptr);
      return FUTHARK_SUCCESS;
    } else {
      if (ctx->cfg->debugging) {
        fprintf(log, "Found a free block, but it was too small.\n");
      }
      int error = gpu_free_actual(ctx, *memptr);
      free(memptr);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    }
  }

  *size_out = min_size;

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg->debugging) {
    fprintf(log, "Actually allocating the desired block.\n");
  }

  int error = gpu_alloc_actual(ctx, min_size, mem_out);

  while (error == FUTHARK_OUT_OF_MEMORY) {
    if (ctx->cfg->debugging) {
      fprintf(log, "Out of GPU memory: releasing entry from the free list...\n");
    }
    gpu_mem* memptr;
    if (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
      gpu_mem mem = *memptr;
      free(memptr);
      error = gpu_free_actual(ctx, mem);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = gpu_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int gpu_free(struct futhark_context *ctx,
                    gpu_mem mem, size_t size, const char *tag) {
  gpu_mem* memptr = malloc(sizeof(gpu_mem));
  *memptr = mem;
  free_list_insert(&ctx->gpu_free_list, size, (fl_mem)memptr, tag);
  return FUTHARK_SUCCESS;
}

static int gpu_free_all(struct futhark_context *ctx) {
  free_list_pack(&ctx->gpu_free_list);
  gpu_mem* memptr;
  while (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
    gpu_mem mem = *memptr;
    free(memptr);
    int error = gpu_free_actual(ctx, mem);
    if (error != FUTHARK_SUCCESS) {
      return error;
    }
  }

  return FUTHARK_SUCCESS;
}

static int gpu_map_transpose(struct futhark_context* ctx,
                             gpu_kernel kernel_default,
                             gpu_kernel kernel_low_height,
                             gpu_kernel kernel_low_width,
                             gpu_kernel kernel_small,
                             gpu_kernel kernel_large,
                             const char *name, size_t elem_size,
                             gpu_mem dst, int64_t dst_offset,
                             gpu_mem src, int64_t src_offset,
                             int64_t k, int64_t n, int64_t m) {
  int64_t mulx = TR_BLOCK_DIM / n;
  int64_t muly = TR_BLOCK_DIM / m;
  int32_t mulx32 = mulx;
  int32_t muly32 = muly;
  int32_t k32 = k;
  int32_t n32 = n;
  int32_t m32 = m;

  gpu_kernel kernel = kernel_default;
  int32_t grid[3];
  int32_t block[3];

  void* args[11];
  size_t args_sizes[11] = {
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t)
  };

  args[0] = &dst;
  args[1] = &dst_offset;
  args[2] = &src;
  args[3] = &src_offset;
  args[7] = &mulx;
  args[8] = &muly;

  if (dst_offset + k * n * m <= 2147483647L &&
      src_offset + k * n * m <= 2147483647L) {
    if (m <= TR_BLOCK_DIM/2 && n <= TR_BLOCK_DIM/2) {
      if (ctx->logging) { fprintf(ctx->log, "Using small kernel\n"); }
      kernel = kernel_small;
      grid[0] = ((k * n * m) + (TR_BLOCK_DIM*TR_BLOCK_DIM) - 1) / (TR_BLOCK_DIM*TR_BLOCK_DIM);
      grid[1] = 1;
      grid[2] = 1;
      block[0] = TR_BLOCK_DIM*TR_BLOCK_DIM;
      block[1] = 1;
      block[2] = 1;
    } else if (m <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < n) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-width kernel\n"); }
      kernel = kernel_low_width;
      int64_t x_elems = m;
      int64_t y_elems = (n + muly - 1) / muly;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else if (n <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < m) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-height kernel\n"); }
      kernel = kernel_low_height;
      int64_t x_elems = (m + mulx - 1) / mulx;
      int64_t y_elems = n;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else {
      if (ctx->logging) { fprintf(ctx->log, "Using default kernel\n"); }
      kernel = kernel_default;
      grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[2] = k;
      block[0] = TR_TILE_DIM;
      block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
      block[2] = 1;
    }
    args[4] = &k32;
    args[5] = &m32;
    args[6] = &n32;
    args[7] = &mulx32;
    args[8] = &muly32;
  } else {
    if (ctx->logging) { fprintf(ctx->log, "Using large kernel\n"); }
    kernel = kernel_large;
    grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[2] = k;
    block[0] = TR_TILE_DIM;
    block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
    block[2] = 1;
    args[4] = &k;
    args[5] = &m;
    args[6] = &n;
    args[7] = &mulx;
    args[8] = &muly;
    args_sizes[4] = sizeof(int64_t);
    args_sizes[5] = sizeof(int64_t);
    args_sizes[6] = sizeof(int64_t);
    args_sizes[7] = sizeof(int64_t);
    args_sizes[8] = sizeof(int64_t);
  }

  // Cap the number of thead blocks we launch and figure out how many
  // repeats we need alongside each dimension.
  int32_t repeat_1 = grid[1] / MAX_TR_THREAD_BLOCKS;
  int32_t repeat_2 = grid[2] / MAX_TR_THREAD_BLOCKS;
  grid[1] = repeat_1 > 0 ? MAX_TR_THREAD_BLOCKS : grid[1];
  grid[2] = repeat_2 > 0 ? MAX_TR_THREAD_BLOCKS : grid[2];
  args[9] = &repeat_1;
  args[10] = &repeat_2;
  args_sizes[9] = sizeof(repeat_1);
  args_sizes[10] = sizeof(repeat_2);

  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return gpu_launch_kernel(ctx, kernel, name, grid, block,
                           TR_TILE_DIM*(TR_TILE_DIM+1)*elem_size,
                           sizeof(args)/sizeof(args[0]), args, args_sizes);
}

#define GEN_MAP_TRANSPOSE_GPU2GPU(NAME, ELEM_TYPE)                      \
  static int map_transpose_gpu2gpu_##NAME                               \
  (struct futhark_context* ctx,                                         \
   gpu_mem dst, int64_t dst_offset,                                     \
   gpu_mem src, int64_t src_offset,                                     \
   int64_t k, int64_t m, int64_t n)                                     \
  {                                                                     \
    return                                                              \
      gpu_map_transpose                                                 \
      (ctx,                                                             \
       ctx->kernels->map_transpose_##NAME,                              \
       ctx->kernels->map_transpose_##NAME##_low_height,                 \
       ctx->kernels->map_transpose_##NAME##_low_width,                  \
       ctx->kernels->map_transpose_##NAME##_small,                      \
       ctx->kernels->map_transpose_##NAME##_large,                      \
       "map_transpose_" #NAME, sizeof(ELEM_TYPE),                       \
       dst, dst_offset, src, src_offset,                                \
       k, n, m);                                                        \
  }

static int gpu_lmad_copy(struct futhark_context* ctx,
                         gpu_kernel kernel, int r,
                         gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                         gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                         int64_t shape[r]) {
  if (r > 8) {
    set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy array of greater than rank 8.\n"));
    return 1;
  }

  int64_t n = 1;
  for (int i = 0; i < r; i++) { n *= shape[i]; }

  void* args[6+(8*3)];
  size_t args_sizes[6+(8*3)];

  args[0] = &dst;
  args_sizes[0] = sizeof(gpu_mem);
  args[1] = &dst_offset;
  args_sizes[1] = sizeof(dst_offset);
  args[2] = &src;
  args_sizes[2] = sizeof(gpu_mem);
  args[3] = &src_offset;
  args_sizes[3] = sizeof(src_offset);
  args[4] = &n;
  args_sizes[4] = sizeof(n);
  args[5] = &r;
  args_sizes[5] = sizeof(r);

  int64_t zero = 0;

  for (int i = 0; i < 8; i++) {
    args_sizes[6+i*3] = sizeof(int64_t);
    args_sizes[6+i*3+1] = sizeof(int64_t);
    args_sizes[6+i*3+2] = sizeof(int64_t);
    if (i < r) {
      args[6+i*3] = &shape[i];
      args[6+i*3+1] = &dst_strides[i];
      args[6+i*3+2] = &src_strides[i];
    } else {
      args[6+i*3] = &zero;
      args[6+i*3+1] = &zero;
      args[6+i*3+2] = &zero;
    }
  }
  const size_t w = 256; // XXX: hardcoded thread block size.

  return gpu_launch_kernel(ctx, kernel, "copy_lmad_dev_to_dev",
                           (const int32_t[3]) {(n+w-1)/w,1,1},
                           (const int32_t[3]) {w,1,1},
                           0, 6+(8*3), args, args_sizes);
}

#define GEN_LMAD_COPY_ELEMENTS_GPU2GPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return gpu_lmad_copy(ctx, ctx->kernels->lmad_copy_##NAME, r,        \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \

#define GEN_LMAD_COPY_GPU2GPU(NAME, ELEM_TYPE)                          \
  static int lmad_copy_gpu2gpu_##NAME                                   \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "GPU to GPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return FUTHARK_SUCCESS; }                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                       r, dst_strides, src_strides, shape)) {           \
      log_transpose(ctx, k, n, m);                                      \
      return map_transpose_gpu2gpu_##NAME                               \
        (ctx, dst, dst_offset, src, src_offset, k, n, m);               \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}        \
      return gpu_memcpy(ctx,                                            \
                        dst, dst_offset*sizeof(ELEM_TYPE),              \
                        src, src_offset*sizeof(ELEM_TYPE),              \
                        size * sizeof(ELEM_TYPE));                      \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}     \
      return lmad_copy_elements_gpu2gpu_##NAME                          \
        (ctx, r,                                                        \
         dst, dst_offset, dst_strides,                                  \
         src, src_offset, src_strides,                                  \
         shape);                                                        \
    }                                                                   \
  }

static int
lmad_copy_elements_host2gpu(struct futhark_context *ctx, size_t elem_size,
                            int r,
                            gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                            unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                            int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from host to GPU.\n"));
  return 1;
}

static int
lmad_copy_elements_gpu2host (struct futhark_context *ctx, size_t elem_size,
                             int r,
                             unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                             gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                             int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from GPU to host.\n"));
  return 1;
}

#define GEN_LMAD_COPY_ELEMENTS_HOSTGPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return (ctx, ctx->kernels->lmad_copy_##NAME, r,                     \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \


static int lmad_copy_host2gpu(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                              unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_host2gpu(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_host2gpu
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

static int lmad_copy_gpu2host(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                              gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_gpu2host(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_gpu2host
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

GEN_MAP_TRANSPOSE_GPU2GPU(1b, uint8_t)
GEN_MAP_TRANSPOSE_GPU2GPU(2b, uint16_t)
GEN_MAP_TRANSPOSE_GPU2GPU(4b, uint32_t)
GEN_MAP_TRANSPOSE_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_GPU2GPU(8b, uint64_t)

// End of gpu.h

static int gpu_macros(struct futhark_context *ctx, char ***names_out, int64_t **values_out)
{
    int num_macros = 373;
    char **names = malloc(num_macros * sizeof(char *));
    int64_t *values = malloc(num_macros * sizeof(int64_t));
    
    {
        names[0] = "min_idxzisegred_nonseg_66763_dim1";
        values[0] = *ctx->tuning_params.min_idxzisegred_tblock_sizze_66755;
    }
    {
        names[1] = "min_idxzisegred_nonseg_66763zisegred_tblock_sizze_66756";
        values[1] = *ctx->tuning_params.min_idxzisegred_tblock_sizze_66755;
    }
    {
        names[2] = "min_idxzisegred_nonseg_66763zichunk_sizze_76544";
        values[2] = (int64_t) 1;
    }
    {
        names[3] = "max_idxzisegred_nonseg_66773_dim1";
        values[3] = *ctx->tuning_params.max_idxzisegred_tblock_sizze_66765;
    }
    {
        names[4] = "max_idxzisegred_nonseg_66773zisegred_tblock_sizze_66766";
        values[4] = *ctx->tuning_params.max_idxzisegred_tblock_sizze_66765;
    }
    {
        names[5] = "max_idxzisegred_nonseg_66773zichunk_sizze_76544";
        values[5] = (int64_t) 1;
    }
    {
        names[6] = "inner_SMJ_shortzisegmap_68641_dim1";
        values[6] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68629;
    }
    {
        names[7] = "inner_SMJ_shortzisegmap_68641zisegmap_tblock_sizze_68637";
        values[7] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68629;
    }
    {
        names[8] = "inner_SMJ_shortzigpuseq_77296_dim1";
        values[8] = (int64_t) 1;
    }
    {
        names[9] = "inner_SMJ_shortzisegmap_68611_dim1";
        values[9] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68613;
    }
    {
        names[10] = "inner_SMJ_shortzisegmap_68611zisegmap_tblock_sizze_68614";
        values[10] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68613;
    }
    {
        names[11] = "inner_SMJ_shortzisegmap_68619_dim1";
        values[11] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68621;
    }
    {
        names[12] = "inner_SMJ_shortzisegmap_68619zisegmap_tblock_sizze_68622";
        values[12] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68621;
    }
    {
        names[13] = "inner_SMJ_shortzigpuseq_77249_dim1";
        values[13] = (int64_t) 1;
    }
    {
        names[14] = "inner_SMJ_shortzigpuseq_77243_dim1";
        values[14] = (int64_t) 1;
    }
    {
        names[15] = "inner_SMJ_shortzigpuseq_77237_dim1";
        values[15] = (int64_t) 1;
    }
    {
        names[16] = "inner_SMJ_shortzisegmap_68603_dim1";
        values[16] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68587;
    }
    {
        names[17] = "inner_SMJ_shortzisegmap_68603zisegmap_tblock_sizze_68599";
        values[17] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68587;
    }
    {
        names[18] = "inner_SMJ_shortzisegscan_68583_dim1";
        values[18] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68577;
    }
    {
        names[19] = "inner_SMJ_shortzisegscan_68583zisegscan_tblock_sizze_68578";
        values[19] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68577;
    }
    {
        names[20] = "inner_SMJ_shortzisegscan_68583zichunk_sizze_77080";
        values[20] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[21] = "inner_SMJ_shortzisegmap_68569_dim1";
        values[21] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68571;
    }
    {
        names[22] = "inner_SMJ_shortzisegmap_68569zisegmap_tblock_sizze_68572";
        values[22] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68571;
    }
    {
        names[23] = "inner_SMJ_shortzisegscan_68567_dim1";
        values[23] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68561;
    }
    {
        names[24] = "inner_SMJ_shortzisegscan_68567zisegscan_tblock_sizze_68562";
        values[24] = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68561;
    }
    {
        names[25] = "inner_SMJ_shortzisegscan_68567zichunk_sizze_76923";
        values[25] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[26] = "inner_SMJ_shortzigpuseq_76912_dim1";
        values[26] = (int64_t) 1;
    }
    {
        names[27] = "inner_SMJ_shortzisegmap_68556_dim1";
        values[27] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68543;
    }
    {
        names[28] = "inner_SMJ_shortzisegmap_68556zisegmap_tblock_sizze_68552";
        values[28] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68543;
    }
    {
        names[29] = "inner_SMJ_shortzisegmap_68535_dim1";
        values[29] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68521;
    }
    {
        names[30] = "inner_SMJ_shortzisegmap_68535zisegmap_tblock_sizze_68531";
        values[30] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68521;
    }
    {
        names[31] = "inner_SMJ_shortzisegmap_68514_dim1";
        values[31] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68501;
    }
    {
        names[32] = "inner_SMJ_shortzisegmap_68514zisegmap_tblock_sizze_68510";
        values[32] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68501;
    }
    {
        names[33] = "inner_SMJ_shortzisegmap_68493_dim1";
        values[33] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68479;
    }
    {
        names[34] = "inner_SMJ_shortzisegmap_68493zisegmap_tblock_sizze_68489";
        values[34] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68479;
    }
    {
        names[35] = "inner_SMJ_shortzisegmap_68472_dim1";
        values[35] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68459;
    }
    {
        names[36] = "inner_SMJ_shortzisegmap_68472zisegmap_tblock_sizze_68468";
        values[36] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68459;
    }
    {
        names[37] = "inner_SMJ_shortzisegmap_68451_dim1";
        values[37] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68437;
    }
    {
        names[38] = "inner_SMJ_shortzisegmap_68451zisegmap_tblock_sizze_68447";
        values[38] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68437;
    }
    {
        names[39] = "inner_SMJ_shortzisegmap_intrablock_74964_dim1";
        values[39] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965;
    }
    {
        names[40] = "inner_SMJ_shortzisegmap_intrablock_74964zitile_sizze_74966";
        values[40] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965;
    }
    {
        names[41] = "inner_SMJ_shortzisegmap_intrablock_74964zibytes_75583";
        values[41] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965;
    }
    {
        names[42] = "inner_SMJ_shortzisegmap_intrablock_74964zibytes_75585";
        values[42] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965;
    }
    {
        names[43] = "inner_SMJ_shortzisegmap_intrablock_74609_dim1";
        values[43] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610;
    }
    {
        names[44] = "inner_SMJ_shortzisegmap_intrablock_74609zitile_sizze_74611";
        values[44] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610;
    }
    {
        names[45] = "inner_SMJ_shortzisegmap_intrablock_74609zibytes_75644";
        values[45] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610;
    }
    {
        names[46] = "inner_SMJ_shortzisegmap_intrablock_74609zibytes_75646";
        values[46] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610;
    }
    {
        names[47] = "inner_SMJ_shortzigpuseq_76799_dim1";
        values[47] = (int64_t) 1;
    }
    {
        names[48] = "inner_SMJ_shortzigpuseq_76793_dim1";
        values[48] = (int64_t) 1;
    }
    {
        names[49] = "inner_SMJ_shortzigpuseq_76787_dim1";
        values[49] = (int64_t) 1;
    }
    {
        names[50] = "inner_SMJ_shortzigpuseq_76771_dim1";
        values[50] = (int64_t) 1;
    }
    {
        names[51] = "inner_SMJ_shortzigpuseq_76765_dim1";
        values[51] = (int64_t) 1;
    }
    {
        names[52] = "inner_SMJ_shortzisegmap_68099_dim1";
        values[52] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67930;
    }
    {
        names[53] = "inner_SMJ_shortzisegmap_68099zisegmap_tblock_sizze_68094";
        values[53] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67930;
    }
    {
        names[54] = "inner_SMJ_shortzisegmap_67725_dim1";
        values[54] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67513;
    }
    {
        names[55] = "inner_SMJ_shortzisegmap_67725zisegmap_tblock_sizze_67720";
        values[55] = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67513;
    }
    {
        names[56] = "inner_SMJ_shortzigpuseq_76703_dim1";
        values[56] = (int64_t) 1;
    }
    {
        names[57] = "inner_SMJ_shortzigpuseq_76697_dim1";
        values[57] = (int64_t) 1;
    }
    {
        names[58] = "inner_SMJ_shortzigpuseq_76691_dim1";
        values[58] = (int64_t) 1;
    }
    {
        names[59] = "inner_SMJ_shortzisegmap_intrablock_74254_dim1";
        values[59] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255;
    }
    {
        names[60] = "inner_SMJ_shortzisegmap_intrablock_74254zitile_sizze_74256";
        values[60] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255;
    }
    {
        names[61] = "inner_SMJ_shortzisegmap_intrablock_74254zibytes_75788";
        values[61] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255;
    }
    {
        names[62] = "inner_SMJ_shortzisegmap_intrablock_74254zibytes_75790";
        values[62] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255;
    }
    {
        names[63] = "inner_SMJ_shortzisegmap_intrablock_73899_dim1";
        values[63] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900;
    }
    {
        names[64] = "inner_SMJ_shortzisegmap_intrablock_73899zitile_sizze_73901";
        values[64] = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900;
    }
    {
        names[65] = "inner_SMJ_shortzisegmap_intrablock_73899zibytes_75849";
        values[65] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900;
    }
    {
        names[66] = "inner_SMJ_shortzisegmap_intrablock_73899zibytes_75851";
        values[66] = (int64_t) 2 * *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900;
    }
    {
        names[67] = "inner_SMJ_shortzigpuseq_76632_dim1";
        values[67] = (int64_t) 1;
    }
    {
        names[68] = "inner_SMJ_shortzigpuseq_76626_dim1";
        values[68] = (int64_t) 1;
    }
    {
        names[69] = "inner_SMJ_shortzigpuseq_76620_dim1";
        values[69] = (int64_t) 1;
    }
    {
        names[70] = "inner_SMJ_shortzigpuseq_76604_dim1";
        values[70] = (int64_t) 1;
    }
    {
        names[71] = "inner_SMJ_shortzigpuseq_76598_dim1";
        values[71] = (int64_t) 1;
    }
    {
        names[72] = "inner_SMJ_shortzigpuseq_76566_dim1";
        values[72] = (int64_t) 1;
    }
    {
        names[73] = "inner_SMJ_longzisegmap_71261_dim1";
        values[73] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71249;
    }
    {
        names[74] = "inner_SMJ_longzisegmap_71261zisegmap_tblock_sizze_71257";
        values[74] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71249;
    }
    {
        names[75] = "inner_SMJ_longzigpuseq_77276_dim1";
        values[75] = (int64_t) 1;
    }
    {
        names[76] = "inner_SMJ_longzisegmap_71231_dim1";
        values[76] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71233;
    }
    {
        names[77] = "inner_SMJ_longzisegmap_71231zisegmap_tblock_sizze_71234";
        values[77] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71233;
    }
    {
        names[78] = "inner_SMJ_longzisegmap_71239_dim1";
        values[78] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71241;
    }
    {
        names[79] = "inner_SMJ_longzisegmap_71239zisegmap_tblock_sizze_71242";
        values[79] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71241;
    }
    {
        names[80] = "inner_SMJ_longzigpuseq_77229_dim1";
        values[80] = (int64_t) 1;
    }
    {
        names[81] = "inner_SMJ_longzigpuseq_77223_dim1";
        values[81] = (int64_t) 1;
    }
    {
        names[82] = "inner_SMJ_longzigpuseq_77217_dim1";
        values[82] = (int64_t) 1;
    }
    {
        names[83] = "inner_SMJ_longzisegmap_71223_dim1";
        values[83] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71207;
    }
    {
        names[84] = "inner_SMJ_longzisegmap_71223zisegmap_tblock_sizze_71219";
        values[84] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71207;
    }
    {
        names[85] = "inner_SMJ_longzisegscan_71203_dim1";
        values[85] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71197;
    }
    {
        names[86] = "inner_SMJ_longzisegscan_71203zisegscan_tblock_sizze_71198";
        values[86] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71197;
    }
    {
        names[87] = "inner_SMJ_longzisegscan_71203zichunk_sizze_77060";
        values[87] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[88] = "inner_SMJ_longzisegmap_71189_dim1";
        values[88] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71191;
    }
    {
        names[89] = "inner_SMJ_longzisegmap_71189zisegmap_tblock_sizze_71192";
        values[89] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71191;
    }
    {
        names[90] = "inner_SMJ_longzisegscan_71187_dim1";
        values[90] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71181;
    }
    {
        names[91] = "inner_SMJ_longzisegscan_71187zisegscan_tblock_sizze_71182";
        values[91] = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71181;
    }
    {
        names[92] = "inner_SMJ_longzisegscan_71187zichunk_sizze_76903";
        values[92] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[93] = "inner_SMJ_longzigpuseq_76892_dim1";
        values[93] = (int64_t) 1;
    }
    {
        names[94] = "inner_SMJ_longzisegmap_71176_dim1";
        values[94] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71163;
    }
    {
        names[95] = "inner_SMJ_longzisegmap_71176zisegmap_tblock_sizze_71172";
        values[95] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71163;
    }
    {
        names[96] = "inner_SMJ_longzisegmap_71155_dim1";
        values[96] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71141;
    }
    {
        names[97] = "inner_SMJ_longzisegmap_71155zisegmap_tblock_sizze_71151";
        values[97] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71141;
    }
    {
        names[98] = "inner_SMJ_longzisegmap_71134_dim1";
        values[98] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71121;
    }
    {
        names[99] = "inner_SMJ_longzisegmap_71134zisegmap_tblock_sizze_71130";
        values[99] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71121;
    }
    {
        names[100] = "inner_SMJ_longzisegmap_71113_dim1";
        values[100] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71099;
    }
    {
        names[101] = "inner_SMJ_longzisegmap_71113zisegmap_tblock_sizze_71109";
        values[101] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71099;
    }
    {
        names[102] = "inner_SMJ_longzisegmap_71092_dim1";
        values[102] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71079;
    }
    {
        names[103] = "inner_SMJ_longzisegmap_71092zisegmap_tblock_sizze_71088";
        values[103] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71079;
    }
    {
        names[104] = "inner_SMJ_longzisegmap_71071_dim1";
        values[104] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71057;
    }
    {
        names[105] = "inner_SMJ_longzisegmap_71071zisegmap_tblock_sizze_71067";
        values[105] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71057;
    }
    {
        names[106] = "inner_SMJ_longzisegmap_intrablock_74964_dim1";
        values[106] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74965;
    }
    {
        names[107] = "inner_SMJ_longzisegmap_intrablock_74964zitile_sizze_74966";
        values[107] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74965;
    }
    {
        names[108] = "inner_SMJ_longzisegmap_intrablock_74964zibytes_75583";
        values[108] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_74965;
    }
    {
        names[109] = "inner_SMJ_longzisegmap_intrablock_74609_dim1";
        values[109] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74610;
    }
    {
        names[110] = "inner_SMJ_longzisegmap_intrablock_74609zitile_sizze_74611";
        values[110] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74610;
    }
    {
        names[111] = "inner_SMJ_longzisegmap_intrablock_74609zibytes_75644";
        values[111] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_74610;
    }
    {
        names[112] = "inner_SMJ_longzigpuseq_76779_dim1";
        values[112] = (int64_t) 1;
    }
    {
        names[113] = "inner_SMJ_longzigpuseq_76773_dim1";
        values[113] = (int64_t) 1;
    }
    {
        names[114] = "inner_SMJ_longzigpuseq_76767_dim1";
        values[114] = (int64_t) 1;
    }
    {
        names[115] = "inner_SMJ_longzigpuseq_76751_dim1";
        values[115] = (int64_t) 1;
    }
    {
        names[116] = "inner_SMJ_longzigpuseq_76745_dim1";
        values[116] = (int64_t) 1;
    }
    {
        names[117] = "inner_SMJ_longzisegmap_70719_dim1";
        values[117] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70550;
    }
    {
        names[118] = "inner_SMJ_longzisegmap_70719zisegmap_tblock_sizze_70714";
        values[118] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70550;
    }
    {
        names[119] = "inner_SMJ_longzisegmap_70345_dim1";
        values[119] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70133;
    }
    {
        names[120] = "inner_SMJ_longzisegmap_70345zisegmap_tblock_sizze_70340";
        values[120] = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70133;
    }
    {
        names[121] = "inner_SMJ_longzigpuseq_76683_dim1";
        values[121] = (int64_t) 1;
    }
    {
        names[122] = "inner_SMJ_longzigpuseq_76677_dim1";
        values[122] = (int64_t) 1;
    }
    {
        names[123] = "inner_SMJ_longzigpuseq_76671_dim1";
        values[123] = (int64_t) 1;
    }
    {
        names[124] = "inner_SMJ_longzisegmap_intrablock_74254_dim1";
        values[124] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74255;
    }
    {
        names[125] = "inner_SMJ_longzisegmap_intrablock_74254zitile_sizze_74256";
        values[125] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74255;
    }
    {
        names[126] = "inner_SMJ_longzisegmap_intrablock_74254zibytes_75788";
        values[126] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_74255;
    }
    {
        names[127] = "inner_SMJ_longzisegmap_intrablock_73899_dim1";
        values[127] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_73900;
    }
    {
        names[128] = "inner_SMJ_longzisegmap_intrablock_73899zitile_sizze_73901";
        values[128] = *ctx->tuning_params.inner_SMJ_longzitile_sizze_73900;
    }
    {
        names[129] = "inner_SMJ_longzisegmap_intrablock_73899zibytes_75849";
        values[129] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_longzitile_sizze_73900;
    }
    {
        names[130] = "inner_SMJ_longzigpuseq_76612_dim1";
        values[130] = (int64_t) 1;
    }
    {
        names[131] = "inner_SMJ_longzigpuseq_76606_dim1";
        values[131] = (int64_t) 1;
    }
    {
        names[132] = "inner_SMJ_longzigpuseq_76600_dim1";
        values[132] = (int64_t) 1;
    }
    {
        names[133] = "inner_SMJ_longzigpuseq_76584_dim1";
        values[133] = (int64_t) 1;
    }
    {
        names[134] = "inner_SMJ_longzigpuseq_76578_dim1";
        values[134] = (int64_t) 1;
    }
    {
        names[135] = "inner_SMJ_longzigpuseq_76566_dim1";
        values[135] = (int64_t) 1;
    }
    {
        names[136] = "inner_SMJ_intzisegmap_69951_dim1";
        values[136] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69939;
    }
    {
        names[137] = "inner_SMJ_intzisegmap_69951zisegmap_tblock_sizze_69947";
        values[137] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69939;
    }
    {
        names[138] = "inner_SMJ_intzigpuseq_77276_dim1";
        values[138] = (int64_t) 1;
    }
    {
        names[139] = "inner_SMJ_intzisegmap_69921_dim1";
        values[139] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69923;
    }
    {
        names[140] = "inner_SMJ_intzisegmap_69921zisegmap_tblock_sizze_69924";
        values[140] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69923;
    }
    {
        names[141] = "inner_SMJ_intzisegmap_69929_dim1";
        values[141] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69931;
    }
    {
        names[142] = "inner_SMJ_intzisegmap_69929zisegmap_tblock_sizze_69932";
        values[142] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69931;
    }
    {
        names[143] = "inner_SMJ_intzigpuseq_77229_dim1";
        values[143] = (int64_t) 1;
    }
    {
        names[144] = "inner_SMJ_intzigpuseq_77223_dim1";
        values[144] = (int64_t) 1;
    }
    {
        names[145] = "inner_SMJ_intzigpuseq_77217_dim1";
        values[145] = (int64_t) 1;
    }
    {
        names[146] = "inner_SMJ_intzisegmap_69913_dim1";
        values[146] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69897;
    }
    {
        names[147] = "inner_SMJ_intzisegmap_69913zisegmap_tblock_sizze_69909";
        values[147] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69897;
    }
    {
        names[148] = "inner_SMJ_intzisegscan_69893_dim1";
        values[148] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69887;
    }
    {
        names[149] = "inner_SMJ_intzisegscan_69893zisegscan_tblock_sizze_69888";
        values[149] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69887;
    }
    {
        names[150] = "inner_SMJ_intzisegscan_69893zichunk_sizze_77060";
        values[150] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[151] = "inner_SMJ_intzisegmap_69879_dim1";
        values[151] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69881;
    }
    {
        names[152] = "inner_SMJ_intzisegmap_69879zisegmap_tblock_sizze_69882";
        values[152] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69881;
    }
    {
        names[153] = "inner_SMJ_intzisegscan_69877_dim1";
        values[153] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69871;
    }
    {
        names[154] = "inner_SMJ_intzisegscan_69877zisegscan_tblock_sizze_69872";
        values[154] = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69871;
    }
    {
        names[155] = "inner_SMJ_intzisegscan_69877zichunk_sizze_76923";
        values[155] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[156] = "inner_SMJ_intzigpuseq_76912_dim1";
        values[156] = (int64_t) 1;
    }
    {
        names[157] = "inner_SMJ_intzisegmap_69866_dim1";
        values[157] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69853;
    }
    {
        names[158] = "inner_SMJ_intzisegmap_69866zisegmap_tblock_sizze_69862";
        values[158] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69853;
    }
    {
        names[159] = "inner_SMJ_intzisegmap_69845_dim1";
        values[159] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69831;
    }
    {
        names[160] = "inner_SMJ_intzisegmap_69845zisegmap_tblock_sizze_69841";
        values[160] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69831;
    }
    {
        names[161] = "inner_SMJ_intzisegmap_69824_dim1";
        values[161] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69811;
    }
    {
        names[162] = "inner_SMJ_intzisegmap_69824zisegmap_tblock_sizze_69820";
        values[162] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69811;
    }
    {
        names[163] = "inner_SMJ_intzisegmap_69803_dim1";
        values[163] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69789;
    }
    {
        names[164] = "inner_SMJ_intzisegmap_69803zisegmap_tblock_sizze_69799";
        values[164] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69789;
    }
    {
        names[165] = "inner_SMJ_intzisegmap_69782_dim1";
        values[165] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69769;
    }
    {
        names[166] = "inner_SMJ_intzisegmap_69782zisegmap_tblock_sizze_69778";
        values[166] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69769;
    }
    {
        names[167] = "inner_SMJ_intzisegmap_69761_dim1";
        values[167] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69747;
    }
    {
        names[168] = "inner_SMJ_intzisegmap_69761zisegmap_tblock_sizze_69757";
        values[168] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69747;
    }
    {
        names[169] = "inner_SMJ_intzisegmap_intrablock_74964_dim1";
        values[169] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965;
    }
    {
        names[170] = "inner_SMJ_intzisegmap_intrablock_74964zitile_sizze_74966";
        values[170] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965;
    }
    {
        names[171] = "inner_SMJ_intzisegmap_intrablock_74964zibytes_75583";
        values[171] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965;
    }
    {
        names[172] = "inner_SMJ_intzisegmap_intrablock_74964zibytes_75585";
        values[172] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965;
    }
    {
        names[173] = "inner_SMJ_intzisegmap_intrablock_74609_dim1";
        values[173] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610;
    }
    {
        names[174] = "inner_SMJ_intzisegmap_intrablock_74609zitile_sizze_74611";
        values[174] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610;
    }
    {
        names[175] = "inner_SMJ_intzisegmap_intrablock_74609zibytes_75644";
        values[175] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610;
    }
    {
        names[176] = "inner_SMJ_intzisegmap_intrablock_74609zibytes_75646";
        values[176] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610;
    }
    {
        names[177] = "inner_SMJ_intzigpuseq_76799_dim1";
        values[177] = (int64_t) 1;
    }
    {
        names[178] = "inner_SMJ_intzigpuseq_76793_dim1";
        values[178] = (int64_t) 1;
    }
    {
        names[179] = "inner_SMJ_intzigpuseq_76787_dim1";
        values[179] = (int64_t) 1;
    }
    {
        names[180] = "inner_SMJ_intzigpuseq_76771_dim1";
        values[180] = (int64_t) 1;
    }
    {
        names[181] = "inner_SMJ_intzigpuseq_76765_dim1";
        values[181] = (int64_t) 1;
    }
    {
        names[182] = "inner_SMJ_intzisegmap_69409_dim1";
        values[182] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69240;
    }
    {
        names[183] = "inner_SMJ_intzisegmap_69409zisegmap_tblock_sizze_69404";
        values[183] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69240;
    }
    {
        names[184] = "inner_SMJ_intzisegmap_69035_dim1";
        values[184] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_68823;
    }
    {
        names[185] = "inner_SMJ_intzisegmap_69035zisegmap_tblock_sizze_69030";
        values[185] = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_68823;
    }
    {
        names[186] = "inner_SMJ_intzigpuseq_76703_dim1";
        values[186] = (int64_t) 1;
    }
    {
        names[187] = "inner_SMJ_intzigpuseq_76697_dim1";
        values[187] = (int64_t) 1;
    }
    {
        names[188] = "inner_SMJ_intzigpuseq_76691_dim1";
        values[188] = (int64_t) 1;
    }
    {
        names[189] = "inner_SMJ_intzisegmap_intrablock_74254_dim1";
        values[189] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255;
    }
    {
        names[190] = "inner_SMJ_intzisegmap_intrablock_74254zitile_sizze_74256";
        values[190] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255;
    }
    {
        names[191] = "inner_SMJ_intzisegmap_intrablock_74254zibytes_75788";
        values[191] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255;
    }
    {
        names[192] = "inner_SMJ_intzisegmap_intrablock_74254zibytes_75790";
        values[192] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255;
    }
    {
        names[193] = "inner_SMJ_intzisegmap_intrablock_73899_dim1";
        values[193] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900;
    }
    {
        names[194] = "inner_SMJ_intzisegmap_intrablock_73899zitile_sizze_73901";
        values[194] = *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900;
    }
    {
        names[195] = "inner_SMJ_intzisegmap_intrablock_73899zibytes_75849";
        values[195] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900;
    }
    {
        names[196] = "inner_SMJ_intzisegmap_intrablock_73899zibytes_75851";
        values[196] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900;
    }
    {
        names[197] = "inner_SMJ_intzigpuseq_76632_dim1";
        values[197] = (int64_t) 1;
    }
    {
        names[198] = "inner_SMJ_intzigpuseq_76626_dim1";
        values[198] = (int64_t) 1;
    }
    {
        names[199] = "inner_SMJ_intzigpuseq_76620_dim1";
        values[199] = (int64_t) 1;
    }
    {
        names[200] = "inner_SMJ_intzigpuseq_76604_dim1";
        values[200] = (int64_t) 1;
    }
    {
        names[201] = "inner_SMJ_intzigpuseq_76598_dim1";
        values[201] = (int64_t) 1;
    }
    {
        names[202] = "inner_SMJ_intzigpuseq_76566_dim1";
        values[202] = (int64_t) 1;
    }
    {
        names[203] = "inner_SMJ_floatzisegmap_72571_dim1";
        values[203] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72559;
    }
    {
        names[204] = "inner_SMJ_floatzisegmap_72571zisegmap_tblock_sizze_72567";
        values[204] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72559;
    }
    {
        names[205] = "inner_SMJ_floatzigpuseq_77296_dim1";
        values[205] = (int64_t) 1;
    }
    {
        names[206] = "inner_SMJ_floatzisegmap_72541_dim1";
        values[206] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72543;
    }
    {
        names[207] = "inner_SMJ_floatzisegmap_72541zisegmap_tblock_sizze_72544";
        values[207] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72543;
    }
    {
        names[208] = "inner_SMJ_floatzisegmap_72549_dim1";
        values[208] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72551;
    }
    {
        names[209] = "inner_SMJ_floatzisegmap_72549zisegmap_tblock_sizze_72552";
        values[209] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72551;
    }
    {
        names[210] = "inner_SMJ_floatzigpuseq_77249_dim1";
        values[210] = (int64_t) 1;
    }
    {
        names[211] = "inner_SMJ_floatzigpuseq_77243_dim1";
        values[211] = (int64_t) 1;
    }
    {
        names[212] = "inner_SMJ_floatzigpuseq_77237_dim1";
        values[212] = (int64_t) 1;
    }
    {
        names[213] = "inner_SMJ_floatzisegmap_72533_dim1";
        values[213] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72517;
    }
    {
        names[214] = "inner_SMJ_floatzisegmap_72533zisegmap_tblock_sizze_72529";
        values[214] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72517;
    }
    {
        names[215] = "inner_SMJ_floatzisegscan_72513_dim1";
        values[215] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72507;
    }
    {
        names[216] = "inner_SMJ_floatzisegscan_72513zisegscan_tblock_sizze_72508";
        values[216] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72507;
    }
    {
        names[217] = "inner_SMJ_floatzisegscan_72513zichunk_sizze_77080";
        values[217] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[218] = "inner_SMJ_floatzisegmap_72499_dim1";
        values[218] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72501;
    }
    {
        names[219] = "inner_SMJ_floatzisegmap_72499zisegmap_tblock_sizze_72502";
        values[219] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72501;
    }
    {
        names[220] = "inner_SMJ_floatzisegscan_72497_dim1";
        values[220] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72491;
    }
    {
        names[221] = "inner_SMJ_floatzisegscan_72497zisegscan_tblock_sizze_72492";
        values[221] = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72491;
    }
    {
        names[222] = "inner_SMJ_floatzisegscan_72497zichunk_sizze_76923";
        values[222] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[223] = "inner_SMJ_floatzigpuseq_76912_dim1";
        values[223] = (int64_t) 1;
    }
    {
        names[224] = "inner_SMJ_floatzisegmap_72486_dim1";
        values[224] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72473;
    }
    {
        names[225] = "inner_SMJ_floatzisegmap_72486zisegmap_tblock_sizze_72482";
        values[225] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72473;
    }
    {
        names[226] = "inner_SMJ_floatzisegmap_72465_dim1";
        values[226] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72451;
    }
    {
        names[227] = "inner_SMJ_floatzisegmap_72465zisegmap_tblock_sizze_72461";
        values[227] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72451;
    }
    {
        names[228] = "inner_SMJ_floatzisegmap_72444_dim1";
        values[228] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72431;
    }
    {
        names[229] = "inner_SMJ_floatzisegmap_72444zisegmap_tblock_sizze_72440";
        values[229] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72431;
    }
    {
        names[230] = "inner_SMJ_floatzisegmap_72423_dim1";
        values[230] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72409;
    }
    {
        names[231] = "inner_SMJ_floatzisegmap_72423zisegmap_tblock_sizze_72419";
        values[231] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72409;
    }
    {
        names[232] = "inner_SMJ_floatzisegmap_72402_dim1";
        values[232] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72389;
    }
    {
        names[233] = "inner_SMJ_floatzisegmap_72402zisegmap_tblock_sizze_72398";
        values[233] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72389;
    }
    {
        names[234] = "inner_SMJ_floatzisegmap_72381_dim1";
        values[234] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72367;
    }
    {
        names[235] = "inner_SMJ_floatzisegmap_72381zisegmap_tblock_sizze_72377";
        values[235] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72367;
    }
    {
        names[236] = "inner_SMJ_floatzisegmap_intrablock_74964_dim1";
        values[236] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965;
    }
    {
        names[237] = "inner_SMJ_floatzisegmap_intrablock_74964zitile_sizze_74966";
        values[237] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965;
    }
    {
        names[238] = "inner_SMJ_floatzisegmap_intrablock_74964zibytes_75583";
        values[238] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965;
    }
    {
        names[239] = "inner_SMJ_floatzisegmap_intrablock_74964zibytes_75585";
        values[239] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965;
    }
    {
        names[240] = "inner_SMJ_floatzisegmap_intrablock_74609_dim1";
        values[240] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610;
    }
    {
        names[241] = "inner_SMJ_floatzisegmap_intrablock_74609zitile_sizze_74611";
        values[241] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610;
    }
    {
        names[242] = "inner_SMJ_floatzisegmap_intrablock_74609zibytes_75644";
        values[242] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610;
    }
    {
        names[243] = "inner_SMJ_floatzisegmap_intrablock_74609zibytes_75646";
        values[243] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610;
    }
    {
        names[244] = "inner_SMJ_floatzigpuseq_76799_dim1";
        values[244] = (int64_t) 1;
    }
    {
        names[245] = "inner_SMJ_floatzigpuseq_76793_dim1";
        values[245] = (int64_t) 1;
    }
    {
        names[246] = "inner_SMJ_floatzigpuseq_76787_dim1";
        values[246] = (int64_t) 1;
    }
    {
        names[247] = "inner_SMJ_floatzigpuseq_76771_dim1";
        values[247] = (int64_t) 1;
    }
    {
        names[248] = "inner_SMJ_floatzigpuseq_76765_dim1";
        values[248] = (int64_t) 1;
    }
    {
        names[249] = "inner_SMJ_floatzisegmap_72029_dim1";
        values[249] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71860;
    }
    {
        names[250] = "inner_SMJ_floatzisegmap_72029zisegmap_tblock_sizze_72024";
        values[250] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71860;
    }
    {
        names[251] = "inner_SMJ_floatzisegmap_71655_dim1";
        values[251] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71443;
    }
    {
        names[252] = "inner_SMJ_floatzisegmap_71655zisegmap_tblock_sizze_71650";
        values[252] = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71443;
    }
    {
        names[253] = "inner_SMJ_floatzigpuseq_76703_dim1";
        values[253] = (int64_t) 1;
    }
    {
        names[254] = "inner_SMJ_floatzigpuseq_76697_dim1";
        values[254] = (int64_t) 1;
    }
    {
        names[255] = "inner_SMJ_floatzigpuseq_76691_dim1";
        values[255] = (int64_t) 1;
    }
    {
        names[256] = "inner_SMJ_floatzisegmap_intrablock_74254_dim1";
        values[256] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255;
    }
    {
        names[257] = "inner_SMJ_floatzisegmap_intrablock_74254zitile_sizze_74256";
        values[257] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255;
    }
    {
        names[258] = "inner_SMJ_floatzisegmap_intrablock_74254zibytes_75788";
        values[258] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255;
    }
    {
        names[259] = "inner_SMJ_floatzisegmap_intrablock_74254zibytes_75790";
        values[259] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255;
    }
    {
        names[260] = "inner_SMJ_floatzisegmap_intrablock_73899_dim1";
        values[260] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900;
    }
    {
        names[261] = "inner_SMJ_floatzisegmap_intrablock_73899zitile_sizze_73901";
        values[261] = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900;
    }
    {
        names[262] = "inner_SMJ_floatzisegmap_intrablock_73899zibytes_75849";
        values[262] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900;
    }
    {
        names[263] = "inner_SMJ_floatzisegmap_intrablock_73899zibytes_75851";
        values[263] = (int64_t) 4 * *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900;
    }
    {
        names[264] = "inner_SMJ_floatzigpuseq_76632_dim1";
        values[264] = (int64_t) 1;
    }
    {
        names[265] = "inner_SMJ_floatzigpuseq_76626_dim1";
        values[265] = (int64_t) 1;
    }
    {
        names[266] = "inner_SMJ_floatzigpuseq_76620_dim1";
        values[266] = (int64_t) 1;
    }
    {
        names[267] = "inner_SMJ_floatzigpuseq_76604_dim1";
        values[267] = (int64_t) 1;
    }
    {
        names[268] = "inner_SMJ_floatzigpuseq_76598_dim1";
        values[268] = (int64_t) 1;
    }
    {
        names[269] = "inner_SMJ_floatzigpuseq_76566_dim1";
        values[269] = (int64_t) 1;
    }
    {
        names[270] = "inner_SMJ_doublezisegmap_73881_dim1";
        values[270] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73869;
    }
    {
        names[271] = "inner_SMJ_doublezisegmap_73881zisegmap_tblock_sizze_73877";
        values[271] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73869;
    }
    {
        names[272] = "inner_SMJ_doublezigpuseq_77296_dim1";
        values[272] = (int64_t) 1;
    }
    {
        names[273] = "inner_SMJ_doublezisegmap_73851_dim1";
        values[273] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73853;
    }
    {
        names[274] = "inner_SMJ_doublezisegmap_73851zisegmap_tblock_sizze_73854";
        values[274] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73853;
    }
    {
        names[275] = "inner_SMJ_doublezisegmap_73859_dim1";
        values[275] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73861;
    }
    {
        names[276] = "inner_SMJ_doublezisegmap_73859zisegmap_tblock_sizze_73862";
        values[276] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73861;
    }
    {
        names[277] = "inner_SMJ_doublezigpuseq_77249_dim1";
        values[277] = (int64_t) 1;
    }
    {
        names[278] = "inner_SMJ_doublezigpuseq_77243_dim1";
        values[278] = (int64_t) 1;
    }
    {
        names[279] = "inner_SMJ_doublezigpuseq_77237_dim1";
        values[279] = (int64_t) 1;
    }
    {
        names[280] = "inner_SMJ_doublezisegmap_73843_dim1";
        values[280] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73827;
    }
    {
        names[281] = "inner_SMJ_doublezisegmap_73843zisegmap_tblock_sizze_73839";
        values[281] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73827;
    }
    {
        names[282] = "inner_SMJ_doublezisegscan_73823_dim1";
        values[282] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73817;
    }
    {
        names[283] = "inner_SMJ_doublezisegscan_73823zisegscan_tblock_sizze_73818";
        values[283] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73817;
    }
    {
        names[284] = "inner_SMJ_doublezisegscan_73823zichunk_sizze_77080";
        values[284] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[285] = "inner_SMJ_doublezisegmap_73809_dim1";
        values[285] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73811;
    }
    {
        names[286] = "inner_SMJ_doublezisegmap_73809zisegmap_tblock_sizze_73812";
        values[286] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73811;
    }
    {
        names[287] = "inner_SMJ_doublezisegscan_73807_dim1";
        values[287] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73801;
    }
    {
        names[288] = "inner_SMJ_doublezisegscan_73807zisegscan_tblock_sizze_73802";
        values[288] = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73801;
    }
    {
        names[289] = "inner_SMJ_doublezisegscan_73807zichunk_sizze_76923";
        values[289] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[290] = "inner_SMJ_doublezigpuseq_76912_dim1";
        values[290] = (int64_t) 1;
    }
    {
        names[291] = "inner_SMJ_doublezisegmap_73796_dim1";
        values[291] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73783;
    }
    {
        names[292] = "inner_SMJ_doublezisegmap_73796zisegmap_tblock_sizze_73792";
        values[292] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73783;
    }
    {
        names[293] = "inner_SMJ_doublezisegmap_73775_dim1";
        values[293] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73761;
    }
    {
        names[294] = "inner_SMJ_doublezisegmap_73775zisegmap_tblock_sizze_73771";
        values[294] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73761;
    }
    {
        names[295] = "inner_SMJ_doublezisegmap_73754_dim1";
        values[295] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73741;
    }
    {
        names[296] = "inner_SMJ_doublezisegmap_73754zisegmap_tblock_sizze_73750";
        values[296] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73741;
    }
    {
        names[297] = "inner_SMJ_doublezisegmap_73733_dim1";
        values[297] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73719;
    }
    {
        names[298] = "inner_SMJ_doublezisegmap_73733zisegmap_tblock_sizze_73729";
        values[298] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73719;
    }
    {
        names[299] = "inner_SMJ_doublezisegmap_73712_dim1";
        values[299] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73699;
    }
    {
        names[300] = "inner_SMJ_doublezisegmap_73712zisegmap_tblock_sizze_73708";
        values[300] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73699;
    }
    {
        names[301] = "inner_SMJ_doublezisegmap_73691_dim1";
        values[301] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73677;
    }
    {
        names[302] = "inner_SMJ_doublezisegmap_73691zisegmap_tblock_sizze_73687";
        values[302] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73677;
    }
    {
        names[303] = "inner_SMJ_doublezisegmap_intrablock_74964_dim1";
        values[303] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965;
    }
    {
        names[304] = "inner_SMJ_doublezisegmap_intrablock_74964zitile_sizze_74966";
        values[304] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965;
    }
    {
        names[305] = "inner_SMJ_doublezisegmap_intrablock_74964zibytes_75583";
        values[305] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965;
    }
    {
        names[306] = "inner_SMJ_doublezisegmap_intrablock_74609_dim1";
        values[306] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610;
    }
    {
        names[307] = "inner_SMJ_doublezisegmap_intrablock_74609zitile_sizze_74611";
        values[307] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610;
    }
    {
        names[308] = "inner_SMJ_doublezisegmap_intrablock_74609zibytes_75644";
        values[308] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610;
    }
    {
        names[309] = "inner_SMJ_doublezigpuseq_76799_dim1";
        values[309] = (int64_t) 1;
    }
    {
        names[310] = "inner_SMJ_doublezigpuseq_76793_dim1";
        values[310] = (int64_t) 1;
    }
    {
        names[311] = "inner_SMJ_doublezigpuseq_76787_dim1";
        values[311] = (int64_t) 1;
    }
    {
        names[312] = "inner_SMJ_doublezigpuseq_76771_dim1";
        values[312] = (int64_t) 1;
    }
    {
        names[313] = "inner_SMJ_doublezigpuseq_76765_dim1";
        values[313] = (int64_t) 1;
    }
    {
        names[314] = "inner_SMJ_doublezisegmap_73339_dim1";
        values[314] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73170;
    }
    {
        names[315] = "inner_SMJ_doublezisegmap_73339zisegmap_tblock_sizze_73334";
        values[315] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73170;
    }
    {
        names[316] = "inner_SMJ_doublezisegmap_72965_dim1";
        values[316] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_72753;
    }
    {
        names[317] = "inner_SMJ_doublezisegmap_72965zisegmap_tblock_sizze_72960";
        values[317] = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_72753;
    }
    {
        names[318] = "inner_SMJ_doublezigpuseq_76703_dim1";
        values[318] = (int64_t) 1;
    }
    {
        names[319] = "inner_SMJ_doublezigpuseq_76697_dim1";
        values[319] = (int64_t) 1;
    }
    {
        names[320] = "inner_SMJ_doublezigpuseq_76691_dim1";
        values[320] = (int64_t) 1;
    }
    {
        names[321] = "inner_SMJ_doublezisegmap_intrablock_74254_dim1";
        values[321] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255;
    }
    {
        names[322] = "inner_SMJ_doublezisegmap_intrablock_74254zitile_sizze_74256";
        values[322] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255;
    }
    {
        names[323] = "inner_SMJ_doublezisegmap_intrablock_74254zibytes_75788";
        values[323] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255;
    }
    {
        names[324] = "inner_SMJ_doublezisegmap_intrablock_73899_dim1";
        values[324] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900;
    }
    {
        names[325] = "inner_SMJ_doublezisegmap_intrablock_73899zitile_sizze_73901";
        values[325] = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900;
    }
    {
        names[326] = "inner_SMJ_doublezisegmap_intrablock_73899zibytes_75849";
        values[326] = (int64_t) 8 * *ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900;
    }
    {
        names[327] = "inner_SMJ_doublezigpuseq_76632_dim1";
        values[327] = (int64_t) 1;
    }
    {
        names[328] = "inner_SMJ_doublezigpuseq_76626_dim1";
        values[328] = (int64_t) 1;
    }
    {
        names[329] = "inner_SMJ_doublezigpuseq_76620_dim1";
        values[329] = (int64_t) 1;
    }
    {
        names[330] = "inner_SMJ_doublezigpuseq_76604_dim1";
        values[330] = (int64_t) 1;
    }
    {
        names[331] = "inner_SMJ_doublezigpuseq_76598_dim1";
        values[331] = (int64_t) 1;
    }
    {
        names[332] = "inner_SMJ_doublezigpuseq_76566_dim1";
        values[332] = (int64_t) 1;
    }
    {
        names[333] = "gather_payloads_short_GFURzisegmap_67097_dim1";
        values[333] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67075;
    }
    {
        names[334] = "gather_payloads_short_GFURzisegmap_67097zisegmap_tblock_sizze_67093";
        values[334] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67075;
    }
    {
        names[335] = "gather_payloads_short_GFURzisegmap_67069_dim1";
        values[335] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67057;
    }
    {
        names[336] = "gather_payloads_short_GFURzisegmap_67069zisegmap_tblock_sizze_67065";
        values[336] = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67057;
    }
    {
        names[337] = "gather_payloads_shortzisegmap_66817_dim1";
        values[337] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66795;
    }
    {
        names[338] = "gather_payloads_shortzisegmap_66817zisegmap_tblock_sizze_66813";
        values[338] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66795;
    }
    {
        names[339] = "gather_payloads_shortzisegmap_66789_dim1";
        values[339] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66777;
    }
    {
        names[340] = "gather_payloads_shortzisegmap_66789zisegmap_tblock_sizze_66785";
        values[340] = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66777;
    }
    {
        names[341] = "gather_payloads_long_GFURzisegmap_67209_dim1";
        values[341] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67187;
    }
    {
        names[342] = "gather_payloads_long_GFURzisegmap_67209zisegmap_tblock_sizze_67205";
        values[342] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67187;
    }
    {
        names[343] = "gather_payloads_long_GFURzisegmap_67181_dim1";
        values[343] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67169;
    }
    {
        names[344] = "gather_payloads_long_GFURzisegmap_67181zisegmap_tblock_sizze_67177";
        values[344] = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67169;
    }
    {
        names[345] = "gather_payloads_longzisegmap_66929_dim1";
        values[345] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66907;
    }
    {
        names[346] = "gather_payloads_longzisegmap_66929zisegmap_tblock_sizze_66925";
        values[346] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66907;
    }
    {
        names[347] = "gather_payloads_longzisegmap_66901_dim1";
        values[347] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66889;
    }
    {
        names[348] = "gather_payloads_longzisegmap_66901zisegmap_tblock_sizze_66897";
        values[348] = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66889;
    }
    {
        names[349] = "gather_payloads_int_GFURzisegmap_67153_dim1";
        values[349] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67131;
    }
    {
        names[350] = "gather_payloads_int_GFURzisegmap_67153zisegmap_tblock_sizze_67149";
        values[350] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67131;
    }
    {
        names[351] = "gather_payloads_int_GFURzisegmap_67125_dim1";
        values[351] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67113;
    }
    {
        names[352] = "gather_payloads_int_GFURzisegmap_67125zisegmap_tblock_sizze_67121";
        values[352] = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67113;
    }
    {
        names[353] = "gather_payloads_intzisegmap_66873_dim1";
        values[353] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66851;
    }
    {
        names[354] = "gather_payloads_intzisegmap_66873zisegmap_tblock_sizze_66869";
        values[354] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66851;
    }
    {
        names[355] = "gather_payloads_intzisegmap_66845_dim1";
        values[355] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66833;
    }
    {
        names[356] = "gather_payloads_intzisegmap_66845zisegmap_tblock_sizze_66841";
        values[356] = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66833;
    }
    {
        names[357] = "gather_payloads_float_GFURzisegmap_67265_dim1";
        values[357] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67243;
    }
    {
        names[358] = "gather_payloads_float_GFURzisegmap_67265zisegmap_tblock_sizze_67261";
        values[358] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67243;
    }
    {
        names[359] = "gather_payloads_float_GFURzisegmap_67237_dim1";
        values[359] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67225;
    }
    {
        names[360] = "gather_payloads_float_GFURzisegmap_67237zisegmap_tblock_sizze_67233";
        values[360] = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67225;
    }
    {
        names[361] = "gather_payloads_floatzisegmap_66985_dim1";
        values[361] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66963;
    }
    {
        names[362] = "gather_payloads_floatzisegmap_66985zisegmap_tblock_sizze_66981";
        values[362] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66963;
    }
    {
        names[363] = "gather_payloads_floatzisegmap_66957_dim1";
        values[363] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66945;
    }
    {
        names[364] = "gather_payloads_floatzisegmap_66957zisegmap_tblock_sizze_66953";
        values[364] = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66945;
    }
    {
        names[365] = "gather_payloads_double_GFURzisegmap_67321_dim1";
        values[365] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67299;
    }
    {
        names[366] = "gather_payloads_double_GFURzisegmap_67321zisegmap_tblock_sizze_67317";
        values[366] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67299;
    }
    {
        names[367] = "gather_payloads_double_GFURzisegmap_67293_dim1";
        values[367] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67281;
    }
    {
        names[368] = "gather_payloads_double_GFURzisegmap_67293zisegmap_tblock_sizze_67289";
        values[368] = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67281;
    }
    {
        names[369] = "gather_payloads_doublezisegmap_67041_dim1";
        values[369] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67019;
    }
    {
        names[370] = "gather_payloads_doublezisegmap_67041zisegmap_tblock_sizze_67037";
        values[370] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67019;
    }
    {
        names[371] = "gather_payloads_doublezisegmap_67013_dim1";
        values[371] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67001;
    }
    {
        names[372] = "gather_payloads_doublezisegmap_67013zisegmap_tblock_sizze_67009";
        values[372] = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67001;
    }
    *names_out = names;
    *values_out = values;
    return num_macros;
}
static char *get_failure_msg(int failure_idx, int64_t args[])
{
    (void) args;
    switch (failure_idx) {
        
      case 0:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:430:5-41\n   #4  ftSMJ.fut:429:1-430:41\n", args[0], args[1]);
            break;
        }
        
      case 1:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:458:5-50\n   #4  ftSMJ.fut:457:1-458:50\n", args[0], args[1]);
            break;
        }
        
      case 2:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:427:5-41\n   #4  ftSMJ.fut:426:1-427:41\n", args[0], args[1]);
            break;
        }
        
      case 3:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:455:5-50\n   #4  ftSMJ.fut:454:1-455:50\n", args[0], args[1]);
            break;
        }
        
      case 4:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:421:5-41\n   #4  ftSMJ.fut:420:1-421:41\n", args[0], args[1]);
            break;
        }
        
      case 5:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:449:5-50\n   #4  ftSMJ.fut:448:1-449:50\n", args[0], args[1]);
            break;
        }
        
      case 6:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:424:5-41\n   #4  ftSMJ.fut:423:1-424:41\n", args[0], args[1]);
            break;
        }
        
      case 7:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:452:5-50\n   #4  ftSMJ.fut:451:1-452:50\n", args[0], args[1]);
            break;
        }
        
      case 8:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:418:5-41\n   #4  ftSMJ.fut:417:1-418:41\n", args[0], args[1]);
            break;
        }
        
      case 9:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftSMJ.fut:446:5-50\n   #4  ftSMJ.fut:445:1-446:50\n", args[0], args[1]);
            break;
        }
        
      case 10:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:44-49\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 11:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:55-60\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 12:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:168:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 13:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 14:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 15:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 16:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 17:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:120:8-14\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 18:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:31-39\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 19:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:45-50\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 20:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:15-24\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 21:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:31-38\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 22:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:15-22\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 23:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:28-35\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:402:133-136\n   #5  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 24:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:194:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 25:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 26:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 27:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:126:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 28:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 29:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 30:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:133:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 31:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 32:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 33:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 34:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 35:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 36:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:149:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 37:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 38:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 39:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 40:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 41:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n", args[0], args[1]);
            break;
        }
        
      case 42:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:44-49\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 43:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:55-60\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 44:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:168:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 45:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 46:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 47:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 48:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 49:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:120:8-14\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 50:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:31-39\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 51:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:45-50\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 52:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:15-24\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 53:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:31-38\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 54:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:15-22\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 55:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:28-35\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:389:133-136\n   #5  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 56:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:194:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 57:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 58:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 59:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:126:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 60:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 61:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 62:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:133:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 63:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 64:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 65:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 66:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 67:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 68:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:149:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 69:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 70:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 71:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 72:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 73:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n", args[0], args[1]);
            break;
        }
        
      case 74:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:44-49\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 75:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:55-60\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 76:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:168:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 77:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 78:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 79:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 80:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 81:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:120:8-14\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 82:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:31-39\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 83:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:45-50\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 84:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:15-24\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 85:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:31-38\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 86:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:15-22\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 87:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:28-35\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:363:133-136\n   #5  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 88:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:194:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 89:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 90:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 91:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:126:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 92:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 93:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 94:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:133:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 95:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 96:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 97:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 98:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 99:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 100:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:149:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 101:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 102:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 103:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 104:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 105:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n", args[0], args[1]);
            break;
        }
        
      case 106:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:44-49\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 107:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:55-60\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 108:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:168:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 109:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 110:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 111:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 112:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 113:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:120:8-14\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 114:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:31-39\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 115:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:45-50\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 116:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:15-24\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 117:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:31-38\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 118:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:15-22\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 119:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:28-35\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:376:133-136\n   #5  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 120:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:194:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 121:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 122:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 123:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:126:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 124:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 125:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 126:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:133:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 127:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 128:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 129:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 130:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 131:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 132:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:149:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 133:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 134:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 135:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 136:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 137:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n", args[0], args[1]);
            break;
        }
        
      case 138:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:44-49\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 139:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:150:55-60\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 140:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:168:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 141:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 142:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:179:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 143:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 144:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:186:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 145:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:120:8-14\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 146:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:31-39\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 147:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:118:45-50\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 148:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:15-24\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 149:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:126:31-38\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 150:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:15-22\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 151:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:136:28-35\n   #1  ftbasics.fut:190:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:155:8-215:8\n   #4  ftSMJ.fut:350:133-136\n   #5  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 152:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:194:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 153:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 154:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:195:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 155:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:126:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 156:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:127:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 157:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:128:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 158:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:133:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 159:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:134:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 160:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:135:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 161:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:136:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 162:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:137:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 163:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:138:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 164:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:149:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 165:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:150:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 166:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:151:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 167:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:152:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 168:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:153:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
        
      case 169:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftSMJ.fut:154:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:125:8-163:6\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n", args[0], args[1]);
            break;
        }
    }
    return strdup("Unknown error.  This is a compiler bug.");
}
struct program {
    int dummy;
    gpu_kernel builtinzhiota_i64ziiota_i64_76548;
    gpu_kernel builtinzhreplicate_f32zireplicate_76577;
    gpu_kernel builtinzhreplicate_f64zireplicate_76577;
    gpu_kernel builtinzhreplicate_i16zireplicate_76577;
    gpu_kernel builtinzhreplicate_i32zireplicate_76959;
    gpu_kernel builtinzhreplicate_i64zireplicate_76551;
    gpu_kernel builtinzhreplicate_i8zireplicate_76933;
    gpu_kernel gather_payloads_doublezisegmap_67013;
    gpu_kernel gather_payloads_doublezisegmap_67041;
    gpu_kernel gather_payloads_double_GFURzisegmap_67293;
    gpu_kernel gather_payloads_double_GFURzisegmap_67321;
    gpu_kernel gather_payloads_floatzisegmap_66957;
    gpu_kernel gather_payloads_floatzisegmap_66985;
    gpu_kernel gather_payloads_float_GFURzisegmap_67237;
    gpu_kernel gather_payloads_float_GFURzisegmap_67265;
    gpu_kernel gather_payloads_intzisegmap_66845;
    gpu_kernel gather_payloads_intzisegmap_66873;
    gpu_kernel gather_payloads_int_GFURzisegmap_67125;
    gpu_kernel gather_payloads_int_GFURzisegmap_67153;
    gpu_kernel gather_payloads_longzisegmap_66901;
    gpu_kernel gather_payloads_longzisegmap_66929;
    gpu_kernel gather_payloads_long_GFURzisegmap_67181;
    gpu_kernel gather_payloads_long_GFURzisegmap_67209;
    gpu_kernel gather_payloads_shortzisegmap_66789;
    gpu_kernel gather_payloads_shortzisegmap_66817;
    gpu_kernel gather_payloads_short_GFURzisegmap_67069;
    gpu_kernel gather_payloads_short_GFURzisegmap_67097;
    gpu_kernel inner_SMJ_doublezigpuseq_76566;
    gpu_kernel inner_SMJ_doublezigpuseq_76598;
    gpu_kernel inner_SMJ_doublezigpuseq_76604;
    gpu_kernel inner_SMJ_doublezigpuseq_76620;
    gpu_kernel inner_SMJ_doublezigpuseq_76626;
    gpu_kernel inner_SMJ_doublezigpuseq_76632;
    gpu_kernel inner_SMJ_doublezigpuseq_76691;
    gpu_kernel inner_SMJ_doublezigpuseq_76697;
    gpu_kernel inner_SMJ_doublezigpuseq_76703;
    gpu_kernel inner_SMJ_doublezigpuseq_76765;
    gpu_kernel inner_SMJ_doublezigpuseq_76771;
    gpu_kernel inner_SMJ_doublezigpuseq_76787;
    gpu_kernel inner_SMJ_doublezigpuseq_76793;
    gpu_kernel inner_SMJ_doublezigpuseq_76799;
    gpu_kernel inner_SMJ_doublezigpuseq_76912;
    gpu_kernel inner_SMJ_doublezigpuseq_77237;
    gpu_kernel inner_SMJ_doublezigpuseq_77243;
    gpu_kernel inner_SMJ_doublezigpuseq_77249;
    gpu_kernel inner_SMJ_doublezigpuseq_77296;
    gpu_kernel inner_SMJ_doublezireplicate_77303;
    gpu_kernel inner_SMJ_doublezireplicate_77323;
    gpu_kernel inner_SMJ_doublezisegmap_72965;
    gpu_kernel inner_SMJ_doublezisegmap_73339;
    gpu_kernel inner_SMJ_doublezisegmap_73691;
    gpu_kernel inner_SMJ_doublezisegmap_73712;
    gpu_kernel inner_SMJ_doublezisegmap_73733;
    gpu_kernel inner_SMJ_doublezisegmap_73754;
    gpu_kernel inner_SMJ_doublezisegmap_73775;
    gpu_kernel inner_SMJ_doublezisegmap_73796;
    gpu_kernel inner_SMJ_doublezisegmap_73809;
    gpu_kernel inner_SMJ_doublezisegmap_73843;
    gpu_kernel inner_SMJ_doublezisegmap_73851;
    gpu_kernel inner_SMJ_doublezisegmap_73859;
    gpu_kernel inner_SMJ_doublezisegmap_73881;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_73899;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_74254;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_74609;
    gpu_kernel inner_SMJ_doublezisegmap_intrablock_74964;
    gpu_kernel inner_SMJ_doublezisegscan_73807;
    gpu_kernel inner_SMJ_doublezisegscan_73823;
    gpu_kernel inner_SMJ_floatzigpuseq_76566;
    gpu_kernel inner_SMJ_floatzigpuseq_76598;
    gpu_kernel inner_SMJ_floatzigpuseq_76604;
    gpu_kernel inner_SMJ_floatzigpuseq_76620;
    gpu_kernel inner_SMJ_floatzigpuseq_76626;
    gpu_kernel inner_SMJ_floatzigpuseq_76632;
    gpu_kernel inner_SMJ_floatzigpuseq_76691;
    gpu_kernel inner_SMJ_floatzigpuseq_76697;
    gpu_kernel inner_SMJ_floatzigpuseq_76703;
    gpu_kernel inner_SMJ_floatzigpuseq_76765;
    gpu_kernel inner_SMJ_floatzigpuseq_76771;
    gpu_kernel inner_SMJ_floatzigpuseq_76787;
    gpu_kernel inner_SMJ_floatzigpuseq_76793;
    gpu_kernel inner_SMJ_floatzigpuseq_76799;
    gpu_kernel inner_SMJ_floatzigpuseq_76912;
    gpu_kernel inner_SMJ_floatzigpuseq_77237;
    gpu_kernel inner_SMJ_floatzigpuseq_77243;
    gpu_kernel inner_SMJ_floatzigpuseq_77249;
    gpu_kernel inner_SMJ_floatzigpuseq_77296;
    gpu_kernel inner_SMJ_floatzireplicate_77303;
    gpu_kernel inner_SMJ_floatzireplicate_77323;
    gpu_kernel inner_SMJ_floatzisegmap_71655;
    gpu_kernel inner_SMJ_floatzisegmap_72029;
    gpu_kernel inner_SMJ_floatzisegmap_72381;
    gpu_kernel inner_SMJ_floatzisegmap_72402;
    gpu_kernel inner_SMJ_floatzisegmap_72423;
    gpu_kernel inner_SMJ_floatzisegmap_72444;
    gpu_kernel inner_SMJ_floatzisegmap_72465;
    gpu_kernel inner_SMJ_floatzisegmap_72486;
    gpu_kernel inner_SMJ_floatzisegmap_72499;
    gpu_kernel inner_SMJ_floatzisegmap_72533;
    gpu_kernel inner_SMJ_floatzisegmap_72541;
    gpu_kernel inner_SMJ_floatzisegmap_72549;
    gpu_kernel inner_SMJ_floatzisegmap_72571;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_73899;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_74254;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_74609;
    gpu_kernel inner_SMJ_floatzisegmap_intrablock_74964;
    gpu_kernel inner_SMJ_floatzisegscan_72497;
    gpu_kernel inner_SMJ_floatzisegscan_72513;
    gpu_kernel inner_SMJ_intzigpuseq_76566;
    gpu_kernel inner_SMJ_intzigpuseq_76598;
    gpu_kernel inner_SMJ_intzigpuseq_76604;
    gpu_kernel inner_SMJ_intzigpuseq_76620;
    gpu_kernel inner_SMJ_intzigpuseq_76626;
    gpu_kernel inner_SMJ_intzigpuseq_76632;
    gpu_kernel inner_SMJ_intzigpuseq_76691;
    gpu_kernel inner_SMJ_intzigpuseq_76697;
    gpu_kernel inner_SMJ_intzigpuseq_76703;
    gpu_kernel inner_SMJ_intzigpuseq_76765;
    gpu_kernel inner_SMJ_intzigpuseq_76771;
    gpu_kernel inner_SMJ_intzigpuseq_76787;
    gpu_kernel inner_SMJ_intzigpuseq_76793;
    gpu_kernel inner_SMJ_intzigpuseq_76799;
    gpu_kernel inner_SMJ_intzigpuseq_76912;
    gpu_kernel inner_SMJ_intzigpuseq_77217;
    gpu_kernel inner_SMJ_intzigpuseq_77223;
    gpu_kernel inner_SMJ_intzigpuseq_77229;
    gpu_kernel inner_SMJ_intzigpuseq_77276;
    gpu_kernel inner_SMJ_intzireplicate_77283;
    gpu_kernel inner_SMJ_intzireplicate_77303;
    gpu_kernel inner_SMJ_intzisegmap_69035;
    gpu_kernel inner_SMJ_intzisegmap_69409;
    gpu_kernel inner_SMJ_intzisegmap_69761;
    gpu_kernel inner_SMJ_intzisegmap_69782;
    gpu_kernel inner_SMJ_intzisegmap_69803;
    gpu_kernel inner_SMJ_intzisegmap_69824;
    gpu_kernel inner_SMJ_intzisegmap_69845;
    gpu_kernel inner_SMJ_intzisegmap_69866;
    gpu_kernel inner_SMJ_intzisegmap_69879;
    gpu_kernel inner_SMJ_intzisegmap_69913;
    gpu_kernel inner_SMJ_intzisegmap_69921;
    gpu_kernel inner_SMJ_intzisegmap_69929;
    gpu_kernel inner_SMJ_intzisegmap_69951;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_73899;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_74254;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_74609;
    gpu_kernel inner_SMJ_intzisegmap_intrablock_74964;
    gpu_kernel inner_SMJ_intzisegscan_69877;
    gpu_kernel inner_SMJ_intzisegscan_69893;
    gpu_kernel inner_SMJ_longzigpuseq_76566;
    gpu_kernel inner_SMJ_longzigpuseq_76578;
    gpu_kernel inner_SMJ_longzigpuseq_76584;
    gpu_kernel inner_SMJ_longzigpuseq_76600;
    gpu_kernel inner_SMJ_longzigpuseq_76606;
    gpu_kernel inner_SMJ_longzigpuseq_76612;
    gpu_kernel inner_SMJ_longzigpuseq_76671;
    gpu_kernel inner_SMJ_longzigpuseq_76677;
    gpu_kernel inner_SMJ_longzigpuseq_76683;
    gpu_kernel inner_SMJ_longzigpuseq_76745;
    gpu_kernel inner_SMJ_longzigpuseq_76751;
    gpu_kernel inner_SMJ_longzigpuseq_76767;
    gpu_kernel inner_SMJ_longzigpuseq_76773;
    gpu_kernel inner_SMJ_longzigpuseq_76779;
    gpu_kernel inner_SMJ_longzigpuseq_76892;
    gpu_kernel inner_SMJ_longzigpuseq_77217;
    gpu_kernel inner_SMJ_longzigpuseq_77223;
    gpu_kernel inner_SMJ_longzigpuseq_77229;
    gpu_kernel inner_SMJ_longzigpuseq_77276;
    gpu_kernel inner_SMJ_longzireplicate_77283;
    gpu_kernel inner_SMJ_longzireplicate_77303;
    gpu_kernel inner_SMJ_longzisegmap_70345;
    gpu_kernel inner_SMJ_longzisegmap_70719;
    gpu_kernel inner_SMJ_longzisegmap_71071;
    gpu_kernel inner_SMJ_longzisegmap_71092;
    gpu_kernel inner_SMJ_longzisegmap_71113;
    gpu_kernel inner_SMJ_longzisegmap_71134;
    gpu_kernel inner_SMJ_longzisegmap_71155;
    gpu_kernel inner_SMJ_longzisegmap_71176;
    gpu_kernel inner_SMJ_longzisegmap_71189;
    gpu_kernel inner_SMJ_longzisegmap_71223;
    gpu_kernel inner_SMJ_longzisegmap_71231;
    gpu_kernel inner_SMJ_longzisegmap_71239;
    gpu_kernel inner_SMJ_longzisegmap_71261;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_73899;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_74254;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_74609;
    gpu_kernel inner_SMJ_longzisegmap_intrablock_74964;
    gpu_kernel inner_SMJ_longzisegscan_71187;
    gpu_kernel inner_SMJ_longzisegscan_71203;
    gpu_kernel inner_SMJ_shortzigpuseq_76566;
    gpu_kernel inner_SMJ_shortzigpuseq_76598;
    gpu_kernel inner_SMJ_shortzigpuseq_76604;
    gpu_kernel inner_SMJ_shortzigpuseq_76620;
    gpu_kernel inner_SMJ_shortzigpuseq_76626;
    gpu_kernel inner_SMJ_shortzigpuseq_76632;
    gpu_kernel inner_SMJ_shortzigpuseq_76691;
    gpu_kernel inner_SMJ_shortzigpuseq_76697;
    gpu_kernel inner_SMJ_shortzigpuseq_76703;
    gpu_kernel inner_SMJ_shortzigpuseq_76765;
    gpu_kernel inner_SMJ_shortzigpuseq_76771;
    gpu_kernel inner_SMJ_shortzigpuseq_76787;
    gpu_kernel inner_SMJ_shortzigpuseq_76793;
    gpu_kernel inner_SMJ_shortzigpuseq_76799;
    gpu_kernel inner_SMJ_shortzigpuseq_76912;
    gpu_kernel inner_SMJ_shortzigpuseq_77237;
    gpu_kernel inner_SMJ_shortzigpuseq_77243;
    gpu_kernel inner_SMJ_shortzigpuseq_77249;
    gpu_kernel inner_SMJ_shortzigpuseq_77296;
    gpu_kernel inner_SMJ_shortzireplicate_77303;
    gpu_kernel inner_SMJ_shortzireplicate_77323;
    gpu_kernel inner_SMJ_shortzisegmap_67725;
    gpu_kernel inner_SMJ_shortzisegmap_68099;
    gpu_kernel inner_SMJ_shortzisegmap_68451;
    gpu_kernel inner_SMJ_shortzisegmap_68472;
    gpu_kernel inner_SMJ_shortzisegmap_68493;
    gpu_kernel inner_SMJ_shortzisegmap_68514;
    gpu_kernel inner_SMJ_shortzisegmap_68535;
    gpu_kernel inner_SMJ_shortzisegmap_68556;
    gpu_kernel inner_SMJ_shortzisegmap_68569;
    gpu_kernel inner_SMJ_shortzisegmap_68603;
    gpu_kernel inner_SMJ_shortzisegmap_68611;
    gpu_kernel inner_SMJ_shortzisegmap_68619;
    gpu_kernel inner_SMJ_shortzisegmap_68641;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_73899;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_74254;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_74609;
    gpu_kernel inner_SMJ_shortzisegmap_intrablock_74964;
    gpu_kernel inner_SMJ_shortzisegscan_68567;
    gpu_kernel inner_SMJ_shortzisegscan_68583;
    gpu_kernel max_idxzisegred_nonseg_66773;
    gpu_kernel min_idxzisegred_nonseg_66763;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    gpu_create_kernel(ctx, &ctx->program->builtinzhiota_i64ziiota_i64_76548, "builtinzhiota_i64ziiota_i64_76548");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f32zireplicate_76577, "builtinzhreplicate_f32zireplicate_76577");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f64zireplicate_76577, "builtinzhreplicate_f64zireplicate_76577");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i16zireplicate_76577, "builtinzhreplicate_i16zireplicate_76577");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i32zireplicate_76959, "builtinzhreplicate_i32zireplicate_76959");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i64zireplicate_76551, "builtinzhreplicate_i64zireplicate_76551");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i8zireplicate_76933, "builtinzhreplicate_i8zireplicate_76933");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_doublezisegmap_67013, "gather_payloads_doublezisegmap_67013");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_doublezisegmap_67041, "gather_payloads_doublezisegmap_67041");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_double_GFURzisegmap_67293, "gather_payloads_double_GFURzisegmap_67293");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_double_GFURzisegmap_67321, "gather_payloads_double_GFURzisegmap_67321");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_floatzisegmap_66957, "gather_payloads_floatzisegmap_66957");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_floatzisegmap_66985, "gather_payloads_floatzisegmap_66985");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_float_GFURzisegmap_67237, "gather_payloads_float_GFURzisegmap_67237");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_float_GFURzisegmap_67265, "gather_payloads_float_GFURzisegmap_67265");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_intzisegmap_66845, "gather_payloads_intzisegmap_66845");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_intzisegmap_66873, "gather_payloads_intzisegmap_66873");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_int_GFURzisegmap_67125, "gather_payloads_int_GFURzisegmap_67125");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_int_GFURzisegmap_67153, "gather_payloads_int_GFURzisegmap_67153");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_longzisegmap_66901, "gather_payloads_longzisegmap_66901");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_longzisegmap_66929, "gather_payloads_longzisegmap_66929");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_long_GFURzisegmap_67181, "gather_payloads_long_GFURzisegmap_67181");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_long_GFURzisegmap_67209, "gather_payloads_long_GFURzisegmap_67209");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_shortzisegmap_66789, "gather_payloads_shortzisegmap_66789");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_shortzisegmap_66817, "gather_payloads_shortzisegmap_66817");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_short_GFURzisegmap_67069, "gather_payloads_short_GFURzisegmap_67069");
    gpu_create_kernel(ctx, &ctx->program->gather_payloads_short_GFURzisegmap_67097, "gather_payloads_short_GFURzisegmap_67097");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76566, "inner_SMJ_doublezigpuseq_76566");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76598, "inner_SMJ_doublezigpuseq_76598");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76604, "inner_SMJ_doublezigpuseq_76604");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76620, "inner_SMJ_doublezigpuseq_76620");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76626, "inner_SMJ_doublezigpuseq_76626");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76632, "inner_SMJ_doublezigpuseq_76632");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76691, "inner_SMJ_doublezigpuseq_76691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76697, "inner_SMJ_doublezigpuseq_76697");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76703, "inner_SMJ_doublezigpuseq_76703");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76765, "inner_SMJ_doublezigpuseq_76765");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76771, "inner_SMJ_doublezigpuseq_76771");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76787, "inner_SMJ_doublezigpuseq_76787");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76793, "inner_SMJ_doublezigpuseq_76793");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76799, "inner_SMJ_doublezigpuseq_76799");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_76912, "inner_SMJ_doublezigpuseq_76912");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_77237, "inner_SMJ_doublezigpuseq_77237");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_77243, "inner_SMJ_doublezigpuseq_77243");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_77249, "inner_SMJ_doublezigpuseq_77249");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezigpuseq_77296, "inner_SMJ_doublezigpuseq_77296");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezireplicate_77303, "inner_SMJ_doublezireplicate_77303");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezireplicate_77323, "inner_SMJ_doublezireplicate_77323");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_72965, "inner_SMJ_doublezisegmap_72965");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73339, "inner_SMJ_doublezisegmap_73339");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73691, "inner_SMJ_doublezisegmap_73691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73712, "inner_SMJ_doublezisegmap_73712");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73733, "inner_SMJ_doublezisegmap_73733");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73754, "inner_SMJ_doublezisegmap_73754");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73775, "inner_SMJ_doublezisegmap_73775");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73796, "inner_SMJ_doublezisegmap_73796");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73809, "inner_SMJ_doublezisegmap_73809");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73843, "inner_SMJ_doublezisegmap_73843");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73851, "inner_SMJ_doublezisegmap_73851");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73859, "inner_SMJ_doublezisegmap_73859");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_73881, "inner_SMJ_doublezisegmap_73881");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_73899, "inner_SMJ_doublezisegmap_intrablock_73899");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_74254, "inner_SMJ_doublezisegmap_intrablock_74254");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_74609, "inner_SMJ_doublezisegmap_intrablock_74609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegmap_intrablock_74964, "inner_SMJ_doublezisegmap_intrablock_74964");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegscan_73807, "inner_SMJ_doublezisegscan_73807");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_doublezisegscan_73823, "inner_SMJ_doublezisegscan_73823");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76566, "inner_SMJ_floatzigpuseq_76566");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76598, "inner_SMJ_floatzigpuseq_76598");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76604, "inner_SMJ_floatzigpuseq_76604");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76620, "inner_SMJ_floatzigpuseq_76620");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76626, "inner_SMJ_floatzigpuseq_76626");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76632, "inner_SMJ_floatzigpuseq_76632");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76691, "inner_SMJ_floatzigpuseq_76691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76697, "inner_SMJ_floatzigpuseq_76697");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76703, "inner_SMJ_floatzigpuseq_76703");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76765, "inner_SMJ_floatzigpuseq_76765");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76771, "inner_SMJ_floatzigpuseq_76771");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76787, "inner_SMJ_floatzigpuseq_76787");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76793, "inner_SMJ_floatzigpuseq_76793");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76799, "inner_SMJ_floatzigpuseq_76799");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_76912, "inner_SMJ_floatzigpuseq_76912");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_77237, "inner_SMJ_floatzigpuseq_77237");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_77243, "inner_SMJ_floatzigpuseq_77243");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_77249, "inner_SMJ_floatzigpuseq_77249");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzigpuseq_77296, "inner_SMJ_floatzigpuseq_77296");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzireplicate_77303, "inner_SMJ_floatzireplicate_77303");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzireplicate_77323, "inner_SMJ_floatzireplicate_77323");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_71655, "inner_SMJ_floatzisegmap_71655");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72029, "inner_SMJ_floatzisegmap_72029");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72381, "inner_SMJ_floatzisegmap_72381");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72402, "inner_SMJ_floatzisegmap_72402");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72423, "inner_SMJ_floatzisegmap_72423");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72444, "inner_SMJ_floatzisegmap_72444");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72465, "inner_SMJ_floatzisegmap_72465");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72486, "inner_SMJ_floatzisegmap_72486");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72499, "inner_SMJ_floatzisegmap_72499");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72533, "inner_SMJ_floatzisegmap_72533");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72541, "inner_SMJ_floatzisegmap_72541");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72549, "inner_SMJ_floatzisegmap_72549");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_72571, "inner_SMJ_floatzisegmap_72571");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_73899, "inner_SMJ_floatzisegmap_intrablock_73899");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_74254, "inner_SMJ_floatzisegmap_intrablock_74254");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_74609, "inner_SMJ_floatzisegmap_intrablock_74609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegmap_intrablock_74964, "inner_SMJ_floatzisegmap_intrablock_74964");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegscan_72497, "inner_SMJ_floatzisegscan_72497");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_floatzisegscan_72513, "inner_SMJ_floatzisegscan_72513");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76566, "inner_SMJ_intzigpuseq_76566");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76598, "inner_SMJ_intzigpuseq_76598");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76604, "inner_SMJ_intzigpuseq_76604");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76620, "inner_SMJ_intzigpuseq_76620");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76626, "inner_SMJ_intzigpuseq_76626");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76632, "inner_SMJ_intzigpuseq_76632");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76691, "inner_SMJ_intzigpuseq_76691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76697, "inner_SMJ_intzigpuseq_76697");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76703, "inner_SMJ_intzigpuseq_76703");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76765, "inner_SMJ_intzigpuseq_76765");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76771, "inner_SMJ_intzigpuseq_76771");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76787, "inner_SMJ_intzigpuseq_76787");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76793, "inner_SMJ_intzigpuseq_76793");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76799, "inner_SMJ_intzigpuseq_76799");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_76912, "inner_SMJ_intzigpuseq_76912");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_77217, "inner_SMJ_intzigpuseq_77217");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_77223, "inner_SMJ_intzigpuseq_77223");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_77229, "inner_SMJ_intzigpuseq_77229");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzigpuseq_77276, "inner_SMJ_intzigpuseq_77276");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzireplicate_77283, "inner_SMJ_intzireplicate_77283");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzireplicate_77303, "inner_SMJ_intzireplicate_77303");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69035, "inner_SMJ_intzisegmap_69035");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69409, "inner_SMJ_intzisegmap_69409");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69761, "inner_SMJ_intzisegmap_69761");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69782, "inner_SMJ_intzisegmap_69782");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69803, "inner_SMJ_intzisegmap_69803");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69824, "inner_SMJ_intzisegmap_69824");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69845, "inner_SMJ_intzisegmap_69845");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69866, "inner_SMJ_intzisegmap_69866");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69879, "inner_SMJ_intzisegmap_69879");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69913, "inner_SMJ_intzisegmap_69913");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69921, "inner_SMJ_intzisegmap_69921");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69929, "inner_SMJ_intzisegmap_69929");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_69951, "inner_SMJ_intzisegmap_69951");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_73899, "inner_SMJ_intzisegmap_intrablock_73899");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_74254, "inner_SMJ_intzisegmap_intrablock_74254");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_74609, "inner_SMJ_intzisegmap_intrablock_74609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegmap_intrablock_74964, "inner_SMJ_intzisegmap_intrablock_74964");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegscan_69877, "inner_SMJ_intzisegscan_69877");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_intzisegscan_69893, "inner_SMJ_intzisegscan_69893");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76566, "inner_SMJ_longzigpuseq_76566");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76578, "inner_SMJ_longzigpuseq_76578");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76584, "inner_SMJ_longzigpuseq_76584");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76600, "inner_SMJ_longzigpuseq_76600");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76606, "inner_SMJ_longzigpuseq_76606");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76612, "inner_SMJ_longzigpuseq_76612");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76671, "inner_SMJ_longzigpuseq_76671");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76677, "inner_SMJ_longzigpuseq_76677");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76683, "inner_SMJ_longzigpuseq_76683");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76745, "inner_SMJ_longzigpuseq_76745");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76751, "inner_SMJ_longzigpuseq_76751");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76767, "inner_SMJ_longzigpuseq_76767");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76773, "inner_SMJ_longzigpuseq_76773");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76779, "inner_SMJ_longzigpuseq_76779");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_76892, "inner_SMJ_longzigpuseq_76892");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_77217, "inner_SMJ_longzigpuseq_77217");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_77223, "inner_SMJ_longzigpuseq_77223");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_77229, "inner_SMJ_longzigpuseq_77229");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzigpuseq_77276, "inner_SMJ_longzigpuseq_77276");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzireplicate_77283, "inner_SMJ_longzireplicate_77283");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzireplicate_77303, "inner_SMJ_longzireplicate_77303");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_70345, "inner_SMJ_longzisegmap_70345");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_70719, "inner_SMJ_longzisegmap_70719");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71071, "inner_SMJ_longzisegmap_71071");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71092, "inner_SMJ_longzisegmap_71092");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71113, "inner_SMJ_longzisegmap_71113");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71134, "inner_SMJ_longzisegmap_71134");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71155, "inner_SMJ_longzisegmap_71155");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71176, "inner_SMJ_longzisegmap_71176");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71189, "inner_SMJ_longzisegmap_71189");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71223, "inner_SMJ_longzisegmap_71223");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71231, "inner_SMJ_longzisegmap_71231");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71239, "inner_SMJ_longzisegmap_71239");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_71261, "inner_SMJ_longzisegmap_71261");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_73899, "inner_SMJ_longzisegmap_intrablock_73899");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_74254, "inner_SMJ_longzisegmap_intrablock_74254");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_74609, "inner_SMJ_longzisegmap_intrablock_74609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegmap_intrablock_74964, "inner_SMJ_longzisegmap_intrablock_74964");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegscan_71187, "inner_SMJ_longzisegscan_71187");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_longzisegscan_71203, "inner_SMJ_longzisegscan_71203");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76566, "inner_SMJ_shortzigpuseq_76566");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76598, "inner_SMJ_shortzigpuseq_76598");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76604, "inner_SMJ_shortzigpuseq_76604");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76620, "inner_SMJ_shortzigpuseq_76620");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76626, "inner_SMJ_shortzigpuseq_76626");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76632, "inner_SMJ_shortzigpuseq_76632");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76691, "inner_SMJ_shortzigpuseq_76691");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76697, "inner_SMJ_shortzigpuseq_76697");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76703, "inner_SMJ_shortzigpuseq_76703");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76765, "inner_SMJ_shortzigpuseq_76765");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76771, "inner_SMJ_shortzigpuseq_76771");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76787, "inner_SMJ_shortzigpuseq_76787");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76793, "inner_SMJ_shortzigpuseq_76793");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76799, "inner_SMJ_shortzigpuseq_76799");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_76912, "inner_SMJ_shortzigpuseq_76912");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_77237, "inner_SMJ_shortzigpuseq_77237");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_77243, "inner_SMJ_shortzigpuseq_77243");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_77249, "inner_SMJ_shortzigpuseq_77249");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzigpuseq_77296, "inner_SMJ_shortzigpuseq_77296");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzireplicate_77303, "inner_SMJ_shortzireplicate_77303");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzireplicate_77323, "inner_SMJ_shortzireplicate_77323");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_67725, "inner_SMJ_shortzisegmap_67725");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68099, "inner_SMJ_shortzisegmap_68099");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68451, "inner_SMJ_shortzisegmap_68451");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68472, "inner_SMJ_shortzisegmap_68472");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68493, "inner_SMJ_shortzisegmap_68493");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68514, "inner_SMJ_shortzisegmap_68514");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68535, "inner_SMJ_shortzisegmap_68535");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68556, "inner_SMJ_shortzisegmap_68556");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68569, "inner_SMJ_shortzisegmap_68569");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68603, "inner_SMJ_shortzisegmap_68603");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68611, "inner_SMJ_shortzisegmap_68611");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68619, "inner_SMJ_shortzisegmap_68619");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_68641, "inner_SMJ_shortzisegmap_68641");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_73899, "inner_SMJ_shortzisegmap_intrablock_73899");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_74254, "inner_SMJ_shortzisegmap_intrablock_74254");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_74609, "inner_SMJ_shortzisegmap_intrablock_74609");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegmap_intrablock_74964, "inner_SMJ_shortzisegmap_intrablock_74964");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegscan_68567, "inner_SMJ_shortzisegscan_68567");
    gpu_create_kernel(ctx, &ctx->program->inner_SMJ_shortzisegscan_68583, "inner_SMJ_shortzisegscan_68583");
    gpu_create_kernel(ctx, &ctx->program->max_idxzisegred_nonseg_66773, "max_idxzisegred_nonseg_66773");
    gpu_create_kernel(ctx, &ctx->program->min_idxzisegred_nonseg_66763, "min_idxzisegred_nonseg_66763");
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    gpu_free_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_76548);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_76577);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_76577);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_76577);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_76959);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_76551);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_76933);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_67013);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_67041);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_67293);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_67321);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_66957);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_66985);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_67237);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_67265);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_intzisegmap_66845);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_intzisegmap_66873);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_67125);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_67153);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_longzisegmap_66901);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_longzisegmap_66929);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_67181);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_67209);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_66789);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_66817);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_67069);
    gpu_free_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_67097);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76566);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76598);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76604);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76620);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76626);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76632);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76697);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76703);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76765);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76771);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76787);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76793);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76799);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76912);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77237);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77243);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77249);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77296);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_77303);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_77323);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_72965);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73339);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73712);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73733);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73754);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73775);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73796);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73809);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73843);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73851);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73859);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73881);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_73899);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74254);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74964);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_73807);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_73823);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76566);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76598);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76604);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76620);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76626);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76632);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76697);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76703);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76765);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76771);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76787);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76793);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76799);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76912);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77237);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77243);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77249);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77296);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_77303);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_77323);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_71655);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72029);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72381);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72402);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72423);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72444);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72465);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72486);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72499);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72533);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72541);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72549);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72571);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_73899);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74254);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74964);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_72497);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_72513);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76566);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76598);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76604);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76620);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76626);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76632);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76697);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76703);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76765);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76771);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76787);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76793);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76799);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76912);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77217);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77223);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77229);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77276);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_77283);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_77303);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69035);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69409);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69761);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69782);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69803);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69824);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69845);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69866);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69879);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69913);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69921);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69929);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69951);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_73899);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74254);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74964);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_69877);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_69893);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76566);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76578);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76584);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76600);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76606);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76612);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76671);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76677);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76683);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76745);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76751);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76767);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76773);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76779);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76892);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77217);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77223);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77229);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77276);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_77283);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_77303);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_70345);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_70719);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71071);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71092);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71113);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71134);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71155);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71176);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71189);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71223);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71231);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71239);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71261);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_73899);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74254);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74964);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_71187);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_71203);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76566);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76598);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76604);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76620);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76626);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76632);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76691);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76697);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76703);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76765);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76771);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76787);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76793);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76799);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76912);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77237);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77243);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77249);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77296);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_77303);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_77323);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_67725);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68099);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68451);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68472);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68493);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68514);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68535);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68556);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68569);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68603);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68611);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68619);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68641);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_73899);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74254);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74609);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74964);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_68567);
    gpu_free_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_68583);
    gpu_free_kernel(ctx, ctx->program->max_idxzisegred_nonseg_66773);
    gpu_free_kernel(ctx, ctx->program->min_idxzisegred_nonseg_66763);
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
    ctx->tuning_params.builtinzhiota_i64zitblock_sizze_76552 = &ctx->cfg->tuning_params[0];
    ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_76581 = &ctx->cfg->tuning_params[1];
    ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_76581 = &ctx->cfg->tuning_params[2];
    ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_76581 = &ctx->cfg->tuning_params[3];
    ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_76963 = &ctx->cfg->tuning_params[4];
    ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_76555 = &ctx->cfg->tuning_params[5];
    ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_76937 = &ctx->cfg->tuning_params[6];
    ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67001 = &ctx->cfg->tuning_params[7];
    ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67019 = &ctx->cfg->tuning_params[8];
    ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67281 = &ctx->cfg->tuning_params[9];
    ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67299 = &ctx->cfg->tuning_params[10];
    ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66945 = &ctx->cfg->tuning_params[11];
    ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66963 = &ctx->cfg->tuning_params[12];
    ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67225 = &ctx->cfg->tuning_params[13];
    ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67243 = &ctx->cfg->tuning_params[14];
    ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66833 = &ctx->cfg->tuning_params[15];
    ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66851 = &ctx->cfg->tuning_params[16];
    ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67113 = &ctx->cfg->tuning_params[17];
    ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67131 = &ctx->cfg->tuning_params[18];
    ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66889 = &ctx->cfg->tuning_params[19];
    ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66907 = &ctx->cfg->tuning_params[20];
    ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67169 = &ctx->cfg->tuning_params[21];
    ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67187 = &ctx->cfg->tuning_params[22];
    ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66777 = &ctx->cfg->tuning_params[23];
    ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66795 = &ctx->cfg->tuning_params[24];
    ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67057 = &ctx->cfg->tuning_params[25];
    ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67075 = &ctx->cfg->tuning_params[26];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73813 = &ctx->cfg->tuning_params[27];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73855 = &ctx->cfg->tuning_params[28];
    ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73863 = &ctx->cfg->tuning_params[29];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_72753 = &ctx->cfg->tuning_params[30];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73170 = &ctx->cfg->tuning_params[31];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73677 = &ctx->cfg->tuning_params[32];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73699 = &ctx->cfg->tuning_params[33];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73719 = &ctx->cfg->tuning_params[34];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73741 = &ctx->cfg->tuning_params[35];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73761 = &ctx->cfg->tuning_params[36];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73783 = &ctx->cfg->tuning_params[37];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73811 = &ctx->cfg->tuning_params[38];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73827 = &ctx->cfg->tuning_params[39];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73853 = &ctx->cfg->tuning_params[40];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73861 = &ctx->cfg->tuning_params[41];
    ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73869 = &ctx->cfg->tuning_params[42];
    ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_73803 = &ctx->cfg->tuning_params[43];
    ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_73819 = &ctx->cfg->tuning_params[44];
    ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73801 = &ctx->cfg->tuning_params[45];
    ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73817 = &ctx->cfg->tuning_params[46];
    ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_0 = &ctx->cfg->tuning_params[47];
    ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_1 = &ctx->cfg->tuning_params[48];
    ctx->tuning_params.inner_SMJ_doublezitblock_sizze_77307 = &ctx->cfg->tuning_params[49];
    ctx->tuning_params.inner_SMJ_doublezitblock_sizze_77327 = &ctx->cfg->tuning_params[50];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900 = &ctx->cfg->tuning_params[51];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255 = &ctx->cfg->tuning_params[52];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610 = &ctx->cfg->tuning_params[53];
    ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965 = &ctx->cfg->tuning_params[54];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72503 = &ctx->cfg->tuning_params[55];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72545 = &ctx->cfg->tuning_params[56];
    ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72553 = &ctx->cfg->tuning_params[57];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71443 = &ctx->cfg->tuning_params[58];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71860 = &ctx->cfg->tuning_params[59];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72367 = &ctx->cfg->tuning_params[60];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72389 = &ctx->cfg->tuning_params[61];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72409 = &ctx->cfg->tuning_params[62];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72431 = &ctx->cfg->tuning_params[63];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72451 = &ctx->cfg->tuning_params[64];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72473 = &ctx->cfg->tuning_params[65];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72501 = &ctx->cfg->tuning_params[66];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72517 = &ctx->cfg->tuning_params[67];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72543 = &ctx->cfg->tuning_params[68];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72551 = &ctx->cfg->tuning_params[69];
    ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72559 = &ctx->cfg->tuning_params[70];
    ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_72493 = &ctx->cfg->tuning_params[71];
    ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_72509 = &ctx->cfg->tuning_params[72];
    ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72491 = &ctx->cfg->tuning_params[73];
    ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72507 = &ctx->cfg->tuning_params[74];
    ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_0 = &ctx->cfg->tuning_params[75];
    ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_1 = &ctx->cfg->tuning_params[76];
    ctx->tuning_params.inner_SMJ_floatzitblock_sizze_77307 = &ctx->cfg->tuning_params[77];
    ctx->tuning_params.inner_SMJ_floatzitblock_sizze_77327 = &ctx->cfg->tuning_params[78];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900 = &ctx->cfg->tuning_params[79];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255 = &ctx->cfg->tuning_params[80];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610 = &ctx->cfg->tuning_params[81];
    ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965 = &ctx->cfg->tuning_params[82];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69883 = &ctx->cfg->tuning_params[83];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69925 = &ctx->cfg->tuning_params[84];
    ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69933 = &ctx->cfg->tuning_params[85];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_68823 = &ctx->cfg->tuning_params[86];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69240 = &ctx->cfg->tuning_params[87];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69747 = &ctx->cfg->tuning_params[88];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69769 = &ctx->cfg->tuning_params[89];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69789 = &ctx->cfg->tuning_params[90];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69811 = &ctx->cfg->tuning_params[91];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69831 = &ctx->cfg->tuning_params[92];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69853 = &ctx->cfg->tuning_params[93];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69881 = &ctx->cfg->tuning_params[94];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69897 = &ctx->cfg->tuning_params[95];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69923 = &ctx->cfg->tuning_params[96];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69931 = &ctx->cfg->tuning_params[97];
    ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69939 = &ctx->cfg->tuning_params[98];
    ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_69873 = &ctx->cfg->tuning_params[99];
    ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_69889 = &ctx->cfg->tuning_params[100];
    ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69871 = &ctx->cfg->tuning_params[101];
    ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69887 = &ctx->cfg->tuning_params[102];
    ctx->tuning_params.inner_SMJ_intzisuff_outer_par_0 = &ctx->cfg->tuning_params[103];
    ctx->tuning_params.inner_SMJ_intzisuff_outer_par_1 = &ctx->cfg->tuning_params[104];
    ctx->tuning_params.inner_SMJ_intzitblock_sizze_77287 = &ctx->cfg->tuning_params[105];
    ctx->tuning_params.inner_SMJ_intzitblock_sizze_77307 = &ctx->cfg->tuning_params[106];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_73900 = &ctx->cfg->tuning_params[107];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_74255 = &ctx->cfg->tuning_params[108];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_74610 = &ctx->cfg->tuning_params[109];
    ctx->tuning_params.inner_SMJ_intzitile_sizze_74965 = &ctx->cfg->tuning_params[110];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71193 = &ctx->cfg->tuning_params[111];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71235 = &ctx->cfg->tuning_params[112];
    ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71243 = &ctx->cfg->tuning_params[113];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70133 = &ctx->cfg->tuning_params[114];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70550 = &ctx->cfg->tuning_params[115];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71057 = &ctx->cfg->tuning_params[116];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71079 = &ctx->cfg->tuning_params[117];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71099 = &ctx->cfg->tuning_params[118];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71121 = &ctx->cfg->tuning_params[119];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71141 = &ctx->cfg->tuning_params[120];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71163 = &ctx->cfg->tuning_params[121];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71191 = &ctx->cfg->tuning_params[122];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71207 = &ctx->cfg->tuning_params[123];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71233 = &ctx->cfg->tuning_params[124];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71241 = &ctx->cfg->tuning_params[125];
    ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71249 = &ctx->cfg->tuning_params[126];
    ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_71183 = &ctx->cfg->tuning_params[127];
    ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_71199 = &ctx->cfg->tuning_params[128];
    ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71181 = &ctx->cfg->tuning_params[129];
    ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71197 = &ctx->cfg->tuning_params[130];
    ctx->tuning_params.inner_SMJ_longzisuff_outer_par_0 = &ctx->cfg->tuning_params[131];
    ctx->tuning_params.inner_SMJ_longzisuff_outer_par_1 = &ctx->cfg->tuning_params[132];
    ctx->tuning_params.inner_SMJ_longzitblock_sizze_77287 = &ctx->cfg->tuning_params[133];
    ctx->tuning_params.inner_SMJ_longzitblock_sizze_77307 = &ctx->cfg->tuning_params[134];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_73900 = &ctx->cfg->tuning_params[135];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_74255 = &ctx->cfg->tuning_params[136];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_74610 = &ctx->cfg->tuning_params[137];
    ctx->tuning_params.inner_SMJ_longzitile_sizze_74965 = &ctx->cfg->tuning_params[138];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68573 = &ctx->cfg->tuning_params[139];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68615 = &ctx->cfg->tuning_params[140];
    ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68623 = &ctx->cfg->tuning_params[141];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67513 = &ctx->cfg->tuning_params[142];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67930 = &ctx->cfg->tuning_params[143];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68437 = &ctx->cfg->tuning_params[144];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68459 = &ctx->cfg->tuning_params[145];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68479 = &ctx->cfg->tuning_params[146];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68501 = &ctx->cfg->tuning_params[147];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68521 = &ctx->cfg->tuning_params[148];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68543 = &ctx->cfg->tuning_params[149];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68571 = &ctx->cfg->tuning_params[150];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68587 = &ctx->cfg->tuning_params[151];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68613 = &ctx->cfg->tuning_params[152];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68621 = &ctx->cfg->tuning_params[153];
    ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68629 = &ctx->cfg->tuning_params[154];
    ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_68563 = &ctx->cfg->tuning_params[155];
    ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_68579 = &ctx->cfg->tuning_params[156];
    ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68561 = &ctx->cfg->tuning_params[157];
    ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68577 = &ctx->cfg->tuning_params[158];
    ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_0 = &ctx->cfg->tuning_params[159];
    ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_1 = &ctx->cfg->tuning_params[160];
    ctx->tuning_params.inner_SMJ_shortzitblock_sizze_77307 = &ctx->cfg->tuning_params[161];
    ctx->tuning_params.inner_SMJ_shortzitblock_sizze_77327 = &ctx->cfg->tuning_params[162];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900 = &ctx->cfg->tuning_params[163];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255 = &ctx->cfg->tuning_params[164];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610 = &ctx->cfg->tuning_params[165];
    ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965 = &ctx->cfg->tuning_params[166];
    ctx->tuning_params.max_idxzisegred_num_tblocks_66767 = &ctx->cfg->tuning_params[167];
    ctx->tuning_params.max_idxzisegred_tblock_sizze_66765 = &ctx->cfg->tuning_params[168];
    ctx->tuning_params.min_idxzisegred_num_tblocks_66757 = &ctx->cfg->tuning_params[169];
    ctx->tuning_params.min_idxzisegred_tblock_sizze_66755 = &ctx->cfg->tuning_params[170];
}
int memblock_unref_device(struct futhark_context *ctx, struct memblock_device *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            (void) gpu_free(ctx, block->mem, block->size, desc);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc_device(struct futhark_context *ctx, struct memblock_device *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "space 'device'", ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "space 'device'", (long long) ctx->cur_mem_usage_device);
    (void) gpu_alloc(ctx, ctx->log, (size_t) size, desc, &block->mem, (size_t *) &size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_device + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_device = new_usage;
        if (new_usage > ctx->peak_mem_usage_device) {
            ctx->peak_mem_usage_device = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "space 'device'", (long long) size, (long long) ctx->cur_mem_usage_device, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set_device(struct futhark_context *ctx, struct memblock_device *lhs, struct memblock_device *rhs, const char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"space 'device'\": %lld", (long long) ctx->peak_mem_usage_device);
    str_builder_char(&builder, ',');
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        gpu_free_all(ctx);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_76543, int64_t n_76544, int64_t x_76545, int64_t s_76546);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, float val_76574);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, double val_76574);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, int16_t val_76574);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_76954, int64_t num_elems_76955, int32_t val_76956);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_76546, int64_t num_elems_76547, int64_t val_76548);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_76928, int64_t num_elems_76929, int8_t val_76930);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_77351, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58875, int64_t dz2083U_58876, int64_t incr_58877, int64_t psizze_58878);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77352, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_60382, int64_t n_60383, int64_t incr_60384, int64_t psizze_60385);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_77353, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58535, int64_t dz2083U_58536, int64_t incr_58537, int64_t psizze_58538);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77354, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_60081, int64_t n_60082, int64_t incr_60083, int64_t psizze_60084);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_77355, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_57886, int64_t dz2083U_57887, int64_t incr_57888, int64_t psizze_57889);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77356, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59479, int64_t n_59480, int64_t incr_59481, int64_t psizze_59482);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_77357, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58195, int64_t dz2083U_58196, int64_t incr_58197, int64_t psizze_58198);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77358, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59780, int64_t n_59781, int64_t incr_59782, int64_t psizze_59783);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_77359, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_57574, int64_t dz2083U_57575, int64_t incr_57576, int64_t psizze_57577);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77360, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59178, int64_t n_59179, int64_t incr_59180, int64_t psizze_59181);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_77361, struct memblock_device *mem_out_p_77362, struct memblock_device *mem_out_p_77363, int64_t *out_prim_out_77364, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_57224, int64_t nS_57225, int64_t offset_R_57228, int64_t offset_S_57229, int64_t partitionsPerWindow_57230, int64_t numberOfWindows_57231, int64_t extParallelism_57232, int64_t scatter_psizze_57233);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_77382, struct memblock_device *mem_out_p_77383, struct memblock_device *mem_out_p_77384, int64_t *out_prim_out_77385, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_52195, int64_t nS_52196, int64_t offset_R_52199, int64_t offset_S_52200, int64_t partitionsPerWindow_52201, int64_t numberOfWindows_52202, int64_t extParallelism_52203, int64_t scatter_psizze_52204);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_77403, struct memblock_device *mem_out_p_77404, struct memblock_device *mem_out_p_77405, int64_t *out_prim_out_77406, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_42219, int64_t nS_42220, int64_t offset_R_42223, int64_t offset_S_42224, int64_t partitionsPerWindow_42225, int64_t numberOfWindows_42226, int64_t extParallelism_42227, int64_t scatter_psizze_42228);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_77424, struct memblock_device *mem_out_p_77425, struct memblock_device *mem_out_p_77426, int64_t *out_prim_out_77427, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_47166, int64_t nS_47167, int64_t offset_R_47170, int64_t offset_S_47171, int64_t partitionsPerWindow_47172, int64_t numberOfWindows_47173, int64_t extParallelism_47174, int64_t scatter_psizze_47175);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_77445, struct memblock_device *mem_out_p_77446, struct memblock_device *mem_out_p_77447, int64_t *out_prim_out_77448, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_37190, int64_t nS_37191, int64_t offset_R_37194, int64_t offset_S_37195, int64_t partitionsPerWindow_37196, int64_t numberOfWindows_37197, int64_t extParallelism_37198, int64_t scatter_psizze_37199);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_77466, struct memblock_device eta_p_mem_75467, int64_t nz2080U_60458);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_77468, struct memblock_device eta_p_mem_75467, int64_t nz2080U_60421);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7443(struct futhark_context *ctx, struct memblock_device *mem_out_p_77470, struct memblock_device xs_mem_75467, int64_t n_31863, int64_t incr_31864);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7587(struct futhark_context *ctx, struct memblock_device *mem_out_p_77471, struct memblock_device xs_mem_75467, int64_t n_37232, int64_t incr_37233);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7692(struct futhark_context *ctx, struct memblock_device *mem_out_p_77472, struct memblock_device xs_mem_75467, int64_t n_42252, int64_t incr_42253);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7791(struct futhark_context *ctx, struct memblock_device *mem_out_p_77473, struct memblock_device xs_mem_75467, int64_t n_47208, int64_t incr_47209);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7898(struct futhark_context *ctx, struct memblock_device *mem_out_p_77474, struct memblock_device xs_mem_75467, int64_t n_52237, int64_t incr_52238);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define counters_mem_76545 (ctx->constants->counters_mem_76545)
    #define global_dynid_mem_76932 (ctx->constants->global_dynid_mem_76932)
    #define global_dynid_mem_76952 (ctx->constants->global_dynid_mem_76952)
    #define global_dynid_mem_77073 (ctx->constants->global_dynid_mem_77073)
    #define global_dynid_mem_77093 (ctx->constants->global_dynid_mem_77093)
    counters_mem_76545.references = NULL;
    global_dynid_mem_76932.references = NULL;
    global_dynid_mem_76952.references = NULL;
    global_dynid_mem_77073.references = NULL;
    global_dynid_mem_77093.references = NULL;
    if (memblock_alloc_device(ctx, &counters_mem_76545, (int64_t) 80, "counters_mem_76545")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_76545, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_76545, (int64_t) 80, "counters_mem_76545")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_76545, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_76952, (int64_t) 4, "global_dynid_mem_76952")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_76952, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_77093, (int64_t) 4, "global_dynid_mem_77093")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_77093, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_76952, (int64_t) 4, "global_dynid_mem_76952")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_76952, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_77073, (int64_t) 4, "global_dynid_mem_77073")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_77073, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_76932, (int64_t) 4, "global_dynid_mem_76932")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_76932, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_77073, (int64_t) 4, "global_dynid_mem_77073")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_77073, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_76952, (int64_t) 4, "global_dynid_mem_76952")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_76952, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_77093, (int64_t) 4, "global_dynid_mem_77093")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_77093, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_76952, (int64_t) 4, "global_dynid_mem_76952")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_76952, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_77093, (int64_t) 4, "global_dynid_mem_77093")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_77093, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    #undef counters_mem_76545
    #undef global_dynid_mem_76932
    #undef global_dynid_mem_76952
    #undef global_dynid_mem_77073
    #undef global_dynid_mem_77093
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_76545, "ctx->constants->counters_mem_76545") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_76932, "ctx->constants->global_dynid_mem_76932") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_76952, "ctx->constants->global_dynid_mem_76952") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_77073, "ctx->constants->global_dynid_mem_77073") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_77093, "ctx->constants->global_dynid_mem_77093") != 0)
        return 1;
    return 0;
}
static int gpu_kernel_builtinzhiota_i64ziiota_i64_76548(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_76548, "builtin#iota_i64.iota_i64_76548", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f32zireplicate_76577(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, float arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_76577, "builtin#replicate_f32.replicate_76577", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f64zireplicate_76577(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_76577, "builtin#replicate_f64.replicate_76577", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i16zireplicate_76577(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int16_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_76577, "builtin#replicate_i16.replicate_76577", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i32zireplicate_76959(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int32_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_76959, "builtin#replicate_i32.replicate_76959", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i64zireplicate_76551(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_76551, "builtin#replicate_i64.replicate_76551", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i8zireplicate_76933(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_76933, "builtin#replicate_i8.replicate_76933", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_doublezisegmap_67013(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_67013, "gather_payloads_double.segmap_67013", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_doublezisegmap_67041(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_doublezisegmap_67041, "gather_payloads_double.segmap_67041", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_double_GFURzisegmap_67293(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_67293, "gather_payloads_double_GFUR.segmap_67293", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_double_GFURzisegmap_67321(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_double_GFURzisegmap_67321, "gather_payloads_double_GFUR.segmap_67321", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_floatzisegmap_66957(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_66957, "gather_payloads_float.segmap_66957", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_floatzisegmap_66985(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_floatzisegmap_66985, "gather_payloads_float.segmap_66985", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_float_GFURzisegmap_67237(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_67237, "gather_payloads_float_GFUR.segmap_67237", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_float_GFURzisegmap_67265(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_float_GFURzisegmap_67265, "gather_payloads_float_GFUR.segmap_67265", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_intzisegmap_66845(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_intzisegmap_66845, "gather_payloads_int.segmap_66845", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_intzisegmap_66873(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_intzisegmap_66873, "gather_payloads_int.segmap_66873", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_int_GFURzisegmap_67125(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_67125, "gather_payloads_int_GFUR.segmap_67125", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_int_GFURzisegmap_67153(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_int_GFURzisegmap_67153, "gather_payloads_int_GFUR.segmap_67153", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_longzisegmap_66901(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_longzisegmap_66901, "gather_payloads_long.segmap_66901", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_longzisegmap_66929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_longzisegmap_66929, "gather_payloads_long.segmap_66929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_long_GFURzisegmap_67181(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_67181, "gather_payloads_long_GFUR.segmap_67181", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_long_GFURzisegmap_67209(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_long_GFURzisegmap_67209, "gather_payloads_long_GFUR.segmap_67209", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_shortzisegmap_66789(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_66789, "gather_payloads_short.segmap_66789", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_shortzisegmap_66817(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_shortzisegmap_66817, "gather_payloads_short.segmap_66817", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_short_GFURzisegmap_67069(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_67069, "gather_payloads_short_GFUR.segmap_67069", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_gather_payloads_short_GFURzisegmap_67097(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->gather_payloads_short_GFURzisegmap_67097, "gather_payloads_short_GFUR.segmap_67097", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76566(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76566, "inner_SMJ_double.gpuseq_76566", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76598(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76598, "inner_SMJ_double.gpuseq_76598", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76604(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76604, "inner_SMJ_double.gpuseq_76604", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76620(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76620, "inner_SMJ_double.gpuseq_76620", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76626(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76626, "inner_SMJ_double.gpuseq_76626", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76632(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76632, "inner_SMJ_double.gpuseq_76632", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_73899(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_73899, "inner_SMJ_double.segmap_intrablock_73899", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74254(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74254, "inner_SMJ_double.segmap_intrablock_74254", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76691, "inner_SMJ_double.gpuseq_76691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76697(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76697, "inner_SMJ_double.gpuseq_76697", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76703(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76703, "inner_SMJ_double.gpuseq_76703", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_72965(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_72965, "inner_SMJ_double.segmap_72965", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73339(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73339, "inner_SMJ_double.segmap_73339", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76765(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76765, "inner_SMJ_double.gpuseq_76765", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76771(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76771, "inner_SMJ_double.gpuseq_76771", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76787(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76787, "inner_SMJ_double.gpuseq_76787", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76793(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76793, "inner_SMJ_double.gpuseq_76793", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76799(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76799, "inner_SMJ_double.gpuseq_76799", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74609, "inner_SMJ_double.segmap_intrablock_74609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74964(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_intrablock_74964, "inner_SMJ_double.segmap_intrablock_74964", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73691, "inner_SMJ_double.segmap_73691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73712(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73712, "inner_SMJ_double.segmap_73712", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73733(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73733, "inner_SMJ_double.segmap_73733", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73754(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73754, "inner_SMJ_double.segmap_73754", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73775(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73775, "inner_SMJ_double.segmap_73775", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73796(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73796, "inner_SMJ_double.segmap_73796", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_76912(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_76912, "inner_SMJ_double.gpuseq_76912", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegscan_73807(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_73807, "inner_SMJ_double.segscan_73807", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73809(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73809, "inner_SMJ_double.segmap_73809", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegscan_73823(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegscan_73823, "inner_SMJ_double.segscan_73823", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73843(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73843, "inner_SMJ_double.segmap_73843", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_77237(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77237, "inner_SMJ_double.gpuseq_77237", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_77243(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77243, "inner_SMJ_double.gpuseq_77243", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_77249(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77249, "inner_SMJ_double.gpuseq_77249", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73859(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73859, "inner_SMJ_double.segmap_73859", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73851(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73851, "inner_SMJ_double.segmap_73851", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezigpuseq_77296(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezigpuseq_77296, "inner_SMJ_double.gpuseq_77296", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezireplicate_77303(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_77303, "inner_SMJ_double.replicate_77303", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezireplicate_77323(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezireplicate_77323, "inner_SMJ_double.replicate_77323", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_doublezisegmap_73881(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_doublezisegmap_73881, "inner_SMJ_double.segmap_73881", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76566(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76566, "inner_SMJ_float.gpuseq_76566", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76598(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76598, "inner_SMJ_float.gpuseq_76598", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76604(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76604, "inner_SMJ_float.gpuseq_76604", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76620(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76620, "inner_SMJ_float.gpuseq_76620", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76626(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76626, "inner_SMJ_float.gpuseq_76626", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76632(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76632, "inner_SMJ_float.gpuseq_76632", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_73899(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_73899, "inner_SMJ_float.segmap_intrablock_73899", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74254(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74254, "inner_SMJ_float.segmap_intrablock_74254", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76691, "inner_SMJ_float.gpuseq_76691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76697(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76697, "inner_SMJ_float.gpuseq_76697", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76703(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76703, "inner_SMJ_float.gpuseq_76703", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_71655(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_71655, "inner_SMJ_float.segmap_71655", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72029(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72029, "inner_SMJ_float.segmap_72029", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76765(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76765, "inner_SMJ_float.gpuseq_76765", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76771(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76771, "inner_SMJ_float.gpuseq_76771", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76787(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76787, "inner_SMJ_float.gpuseq_76787", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76793(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76793, "inner_SMJ_float.gpuseq_76793", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76799(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76799, "inner_SMJ_float.gpuseq_76799", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74609, "inner_SMJ_float.segmap_intrablock_74609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74964(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_intrablock_74964, "inner_SMJ_float.segmap_intrablock_74964", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72381(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72381, "inner_SMJ_float.segmap_72381", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72402(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72402, "inner_SMJ_float.segmap_72402", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72423(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72423, "inner_SMJ_float.segmap_72423", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72444(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72444, "inner_SMJ_float.segmap_72444", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72465(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72465, "inner_SMJ_float.segmap_72465", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72486(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72486, "inner_SMJ_float.segmap_72486", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_76912(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_76912, "inner_SMJ_float.gpuseq_76912", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegscan_72497(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_72497, "inner_SMJ_float.segscan_72497", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72499(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72499, "inner_SMJ_float.segmap_72499", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegscan_72513(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegscan_72513, "inner_SMJ_float.segscan_72513", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72533(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72533, "inner_SMJ_float.segmap_72533", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_77237(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77237, "inner_SMJ_float.gpuseq_77237", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_77243(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77243, "inner_SMJ_float.gpuseq_77243", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_77249(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77249, "inner_SMJ_float.gpuseq_77249", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72549(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72549, "inner_SMJ_float.segmap_72549", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72541(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72541, "inner_SMJ_float.segmap_72541", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzigpuseq_77296(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzigpuseq_77296, "inner_SMJ_float.gpuseq_77296", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzireplicate_77303(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_77303, "inner_SMJ_float.replicate_77303", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzireplicate_77323(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzireplicate_77323, "inner_SMJ_float.replicate_77323", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_floatzisegmap_72571(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_floatzisegmap_72571, "inner_SMJ_float.segmap_72571", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76566(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76566, "inner_SMJ_int.gpuseq_76566", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76598(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76598, "inner_SMJ_int.gpuseq_76598", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76604(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76604, "inner_SMJ_int.gpuseq_76604", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76620(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76620, "inner_SMJ_int.gpuseq_76620", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76626(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76626, "inner_SMJ_int.gpuseq_76626", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76632(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76632, "inner_SMJ_int.gpuseq_76632", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_73899(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_73899, "inner_SMJ_int.segmap_intrablock_73899", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_74254(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74254, "inner_SMJ_int.segmap_intrablock_74254", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76691, "inner_SMJ_int.gpuseq_76691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76697(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76697, "inner_SMJ_int.gpuseq_76697", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76703(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76703, "inner_SMJ_int.gpuseq_76703", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69035(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69035, "inner_SMJ_int.segmap_69035", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69409(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69409, "inner_SMJ_int.segmap_69409", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76765(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76765, "inner_SMJ_int.gpuseq_76765", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76771(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76771, "inner_SMJ_int.gpuseq_76771", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76787(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76787, "inner_SMJ_int.gpuseq_76787", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76793(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76793, "inner_SMJ_int.gpuseq_76793", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76799(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76799, "inner_SMJ_int.gpuseq_76799", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_74609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74609, "inner_SMJ_int.segmap_intrablock_74609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_intrablock_74964(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_intrablock_74964, "inner_SMJ_int.segmap_intrablock_74964", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69761(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69761, "inner_SMJ_int.segmap_69761", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69782(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69782, "inner_SMJ_int.segmap_69782", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69803(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69803, "inner_SMJ_int.segmap_69803", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69824(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69824, "inner_SMJ_int.segmap_69824", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69845(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69845, "inner_SMJ_int.segmap_69845", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69866(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69866, "inner_SMJ_int.segmap_69866", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_76912(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_76912, "inner_SMJ_int.gpuseq_76912", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegscan_69877(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_69877, "inner_SMJ_int.segscan_69877", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69879(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69879, "inner_SMJ_int.segmap_69879", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegscan_69893(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegscan_69893, "inner_SMJ_int.segscan_69893", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69913(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69913, "inner_SMJ_int.segmap_69913", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_77217(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77217, "inner_SMJ_int.gpuseq_77217", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_77223(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77223, "inner_SMJ_int.gpuseq_77223", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_77229(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77229, "inner_SMJ_int.gpuseq_77229", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69929(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69929, "inner_SMJ_int.segmap_69929", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69921(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69921, "inner_SMJ_int.segmap_69921", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzigpuseq_77276(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzigpuseq_77276, "inner_SMJ_int.gpuseq_77276", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzireplicate_77283(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_77283, "inner_SMJ_int.replicate_77283", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzireplicate_77303(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzireplicate_77303, "inner_SMJ_int.replicate_77303", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_intzisegmap_69951(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_intzisegmap_69951, "inner_SMJ_int.segmap_69951", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76566(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76566, "inner_SMJ_long.gpuseq_76566", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76578(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76578, "inner_SMJ_long.gpuseq_76578", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76584(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76584, "inner_SMJ_long.gpuseq_76584", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76600(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76600, "inner_SMJ_long.gpuseq_76600", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76606(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76606, "inner_SMJ_long.gpuseq_76606", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76612(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76612, "inner_SMJ_long.gpuseq_76612", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_73899(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_73899, "inner_SMJ_long.segmap_intrablock_73899", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_74254(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74254, "inner_SMJ_long.segmap_intrablock_74254", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76671(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76671, "inner_SMJ_long.gpuseq_76671", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76677(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76677, "inner_SMJ_long.gpuseq_76677", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76683(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76683, "inner_SMJ_long.gpuseq_76683", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_70345(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_70345, "inner_SMJ_long.segmap_70345", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_70719(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_70719, "inner_SMJ_long.segmap_70719", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76745(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76745, "inner_SMJ_long.gpuseq_76745", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76751(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76751, "inner_SMJ_long.gpuseq_76751", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76767(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76767, "inner_SMJ_long.gpuseq_76767", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76773(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76773, "inner_SMJ_long.gpuseq_76773", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76779(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76779, "inner_SMJ_long.gpuseq_76779", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_74609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74609, "inner_SMJ_long.segmap_intrablock_74609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_intrablock_74964(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_intrablock_74964, "inner_SMJ_long.segmap_intrablock_74964", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71071(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71071, "inner_SMJ_long.segmap_71071", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71092(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71092, "inner_SMJ_long.segmap_71092", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71113(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71113, "inner_SMJ_long.segmap_71113", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71134(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71134, "inner_SMJ_long.segmap_71134", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71155(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71155, "inner_SMJ_long.segmap_71155", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71176(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71176, "inner_SMJ_long.segmap_71176", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_76892(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_76892, "inner_SMJ_long.gpuseq_76892", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegscan_71187(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_71187, "inner_SMJ_long.segscan_71187", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71189(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71189, "inner_SMJ_long.segmap_71189", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegscan_71203(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegscan_71203, "inner_SMJ_long.segscan_71203", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71223(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71223, "inner_SMJ_long.segmap_71223", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_77217(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77217, "inner_SMJ_long.gpuseq_77217", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_77223(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77223, "inner_SMJ_long.gpuseq_77223", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_77229(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77229, "inner_SMJ_long.gpuseq_77229", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71239(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71239, "inner_SMJ_long.segmap_71239", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71231(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71231, "inner_SMJ_long.segmap_71231", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzigpuseq_77276(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzigpuseq_77276, "inner_SMJ_long.gpuseq_77276", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzireplicate_77283(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_77283, "inner_SMJ_long.replicate_77283", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzireplicate_77303(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzireplicate_77303, "inner_SMJ_long.replicate_77303", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_longzisegmap_71261(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_longzisegmap_71261, "inner_SMJ_long.segmap_71261", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76566(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76566, "inner_SMJ_short.gpuseq_76566", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76598(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76598, "inner_SMJ_short.gpuseq_76598", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76604(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76604, "inner_SMJ_short.gpuseq_76604", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76620(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76620, "inner_SMJ_short.gpuseq_76620", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76626(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76626, "inner_SMJ_short.gpuseq_76626", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76632(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76632, "inner_SMJ_short.gpuseq_76632", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_73899(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_73899, "inner_SMJ_short.segmap_intrablock_73899", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74254(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74254, "inner_SMJ_short.segmap_intrablock_74254", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76691(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76691, "inner_SMJ_short.gpuseq_76691", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76697(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76697, "inner_SMJ_short.gpuseq_76697", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76703(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76703, "inner_SMJ_short.gpuseq_76703", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_67725(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_67725, "inner_SMJ_short.segmap_67725", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68099(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68099, "inner_SMJ_short.segmap_68099", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76765(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76765, "inner_SMJ_short.gpuseq_76765", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76771(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76771, "inner_SMJ_short.gpuseq_76771", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76787(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76787, "inner_SMJ_short.gpuseq_76787", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76793(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76793, "inner_SMJ_short.gpuseq_76793", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76799(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76799, "inner_SMJ_short.gpuseq_76799", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74609(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74609, "inner_SMJ_short.segmap_intrablock_74609", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74964(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, bool arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_intrablock_74964, "inner_SMJ_short.segmap_intrablock_74964", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68451(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68451, "inner_SMJ_short.segmap_68451", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68472(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68472, "inner_SMJ_short.segmap_68472", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68493(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68493, "inner_SMJ_short.segmap_68493", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68514(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68514, "inner_SMJ_short.segmap_68514", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68535(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68535, "inner_SMJ_short.segmap_68535", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68556(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68556, "inner_SMJ_short.segmap_68556", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_76912(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_76912, "inner_SMJ_short.gpuseq_76912", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegscan_68567(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_68567, "inner_SMJ_short.segscan_68567", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68569(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68569, "inner_SMJ_short.segmap_68569", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegscan_68583(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegscan_68583, "inner_SMJ_short.segscan_68583", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68603(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68603, "inner_SMJ_short.segmap_68603", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_77237(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77237, "inner_SMJ_short.gpuseq_77237", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_77243(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77243, "inner_SMJ_short.gpuseq_77243", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_77249(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77249, "inner_SMJ_short.gpuseq_77249", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68619(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68619, "inner_SMJ_short.segmap_68619", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68611(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68611, "inner_SMJ_short.segmap_68611", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzigpuseq_77296(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzigpuseq_77296, "inner_SMJ_short.gpuseq_77296", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzireplicate_77303(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_77303, "inner_SMJ_short.replicate_77303", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzireplicate_77323(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzireplicate_77323, "inner_SMJ_short.replicate_77323", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_inner_SMJ_shortzisegmap_68641(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->inner_SMJ_shortzisegmap_68641, "inner_SMJ_short.segmap_68641", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_max_idxzisegred_nonseg_66773(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->max_idxzisegred_nonseg_66773, "max_idx.segred_nonseg_66773", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_min_idxzisegred_nonseg_66763(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->min_idxzisegred_nonseg_66763, "min_idx.segred_nonseg_66763", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
struct futhark_i16_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 2 * (i0 * 1), 2);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_76543, int64_t n_76544, int64_t x_76545, int64_t s_76546)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t tblock_sizze_76552;
    
    tblock_sizze_76552 = *ctx->tuning_params.builtinzhiota_i64zitblock_sizze_76552;
    
    int64_t virt_num_tblocks_76553 = sdiv_up64(n_76544, tblock_sizze_76552);
    int64_t num_tblocks_76554 = smin64(virt_num_tblocks_76553, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhiota_i64ziiota_i64_76548(ctx, num_tblocks_76554, 1, 1, tblock_sizze_76552, 1, 1, (int64_t) 0, n_76544, x_76545, s_76546, virt_num_tblocks_76553, num_tblocks_76554, mem_76543.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, float val_76574)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76576 = num_elems_76573;
    int64_t tblock_sizze_76581;
    
    tblock_sizze_76581 = *ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_76581;
    
    int64_t virt_num_tblocks_76582 = sdiv_up64(replicate_n_76576, tblock_sizze_76581);
    int64_t num_tblocks_76583 = smin64(virt_num_tblocks_76582, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f32zireplicate_76577(ctx, num_tblocks_76583, 1, 1, tblock_sizze_76581, 1, 1, (int64_t) 0, num_elems_76573, val_76574, replicate_n_76576, virt_num_tblocks_76582, num_tblocks_76583, mem_76572.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, double val_76574)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76576 = num_elems_76573;
    int64_t tblock_sizze_76581;
    
    tblock_sizze_76581 = *ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_76581;
    
    int64_t virt_num_tblocks_76582 = sdiv_up64(replicate_n_76576, tblock_sizze_76581);
    int64_t num_tblocks_76583 = smin64(virt_num_tblocks_76582, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f64zireplicate_76577(ctx, num_tblocks_76583, 1, 1, tblock_sizze_76581, 1, 1, (int64_t) 0, num_elems_76573, val_76574, replicate_n_76576, virt_num_tblocks_76582, num_tblocks_76583, mem_76572.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_76572, int64_t num_elems_76573, int16_t val_76574)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76576 = num_elems_76573;
    int64_t tblock_sizze_76581;
    
    tblock_sizze_76581 = *ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_76581;
    
    int64_t virt_num_tblocks_76582 = sdiv_up64(replicate_n_76576, tblock_sizze_76581);
    int64_t num_tblocks_76583 = smin64(virt_num_tblocks_76582, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i16zireplicate_76577(ctx, num_tblocks_76583, 1, 1, tblock_sizze_76581, 1, 1, (int64_t) 0, num_elems_76573, val_76574, replicate_n_76576, virt_num_tblocks_76582, num_tblocks_76583, mem_76572.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_76954, int64_t num_elems_76955, int32_t val_76956)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76958 = num_elems_76955;
    int64_t tblock_sizze_76963;
    
    tblock_sizze_76963 = *ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_76963;
    
    int64_t virt_num_tblocks_76964 = sdiv_up64(replicate_n_76958, tblock_sizze_76963);
    int64_t num_tblocks_76965 = smin64(virt_num_tblocks_76964, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i32zireplicate_76959(ctx, num_tblocks_76965, 1, 1, tblock_sizze_76963, 1, 1, (int64_t) 0, num_elems_76955, val_76956, replicate_n_76958, virt_num_tblocks_76964, num_tblocks_76965, mem_76954.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_76546, int64_t num_elems_76547, int64_t val_76548)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76550 = num_elems_76547;
    int64_t tblock_sizze_76555;
    
    tblock_sizze_76555 = *ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_76555;
    
    int64_t virt_num_tblocks_76556 = sdiv_up64(replicate_n_76550, tblock_sizze_76555);
    int64_t num_tblocks_76557 = smin64(virt_num_tblocks_76556, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i64zireplicate_76551(ctx, num_tblocks_76557, 1, 1, tblock_sizze_76555, 1, 1, (int64_t) 0, num_elems_76547, val_76548, replicate_n_76550, virt_num_tblocks_76556, num_tblocks_76557, mem_76546.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_76928, int64_t num_elems_76929, int8_t val_76930)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t replicate_n_76932 = num_elems_76929;
    int64_t tblock_sizze_76937;
    
    tblock_sizze_76937 = *ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_76937;
    
    int64_t virt_num_tblocks_76938 = sdiv_up64(replicate_n_76932, tblock_sizze_76937);
    int64_t num_tblocks_76939 = smin64(virt_num_tblocks_76938, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i8zireplicate_76933(ctx, num_tblocks_76939, 1, 1, tblock_sizze_76937, 1, 1, (int64_t) 0, num_elems_76929, val_76930, replicate_n_76932, virt_num_tblocks_76938, num_tblocks_76939, mem_76928.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_77351, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58875, int64_t dz2083U_58876, int64_t incr_58877, int64_t psizze_58878)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75481;
    
    mem_75481.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device mem_param_75476;
    
    mem_param_75476.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device ext_mem_75490;
    
    ext_mem_75490.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75470 = (int64_t) 8 * niz2084U_58875;
    bool zzero_61602 = psizze_58878 == (int64_t) 0;
    bool nonzzero_61603 = !zzero_61602;
    bool nonzzero_cert_61604;
    
    if (!nonzzero_61603) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:430:5-41\n   #2  ftSMJ.fut:429:1-430:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_67009;
    
    segmap_tblock_sizze_67009 = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67001;
    
    int64_t segmap_usable_groups_67010 = sdiv_up64(niz2084U_58875, segmap_tblock_sizze_67009);
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(niz2084U_58875, segmap_tblock_sizze_67009));
    
    {
        err = gpu_kernel_gather_payloads_doublezisegmap_67013(ctx, segmap_usable_groups_67010, 1, 1, *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67001, 1, 1, (int64_t) 0, niz2084U_58875, incr_58877, is_mem_75467.mem, mem_75471.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61600 = add64(dz2083U_58876, psizze_58878);
    int64_t zs_lhs_61601 = sub64(zm_lhs_61600, (int64_t) 1);
    int64_t m_61605 = sdiv64(zs_lhs_61601, psizze_58878);
    
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_75473, niz2084U_58875, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_61607 = slt64((int64_t) 0, m_61605);
    int64_t segmap_tblock_sizze_67037;
    
    segmap_tblock_sizze_67037 = *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67019;
    
    int64_t segmap_usable_groups_67038 = sdiv_up_safe64(niz2084U_58875, segmap_tblock_sizze_67037);
    bool partitioned_gather_res_61608;
    int64_t partitioned_gather_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75476, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_58878, p_61615);
        int64_t min_arg1_61617 = add64(psizze_58878, lower_bound_61616);
        int64_t min_res_61618 = smin64(dz2083U_58876, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, dz2083U_58876);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) dz2083U_58876, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:430:5-41\n   #2  ftSMJ.fut:429:1-430:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75481, bytes_75470, "mem_75481")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75476.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58875})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75484, bytes_75470, "mem_75484")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76578 = sext_i64_i32(sdiv_up64(niz2084U_58875, segmap_tblock_sizze_67037));
        
        {
            err = gpu_kernel_gather_payloads_doublezisegmap_67041(ctx, segmap_usable_groups_67038, 1, 1, *ctx->tuning_params.gather_payloads_doublezisegmap_tblock_sizze_67019, 1, 1, (int64_t) 0, niz2084U_58875, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75468.mem, mem_param_75476.mem, mem_param_75479.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61605);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &mem_75484, "mem_75484") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_61647;
        int64_t p_tmp_76577 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75476, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76574;
        p_61615 = p_tmp_76577;
    }
    if (memblock_set_device(ctx, &ext_mem_75490, &mem_param_75476, "mem_param_75476") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    partitioned_gather_res_61608 = loop_while_61612;
    partitioned_gather_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75492, bytes_75470, "mem_75492")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75492.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75489.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58875})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75492, "mem_75492") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77351, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75476, "mem_param_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75490, "ext_mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77352, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_60382, int64_t n_60383, int64_t incr_60384, int64_t psizze_60385)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75491;
    
    mem_75491.references = NULL;
    
    struct memblock_device mem_param_tmp_76553;
    
    mem_param_tmp_76553.references = NULL;
    
    struct memblock_device mem_param_tmp_76552;
    
    mem_param_tmp_76552.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75480;
    
    mem_75480.references = NULL;
    
    struct memblock_device mem_param_75478;
    
    mem_param_75478.references = NULL;
    
    struct memblock_device mem_param_75475;
    
    mem_param_75475.references = NULL;
    
    struct memblock_device ext_mem_75488;
    
    ext_mem_75488.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device mem_75472;
    
    mem_75472.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75471 = (int64_t) 8 * ni_60382;
    bool zzero_61603 = psizze_60385 == (int64_t) 0;
    bool nonzzero_61604 = !zzero_61603;
    bool nonzzero_cert_61605;
    
    if (!nonzzero_61604) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:458:5-50\n   #2  ftSMJ.fut:457:1-458:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_67289;
    
    segmap_tblock_sizze_67289 = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67281;
    
    int64_t segmap_usable_groups_67290 = sdiv_up64(ni_60382, segmap_tblock_sizze_67289);
    
    if (memblock_alloc_device(ctx, &mem_75472, bytes_75471, "mem_75472")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(ni_60382, segmap_tblock_sizze_67289));
    
    {
        err = gpu_kernel_gather_payloads_double_GFURzisegmap_67293(ctx, segmap_usable_groups_67290, 1, 1, *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67281, 1, 1, (int64_t) 0, ni_60382, incr_60384, is_mem_75468.mem, mem_75472.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61601 = add64(n_60383, psizze_60385);
    int64_t zs_lhs_61602 = sub64(zm_lhs_61601, (int64_t) 1);
    int64_t m_61606 = sdiv64(zs_lhs_61602, psizze_60385);
    bool loop_cond_61607 = slt64((int64_t) 0, m_61606);
    int64_t segmap_tblock_sizze_67317;
    
    segmap_tblock_sizze_67317 = *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67299;
    
    int64_t segmap_usable_groups_67318 = sdiv_up_safe64(ni_60382, segmap_tblock_sizze_67317);
    bool partitioned_gather_over_array_res_61608;
    int64_t partitioned_gather_over_array_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75475, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75478, &preVals_mem_75467, "preVals_mem_75467") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_60385, p_61615);
        int64_t min_arg1_61617 = add64(psizze_60385, lower_bound_61616);
        int64_t min_res_61618 = smin64(n_60383, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, n_60383);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) n_60383, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:458:5-50\n   #2  ftSMJ.fut:457:1-458:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75480, bytes_75471, "mem_75480")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_60382})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75483, bytes_75471, "mem_75483")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76558 = sext_i64_i32(sdiv_up64(ni_60382, segmap_tblock_sizze_67317));
        
        {
            err = gpu_kernel_gather_payloads_double_GFURzisegmap_67321(ctx, segmap_usable_groups_67318, 1, 1, *ctx->tuning_params.gather_payloads_double_GFURzisegmap_tblock_sizze_67299, 1, 1, (int64_t) 0, ni_60382, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75469.mem, mem_param_75475.mem, mem_param_75478.mem, mem_75483.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61606);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76552, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76553, &mem_75483, "mem_75483") != 0)
            return 1;
        
        bool loop_while_tmp_76554 = loop_cond_61647;
        int64_t p_tmp_76557 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75475, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75478, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76554;
        p_61615 = p_tmp_76557;
    }
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75475, "mem_param_75475") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75488, &mem_param_75478, "mem_param_75478") != 0)
        return 1;
    partitioned_gather_over_array_res_61608 = loop_while_61612;
    partitioned_gather_over_array_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75491, bytes_75471, "mem_75491")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75491.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75488.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_60382})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75491, "mem_75491") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77352, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75491, "mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75478, "mem_param_75478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75475, "mem_param_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_77353, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58535, int64_t dz2083U_58536, int64_t incr_58537, int64_t psizze_58538)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75481;
    
    mem_75481.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device mem_param_75476;
    
    mem_param_75476.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device ext_mem_75490;
    
    ext_mem_75490.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75470 = (int64_t) 8 * niz2084U_58535;
    bool zzero_61602 = psizze_58538 == (int64_t) 0;
    bool nonzzero_61603 = !zzero_61602;
    bool nonzzero_cert_61604;
    
    if (!nonzzero_61603) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:427:5-41\n   #2  ftSMJ.fut:426:1-427:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75472 = (int64_t) 4 * niz2084U_58535;
    int64_t segmap_tblock_sizze_66953;
    
    segmap_tblock_sizze_66953 = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66945;
    
    int64_t segmap_usable_groups_66954 = sdiv_up64(niz2084U_58535, segmap_tblock_sizze_66953);
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(niz2084U_58535, segmap_tblock_sizze_66953));
    
    {
        err = gpu_kernel_gather_payloads_floatzisegmap_66957(ctx, segmap_usable_groups_66954, 1, 1, *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66945, 1, 1, (int64_t) 0, niz2084U_58535, incr_58537, is_mem_75467.mem, mem_75471.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61600 = add64(dz2083U_58536, psizze_58538);
    int64_t zs_lhs_61601 = sub64(zm_lhs_61600, (int64_t) 1);
    int64_t m_61605 = sdiv64(zs_lhs_61601, psizze_58538);
    
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75472, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_75473, niz2084U_58535, 0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_61607 = slt64((int64_t) 0, m_61605);
    int64_t segmap_tblock_sizze_66981;
    
    segmap_tblock_sizze_66981 = *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66963;
    
    int64_t segmap_usable_groups_66982 = sdiv_up_safe64(niz2084U_58535, segmap_tblock_sizze_66981);
    bool partitioned_gather_res_61608;
    int64_t partitioned_gather_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75476, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_58538, p_61615);
        int64_t min_arg1_61617 = add64(psizze_58538, lower_bound_61616);
        int64_t min_res_61618 = smin64(dz2083U_58536, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, dz2083U_58536);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) dz2083U_58536, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:427:5-41\n   #2  ftSMJ.fut:426:1-427:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75481, bytes_75470, "mem_75481")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75476.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58535})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75484, bytes_75472, "mem_75484")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76578 = sext_i64_i32(sdiv_up64(niz2084U_58535, segmap_tblock_sizze_66981));
        
        {
            err = gpu_kernel_gather_payloads_floatzisegmap_66985(ctx, segmap_usable_groups_66982, 1, 1, *ctx->tuning_params.gather_payloads_floatzisegmap_tblock_sizze_66963, 1, 1, (int64_t) 0, niz2084U_58535, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75468.mem, mem_param_75476.mem, mem_param_75479.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61605);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &mem_75484, "mem_75484") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_61647;
        int64_t p_tmp_76577 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75476, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76574;
        p_61615 = p_tmp_76577;
    }
    if (memblock_set_device(ctx, &ext_mem_75490, &mem_param_75476, "mem_param_75476") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    partitioned_gather_res_61608 = loop_while_61612;
    partitioned_gather_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75492, bytes_75472, "mem_75492")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75492.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75489.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58535})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75492, "mem_75492") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77353, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75476, "mem_param_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75490, "ext_mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77354, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_60081, int64_t n_60082, int64_t incr_60083, int64_t psizze_60084)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75491;
    
    mem_75491.references = NULL;
    
    struct memblock_device mem_param_tmp_76553;
    
    mem_param_tmp_76553.references = NULL;
    
    struct memblock_device mem_param_tmp_76552;
    
    mem_param_tmp_76552.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75480;
    
    mem_75480.references = NULL;
    
    struct memblock_device mem_param_75478;
    
    mem_param_75478.references = NULL;
    
    struct memblock_device mem_param_75475;
    
    mem_param_75475.references = NULL;
    
    struct memblock_device ext_mem_75488;
    
    ext_mem_75488.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device mem_75472;
    
    mem_75472.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75471 = (int64_t) 8 * ni_60081;
    bool zzero_61603 = psizze_60084 == (int64_t) 0;
    bool nonzzero_61604 = !zzero_61603;
    bool nonzzero_cert_61605;
    
    if (!nonzzero_61604) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:455:5-50\n   #2  ftSMJ.fut:454:1-455:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75482 = (int64_t) 4 * ni_60081;
    int64_t segmap_tblock_sizze_67233;
    
    segmap_tblock_sizze_67233 = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67225;
    
    int64_t segmap_usable_groups_67234 = sdiv_up64(ni_60081, segmap_tblock_sizze_67233);
    
    if (memblock_alloc_device(ctx, &mem_75472, bytes_75471, "mem_75472")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(ni_60081, segmap_tblock_sizze_67233));
    
    {
        err = gpu_kernel_gather_payloads_float_GFURzisegmap_67237(ctx, segmap_usable_groups_67234, 1, 1, *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67225, 1, 1, (int64_t) 0, ni_60081, incr_60083, is_mem_75468.mem, mem_75472.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61601 = add64(n_60082, psizze_60084);
    int64_t zs_lhs_61602 = sub64(zm_lhs_61601, (int64_t) 1);
    int64_t m_61606 = sdiv64(zs_lhs_61602, psizze_60084);
    bool loop_cond_61607 = slt64((int64_t) 0, m_61606);
    int64_t segmap_tblock_sizze_67261;
    
    segmap_tblock_sizze_67261 = *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67243;
    
    int64_t segmap_usable_groups_67262 = sdiv_up_safe64(ni_60081, segmap_tblock_sizze_67261);
    bool partitioned_gather_over_array_res_61608;
    int64_t partitioned_gather_over_array_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75475, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75478, &preVals_mem_75467, "preVals_mem_75467") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_60084, p_61615);
        int64_t min_arg1_61617 = add64(psizze_60084, lower_bound_61616);
        int64_t min_res_61618 = smin64(n_60082, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, n_60082);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) n_60082, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:455:5-50\n   #2  ftSMJ.fut:454:1-455:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75480, bytes_75471, "mem_75480")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_60081})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75483, bytes_75482, "mem_75483")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76558 = sext_i64_i32(sdiv_up64(ni_60081, segmap_tblock_sizze_67261));
        
        {
            err = gpu_kernel_gather_payloads_float_GFURzisegmap_67265(ctx, segmap_usable_groups_67262, 1, 1, *ctx->tuning_params.gather_payloads_float_GFURzisegmap_tblock_sizze_67243, 1, 1, (int64_t) 0, ni_60081, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75469.mem, mem_param_75475.mem, mem_param_75478.mem, mem_75483.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61606);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76552, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76553, &mem_75483, "mem_75483") != 0)
            return 1;
        
        bool loop_while_tmp_76554 = loop_cond_61647;
        int64_t p_tmp_76557 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75475, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75478, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76554;
        p_61615 = p_tmp_76557;
    }
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75475, "mem_param_75475") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75488, &mem_param_75478, "mem_param_75478") != 0)
        return 1;
    partitioned_gather_over_array_res_61608 = loop_while_61612;
    partitioned_gather_over_array_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75491, bytes_75482, "mem_75491")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75491.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75488.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_60081})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75491, "mem_75491") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77354, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75491, "mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75478, "mem_param_75478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75475, "mem_param_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_77355, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_57886, int64_t dz2083U_57887, int64_t incr_57888, int64_t psizze_57889)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75481;
    
    mem_75481.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device mem_param_75476;
    
    mem_param_75476.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device ext_mem_75490;
    
    ext_mem_75490.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75470 = (int64_t) 8 * niz2084U_57886;
    bool zzero_61602 = psizze_57889 == (int64_t) 0;
    bool nonzzero_61603 = !zzero_61602;
    bool nonzzero_cert_61604;
    
    if (!nonzzero_61603) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:421:5-41\n   #2  ftSMJ.fut:420:1-421:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75472 = (int64_t) 4 * niz2084U_57886;
    int64_t segmap_tblock_sizze_66841;
    
    segmap_tblock_sizze_66841 = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66833;
    
    int64_t segmap_usable_groups_66842 = sdiv_up64(niz2084U_57886, segmap_tblock_sizze_66841);
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(niz2084U_57886, segmap_tblock_sizze_66841));
    
    {
        err = gpu_kernel_gather_payloads_intzisegmap_66845(ctx, segmap_usable_groups_66842, 1, 1, *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66833, 1, 1, (int64_t) 0, niz2084U_57886, incr_57888, is_mem_75467.mem, mem_75471.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61600 = add64(dz2083U_57887, psizze_57889);
    int64_t zs_lhs_61601 = sub64(zm_lhs_61600, (int64_t) 1);
    int64_t m_61605 = sdiv64(zs_lhs_61601, psizze_57889);
    
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75472, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, mem_75473, niz2084U_57886, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_61607 = slt64((int64_t) 0, m_61605);
    int64_t segmap_tblock_sizze_66869;
    
    segmap_tblock_sizze_66869 = *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66851;
    
    int64_t segmap_usable_groups_66870 = sdiv_up_safe64(niz2084U_57886, segmap_tblock_sizze_66869);
    bool partitioned_gather_res_61608;
    int64_t partitioned_gather_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75476, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_57889, p_61615);
        int64_t min_arg1_61617 = add64(psizze_57889, lower_bound_61616);
        int64_t min_res_61618 = smin64(dz2083U_57887, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, dz2083U_57887);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) dz2083U_57887, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:421:5-41\n   #2  ftSMJ.fut:420:1-421:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75481, bytes_75470, "mem_75481")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75476.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_57886})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75484, bytes_75472, "mem_75484")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76578 = sext_i64_i32(sdiv_up64(niz2084U_57886, segmap_tblock_sizze_66869));
        
        {
            err = gpu_kernel_gather_payloads_intzisegmap_66873(ctx, segmap_usable_groups_66870, 1, 1, *ctx->tuning_params.gather_payloads_intzisegmap_tblock_sizze_66851, 1, 1, (int64_t) 0, niz2084U_57886, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75468.mem, mem_param_75476.mem, mem_param_75479.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61605);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &mem_75484, "mem_75484") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_61647;
        int64_t p_tmp_76577 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75476, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76574;
        p_61615 = p_tmp_76577;
    }
    if (memblock_set_device(ctx, &ext_mem_75490, &mem_param_75476, "mem_param_75476") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    partitioned_gather_res_61608 = loop_while_61612;
    partitioned_gather_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75492, bytes_75472, "mem_75492")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75492.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75489.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_57886})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75492, "mem_75492") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77355, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75476, "mem_param_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75490, "ext_mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77356, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59479, int64_t n_59480, int64_t incr_59481, int64_t psizze_59482)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75491;
    
    mem_75491.references = NULL;
    
    struct memblock_device mem_param_tmp_76553;
    
    mem_param_tmp_76553.references = NULL;
    
    struct memblock_device mem_param_tmp_76552;
    
    mem_param_tmp_76552.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75480;
    
    mem_75480.references = NULL;
    
    struct memblock_device mem_param_75478;
    
    mem_param_75478.references = NULL;
    
    struct memblock_device mem_param_75475;
    
    mem_param_75475.references = NULL;
    
    struct memblock_device ext_mem_75488;
    
    ext_mem_75488.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device mem_75472;
    
    mem_75472.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75471 = (int64_t) 8 * ni_59479;
    bool zzero_61603 = psizze_59482 == (int64_t) 0;
    bool nonzzero_61604 = !zzero_61603;
    bool nonzzero_cert_61605;
    
    if (!nonzzero_61604) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:449:5-50\n   #2  ftSMJ.fut:448:1-449:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75482 = (int64_t) 4 * ni_59479;
    int64_t segmap_tblock_sizze_67121;
    
    segmap_tblock_sizze_67121 = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67113;
    
    int64_t segmap_usable_groups_67122 = sdiv_up64(ni_59479, segmap_tblock_sizze_67121);
    
    if (memblock_alloc_device(ctx, &mem_75472, bytes_75471, "mem_75472")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(ni_59479, segmap_tblock_sizze_67121));
    
    {
        err = gpu_kernel_gather_payloads_int_GFURzisegmap_67125(ctx, segmap_usable_groups_67122, 1, 1, *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67113, 1, 1, (int64_t) 0, ni_59479, incr_59481, is_mem_75468.mem, mem_75472.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61601 = add64(n_59480, psizze_59482);
    int64_t zs_lhs_61602 = sub64(zm_lhs_61601, (int64_t) 1);
    int64_t m_61606 = sdiv64(zs_lhs_61602, psizze_59482);
    bool loop_cond_61607 = slt64((int64_t) 0, m_61606);
    int64_t segmap_tblock_sizze_67149;
    
    segmap_tblock_sizze_67149 = *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67131;
    
    int64_t segmap_usable_groups_67150 = sdiv_up_safe64(ni_59479, segmap_tblock_sizze_67149);
    bool partitioned_gather_over_array_res_61608;
    int64_t partitioned_gather_over_array_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75475, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75478, &preVals_mem_75467, "preVals_mem_75467") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_59482, p_61615);
        int64_t min_arg1_61617 = add64(psizze_59482, lower_bound_61616);
        int64_t min_res_61618 = smin64(n_59480, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, n_59480);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) n_59480, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:449:5-50\n   #2  ftSMJ.fut:448:1-449:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75480, bytes_75471, "mem_75480")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59479})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75483, bytes_75482, "mem_75483")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76558 = sext_i64_i32(sdiv_up64(ni_59479, segmap_tblock_sizze_67149));
        
        {
            err = gpu_kernel_gather_payloads_int_GFURzisegmap_67153(ctx, segmap_usable_groups_67150, 1, 1, *ctx->tuning_params.gather_payloads_int_GFURzisegmap_tblock_sizze_67131, 1, 1, (int64_t) 0, ni_59479, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75469.mem, mem_param_75475.mem, mem_param_75478.mem, mem_75483.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61606);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76552, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76553, &mem_75483, "mem_75483") != 0)
            return 1;
        
        bool loop_while_tmp_76554 = loop_cond_61647;
        int64_t p_tmp_76557 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75475, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75478, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76554;
        p_61615 = p_tmp_76557;
    }
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75475, "mem_param_75475") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75488, &mem_param_75478, "mem_param_75478") != 0)
        return 1;
    partitioned_gather_over_array_res_61608 = loop_while_61612;
    partitioned_gather_over_array_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75491, bytes_75482, "mem_75491")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75491.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75488.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59479})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75491, "mem_75491") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77356, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75491, "mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75478, "mem_param_75478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75475, "mem_param_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_77357, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_58195, int64_t dz2083U_58196, int64_t incr_58197, int64_t psizze_58198)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75481;
    
    mem_75481.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device mem_param_75476;
    
    mem_param_75476.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device ext_mem_75490;
    
    ext_mem_75490.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75470 = (int64_t) 8 * niz2084U_58195;
    bool zzero_61602 = psizze_58198 == (int64_t) 0;
    bool nonzzero_61603 = !zzero_61602;
    bool nonzzero_cert_61604;
    
    if (!nonzzero_61603) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:424:5-41\n   #2  ftSMJ.fut:423:1-424:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_66897;
    
    segmap_tblock_sizze_66897 = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66889;
    
    int64_t segmap_usable_groups_66898 = sdiv_up64(niz2084U_58195, segmap_tblock_sizze_66897);
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(niz2084U_58195, segmap_tblock_sizze_66897));
    
    {
        err = gpu_kernel_gather_payloads_longzisegmap_66901(ctx, segmap_usable_groups_66898, 1, 1, *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66889, 1, 1, (int64_t) 0, niz2084U_58195, incr_58197, is_mem_75467.mem, mem_75471.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61600 = add64(dz2083U_58196, psizze_58198);
    int64_t zs_lhs_61601 = sub64(zm_lhs_61600, (int64_t) 1);
    int64_t m_61605 = sdiv64(zs_lhs_61601, psizze_58198);
    
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, niz2084U_58195, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_61607 = slt64((int64_t) 0, m_61605);
    int64_t segmap_tblock_sizze_66925;
    
    segmap_tblock_sizze_66925 = *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66907;
    
    int64_t segmap_usable_groups_66926 = sdiv_up_safe64(niz2084U_58195, segmap_tblock_sizze_66925);
    bool partitioned_gather_res_61608;
    int64_t partitioned_gather_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75476, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_58198, p_61615);
        int64_t min_arg1_61617 = add64(psizze_58198, lower_bound_61616);
        int64_t min_res_61618 = smin64(dz2083U_58196, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, dz2083U_58196);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) dz2083U_58196, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:424:5-41\n   #2  ftSMJ.fut:423:1-424:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75481, bytes_75470, "mem_75481")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75476.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58195})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75484, bytes_75470, "mem_75484")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76578 = sext_i64_i32(sdiv_up64(niz2084U_58195, segmap_tblock_sizze_66925));
        
        {
            err = gpu_kernel_gather_payloads_longzisegmap_66929(ctx, segmap_usable_groups_66926, 1, 1, *ctx->tuning_params.gather_payloads_longzisegmap_tblock_sizze_66907, 1, 1, (int64_t) 0, niz2084U_58195, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75468.mem, mem_param_75476.mem, mem_param_75479.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61605);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &mem_75484, "mem_75484") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_61647;
        int64_t p_tmp_76577 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75476, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76574;
        p_61615 = p_tmp_76577;
    }
    if (memblock_set_device(ctx, &ext_mem_75490, &mem_param_75476, "mem_param_75476") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    partitioned_gather_res_61608 = loop_while_61612;
    partitioned_gather_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75492, bytes_75470, "mem_75492")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75492.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75489.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_58195})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75492, "mem_75492") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77357, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75476, "mem_param_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75490, "ext_mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77358, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59780, int64_t n_59781, int64_t incr_59782, int64_t psizze_59783)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75491;
    
    mem_75491.references = NULL;
    
    struct memblock_device mem_param_tmp_76553;
    
    mem_param_tmp_76553.references = NULL;
    
    struct memblock_device mem_param_tmp_76552;
    
    mem_param_tmp_76552.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75480;
    
    mem_75480.references = NULL;
    
    struct memblock_device mem_param_75478;
    
    mem_param_75478.references = NULL;
    
    struct memblock_device mem_param_75475;
    
    mem_param_75475.references = NULL;
    
    struct memblock_device ext_mem_75488;
    
    ext_mem_75488.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device mem_75472;
    
    mem_75472.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75471 = (int64_t) 8 * ni_59780;
    bool zzero_61603 = psizze_59783 == (int64_t) 0;
    bool nonzzero_61604 = !zzero_61603;
    bool nonzzero_cert_61605;
    
    if (!nonzzero_61604) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:452:5-50\n   #2  ftSMJ.fut:451:1-452:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_67177;
    
    segmap_tblock_sizze_67177 = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67169;
    
    int64_t segmap_usable_groups_67178 = sdiv_up64(ni_59780, segmap_tblock_sizze_67177);
    
    if (memblock_alloc_device(ctx, &mem_75472, bytes_75471, "mem_75472")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(ni_59780, segmap_tblock_sizze_67177));
    
    {
        err = gpu_kernel_gather_payloads_long_GFURzisegmap_67181(ctx, segmap_usable_groups_67178, 1, 1, *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67169, 1, 1, (int64_t) 0, ni_59780, incr_59782, is_mem_75468.mem, mem_75472.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61601 = add64(n_59781, psizze_59783);
    int64_t zs_lhs_61602 = sub64(zm_lhs_61601, (int64_t) 1);
    int64_t m_61606 = sdiv64(zs_lhs_61602, psizze_59783);
    bool loop_cond_61607 = slt64((int64_t) 0, m_61606);
    int64_t segmap_tblock_sizze_67205;
    
    segmap_tblock_sizze_67205 = *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67187;
    
    int64_t segmap_usable_groups_67206 = sdiv_up_safe64(ni_59780, segmap_tblock_sizze_67205);
    bool partitioned_gather_over_array_res_61608;
    int64_t partitioned_gather_over_array_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75475, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75478, &preVals_mem_75467, "preVals_mem_75467") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_59783, p_61615);
        int64_t min_arg1_61617 = add64(psizze_59783, lower_bound_61616);
        int64_t min_res_61618 = smin64(n_59781, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, n_59781);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) n_59781, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:452:5-50\n   #2  ftSMJ.fut:451:1-452:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75480, bytes_75471, "mem_75480")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59780})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75483, bytes_75471, "mem_75483")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76558 = sext_i64_i32(sdiv_up64(ni_59780, segmap_tblock_sizze_67205));
        
        {
            err = gpu_kernel_gather_payloads_long_GFURzisegmap_67209(ctx, segmap_usable_groups_67206, 1, 1, *ctx->tuning_params.gather_payloads_long_GFURzisegmap_tblock_sizze_67187, 1, 1, (int64_t) 0, ni_59780, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75469.mem, mem_param_75475.mem, mem_param_75478.mem, mem_75483.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61606);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76552, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76553, &mem_75483, "mem_75483") != 0)
            return 1;
        
        bool loop_while_tmp_76554 = loop_cond_61647;
        int64_t p_tmp_76557 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75475, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75478, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76554;
        p_61615 = p_tmp_76557;
    }
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75475, "mem_param_75475") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75488, &mem_param_75478, "mem_param_75478") != 0)
        return 1;
    partitioned_gather_over_array_res_61608 = loop_while_61612;
    partitioned_gather_over_array_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75491, bytes_75471, "mem_75491")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75491.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75488.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59780})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75491, "mem_75491") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77358, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75491, "mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75478, "mem_param_75478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75475, "mem_param_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_77359, struct memblock_device is_mem_75467, struct memblock_device ys_mem_75468, int64_t niz2084U_57574, int64_t dz2083U_57575, int64_t incr_57576, int64_t psizze_57577)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75481;
    
    mem_75481.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device mem_param_75476;
    
    mem_param_75476.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device ext_mem_75490;
    
    ext_mem_75490.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75470 = (int64_t) 8 * niz2084U_57574;
    bool zzero_61602 = psizze_57577 == (int64_t) 0;
    bool nonzzero_61603 = !zzero_61602;
    bool nonzzero_cert_61604;
    
    if (!nonzzero_61603) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:418:5-41\n   #2  ftSMJ.fut:417:1-418:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75472 = (int64_t) 2 * niz2084U_57574;
    int64_t segmap_tblock_sizze_66785;
    
    segmap_tblock_sizze_66785 = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66777;
    
    int64_t segmap_usable_groups_66786 = sdiv_up64(niz2084U_57574, segmap_tblock_sizze_66785);
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(niz2084U_57574, segmap_tblock_sizze_66785));
    
    {
        err = gpu_kernel_gather_payloads_shortzisegmap_66789(ctx, segmap_usable_groups_66786, 1, 1, *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66777, 1, 1, (int64_t) 0, niz2084U_57574, incr_57576, is_mem_75467.mem, mem_75471.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61600 = add64(dz2083U_57575, psizze_57577);
    int64_t zs_lhs_61601 = sub64(zm_lhs_61600, (int64_t) 1);
    int64_t m_61605 = sdiv64(zs_lhs_61601, psizze_57577);
    
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75472, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i16(ctx, mem_75473, niz2084U_57574, (int16_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_61607 = slt64((int64_t) 0, m_61605);
    int64_t segmap_tblock_sizze_66813;
    
    segmap_tblock_sizze_66813 = *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66795;
    
    int64_t segmap_usable_groups_66814 = sdiv_up_safe64(niz2084U_57574, segmap_tblock_sizze_66813);
    bool partitioned_gather_res_61608;
    int64_t partitioned_gather_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75476, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_57577, p_61615);
        int64_t min_arg1_61617 = add64(psizze_57577, lower_bound_61616);
        int64_t min_res_61618 = smin64(dz2083U_57575, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, dz2083U_57575);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) dz2083U_57575, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:418:5-41\n   #2  ftSMJ.fut:417:1-418:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75481, bytes_75470, "mem_75481")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75476.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_57574})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75484, bytes_75472, "mem_75484")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76578 = sext_i64_i32(sdiv_up64(niz2084U_57574, segmap_tblock_sizze_66813));
        
        {
            err = gpu_kernel_gather_payloads_shortzisegmap_66817(ctx, segmap_usable_groups_66814, 1, 1, *ctx->tuning_params.gather_payloads_shortzisegmap_tblock_sizze_66795, 1, 1, (int64_t) 0, niz2084U_57574, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75468.mem, mem_param_75476.mem, mem_param_75479.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61605);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &mem_75484, "mem_75484") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_61647;
        int64_t p_tmp_76577 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75476, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76574;
        p_61615 = p_tmp_76577;
    }
    if (memblock_set_device(ctx, &ext_mem_75490, &mem_param_75476, "mem_param_75476") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    partitioned_gather_res_61608 = loop_while_61612;
    partitioned_gather_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75492, bytes_75472, "mem_75492")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75492.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75489.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_57574})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75492, "mem_75492") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77359, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75481, "mem_75481") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75476, "mem_param_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75490, "ext_mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock_device *mem_out_p_77360, struct memblock_device preVals_mem_75467, struct memblock_device is_mem_75468, struct memblock_device ys_mem_75469, int64_t ni_59178, int64_t n_59179, int64_t incr_59180, int64_t psizze_59181)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75491;
    
    mem_75491.references = NULL;
    
    struct memblock_device mem_param_tmp_76553;
    
    mem_param_tmp_76553.references = NULL;
    
    struct memblock_device mem_param_tmp_76552;
    
    mem_param_tmp_76552.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75480;
    
    mem_75480.references = NULL;
    
    struct memblock_device mem_param_75478;
    
    mem_param_75478.references = NULL;
    
    struct memblock_device mem_param_75475;
    
    mem_param_75475.references = NULL;
    
    struct memblock_device ext_mem_75488;
    
    ext_mem_75488.references = NULL;
    
    struct memblock_device ext_mem_75489;
    
    ext_mem_75489.references = NULL;
    
    struct memblock_device mem_75472;
    
    mem_75472.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t bytes_75471 = (int64_t) 8 * ni_59178;
    bool zzero_61603 = psizze_59181 == (int64_t) 0;
    bool nonzzero_61604 = !zzero_61603;
    bool nonzzero_cert_61605;
    
    if (!nonzzero_61604) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftSMJ.fut:446:5-50\n   #2  ftSMJ.fut:445:1-446:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75482 = (int64_t) 2 * ni_59178;
    int64_t segmap_tblock_sizze_67065;
    
    segmap_tblock_sizze_67065 = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67057;
    
    int64_t segmap_usable_groups_67066 = sdiv_up64(ni_59178, segmap_tblock_sizze_67065);
    
    if (memblock_alloc_device(ctx, &mem_75472, bytes_75471, "mem_75472")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_76543 = sext_i64_i32(sdiv_up64(ni_59178, segmap_tblock_sizze_67065));
    
    {
        err = gpu_kernel_gather_payloads_short_GFURzisegmap_67069(ctx, segmap_usable_groups_67066, 1, 1, *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67057, 1, 1, (int64_t) 0, ni_59178, incr_59180, is_mem_75468.mem, mem_75472.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t zm_lhs_61601 = add64(n_59179, psizze_59181);
    int64_t zs_lhs_61602 = sub64(zm_lhs_61601, (int64_t) 1);
    int64_t m_61606 = sdiv64(zs_lhs_61602, psizze_59181);
    bool loop_cond_61607 = slt64((int64_t) 0, m_61606);
    int64_t segmap_tblock_sizze_67093;
    
    segmap_tblock_sizze_67093 = *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67075;
    
    int64_t segmap_usable_groups_67094 = sdiv_up_safe64(ni_59178, segmap_tblock_sizze_67093);
    bool partitioned_gather_over_array_res_61608;
    int64_t partitioned_gather_over_array_res_61611;
    bool loop_while_61612;
    int64_t p_61615;
    
    if (memblock_set_device(ctx, &mem_param_75475, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75478, &preVals_mem_75467, "preVals_mem_75467") != 0)
        return 1;
    loop_while_61612 = loop_cond_61607;
    p_61615 = (int64_t) 0;
    while (loop_while_61612) {
        int64_t lower_bound_61616 = mul64(psizze_59181, p_61615);
        int64_t min_arg1_61617 = add64(psizze_59181, lower_bound_61616);
        int64_t min_res_61618 = smin64(n_59179, min_arg1_61617);
        int64_t j_m_i_61619 = sub64(min_res_61618, lower_bound_61616);
        bool empty_slice_61620 = j_m_i_61619 == (int64_t) 0;
        int64_t m_61621 = sub64(j_m_i_61619, (int64_t) 1);
        int64_t i_p_m_t_s_61622 = add64(lower_bound_61616, m_61621);
        bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, i_p_m_t_s_61622);
        bool i_p_m_t_s_leq_w_61624 = slt64(i_p_m_t_s_61622, n_59179);
        bool zzero_lte_i_61625 = sle64((int64_t) 0, lower_bound_61616);
        bool i_lte_j_61626 = sle64(lower_bound_61616, min_res_61618);
        bool y_61627 = i_p_m_t_s_leq_w_61624 && zzero_lte_i_61625;
        bool y_61628 = zzero_leq_i_p_m_t_s_61623 && y_61627;
        bool forwards_ok_61629 = i_lte_j_61626 && y_61628;
        bool ok_or_empty_61630 = empty_slice_61620 || forwards_ok_61629;
        bool index_certs_61631;
        
        if (!ok_or_empty_61630) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_61616, ":", (long long) min_res_61618, "] out of bounds for array of shape [", (long long) n_59179, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftSMJ.fut:446:5-50\n   #2  ftSMJ.fut:445:1-446:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_75480, bytes_75471, "mem_75480")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59178})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75483, bytes_75482, "mem_75483")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_76558 = sext_i64_i32(sdiv_up64(ni_59178, segmap_tblock_sizze_67093));
        
        {
            err = gpu_kernel_gather_payloads_short_GFURzisegmap_67097(ctx, segmap_usable_groups_67094, 1, 1, *ctx->tuning_params.gather_payloads_short_GFURzisegmap_tblock_sizze_67075, 1, 1, (int64_t) 0, ni_59178, lower_bound_61616, min_res_61618, j_m_i_61619, ys_mem_75469.mem, mem_param_75475.mem, mem_param_75478.mem, mem_75483.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_61646 = add64((int64_t) 1, p_61615);
        bool loop_cond_61647 = slt64(tmp_61646, m_61606);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76552, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76553, &mem_75483, "mem_75483") != 0)
            return 1;
        
        bool loop_while_tmp_76554 = loop_cond_61647;
        int64_t p_tmp_76557 = tmp_61646;
        
        if (memblock_set_device(ctx, &mem_param_75475, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75478, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        loop_while_61612 = loop_while_tmp_76554;
        p_61615 = p_tmp_76557;
    }
    if (memblock_set_device(ctx, &ext_mem_75489, &mem_param_75475, "mem_param_75475") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75488, &mem_param_75478, "mem_param_75478") != 0)
        return 1;
    partitioned_gather_over_array_res_61608 = loop_while_61612;
    partitioned_gather_over_array_res_61611 = p_61615;
    if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_75491, bytes_75482, "mem_75491")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75491.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75488.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_59178})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75491, "mem_75491") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77360, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75491, "mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76553, "mem_param_tmp_76553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76552, "mem_param_tmp_76552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75480, "mem_75480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75478, "mem_param_75478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75475, "mem_param_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75488, "ext_mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75489, "ext_mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75472, "mem_75472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_77361, struct memblock_device *mem_out_p_77362, struct memblock_device *mem_out_p_77363, int64_t *out_prim_out_77364, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_57224, int64_t nS_57225, int64_t offset_R_57228, int64_t offset_S_57229, int64_t partitionsPerWindow_57230, int64_t numberOfWindows_57231, int64_t extParallelism_57232, int64_t scatter_psizze_57233)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_76045;
    
    mem_76045.references = NULL;
    
    struct memblock_device mem_76043;
    
    mem_76043.references = NULL;
    
    struct memblock_device mem_76041;
    
    mem_76041.references = NULL;
    
    struct memblock_device mem_param_tmp_77290;
    
    mem_param_tmp_77290.references = NULL;
    
    struct memblock_device mem_param_tmp_77289;
    
    mem_param_tmp_77289.references = NULL;
    
    struct memblock_device mem_param_tmp_77288;
    
    mem_param_tmp_77288.references = NULL;
    
    struct memblock_device mem_76027;
    
    mem_76027.references = NULL;
    
    struct memblock_device mem_76025;
    
    mem_76025.references = NULL;
    
    struct memblock_device mem_76020;
    
    mem_76020.references = NULL;
    
    struct memblock_device mem_76018;
    
    mem_76018.references = NULL;
    
    struct memblock_device mem_76016;
    
    mem_76016.references = NULL;
    
    struct memblock_device mem_param_76014;
    
    mem_param_76014.references = NULL;
    
    struct memblock_device mem_param_76011;
    
    mem_param_76011.references = NULL;
    
    struct memblock_device mem_param_76008;
    
    mem_param_76008.references = NULL;
    
    struct memblock_device ext_mem_76037;
    
    ext_mem_76037.references = NULL;
    
    struct memblock_device ext_mem_76038;
    
    ext_mem_76038.references = NULL;
    
    struct memblock_device ext_mem_76039;
    
    ext_mem_76039.references = NULL;
    
    struct memblock_device mem_76023;
    
    mem_76023.references = NULL;
    
    struct memblock_device mem_76022;
    
    mem_76022.references = NULL;
    
    struct memblock_device mem_76021;
    
    mem_76021.references = NULL;
    
    struct memblock_device mem_75995;
    
    mem_75995.references = NULL;
    
    struct memblock_device mem_75993;
    
    mem_75993.references = NULL;
    
    struct memblock_device mem_75991;
    
    mem_75991.references = NULL;
    
    struct memblock_device mem_75980;
    
    mem_75980.references = NULL;
    
    struct memblock_device mem_75978;
    
    mem_75978.references = NULL;
    
    struct memblock_device mem_75976;
    
    mem_75976.references = NULL;
    
    struct memblock_device mem_75972;
    
    mem_75972.references = NULL;
    
    struct memblock_device mem_75970;
    
    mem_75970.references = NULL;
    
    struct memblock_device mem_75974;
    
    mem_75974.references = NULL;
    
    struct memblock_device mem_75966;
    
    mem_75966.references = NULL;
    
    struct memblock_device mem_75967;
    
    mem_75967.references = NULL;
    
    struct memblock_device ext_mem_75968;
    
    ext_mem_75968.references = NULL;
    
    struct memblock_device mem_75963;
    
    mem_75963.references = NULL;
    
    struct memblock_device mem_75964;
    
    mem_75964.references = NULL;
    
    struct memblock_device ext_mem_75965;
    
    ext_mem_75965.references = NULL;
    
    struct memblock_device mem_75962;
    
    mem_75962.references = NULL;
    
    struct memblock_device incprefixes_mem_77091;
    
    incprefixes_mem_77091.references = NULL;
    
    struct memblock_device aggregates_mem_77089;
    
    aggregates_mem_77089.references = NULL;
    
    struct memblock_device incprefixes_mem_77087;
    
    incprefixes_mem_77087.references = NULL;
    
    struct memblock_device aggregates_mem_77085;
    
    aggregates_mem_77085.references = NULL;
    
    struct memblock_device status_flags_mem_77083;
    
    status_flags_mem_77083.references = NULL;
    
    struct memblock_device mem_75959;
    
    mem_75959.references = NULL;
    
    struct memblock_device mem_75957;
    
    mem_75957.references = NULL;
    
    struct memblock_device mem_75955;
    
    mem_75955.references = NULL;
    
    struct memblock_device mem_75951;
    
    mem_75951.references = NULL;
    
    struct memblock_device mem_75949;
    
    mem_75949.references = NULL;
    
    struct memblock_device mem_75947;
    
    mem_75947.references = NULL;
    
    struct memblock_device mem_75945;
    
    mem_75945.references = NULL;
    
    struct memblock_device incprefixes_mem_76950;
    
    incprefixes_mem_76950.references = NULL;
    
    struct memblock_device aggregates_mem_76948;
    
    aggregates_mem_76948.references = NULL;
    
    struct memblock_device status_flags_mem_76926;
    
    status_flags_mem_76926.references = NULL;
    
    struct memblock_device mem_75943;
    
    mem_75943.references = NULL;
    
    struct memblock_device mem_75941;
    
    mem_75941.references = NULL;
    
    struct memblock_device mem_param_tmp_76593;
    
    mem_param_tmp_76593.references = NULL;
    
    struct memblock_device mem_param_tmp_76592;
    
    mem_param_tmp_76592.references = NULL;
    
    struct memblock_device mem_75926;
    
    mem_75926.references = NULL;
    
    struct memblock_device mem_75925;
    
    mem_75925.references = NULL;
    
    struct memblock_device mem_75922;
    
    mem_75922.references = NULL;
    
    struct memblock_device mem_param_tmp_76750;
    
    mem_param_tmp_76750.references = NULL;
    
    struct memblock_device mem_param_tmp_76749;
    
    mem_param_tmp_76749.references = NULL;
    
    struct memblock_device mem_75730;
    
    mem_75730.references = NULL;
    
    struct memblock_device mem_75728;
    
    mem_75728.references = NULL;
    
    struct memblock_device mem_75726;
    
    mem_75726.references = NULL;
    
    struct memblock_device mem_75723;
    
    mem_75723.references = NULL;
    
    struct memblock_device mem_param_tmp_76760;
    
    mem_param_tmp_76760.references = NULL;
    
    struct memblock_device mem_param_tmp_76759;
    
    mem_param_tmp_76759.references = NULL;
    
    struct memblock_device mem_75714;
    
    mem_75714.references = NULL;
    
    struct memblock_device mem_75711;
    
    mem_75711.references = NULL;
    
    struct memblock_device mem_param_tmp_76778;
    
    mem_param_tmp_76778.references = NULL;
    
    struct memblock_device mem_param_tmp_76777;
    
    mem_param_tmp_76777.references = NULL;
    
    struct memblock_device mem_75690;
    
    mem_75690.references = NULL;
    
    struct memblock_device mem_75688;
    
    mem_75688.references = NULL;
    
    struct memblock_device mem_75623;
    
    mem_75623.references = NULL;
    
    struct memblock_device mem_75621;
    
    mem_75621.references = NULL;
    
    struct memblock_device mem_75684;
    
    mem_75684.references = NULL;
    
    struct memblock_device mem_75682;
    
    mem_75682.references = NULL;
    
    struct memblock_device ext_mem_75685;
    
    ext_mem_75685.references = NULL;
    
    struct memblock_device ext_mem_75686;
    
    ext_mem_75686.references = NULL;
    
    struct memblock_device ext_mem_75562;
    
    ext_mem_75562.references = NULL;
    
    struct memblock_device mem_75560;
    
    mem_75560.references = NULL;
    
    struct memblock_device ext_mem_75693;
    
    ext_mem_75693.references = NULL;
    
    struct memblock_device ext_mem_75696;
    
    ext_mem_75696.references = NULL;
    
    struct memblock_device mem_75558;
    
    mem_75558.references = NULL;
    
    struct memblock_device ext_mem_75699;
    
    ext_mem_75699.references = NULL;
    
    struct memblock_device ext_mem_75702;
    
    ext_mem_75702.references = NULL;
    
    struct memblock_device ext_mem_75556;
    
    ext_mem_75556.references = NULL;
    
    struct memblock_device ext_mem_75555;
    
    ext_mem_75555.references = NULL;
    
    struct memblock_device mem_param_75552;
    
    mem_param_75552.references = NULL;
    
    struct memblock_device mem_param_75549;
    
    mem_param_75549.references = NULL;
    
    struct memblock_device ext_mem_75707;
    
    ext_mem_75707.references = NULL;
    
    struct memblock_device ext_mem_75708;
    
    ext_mem_75708.references = NULL;
    
    struct memblock_device mem_75544;
    
    mem_75544.references = NULL;
    
    struct memblock_device mem_75545;
    
    mem_75545.references = NULL;
    
    struct memblock_device ext_mem_75546;
    
    ext_mem_75546.references = NULL;
    
    struct memblock_device mem_75541;
    
    mem_75541.references = NULL;
    
    struct memblock_device mem_75542;
    
    mem_75542.references = NULL;
    
    struct memblock_device ext_mem_75543;
    
    ext_mem_75543.references = NULL;
    
    struct memblock_device mem_param_75540;
    
    mem_param_75540.references = NULL;
    
    struct memblock_device mem_param_75537;
    
    mem_param_75537.references = NULL;
    
    struct memblock_device ext_mem_75719;
    
    ext_mem_75719.references = NULL;
    
    struct memblock_device ext_mem_75720;
    
    ext_mem_75720.references = NULL;
    
    struct memblock_device mem_75557;
    
    mem_75557.references = NULL;
    
    struct memblock_device mem_75554;
    
    mem_75554.references = NULL;
    
    struct memblock_device mem_75553;
    
    mem_75553.references = NULL;
    
    struct memblock_device mem_75534;
    
    mem_75534.references = NULL;
    
    struct memblock_device mem_75532;
    
    mem_75532.references = NULL;
    
    struct memblock_device ext_mem_75733;
    
    ext_mem_75733.references = NULL;
    
    struct memblock_device ext_mem_75736;
    
    ext_mem_75736.references = NULL;
    
    struct memblock_device ext_mem_75739;
    
    ext_mem_75739.references = NULL;
    
    struct memblock_device ext_mem_75742;
    
    ext_mem_75742.references = NULL;
    
    struct memblock_device mem_param_75530;
    
    mem_param_75530.references = NULL;
    
    struct memblock_device mem_param_75527;
    
    mem_param_75527.references = NULL;
    
    struct memblock_device ext_mem_75747;
    
    ext_mem_75747.references = NULL;
    
    struct memblock_device ext_mem_75748;
    
    ext_mem_75748.references = NULL;
    
    struct memblock_device mem_75524;
    
    mem_75524.references = NULL;
    
    struct memblock_device mem_75522;
    
    mem_75522.references = NULL;
    
    struct memblock_device mem_75509;
    
    mem_75509.references = NULL;
    
    struct memblock_device mem_75511;
    
    mem_75511.references = NULL;
    
    struct memblock_device ext_mem_75512;
    
    ext_mem_75512.references = NULL;
    
    struct memblock_device ext_mem_75513;
    
    ext_mem_75513.references = NULL;
    
    struct memblock_device mem_75506;
    
    mem_75506.references = NULL;
    
    struct memblock_device mem_75504;
    
    mem_75504.references = NULL;
    
    struct memblock_device mem_75493;
    
    mem_75493.references = NULL;
    
    struct memblock_device mem_75494;
    
    mem_75494.references = NULL;
    
    struct memblock_device ext_mem_75495;
    
    ext_mem_75495.references = NULL;
    
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_75489;
    
    mem_75489.references = NULL;
    
    struct memblock_device mem_75490;
    
    mem_75490.references = NULL;
    
    struct memblock_device ext_mem_75491;
    
    ext_mem_75491.references = NULL;
    
    struct memblock_device mem_75488;
    
    mem_75488.references = NULL;
    
    struct memblock_device mem_75486;
    
    mem_75486.references = NULL;
    
    struct memblock_device mem_param_tmp_76611;
    
    mem_param_tmp_76611.references = NULL;
    
    struct memblock_device mem_param_tmp_76610;
    
    mem_param_tmp_76610.references = NULL;
    
    struct memblock_device mem_75895;
    
    mem_75895.references = NULL;
    
    struct memblock_device mem_75893;
    
    mem_75893.references = NULL;
    
    struct memblock_device mem_75828;
    
    mem_75828.references = NULL;
    
    struct memblock_device mem_75826;
    
    mem_75826.references = NULL;
    
    struct memblock_device mem_75889;
    
    mem_75889.references = NULL;
    
    struct memblock_device mem_75887;
    
    mem_75887.references = NULL;
    
    struct memblock_device ext_mem_75890;
    
    ext_mem_75890.references = NULL;
    
    struct memblock_device ext_mem_75891;
    
    ext_mem_75891.references = NULL;
    
    struct memblock_device ext_mem_75767;
    
    ext_mem_75767.references = NULL;
    
    struct memblock_device mem_75765;
    
    mem_75765.references = NULL;
    
    struct memblock_device ext_mem_75898;
    
    ext_mem_75898.references = NULL;
    
    struct memblock_device ext_mem_75901;
    
    ext_mem_75901.references = NULL;
    
    struct memblock_device mem_75763;
    
    mem_75763.references = NULL;
    
    struct memblock_device ext_mem_75904;
    
    ext_mem_75904.references = NULL;
    
    struct memblock_device ext_mem_75907;
    
    ext_mem_75907.references = NULL;
    
    struct memblock_device ext_mem_75761;
    
    ext_mem_75761.references = NULL;
    
    struct memblock_device ext_mem_75760;
    
    ext_mem_75760.references = NULL;
    
    struct memblock_device mem_param_75757;
    
    mem_param_75757.references = NULL;
    
    struct memblock_device mem_param_75754;
    
    mem_param_75754.references = NULL;
    
    struct memblock_device ext_mem_75912;
    
    ext_mem_75912.references = NULL;
    
    struct memblock_device ext_mem_75913;
    
    ext_mem_75913.references = NULL;
    
    struct memblock_device mem_75762;
    
    mem_75762.references = NULL;
    
    struct memblock_device mem_75759;
    
    mem_75759.references = NULL;
    
    struct memblock_device mem_75758;
    
    mem_75758.references = NULL;
    
    struct memblock_device mem_75749;
    
    mem_75749.references = NULL;
    
    struct memblock_device mem_75750;
    
    mem_75750.references = NULL;
    
    struct memblock_device ext_mem_75751;
    
    ext_mem_75751.references = NULL;
    
    struct memblock_device ext_mem_75916;
    
    ext_mem_75916.references = NULL;
    
    struct memblock_device ext_mem_75919;
    
    ext_mem_75919.references = NULL;
    
    struct memblock_device ext_mem_75929;
    
    ext_mem_75929.references = NULL;
    
    struct memblock_device ext_mem_75932;
    
    ext_mem_75932.references = NULL;
    
    struct memblock_device mem_param_75482;
    
    mem_param_75482.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device ext_mem_75937;
    
    ext_mem_75937.references = NULL;
    
    struct memblock_device ext_mem_75938;
    
    ext_mem_75938.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75474;
    
    mem_75474.references = NULL;
    
    struct memblock_device mem_75475;
    
    mem_75475.references = NULL;
    
    struct memblock_device ext_mem_75476;
    
    ext_mem_75476.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device ext_mem_75469;
    
    ext_mem_75469.references = NULL;
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76545;
    int64_t zm_lhs_64812 = add64(nR_57224, nS_57225);
    int64_t zs_lhs_64813 = sub64(zm_lhs_64812, (int64_t) 1);
    bool zzero_64814 = nR_57224 == (int64_t) 0;
    bool nonzzero_64815 = !zzero_64814;
    bool nonzzero_cert_64816;
    
    if (!nonzzero_64815) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:231:26-29\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_64817 = sdiv64(zs_lhs_64813, nR_57224);
    
    if (futrts_indicesWithIncrement_7898(ctx, &ext_mem_75469, tR_mem_75467, nR_57224, offset_R_57228) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_75470 = (int64_t) 8 * nR_57224;
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75471, nR_57224, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, nR_57224, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_64822 = slt64((int64_t) 0, numIter_64817);
    int64_t gt_rhs_64823 = sub64(nR_57224, (int64_t) 1);
    bool x_64824 = sle64((int64_t) 0, gt_rhs_64823);
    bool y_64825 = slt64(gt_rhs_64823, nR_57224);
    bool bounds_check_64826 = x_64824 && y_64825;
    bool loop_not_taken_64827 = !loop_cond_64822;
    bool protect_assert_disj_64828 = bounds_check_64826 || loop_not_taken_64827;
    bool index_certs_64829;
    
    if (!protect_assert_disj_64828) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftSMJ.fut:238:25-33\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_64822) {
        if (memblock_alloc_device(ctx, &mem_75475, (int64_t) 8, "mem_75475")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_76566(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, tR_mem_75467.mem, mem_75475.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75475, "mem_75475") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75474, (int64_t) 8, "mem_75474")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_75474, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75474, "mem_75474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_75483, (int64_t) 8, "mem_75483")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75484, (int64_t) 1, "mem_75484")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_64832;
    int64_t defunc_0_mergeJoin_res_64833;
    bool loop_while_64836;
    int64_t p_64837;
    
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75482, &mem_75471, "mem_75471") != 0)
        return 1;
    loop_while_64836 = loop_cond_64822;
    p_64837 = (int64_t) 0;
    while (loop_while_64836) {
        int64_t tS_start_64840 = mul64(nR_57224, p_64837);
        int64_t min_arg1_64841 = add64(nR_57224, tS_start_64840);
        int64_t min_res_64842 = smin64(nS_57225, min_arg1_64841);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 = sub64(min_res_64842, tS_start_64840);
        bool empty_slice_64844 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 == (int64_t) 0;
        int64_t m_64845 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, (int64_t) 1);
        int64_t i_p_m_t_s_64846 = add64(tS_start_64840, m_64845);
        bool zzero_leq_i_p_m_t_s_64847 = sle64((int64_t) 0, i_p_m_t_s_64846);
        bool i_p_m_t_s_leq_w_64848 = slt64(i_p_m_t_s_64846, nS_57225);
        bool zzero_lte_i_64849 = sle64((int64_t) 0, tS_start_64840);
        bool i_lte_j_64850 = sle64(tS_start_64840, min_res_64842);
        bool y_64851 = i_p_m_t_s_leq_w_64848 && zzero_lte_i_64849;
        bool y_64852 = zzero_leq_i_p_m_t_s_64847 && y_64851;
        bool forwards_ok_64853 = i_lte_j_64850 && y_64852;
        bool ok_or_empty_64854 = empty_slice_64844 || forwards_ok_64853;
        bool index_certs_64855;
        
        if (!ok_or_empty_64854) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_64840, ":", (long long) min_res_64842, "] out of bounds for array of shape [", (long long) nS_57225, "].", "-> #0  ftSMJ.fut:237:16-35\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_64857 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
        bool index_certs_64858;
        
        if (!y_64857) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:238:12-19\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_76598(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_64840, tS_mem_75468.mem, ext_mem_75476.mem, mem_75483.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_77365;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77365, mem_75484.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_64860 = read_res_77365;
        int64_t loopres_64861;
        
        if (defunc_0_gt_res_64860) {
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_param_75479, "mem_param_75479") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_param_75482, "mem_param_75482") != 0)
                return 1;
            loopres_64861 = numIter_64817;
        } else {
            bool cond_64864 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, nR_57224);
            bool dim_match_64978 = nR_57224 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            bool protect_assert_disj_76147 = cond_64864 || dim_match_64978;
            bool empty_or_match_cert_64979;
            
            if (!protect_assert_disj_76147) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "] cannot match shape of type `[", (long long) nR_57224, "]f64`.", "-> #0  ftSMJ.fut:246:18-31\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_64985 = slt64((int64_t) 0, numberOfWindows_57231);
            bool y_64988 = slt64((int64_t) 0, nR_57224);
            bool loop_not_taken_64989 = !loop_cond_64985;
            bool protect_assert_disj_64990 = y_64988 || loop_not_taken_64989;
            bool protect_assert_disj_76149 = cond_64864 || protect_assert_disj_64990;
            bool index_certs_64991;
            
            if (!protect_assert_disj_76149) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftbasics.fut:150:20-25\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_66374 = add64(nR_57224, extParallelism_57232);
            int64_t zs_lhs_66375 = sub64(zm_lhs_66374, (int64_t) 1);
            bool zzero_66376 = extParallelism_57232 == (int64_t) 0;
            bool nonzzero_66377 = !zzero_66376;
            bool loop_not_taken_76090 = !cond_64864;
            bool protect_assert_disj_76091 = nonzzero_66377 || loop_not_taken_76090;
            bool nonzzero_cert_66378;
            
            if (!protect_assert_disj_76091) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_66379 = sdiv_safe64(zs_lhs_66375, extParallelism_57232);
            bool loop_cond_66380 = slt64((int64_t) 0, numIter_66379);
            bool loop_not_taken_66381 = !y_64857;
            bool loop_not_taken_66382 = !loop_cond_66380;
            bool x_66383 = sle64((int64_t) 0, m_64845);
            bool y_66384 = slt64(m_64845, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
            bool bounds_check_66386 = x_66383 && y_66384;
            bool protect_assert_disj_66387 = loop_not_taken_66381 || bounds_check_66386;
            bool protect_assert_disj_66388 = loop_not_taken_66382 || protect_assert_disj_66387;
            bool protect_assert_disj_76093 = protect_assert_disj_66388 || loop_not_taken_76090;
            bool index_certs_66389;
            
            if (!protect_assert_disj_76093) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65659;
            
            if (!bounds_check_66386) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:257:23-44\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65661;
            
            if (!bounds_check_64826) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftSMJ.fut:257:51-59\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 = mul64(partitionsPerWindow_57230, numberOfWindows_57231);
            int64_t join_chunks_arg3_64981 = add64(offset_S_57229, tS_start_64840);
            int64_t bytes_75485 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
            bool empty_slice_64986 = partitionsPerWindow_57230 == (int64_t) 0;
            int64_t m_64987 = sub64(partitionsPerWindow_57230, (int64_t) 1);
            int64_t segmap_tblock_sizze_72960;
            
            segmap_tblock_sizze_72960 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_72753;
            
            int64_t zeze_rhs_65256 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, (int64_t) 1);
            int64_t segmap_tblock_sizze_73334;
            
            segmap_tblock_sizze_73334 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73170;
            
            int64_t segmap_usable_groups_73335 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_73334);
            bool loop_cond_65411 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
            bool protect_cond_conj_66385 = y_64857 && loop_cond_66380;
            int64_t bytes_75764 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            int64_t ext_75918;
            int64_t ext_75917;
            int64_t ext_75915;
            int64_t ext_75914;
            
            if (cond_64864) {
                if (protect_cond_conj_66385) {
                    if (memblock_alloc_device(ctx, &mem_75750, (int64_t) 8, "mem_75750")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76604(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_64846, tS_mem_75468.mem, mem_75750.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75750, "mem_75750") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75749, (int64_t) 8, "mem_75749")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_75749, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75749, "mem_75749") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75758, (int64_t) 8, "mem_75758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75759, (int64_t) 8, "mem_75759")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75762, (int64_t) 1, "mem_75762")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_75911;
                int64_t ext_75910;
                int64_t ext_75909;
                int64_t ext_75908;
                bool defunc_0_find_joinTuples_res_66392;
                int64_t defunc_0_find_joinTuples_res_66393;
                bool loop_while_66396;
                int64_t p_66397;
                int64_t ctx_param_ext_75752;
                int64_t ctx_param_ext_75753;
                int64_t ctx_param_ext_75755;
                int64_t ctx_param_ext_75756;
                
                if (memblock_set_device(ctx, &mem_param_75754, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75757, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75752 = (int64_t) 0;
                ctx_param_ext_75753 = (int64_t) 1;
                ctx_param_ext_75755 = (int64_t) 0;
                ctx_param_ext_75756 = (int64_t) 1;
                loop_while_66396 = loop_cond_66380;
                p_66397 = (int64_t) 0;
                while (loop_while_66396) {
                    int64_t start_66400 = mul64(extParallelism_57232, p_66397);
                    int64_t min_arg1_66401 = sub64(nR_57224, start_66400);
                    int64_t min_res_66402 = smin64(extParallelism_57232, min_arg1_66401);
                    int64_t iter_R_66403 = add64(start_66400, min_res_66402);
                    bool empty_slice_66404 = min_res_66402 == (int64_t) 0;
                    int64_t m_66405 = sub64(min_res_66402, (int64_t) 1);
                    int64_t i_p_m_t_s_66406 = add64(start_66400, m_66405);
                    bool zzero_leq_i_p_m_t_s_66407 = sle64((int64_t) 0, i_p_m_t_s_66406);
                    bool i_p_m_t_s_leq_w_66408 = slt64(i_p_m_t_s_66406, nR_57224);
                    bool zzero_lte_i_66409 = sle64((int64_t) 0, start_66400);
                    bool i_lte_j_66410 = sle64(start_66400, iter_R_66403);
                    bool y_66411 = i_p_m_t_s_leq_w_66408 && zzero_lte_i_66409;
                    bool y_66412 = zzero_leq_i_p_m_t_s_66407 && y_66411;
                    bool forwards_ok_66413 = i_lte_j_66410 && y_66412;
                    bool ok_or_empty_66414 = empty_slice_66404 || forwards_ok_66413;
                    bool index_certs_66415;
                    
                    if (!ok_or_empty_66414) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_66400, ":", (long long) iter_R_66403, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66416 = slt64(m_66405, min_res_66402);
                    bool x_66417 = sle64((int64_t) 0, m_66405);
                    bool bounds_check_66418 = y_66416 && x_66417;
                    bool index_certs_66419;
                    
                    if (!bounds_check_66418) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_66405, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66422 = slt64((int64_t) 0, min_res_66402);
                    bool index_certs_66423;
                    
                    if (!y_66422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76620(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_66400, i_p_m_t_s_66406, tR_mem_75467.mem, mem_75758.mem, mem_75759.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75760, &ext_mem_75751, "ext_mem_75751") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75760, &mem_75758, "mem_75758") != 0)
                        return 1;
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75761, &mem_75483, "mem_75483") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75761, &mem_75759, "mem_75759") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76626(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75759.mem, ext_mem_75760.mem, mem_75762.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
                        return 1;
                    
                    bool read_res_77366;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77366, mem_75762.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_66425 = read_res_77366;
                    int64_t ext_75906;
                    int64_t ext_75905;
                    int64_t ext_75903;
                    int64_t ext_75902;
                    int64_t loopres_66427;
                    
                    if (defunc_0_gt_res_66425) {
                        if (memblock_set_device(ctx, &ext_mem_75907, &mem_param_75754, "mem_param_75754") != 0)
                            return 1;
                        ext_75906 = ctx_param_ext_75752;
                        ext_75905 = ctx_param_ext_75753;
                        if (memblock_set_device(ctx, &ext_mem_75904, &mem_param_75757, "mem_param_75757") != 0)
                            return 1;
                        ext_75903 = ctx_param_ext_75755;
                        ext_75902 = ctx_param_ext_75756;
                        loopres_66427 = numIter_66379;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75763, (int64_t) 1, "mem_75763")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_doublezigpuseq_76632(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75758.mem, ext_mem_75761.mem, mem_75763.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_77367;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77367, mem_75763.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_66431 = read_res_77367;
                        
                        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
                            return 1;
                        
                        int64_t ext_75900;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75900 = ctx_param_ext_75752;
                        } else {
                            ext_75900 = (int64_t) 0;
                        }
                        
                        int64_t ext_75899;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75899 = ctx_param_ext_75753;
                        } else {
                            ext_75899 = (int64_t) 1;
                        }
                        
                        int64_t ext_75897;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75897 = ctx_param_ext_75755;
                        } else {
                            ext_75897 = (int64_t) 0;
                        }
                        
                        int64_t ext_75896;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75896 = ctx_param_ext_75756;
                        } else {
                            ext_75896 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_66432;
                        
                        if (defunc_0_gt_res_66431) {
                            int64_t tmp_66436 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_param_75754, "mem_param_75754") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_param_75757, "mem_param_75757") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66436;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_75765, bytes_75764, "mem_75765")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75765.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, tS_start_64840, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_7898(ctx, &ext_mem_75767, mem_75765, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, join_chunks_arg3_64981) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
                                return 1;
                            
                            bool suff_outer_par_72575;
                            
                            suff_outer_par_72575 = *ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_0 <= min_res_66402;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_double.suff_outer_par_0", (long) min_res_66402, suff_outer_par_72575 ? "true" : "false");
                            
                            int64_t tile_sizze_74256;
                            
                            tile_sizze_74256 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255;
                            
                            int64_t tile_sizze_73901;
                            
                            tile_sizze_73901 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900;
                            
                            int64_t num_whole_tiles_74272 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            int64_t residual_input_74496 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            bool cond_74497 = residual_input_74496 == (int64_t) 0;
                            int64_t binop_x_74513 = tile_sizze_74256 * num_whole_tiles_74272;
                            int64_t bytes_75825 = (int64_t) 8 * min_res_66402;
                            int64_t bytes_75788 = (int64_t) 8 * tile_sizze_74256;
                            int64_t num_whole_tiles_73917 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            int64_t residual_input_74141 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            bool cond_74142 = residual_input_74141 == (int64_t) 0;
                            int64_t binop_x_74158 = tile_sizze_73901 * num_whole_tiles_73917;
                            int64_t bytes_75849 = (int64_t) 8 * tile_sizze_73901;
                            int64_t shared_memory_capacity_76690;
                            
                            shared_memory_capacity_76690 = ctx->max_shared_memory;
                            if (suff_outer_par_72575 && sle64(sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76690)) {
                                int64_t ldim_73902 = sdiv_up64(min_res_66402, tile_sizze_73901);
                                
                                if (memblock_alloc_device(ctx, &mem_75887, bytes_75825, "mem_75887")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75889, bytes_75825, "mem_75889")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76638 = sext_i64_i32(sdiv_up64(tile_sizze_73901, tile_sizze_73901));
                                int32_t virt_num_tblocks_76639 = sext_i64_i32(ldim_73902);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_73899(ctx, ldim_73902, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_73900, 1, 1, bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_73902, num_whole_tiles_73917, residual_input_74141, cond_74142, binop_x_74158, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75887.mem, mem_75889.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75887, "mem_75887") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75889, "mem_75889") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_74257 = sdiv_up64(min_res_66402, tile_sizze_74256);
                                
                                if (memblock_alloc_device(ctx, &mem_75826, bytes_75825, "mem_75826")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75828, bytes_75825, "mem_75828")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76664 = sext_i64_i32(sdiv_up64(tile_sizze_74256, tile_sizze_74256));
                                int32_t virt_num_tblocks_76665 = sext_i64_i32(ldim_74257);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74254(ctx, ldim_74257, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74255, 1, 1, bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_74257, num_whole_tiles_74272, residual_input_74496, cond_74497, binop_x_74513, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75826.mem, mem_75828.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75826, "mem_75826") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75828, "mem_75828") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75893, bytes_75470, "mem_75893")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75757.mem, ctx_param_ext_75755, (int64_t []) {ctx_param_ext_75756}, (int64_t []) {nR_57224})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75891.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75895, bytes_75470, "mem_75895")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75754.mem, ctx_param_ext_75752, (int64_t []) {ctx_param_ext_75753}, (int64_t []) {nR_57224})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
                                return 1;
                            
                            int64_t tmp_66488 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_75895, "mem_75895") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_75893, "mem_75893") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66488;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75907, &ext_mem_75901, "ext_mem_75901") != 0)
                            return 1;
                        ext_75906 = ext_75900;
                        ext_75905 = ext_75899;
                        if (memblock_set_device(ctx, &ext_mem_75904, &ext_mem_75898, "ext_mem_75898") != 0)
                            return 1;
                        ext_75903 = ext_75897;
                        ext_75902 = ext_75896;
                        loopres_66427 = loopres_f_res_66432;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
                        return 1;
                    
                    bool loop_cond_66489 = slt64(loopres_66427, numIter_66379);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76610, &ext_mem_75907, "ext_mem_75907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76611, &ext_mem_75904, "ext_mem_75904") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76612 = ext_75906;
                    int64_t ctx_param_ext_tmp_76613 = ext_75905;
                    int64_t ctx_param_ext_tmp_76614 = ext_75903;
                    int64_t ctx_param_ext_tmp_76615 = ext_75902;
                    bool loop_while_tmp_76616 = loop_cond_66489;
                    int64_t p_tmp_76617 = loopres_66427;
                    
                    if (memblock_set_device(ctx, &mem_param_75754, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75757, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
                        return 1;
                    ctx_param_ext_75752 = ctx_param_ext_tmp_76612;
                    ctx_param_ext_75753 = ctx_param_ext_tmp_76613;
                    ctx_param_ext_75755 = ctx_param_ext_tmp_76614;
                    ctx_param_ext_75756 = ctx_param_ext_tmp_76615;
                    loop_while_66396 = loop_while_tmp_76616;
                    p_66397 = p_tmp_76617;
                }
                if (memblock_set_device(ctx, &ext_mem_75913, &mem_param_75754, "mem_param_75754") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75912, &mem_param_75757, "mem_param_75757") != 0)
                    return 1;
                ext_75911 = ctx_param_ext_75752;
                ext_75910 = ctx_param_ext_75753;
                ext_75909 = ctx_param_ext_75755;
                ext_75908 = ctx_param_ext_75756;
                defunc_0_find_joinTuples_res_66392 = loop_while_66396;
                defunc_0_find_joinTuples_res_66393 = p_66397;
                if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75913, "ext_mem_75913") != 0)
                    return 1;
                ext_75918 = ext_75911;
                ext_75917 = ext_75910;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75912, "ext_mem_75912") != 0)
                    return 1;
                ext_75915 = ext_75909;
                ext_75914 = ext_75908;
            } else {
                if (memblock_alloc_device(ctx, &mem_75486, bytes_75485, "mem_75486")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75486, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_57224) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75488, bytes_75485, "mem_75488")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75488, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_57224) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75490, (int64_t) 8, "mem_75490")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76691(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_75467.mem, mem_75490.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75490, "mem_75490") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75489, (int64_t) 8, "mem_75489")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_75489, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75489, "mem_75489") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75492, (int64_t) 1, "mem_75492")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_doublezigpuseq_76697(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75483.mem, ext_mem_75491.mem, mem_75492.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
                    return 1;
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75494, (int64_t) 8, "mem_75494")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76703(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_57224, y_64988, tR_mem_75467.mem, mem_75483.mem, mem_75492.mem, mem_75494.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75494, "mem_75494") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75493, (int64_t) 8, "mem_75493")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f64(ctx, mem_75493, (int64_t) 1, 0.0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75493, "mem_75493") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_65003;
                int64_t defunc_0_windowed_partitionFunc_res_65004;
                bool loop_while_65007;
                int64_t p_65008;
                
                loop_while_65007 = loop_cond_64985;
                p_65008 = (int64_t) 0;
                while (loop_while_65007) {
                    int64_t start_65011 = mul64(partitionsPerWindow_57230, p_65008);
                    int64_t end_65012 = add64(partitionsPerWindow_57230, start_65011);
                    int64_t max_res_65013 = smax64((int64_t) 1, start_65011);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014 = sub64(end_65012, max_res_65013);
                    bool bounds_invalid_upwards_65015 = slt64(end_65012, max_res_65013);
                    bool valid_65016 = !bounds_invalid_upwards_65015;
                    bool range_valid_c_65017;
                    
                    if (!valid_65016) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_65013, "..<", (long long) end_65012, " is invalid.", "-> #0  ftbasics.fut:153:43-68\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_65020 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 == (int64_t) 0;
                    bool nonzzero_65021 = !zzero_65020;
                    bool nonzzero_cert_65022;
                    
                    if (!nonzzero_65021) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:156:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_75503 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool cond_65223 = slt64((int64_t) 0, start_65011);
                    int64_t conc_tmp_65224 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    int64_t ret_65225;
                    
                    if (cond_65223) {
                        ret_65225 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    } else {
                        ret_65225 = conc_tmp_65224;
                    }
                    
                    bool eq_x_y_65233 = partitionsPerWindow_57230 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool eq_x_zz_65234 = partitionsPerWindow_57230 == conc_tmp_65224;
                    bool p_and_eq_x_y_65235 = cond_65223 && eq_x_y_65233;
                    bool not_p_65236 = !cond_65223;
                    bool p_and_eq_x_y_65237 = eq_x_zz_65234 && not_p_65236;
                    bool dim_match_65238 = p_and_eq_x_y_65235 || p_and_eq_x_y_65237;
                    bool empty_or_match_cert_65239;
                    
                    if (!dim_match_65238) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_65225, "] cannot match shape of type `[", (long long) partitionsPerWindow_57230, "](i64, i64)`.", "-> #0  ftbasics.fut:217:5-222:49\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_65241 = add64(m_64987, start_65011);
                    bool zzero_leq_i_p_m_t_s_65242 = sle64((int64_t) 0, i_p_m_t_s_65241);
                    bool i_p_m_t_s_leq_w_65243 = slt64(i_p_m_t_s_65241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool zzero_lte_i_65244 = sle64((int64_t) 0, start_65011);
                    bool i_lte_j_65245 = sle64(start_65011, end_65012);
                    bool y_65246 = i_p_m_t_s_leq_w_65243 && zzero_lte_i_65244;
                    bool y_65247 = zzero_leq_i_p_m_t_s_65242 && y_65246;
                    bool forwards_ok_65248 = i_lte_j_65245 && y_65247;
                    bool ok_or_empty_65249 = empty_slice_64986 || forwards_ok_65248;
                    bool index_certs_65250;
                    
                    if (!ok_or_empty_65249) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65011, ":", (long long) end_65012, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:108:37-74\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_65019 = add64(nR_57224, nR_57224);
                    int64_t segmap_usable_groups_72961 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_72960);
                    
                    if (memblock_alloc_device(ctx, &mem_75504, bytes_75503, "mem_75504")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_75506, bytes_75503, "mem_75506")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_76713 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_72960));
                    
                    {
                        err = gpu_kernel_inner_SMJ_doublezisegmap_72965(ctx, segmap_usable_groups_72961, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_72753, 1, 1, (int64_t) 0, nR_57224, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, max_res_65013, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, zt_rhs_65019, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75495.mem, mem_75504.mem, mem_75506.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_75508 = (int64_t) 8 * ret_65225;
                    
                    if (cond_65223) {
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75504, "mem_75504") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75506, "mem_75506") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75511, bytes_75508, "mem_75511")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_75511, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_75509, bytes_75508, "mem_75509")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_76734 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75504.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        
                        int64_t tmp_offs_76735 = (int64_t) 0;
                        
                        if (!(tmp_offs_76735 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_76735 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75506.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76735 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75509, "mem_75509") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75511, "mem_75511") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
                        return 1;
                    
                    int64_t tmp_65240 = add64((int64_t) 1, p_65008);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75486.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75488.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
                        return 1;
                    
                    bool loop_cond_65253 = slt64(tmp_65240, numberOfWindows_57231);
                    bool loop_while_tmp_76709 = loop_cond_65253;
                    int64_t p_tmp_76710 = tmp_65240;
                    
                    loop_while_65007 = loop_while_tmp_76709;
                    p_65008 = p_tmp_76710;
                }
                defunc_0_windowed_partitionFunc_res_65003 = loop_while_65007;
                defunc_0_windowed_partitionFunc_res_65004 = p_65008;
                if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_75522, bytes_75485, "mem_75522")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75524, bytes_75485, "mem_75524")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_76736 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_73334));
                
                {
                    err = gpu_kernel_inner_SMJ_doublezisegmap_73339(ctx, segmap_usable_groups_73335, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73170, 1, 1, (int64_t) 0, nR_57224, gt_rhs_64823, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zeze_rhs_65256, tR_mem_75467.mem, tS_mem_75468.mem, mem_75486.mem, mem_75488.mem, mem_75522.mem, mem_75524.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_75746;
                int64_t ext_75745;
                int64_t ext_75744;
                int64_t ext_75743;
                bool defunc_0_join_chunks_res_65412;
                int64_t defunc_0_join_chunks_res_65413;
                bool loop_while_65416;
                int64_t p_65417;
                int64_t ctx_param_ext_75525;
                int64_t ctx_param_ext_75526;
                int64_t ctx_param_ext_75528;
                int64_t ctx_param_ext_75529;
                
                if (memblock_set_device(ctx, &mem_param_75527, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75530, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75525 = (int64_t) 0;
                ctx_param_ext_75526 = (int64_t) 1;
                ctx_param_ext_75528 = (int64_t) 0;
                ctx_param_ext_75529 = (int64_t) 1;
                loop_while_65416 = loop_cond_65411;
                p_65417 = (int64_t) 0;
                while (loop_while_65416) {
                    bool x_65420 = sle64((int64_t) 0, p_65417);
                    bool y_65421 = slt64(p_65417, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65422 = x_65420 && y_65421;
                    bool index_certs_65423;
                    
                    if (!bounds_check_65422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:186:22-34\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_77368;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77368, mem_75522.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65424 = read_res_77368;
                    int64_t read_res_77369;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77369, mem_75524.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65425 = read_res_77369;
                    int64_t min_res_65426 = smin64(zeze_rhs_65256, loopres_65425);
                    bool cond_65427 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, loopres_65424);
                    bool cond_65431 = slt64(min_res_65426, (int64_t) 0);
                    bool protect_assert_disj_65433 = bounds_check_65422 || cond_65431;
                    bool protect_assert_disj_76139 = cond_65427 || protect_assert_disj_65433;
                    bool index_certs_65434;
                    
                    if (!protect_assert_disj_76139) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:190:19-32\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_65437 = add64((int64_t) 1, p_65417);
                    bool cond_65438 = zeze_lhs_65437 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    bool x_65440 = sle64((int64_t) 0, zeze_lhs_65437);
                    bool y_65441 = slt64(zeze_lhs_65437, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65442 = x_65440 && y_65441;
                    bool protect_assert_disj_65443 = cond_65438 || bounds_check_65442;
                    bool protect_assert_disj_65444 = cond_65431 || protect_assert_disj_65443;
                    bool protect_assert_disj_76142 = cond_65427 || protect_assert_disj_65444;
                    bool index_certs_65445;
                    
                    if (!protect_assert_disj_76142) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65437, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:191:49-64\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_76136 = !cond_65427;
                    bool x_65432 = !cond_65431;
                    bool protect_cond_conj_76140 = x_65432 && x_76136;
                    int64_t loopres_f_res_f_res_65435;
                    
                    if (protect_cond_conj_76140) {
                        int64_t read_res_77370;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77370, mem_75486.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66705 = read_res_77370;
                        
                        loopres_f_res_f_res_65435 = x_66705;
                    } else {
                        loopres_f_res_f_res_65435 = (int64_t) 0;
                    }
                    
                    bool x_65439 = !cond_65438;
                    bool protect_cond_conj_65446 = x_65432 && x_65439;
                    bool protect_cond_conj_76143 = protect_cond_conj_65446 && x_76136;
                    int64_t r_end_f_res_65447;
                    
                    if (protect_cond_conj_76143) {
                        int64_t read_res_77371;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77371, mem_75486.mem, zeze_lhs_65437 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66706 = read_res_77371;
                        
                        r_end_f_res_65447 = x_66706;
                    } else {
                        r_end_f_res_65447 = (int64_t) 0;
                    }
                    
                    int64_t r_end_65449;
                    
                    if (cond_65438) {
                        r_end_65449 = nR_57224;
                    } else {
                        r_end_65449 = r_end_f_res_65447;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 = sub64(r_end_65449, loopres_f_res_f_res_65435);
                    int64_t ext_75735;
                    
                    if (cond_65431) {
                        ext_75735 = ctx_param_ext_75525;
                    } else {
                        ext_75735 = (int64_t) 0;
                    }
                    
                    int64_t ext_75734;
                    
                    if (cond_65431) {
                        ext_75734 = ctx_param_ext_75526;
                    } else {
                        ext_75734 = (int64_t) 1;
                    }
                    
                    int64_t ext_75732;
                    
                    if (cond_65431) {
                        ext_75732 = ctx_param_ext_75528;
                    } else {
                        ext_75732 = (int64_t) 0;
                    }
                    
                    int64_t ext_75731;
                    
                    if (cond_65431) {
                        ext_75731 = ctx_param_ext_75529;
                    } else {
                        ext_75731 = (int64_t) 1;
                    }
                    
                    int64_t bytes_75531 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;
                    int64_t ext_75741;
                    
                    if (cond_65427) {
                        ext_75741 = ctx_param_ext_75525;
                    } else {
                        ext_75741 = ext_75735;
                    }
                    
                    int64_t ext_75740;
                    
                    if (cond_65427) {
                        ext_75740 = ctx_param_ext_75526;
                    } else {
                        ext_75740 = ext_75734;
                    }
                    
                    int64_t ext_75738;
                    
                    if (cond_65427) {
                        ext_75738 = ctx_param_ext_75528;
                    } else {
                        ext_75738 = ext_75732;
                    }
                    
                    int64_t ext_75737;
                    
                    if (cond_65427) {
                        ext_75737 = ctx_param_ext_75529;
                    } else {
                        ext_75737 = ext_75731;
                    }
                    
                    int64_t loopres_65428;
                    
                    if (cond_65427) {
                        loopres_65428 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    } else {
                        loopres_65428 = zeze_lhs_65437;
                    }
                    if (cond_65427) {
                        if (memblock_set_device(ctx, &ext_mem_75742, &mem_param_75527, "mem_param_75527") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &mem_param_75530, "mem_param_75530") != 0)
                            return 1;
                    } else {
                        if (cond_65431) {
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_param_75527, "mem_param_75527") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_param_75530, "mem_param_75530") != 0)
                                return 1;
                        } else {
                            bool empty_slice_65453 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 == (int64_t) 0;
                            int64_t m_65454 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 1);
                            int64_t i_p_m_t_s_65455 = add64(loopres_f_res_f_res_65435, m_65454);
                            bool zzero_leq_i_p_m_t_s_65456 = sle64((int64_t) 0, i_p_m_t_s_65455);
                            bool i_p_m_t_s_leq_w_65457 = slt64(i_p_m_t_s_65455, nR_57224);
                            bool zzero_lte_i_65458 = sle64((int64_t) 0, loopres_f_res_f_res_65435);
                            bool i_lte_j_65459 = sle64(loopres_f_res_f_res_65435, r_end_65449);
                            bool y_65460 = i_p_m_t_s_leq_w_65457 && zzero_lte_i_65458;
                            bool y_65461 = zzero_leq_i_p_m_t_s_65456 && y_65460;
                            bool forwards_ok_65462 = i_lte_j_65459 && y_65461;
                            bool ok_or_empty_65463 = empty_slice_65453 || forwards_ok_65462;
                            bool index_certs_65464;
                            
                            if (!ok_or_empty_65463) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_65435, ":", (long long) r_end_65449, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftSMJ.fut:192:16-33\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_65467 = sle64(loopres_65424, min_res_65426);
                            bool loop_not_taken_65472 = !loop_cond_65467;
                            bool protect_assert_disj_65473 = loop_not_taken_65472 || nonzzero_66377;
                            bool nonzzero_cert_65474;
                            
                            if (!protect_assert_disj_65473) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75532, bytes_75531, "mem_75532")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75532, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75534, bytes_75531, "mem_75534")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75534, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_65468 = add64(extParallelism_57232, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                            int64_t zs_lhs_65469 = sub64(zm_lhs_65468, (int64_t) 1);
                            int64_t numIter_65475 = sdiv_safe64(zs_lhs_65469, extParallelism_57232);
                            bool loop_cond_65476 = slt64((int64_t) 0, numIter_65475);
                            bool loop_not_taken_65477 = !loop_cond_65476;
                            int64_t segmap_tblock_sizze_73687;
                            
                            segmap_tblock_sizze_73687 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73677;
                            
                            int64_t segmap_usable_groups_73688 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73687);
                            int64_t segmap_tblock_sizze_73708;
                            
                            segmap_tblock_sizze_73708 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73699;
                            
                            int64_t segmap_usable_groups_73709 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73708);
                            
                            if (memblock_alloc_device(ctx, &mem_75553, (int64_t) 8, "mem_75553")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75554, (int64_t) 8, "mem_75554")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75557, (int64_t) 1, "mem_75557")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_65478;
                            int64_t loopres_f_res_f_res_65479;
                            bool loop_while_65482;
                            int64_t dp_65483;
                            
                            if (memblock_set_device(ctx, &mem_param_75537, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_75540, &mem_75532, "mem_75532") != 0)
                                return 1;
                            loop_while_65482 = loop_cond_65467;
                            dp_65483 = loopres_65424;
                            while (loop_while_65482) {
                                bool x_65486 = sle64((int64_t) 0, dp_65483);
                                bool y_65487 = slt64(dp_65483, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65488 = x_65486 && y_65487;
                                bool index_certs_65489;
                                
                                if (!bounds_check_65488) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_65483, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:196:21-38\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_77372;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_77372, mem_75488.mem, dp_65483 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_65490 = read_res_77372;
                                int64_t zeze_lhs_65491 = add64((int64_t) 1, dp_65483);
                                bool cond_65492 = zeze_lhs_65491 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                                bool x_65493 = !cond_65492;
                                bool x_65494 = sle64((int64_t) 0, zeze_lhs_65491);
                                bool y_65495 = slt64(zeze_lhs_65491, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65496 = x_65494 && y_65495;
                                bool protect_assert_disj_65497 = cond_65492 || bounds_check_65496;
                                bool index_certs_65498;
                                
                                if (!protect_assert_disj_65497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65491, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:197:55-74\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_65499;
                                
                                if (x_65493) {
                                    int64_t read_res_77373;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77373, mem_75488.mem, zeze_lhs_65491 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_66707 = read_res_77373;
                                    
                                    s_end_f_res_65499 = x_66707;
                                } else {
                                    s_end_f_res_65499 = (int64_t) 0;
                                }
                                
                                int64_t s_end_65501;
                                
                                if (cond_65492) {
                                    s_end_65501 = nR_57224;
                                } else {
                                    s_end_65501 = s_end_f_res_65499;
                                }
                                
                                int64_t j_m_i_65502 = sub64(s_end_65501, loopres_65490);
                                bool empty_slice_65503 = j_m_i_65502 == (int64_t) 0;
                                int64_t m_65504 = sub64(j_m_i_65502, (int64_t) 1);
                                int64_t i_p_m_t_s_65505 = add64(loopres_65490, m_65504);
                                bool zzero_leq_i_p_m_t_s_65506 = sle64((int64_t) 0, i_p_m_t_s_65505);
                                bool i_p_m_t_s_leq_w_65507 = slt64(i_p_m_t_s_65505, nR_57224);
                                bool zzero_lte_i_65508 = sle64((int64_t) 0, loopres_65490);
                                bool i_lte_j_65509 = sle64(loopres_65490, s_end_65501);
                                bool y_65510 = i_p_m_t_s_leq_w_65507 && zzero_lte_i_65508;
                                bool y_65511 = zzero_leq_i_p_m_t_s_65506 && y_65510;
                                bool forwards_ok_65512 = i_lte_j_65509 && y_65511;
                                bool ok_or_empty_65513 = empty_slice_65503 || forwards_ok_65512;
                                bool index_certs_65514;
                                
                                if (!ok_or_empty_65513) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65490, ":", (long long) s_end_65501, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  ftSMJ.fut:198:18-35\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_65517 = slt64((int64_t) 0, j_m_i_65502);
                                bool loop_not_taken_65518 = !cond_65517;
                                bool x_65519 = sle64((int64_t) 0, m_65504);
                                bool y_65520 = slt64(m_65504, j_m_i_65502);
                                bool bounds_check_65524 = x_65519 && y_65520;
                                bool protect_assert_disj_65525 = loop_not_taken_65518 || bounds_check_65524;
                                bool protect_assert_disj_65526 = loop_not_taken_65477 || protect_assert_disj_65525;
                                bool index_certs_65527;
                                
                                if (!protect_assert_disj_65526) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65504, "] out of bounds for array of shape [", (long long) j_m_i_65502, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_65911 = tS_start_64840 + loopres_65490;
                                int64_t find_joinTuples_arg3_65516 = add64(join_chunks_arg3_64981, loopres_65490);
                                bool protect_cond_conj_65521 = loop_cond_65476 && cond_65517;
                                
                                if (protect_cond_conj_65521) {
                                    if (memblock_alloc_device(ctx, &mem_75542, (int64_t) 8, "mem_75542")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76765(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65911, tS_mem_75468.mem, mem_75542.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75542, "mem_75542") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75541, (int64_t) 8, "mem_75541")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f64(ctx, mem_75541, (int64_t) 1, 0.0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75541, "mem_75541") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_65521) {
                                    int64_t slice_66709 = tS_start_64840 + i_p_m_t_s_65505;
                                    
                                    if (memblock_alloc_device(ctx, &mem_75545, (int64_t) 8, "mem_75545")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76771(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_66709, tS_mem_75468.mem, mem_75545.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75545, "mem_75545") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75544, (int64_t) 8, "mem_75544")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f64(ctx, mem_75544, (int64_t) 1, 0.0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75544, "mem_75544") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_75559 = (int64_t) 8 * j_m_i_65502;
                                int64_t ext_75706;
                                int64_t ext_75705;
                                int64_t ext_75704;
                                int64_t ext_75703;
                                bool defunc_0_find_joinTuples_res_65530;
                                int64_t defunc_0_find_joinTuples_res_65531;
                                bool loop_while_65534;
                                int64_t p_65535;
                                int64_t ctx_param_ext_75547;
                                int64_t ctx_param_ext_75548;
                                int64_t ctx_param_ext_75550;
                                int64_t ctx_param_ext_75551;
                                
                                if (memblock_set_device(ctx, &mem_param_75549, &mem_75534, "mem_75534") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75552, &mem_75532, "mem_75532") != 0)
                                    return 1;
                                ctx_param_ext_75547 = (int64_t) 0;
                                ctx_param_ext_75548 = (int64_t) 1;
                                ctx_param_ext_75550 = (int64_t) 0;
                                ctx_param_ext_75551 = (int64_t) 1;
                                loop_while_65534 = loop_cond_65476;
                                p_65535 = (int64_t) 0;
                                while (loop_while_65534) {
                                    int64_t start_65538 = mul64(extParallelism_57232, p_65535);
                                    int64_t min_arg1_65539 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, start_65538);
                                    int64_t min_res_65540 = smin64(extParallelism_57232, min_arg1_65539);
                                    int64_t iter_R_65541 = add64(start_65538, min_res_65540);
                                    bool empty_slice_65542 = min_res_65540 == (int64_t) 0;
                                    int64_t m_65543 = sub64(min_res_65540, (int64_t) 1);
                                    int64_t i_p_m_t_s_65544 = add64(start_65538, m_65543);
                                    bool zzero_leq_i_p_m_t_s_65545 = sle64((int64_t) 0, i_p_m_t_s_65544);
                                    bool i_p_m_t_s_leq_w_65546 = slt64(i_p_m_t_s_65544, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                                    bool zzero_lte_i_65547 = sle64((int64_t) 0, start_65538);
                                    bool i_lte_j_65548 = sle64(start_65538, iter_R_65541);
                                    bool y_65549 = i_p_m_t_s_leq_w_65546 && zzero_lte_i_65547;
                                    bool y_65550 = zzero_leq_i_p_m_t_s_65545 && y_65549;
                                    bool forwards_ok_65551 = i_lte_j_65548 && y_65550;
                                    bool ok_or_empty_65552 = empty_slice_65542 || forwards_ok_65551;
                                    bool index_certs_65553;
                                    
                                    if (!ok_or_empty_65552) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65538, ":", (long long) iter_R_65541, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65560 = slt64(m_65543, min_res_65540);
                                    bool x_65559 = sle64((int64_t) 0, m_65543);
                                    bool bounds_check_65561 = x_65559 && y_65560;
                                    bool index_certs_65562;
                                    
                                    if (!bounds_check_65561) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65543, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65556 = slt64((int64_t) 0, min_res_65540);
                                    bool index_certs_65557;
                                    
                                    if (!y_65556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:402:133-136\n   #2  ftSMJ.fut:391:1-402:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_65554 = loopres_f_res_f_res_65435 + start_65538;
                                    int64_t slice_65563 = loopres_f_res_f_res_65435 + i_p_m_t_s_65544;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76787(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65554, slice_65563, tR_mem_75467.mem, mem_75553.mem, mem_75554.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75555, &ext_mem_75546, "ext_mem_75546") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75555, &mem_75553, "mem_75553") != 0)
                                        return 1;
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75556, &ext_mem_75543, "ext_mem_75543") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75556, &mem_75554, "mem_75554") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_doublezigpuseq_76793(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75554.mem, ext_mem_75555.mem, mem_75557.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
                                        return 1;
                                    
                                    bool read_res_77374;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77374, mem_75557.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_65567 = read_res_77374;
                                    int64_t ext_75701;
                                    int64_t ext_75700;
                                    int64_t ext_75698;
                                    int64_t ext_75697;
                                    int64_t loopres_65568;
                                    
                                    if (defunc_0_gt_res_65567) {
                                        if (memblock_set_device(ctx, &ext_mem_75702, &mem_param_75549, "mem_param_75549") != 0)
                                            return 1;
                                        ext_75701 = ctx_param_ext_75547;
                                        ext_75700 = ctx_param_ext_75548;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &mem_param_75552, "mem_param_75552") != 0)
                                            return 1;
                                        ext_75698 = ctx_param_ext_75550;
                                        ext_75697 = ctx_param_ext_75551;
                                        loopres_65568 = numIter_65475;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_75558, (int64_t) 1, "mem_75558")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_doublezigpuseq_76799(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75553.mem, ext_mem_75556.mem, mem_75558.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_77375;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_77375, mem_75558.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_65571 = read_res_77375;
                                        
                                        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
                                            return 1;
                                        
                                        int64_t ext_75695;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75695 = ctx_param_ext_75547;
                                        } else {
                                            ext_75695 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75694;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75694 = ctx_param_ext_75548;
                                        } else {
                                            ext_75694 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_75692;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75692 = ctx_param_ext_75550;
                                        } else {
                                            ext_75692 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75691;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75691 = ctx_param_ext_75551;
                                        } else {
                                            ext_75691 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_65572;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            int64_t tmp_66713 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_param_75549, "mem_param_75549") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_param_75552, "mem_param_75552") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_66713;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_75560, bytes_75559, "mem_75560")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75560.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, slice_65911, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65502})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_7898(ctx, &ext_mem_75562, mem_75560, j_m_i_65502, find_joinTuples_arg3_65516) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_73499;
                                            
                                            suff_outer_par_73499 = *ctx->tuning_params.inner_SMJ_doublezisuff_outer_par_1 <= min_res_65540;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_double.suff_outer_par_1", (long) min_res_65540, suff_outer_par_73499 ? "true" : "false");
                                            
                                            int64_t tile_sizze_74966;
                                            
                                            tile_sizze_74966 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965;
                                            
                                            int64_t tile_sizze_74611;
                                            
                                            tile_sizze_74611 = *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610;
                                            
                                            int64_t num_whole_tiles_74982 = squot_safe64(j_m_i_65502, tile_sizze_74966);
                                            int64_t residual_input_75206 = srem_safe64(j_m_i_65502, tile_sizze_74966);
                                            bool cond_75207 = residual_input_75206 == (int64_t) 0;
                                            int64_t binop_x_75223 = tile_sizze_74966 * num_whole_tiles_74982;
                                            int64_t bytes_75620 = (int64_t) 8 * min_res_65540;
                                            int64_t bytes_75583 = (int64_t) 8 * tile_sizze_74966;
                                            int64_t num_whole_tiles_74627 = squot_safe64(j_m_i_65502, tile_sizze_74611);
                                            int64_t residual_input_74851 = srem_safe64(j_m_i_65502, tile_sizze_74611);
                                            bool cond_74852 = residual_input_74851 == (int64_t) 0;
                                            int64_t binop_x_74868 = tile_sizze_74611 * num_whole_tiles_74627;
                                            int64_t bytes_75644 = (int64_t) 8 * tile_sizze_74611;
                                            int64_t shared_memory_capacity_76857;
                                            
                                            shared_memory_capacity_76857 = ctx->max_shared_memory;
                                            if (suff_outer_par_73499 && sle64(sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76857)) {
                                                int64_t ldim_74612 = sdiv_up64(min_res_65540, tile_sizze_74611);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75682, bytes_75620, "mem_75682")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75684, bytes_75620, "mem_75684")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76805 = sext_i64_i32(sdiv_up64(tile_sizze_74611, tile_sizze_74611));
                                                int32_t virt_num_tblocks_76806 = sext_i64_i32(ldim_74612);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74609(ctx, ldim_74612, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74610, 1, 1, bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74612, num_whole_tiles_74627, residual_input_74851, cond_74852, binop_x_74868, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75682.mem, mem_75684.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75682, "mem_75682") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75684, "mem_75684") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_74967 = sdiv_up64(min_res_65540, tile_sizze_74966);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75621, bytes_75620, "mem_75621")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75623, bytes_75620, "mem_75623")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76831 = sext_i64_i32(sdiv_up64(tile_sizze_74966, tile_sizze_74966));
                                                int32_t virt_num_tblocks_76832 = sext_i64_i32(ldim_74967);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_doublezisegmap_intrablock_74964(ctx, ldim_74967, 1, 1, *ctx->tuning_params.inner_SMJ_doublezitile_sizze_74965, 1, 1, bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74967, num_whole_tiles_74982, residual_input_75206, cond_75207, binop_x_75223, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75621.mem, mem_75623.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75621, "mem_75621") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75623, "mem_75623") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75688, bytes_75531, "mem_75688")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75552.mem, ctx_param_ext_75550, (int64_t []) {ctx_param_ext_75551}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75686.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75690, bytes_75531, "mem_75690")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75549.mem, ctx_param_ext_75547, (int64_t []) {ctx_param_ext_75548}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
                                                return 1;
                                            
                                            int64_t tmp_65619 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_75690, "mem_75690") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_75688, "mem_75688") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_65619;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_75702, &ext_mem_75696, "ext_mem_75696") != 0)
                                            return 1;
                                        ext_75701 = ext_75695;
                                        ext_75700 = ext_75694;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &ext_mem_75693, "ext_mem_75693") != 0)
                                            return 1;
                                        ext_75698 = ext_75692;
                                        ext_75697 = ext_75691;
                                        loopres_65568 = loopres_f_res_65572;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
                                        return 1;
                                    
                                    bool loop_cond_65620 = slt64(loopres_65568, numIter_65475);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_76777, &ext_mem_75702, "ext_mem_75702") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_76778, &ext_mem_75699, "ext_mem_75699") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_76779 = ext_75701;
                                    int64_t ctx_param_ext_tmp_76780 = ext_75700;
                                    int64_t ctx_param_ext_tmp_76781 = ext_75698;
                                    int64_t ctx_param_ext_tmp_76782 = ext_75697;
                                    bool loop_while_tmp_76783 = loop_cond_65620;
                                    int64_t p_tmp_76784 = loopres_65568;
                                    
                                    if (memblock_set_device(ctx, &mem_param_75549, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_75552, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
                                        return 1;
                                    ctx_param_ext_75547 = ctx_param_ext_tmp_76779;
                                    ctx_param_ext_75548 = ctx_param_ext_tmp_76780;
                                    ctx_param_ext_75550 = ctx_param_ext_tmp_76781;
                                    ctx_param_ext_75551 = ctx_param_ext_tmp_76782;
                                    loop_while_65534 = loop_while_tmp_76783;
                                    p_65535 = p_tmp_76784;
                                }
                                if (memblock_set_device(ctx, &ext_mem_75708, &mem_param_75549, "mem_param_75549") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75707, &mem_param_75552, "mem_param_75552") != 0)
                                    return 1;
                                ext_75706 = ctx_param_ext_75547;
                                ext_75705 = ctx_param_ext_75548;
                                ext_75704 = ctx_param_ext_75550;
                                ext_75703 = ctx_param_ext_75551;
                                defunc_0_find_joinTuples_res_65530 = loop_while_65534;
                                defunc_0_find_joinTuples_res_65531 = p_65535;
                                if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75711, bytes_75531, "mem_75711")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76858 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73687));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_73691(ctx, segmap_usable_groups_73688, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73677, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75703, ext_75704, mem_param_75540.mem, ext_mem_75707.mem, mem_75711.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75714, bytes_75531, "mem_75714")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76867 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73708));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_doublezisegmap_73712(ctx, segmap_usable_groups_73709, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73699, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75705, ext_75706, mem_param_75537.mem, ext_mem_75708.mem, mem_75714.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
                                    return 1;
                                
                                bool loop_cond_65630 = sle64(zeze_lhs_65491, min_res_65426);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_76759, &mem_75714, "mem_75714") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_76760, &mem_75711, "mem_75711") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_76761 = loop_cond_65630;
                                int64_t dp_tmp_76762 = zeze_lhs_65491;
                                
                                if (memblock_set_device(ctx, &mem_param_75537, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75540, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
                                    return 1;
                                loop_while_65482 = loop_while_tmp_76761;
                                dp_65483 = dp_tmp_76762;
                            }
                            if (memblock_set_device(ctx, &ext_mem_75720, &mem_param_75537, "mem_param_75537") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75719, &mem_param_75540, "mem_param_75540") != 0)
                                return 1;
                            loopres_f_res_f_res_65478 = loop_while_65482;
                            loopres_f_res_f_res_65479 = dp_65483;
                            if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_73729;
                            
                            segmap_tblock_sizze_73729 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73719;
                            
                            int64_t segmap_usable_groups_73730 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73729);
                            
                            if (memblock_alloc_device(ctx, &mem_75723, bytes_75531, "mem_75723")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76876 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73729));
                            
                            {
                                err = gpu_kernel_inner_SMJ_doublezisegmap_73733(ctx, segmap_usable_groups_73730, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73719, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75528, ctx_param_ext_75529, mem_param_75530.mem, ext_mem_75719.mem, mem_75723.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_73750;
                            
                            segmap_tblock_sizze_73750 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73741;
                            
                            int64_t segmap_usable_groups_73751 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73750);
                            
                            if (memblock_alloc_device(ctx, &mem_75726, bytes_75531, "mem_75726")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76885 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_73750));
                            
                            {
                                err = gpu_kernel_inner_SMJ_doublezisegmap_73754(ctx, segmap_usable_groups_73751, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73741, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75525, ctx_param_ext_75526, mem_param_75527.mem, ext_mem_75720.mem, mem_75726.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75728, bytes_75470, "mem_75728")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75530.mem, ctx_param_ext_75528, (int64_t []) {ctx_param_ext_75529}, (int64_t []) {nR_57224})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75723.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75730, bytes_75470, "mem_75730")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75527.mem, ctx_param_ext_75525, (int64_t []) {ctx_param_ext_75526}, (int64_t []) {nR_57224})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_75730, "mem_75730") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_75728, "mem_75728") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75742, &ext_mem_75736, "ext_mem_75736") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &ext_mem_75733, "ext_mem_75733") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_65646 = slt64(loopres_65428, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76749, &ext_mem_75742, "ext_mem_75742") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76750, &ext_mem_75739, "ext_mem_75739") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76751 = ext_75741;
                    int64_t ctx_param_ext_tmp_76752 = ext_75740;
                    int64_t ctx_param_ext_tmp_76753 = ext_75738;
                    int64_t ctx_param_ext_tmp_76754 = ext_75737;
                    bool loop_while_tmp_76755 = loop_cond_65646;
                    int64_t p_tmp_76756 = loopres_65428;
                    
                    if (memblock_set_device(ctx, &mem_param_75527, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75530, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
                        return 1;
                    ctx_param_ext_75525 = ctx_param_ext_tmp_76751;
                    ctx_param_ext_75526 = ctx_param_ext_tmp_76752;
                    ctx_param_ext_75528 = ctx_param_ext_tmp_76753;
                    ctx_param_ext_75529 = ctx_param_ext_tmp_76754;
                    loop_while_65416 = loop_while_tmp_76755;
                    p_65417 = p_tmp_76756;
                }
                if (memblock_set_device(ctx, &ext_mem_75748, &mem_param_75527, "mem_param_75527") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75747, &mem_param_75530, "mem_param_75530") != 0)
                    return 1;
                ext_75746 = ctx_param_ext_75525;
                ext_75745 = ctx_param_ext_75526;
                ext_75744 = ctx_param_ext_75528;
                ext_75743 = ctx_param_ext_75529;
                defunc_0_join_chunks_res_65412 = loop_while_65416;
                defunc_0_join_chunks_res_65413 = p_65417;
                if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75748, "ext_mem_75748") != 0)
                    return 1;
                ext_75918 = ext_75746;
                ext_75917 = ext_75745;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75747, "ext_mem_75747") != 0)
                    return 1;
                ext_75915 = ext_75744;
                ext_75914 = ext_75743;
            }
            
            int64_t segmap_tblock_sizze_73771;
            
            segmap_tblock_sizze_73771 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73761;
            
            int64_t segmap_usable_groups_73772 = sdiv_up64(nR_57224, segmap_tblock_sizze_73771);
            
            if (memblock_alloc_device(ctx, &mem_75922, bytes_75470, "mem_75922")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76894 = sext_i64_i32(sdiv_up64(nR_57224, segmap_tblock_sizze_73771));
            
            {
                err = gpu_kernel_inner_SMJ_doublezisegmap_73775(ctx, segmap_usable_groups_73772, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73761, 1, 1, (int64_t) 0, nR_57224, ext_75914, ext_75915, mem_param_75482.mem, ext_mem_75916.mem, mem_75922.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_73792;
            
            segmap_tblock_sizze_73792 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73783;
            
            int64_t segmap_usable_groups_73793 = sdiv_up64(nR_57224, segmap_tblock_sizze_73792);
            
            if (memblock_alloc_device(ctx, &mem_75925, bytes_75470, "mem_75925")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76903 = sext_i64_i32(sdiv_up64(nR_57224, segmap_tblock_sizze_73792));
            
            {
                err = gpu_kernel_inner_SMJ_doublezisegmap_73796(ctx, segmap_usable_groups_73793, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73783, 1, 1, (int64_t) 0, nR_57224, ext_75917, ext_75918, mem_param_75479.mem, ext_mem_75919.mem, mem_75925.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_75926, (int64_t) 1, "mem_75926")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_doublezigpuseq_76912(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, i_p_m_t_s_64846, tR_mem_75467.mem, tS_mem_75468.mem, mem_75926.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_77376;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_77376, mem_75926.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_65663 = read_res_77376;
            
            if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
                return 1;
            
            int64_t nextIter_65664;
            
            if (defunc_0_leq_res_65663) {
                int64_t nextIter_t_res_66728 = add64((int64_t) 1, p_64837);
                
                nextIter_65664 = nextIter_t_res_66728;
            } else {
                nextIter_65664 = numIter_64817;
            }
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_75925, "mem_75925") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_75922, "mem_75922") != 0)
                return 1;
            loopres_64861 = nextIter_65664;
        }
        
        bool loop_cond_65666 = slt64(loopres_64861, numIter_64817);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76592, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76593, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        
        bool loop_while_tmp_76594 = loop_cond_65666;
        int64_t p_tmp_76595 = loopres_64861;
        
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75482, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        loop_while_64836 = loop_while_tmp_76594;
        p_64837 = p_tmp_76595;
    }
    if (memblock_set_device(ctx, &ext_mem_75938, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75937, &mem_param_75482, "mem_param_75482") != 0)
        return 1;
    defunc_0_mergeJoin_res_64832 = loop_while_64836;
    defunc_0_mergeJoin_res_64833 = p_64837;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_73802;
    
    segscan_tblock_sizze_73802 = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73801;
    
    int64_t num_tblocks_73804;
    int64_t max_num_tblocks_76918;
    
    max_num_tblocks_76918 = *ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_73803;
    num_tblocks_73804 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_57224, segscan_tblock_sizze_73802), max_num_tblocks_76918)));
    if (memblock_alloc_device(ctx, &mem_75941, bytes_75470, "mem_75941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75943, bytes_75470, "mem_75943")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_57224)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_76919;
        
        shared_memory_76919 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_76920;
        
        thread_block_sizze_76920 = ctx->max_thread_block_size;
        
        int64_t registers_76921;
        
        registers_76921 = ctx->max_registers;
        
        int64_t thread_block_sizze_76922;
        
        thread_block_sizze_76922 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_76923 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_76919, thread_block_sizze_76920), (int64_t) 8), squot64(squot64(registers_76921, thread_block_sizze_76922) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_76924 = sdiv_up64(nR_57224, segscan_tblock_sizze_73802 * chunk_sizze_76923);
        int64_t num_virt_threads_76925 = num_virt_blocks_76924 * segscan_tblock_sizze_73802;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_76923, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_76926, num_virt_blocks_76924, "status_flags_mem_76926")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_76926, num_virt_blocks_76924, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_76948, (int64_t) 8 * num_virt_blocks_76924, "aggregates_mem_76948")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_76950, (int64_t) 8 * num_virt_blocks_76924, "incprefixes_mem_76950")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezisegscan_73807(ctx, num_tblocks_73804, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73801, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73802), chunk_sizze_76923 * segscan_tblock_sizze_73802 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_73802), chunk_sizze_76923 * segscan_tblock_sizze_73802 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_57224, num_tblocks_73804, num_virt_blocks_76924, num_virt_threads_76925, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, status_flags_mem_76926.mem, aggregates_mem_76948.mem, incprefixes_mem_76950.mem, global_dynid_mem_76952.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_65682 = zzero_64814 || bounds_check_64826;
    bool index_certs_65683;
    
    if (!protect_assert_disj_65682) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65684;
    
    if (nonzzero_64815) {
        int64_t read_res_77377;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77377, mem_75941.mem, gt_rhs_64823 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66731 = read_res_77377;
        
        m_f_res_65684 = x_66731;
    } else {
        m_f_res_65684 = (int64_t) 0;
    }
    
    int64_t m_65686;
    
    if (zzero_64814) {
        m_65686 = (int64_t) 0;
    } else {
        m_65686 = m_f_res_65684;
    }
    
    int64_t m_65696 = sub64(m_65686, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65698 = slt64(m_65696, nR_57224);
    bool zzero_leq_i_p_m_t_s_65697 = sle64((int64_t) 0, m_65696);
    bool y_65700 = zzero_leq_i_p_m_t_s_65697 && i_p_m_t_s_leq_w_65698;
    bool i_lte_j_65699 = sle64((int64_t) 0, m_65686);
    bool forwards_ok_65701 = i_lte_j_65699 && y_65700;
    bool eq_x_zz_65693 = (int64_t) 0 == m_f_res_65684;
    bool p_and_eq_x_y_65694 = nonzzero_64815 && eq_x_zz_65693;
    bool empty_slice_65695 = zzero_64814 || p_and_eq_x_y_65694;
    bool ok_or_empty_65702 = empty_slice_65695 || forwards_ok_65701;
    bool index_certs_65703;
    
    if (!ok_or_empty_65702) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65686, "] out of bounds for array of shape [", (long long) nR_57224, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75944 = (int64_t) 8 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75945, bytes_75944, "mem_75945")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75947, bytes_75944, "mem_75947")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75949, bytes_75944, "mem_75949")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75469.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75951, bytes_75944, "mem_75951")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_75467.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_73812;
    
    segmap_tblock_sizze_73812 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73811;
    
    int64_t num_tblocks_73814;
    int64_t max_num_tblocks_77061;
    
    max_num_tblocks_77061 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73813;
    num_tblocks_73814 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_57224, segmap_tblock_sizze_73812), max_num_tblocks_77061)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77062 = sext_i64_i32(sdiv_up64(nR_57224, segmap_tblock_sizze_73812));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_73809(ctx, num_tblocks_73814, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73811, 1, 1, (int64_t) 0, nR_57224, m_65686, num_tblocks_73814, virt_num_tblocks_77062, tR_mem_75467.mem, ext_mem_75469.mem, ext_mem_75937.mem, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, mem_75945.mem, mem_75947.mem, mem_75949.mem, mem_75951.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_73818;
    
    segscan_tblock_sizze_73818 = *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73817;
    
    int64_t num_tblocks_73820;
    int64_t max_num_tblocks_77075;
    
    max_num_tblocks_77075 = *ctx->tuning_params.inner_SMJ_doublezisegscan_num_tblocks_73819;
    num_tblocks_73820 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segscan_tblock_sizze_73818), max_num_tblocks_77075)));
    if (memblock_alloc_device(ctx, &mem_75955, bytes_75944, "mem_75955")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75957, bytes_75944, "mem_75957")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75959, bytes_75944, "mem_75959")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_65686)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_77076;
        
        shared_memory_77076 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_77077;
        
        thread_block_sizze_77077 = ctx->max_thread_block_size;
        
        int64_t registers_77078;
        
        registers_77078 = ctx->max_registers;
        
        int64_t thread_block_sizze_77079;
        
        thread_block_sizze_77079 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_77080 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_77076, thread_block_sizze_77077), (int64_t) 8), squot64(squot64(registers_77078, thread_block_sizze_77079) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_77081 = sdiv_up64(m_65686, segscan_tblock_sizze_73818 * chunk_sizze_77080);
        int64_t num_virt_threads_77082 = num_virt_blocks_77081 * segscan_tblock_sizze_73818;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_77080, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_77083, num_virt_blocks_77081, "status_flags_mem_77083")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_77083, num_virt_blocks_77081, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77085, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77085")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77087, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77087")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77089, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77089")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77091, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77091")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezisegscan_73823(ctx, num_tblocks_73820, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegscan_tblock_sizze_73817, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73818, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73818), smax64(chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_73818, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_73818), smax64(chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_73818 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_65686, num_tblocks_73820, num_virt_blocks_77081, num_virt_threads_77082, mem_75945.mem, mem_75955.mem, mem_75957.mem, mem_75959.mem, status_flags_mem_77083.mem, aggregates_mem_77085.mem, incprefixes_mem_77087.mem, aggregates_mem_77089.mem, incprefixes_mem_77091.mem, global_dynid_mem_77093.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_73839;
    
    segmap_tblock_sizze_73839 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73827;
    
    int64_t segmap_usable_groups_73840 = sdiv_up64(m_65686, segmap_tblock_sizze_73839);
    
    if (memblock_alloc_device(ctx, &mem_75962, bytes_75944, "mem_75962")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77228 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_73839));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_73843(ctx, segmap_usable_groups_73840, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73827, 1, 1, (int64_t) 0, m_65686, mem_75955.mem, mem_75962.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
        return 1;
    
    bool cond_65737 = slt64((int64_t) 0, m_65686);
    bool y_65738 = slt64(m_65696, m_65686);
    bool bounds_check_65739 = zzero_leq_i_p_m_t_s_65697 && y_65738;
    bool loop_not_taken_65740 = !cond_65737;
    bool protect_assert_disj_65741 = bounds_check_65739 || loop_not_taken_65740;
    bool index_certs_65742;
    
    if (!protect_assert_disj_65741) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  ftSMJ.fut:284:10-41\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75964, (int64_t) 8, "mem_75964")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_77237(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75962.mem, mem_75964.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75964, "mem_75964") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75963, (int64_t) 8, "mem_75963")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75963, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75963, "mem_75963") != 0)
            return 1;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75967, (int64_t) 8, "mem_75967")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_77243(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75945.mem, mem_75967.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75967, "mem_75967") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75966, (int64_t) 8, "mem_75966")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75966, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75966, "mem_75966") != 0)
            return 1;
    }
    
    bool zzero_65754 = scatter_psizze_57233 == (int64_t) 0;
    bool nonzzero_65755 = !zzero_65754;
    bool nonzzero_cert_65756;
    
    if (!nonzzero_65755) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_65821 = !empty_slice_65695;
    bool protect_assert_disj_65822 = empty_slice_65695 || bounds_check_65739;
    bool index_certs_65823;
    
    if (!protect_assert_disj_65822) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65824;
    
    if (x_65821) {
        int64_t read_res_77378;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77378, mem_75957.mem, m_65696 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66739 = read_res_77378;
        
        m_f_res_65824 = x_66739;
    } else {
        m_f_res_65824 = (int64_t) 0;
    }
    
    int64_t m_65826;
    
    if (empty_slice_65695) {
        m_65826 = (int64_t) 0;
    } else {
        m_65826 = m_f_res_65824;
    }
    
    int64_t m_65836 = sub64(m_65826, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65838 = slt64(m_65836, m_65686);
    bool zzero_leq_i_p_m_t_s_65837 = sle64((int64_t) 0, m_65836);
    bool y_65840 = zzero_leq_i_p_m_t_s_65837 && i_p_m_t_s_leq_w_65838;
    bool i_lte_j_65839 = sle64((int64_t) 0, m_65826);
    bool forwards_ok_65841 = i_lte_j_65839 && y_65840;
    bool eq_x_zz_65833 = (int64_t) 0 == m_f_res_65824;
    bool p_and_eq_x_y_65834 = x_65821 && eq_x_zz_65833;
    bool empty_slice_65835 = empty_slice_65695 || p_and_eq_x_y_65834;
    bool ok_or_empty_65842 = empty_slice_65835 || forwards_ok_65841;
    bool index_certs_65843;
    
    if (!ok_or_empty_65842) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65826, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:402:133-136\n   #4  ftSMJ.fut:391:1-402:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75969 = (int64_t) 8 * m_65826;
    
    if (memblock_alloc_device(ctx, &mem_75974, (int64_t) 8, "mem_75974")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_doublezigpuseq_77249(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_75965.mem, ext_mem_75968.mem, mem_75974.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
        return 1;
    
    int64_t n_pairs_t_res_65747;
    
    if (cond_65737) {
        int64_t read_res_77379;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77379, mem_75974.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_75465 = read_res_77379;
        
        n_pairs_t_res_65747 = x_75465;
    } else {
        n_pairs_t_res_65747 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
        return 1;
    
    int64_t n_pairs_65748;
    
    if (cond_65737) {
        n_pairs_65748 = n_pairs_t_res_65747;
    } else {
        n_pairs_65748 = (int64_t) 0;
    }
    
    int64_t bytes_75975 = (int64_t) 8 * n_pairs_65748;
    int64_t segmap_tblock_sizze_73854;
    
    segmap_tblock_sizze_73854 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73853;
    
    int64_t num_tblocks_73856;
    int64_t max_num_tblocks_77255;
    
    max_num_tblocks_77255 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73855;
    num_tblocks_73856 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_73854), max_num_tblocks_77255)));
    if (memblock_alloc_device(ctx, &mem_75970, bytes_75969, "mem_75970")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75970.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75972, bytes_75969, "mem_75972")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75972.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_73862;
    
    segmap_tblock_sizze_73862 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73861;
    
    int64_t num_tblocks_73864;
    int64_t max_num_tblocks_77256;
    
    max_num_tblocks_77256 = *ctx->tuning_params.inner_SMJ_doublezisegmap_num_tblocks_73863;
    num_tblocks_73864 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_73862), max_num_tblocks_77256)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77257 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_73862));
    
    {
        err = gpu_kernel_inner_SMJ_doublezisegmap_73859(ctx, num_tblocks_73864, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73861, 1, 1, (int64_t) 0, m_65686, m_65826, num_tblocks_73864, virt_num_tblocks_77257, mem_75945.mem, mem_75957.mem, mem_75959.mem, mem_75962.mem, mem_75970.mem, mem_75972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
        return 1;
    
    bool cond_65853 = slt64((int64_t) 0, m_65826);
    int64_t segmap_tblock_sizze_73877;
    
    segmap_tblock_sizze_73877 = *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73869;
    if (memblock_alloc_device(ctx, &mem_75976, bytes_75975, "mem_75976")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_75976, n_pairs_65748, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75978, bytes_75975, "mem_75978")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75978, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75980, bytes_75975, "mem_75980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75980, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_65752 = add64(scatter_psizze_57233, n_pairs_65748);
    int64_t zs_lhs_65753 = sub64(zm_lhs_65752, (int64_t) 1);
    int64_t m_65757 = sdiv64(zs_lhs_65753, scatter_psizze_57233);
    bool loop_cond_65758 = slt64((int64_t) 0, m_65757);
    bool partitioned_scatter_res_65759;
    int64_t partitioned_scatter_res_65763;
    bool loop_while_65764;
    int64_t p_65768;
    
    loop_while_65764 = loop_cond_65758;
    p_65768 = (int64_t) 0;
    while (loop_while_65764) {
        int64_t lower_bound_65769 = mul64(scatter_psizze_57233, p_65768);
        int64_t min_arg1_65770 = add64(scatter_psizze_57233, lower_bound_65769);
        int64_t min_res_65771 = smin64(n_pairs_65748, min_arg1_65770);
        int64_t j_m_i_65772 = sub64(min_res_65771, lower_bound_65769);
        bool empty_slice_65773 = j_m_i_65772 == (int64_t) 0;
        int64_t m_65774 = sub64(j_m_i_65772, (int64_t) 1);
        int64_t i_p_m_t_s_65775 = add64(lower_bound_65769, m_65774);
        bool zzero_leq_i_p_m_t_s_65776 = sle64((int64_t) 0, i_p_m_t_s_65775);
        bool i_p_m_t_s_leq_w_65777 = slt64(i_p_m_t_s_65775, n_pairs_65748);
        bool zzero_lte_i_65778 = sle64((int64_t) 0, lower_bound_65769);
        bool i_lte_j_65779 = sle64(lower_bound_65769, min_res_65771);
        bool y_65780 = i_p_m_t_s_leq_w_65777 && zzero_lte_i_65778;
        bool y_65781 = zzero_leq_i_p_m_t_s_65776 && y_65780;
        bool forwards_ok_65782 = i_lte_j_65779 && y_65781;
        bool ok_or_empty_65783 = empty_slice_65773 || forwards_ok_65782;
        bool index_certs_65784;
        
        if (!ok_or_empty_65783) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_65769, ":", (long long) min_res_65771, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_75990 = (int64_t) 8 * j_m_i_65772;
        
        if (memblock_alloc_device(ctx, &mem_75991, bytes_75990, "mem_75991")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75976.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75993, bytes_75990, "mem_75993")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75978.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75995, bytes_75990, "mem_75995")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75980.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77275 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_73854));
        
        {
            err = gpu_kernel_inner_SMJ_doublezisegmap_73851(ctx, num_tblocks_73856, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73853, 1, 1, (int64_t) 0, m_65686, lower_bound_65769, min_res_65771, j_m_i_65772, num_tblocks_73856, virt_num_tblocks_77275, mem_75947.mem, mem_75949.mem, mem_75951.mem, mem_75962.mem, mem_75991.mem, mem_75993.mem, mem_75995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_65798 = add64((int64_t) 1, p_65768);
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75976.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75978.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75980.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        
        bool loop_cond_65809 = slt64(tmp_65798, m_65757);
        bool loop_while_tmp_77270 = loop_cond_65809;
        int64_t p_tmp_77274 = tmp_65798;
        
        loop_while_65764 = loop_while_tmp_77270;
        p_65768 = p_tmp_77274;
    }
    partitioned_scatter_res_65759 = loop_while_65764;
    partitioned_scatter_res_65763 = p_65768;
    if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
        return 1;
    
    bool loop_cond_t_res_65854 = slt64(m_65686, n_pairs_65748);
    bool x_65855 = cond_65853 && loop_cond_t_res_65854;
    
    if (memblock_alloc_device(ctx, &mem_76021, (int64_t) 8, "mem_76021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76022, (int64_t) 8, "mem_76022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76023, (int64_t) 8, "mem_76023")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_65856;
    int64_t joinTups_to_joinPairs_InnerJoin_res_65860;
    bool loop_while_65861;
    int64_t p_65865;
    
    if (memblock_set_device(ctx, &mem_param_76008, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76011, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76014, &mem_75980, "mem_75980") != 0)
        return 1;
    loop_while_65861 = x_65855;
    p_65865 = (int64_t) 0;
    while (loop_while_65861) {
        bool x_65866 = sle64((int64_t) 0, p_65865);
        bool y_65867 = slt64(p_65865, m_65826);
        bool bounds_check_65868 = x_65866 && y_65867;
        bool index_certs_65869;
        
        if (!bounds_check_65868) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65865, "] out of bounds for array of shape [", (long long) m_65826, "].", "-> #0  ftSMJ.fut:299:13-42\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_77380;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77380, mem_75972.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65870 = read_res_77380;
        int64_t read_res_77381;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77381, mem_75970.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65871 = read_res_77381;
        bool x_65872 = sle64((int64_t) 0, loopres_65870);
        bool y_65873 = slt64(loopres_65870, n_pairs_65748);
        bool bounds_check_65874 = x_65872 && y_65873;
        bool index_certs_65875;
        
        if (!bounds_check_65874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:301:52-61\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_65886 = add64(loopres_65870, loopres_65871);
        bool empty_slice_65890 = loopres_65871 == (int64_t) 0;
        int64_t m_65891 = sub64(loopres_65871, (int64_t) 1);
        int64_t i_p_m_t_s_65892 = add64(loopres_65870, m_65891);
        bool zzero_leq_i_p_m_t_s_65893 = sle64((int64_t) 0, i_p_m_t_s_65892);
        bool i_p_m_t_s_leq_w_65894 = slt64(i_p_m_t_s_65892, n_pairs_65748);
        bool i_lte_j_65895 = sle64(loopres_65870, tmp_65886);
        bool y_65896 = x_65872 && i_p_m_t_s_leq_w_65894;
        bool y_65897 = zzero_leq_i_p_m_t_s_65893 && y_65896;
        bool forwards_ok_65898 = i_lte_j_65895 && y_65897;
        bool ok_or_empty_65899 = empty_slice_65890 || forwards_ok_65898;
        bool index_certs_65900;
        
        if (!ok_or_empty_65899) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, ":", (long long) tmp_65886, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:305:14-55\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:402:133-136\n   #3  ftSMJ.fut:391:1-402:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_76024 = (int64_t) 8 * loopres_65871;
        int64_t segmap_usable_groups_73878 = sdiv_up64(loopres_65871, segmap_tblock_sizze_73877);
        int64_t tmp_65885 = add64((int64_t) 1, p_65865);
        
        if (memblock_alloc_device(ctx, &mem_76016, bytes_75975, "mem_76016")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76016.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76008.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76018, bytes_75975, "mem_76018")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76011.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76020, bytes_75975, "mem_76020")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76020.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76014.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        
        bool cond_65904 = slt64(tmp_65885, m_65826);
        bool x_65905 = loop_cond_t_res_65854 && cond_65904;
        
        {
            err = gpu_kernel_inner_SMJ_doublezigpuseq_77296(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_65870, mem_param_76008.mem, mem_param_76011.mem, mem_param_76014.mem, mem_76021.mem, mem_76022.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76025, bytes_76024, "mem_76025")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77302 = loopres_65871;
        int64_t tblock_sizze_77307;
        
        tblock_sizze_77307 = *ctx->tuning_params.inner_SMJ_doublezitblock_sizze_77307;
        
        int64_t virt_num_tblocks_77308 = sdiv_up64(replicate_n_77302, tblock_sizze_77307);
        int64_t num_tblocks_77309 = smin64(virt_num_tblocks_77308, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_doublezireplicate_77303(ctx, num_tblocks_77309, 1, 1, tblock_sizze_77307, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77302, virt_num_tblocks_77308, num_tblocks_77309, mem_76021.mem, mem_76025.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76027, bytes_76024, "mem_76027")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77322 = loopres_65871;
        int64_t tblock_sizze_77327;
        
        tblock_sizze_77327 = *ctx->tuning_params.inner_SMJ_doublezitblock_sizze_77327;
        
        int64_t virt_num_tblocks_77328 = sdiv_up64(replicate_n_77322, tblock_sizze_77327);
        int64_t num_tblocks_77329 = smin64(virt_num_tblocks_77328, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_doublezireplicate_77323(ctx, num_tblocks_77329, 1, 1, tblock_sizze_77327, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77322, virt_num_tblocks_77328, num_tblocks_77329, mem_76022.mem, mem_76027.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77342 = sext_i64_i32(sdiv_up64(loopres_65871, segmap_tblock_sizze_73877));
        
        {
            err = gpu_kernel_inner_SMJ_doublezisegmap_73881(ctx, segmap_usable_groups_73878, 1, 1, *ctx->tuning_params.inner_SMJ_doublezisegmap_tblock_sizze_73869, 1, 1, (int64_t) 0, loopres_65870, loopres_65871, mem_76020.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76016.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77288, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77289, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77290, &mem_76020, "mem_76020") != 0)
            return 1;
        
        bool loop_while_tmp_77291 = x_65905;
        int64_t p_tmp_77295 = tmp_65885;
        
        if (memblock_set_device(ctx, &mem_param_76008, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76011, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76014, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        loop_while_65861 = loop_while_tmp_77291;
        p_65865 = p_tmp_77295;
    }
    if (memblock_set_device(ctx, &ext_mem_76039, &mem_param_76008, "mem_param_76008") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76038, &mem_param_76011, "mem_param_76011") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76037, &mem_param_76014, "mem_param_76014") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_65856 = loop_while_65861;
    joinTups_to_joinPairs_InnerJoin_res_65860 = p_65865;
    if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76041, bytes_75975, "mem_76041")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76041.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76039.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76043, bytes_75975, "mem_76043")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76038.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76045, bytes_75975, "mem_76045")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76037.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_76043, "mem_76043") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76543, &mem_76045, "mem_76045") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76544, &mem_76041, "mem_76041") != 0)
        return 1;
    prim_out_76545 = n_pairs_65748;
    if (memblock_set_device(ctx, &*mem_out_p_77361, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77362, &mem_out_76543, "mem_out_76543") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77363, &mem_out_76544, "mem_out_76544") != 0)
        return 1;
    *out_prim_out_77364 = prim_out_76545;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_76045, "mem_76045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76043, "mem_76043") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76041, "mem_76041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76020, "mem_76020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76014, "mem_param_76014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76011, "mem_param_76011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76008, "mem_param_76008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75966, "mem_75966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75967, "mem_75967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75963, "mem_75963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75964, "mem_75964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77091, "incprefixes_mem_77091") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77089, "aggregates_mem_77089") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77087, "incprefixes_mem_77087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77085, "aggregates_mem_77085") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_77083, "status_flags_mem_77083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_76950, "incprefixes_mem_76950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_76948, "aggregates_mem_76948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_76926, "status_flags_mem_76926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75925, "mem_75925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75922, "mem_75922") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75730, "mem_75730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75728, "mem_75728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75714, "mem_75714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75711, "mem_75711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75690, "mem_75690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75688, "mem_75688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75623, "mem_75623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75621, "mem_75621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75684, "mem_75684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75682, "mem_75682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75693, "ext_mem_75693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75696, "ext_mem_75696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75699, "ext_mem_75699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75702, "ext_mem_75702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75552, "mem_param_75552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75549, "mem_param_75549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75544, "mem_75544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75545, "mem_75545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75541, "mem_75541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75542, "mem_75542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75540, "mem_param_75540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75537, "mem_param_75537") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75733, "ext_mem_75733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75736, "ext_mem_75736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75739, "ext_mem_75739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75742, "ext_mem_75742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75530, "mem_param_75530") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75527, "mem_param_75527") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75747, "ext_mem_75747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75748, "ext_mem_75748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75509, "mem_75509") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75511, "mem_75511") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75493, "mem_75493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75494, "mem_75494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75489, "mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75490, "mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75895, "mem_75895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75893, "mem_75893") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75828, "mem_75828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75826, "mem_75826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75889, "mem_75889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75887, "mem_75887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75898, "ext_mem_75898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75901, "ext_mem_75901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75904, "ext_mem_75904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75907, "ext_mem_75907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75757, "mem_param_75757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75754, "mem_param_75754") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75912, "ext_mem_75912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75913, "ext_mem_75913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75749, "mem_75749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75750, "mem_75750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75482, "mem_param_75482") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75474, "mem_75474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75475, "mem_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76544, "mem_out_76544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76543, "mem_out_76543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_77382, struct memblock_device *mem_out_p_77383, struct memblock_device *mem_out_p_77384, int64_t *out_prim_out_77385, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_52195, int64_t nS_52196, int64_t offset_R_52199, int64_t offset_S_52200, int64_t partitionsPerWindow_52201, int64_t numberOfWindows_52202, int64_t extParallelism_52203, int64_t scatter_psizze_52204)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_76045;
    
    mem_76045.references = NULL;
    
    struct memblock_device mem_76043;
    
    mem_76043.references = NULL;
    
    struct memblock_device mem_76041;
    
    mem_76041.references = NULL;
    
    struct memblock_device mem_param_tmp_77290;
    
    mem_param_tmp_77290.references = NULL;
    
    struct memblock_device mem_param_tmp_77289;
    
    mem_param_tmp_77289.references = NULL;
    
    struct memblock_device mem_param_tmp_77288;
    
    mem_param_tmp_77288.references = NULL;
    
    struct memblock_device mem_76027;
    
    mem_76027.references = NULL;
    
    struct memblock_device mem_76025;
    
    mem_76025.references = NULL;
    
    struct memblock_device mem_76020;
    
    mem_76020.references = NULL;
    
    struct memblock_device mem_76018;
    
    mem_76018.references = NULL;
    
    struct memblock_device mem_76016;
    
    mem_76016.references = NULL;
    
    struct memblock_device mem_param_76014;
    
    mem_param_76014.references = NULL;
    
    struct memblock_device mem_param_76011;
    
    mem_param_76011.references = NULL;
    
    struct memblock_device mem_param_76008;
    
    mem_param_76008.references = NULL;
    
    struct memblock_device ext_mem_76037;
    
    ext_mem_76037.references = NULL;
    
    struct memblock_device ext_mem_76038;
    
    ext_mem_76038.references = NULL;
    
    struct memblock_device ext_mem_76039;
    
    ext_mem_76039.references = NULL;
    
    struct memblock_device mem_76023;
    
    mem_76023.references = NULL;
    
    struct memblock_device mem_76022;
    
    mem_76022.references = NULL;
    
    struct memblock_device mem_76021;
    
    mem_76021.references = NULL;
    
    struct memblock_device mem_75995;
    
    mem_75995.references = NULL;
    
    struct memblock_device mem_75993;
    
    mem_75993.references = NULL;
    
    struct memblock_device mem_75991;
    
    mem_75991.references = NULL;
    
    struct memblock_device mem_75980;
    
    mem_75980.references = NULL;
    
    struct memblock_device mem_75978;
    
    mem_75978.references = NULL;
    
    struct memblock_device mem_75976;
    
    mem_75976.references = NULL;
    
    struct memblock_device mem_75972;
    
    mem_75972.references = NULL;
    
    struct memblock_device mem_75970;
    
    mem_75970.references = NULL;
    
    struct memblock_device mem_75974;
    
    mem_75974.references = NULL;
    
    struct memblock_device mem_75966;
    
    mem_75966.references = NULL;
    
    struct memblock_device mem_75967;
    
    mem_75967.references = NULL;
    
    struct memblock_device ext_mem_75968;
    
    ext_mem_75968.references = NULL;
    
    struct memblock_device mem_75963;
    
    mem_75963.references = NULL;
    
    struct memblock_device mem_75964;
    
    mem_75964.references = NULL;
    
    struct memblock_device ext_mem_75965;
    
    ext_mem_75965.references = NULL;
    
    struct memblock_device mem_75962;
    
    mem_75962.references = NULL;
    
    struct memblock_device incprefixes_mem_77091;
    
    incprefixes_mem_77091.references = NULL;
    
    struct memblock_device aggregates_mem_77089;
    
    aggregates_mem_77089.references = NULL;
    
    struct memblock_device incprefixes_mem_77087;
    
    incprefixes_mem_77087.references = NULL;
    
    struct memblock_device aggregates_mem_77085;
    
    aggregates_mem_77085.references = NULL;
    
    struct memblock_device status_flags_mem_77083;
    
    status_flags_mem_77083.references = NULL;
    
    struct memblock_device mem_75959;
    
    mem_75959.references = NULL;
    
    struct memblock_device mem_75957;
    
    mem_75957.references = NULL;
    
    struct memblock_device mem_75955;
    
    mem_75955.references = NULL;
    
    struct memblock_device mem_75951;
    
    mem_75951.references = NULL;
    
    struct memblock_device mem_75949;
    
    mem_75949.references = NULL;
    
    struct memblock_device mem_75947;
    
    mem_75947.references = NULL;
    
    struct memblock_device mem_75945;
    
    mem_75945.references = NULL;
    
    struct memblock_device incprefixes_mem_76950;
    
    incprefixes_mem_76950.references = NULL;
    
    struct memblock_device aggregates_mem_76948;
    
    aggregates_mem_76948.references = NULL;
    
    struct memblock_device status_flags_mem_76926;
    
    status_flags_mem_76926.references = NULL;
    
    struct memblock_device mem_75943;
    
    mem_75943.references = NULL;
    
    struct memblock_device mem_75941;
    
    mem_75941.references = NULL;
    
    struct memblock_device mem_param_tmp_76593;
    
    mem_param_tmp_76593.references = NULL;
    
    struct memblock_device mem_param_tmp_76592;
    
    mem_param_tmp_76592.references = NULL;
    
    struct memblock_device mem_75926;
    
    mem_75926.references = NULL;
    
    struct memblock_device mem_75925;
    
    mem_75925.references = NULL;
    
    struct memblock_device mem_75922;
    
    mem_75922.references = NULL;
    
    struct memblock_device mem_param_tmp_76750;
    
    mem_param_tmp_76750.references = NULL;
    
    struct memblock_device mem_param_tmp_76749;
    
    mem_param_tmp_76749.references = NULL;
    
    struct memblock_device mem_75730;
    
    mem_75730.references = NULL;
    
    struct memblock_device mem_75728;
    
    mem_75728.references = NULL;
    
    struct memblock_device mem_75726;
    
    mem_75726.references = NULL;
    
    struct memblock_device mem_75723;
    
    mem_75723.references = NULL;
    
    struct memblock_device mem_param_tmp_76760;
    
    mem_param_tmp_76760.references = NULL;
    
    struct memblock_device mem_param_tmp_76759;
    
    mem_param_tmp_76759.references = NULL;
    
    struct memblock_device mem_75714;
    
    mem_75714.references = NULL;
    
    struct memblock_device mem_75711;
    
    mem_75711.references = NULL;
    
    struct memblock_device mem_param_tmp_76778;
    
    mem_param_tmp_76778.references = NULL;
    
    struct memblock_device mem_param_tmp_76777;
    
    mem_param_tmp_76777.references = NULL;
    
    struct memblock_device mem_75690;
    
    mem_75690.references = NULL;
    
    struct memblock_device mem_75688;
    
    mem_75688.references = NULL;
    
    struct memblock_device mem_75623;
    
    mem_75623.references = NULL;
    
    struct memblock_device mem_75621;
    
    mem_75621.references = NULL;
    
    struct memblock_device mem_75684;
    
    mem_75684.references = NULL;
    
    struct memblock_device mem_75682;
    
    mem_75682.references = NULL;
    
    struct memblock_device ext_mem_75685;
    
    ext_mem_75685.references = NULL;
    
    struct memblock_device ext_mem_75686;
    
    ext_mem_75686.references = NULL;
    
    struct memblock_device ext_mem_75562;
    
    ext_mem_75562.references = NULL;
    
    struct memblock_device mem_75560;
    
    mem_75560.references = NULL;
    
    struct memblock_device ext_mem_75693;
    
    ext_mem_75693.references = NULL;
    
    struct memblock_device ext_mem_75696;
    
    ext_mem_75696.references = NULL;
    
    struct memblock_device mem_75558;
    
    mem_75558.references = NULL;
    
    struct memblock_device ext_mem_75699;
    
    ext_mem_75699.references = NULL;
    
    struct memblock_device ext_mem_75702;
    
    ext_mem_75702.references = NULL;
    
    struct memblock_device ext_mem_75556;
    
    ext_mem_75556.references = NULL;
    
    struct memblock_device ext_mem_75555;
    
    ext_mem_75555.references = NULL;
    
    struct memblock_device mem_param_75552;
    
    mem_param_75552.references = NULL;
    
    struct memblock_device mem_param_75549;
    
    mem_param_75549.references = NULL;
    
    struct memblock_device ext_mem_75707;
    
    ext_mem_75707.references = NULL;
    
    struct memblock_device ext_mem_75708;
    
    ext_mem_75708.references = NULL;
    
    struct memblock_device mem_75544;
    
    mem_75544.references = NULL;
    
    struct memblock_device mem_75545;
    
    mem_75545.references = NULL;
    
    struct memblock_device ext_mem_75546;
    
    ext_mem_75546.references = NULL;
    
    struct memblock_device mem_75541;
    
    mem_75541.references = NULL;
    
    struct memblock_device mem_75542;
    
    mem_75542.references = NULL;
    
    struct memblock_device ext_mem_75543;
    
    ext_mem_75543.references = NULL;
    
    struct memblock_device mem_param_75540;
    
    mem_param_75540.references = NULL;
    
    struct memblock_device mem_param_75537;
    
    mem_param_75537.references = NULL;
    
    struct memblock_device ext_mem_75719;
    
    ext_mem_75719.references = NULL;
    
    struct memblock_device ext_mem_75720;
    
    ext_mem_75720.references = NULL;
    
    struct memblock_device mem_75557;
    
    mem_75557.references = NULL;
    
    struct memblock_device mem_75554;
    
    mem_75554.references = NULL;
    
    struct memblock_device mem_75553;
    
    mem_75553.references = NULL;
    
    struct memblock_device mem_75534;
    
    mem_75534.references = NULL;
    
    struct memblock_device mem_75532;
    
    mem_75532.references = NULL;
    
    struct memblock_device ext_mem_75733;
    
    ext_mem_75733.references = NULL;
    
    struct memblock_device ext_mem_75736;
    
    ext_mem_75736.references = NULL;
    
    struct memblock_device ext_mem_75739;
    
    ext_mem_75739.references = NULL;
    
    struct memblock_device ext_mem_75742;
    
    ext_mem_75742.references = NULL;
    
    struct memblock_device mem_param_75530;
    
    mem_param_75530.references = NULL;
    
    struct memblock_device mem_param_75527;
    
    mem_param_75527.references = NULL;
    
    struct memblock_device ext_mem_75747;
    
    ext_mem_75747.references = NULL;
    
    struct memblock_device ext_mem_75748;
    
    ext_mem_75748.references = NULL;
    
    struct memblock_device mem_75524;
    
    mem_75524.references = NULL;
    
    struct memblock_device mem_75522;
    
    mem_75522.references = NULL;
    
    struct memblock_device mem_75509;
    
    mem_75509.references = NULL;
    
    struct memblock_device mem_75511;
    
    mem_75511.references = NULL;
    
    struct memblock_device ext_mem_75512;
    
    ext_mem_75512.references = NULL;
    
    struct memblock_device ext_mem_75513;
    
    ext_mem_75513.references = NULL;
    
    struct memblock_device mem_75506;
    
    mem_75506.references = NULL;
    
    struct memblock_device mem_75504;
    
    mem_75504.references = NULL;
    
    struct memblock_device mem_75493;
    
    mem_75493.references = NULL;
    
    struct memblock_device mem_75494;
    
    mem_75494.references = NULL;
    
    struct memblock_device ext_mem_75495;
    
    ext_mem_75495.references = NULL;
    
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_75489;
    
    mem_75489.references = NULL;
    
    struct memblock_device mem_75490;
    
    mem_75490.references = NULL;
    
    struct memblock_device ext_mem_75491;
    
    ext_mem_75491.references = NULL;
    
    struct memblock_device mem_75488;
    
    mem_75488.references = NULL;
    
    struct memblock_device mem_75486;
    
    mem_75486.references = NULL;
    
    struct memblock_device mem_param_tmp_76611;
    
    mem_param_tmp_76611.references = NULL;
    
    struct memblock_device mem_param_tmp_76610;
    
    mem_param_tmp_76610.references = NULL;
    
    struct memblock_device mem_75895;
    
    mem_75895.references = NULL;
    
    struct memblock_device mem_75893;
    
    mem_75893.references = NULL;
    
    struct memblock_device mem_75828;
    
    mem_75828.references = NULL;
    
    struct memblock_device mem_75826;
    
    mem_75826.references = NULL;
    
    struct memblock_device mem_75889;
    
    mem_75889.references = NULL;
    
    struct memblock_device mem_75887;
    
    mem_75887.references = NULL;
    
    struct memblock_device ext_mem_75890;
    
    ext_mem_75890.references = NULL;
    
    struct memblock_device ext_mem_75891;
    
    ext_mem_75891.references = NULL;
    
    struct memblock_device ext_mem_75767;
    
    ext_mem_75767.references = NULL;
    
    struct memblock_device mem_75765;
    
    mem_75765.references = NULL;
    
    struct memblock_device ext_mem_75898;
    
    ext_mem_75898.references = NULL;
    
    struct memblock_device ext_mem_75901;
    
    ext_mem_75901.references = NULL;
    
    struct memblock_device mem_75763;
    
    mem_75763.references = NULL;
    
    struct memblock_device ext_mem_75904;
    
    ext_mem_75904.references = NULL;
    
    struct memblock_device ext_mem_75907;
    
    ext_mem_75907.references = NULL;
    
    struct memblock_device ext_mem_75761;
    
    ext_mem_75761.references = NULL;
    
    struct memblock_device ext_mem_75760;
    
    ext_mem_75760.references = NULL;
    
    struct memblock_device mem_param_75757;
    
    mem_param_75757.references = NULL;
    
    struct memblock_device mem_param_75754;
    
    mem_param_75754.references = NULL;
    
    struct memblock_device ext_mem_75912;
    
    ext_mem_75912.references = NULL;
    
    struct memblock_device ext_mem_75913;
    
    ext_mem_75913.references = NULL;
    
    struct memblock_device mem_75762;
    
    mem_75762.references = NULL;
    
    struct memblock_device mem_75759;
    
    mem_75759.references = NULL;
    
    struct memblock_device mem_75758;
    
    mem_75758.references = NULL;
    
    struct memblock_device mem_75749;
    
    mem_75749.references = NULL;
    
    struct memblock_device mem_75750;
    
    mem_75750.references = NULL;
    
    struct memblock_device ext_mem_75751;
    
    ext_mem_75751.references = NULL;
    
    struct memblock_device ext_mem_75916;
    
    ext_mem_75916.references = NULL;
    
    struct memblock_device ext_mem_75919;
    
    ext_mem_75919.references = NULL;
    
    struct memblock_device ext_mem_75929;
    
    ext_mem_75929.references = NULL;
    
    struct memblock_device ext_mem_75932;
    
    ext_mem_75932.references = NULL;
    
    struct memblock_device mem_param_75482;
    
    mem_param_75482.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device ext_mem_75937;
    
    ext_mem_75937.references = NULL;
    
    struct memblock_device ext_mem_75938;
    
    ext_mem_75938.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75474;
    
    mem_75474.references = NULL;
    
    struct memblock_device mem_75475;
    
    mem_75475.references = NULL;
    
    struct memblock_device ext_mem_75476;
    
    ext_mem_75476.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device ext_mem_75469;
    
    ext_mem_75469.references = NULL;
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76545;
    int64_t zm_lhs_64812 = add64(nR_52195, nS_52196);
    int64_t zs_lhs_64813 = sub64(zm_lhs_64812, (int64_t) 1);
    bool zzero_64814 = nR_52195 == (int64_t) 0;
    bool nonzzero_64815 = !zzero_64814;
    bool nonzzero_cert_64816;
    
    if (!nonzzero_64815) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:231:26-29\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_64817 = sdiv64(zs_lhs_64813, nR_52195);
    
    if (futrts_indicesWithIncrement_7791(ctx, &ext_mem_75469, tR_mem_75467, nR_52195, offset_R_52199) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_75470 = (int64_t) 8 * nR_52195;
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75471, nR_52195, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, nR_52195, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_64822 = slt64((int64_t) 0, numIter_64817);
    int64_t gt_rhs_64823 = sub64(nR_52195, (int64_t) 1);
    bool x_64824 = sle64((int64_t) 0, gt_rhs_64823);
    bool y_64825 = slt64(gt_rhs_64823, nR_52195);
    bool bounds_check_64826 = x_64824 && y_64825;
    bool loop_not_taken_64827 = !loop_cond_64822;
    bool protect_assert_disj_64828 = bounds_check_64826 || loop_not_taken_64827;
    bool index_certs_64829;
    
    if (!protect_assert_disj_64828) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftSMJ.fut:238:25-33\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_64822) {
        if (memblock_alloc_device(ctx, &mem_75475, (int64_t) 4, "mem_75475")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_76566(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, tR_mem_75467.mem, mem_75475.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75475, "mem_75475") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75474, (int64_t) 4, "mem_75474")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_75474, (int64_t) 1, 0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75474, "mem_75474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_75483, (int64_t) 4, "mem_75483")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75484, (int64_t) 1, "mem_75484")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_64832;
    int64_t defunc_0_mergeJoin_res_64833;
    bool loop_while_64836;
    int64_t p_64837;
    
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75482, &mem_75471, "mem_75471") != 0)
        return 1;
    loop_while_64836 = loop_cond_64822;
    p_64837 = (int64_t) 0;
    while (loop_while_64836) {
        int64_t tS_start_64840 = mul64(nR_52195, p_64837);
        int64_t min_arg1_64841 = add64(nR_52195, tS_start_64840);
        int64_t min_res_64842 = smin64(nS_52196, min_arg1_64841);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 = sub64(min_res_64842, tS_start_64840);
        bool empty_slice_64844 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 == (int64_t) 0;
        int64_t m_64845 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, (int64_t) 1);
        int64_t i_p_m_t_s_64846 = add64(tS_start_64840, m_64845);
        bool zzero_leq_i_p_m_t_s_64847 = sle64((int64_t) 0, i_p_m_t_s_64846);
        bool i_p_m_t_s_leq_w_64848 = slt64(i_p_m_t_s_64846, nS_52196);
        bool zzero_lte_i_64849 = sle64((int64_t) 0, tS_start_64840);
        bool i_lte_j_64850 = sle64(tS_start_64840, min_res_64842);
        bool y_64851 = i_p_m_t_s_leq_w_64848 && zzero_lte_i_64849;
        bool y_64852 = zzero_leq_i_p_m_t_s_64847 && y_64851;
        bool forwards_ok_64853 = i_lte_j_64850 && y_64852;
        bool ok_or_empty_64854 = empty_slice_64844 || forwards_ok_64853;
        bool index_certs_64855;
        
        if (!ok_or_empty_64854) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_64840, ":", (long long) min_res_64842, "] out of bounds for array of shape [", (long long) nS_52196, "].", "-> #0  ftSMJ.fut:237:16-35\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_64857 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
        bool index_certs_64858;
        
        if (!y_64857) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:238:12-19\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_76598(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_64840, tS_mem_75468.mem, ext_mem_75476.mem, mem_75483.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_77386;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77386, mem_75484.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_64860 = read_res_77386;
        int64_t loopres_64861;
        
        if (defunc_0_gt_res_64860) {
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_param_75479, "mem_param_75479") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_param_75482, "mem_param_75482") != 0)
                return 1;
            loopres_64861 = numIter_64817;
        } else {
            bool cond_64864 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, nR_52195);
            bool dim_match_64978 = nR_52195 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            bool protect_assert_disj_76147 = cond_64864 || dim_match_64978;
            bool empty_or_match_cert_64979;
            
            if (!protect_assert_disj_76147) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "] cannot match shape of type `[", (long long) nR_52195, "]f32`.", "-> #0  ftSMJ.fut:246:18-31\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_64985 = slt64((int64_t) 0, numberOfWindows_52202);
            bool y_64988 = slt64((int64_t) 0, nR_52195);
            bool loop_not_taken_64989 = !loop_cond_64985;
            bool protect_assert_disj_64990 = y_64988 || loop_not_taken_64989;
            bool protect_assert_disj_76149 = cond_64864 || protect_assert_disj_64990;
            bool index_certs_64991;
            
            if (!protect_assert_disj_76149) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftbasics.fut:150:20-25\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_66374 = add64(nR_52195, extParallelism_52203);
            int64_t zs_lhs_66375 = sub64(zm_lhs_66374, (int64_t) 1);
            bool zzero_66376 = extParallelism_52203 == (int64_t) 0;
            bool nonzzero_66377 = !zzero_66376;
            bool loop_not_taken_76090 = !cond_64864;
            bool protect_assert_disj_76091 = nonzzero_66377 || loop_not_taken_76090;
            bool nonzzero_cert_66378;
            
            if (!protect_assert_disj_76091) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_66379 = sdiv_safe64(zs_lhs_66375, extParallelism_52203);
            bool loop_cond_66380 = slt64((int64_t) 0, numIter_66379);
            bool loop_not_taken_66381 = !y_64857;
            bool loop_not_taken_66382 = !loop_cond_66380;
            bool x_66383 = sle64((int64_t) 0, m_64845);
            bool y_66384 = slt64(m_64845, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
            bool bounds_check_66386 = x_66383 && y_66384;
            bool protect_assert_disj_66387 = loop_not_taken_66381 || bounds_check_66386;
            bool protect_assert_disj_66388 = loop_not_taken_66382 || protect_assert_disj_66387;
            bool protect_assert_disj_76093 = protect_assert_disj_66388 || loop_not_taken_76090;
            bool index_certs_66389;
            
            if (!protect_assert_disj_76093) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65659;
            
            if (!bounds_check_66386) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:257:23-44\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65661;
            
            if (!bounds_check_64826) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftSMJ.fut:257:51-59\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 = mul64(partitionsPerWindow_52201, numberOfWindows_52202);
            int64_t join_chunks_arg3_64981 = add64(offset_S_52200, tS_start_64840);
            int64_t bytes_75485 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
            bool empty_slice_64986 = partitionsPerWindow_52201 == (int64_t) 0;
            int64_t m_64987 = sub64(partitionsPerWindow_52201, (int64_t) 1);
            int64_t segmap_tblock_sizze_71650;
            
            segmap_tblock_sizze_71650 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71443;
            
            int64_t zeze_rhs_65256 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, (int64_t) 1);
            int64_t segmap_tblock_sizze_72024;
            
            segmap_tblock_sizze_72024 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71860;
            
            int64_t segmap_usable_groups_72025 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_72024);
            bool loop_cond_65411 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
            bool protect_cond_conj_66385 = y_64857 && loop_cond_66380;
            int64_t bytes_75764 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            int64_t ext_75918;
            int64_t ext_75917;
            int64_t ext_75915;
            int64_t ext_75914;
            
            if (cond_64864) {
                if (protect_cond_conj_66385) {
                    if (memblock_alloc_device(ctx, &mem_75750, (int64_t) 4, "mem_75750")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76604(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_64846, tS_mem_75468.mem, mem_75750.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75750, "mem_75750") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75749, (int64_t) 4, "mem_75749")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_75749, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75749, "mem_75749") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75758, (int64_t) 4, "mem_75758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75759, (int64_t) 4, "mem_75759")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75762, (int64_t) 1, "mem_75762")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_75911;
                int64_t ext_75910;
                int64_t ext_75909;
                int64_t ext_75908;
                bool defunc_0_find_joinTuples_res_66392;
                int64_t defunc_0_find_joinTuples_res_66393;
                bool loop_while_66396;
                int64_t p_66397;
                int64_t ctx_param_ext_75752;
                int64_t ctx_param_ext_75753;
                int64_t ctx_param_ext_75755;
                int64_t ctx_param_ext_75756;
                
                if (memblock_set_device(ctx, &mem_param_75754, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75757, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75752 = (int64_t) 0;
                ctx_param_ext_75753 = (int64_t) 1;
                ctx_param_ext_75755 = (int64_t) 0;
                ctx_param_ext_75756 = (int64_t) 1;
                loop_while_66396 = loop_cond_66380;
                p_66397 = (int64_t) 0;
                while (loop_while_66396) {
                    int64_t start_66400 = mul64(extParallelism_52203, p_66397);
                    int64_t min_arg1_66401 = sub64(nR_52195, start_66400);
                    int64_t min_res_66402 = smin64(extParallelism_52203, min_arg1_66401);
                    int64_t iter_R_66403 = add64(start_66400, min_res_66402);
                    bool empty_slice_66404 = min_res_66402 == (int64_t) 0;
                    int64_t m_66405 = sub64(min_res_66402, (int64_t) 1);
                    int64_t i_p_m_t_s_66406 = add64(start_66400, m_66405);
                    bool zzero_leq_i_p_m_t_s_66407 = sle64((int64_t) 0, i_p_m_t_s_66406);
                    bool i_p_m_t_s_leq_w_66408 = slt64(i_p_m_t_s_66406, nR_52195);
                    bool zzero_lte_i_66409 = sle64((int64_t) 0, start_66400);
                    bool i_lte_j_66410 = sle64(start_66400, iter_R_66403);
                    bool y_66411 = i_p_m_t_s_leq_w_66408 && zzero_lte_i_66409;
                    bool y_66412 = zzero_leq_i_p_m_t_s_66407 && y_66411;
                    bool forwards_ok_66413 = i_lte_j_66410 && y_66412;
                    bool ok_or_empty_66414 = empty_slice_66404 || forwards_ok_66413;
                    bool index_certs_66415;
                    
                    if (!ok_or_empty_66414) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_66400, ":", (long long) iter_R_66403, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66416 = slt64(m_66405, min_res_66402);
                    bool x_66417 = sle64((int64_t) 0, m_66405);
                    bool bounds_check_66418 = y_66416 && x_66417;
                    bool index_certs_66419;
                    
                    if (!bounds_check_66418) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_66405, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66422 = slt64((int64_t) 0, min_res_66402);
                    bool index_certs_66423;
                    
                    if (!y_66422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76620(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_66400, i_p_m_t_s_66406, tR_mem_75467.mem, mem_75758.mem, mem_75759.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75760, &ext_mem_75751, "ext_mem_75751") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75760, &mem_75758, "mem_75758") != 0)
                        return 1;
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75761, &mem_75483, "mem_75483") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75761, &mem_75759, "mem_75759") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76626(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75759.mem, ext_mem_75760.mem, mem_75762.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
                        return 1;
                    
                    bool read_res_77387;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77387, mem_75762.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_66425 = read_res_77387;
                    int64_t ext_75906;
                    int64_t ext_75905;
                    int64_t ext_75903;
                    int64_t ext_75902;
                    int64_t loopres_66427;
                    
                    if (defunc_0_gt_res_66425) {
                        if (memblock_set_device(ctx, &ext_mem_75907, &mem_param_75754, "mem_param_75754") != 0)
                            return 1;
                        ext_75906 = ctx_param_ext_75752;
                        ext_75905 = ctx_param_ext_75753;
                        if (memblock_set_device(ctx, &ext_mem_75904, &mem_param_75757, "mem_param_75757") != 0)
                            return 1;
                        ext_75903 = ctx_param_ext_75755;
                        ext_75902 = ctx_param_ext_75756;
                        loopres_66427 = numIter_66379;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75763, (int64_t) 1, "mem_75763")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_floatzigpuseq_76632(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75758.mem, ext_mem_75761.mem, mem_75763.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_77388;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77388, mem_75763.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_66431 = read_res_77388;
                        
                        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
                            return 1;
                        
                        int64_t ext_75900;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75900 = ctx_param_ext_75752;
                        } else {
                            ext_75900 = (int64_t) 0;
                        }
                        
                        int64_t ext_75899;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75899 = ctx_param_ext_75753;
                        } else {
                            ext_75899 = (int64_t) 1;
                        }
                        
                        int64_t ext_75897;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75897 = ctx_param_ext_75755;
                        } else {
                            ext_75897 = (int64_t) 0;
                        }
                        
                        int64_t ext_75896;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75896 = ctx_param_ext_75756;
                        } else {
                            ext_75896 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_66432;
                        
                        if (defunc_0_gt_res_66431) {
                            int64_t tmp_66436 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_param_75754, "mem_param_75754") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_param_75757, "mem_param_75757") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66436;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_75765, bytes_75764, "mem_75765")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75765.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, tS_start_64840, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_7791(ctx, &ext_mem_75767, mem_75765, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, join_chunks_arg3_64981) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
                                return 1;
                            
                            bool suff_outer_par_71265;
                            
                            suff_outer_par_71265 = *ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_0 <= min_res_66402;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_float.suff_outer_par_0", (long) min_res_66402, suff_outer_par_71265 ? "true" : "false");
                            
                            int64_t tile_sizze_74256;
                            
                            tile_sizze_74256 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255;
                            
                            int64_t tile_sizze_73901;
                            
                            tile_sizze_73901 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900;
                            
                            int64_t num_whole_tiles_74272 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            int64_t residual_input_74496 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            bool cond_74497 = residual_input_74496 == (int64_t) 0;
                            int64_t binop_x_74513 = tile_sizze_74256 * num_whole_tiles_74272;
                            int64_t bytes_75825 = (int64_t) 8 * min_res_66402;
                            int64_t bytes_75788 = (int64_t) 8 * tile_sizze_74256;
                            int64_t bytes_75790 = (int64_t) 4 * tile_sizze_74256;
                            int64_t num_whole_tiles_73917 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            int64_t residual_input_74141 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            bool cond_74142 = residual_input_74141 == (int64_t) 0;
                            int64_t binop_x_74158 = tile_sizze_73901 * num_whole_tiles_73917;
                            int64_t bytes_75849 = (int64_t) 8 * tile_sizze_73901;
                            int64_t bytes_75851 = (int64_t) 4 * tile_sizze_73901;
                            int64_t shared_memory_capacity_76690;
                            
                            shared_memory_capacity_76690 = ctx->max_shared_memory;
                            if (suff_outer_par_71265 && sle64(sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75851, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76690)) {
                                int64_t ldim_73902 = sdiv_up64(min_res_66402, tile_sizze_73901);
                                
                                if (memblock_alloc_device(ctx, &mem_75887, bytes_75825, "mem_75887")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75889, bytes_75825, "mem_75889")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76638 = sext_i64_i32(sdiv_up64(tile_sizze_73901, tile_sizze_73901));
                                int32_t virt_num_tblocks_76639 = sext_i64_i32(ldim_73902);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_73899(ctx, ldim_73902, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_73900, 1, 1, bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8) + (bytes_75851 + srem64((int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8)) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_73902, num_whole_tiles_73917, residual_input_74141, cond_74142, binop_x_74158, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75887.mem, mem_75889.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75887, "mem_75887") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75889, "mem_75889") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_74257 = sdiv_up64(min_res_66402, tile_sizze_74256);
                                
                                if (memblock_alloc_device(ctx, &mem_75826, bytes_75825, "mem_75826")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75828, bytes_75825, "mem_75828")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76664 = sext_i64_i32(sdiv_up64(tile_sizze_74256, tile_sizze_74256));
                                int32_t virt_num_tblocks_76665 = sext_i64_i32(ldim_74257);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74254(ctx, ldim_74257, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74255, 1, 1, bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8) + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8)) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_74257, num_whole_tiles_74272, residual_input_74496, cond_74497, binop_x_74513, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75826.mem, mem_75828.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75826, "mem_75826") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75828, "mem_75828") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75893, bytes_75470, "mem_75893")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75757.mem, ctx_param_ext_75755, (int64_t []) {ctx_param_ext_75756}, (int64_t []) {nR_52195})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75891.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75895, bytes_75470, "mem_75895")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75754.mem, ctx_param_ext_75752, (int64_t []) {ctx_param_ext_75753}, (int64_t []) {nR_52195})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
                                return 1;
                            
                            int64_t tmp_66488 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_75895, "mem_75895") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_75893, "mem_75893") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66488;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75907, &ext_mem_75901, "ext_mem_75901") != 0)
                            return 1;
                        ext_75906 = ext_75900;
                        ext_75905 = ext_75899;
                        if (memblock_set_device(ctx, &ext_mem_75904, &ext_mem_75898, "ext_mem_75898") != 0)
                            return 1;
                        ext_75903 = ext_75897;
                        ext_75902 = ext_75896;
                        loopres_66427 = loopres_f_res_66432;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
                        return 1;
                    
                    bool loop_cond_66489 = slt64(loopres_66427, numIter_66379);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76610, &ext_mem_75907, "ext_mem_75907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76611, &ext_mem_75904, "ext_mem_75904") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76612 = ext_75906;
                    int64_t ctx_param_ext_tmp_76613 = ext_75905;
                    int64_t ctx_param_ext_tmp_76614 = ext_75903;
                    int64_t ctx_param_ext_tmp_76615 = ext_75902;
                    bool loop_while_tmp_76616 = loop_cond_66489;
                    int64_t p_tmp_76617 = loopres_66427;
                    
                    if (memblock_set_device(ctx, &mem_param_75754, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75757, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
                        return 1;
                    ctx_param_ext_75752 = ctx_param_ext_tmp_76612;
                    ctx_param_ext_75753 = ctx_param_ext_tmp_76613;
                    ctx_param_ext_75755 = ctx_param_ext_tmp_76614;
                    ctx_param_ext_75756 = ctx_param_ext_tmp_76615;
                    loop_while_66396 = loop_while_tmp_76616;
                    p_66397 = p_tmp_76617;
                }
                if (memblock_set_device(ctx, &ext_mem_75913, &mem_param_75754, "mem_param_75754") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75912, &mem_param_75757, "mem_param_75757") != 0)
                    return 1;
                ext_75911 = ctx_param_ext_75752;
                ext_75910 = ctx_param_ext_75753;
                ext_75909 = ctx_param_ext_75755;
                ext_75908 = ctx_param_ext_75756;
                defunc_0_find_joinTuples_res_66392 = loop_while_66396;
                defunc_0_find_joinTuples_res_66393 = p_66397;
                if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75913, "ext_mem_75913") != 0)
                    return 1;
                ext_75918 = ext_75911;
                ext_75917 = ext_75910;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75912, "ext_mem_75912") != 0)
                    return 1;
                ext_75915 = ext_75909;
                ext_75914 = ext_75908;
            } else {
                if (memblock_alloc_device(ctx, &mem_75486, bytes_75485, "mem_75486")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75486, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_52195) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75488, bytes_75485, "mem_75488")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75488, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_52195) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75490, (int64_t) 4, "mem_75490")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76691(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_75467.mem, mem_75490.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75490, "mem_75490") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75489, (int64_t) 4, "mem_75489")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_75489, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75489, "mem_75489") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75492, (int64_t) 1, "mem_75492")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_floatzigpuseq_76697(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75483.mem, ext_mem_75491.mem, mem_75492.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
                    return 1;
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75494, (int64_t) 4, "mem_75494")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76703(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_52195, y_64988, tR_mem_75467.mem, mem_75483.mem, mem_75492.mem, mem_75494.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75494, "mem_75494") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75493, (int64_t) 4, "mem_75493")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_f32(ctx, mem_75493, (int64_t) 1, 0.0F) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75493, "mem_75493") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_65003;
                int64_t defunc_0_windowed_partitionFunc_res_65004;
                bool loop_while_65007;
                int64_t p_65008;
                
                loop_while_65007 = loop_cond_64985;
                p_65008 = (int64_t) 0;
                while (loop_while_65007) {
                    int64_t start_65011 = mul64(partitionsPerWindow_52201, p_65008);
                    int64_t end_65012 = add64(partitionsPerWindow_52201, start_65011);
                    int64_t max_res_65013 = smax64((int64_t) 1, start_65011);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014 = sub64(end_65012, max_res_65013);
                    bool bounds_invalid_upwards_65015 = slt64(end_65012, max_res_65013);
                    bool valid_65016 = !bounds_invalid_upwards_65015;
                    bool range_valid_c_65017;
                    
                    if (!valid_65016) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_65013, "..<", (long long) end_65012, " is invalid.", "-> #0  ftbasics.fut:153:43-68\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_65020 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 == (int64_t) 0;
                    bool nonzzero_65021 = !zzero_65020;
                    bool nonzzero_cert_65022;
                    
                    if (!nonzzero_65021) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:156:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_75503 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool cond_65223 = slt64((int64_t) 0, start_65011);
                    int64_t conc_tmp_65224 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    int64_t ret_65225;
                    
                    if (cond_65223) {
                        ret_65225 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    } else {
                        ret_65225 = conc_tmp_65224;
                    }
                    
                    bool eq_x_y_65233 = partitionsPerWindow_52201 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool eq_x_zz_65234 = partitionsPerWindow_52201 == conc_tmp_65224;
                    bool p_and_eq_x_y_65235 = cond_65223 && eq_x_y_65233;
                    bool not_p_65236 = !cond_65223;
                    bool p_and_eq_x_y_65237 = eq_x_zz_65234 && not_p_65236;
                    bool dim_match_65238 = p_and_eq_x_y_65235 || p_and_eq_x_y_65237;
                    bool empty_or_match_cert_65239;
                    
                    if (!dim_match_65238) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_65225, "] cannot match shape of type `[", (long long) partitionsPerWindow_52201, "](i64, i64)`.", "-> #0  ftbasics.fut:217:5-222:49\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_65241 = add64(m_64987, start_65011);
                    bool zzero_leq_i_p_m_t_s_65242 = sle64((int64_t) 0, i_p_m_t_s_65241);
                    bool i_p_m_t_s_leq_w_65243 = slt64(i_p_m_t_s_65241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool zzero_lte_i_65244 = sle64((int64_t) 0, start_65011);
                    bool i_lte_j_65245 = sle64(start_65011, end_65012);
                    bool y_65246 = i_p_m_t_s_leq_w_65243 && zzero_lte_i_65244;
                    bool y_65247 = zzero_leq_i_p_m_t_s_65242 && y_65246;
                    bool forwards_ok_65248 = i_lte_j_65245 && y_65247;
                    bool ok_or_empty_65249 = empty_slice_64986 || forwards_ok_65248;
                    bool index_certs_65250;
                    
                    if (!ok_or_empty_65249) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65011, ":", (long long) end_65012, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:108:37-74\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_65019 = add64(nR_52195, nR_52195);
                    int64_t segmap_usable_groups_71651 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_71650);
                    
                    if (memblock_alloc_device(ctx, &mem_75504, bytes_75503, "mem_75504")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_75506, bytes_75503, "mem_75506")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_76713 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_71650));
                    
                    {
                        err = gpu_kernel_inner_SMJ_floatzisegmap_71655(ctx, segmap_usable_groups_71651, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71443, 1, 1, (int64_t) 0, nR_52195, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, max_res_65013, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, zt_rhs_65019, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75495.mem, mem_75504.mem, mem_75506.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_75508 = (int64_t) 8 * ret_65225;
                    
                    if (cond_65223) {
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75504, "mem_75504") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75506, "mem_75506") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75511, bytes_75508, "mem_75511")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_75511, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_75509, bytes_75508, "mem_75509")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_76734 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75504.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        
                        int64_t tmp_offs_76735 = (int64_t) 0;
                        
                        if (!(tmp_offs_76735 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_76735 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75506.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76735 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75509, "mem_75509") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75511, "mem_75511") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
                        return 1;
                    
                    int64_t tmp_65240 = add64((int64_t) 1, p_65008);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75486.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75488.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
                        return 1;
                    
                    bool loop_cond_65253 = slt64(tmp_65240, numberOfWindows_52202);
                    bool loop_while_tmp_76709 = loop_cond_65253;
                    int64_t p_tmp_76710 = tmp_65240;
                    
                    loop_while_65007 = loop_while_tmp_76709;
                    p_65008 = p_tmp_76710;
                }
                defunc_0_windowed_partitionFunc_res_65003 = loop_while_65007;
                defunc_0_windowed_partitionFunc_res_65004 = p_65008;
                if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_75522, bytes_75485, "mem_75522")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75524, bytes_75485, "mem_75524")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_76736 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_72024));
                
                {
                    err = gpu_kernel_inner_SMJ_floatzisegmap_72029(ctx, segmap_usable_groups_72025, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_71860, 1, 1, (int64_t) 0, nR_52195, gt_rhs_64823, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zeze_rhs_65256, tR_mem_75467.mem, tS_mem_75468.mem, mem_75486.mem, mem_75488.mem, mem_75522.mem, mem_75524.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_75746;
                int64_t ext_75745;
                int64_t ext_75744;
                int64_t ext_75743;
                bool defunc_0_join_chunks_res_65412;
                int64_t defunc_0_join_chunks_res_65413;
                bool loop_while_65416;
                int64_t p_65417;
                int64_t ctx_param_ext_75525;
                int64_t ctx_param_ext_75526;
                int64_t ctx_param_ext_75528;
                int64_t ctx_param_ext_75529;
                
                if (memblock_set_device(ctx, &mem_param_75527, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75530, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75525 = (int64_t) 0;
                ctx_param_ext_75526 = (int64_t) 1;
                ctx_param_ext_75528 = (int64_t) 0;
                ctx_param_ext_75529 = (int64_t) 1;
                loop_while_65416 = loop_cond_65411;
                p_65417 = (int64_t) 0;
                while (loop_while_65416) {
                    bool x_65420 = sle64((int64_t) 0, p_65417);
                    bool y_65421 = slt64(p_65417, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65422 = x_65420 && y_65421;
                    bool index_certs_65423;
                    
                    if (!bounds_check_65422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:186:22-34\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_77389;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77389, mem_75522.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65424 = read_res_77389;
                    int64_t read_res_77390;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77390, mem_75524.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65425 = read_res_77390;
                    int64_t min_res_65426 = smin64(zeze_rhs_65256, loopres_65425);
                    bool cond_65427 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, loopres_65424);
                    bool cond_65431 = slt64(min_res_65426, (int64_t) 0);
                    bool protect_assert_disj_65433 = bounds_check_65422 || cond_65431;
                    bool protect_assert_disj_76139 = cond_65427 || protect_assert_disj_65433;
                    bool index_certs_65434;
                    
                    if (!protect_assert_disj_76139) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:190:19-32\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_65437 = add64((int64_t) 1, p_65417);
                    bool cond_65438 = zeze_lhs_65437 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    bool x_65440 = sle64((int64_t) 0, zeze_lhs_65437);
                    bool y_65441 = slt64(zeze_lhs_65437, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65442 = x_65440 && y_65441;
                    bool protect_assert_disj_65443 = cond_65438 || bounds_check_65442;
                    bool protect_assert_disj_65444 = cond_65431 || protect_assert_disj_65443;
                    bool protect_assert_disj_76142 = cond_65427 || protect_assert_disj_65444;
                    bool index_certs_65445;
                    
                    if (!protect_assert_disj_76142) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65437, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:191:49-64\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_76136 = !cond_65427;
                    bool x_65432 = !cond_65431;
                    bool protect_cond_conj_76140 = x_65432 && x_76136;
                    int64_t loopres_f_res_f_res_65435;
                    
                    if (protect_cond_conj_76140) {
                        int64_t read_res_77391;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77391, mem_75486.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66705 = read_res_77391;
                        
                        loopres_f_res_f_res_65435 = x_66705;
                    } else {
                        loopres_f_res_f_res_65435 = (int64_t) 0;
                    }
                    
                    bool x_65439 = !cond_65438;
                    bool protect_cond_conj_65446 = x_65432 && x_65439;
                    bool protect_cond_conj_76143 = protect_cond_conj_65446 && x_76136;
                    int64_t r_end_f_res_65447;
                    
                    if (protect_cond_conj_76143) {
                        int64_t read_res_77392;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77392, mem_75486.mem, zeze_lhs_65437 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66706 = read_res_77392;
                        
                        r_end_f_res_65447 = x_66706;
                    } else {
                        r_end_f_res_65447 = (int64_t) 0;
                    }
                    
                    int64_t r_end_65449;
                    
                    if (cond_65438) {
                        r_end_65449 = nR_52195;
                    } else {
                        r_end_65449 = r_end_f_res_65447;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 = sub64(r_end_65449, loopres_f_res_f_res_65435);
                    int64_t ext_75735;
                    
                    if (cond_65431) {
                        ext_75735 = ctx_param_ext_75525;
                    } else {
                        ext_75735 = (int64_t) 0;
                    }
                    
                    int64_t ext_75734;
                    
                    if (cond_65431) {
                        ext_75734 = ctx_param_ext_75526;
                    } else {
                        ext_75734 = (int64_t) 1;
                    }
                    
                    int64_t ext_75732;
                    
                    if (cond_65431) {
                        ext_75732 = ctx_param_ext_75528;
                    } else {
                        ext_75732 = (int64_t) 0;
                    }
                    
                    int64_t ext_75731;
                    
                    if (cond_65431) {
                        ext_75731 = ctx_param_ext_75529;
                    } else {
                        ext_75731 = (int64_t) 1;
                    }
                    
                    int64_t bytes_75531 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;
                    int64_t ext_75741;
                    
                    if (cond_65427) {
                        ext_75741 = ctx_param_ext_75525;
                    } else {
                        ext_75741 = ext_75735;
                    }
                    
                    int64_t ext_75740;
                    
                    if (cond_65427) {
                        ext_75740 = ctx_param_ext_75526;
                    } else {
                        ext_75740 = ext_75734;
                    }
                    
                    int64_t ext_75738;
                    
                    if (cond_65427) {
                        ext_75738 = ctx_param_ext_75528;
                    } else {
                        ext_75738 = ext_75732;
                    }
                    
                    int64_t ext_75737;
                    
                    if (cond_65427) {
                        ext_75737 = ctx_param_ext_75529;
                    } else {
                        ext_75737 = ext_75731;
                    }
                    
                    int64_t loopres_65428;
                    
                    if (cond_65427) {
                        loopres_65428 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    } else {
                        loopres_65428 = zeze_lhs_65437;
                    }
                    if (cond_65427) {
                        if (memblock_set_device(ctx, &ext_mem_75742, &mem_param_75527, "mem_param_75527") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &mem_param_75530, "mem_param_75530") != 0)
                            return 1;
                    } else {
                        if (cond_65431) {
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_param_75527, "mem_param_75527") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_param_75530, "mem_param_75530") != 0)
                                return 1;
                        } else {
                            bool empty_slice_65453 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 == (int64_t) 0;
                            int64_t m_65454 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 1);
                            int64_t i_p_m_t_s_65455 = add64(loopres_f_res_f_res_65435, m_65454);
                            bool zzero_leq_i_p_m_t_s_65456 = sle64((int64_t) 0, i_p_m_t_s_65455);
                            bool i_p_m_t_s_leq_w_65457 = slt64(i_p_m_t_s_65455, nR_52195);
                            bool zzero_lte_i_65458 = sle64((int64_t) 0, loopres_f_res_f_res_65435);
                            bool i_lte_j_65459 = sle64(loopres_f_res_f_res_65435, r_end_65449);
                            bool y_65460 = i_p_m_t_s_leq_w_65457 && zzero_lte_i_65458;
                            bool y_65461 = zzero_leq_i_p_m_t_s_65456 && y_65460;
                            bool forwards_ok_65462 = i_lte_j_65459 && y_65461;
                            bool ok_or_empty_65463 = empty_slice_65453 || forwards_ok_65462;
                            bool index_certs_65464;
                            
                            if (!ok_or_empty_65463) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_65435, ":", (long long) r_end_65449, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftSMJ.fut:192:16-33\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_65467 = sle64(loopres_65424, min_res_65426);
                            bool loop_not_taken_65472 = !loop_cond_65467;
                            bool protect_assert_disj_65473 = loop_not_taken_65472 || nonzzero_66377;
                            bool nonzzero_cert_65474;
                            
                            if (!protect_assert_disj_65473) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75532, bytes_75531, "mem_75532")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75532, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75534, bytes_75531, "mem_75534")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75534, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_65468 = add64(extParallelism_52203, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                            int64_t zs_lhs_65469 = sub64(zm_lhs_65468, (int64_t) 1);
                            int64_t numIter_65475 = sdiv_safe64(zs_lhs_65469, extParallelism_52203);
                            bool loop_cond_65476 = slt64((int64_t) 0, numIter_65475);
                            bool loop_not_taken_65477 = !loop_cond_65476;
                            int64_t segmap_tblock_sizze_72377;
                            
                            segmap_tblock_sizze_72377 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72367;
                            
                            int64_t segmap_usable_groups_72378 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72377);
                            int64_t segmap_tblock_sizze_72398;
                            
                            segmap_tblock_sizze_72398 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72389;
                            
                            int64_t segmap_usable_groups_72399 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72398);
                            
                            if (memblock_alloc_device(ctx, &mem_75553, (int64_t) 4, "mem_75553")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75554, (int64_t) 4, "mem_75554")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75557, (int64_t) 1, "mem_75557")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_65478;
                            int64_t loopres_f_res_f_res_65479;
                            bool loop_while_65482;
                            int64_t dp_65483;
                            
                            if (memblock_set_device(ctx, &mem_param_75537, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_75540, &mem_75532, "mem_75532") != 0)
                                return 1;
                            loop_while_65482 = loop_cond_65467;
                            dp_65483 = loopres_65424;
                            while (loop_while_65482) {
                                bool x_65486 = sle64((int64_t) 0, dp_65483);
                                bool y_65487 = slt64(dp_65483, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65488 = x_65486 && y_65487;
                                bool index_certs_65489;
                                
                                if (!bounds_check_65488) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_65483, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:196:21-38\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_77393;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_77393, mem_75488.mem, dp_65483 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_65490 = read_res_77393;
                                int64_t zeze_lhs_65491 = add64((int64_t) 1, dp_65483);
                                bool cond_65492 = zeze_lhs_65491 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                                bool x_65493 = !cond_65492;
                                bool x_65494 = sle64((int64_t) 0, zeze_lhs_65491);
                                bool y_65495 = slt64(zeze_lhs_65491, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65496 = x_65494 && y_65495;
                                bool protect_assert_disj_65497 = cond_65492 || bounds_check_65496;
                                bool index_certs_65498;
                                
                                if (!protect_assert_disj_65497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65491, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:197:55-74\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_65499;
                                
                                if (x_65493) {
                                    int64_t read_res_77394;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77394, mem_75488.mem, zeze_lhs_65491 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_66707 = read_res_77394;
                                    
                                    s_end_f_res_65499 = x_66707;
                                } else {
                                    s_end_f_res_65499 = (int64_t) 0;
                                }
                                
                                int64_t s_end_65501;
                                
                                if (cond_65492) {
                                    s_end_65501 = nR_52195;
                                } else {
                                    s_end_65501 = s_end_f_res_65499;
                                }
                                
                                int64_t j_m_i_65502 = sub64(s_end_65501, loopres_65490);
                                bool empty_slice_65503 = j_m_i_65502 == (int64_t) 0;
                                int64_t m_65504 = sub64(j_m_i_65502, (int64_t) 1);
                                int64_t i_p_m_t_s_65505 = add64(loopres_65490, m_65504);
                                bool zzero_leq_i_p_m_t_s_65506 = sle64((int64_t) 0, i_p_m_t_s_65505);
                                bool i_p_m_t_s_leq_w_65507 = slt64(i_p_m_t_s_65505, nR_52195);
                                bool zzero_lte_i_65508 = sle64((int64_t) 0, loopres_65490);
                                bool i_lte_j_65509 = sle64(loopres_65490, s_end_65501);
                                bool y_65510 = i_p_m_t_s_leq_w_65507 && zzero_lte_i_65508;
                                bool y_65511 = zzero_leq_i_p_m_t_s_65506 && y_65510;
                                bool forwards_ok_65512 = i_lte_j_65509 && y_65511;
                                bool ok_or_empty_65513 = empty_slice_65503 || forwards_ok_65512;
                                bool index_certs_65514;
                                
                                if (!ok_or_empty_65513) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65490, ":", (long long) s_end_65501, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  ftSMJ.fut:198:18-35\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_65517 = slt64((int64_t) 0, j_m_i_65502);
                                bool loop_not_taken_65518 = !cond_65517;
                                bool x_65519 = sle64((int64_t) 0, m_65504);
                                bool y_65520 = slt64(m_65504, j_m_i_65502);
                                bool bounds_check_65524 = x_65519 && y_65520;
                                bool protect_assert_disj_65525 = loop_not_taken_65518 || bounds_check_65524;
                                bool protect_assert_disj_65526 = loop_not_taken_65477 || protect_assert_disj_65525;
                                bool index_certs_65527;
                                
                                if (!protect_assert_disj_65526) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65504, "] out of bounds for array of shape [", (long long) j_m_i_65502, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_65911 = tS_start_64840 + loopres_65490;
                                int64_t find_joinTuples_arg3_65516 = add64(join_chunks_arg3_64981, loopres_65490);
                                bool protect_cond_conj_65521 = loop_cond_65476 && cond_65517;
                                
                                if (protect_cond_conj_65521) {
                                    if (memblock_alloc_device(ctx, &mem_75542, (int64_t) 4, "mem_75542")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76765(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65911, tS_mem_75468.mem, mem_75542.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75542, "mem_75542") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75541, (int64_t) 4, "mem_75541")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f32(ctx, mem_75541, (int64_t) 1, 0.0F) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75541, "mem_75541") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_65521) {
                                    int64_t slice_66709 = tS_start_64840 + i_p_m_t_s_65505;
                                    
                                    if (memblock_alloc_device(ctx, &mem_75545, (int64_t) 4, "mem_75545")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76771(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_66709, tS_mem_75468.mem, mem_75545.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75545, "mem_75545") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75544, (int64_t) 4, "mem_75544")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_f32(ctx, mem_75544, (int64_t) 1, 0.0F) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75544, "mem_75544") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_75559 = (int64_t) 4 * j_m_i_65502;
                                int64_t ext_75706;
                                int64_t ext_75705;
                                int64_t ext_75704;
                                int64_t ext_75703;
                                bool defunc_0_find_joinTuples_res_65530;
                                int64_t defunc_0_find_joinTuples_res_65531;
                                bool loop_while_65534;
                                int64_t p_65535;
                                int64_t ctx_param_ext_75547;
                                int64_t ctx_param_ext_75548;
                                int64_t ctx_param_ext_75550;
                                int64_t ctx_param_ext_75551;
                                
                                if (memblock_set_device(ctx, &mem_param_75549, &mem_75534, "mem_75534") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75552, &mem_75532, "mem_75532") != 0)
                                    return 1;
                                ctx_param_ext_75547 = (int64_t) 0;
                                ctx_param_ext_75548 = (int64_t) 1;
                                ctx_param_ext_75550 = (int64_t) 0;
                                ctx_param_ext_75551 = (int64_t) 1;
                                loop_while_65534 = loop_cond_65476;
                                p_65535 = (int64_t) 0;
                                while (loop_while_65534) {
                                    int64_t start_65538 = mul64(extParallelism_52203, p_65535);
                                    int64_t min_arg1_65539 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, start_65538);
                                    int64_t min_res_65540 = smin64(extParallelism_52203, min_arg1_65539);
                                    int64_t iter_R_65541 = add64(start_65538, min_res_65540);
                                    bool empty_slice_65542 = min_res_65540 == (int64_t) 0;
                                    int64_t m_65543 = sub64(min_res_65540, (int64_t) 1);
                                    int64_t i_p_m_t_s_65544 = add64(start_65538, m_65543);
                                    bool zzero_leq_i_p_m_t_s_65545 = sle64((int64_t) 0, i_p_m_t_s_65544);
                                    bool i_p_m_t_s_leq_w_65546 = slt64(i_p_m_t_s_65544, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                                    bool zzero_lte_i_65547 = sle64((int64_t) 0, start_65538);
                                    bool i_lte_j_65548 = sle64(start_65538, iter_R_65541);
                                    bool y_65549 = i_p_m_t_s_leq_w_65546 && zzero_lte_i_65547;
                                    bool y_65550 = zzero_leq_i_p_m_t_s_65545 && y_65549;
                                    bool forwards_ok_65551 = i_lte_j_65548 && y_65550;
                                    bool ok_or_empty_65552 = empty_slice_65542 || forwards_ok_65551;
                                    bool index_certs_65553;
                                    
                                    if (!ok_or_empty_65552) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65538, ":", (long long) iter_R_65541, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65560 = slt64(m_65543, min_res_65540);
                                    bool x_65559 = sle64((int64_t) 0, m_65543);
                                    bool bounds_check_65561 = x_65559 && y_65560;
                                    bool index_certs_65562;
                                    
                                    if (!bounds_check_65561) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65543, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65556 = slt64((int64_t) 0, min_res_65540);
                                    bool index_certs_65557;
                                    
                                    if (!y_65556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:389:133-136\n   #2  ftSMJ.fut:378:1-389:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_65554 = loopres_f_res_f_res_65435 + start_65538;
                                    int64_t slice_65563 = loopres_f_res_f_res_65435 + i_p_m_t_s_65544;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76787(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65554, slice_65563, tR_mem_75467.mem, mem_75553.mem, mem_75554.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75555, &ext_mem_75546, "ext_mem_75546") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75555, &mem_75553, "mem_75553") != 0)
                                        return 1;
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75556, &ext_mem_75543, "ext_mem_75543") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75556, &mem_75554, "mem_75554") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_floatzigpuseq_76793(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75554.mem, ext_mem_75555.mem, mem_75557.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
                                        return 1;
                                    
                                    bool read_res_77395;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77395, mem_75557.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_65567 = read_res_77395;
                                    int64_t ext_75701;
                                    int64_t ext_75700;
                                    int64_t ext_75698;
                                    int64_t ext_75697;
                                    int64_t loopres_65568;
                                    
                                    if (defunc_0_gt_res_65567) {
                                        if (memblock_set_device(ctx, &ext_mem_75702, &mem_param_75549, "mem_param_75549") != 0)
                                            return 1;
                                        ext_75701 = ctx_param_ext_75547;
                                        ext_75700 = ctx_param_ext_75548;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &mem_param_75552, "mem_param_75552") != 0)
                                            return 1;
                                        ext_75698 = ctx_param_ext_75550;
                                        ext_75697 = ctx_param_ext_75551;
                                        loopres_65568 = numIter_65475;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_75558, (int64_t) 1, "mem_75558")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_floatzigpuseq_76799(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75553.mem, ext_mem_75556.mem, mem_75558.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_77396;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_77396, mem_75558.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_65571 = read_res_77396;
                                        
                                        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
                                            return 1;
                                        
                                        int64_t ext_75695;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75695 = ctx_param_ext_75547;
                                        } else {
                                            ext_75695 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75694;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75694 = ctx_param_ext_75548;
                                        } else {
                                            ext_75694 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_75692;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75692 = ctx_param_ext_75550;
                                        } else {
                                            ext_75692 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75691;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75691 = ctx_param_ext_75551;
                                        } else {
                                            ext_75691 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_65572;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            int64_t tmp_66713 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_param_75549, "mem_param_75549") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_param_75552, "mem_param_75552") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_66713;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_75560, bytes_75559, "mem_75560")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75560.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, slice_65911, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65502})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_7791(ctx, &ext_mem_75562, mem_75560, j_m_i_65502, find_joinTuples_arg3_65516) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_72189;
                                            
                                            suff_outer_par_72189 = *ctx->tuning_params.inner_SMJ_floatzisuff_outer_par_1 <= min_res_65540;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_float.suff_outer_par_1", (long) min_res_65540, suff_outer_par_72189 ? "true" : "false");
                                            
                                            int64_t tile_sizze_74966;
                                            
                                            tile_sizze_74966 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965;
                                            
                                            int64_t tile_sizze_74611;
                                            
                                            tile_sizze_74611 = *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610;
                                            
                                            int64_t num_whole_tiles_74982 = squot_safe64(j_m_i_65502, tile_sizze_74966);
                                            int64_t residual_input_75206 = srem_safe64(j_m_i_65502, tile_sizze_74966);
                                            bool cond_75207 = residual_input_75206 == (int64_t) 0;
                                            int64_t binop_x_75223 = tile_sizze_74966 * num_whole_tiles_74982;
                                            int64_t bytes_75620 = (int64_t) 8 * min_res_65540;
                                            int64_t bytes_75583 = (int64_t) 8 * tile_sizze_74966;
                                            int64_t bytes_75585 = (int64_t) 4 * tile_sizze_74966;
                                            int64_t num_whole_tiles_74627 = squot_safe64(j_m_i_65502, tile_sizze_74611);
                                            int64_t residual_input_74851 = srem_safe64(j_m_i_65502, tile_sizze_74611);
                                            bool cond_74852 = residual_input_74851 == (int64_t) 0;
                                            int64_t binop_x_74868 = tile_sizze_74611 * num_whole_tiles_74627;
                                            int64_t bytes_75644 = (int64_t) 8 * tile_sizze_74611;
                                            int64_t bytes_75646 = (int64_t) 4 * tile_sizze_74611;
                                            int64_t shared_memory_capacity_76857;
                                            
                                            shared_memory_capacity_76857 = ctx->max_shared_memory;
                                            if (suff_outer_par_72189 && sle64(sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75646, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76857)) {
                                                int64_t ldim_74612 = sdiv_up64(min_res_65540, tile_sizze_74611);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75682, bytes_75620, "mem_75682")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75684, bytes_75620, "mem_75684")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76805 = sext_i64_i32(sdiv_up64(tile_sizze_74611, tile_sizze_74611));
                                                int32_t virt_num_tblocks_76806 = sext_i64_i32(ldim_74612);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74609(ctx, ldim_74612, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74610, 1, 1, bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8) + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8)) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74612, num_whole_tiles_74627, residual_input_74851, cond_74852, binop_x_74868, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75682.mem, mem_75684.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75682, "mem_75682") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75684, "mem_75684") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_74967 = sdiv_up64(min_res_65540, tile_sizze_74966);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75621, bytes_75620, "mem_75621")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75623, bytes_75620, "mem_75623")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76831 = sext_i64_i32(sdiv_up64(tile_sizze_74966, tile_sizze_74966));
                                                int32_t virt_num_tblocks_76832 = sext_i64_i32(ldim_74967);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_floatzisegmap_intrablock_74964(ctx, ldim_74967, 1, 1, *ctx->tuning_params.inner_SMJ_floatzitile_sizze_74965, 1, 1, bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8) + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8)) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74967, num_whole_tiles_74982, residual_input_75206, cond_75207, binop_x_75223, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75621.mem, mem_75623.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75621, "mem_75621") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75623, "mem_75623") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75688, bytes_75531, "mem_75688")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75552.mem, ctx_param_ext_75550, (int64_t []) {ctx_param_ext_75551}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75686.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75690, bytes_75531, "mem_75690")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75549.mem, ctx_param_ext_75547, (int64_t []) {ctx_param_ext_75548}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
                                                return 1;
                                            
                                            int64_t tmp_65619 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_75690, "mem_75690") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_75688, "mem_75688") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_65619;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_75702, &ext_mem_75696, "ext_mem_75696") != 0)
                                            return 1;
                                        ext_75701 = ext_75695;
                                        ext_75700 = ext_75694;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &ext_mem_75693, "ext_mem_75693") != 0)
                                            return 1;
                                        ext_75698 = ext_75692;
                                        ext_75697 = ext_75691;
                                        loopres_65568 = loopres_f_res_65572;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
                                        return 1;
                                    
                                    bool loop_cond_65620 = slt64(loopres_65568, numIter_65475);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_76777, &ext_mem_75702, "ext_mem_75702") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_76778, &ext_mem_75699, "ext_mem_75699") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_76779 = ext_75701;
                                    int64_t ctx_param_ext_tmp_76780 = ext_75700;
                                    int64_t ctx_param_ext_tmp_76781 = ext_75698;
                                    int64_t ctx_param_ext_tmp_76782 = ext_75697;
                                    bool loop_while_tmp_76783 = loop_cond_65620;
                                    int64_t p_tmp_76784 = loopres_65568;
                                    
                                    if (memblock_set_device(ctx, &mem_param_75549, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_75552, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
                                        return 1;
                                    ctx_param_ext_75547 = ctx_param_ext_tmp_76779;
                                    ctx_param_ext_75548 = ctx_param_ext_tmp_76780;
                                    ctx_param_ext_75550 = ctx_param_ext_tmp_76781;
                                    ctx_param_ext_75551 = ctx_param_ext_tmp_76782;
                                    loop_while_65534 = loop_while_tmp_76783;
                                    p_65535 = p_tmp_76784;
                                }
                                if (memblock_set_device(ctx, &ext_mem_75708, &mem_param_75549, "mem_param_75549") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75707, &mem_param_75552, "mem_param_75552") != 0)
                                    return 1;
                                ext_75706 = ctx_param_ext_75547;
                                ext_75705 = ctx_param_ext_75548;
                                ext_75704 = ctx_param_ext_75550;
                                ext_75703 = ctx_param_ext_75551;
                                defunc_0_find_joinTuples_res_65530 = loop_while_65534;
                                defunc_0_find_joinTuples_res_65531 = p_65535;
                                if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75711, bytes_75531, "mem_75711")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76858 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72377));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_72381(ctx, segmap_usable_groups_72378, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72367, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75703, ext_75704, mem_param_75540.mem, ext_mem_75707.mem, mem_75711.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75714, bytes_75531, "mem_75714")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76867 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72398));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_floatzisegmap_72402(ctx, segmap_usable_groups_72399, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72389, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75705, ext_75706, mem_param_75537.mem, ext_mem_75708.mem, mem_75714.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
                                    return 1;
                                
                                bool loop_cond_65630 = sle64(zeze_lhs_65491, min_res_65426);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_76759, &mem_75714, "mem_75714") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_76760, &mem_75711, "mem_75711") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_76761 = loop_cond_65630;
                                int64_t dp_tmp_76762 = zeze_lhs_65491;
                                
                                if (memblock_set_device(ctx, &mem_param_75537, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75540, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
                                    return 1;
                                loop_while_65482 = loop_while_tmp_76761;
                                dp_65483 = dp_tmp_76762;
                            }
                            if (memblock_set_device(ctx, &ext_mem_75720, &mem_param_75537, "mem_param_75537") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75719, &mem_param_75540, "mem_param_75540") != 0)
                                return 1;
                            loopres_f_res_f_res_65478 = loop_while_65482;
                            loopres_f_res_f_res_65479 = dp_65483;
                            if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_72419;
                            
                            segmap_tblock_sizze_72419 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72409;
                            
                            int64_t segmap_usable_groups_72420 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72419);
                            
                            if (memblock_alloc_device(ctx, &mem_75723, bytes_75531, "mem_75723")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76876 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72419));
                            
                            {
                                err = gpu_kernel_inner_SMJ_floatzisegmap_72423(ctx, segmap_usable_groups_72420, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72409, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75528, ctx_param_ext_75529, mem_param_75530.mem, ext_mem_75719.mem, mem_75723.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_72440;
                            
                            segmap_tblock_sizze_72440 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72431;
                            
                            int64_t segmap_usable_groups_72441 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72440);
                            
                            if (memblock_alloc_device(ctx, &mem_75726, bytes_75531, "mem_75726")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76885 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_72440));
                            
                            {
                                err = gpu_kernel_inner_SMJ_floatzisegmap_72444(ctx, segmap_usable_groups_72441, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72431, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75525, ctx_param_ext_75526, mem_param_75527.mem, ext_mem_75720.mem, mem_75726.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75728, bytes_75470, "mem_75728")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75530.mem, ctx_param_ext_75528, (int64_t []) {ctx_param_ext_75529}, (int64_t []) {nR_52195})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75723.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75730, bytes_75470, "mem_75730")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75527.mem, ctx_param_ext_75525, (int64_t []) {ctx_param_ext_75526}, (int64_t []) {nR_52195})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_75730, "mem_75730") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_75728, "mem_75728") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75742, &ext_mem_75736, "ext_mem_75736") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &ext_mem_75733, "ext_mem_75733") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_65646 = slt64(loopres_65428, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76749, &ext_mem_75742, "ext_mem_75742") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76750, &ext_mem_75739, "ext_mem_75739") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76751 = ext_75741;
                    int64_t ctx_param_ext_tmp_76752 = ext_75740;
                    int64_t ctx_param_ext_tmp_76753 = ext_75738;
                    int64_t ctx_param_ext_tmp_76754 = ext_75737;
                    bool loop_while_tmp_76755 = loop_cond_65646;
                    int64_t p_tmp_76756 = loopres_65428;
                    
                    if (memblock_set_device(ctx, &mem_param_75527, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75530, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
                        return 1;
                    ctx_param_ext_75525 = ctx_param_ext_tmp_76751;
                    ctx_param_ext_75526 = ctx_param_ext_tmp_76752;
                    ctx_param_ext_75528 = ctx_param_ext_tmp_76753;
                    ctx_param_ext_75529 = ctx_param_ext_tmp_76754;
                    loop_while_65416 = loop_while_tmp_76755;
                    p_65417 = p_tmp_76756;
                }
                if (memblock_set_device(ctx, &ext_mem_75748, &mem_param_75527, "mem_param_75527") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75747, &mem_param_75530, "mem_param_75530") != 0)
                    return 1;
                ext_75746 = ctx_param_ext_75525;
                ext_75745 = ctx_param_ext_75526;
                ext_75744 = ctx_param_ext_75528;
                ext_75743 = ctx_param_ext_75529;
                defunc_0_join_chunks_res_65412 = loop_while_65416;
                defunc_0_join_chunks_res_65413 = p_65417;
                if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75748, "ext_mem_75748") != 0)
                    return 1;
                ext_75918 = ext_75746;
                ext_75917 = ext_75745;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75747, "ext_mem_75747") != 0)
                    return 1;
                ext_75915 = ext_75744;
                ext_75914 = ext_75743;
            }
            
            int64_t segmap_tblock_sizze_72461;
            
            segmap_tblock_sizze_72461 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72451;
            
            int64_t segmap_usable_groups_72462 = sdiv_up64(nR_52195, segmap_tblock_sizze_72461);
            
            if (memblock_alloc_device(ctx, &mem_75922, bytes_75470, "mem_75922")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76894 = sext_i64_i32(sdiv_up64(nR_52195, segmap_tblock_sizze_72461));
            
            {
                err = gpu_kernel_inner_SMJ_floatzisegmap_72465(ctx, segmap_usable_groups_72462, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72451, 1, 1, (int64_t) 0, nR_52195, ext_75914, ext_75915, mem_param_75482.mem, ext_mem_75916.mem, mem_75922.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_72482;
            
            segmap_tblock_sizze_72482 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72473;
            
            int64_t segmap_usable_groups_72483 = sdiv_up64(nR_52195, segmap_tblock_sizze_72482);
            
            if (memblock_alloc_device(ctx, &mem_75925, bytes_75470, "mem_75925")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76903 = sext_i64_i32(sdiv_up64(nR_52195, segmap_tblock_sizze_72482));
            
            {
                err = gpu_kernel_inner_SMJ_floatzisegmap_72486(ctx, segmap_usable_groups_72483, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72473, 1, 1, (int64_t) 0, nR_52195, ext_75917, ext_75918, mem_param_75479.mem, ext_mem_75919.mem, mem_75925.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_75926, (int64_t) 1, "mem_75926")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_floatzigpuseq_76912(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, i_p_m_t_s_64846, tR_mem_75467.mem, tS_mem_75468.mem, mem_75926.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_77397;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_77397, mem_75926.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_65663 = read_res_77397;
            
            if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
                return 1;
            
            int64_t nextIter_65664;
            
            if (defunc_0_leq_res_65663) {
                int64_t nextIter_t_res_66728 = add64((int64_t) 1, p_64837);
                
                nextIter_65664 = nextIter_t_res_66728;
            } else {
                nextIter_65664 = numIter_64817;
            }
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_75925, "mem_75925") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_75922, "mem_75922") != 0)
                return 1;
            loopres_64861 = nextIter_65664;
        }
        
        bool loop_cond_65666 = slt64(loopres_64861, numIter_64817);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76592, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76593, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        
        bool loop_while_tmp_76594 = loop_cond_65666;
        int64_t p_tmp_76595 = loopres_64861;
        
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75482, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        loop_while_64836 = loop_while_tmp_76594;
        p_64837 = p_tmp_76595;
    }
    if (memblock_set_device(ctx, &ext_mem_75938, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75937, &mem_param_75482, "mem_param_75482") != 0)
        return 1;
    defunc_0_mergeJoin_res_64832 = loop_while_64836;
    defunc_0_mergeJoin_res_64833 = p_64837;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_72492;
    
    segscan_tblock_sizze_72492 = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72491;
    
    int64_t num_tblocks_72494;
    int64_t max_num_tblocks_76918;
    
    max_num_tblocks_76918 = *ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_72493;
    num_tblocks_72494 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_52195, segscan_tblock_sizze_72492), max_num_tblocks_76918)));
    if (memblock_alloc_device(ctx, &mem_75941, bytes_75470, "mem_75941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75943, bytes_75470, "mem_75943")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_52195)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_76919;
        
        shared_memory_76919 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_76920;
        
        thread_block_sizze_76920 = ctx->max_thread_block_size;
        
        int64_t registers_76921;
        
        registers_76921 = ctx->max_registers;
        
        int64_t thread_block_sizze_76922;
        
        thread_block_sizze_76922 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_76923 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_76919, thread_block_sizze_76920), (int64_t) 8), squot64(squot64(registers_76921, thread_block_sizze_76922) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_76924 = sdiv_up64(nR_52195, segscan_tblock_sizze_72492 * chunk_sizze_76923);
        int64_t num_virt_threads_76925 = num_virt_blocks_76924 * segscan_tblock_sizze_72492;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_76923, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_76926, num_virt_blocks_76924, "status_flags_mem_76926")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_76926, num_virt_blocks_76924, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_76948, (int64_t) 8 * num_virt_blocks_76924, "aggregates_mem_76948")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_76950, (int64_t) 8 * num_virt_blocks_76924, "incprefixes_mem_76950")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzisegscan_72497(ctx, num_tblocks_72494, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72491, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72492), chunk_sizze_76923 * segscan_tblock_sizze_72492 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_72492), chunk_sizze_76923 * segscan_tblock_sizze_72492 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_52195, num_tblocks_72494, num_virt_blocks_76924, num_virt_threads_76925, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, status_flags_mem_76926.mem, aggregates_mem_76948.mem, incprefixes_mem_76950.mem, global_dynid_mem_76952.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_65682 = zzero_64814 || bounds_check_64826;
    bool index_certs_65683;
    
    if (!protect_assert_disj_65682) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65684;
    
    if (nonzzero_64815) {
        int64_t read_res_77398;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77398, mem_75941.mem, gt_rhs_64823 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66731 = read_res_77398;
        
        m_f_res_65684 = x_66731;
    } else {
        m_f_res_65684 = (int64_t) 0;
    }
    
    int64_t m_65686;
    
    if (zzero_64814) {
        m_65686 = (int64_t) 0;
    } else {
        m_65686 = m_f_res_65684;
    }
    
    int64_t m_65696 = sub64(m_65686, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65698 = slt64(m_65696, nR_52195);
    bool zzero_leq_i_p_m_t_s_65697 = sle64((int64_t) 0, m_65696);
    bool y_65700 = zzero_leq_i_p_m_t_s_65697 && i_p_m_t_s_leq_w_65698;
    bool i_lte_j_65699 = sle64((int64_t) 0, m_65686);
    bool forwards_ok_65701 = i_lte_j_65699 && y_65700;
    bool eq_x_zz_65693 = (int64_t) 0 == m_f_res_65684;
    bool p_and_eq_x_y_65694 = nonzzero_64815 && eq_x_zz_65693;
    bool empty_slice_65695 = zzero_64814 || p_and_eq_x_y_65694;
    bool ok_or_empty_65702 = empty_slice_65695 || forwards_ok_65701;
    bool index_certs_65703;
    
    if (!ok_or_empty_65702) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65686, "] out of bounds for array of shape [", (long long) nR_52195, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75944 = (int64_t) 8 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75945, bytes_75944, "mem_75945")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75947, bytes_75944, "mem_75947")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75949, bytes_75944, "mem_75949")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75469.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t bytes_75950 = (int64_t) 4 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75951, bytes_75950, "mem_75951")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_75467.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_72502;
    
    segmap_tblock_sizze_72502 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72501;
    
    int64_t num_tblocks_72504;
    int64_t max_num_tblocks_77061;
    
    max_num_tblocks_77061 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72503;
    num_tblocks_72504 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_52195, segmap_tblock_sizze_72502), max_num_tblocks_77061)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77062 = sext_i64_i32(sdiv_up64(nR_52195, segmap_tblock_sizze_72502));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_72499(ctx, num_tblocks_72504, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72501, 1, 1, (int64_t) 0, nR_52195, m_65686, num_tblocks_72504, virt_num_tblocks_77062, tR_mem_75467.mem, ext_mem_75469.mem, ext_mem_75937.mem, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, mem_75945.mem, mem_75947.mem, mem_75949.mem, mem_75951.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_72508;
    
    segscan_tblock_sizze_72508 = *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72507;
    
    int64_t num_tblocks_72510;
    int64_t max_num_tblocks_77075;
    
    max_num_tblocks_77075 = *ctx->tuning_params.inner_SMJ_floatzisegscan_num_tblocks_72509;
    num_tblocks_72510 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segscan_tblock_sizze_72508), max_num_tblocks_77075)));
    if (memblock_alloc_device(ctx, &mem_75955, bytes_75944, "mem_75955")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75957, bytes_75944, "mem_75957")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75959, bytes_75944, "mem_75959")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_65686)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_77076;
        
        shared_memory_77076 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_77077;
        
        thread_block_sizze_77077 = ctx->max_thread_block_size;
        
        int64_t registers_77078;
        
        registers_77078 = ctx->max_registers;
        
        int64_t thread_block_sizze_77079;
        
        thread_block_sizze_77079 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_77080 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_77076, thread_block_sizze_77077), (int64_t) 8), squot64(squot64(registers_77078, thread_block_sizze_77079) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_77081 = sdiv_up64(m_65686, segscan_tblock_sizze_72508 * chunk_sizze_77080);
        int64_t num_virt_threads_77082 = num_virt_blocks_77081 * segscan_tblock_sizze_72508;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_77080, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_77083, num_virt_blocks_77081, "status_flags_mem_77083")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_77083, num_virt_blocks_77081, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77085, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77085")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77087, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77087")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77089, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77089")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77091, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77091")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzisegscan_72513(ctx, num_tblocks_72510, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegscan_tblock_sizze_72507, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72508, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72508), smax64(chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_72508, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_72508), smax64(chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_72508 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_65686, num_tblocks_72510, num_virt_blocks_77081, num_virt_threads_77082, mem_75945.mem, mem_75955.mem, mem_75957.mem, mem_75959.mem, status_flags_mem_77083.mem, aggregates_mem_77085.mem, incprefixes_mem_77087.mem, aggregates_mem_77089.mem, incprefixes_mem_77091.mem, global_dynid_mem_77093.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_72529;
    
    segmap_tblock_sizze_72529 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72517;
    
    int64_t segmap_usable_groups_72530 = sdiv_up64(m_65686, segmap_tblock_sizze_72529);
    
    if (memblock_alloc_device(ctx, &mem_75962, bytes_75944, "mem_75962")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77228 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_72529));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_72533(ctx, segmap_usable_groups_72530, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72517, 1, 1, (int64_t) 0, m_65686, mem_75955.mem, mem_75962.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
        return 1;
    
    bool cond_65737 = slt64((int64_t) 0, m_65686);
    bool y_65738 = slt64(m_65696, m_65686);
    bool bounds_check_65739 = zzero_leq_i_p_m_t_s_65697 && y_65738;
    bool loop_not_taken_65740 = !cond_65737;
    bool protect_assert_disj_65741 = bounds_check_65739 || loop_not_taken_65740;
    bool index_certs_65742;
    
    if (!protect_assert_disj_65741) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  ftSMJ.fut:284:10-41\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75964, (int64_t) 8, "mem_75964")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_77237(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75962.mem, mem_75964.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75964, "mem_75964") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75963, (int64_t) 8, "mem_75963")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75963, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75963, "mem_75963") != 0)
            return 1;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75967, (int64_t) 8, "mem_75967")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_77243(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75945.mem, mem_75967.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75967, "mem_75967") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75966, (int64_t) 8, "mem_75966")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75966, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75966, "mem_75966") != 0)
            return 1;
    }
    
    bool zzero_65754 = scatter_psizze_52204 == (int64_t) 0;
    bool nonzzero_65755 = !zzero_65754;
    bool nonzzero_cert_65756;
    
    if (!nonzzero_65755) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_65821 = !empty_slice_65695;
    bool protect_assert_disj_65822 = empty_slice_65695 || bounds_check_65739;
    bool index_certs_65823;
    
    if (!protect_assert_disj_65822) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65824;
    
    if (x_65821) {
        int64_t read_res_77399;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77399, mem_75957.mem, m_65696 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66739 = read_res_77399;
        
        m_f_res_65824 = x_66739;
    } else {
        m_f_res_65824 = (int64_t) 0;
    }
    
    int64_t m_65826;
    
    if (empty_slice_65695) {
        m_65826 = (int64_t) 0;
    } else {
        m_65826 = m_f_res_65824;
    }
    
    int64_t m_65836 = sub64(m_65826, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65838 = slt64(m_65836, m_65686);
    bool zzero_leq_i_p_m_t_s_65837 = sle64((int64_t) 0, m_65836);
    bool y_65840 = zzero_leq_i_p_m_t_s_65837 && i_p_m_t_s_leq_w_65838;
    bool i_lte_j_65839 = sle64((int64_t) 0, m_65826);
    bool forwards_ok_65841 = i_lte_j_65839 && y_65840;
    bool eq_x_zz_65833 = (int64_t) 0 == m_f_res_65824;
    bool p_and_eq_x_y_65834 = x_65821 && eq_x_zz_65833;
    bool empty_slice_65835 = empty_slice_65695 || p_and_eq_x_y_65834;
    bool ok_or_empty_65842 = empty_slice_65835 || forwards_ok_65841;
    bool index_certs_65843;
    
    if (!ok_or_empty_65842) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65826, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:389:133-136\n   #4  ftSMJ.fut:378:1-389:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75969 = (int64_t) 8 * m_65826;
    
    if (memblock_alloc_device(ctx, &mem_75974, (int64_t) 8, "mem_75974")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_floatzigpuseq_77249(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_75965.mem, ext_mem_75968.mem, mem_75974.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
        return 1;
    
    int64_t n_pairs_t_res_65747;
    
    if (cond_65737) {
        int64_t read_res_77400;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77400, mem_75974.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_75465 = read_res_77400;
        
        n_pairs_t_res_65747 = x_75465;
    } else {
        n_pairs_t_res_65747 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
        return 1;
    
    int64_t n_pairs_65748;
    
    if (cond_65737) {
        n_pairs_65748 = n_pairs_t_res_65747;
    } else {
        n_pairs_65748 = (int64_t) 0;
    }
    
    int64_t bytes_75975 = (int64_t) 4 * n_pairs_65748;
    int64_t bytes_75977 = (int64_t) 8 * n_pairs_65748;
    int64_t segmap_tblock_sizze_72544;
    
    segmap_tblock_sizze_72544 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72543;
    
    int64_t num_tblocks_72546;
    int64_t max_num_tblocks_77255;
    
    max_num_tblocks_77255 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72545;
    num_tblocks_72546 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_72544), max_num_tblocks_77255)));
    if (memblock_alloc_device(ctx, &mem_75970, bytes_75969, "mem_75970")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75970.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75972, bytes_75969, "mem_75972")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75972.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_72552;
    
    segmap_tblock_sizze_72552 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72551;
    
    int64_t num_tblocks_72554;
    int64_t max_num_tblocks_77256;
    
    max_num_tblocks_77256 = *ctx->tuning_params.inner_SMJ_floatzisegmap_num_tblocks_72553;
    num_tblocks_72554 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_72552), max_num_tblocks_77256)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77257 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_72552));
    
    {
        err = gpu_kernel_inner_SMJ_floatzisegmap_72549(ctx, num_tblocks_72554, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72551, 1, 1, (int64_t) 0, m_65686, m_65826, num_tblocks_72554, virt_num_tblocks_77257, mem_75945.mem, mem_75957.mem, mem_75959.mem, mem_75962.mem, mem_75970.mem, mem_75972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
        return 1;
    
    bool cond_65853 = slt64((int64_t) 0, m_65826);
    int64_t segmap_tblock_sizze_72567;
    
    segmap_tblock_sizze_72567 = *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72559;
    if (memblock_alloc_device(ctx, &mem_75976, bytes_75975, "mem_75976")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_75976, n_pairs_65748, 0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75978, bytes_75977, "mem_75978")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75978, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75980, bytes_75977, "mem_75980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75980, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_65752 = add64(scatter_psizze_52204, n_pairs_65748);
    int64_t zs_lhs_65753 = sub64(zm_lhs_65752, (int64_t) 1);
    int64_t m_65757 = sdiv64(zs_lhs_65753, scatter_psizze_52204);
    bool loop_cond_65758 = slt64((int64_t) 0, m_65757);
    bool partitioned_scatter_res_65759;
    int64_t partitioned_scatter_res_65763;
    bool loop_while_65764;
    int64_t p_65768;
    
    loop_while_65764 = loop_cond_65758;
    p_65768 = (int64_t) 0;
    while (loop_while_65764) {
        int64_t lower_bound_65769 = mul64(scatter_psizze_52204, p_65768);
        int64_t min_arg1_65770 = add64(scatter_psizze_52204, lower_bound_65769);
        int64_t min_res_65771 = smin64(n_pairs_65748, min_arg1_65770);
        int64_t j_m_i_65772 = sub64(min_res_65771, lower_bound_65769);
        bool empty_slice_65773 = j_m_i_65772 == (int64_t) 0;
        int64_t m_65774 = sub64(j_m_i_65772, (int64_t) 1);
        int64_t i_p_m_t_s_65775 = add64(lower_bound_65769, m_65774);
        bool zzero_leq_i_p_m_t_s_65776 = sle64((int64_t) 0, i_p_m_t_s_65775);
        bool i_p_m_t_s_leq_w_65777 = slt64(i_p_m_t_s_65775, n_pairs_65748);
        bool zzero_lte_i_65778 = sle64((int64_t) 0, lower_bound_65769);
        bool i_lte_j_65779 = sle64(lower_bound_65769, min_res_65771);
        bool y_65780 = i_p_m_t_s_leq_w_65777 && zzero_lte_i_65778;
        bool y_65781 = zzero_leq_i_p_m_t_s_65776 && y_65780;
        bool forwards_ok_65782 = i_lte_j_65779 && y_65781;
        bool ok_or_empty_65783 = empty_slice_65773 || forwards_ok_65782;
        bool index_certs_65784;
        
        if (!ok_or_empty_65783) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_65769, ":", (long long) min_res_65771, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_75990 = (int64_t) 4 * j_m_i_65772;
        int64_t bytes_75992 = (int64_t) 8 * j_m_i_65772;
        
        if (memblock_alloc_device(ctx, &mem_75991, bytes_75990, "mem_75991")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75976.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75993, bytes_75992, "mem_75993")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75978.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75995, bytes_75992, "mem_75995")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75980.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77275 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_72544));
        
        {
            err = gpu_kernel_inner_SMJ_floatzisegmap_72541(ctx, num_tblocks_72546, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72543, 1, 1, (int64_t) 0, m_65686, lower_bound_65769, min_res_65771, j_m_i_65772, num_tblocks_72546, virt_num_tblocks_77275, mem_75947.mem, mem_75949.mem, mem_75951.mem, mem_75962.mem, mem_75991.mem, mem_75993.mem, mem_75995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_65798 = add64((int64_t) 1, p_65768);
        
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75976.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75978.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75980.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        
        bool loop_cond_65809 = slt64(tmp_65798, m_65757);
        bool loop_while_tmp_77270 = loop_cond_65809;
        int64_t p_tmp_77274 = tmp_65798;
        
        loop_while_65764 = loop_while_tmp_77270;
        p_65768 = p_tmp_77274;
    }
    partitioned_scatter_res_65759 = loop_while_65764;
    partitioned_scatter_res_65763 = p_65768;
    if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
        return 1;
    
    bool loop_cond_t_res_65854 = slt64(m_65686, n_pairs_65748);
    bool x_65855 = cond_65853 && loop_cond_t_res_65854;
    
    if (memblock_alloc_device(ctx, &mem_76021, (int64_t) 4, "mem_76021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76022, (int64_t) 8, "mem_76022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76023, (int64_t) 8, "mem_76023")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_65856;
    int64_t joinTups_to_joinPairs_InnerJoin_res_65860;
    bool loop_while_65861;
    int64_t p_65865;
    
    if (memblock_set_device(ctx, &mem_param_76008, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76011, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76014, &mem_75980, "mem_75980") != 0)
        return 1;
    loop_while_65861 = x_65855;
    p_65865 = (int64_t) 0;
    while (loop_while_65861) {
        bool x_65866 = sle64((int64_t) 0, p_65865);
        bool y_65867 = slt64(p_65865, m_65826);
        bool bounds_check_65868 = x_65866 && y_65867;
        bool index_certs_65869;
        
        if (!bounds_check_65868) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65865, "] out of bounds for array of shape [", (long long) m_65826, "].", "-> #0  ftSMJ.fut:299:13-42\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_77401;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77401, mem_75972.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65870 = read_res_77401;
        int64_t read_res_77402;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77402, mem_75970.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65871 = read_res_77402;
        bool x_65872 = sle64((int64_t) 0, loopres_65870);
        bool y_65873 = slt64(loopres_65870, n_pairs_65748);
        bool bounds_check_65874 = x_65872 && y_65873;
        bool index_certs_65875;
        
        if (!bounds_check_65874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:301:52-61\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_65886 = add64(loopres_65870, loopres_65871);
        bool empty_slice_65890 = loopres_65871 == (int64_t) 0;
        int64_t m_65891 = sub64(loopres_65871, (int64_t) 1);
        int64_t i_p_m_t_s_65892 = add64(loopres_65870, m_65891);
        bool zzero_leq_i_p_m_t_s_65893 = sle64((int64_t) 0, i_p_m_t_s_65892);
        bool i_p_m_t_s_leq_w_65894 = slt64(i_p_m_t_s_65892, n_pairs_65748);
        bool i_lte_j_65895 = sle64(loopres_65870, tmp_65886);
        bool y_65896 = x_65872 && i_p_m_t_s_leq_w_65894;
        bool y_65897 = zzero_leq_i_p_m_t_s_65893 && y_65896;
        bool forwards_ok_65898 = i_lte_j_65895 && y_65897;
        bool ok_or_empty_65899 = empty_slice_65890 || forwards_ok_65898;
        bool index_certs_65900;
        
        if (!ok_or_empty_65899) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, ":", (long long) tmp_65886, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:305:14-55\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:389:133-136\n   #3  ftSMJ.fut:378:1-389:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_76024 = (int64_t) 4 * loopres_65871;
        int64_t bytes_76026 = (int64_t) 8 * loopres_65871;
        int64_t segmap_usable_groups_72568 = sdiv_up64(loopres_65871, segmap_tblock_sizze_72567);
        int64_t tmp_65885 = add64((int64_t) 1, p_65865);
        
        if (memblock_alloc_device(ctx, &mem_76016, bytes_75975, "mem_76016")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76016.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76008.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76018, bytes_75977, "mem_76018")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76011.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76020, bytes_75977, "mem_76020")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76020.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76014.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        
        bool cond_65904 = slt64(tmp_65885, m_65826);
        bool x_65905 = loop_cond_t_res_65854 && cond_65904;
        
        {
            err = gpu_kernel_inner_SMJ_floatzigpuseq_77296(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_65870, mem_param_76008.mem, mem_param_76011.mem, mem_param_76014.mem, mem_76021.mem, mem_76022.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76025, bytes_76024, "mem_76025")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77302 = loopres_65871;
        int64_t tblock_sizze_77307;
        
        tblock_sizze_77307 = *ctx->tuning_params.inner_SMJ_floatzitblock_sizze_77307;
        
        int64_t virt_num_tblocks_77308 = sdiv_up64(replicate_n_77302, tblock_sizze_77307);
        int64_t num_tblocks_77309 = smin64(virt_num_tblocks_77308, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_floatzireplicate_77303(ctx, num_tblocks_77309, 1, 1, tblock_sizze_77307, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77302, virt_num_tblocks_77308, num_tblocks_77309, mem_76021.mem, mem_76025.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76027, bytes_76026, "mem_76027")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77322 = loopres_65871;
        int64_t tblock_sizze_77327;
        
        tblock_sizze_77327 = *ctx->tuning_params.inner_SMJ_floatzitblock_sizze_77327;
        
        int64_t virt_num_tblocks_77328 = sdiv_up64(replicate_n_77322, tblock_sizze_77327);
        int64_t num_tblocks_77329 = smin64(virt_num_tblocks_77328, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_floatzireplicate_77323(ctx, num_tblocks_77329, 1, 1, tblock_sizze_77327, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77322, virt_num_tblocks_77328, num_tblocks_77329, mem_76022.mem, mem_76027.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77342 = sext_i64_i32(sdiv_up64(loopres_65871, segmap_tblock_sizze_72567));
        
        {
            err = gpu_kernel_inner_SMJ_floatzisegmap_72571(ctx, segmap_usable_groups_72568, 1, 1, *ctx->tuning_params.inner_SMJ_floatzisegmap_tblock_sizze_72559, 1, 1, (int64_t) 0, loopres_65870, loopres_65871, mem_76020.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76016.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77288, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77289, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77290, &mem_76020, "mem_76020") != 0)
            return 1;
        
        bool loop_while_tmp_77291 = x_65905;
        int64_t p_tmp_77295 = tmp_65885;
        
        if (memblock_set_device(ctx, &mem_param_76008, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76011, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76014, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        loop_while_65861 = loop_while_tmp_77291;
        p_65865 = p_tmp_77295;
    }
    if (memblock_set_device(ctx, &ext_mem_76039, &mem_param_76008, "mem_param_76008") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76038, &mem_param_76011, "mem_param_76011") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76037, &mem_param_76014, "mem_param_76014") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_65856 = loop_while_65861;
    joinTups_to_joinPairs_InnerJoin_res_65860 = p_65865;
    if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76041, bytes_75975, "mem_76041")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76041.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76039.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76043, bytes_75977, "mem_76043")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76038.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76045, bytes_75977, "mem_76045")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76037.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_76043, "mem_76043") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76543, &mem_76045, "mem_76045") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76544, &mem_76041, "mem_76041") != 0)
        return 1;
    prim_out_76545 = n_pairs_65748;
    if (memblock_set_device(ctx, &*mem_out_p_77382, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77383, &mem_out_76543, "mem_out_76543") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77384, &mem_out_76544, "mem_out_76544") != 0)
        return 1;
    *out_prim_out_77385 = prim_out_76545;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_76045, "mem_76045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76043, "mem_76043") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76041, "mem_76041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76020, "mem_76020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76014, "mem_param_76014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76011, "mem_param_76011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76008, "mem_param_76008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75966, "mem_75966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75967, "mem_75967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75963, "mem_75963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75964, "mem_75964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77091, "incprefixes_mem_77091") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77089, "aggregates_mem_77089") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77087, "incprefixes_mem_77087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77085, "aggregates_mem_77085") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_77083, "status_flags_mem_77083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_76950, "incprefixes_mem_76950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_76948, "aggregates_mem_76948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_76926, "status_flags_mem_76926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75925, "mem_75925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75922, "mem_75922") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75730, "mem_75730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75728, "mem_75728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75714, "mem_75714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75711, "mem_75711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75690, "mem_75690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75688, "mem_75688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75623, "mem_75623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75621, "mem_75621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75684, "mem_75684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75682, "mem_75682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75693, "ext_mem_75693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75696, "ext_mem_75696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75699, "ext_mem_75699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75702, "ext_mem_75702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75552, "mem_param_75552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75549, "mem_param_75549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75544, "mem_75544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75545, "mem_75545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75541, "mem_75541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75542, "mem_75542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75540, "mem_param_75540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75537, "mem_param_75537") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75733, "ext_mem_75733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75736, "ext_mem_75736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75739, "ext_mem_75739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75742, "ext_mem_75742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75530, "mem_param_75530") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75527, "mem_param_75527") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75747, "ext_mem_75747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75748, "ext_mem_75748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75509, "mem_75509") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75511, "mem_75511") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75493, "mem_75493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75494, "mem_75494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75489, "mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75490, "mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75895, "mem_75895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75893, "mem_75893") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75828, "mem_75828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75826, "mem_75826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75889, "mem_75889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75887, "mem_75887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75898, "ext_mem_75898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75901, "ext_mem_75901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75904, "ext_mem_75904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75907, "ext_mem_75907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75757, "mem_param_75757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75754, "mem_param_75754") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75912, "ext_mem_75912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75913, "ext_mem_75913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75749, "mem_75749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75750, "mem_75750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75482, "mem_param_75482") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75474, "mem_75474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75475, "mem_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76544, "mem_out_76544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76543, "mem_out_76543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_77403, struct memblock_device *mem_out_p_77404, struct memblock_device *mem_out_p_77405, int64_t *out_prim_out_77406, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_42219, int64_t nS_42220, int64_t offset_R_42223, int64_t offset_S_42224, int64_t partitionsPerWindow_42225, int64_t numberOfWindows_42226, int64_t extParallelism_42227, int64_t scatter_psizze_42228)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_76045;
    
    mem_76045.references = NULL;
    
    struct memblock_device mem_76043;
    
    mem_76043.references = NULL;
    
    struct memblock_device mem_76041;
    
    mem_76041.references = NULL;
    
    struct memblock_device mem_param_tmp_77270;
    
    mem_param_tmp_77270.references = NULL;
    
    struct memblock_device mem_param_tmp_77269;
    
    mem_param_tmp_77269.references = NULL;
    
    struct memblock_device mem_param_tmp_77268;
    
    mem_param_tmp_77268.references = NULL;
    
    struct memblock_device mem_76027;
    
    mem_76027.references = NULL;
    
    struct memblock_device mem_76025;
    
    mem_76025.references = NULL;
    
    struct memblock_device mem_76020;
    
    mem_76020.references = NULL;
    
    struct memblock_device mem_76018;
    
    mem_76018.references = NULL;
    
    struct memblock_device mem_76016;
    
    mem_76016.references = NULL;
    
    struct memblock_device mem_param_76014;
    
    mem_param_76014.references = NULL;
    
    struct memblock_device mem_param_76011;
    
    mem_param_76011.references = NULL;
    
    struct memblock_device mem_param_76008;
    
    mem_param_76008.references = NULL;
    
    struct memblock_device ext_mem_76037;
    
    ext_mem_76037.references = NULL;
    
    struct memblock_device ext_mem_76038;
    
    ext_mem_76038.references = NULL;
    
    struct memblock_device ext_mem_76039;
    
    ext_mem_76039.references = NULL;
    
    struct memblock_device mem_76023;
    
    mem_76023.references = NULL;
    
    struct memblock_device mem_76022;
    
    mem_76022.references = NULL;
    
    struct memblock_device mem_76021;
    
    mem_76021.references = NULL;
    
    struct memblock_device mem_75995;
    
    mem_75995.references = NULL;
    
    struct memblock_device mem_75993;
    
    mem_75993.references = NULL;
    
    struct memblock_device mem_75991;
    
    mem_75991.references = NULL;
    
    struct memblock_device mem_75980;
    
    mem_75980.references = NULL;
    
    struct memblock_device mem_75978;
    
    mem_75978.references = NULL;
    
    struct memblock_device mem_75976;
    
    mem_75976.references = NULL;
    
    struct memblock_device mem_75972;
    
    mem_75972.references = NULL;
    
    struct memblock_device mem_75970;
    
    mem_75970.references = NULL;
    
    struct memblock_device mem_75974;
    
    mem_75974.references = NULL;
    
    struct memblock_device mem_75966;
    
    mem_75966.references = NULL;
    
    struct memblock_device mem_75967;
    
    mem_75967.references = NULL;
    
    struct memblock_device ext_mem_75968;
    
    ext_mem_75968.references = NULL;
    
    struct memblock_device mem_75963;
    
    mem_75963.references = NULL;
    
    struct memblock_device mem_75964;
    
    mem_75964.references = NULL;
    
    struct memblock_device ext_mem_75965;
    
    ext_mem_75965.references = NULL;
    
    struct memblock_device mem_75962;
    
    mem_75962.references = NULL;
    
    struct memblock_device incprefixes_mem_77071;
    
    incprefixes_mem_77071.references = NULL;
    
    struct memblock_device aggregates_mem_77069;
    
    aggregates_mem_77069.references = NULL;
    
    struct memblock_device incprefixes_mem_77067;
    
    incprefixes_mem_77067.references = NULL;
    
    struct memblock_device aggregates_mem_77065;
    
    aggregates_mem_77065.references = NULL;
    
    struct memblock_device status_flags_mem_77063;
    
    status_flags_mem_77063.references = NULL;
    
    struct memblock_device mem_75959;
    
    mem_75959.references = NULL;
    
    struct memblock_device mem_75957;
    
    mem_75957.references = NULL;
    
    struct memblock_device mem_75955;
    
    mem_75955.references = NULL;
    
    struct memblock_device mem_75951;
    
    mem_75951.references = NULL;
    
    struct memblock_device mem_75949;
    
    mem_75949.references = NULL;
    
    struct memblock_device mem_75947;
    
    mem_75947.references = NULL;
    
    struct memblock_device mem_75945;
    
    mem_75945.references = NULL;
    
    struct memblock_device incprefixes_mem_76950;
    
    incprefixes_mem_76950.references = NULL;
    
    struct memblock_device aggregates_mem_76948;
    
    aggregates_mem_76948.references = NULL;
    
    struct memblock_device status_flags_mem_76926;
    
    status_flags_mem_76926.references = NULL;
    
    struct memblock_device mem_75943;
    
    mem_75943.references = NULL;
    
    struct memblock_device mem_75941;
    
    mem_75941.references = NULL;
    
    struct memblock_device mem_param_tmp_76593;
    
    mem_param_tmp_76593.references = NULL;
    
    struct memblock_device mem_param_tmp_76592;
    
    mem_param_tmp_76592.references = NULL;
    
    struct memblock_device mem_75926;
    
    mem_75926.references = NULL;
    
    struct memblock_device mem_75925;
    
    mem_75925.references = NULL;
    
    struct memblock_device mem_75922;
    
    mem_75922.references = NULL;
    
    struct memblock_device mem_param_tmp_76750;
    
    mem_param_tmp_76750.references = NULL;
    
    struct memblock_device mem_param_tmp_76749;
    
    mem_param_tmp_76749.references = NULL;
    
    struct memblock_device mem_75730;
    
    mem_75730.references = NULL;
    
    struct memblock_device mem_75728;
    
    mem_75728.references = NULL;
    
    struct memblock_device mem_75726;
    
    mem_75726.references = NULL;
    
    struct memblock_device mem_75723;
    
    mem_75723.references = NULL;
    
    struct memblock_device mem_param_tmp_76760;
    
    mem_param_tmp_76760.references = NULL;
    
    struct memblock_device mem_param_tmp_76759;
    
    mem_param_tmp_76759.references = NULL;
    
    struct memblock_device mem_75714;
    
    mem_75714.references = NULL;
    
    struct memblock_device mem_75711;
    
    mem_75711.references = NULL;
    
    struct memblock_device mem_param_tmp_76778;
    
    mem_param_tmp_76778.references = NULL;
    
    struct memblock_device mem_param_tmp_76777;
    
    mem_param_tmp_76777.references = NULL;
    
    struct memblock_device mem_75690;
    
    mem_75690.references = NULL;
    
    struct memblock_device mem_75688;
    
    mem_75688.references = NULL;
    
    struct memblock_device mem_75623;
    
    mem_75623.references = NULL;
    
    struct memblock_device mem_75621;
    
    mem_75621.references = NULL;
    
    struct memblock_device mem_75684;
    
    mem_75684.references = NULL;
    
    struct memblock_device mem_75682;
    
    mem_75682.references = NULL;
    
    struct memblock_device ext_mem_75685;
    
    ext_mem_75685.references = NULL;
    
    struct memblock_device ext_mem_75686;
    
    ext_mem_75686.references = NULL;
    
    struct memblock_device ext_mem_75562;
    
    ext_mem_75562.references = NULL;
    
    struct memblock_device mem_75560;
    
    mem_75560.references = NULL;
    
    struct memblock_device ext_mem_75693;
    
    ext_mem_75693.references = NULL;
    
    struct memblock_device ext_mem_75696;
    
    ext_mem_75696.references = NULL;
    
    struct memblock_device mem_75558;
    
    mem_75558.references = NULL;
    
    struct memblock_device ext_mem_75699;
    
    ext_mem_75699.references = NULL;
    
    struct memblock_device ext_mem_75702;
    
    ext_mem_75702.references = NULL;
    
    struct memblock_device ext_mem_75556;
    
    ext_mem_75556.references = NULL;
    
    struct memblock_device ext_mem_75555;
    
    ext_mem_75555.references = NULL;
    
    struct memblock_device mem_param_75552;
    
    mem_param_75552.references = NULL;
    
    struct memblock_device mem_param_75549;
    
    mem_param_75549.references = NULL;
    
    struct memblock_device ext_mem_75707;
    
    ext_mem_75707.references = NULL;
    
    struct memblock_device ext_mem_75708;
    
    ext_mem_75708.references = NULL;
    
    struct memblock_device mem_75544;
    
    mem_75544.references = NULL;
    
    struct memblock_device mem_75545;
    
    mem_75545.references = NULL;
    
    struct memblock_device ext_mem_75546;
    
    ext_mem_75546.references = NULL;
    
    struct memblock_device mem_75541;
    
    mem_75541.references = NULL;
    
    struct memblock_device mem_75542;
    
    mem_75542.references = NULL;
    
    struct memblock_device ext_mem_75543;
    
    ext_mem_75543.references = NULL;
    
    struct memblock_device mem_param_75540;
    
    mem_param_75540.references = NULL;
    
    struct memblock_device mem_param_75537;
    
    mem_param_75537.references = NULL;
    
    struct memblock_device ext_mem_75719;
    
    ext_mem_75719.references = NULL;
    
    struct memblock_device ext_mem_75720;
    
    ext_mem_75720.references = NULL;
    
    struct memblock_device mem_75557;
    
    mem_75557.references = NULL;
    
    struct memblock_device mem_75554;
    
    mem_75554.references = NULL;
    
    struct memblock_device mem_75553;
    
    mem_75553.references = NULL;
    
    struct memblock_device mem_75534;
    
    mem_75534.references = NULL;
    
    struct memblock_device mem_75532;
    
    mem_75532.references = NULL;
    
    struct memblock_device ext_mem_75733;
    
    ext_mem_75733.references = NULL;
    
    struct memblock_device ext_mem_75736;
    
    ext_mem_75736.references = NULL;
    
    struct memblock_device ext_mem_75739;
    
    ext_mem_75739.references = NULL;
    
    struct memblock_device ext_mem_75742;
    
    ext_mem_75742.references = NULL;
    
    struct memblock_device mem_param_75530;
    
    mem_param_75530.references = NULL;
    
    struct memblock_device mem_param_75527;
    
    mem_param_75527.references = NULL;
    
    struct memblock_device ext_mem_75747;
    
    ext_mem_75747.references = NULL;
    
    struct memblock_device ext_mem_75748;
    
    ext_mem_75748.references = NULL;
    
    struct memblock_device mem_75524;
    
    mem_75524.references = NULL;
    
    struct memblock_device mem_75522;
    
    mem_75522.references = NULL;
    
    struct memblock_device mem_75509;
    
    mem_75509.references = NULL;
    
    struct memblock_device mem_75511;
    
    mem_75511.references = NULL;
    
    struct memblock_device ext_mem_75512;
    
    ext_mem_75512.references = NULL;
    
    struct memblock_device ext_mem_75513;
    
    ext_mem_75513.references = NULL;
    
    struct memblock_device mem_75506;
    
    mem_75506.references = NULL;
    
    struct memblock_device mem_75504;
    
    mem_75504.references = NULL;
    
    struct memblock_device mem_75493;
    
    mem_75493.references = NULL;
    
    struct memblock_device mem_75494;
    
    mem_75494.references = NULL;
    
    struct memblock_device ext_mem_75495;
    
    ext_mem_75495.references = NULL;
    
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_75489;
    
    mem_75489.references = NULL;
    
    struct memblock_device mem_75490;
    
    mem_75490.references = NULL;
    
    struct memblock_device ext_mem_75491;
    
    ext_mem_75491.references = NULL;
    
    struct memblock_device mem_75488;
    
    mem_75488.references = NULL;
    
    struct memblock_device mem_75486;
    
    mem_75486.references = NULL;
    
    struct memblock_device mem_param_tmp_76611;
    
    mem_param_tmp_76611.references = NULL;
    
    struct memblock_device mem_param_tmp_76610;
    
    mem_param_tmp_76610.references = NULL;
    
    struct memblock_device mem_75895;
    
    mem_75895.references = NULL;
    
    struct memblock_device mem_75893;
    
    mem_75893.references = NULL;
    
    struct memblock_device mem_75828;
    
    mem_75828.references = NULL;
    
    struct memblock_device mem_75826;
    
    mem_75826.references = NULL;
    
    struct memblock_device mem_75889;
    
    mem_75889.references = NULL;
    
    struct memblock_device mem_75887;
    
    mem_75887.references = NULL;
    
    struct memblock_device ext_mem_75890;
    
    ext_mem_75890.references = NULL;
    
    struct memblock_device ext_mem_75891;
    
    ext_mem_75891.references = NULL;
    
    struct memblock_device ext_mem_75767;
    
    ext_mem_75767.references = NULL;
    
    struct memblock_device mem_75765;
    
    mem_75765.references = NULL;
    
    struct memblock_device ext_mem_75898;
    
    ext_mem_75898.references = NULL;
    
    struct memblock_device ext_mem_75901;
    
    ext_mem_75901.references = NULL;
    
    struct memblock_device mem_75763;
    
    mem_75763.references = NULL;
    
    struct memblock_device ext_mem_75904;
    
    ext_mem_75904.references = NULL;
    
    struct memblock_device ext_mem_75907;
    
    ext_mem_75907.references = NULL;
    
    struct memblock_device ext_mem_75761;
    
    ext_mem_75761.references = NULL;
    
    struct memblock_device ext_mem_75760;
    
    ext_mem_75760.references = NULL;
    
    struct memblock_device mem_param_75757;
    
    mem_param_75757.references = NULL;
    
    struct memblock_device mem_param_75754;
    
    mem_param_75754.references = NULL;
    
    struct memblock_device ext_mem_75912;
    
    ext_mem_75912.references = NULL;
    
    struct memblock_device ext_mem_75913;
    
    ext_mem_75913.references = NULL;
    
    struct memblock_device mem_75762;
    
    mem_75762.references = NULL;
    
    struct memblock_device mem_75759;
    
    mem_75759.references = NULL;
    
    struct memblock_device mem_75758;
    
    mem_75758.references = NULL;
    
    struct memblock_device mem_75749;
    
    mem_75749.references = NULL;
    
    struct memblock_device mem_75750;
    
    mem_75750.references = NULL;
    
    struct memblock_device ext_mem_75751;
    
    ext_mem_75751.references = NULL;
    
    struct memblock_device ext_mem_75916;
    
    ext_mem_75916.references = NULL;
    
    struct memblock_device ext_mem_75919;
    
    ext_mem_75919.references = NULL;
    
    struct memblock_device ext_mem_75929;
    
    ext_mem_75929.references = NULL;
    
    struct memblock_device ext_mem_75932;
    
    ext_mem_75932.references = NULL;
    
    struct memblock_device mem_param_75482;
    
    mem_param_75482.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device ext_mem_75937;
    
    ext_mem_75937.references = NULL;
    
    struct memblock_device ext_mem_75938;
    
    ext_mem_75938.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75474;
    
    mem_75474.references = NULL;
    
    struct memblock_device mem_75475;
    
    mem_75475.references = NULL;
    
    struct memblock_device ext_mem_75476;
    
    ext_mem_75476.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device ext_mem_75469;
    
    ext_mem_75469.references = NULL;
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76545;
    int64_t zm_lhs_64812 = add64(nR_42219, nS_42220);
    int64_t zs_lhs_64813 = sub64(zm_lhs_64812, (int64_t) 1);
    bool zzero_64814 = nR_42219 == (int64_t) 0;
    bool nonzzero_64815 = !zzero_64814;
    bool nonzzero_cert_64816;
    
    if (!nonzzero_64815) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:231:26-29\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_64817 = sdiv64(zs_lhs_64813, nR_42219);
    
    if (futrts_indicesWithIncrement_7587(ctx, &ext_mem_75469, tR_mem_75467, nR_42219, offset_R_42223) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_75470 = (int64_t) 8 * nR_42219;
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75471, nR_42219, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, nR_42219, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_64822 = slt64((int64_t) 0, numIter_64817);
    int64_t gt_rhs_64823 = sub64(nR_42219, (int64_t) 1);
    bool x_64824 = sle64((int64_t) 0, gt_rhs_64823);
    bool y_64825 = slt64(gt_rhs_64823, nR_42219);
    bool bounds_check_64826 = x_64824 && y_64825;
    bool loop_not_taken_64827 = !loop_cond_64822;
    bool protect_assert_disj_64828 = bounds_check_64826 || loop_not_taken_64827;
    bool index_certs_64829;
    
    if (!protect_assert_disj_64828) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftSMJ.fut:238:25-33\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_64822) {
        if (memblock_alloc_device(ctx, &mem_75475, (int64_t) 4, "mem_75475")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_76566(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, tR_mem_75467.mem, mem_75475.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75475, "mem_75475") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75474, (int64_t) 4, "mem_75474")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i32(ctx, mem_75474, (int64_t) 1, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75474, "mem_75474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_75483, (int64_t) 4, "mem_75483")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75484, (int64_t) 1, "mem_75484")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_64832;
    int64_t defunc_0_mergeJoin_res_64833;
    bool loop_while_64836;
    int64_t p_64837;
    
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75482, &mem_75471, "mem_75471") != 0)
        return 1;
    loop_while_64836 = loop_cond_64822;
    p_64837 = (int64_t) 0;
    while (loop_while_64836) {
        int64_t tS_start_64840 = mul64(nR_42219, p_64837);
        int64_t min_arg1_64841 = add64(nR_42219, tS_start_64840);
        int64_t min_res_64842 = smin64(nS_42220, min_arg1_64841);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 = sub64(min_res_64842, tS_start_64840);
        bool empty_slice_64844 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 == (int64_t) 0;
        int64_t m_64845 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, (int64_t) 1);
        int64_t i_p_m_t_s_64846 = add64(tS_start_64840, m_64845);
        bool zzero_leq_i_p_m_t_s_64847 = sle64((int64_t) 0, i_p_m_t_s_64846);
        bool i_p_m_t_s_leq_w_64848 = slt64(i_p_m_t_s_64846, nS_42220);
        bool zzero_lte_i_64849 = sle64((int64_t) 0, tS_start_64840);
        bool i_lte_j_64850 = sle64(tS_start_64840, min_res_64842);
        bool y_64851 = i_p_m_t_s_leq_w_64848 && zzero_lte_i_64849;
        bool y_64852 = zzero_leq_i_p_m_t_s_64847 && y_64851;
        bool forwards_ok_64853 = i_lte_j_64850 && y_64852;
        bool ok_or_empty_64854 = empty_slice_64844 || forwards_ok_64853;
        bool index_certs_64855;
        
        if (!ok_or_empty_64854) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_64840, ":", (long long) min_res_64842, "] out of bounds for array of shape [", (long long) nS_42220, "].", "-> #0  ftSMJ.fut:237:16-35\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_64857 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
        bool index_certs_64858;
        
        if (!y_64857) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:238:12-19\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_76598(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_64840, tS_mem_75468.mem, ext_mem_75476.mem, mem_75483.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_77407;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77407, mem_75484.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_64860 = read_res_77407;
        int64_t loopres_64861;
        
        if (defunc_0_gt_res_64860) {
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_param_75479, "mem_param_75479") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_param_75482, "mem_param_75482") != 0)
                return 1;
            loopres_64861 = numIter_64817;
        } else {
            bool cond_64864 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, nR_42219);
            bool dim_match_64978 = nR_42219 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            bool protect_assert_disj_76147 = cond_64864 || dim_match_64978;
            bool empty_or_match_cert_64979;
            
            if (!protect_assert_disj_76147) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "] cannot match shape of type `[", (long long) nR_42219, "]i32`.", "-> #0  ftSMJ.fut:246:18-31\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_64985 = slt64((int64_t) 0, numberOfWindows_42226);
            bool y_64988 = slt64((int64_t) 0, nR_42219);
            bool loop_not_taken_64989 = !loop_cond_64985;
            bool protect_assert_disj_64990 = y_64988 || loop_not_taken_64989;
            bool protect_assert_disj_76149 = cond_64864 || protect_assert_disj_64990;
            bool index_certs_64991;
            
            if (!protect_assert_disj_76149) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftbasics.fut:150:20-25\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_66374 = add64(nR_42219, extParallelism_42227);
            int64_t zs_lhs_66375 = sub64(zm_lhs_66374, (int64_t) 1);
            bool zzero_66376 = extParallelism_42227 == (int64_t) 0;
            bool nonzzero_66377 = !zzero_66376;
            bool loop_not_taken_76090 = !cond_64864;
            bool protect_assert_disj_76091 = nonzzero_66377 || loop_not_taken_76090;
            bool nonzzero_cert_66378;
            
            if (!protect_assert_disj_76091) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_66379 = sdiv_safe64(zs_lhs_66375, extParallelism_42227);
            bool loop_cond_66380 = slt64((int64_t) 0, numIter_66379);
            bool loop_not_taken_66381 = !y_64857;
            bool loop_not_taken_66382 = !loop_cond_66380;
            bool x_66383 = sle64((int64_t) 0, m_64845);
            bool y_66384 = slt64(m_64845, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
            bool bounds_check_66386 = x_66383 && y_66384;
            bool protect_assert_disj_66387 = loop_not_taken_66381 || bounds_check_66386;
            bool protect_assert_disj_66388 = loop_not_taken_66382 || protect_assert_disj_66387;
            bool protect_assert_disj_76093 = protect_assert_disj_66388 || loop_not_taken_76090;
            bool index_certs_66389;
            
            if (!protect_assert_disj_76093) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65659;
            
            if (!bounds_check_66386) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:257:23-44\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65661;
            
            if (!bounds_check_64826) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftSMJ.fut:257:51-59\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 = mul64(partitionsPerWindow_42225, numberOfWindows_42226);
            int64_t join_chunks_arg3_64981 = add64(offset_S_42224, tS_start_64840);
            int64_t bytes_75485 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
            bool empty_slice_64986 = partitionsPerWindow_42225 == (int64_t) 0;
            int64_t m_64987 = sub64(partitionsPerWindow_42225, (int64_t) 1);
            int64_t segmap_tblock_sizze_69030;
            
            segmap_tblock_sizze_69030 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_68823;
            
            int64_t zeze_rhs_65256 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, (int64_t) 1);
            int64_t segmap_tblock_sizze_69404;
            
            segmap_tblock_sizze_69404 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69240;
            
            int64_t segmap_usable_groups_69405 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_69404);
            bool loop_cond_65411 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
            bool protect_cond_conj_66385 = y_64857 && loop_cond_66380;
            int64_t bytes_75764 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            int64_t ext_75918;
            int64_t ext_75917;
            int64_t ext_75915;
            int64_t ext_75914;
            
            if (cond_64864) {
                if (protect_cond_conj_66385) {
                    if (memblock_alloc_device(ctx, &mem_75750, (int64_t) 4, "mem_75750")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_76604(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_64846, tS_mem_75468.mem, mem_75750.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75750, "mem_75750") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75749, (int64_t) 4, "mem_75749")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_75749, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75749, "mem_75749") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75758, (int64_t) 4, "mem_75758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75759, (int64_t) 4, "mem_75759")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75762, (int64_t) 1, "mem_75762")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_75911;
                int64_t ext_75910;
                int64_t ext_75909;
                int64_t ext_75908;
                bool defunc_0_find_joinTuples_res_66392;
                int64_t defunc_0_find_joinTuples_res_66393;
                bool loop_while_66396;
                int64_t p_66397;
                int64_t ctx_param_ext_75752;
                int64_t ctx_param_ext_75753;
                int64_t ctx_param_ext_75755;
                int64_t ctx_param_ext_75756;
                
                if (memblock_set_device(ctx, &mem_param_75754, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75757, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75752 = (int64_t) 0;
                ctx_param_ext_75753 = (int64_t) 1;
                ctx_param_ext_75755 = (int64_t) 0;
                ctx_param_ext_75756 = (int64_t) 1;
                loop_while_66396 = loop_cond_66380;
                p_66397 = (int64_t) 0;
                while (loop_while_66396) {
                    int64_t start_66400 = mul64(extParallelism_42227, p_66397);
                    int64_t min_arg1_66401 = sub64(nR_42219, start_66400);
                    int64_t min_res_66402 = smin64(extParallelism_42227, min_arg1_66401);
                    int64_t iter_R_66403 = add64(start_66400, min_res_66402);
                    bool empty_slice_66404 = min_res_66402 == (int64_t) 0;
                    int64_t m_66405 = sub64(min_res_66402, (int64_t) 1);
                    int64_t i_p_m_t_s_66406 = add64(start_66400, m_66405);
                    bool zzero_leq_i_p_m_t_s_66407 = sle64((int64_t) 0, i_p_m_t_s_66406);
                    bool i_p_m_t_s_leq_w_66408 = slt64(i_p_m_t_s_66406, nR_42219);
                    bool zzero_lte_i_66409 = sle64((int64_t) 0, start_66400);
                    bool i_lte_j_66410 = sle64(start_66400, iter_R_66403);
                    bool y_66411 = i_p_m_t_s_leq_w_66408 && zzero_lte_i_66409;
                    bool y_66412 = zzero_leq_i_p_m_t_s_66407 && y_66411;
                    bool forwards_ok_66413 = i_lte_j_66410 && y_66412;
                    bool ok_or_empty_66414 = empty_slice_66404 || forwards_ok_66413;
                    bool index_certs_66415;
                    
                    if (!ok_or_empty_66414) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_66400, ":", (long long) iter_R_66403, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66416 = slt64(m_66405, min_res_66402);
                    bool x_66417 = sle64((int64_t) 0, m_66405);
                    bool bounds_check_66418 = y_66416 && x_66417;
                    bool index_certs_66419;
                    
                    if (!bounds_check_66418) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_66405, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66422 = slt64((int64_t) 0, min_res_66402);
                    bool index_certs_66423;
                    
                    if (!y_66422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_76620(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_66400, i_p_m_t_s_66406, tR_mem_75467.mem, mem_75758.mem, mem_75759.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75760, &ext_mem_75751, "ext_mem_75751") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75760, &mem_75758, "mem_75758") != 0)
                        return 1;
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75761, &mem_75483, "mem_75483") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75761, &mem_75759, "mem_75759") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_76626(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75759.mem, ext_mem_75760.mem, mem_75762.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
                        return 1;
                    
                    bool read_res_77408;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77408, mem_75762.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_66425 = read_res_77408;
                    int64_t ext_75906;
                    int64_t ext_75905;
                    int64_t ext_75903;
                    int64_t ext_75902;
                    int64_t loopres_66427;
                    
                    if (defunc_0_gt_res_66425) {
                        if (memblock_set_device(ctx, &ext_mem_75907, &mem_param_75754, "mem_param_75754") != 0)
                            return 1;
                        ext_75906 = ctx_param_ext_75752;
                        ext_75905 = ctx_param_ext_75753;
                        if (memblock_set_device(ctx, &ext_mem_75904, &mem_param_75757, "mem_param_75757") != 0)
                            return 1;
                        ext_75903 = ctx_param_ext_75755;
                        ext_75902 = ctx_param_ext_75756;
                        loopres_66427 = numIter_66379;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75763, (int64_t) 1, "mem_75763")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_intzigpuseq_76632(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75758.mem, ext_mem_75761.mem, mem_75763.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_77409;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77409, mem_75763.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_66431 = read_res_77409;
                        
                        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
                            return 1;
                        
                        int64_t ext_75900;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75900 = ctx_param_ext_75752;
                        } else {
                            ext_75900 = (int64_t) 0;
                        }
                        
                        int64_t ext_75899;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75899 = ctx_param_ext_75753;
                        } else {
                            ext_75899 = (int64_t) 1;
                        }
                        
                        int64_t ext_75897;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75897 = ctx_param_ext_75755;
                        } else {
                            ext_75897 = (int64_t) 0;
                        }
                        
                        int64_t ext_75896;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75896 = ctx_param_ext_75756;
                        } else {
                            ext_75896 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_66432;
                        
                        if (defunc_0_gt_res_66431) {
                            int64_t tmp_66436 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_param_75754, "mem_param_75754") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_param_75757, "mem_param_75757") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66436;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_75765, bytes_75764, "mem_75765")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75765.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, tS_start_64840, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_7587(ctx, &ext_mem_75767, mem_75765, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, join_chunks_arg3_64981) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
                                return 1;
                            
                            bool suff_outer_par_68645;
                            
                            suff_outer_par_68645 = *ctx->tuning_params.inner_SMJ_intzisuff_outer_par_0 <= min_res_66402;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_int.suff_outer_par_0", (long) min_res_66402, suff_outer_par_68645 ? "true" : "false");
                            
                            int64_t tile_sizze_74256;
                            
                            tile_sizze_74256 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255;
                            
                            int64_t tile_sizze_73901;
                            
                            tile_sizze_73901 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900;
                            
                            int64_t num_whole_tiles_74272 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            int64_t residual_input_74496 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            bool cond_74497 = residual_input_74496 == (int64_t) 0;
                            int64_t binop_x_74513 = tile_sizze_74256 * num_whole_tiles_74272;
                            int64_t bytes_75825 = (int64_t) 8 * min_res_66402;
                            int64_t bytes_75788 = (int64_t) 8 * tile_sizze_74256;
                            int64_t bytes_75790 = (int64_t) 4 * tile_sizze_74256;
                            int64_t num_whole_tiles_73917 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            int64_t residual_input_74141 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            bool cond_74142 = residual_input_74141 == (int64_t) 0;
                            int64_t binop_x_74158 = tile_sizze_73901 * num_whole_tiles_73917;
                            int64_t bytes_75849 = (int64_t) 8 * tile_sizze_73901;
                            int64_t bytes_75851 = (int64_t) 4 * tile_sizze_73901;
                            int64_t shared_memory_capacity_76690;
                            
                            shared_memory_capacity_76690 = ctx->max_shared_memory;
                            if (suff_outer_par_68645 && sle64(sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75851, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76690)) {
                                int64_t ldim_73902 = sdiv_up64(min_res_66402, tile_sizze_73901);
                                
                                if (memblock_alloc_device(ctx, &mem_75887, bytes_75825, "mem_75887")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75889, bytes_75825, "mem_75889")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76638 = sext_i64_i32(sdiv_up64(tile_sizze_73901, tile_sizze_73901));
                                int32_t virt_num_tblocks_76639 = sext_i64_i32(ldim_73902);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_73899(ctx, ldim_73902, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_73900, 1, 1, bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8) + (bytes_75851 + srem64((int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8)) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_73902, num_whole_tiles_73917, residual_input_74141, cond_74142, binop_x_74158, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75887.mem, mem_75889.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75887, "mem_75887") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75889, "mem_75889") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_74257 = sdiv_up64(min_res_66402, tile_sizze_74256);
                                
                                if (memblock_alloc_device(ctx, &mem_75826, bytes_75825, "mem_75826")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75828, bytes_75825, "mem_75828")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76664 = sext_i64_i32(sdiv_up64(tile_sizze_74256, tile_sizze_74256));
                                int32_t virt_num_tblocks_76665 = sext_i64_i32(ldim_74257);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_74254(ctx, ldim_74257, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_74255, 1, 1, bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8) + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8)) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_74257, num_whole_tiles_74272, residual_input_74496, cond_74497, binop_x_74513, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75826.mem, mem_75828.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75826, "mem_75826") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75828, "mem_75828") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75893, bytes_75470, "mem_75893")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75757.mem, ctx_param_ext_75755, (int64_t []) {ctx_param_ext_75756}, (int64_t []) {nR_42219})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75891.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75895, bytes_75470, "mem_75895")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75754.mem, ctx_param_ext_75752, (int64_t []) {ctx_param_ext_75753}, (int64_t []) {nR_42219})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
                                return 1;
                            
                            int64_t tmp_66488 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_75895, "mem_75895") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_75893, "mem_75893") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66488;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75907, &ext_mem_75901, "ext_mem_75901") != 0)
                            return 1;
                        ext_75906 = ext_75900;
                        ext_75905 = ext_75899;
                        if (memblock_set_device(ctx, &ext_mem_75904, &ext_mem_75898, "ext_mem_75898") != 0)
                            return 1;
                        ext_75903 = ext_75897;
                        ext_75902 = ext_75896;
                        loopres_66427 = loopres_f_res_66432;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
                        return 1;
                    
                    bool loop_cond_66489 = slt64(loopres_66427, numIter_66379);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76610, &ext_mem_75907, "ext_mem_75907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76611, &ext_mem_75904, "ext_mem_75904") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76612 = ext_75906;
                    int64_t ctx_param_ext_tmp_76613 = ext_75905;
                    int64_t ctx_param_ext_tmp_76614 = ext_75903;
                    int64_t ctx_param_ext_tmp_76615 = ext_75902;
                    bool loop_while_tmp_76616 = loop_cond_66489;
                    int64_t p_tmp_76617 = loopres_66427;
                    
                    if (memblock_set_device(ctx, &mem_param_75754, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75757, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
                        return 1;
                    ctx_param_ext_75752 = ctx_param_ext_tmp_76612;
                    ctx_param_ext_75753 = ctx_param_ext_tmp_76613;
                    ctx_param_ext_75755 = ctx_param_ext_tmp_76614;
                    ctx_param_ext_75756 = ctx_param_ext_tmp_76615;
                    loop_while_66396 = loop_while_tmp_76616;
                    p_66397 = p_tmp_76617;
                }
                if (memblock_set_device(ctx, &ext_mem_75913, &mem_param_75754, "mem_param_75754") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75912, &mem_param_75757, "mem_param_75757") != 0)
                    return 1;
                ext_75911 = ctx_param_ext_75752;
                ext_75910 = ctx_param_ext_75753;
                ext_75909 = ctx_param_ext_75755;
                ext_75908 = ctx_param_ext_75756;
                defunc_0_find_joinTuples_res_66392 = loop_while_66396;
                defunc_0_find_joinTuples_res_66393 = p_66397;
                if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75913, "ext_mem_75913") != 0)
                    return 1;
                ext_75918 = ext_75911;
                ext_75917 = ext_75910;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75912, "ext_mem_75912") != 0)
                    return 1;
                ext_75915 = ext_75909;
                ext_75914 = ext_75908;
            } else {
                if (memblock_alloc_device(ctx, &mem_75486, bytes_75485, "mem_75486")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75486, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_42219) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75488, bytes_75485, "mem_75488")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75488, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_42219) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75490, (int64_t) 4, "mem_75490")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_76691(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_75467.mem, mem_75490.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75490, "mem_75490") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75489, (int64_t) 4, "mem_75489")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_75489, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75489, "mem_75489") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75492, (int64_t) 1, "mem_75492")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_intzigpuseq_76697(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75483.mem, ext_mem_75491.mem, mem_75492.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
                    return 1;
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75494, (int64_t) 4, "mem_75494")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_intzigpuseq_76703(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_42219, y_64988, tR_mem_75467.mem, mem_75483.mem, mem_75492.mem, mem_75494.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75494, "mem_75494") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75493, (int64_t) 4, "mem_75493")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, mem_75493, (int64_t) 1, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75493, "mem_75493") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_65003;
                int64_t defunc_0_windowed_partitionFunc_res_65004;
                bool loop_while_65007;
                int64_t p_65008;
                
                loop_while_65007 = loop_cond_64985;
                p_65008 = (int64_t) 0;
                while (loop_while_65007) {
                    int64_t start_65011 = mul64(partitionsPerWindow_42225, p_65008);
                    int64_t end_65012 = add64(partitionsPerWindow_42225, start_65011);
                    int64_t max_res_65013 = smax64((int64_t) 1, start_65011);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014 = sub64(end_65012, max_res_65013);
                    bool bounds_invalid_upwards_65015 = slt64(end_65012, max_res_65013);
                    bool valid_65016 = !bounds_invalid_upwards_65015;
                    bool range_valid_c_65017;
                    
                    if (!valid_65016) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_65013, "..<", (long long) end_65012, " is invalid.", "-> #0  ftbasics.fut:153:43-68\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_65020 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 == (int64_t) 0;
                    bool nonzzero_65021 = !zzero_65020;
                    bool nonzzero_cert_65022;
                    
                    if (!nonzzero_65021) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:156:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_75503 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool cond_65223 = slt64((int64_t) 0, start_65011);
                    int64_t conc_tmp_65224 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    int64_t ret_65225;
                    
                    if (cond_65223) {
                        ret_65225 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    } else {
                        ret_65225 = conc_tmp_65224;
                    }
                    
                    bool eq_x_y_65233 = partitionsPerWindow_42225 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool eq_x_zz_65234 = partitionsPerWindow_42225 == conc_tmp_65224;
                    bool p_and_eq_x_y_65235 = cond_65223 && eq_x_y_65233;
                    bool not_p_65236 = !cond_65223;
                    bool p_and_eq_x_y_65237 = eq_x_zz_65234 && not_p_65236;
                    bool dim_match_65238 = p_and_eq_x_y_65235 || p_and_eq_x_y_65237;
                    bool empty_or_match_cert_65239;
                    
                    if (!dim_match_65238) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_65225, "] cannot match shape of type `[", (long long) partitionsPerWindow_42225, "](i64, i64)`.", "-> #0  ftbasics.fut:217:5-222:49\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_65241 = add64(m_64987, start_65011);
                    bool zzero_leq_i_p_m_t_s_65242 = sle64((int64_t) 0, i_p_m_t_s_65241);
                    bool i_p_m_t_s_leq_w_65243 = slt64(i_p_m_t_s_65241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool zzero_lte_i_65244 = sle64((int64_t) 0, start_65011);
                    bool i_lte_j_65245 = sle64(start_65011, end_65012);
                    bool y_65246 = i_p_m_t_s_leq_w_65243 && zzero_lte_i_65244;
                    bool y_65247 = zzero_leq_i_p_m_t_s_65242 && y_65246;
                    bool forwards_ok_65248 = i_lte_j_65245 && y_65247;
                    bool ok_or_empty_65249 = empty_slice_64986 || forwards_ok_65248;
                    bool index_certs_65250;
                    
                    if (!ok_or_empty_65249) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65011, ":", (long long) end_65012, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:108:37-74\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_65019 = add64(nR_42219, nR_42219);
                    int64_t segmap_usable_groups_69031 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_69030);
                    
                    if (memblock_alloc_device(ctx, &mem_75504, bytes_75503, "mem_75504")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_75506, bytes_75503, "mem_75506")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_76713 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_69030));
                    
                    {
                        err = gpu_kernel_inner_SMJ_intzisegmap_69035(ctx, segmap_usable_groups_69031, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_68823, 1, 1, (int64_t) 0, nR_42219, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, max_res_65013, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, zt_rhs_65019, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75495.mem, mem_75504.mem, mem_75506.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_75508 = (int64_t) 8 * ret_65225;
                    
                    if (cond_65223) {
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75504, "mem_75504") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75506, "mem_75506") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75511, bytes_75508, "mem_75511")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_75511, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_75509, bytes_75508, "mem_75509")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_76734 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75504.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        
                        int64_t tmp_offs_76735 = (int64_t) 0;
                        
                        if (!(tmp_offs_76735 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_76735 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75506.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76735 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75509, "mem_75509") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75511, "mem_75511") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
                        return 1;
                    
                    int64_t tmp_65240 = add64((int64_t) 1, p_65008);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75486.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75488.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
                        return 1;
                    
                    bool loop_cond_65253 = slt64(tmp_65240, numberOfWindows_42226);
                    bool loop_while_tmp_76709 = loop_cond_65253;
                    int64_t p_tmp_76710 = tmp_65240;
                    
                    loop_while_65007 = loop_while_tmp_76709;
                    p_65008 = p_tmp_76710;
                }
                defunc_0_windowed_partitionFunc_res_65003 = loop_while_65007;
                defunc_0_windowed_partitionFunc_res_65004 = p_65008;
                if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_75522, bytes_75485, "mem_75522")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75524, bytes_75485, "mem_75524")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_76736 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_69404));
                
                {
                    err = gpu_kernel_inner_SMJ_intzisegmap_69409(ctx, segmap_usable_groups_69405, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69240, 1, 1, (int64_t) 0, nR_42219, gt_rhs_64823, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zeze_rhs_65256, tR_mem_75467.mem, tS_mem_75468.mem, mem_75486.mem, mem_75488.mem, mem_75522.mem, mem_75524.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_75746;
                int64_t ext_75745;
                int64_t ext_75744;
                int64_t ext_75743;
                bool defunc_0_join_chunks_res_65412;
                int64_t defunc_0_join_chunks_res_65413;
                bool loop_while_65416;
                int64_t p_65417;
                int64_t ctx_param_ext_75525;
                int64_t ctx_param_ext_75526;
                int64_t ctx_param_ext_75528;
                int64_t ctx_param_ext_75529;
                
                if (memblock_set_device(ctx, &mem_param_75527, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75530, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75525 = (int64_t) 0;
                ctx_param_ext_75526 = (int64_t) 1;
                ctx_param_ext_75528 = (int64_t) 0;
                ctx_param_ext_75529 = (int64_t) 1;
                loop_while_65416 = loop_cond_65411;
                p_65417 = (int64_t) 0;
                while (loop_while_65416) {
                    bool x_65420 = sle64((int64_t) 0, p_65417);
                    bool y_65421 = slt64(p_65417, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65422 = x_65420 && y_65421;
                    bool index_certs_65423;
                    
                    if (!bounds_check_65422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:186:22-34\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_77410;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77410, mem_75522.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65424 = read_res_77410;
                    int64_t read_res_77411;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77411, mem_75524.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65425 = read_res_77411;
                    int64_t min_res_65426 = smin64(zeze_rhs_65256, loopres_65425);
                    bool cond_65427 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, loopres_65424);
                    bool cond_65431 = slt64(min_res_65426, (int64_t) 0);
                    bool protect_assert_disj_65433 = bounds_check_65422 || cond_65431;
                    bool protect_assert_disj_76139 = cond_65427 || protect_assert_disj_65433;
                    bool index_certs_65434;
                    
                    if (!protect_assert_disj_76139) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:190:19-32\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_65437 = add64((int64_t) 1, p_65417);
                    bool cond_65438 = zeze_lhs_65437 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    bool x_65440 = sle64((int64_t) 0, zeze_lhs_65437);
                    bool y_65441 = slt64(zeze_lhs_65437, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65442 = x_65440 && y_65441;
                    bool protect_assert_disj_65443 = cond_65438 || bounds_check_65442;
                    bool protect_assert_disj_65444 = cond_65431 || protect_assert_disj_65443;
                    bool protect_assert_disj_76142 = cond_65427 || protect_assert_disj_65444;
                    bool index_certs_65445;
                    
                    if (!protect_assert_disj_76142) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65437, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:191:49-64\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_76136 = !cond_65427;
                    bool x_65432 = !cond_65431;
                    bool protect_cond_conj_76140 = x_65432 && x_76136;
                    int64_t loopres_f_res_f_res_65435;
                    
                    if (protect_cond_conj_76140) {
                        int64_t read_res_77412;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77412, mem_75486.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66705 = read_res_77412;
                        
                        loopres_f_res_f_res_65435 = x_66705;
                    } else {
                        loopres_f_res_f_res_65435 = (int64_t) 0;
                    }
                    
                    bool x_65439 = !cond_65438;
                    bool protect_cond_conj_65446 = x_65432 && x_65439;
                    bool protect_cond_conj_76143 = protect_cond_conj_65446 && x_76136;
                    int64_t r_end_f_res_65447;
                    
                    if (protect_cond_conj_76143) {
                        int64_t read_res_77413;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77413, mem_75486.mem, zeze_lhs_65437 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66706 = read_res_77413;
                        
                        r_end_f_res_65447 = x_66706;
                    } else {
                        r_end_f_res_65447 = (int64_t) 0;
                    }
                    
                    int64_t r_end_65449;
                    
                    if (cond_65438) {
                        r_end_65449 = nR_42219;
                    } else {
                        r_end_65449 = r_end_f_res_65447;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 = sub64(r_end_65449, loopres_f_res_f_res_65435);
                    int64_t ext_75735;
                    
                    if (cond_65431) {
                        ext_75735 = ctx_param_ext_75525;
                    } else {
                        ext_75735 = (int64_t) 0;
                    }
                    
                    int64_t ext_75734;
                    
                    if (cond_65431) {
                        ext_75734 = ctx_param_ext_75526;
                    } else {
                        ext_75734 = (int64_t) 1;
                    }
                    
                    int64_t ext_75732;
                    
                    if (cond_65431) {
                        ext_75732 = ctx_param_ext_75528;
                    } else {
                        ext_75732 = (int64_t) 0;
                    }
                    
                    int64_t ext_75731;
                    
                    if (cond_65431) {
                        ext_75731 = ctx_param_ext_75529;
                    } else {
                        ext_75731 = (int64_t) 1;
                    }
                    
                    int64_t bytes_75531 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;
                    int64_t ext_75741;
                    
                    if (cond_65427) {
                        ext_75741 = ctx_param_ext_75525;
                    } else {
                        ext_75741 = ext_75735;
                    }
                    
                    int64_t ext_75740;
                    
                    if (cond_65427) {
                        ext_75740 = ctx_param_ext_75526;
                    } else {
                        ext_75740 = ext_75734;
                    }
                    
                    int64_t ext_75738;
                    
                    if (cond_65427) {
                        ext_75738 = ctx_param_ext_75528;
                    } else {
                        ext_75738 = ext_75732;
                    }
                    
                    int64_t ext_75737;
                    
                    if (cond_65427) {
                        ext_75737 = ctx_param_ext_75529;
                    } else {
                        ext_75737 = ext_75731;
                    }
                    
                    int64_t loopres_65428;
                    
                    if (cond_65427) {
                        loopres_65428 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    } else {
                        loopres_65428 = zeze_lhs_65437;
                    }
                    if (cond_65427) {
                        if (memblock_set_device(ctx, &ext_mem_75742, &mem_param_75527, "mem_param_75527") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &mem_param_75530, "mem_param_75530") != 0)
                            return 1;
                    } else {
                        if (cond_65431) {
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_param_75527, "mem_param_75527") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_param_75530, "mem_param_75530") != 0)
                                return 1;
                        } else {
                            bool empty_slice_65453 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 == (int64_t) 0;
                            int64_t m_65454 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 1);
                            int64_t i_p_m_t_s_65455 = add64(loopres_f_res_f_res_65435, m_65454);
                            bool zzero_leq_i_p_m_t_s_65456 = sle64((int64_t) 0, i_p_m_t_s_65455);
                            bool i_p_m_t_s_leq_w_65457 = slt64(i_p_m_t_s_65455, nR_42219);
                            bool zzero_lte_i_65458 = sle64((int64_t) 0, loopres_f_res_f_res_65435);
                            bool i_lte_j_65459 = sle64(loopres_f_res_f_res_65435, r_end_65449);
                            bool y_65460 = i_p_m_t_s_leq_w_65457 && zzero_lte_i_65458;
                            bool y_65461 = zzero_leq_i_p_m_t_s_65456 && y_65460;
                            bool forwards_ok_65462 = i_lte_j_65459 && y_65461;
                            bool ok_or_empty_65463 = empty_slice_65453 || forwards_ok_65462;
                            bool index_certs_65464;
                            
                            if (!ok_or_empty_65463) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_65435, ":", (long long) r_end_65449, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftSMJ.fut:192:16-33\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_65467 = sle64(loopres_65424, min_res_65426);
                            bool loop_not_taken_65472 = !loop_cond_65467;
                            bool protect_assert_disj_65473 = loop_not_taken_65472 || nonzzero_66377;
                            bool nonzzero_cert_65474;
                            
                            if (!protect_assert_disj_65473) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75532, bytes_75531, "mem_75532")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75532, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75534, bytes_75531, "mem_75534")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75534, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_65468 = add64(extParallelism_42227, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                            int64_t zs_lhs_65469 = sub64(zm_lhs_65468, (int64_t) 1);
                            int64_t numIter_65475 = sdiv_safe64(zs_lhs_65469, extParallelism_42227);
                            bool loop_cond_65476 = slt64((int64_t) 0, numIter_65475);
                            bool loop_not_taken_65477 = !loop_cond_65476;
                            int64_t segmap_tblock_sizze_69757;
                            
                            segmap_tblock_sizze_69757 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69747;
                            
                            int64_t segmap_usable_groups_69758 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69757);
                            int64_t segmap_tblock_sizze_69778;
                            
                            segmap_tblock_sizze_69778 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69769;
                            
                            int64_t segmap_usable_groups_69779 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69778);
                            
                            if (memblock_alloc_device(ctx, &mem_75553, (int64_t) 4, "mem_75553")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75554, (int64_t) 4, "mem_75554")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75557, (int64_t) 1, "mem_75557")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_65478;
                            int64_t loopres_f_res_f_res_65479;
                            bool loop_while_65482;
                            int64_t dp_65483;
                            
                            if (memblock_set_device(ctx, &mem_param_75537, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_75540, &mem_75532, "mem_75532") != 0)
                                return 1;
                            loop_while_65482 = loop_cond_65467;
                            dp_65483 = loopres_65424;
                            while (loop_while_65482) {
                                bool x_65486 = sle64((int64_t) 0, dp_65483);
                                bool y_65487 = slt64(dp_65483, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65488 = x_65486 && y_65487;
                                bool index_certs_65489;
                                
                                if (!bounds_check_65488) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_65483, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:196:21-38\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_77414;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_77414, mem_75488.mem, dp_65483 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_65490 = read_res_77414;
                                int64_t zeze_lhs_65491 = add64((int64_t) 1, dp_65483);
                                bool cond_65492 = zeze_lhs_65491 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                                bool x_65493 = !cond_65492;
                                bool x_65494 = sle64((int64_t) 0, zeze_lhs_65491);
                                bool y_65495 = slt64(zeze_lhs_65491, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65496 = x_65494 && y_65495;
                                bool protect_assert_disj_65497 = cond_65492 || bounds_check_65496;
                                bool index_certs_65498;
                                
                                if (!protect_assert_disj_65497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65491, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:197:55-74\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_65499;
                                
                                if (x_65493) {
                                    int64_t read_res_77415;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77415, mem_75488.mem, zeze_lhs_65491 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_66707 = read_res_77415;
                                    
                                    s_end_f_res_65499 = x_66707;
                                } else {
                                    s_end_f_res_65499 = (int64_t) 0;
                                }
                                
                                int64_t s_end_65501;
                                
                                if (cond_65492) {
                                    s_end_65501 = nR_42219;
                                } else {
                                    s_end_65501 = s_end_f_res_65499;
                                }
                                
                                int64_t j_m_i_65502 = sub64(s_end_65501, loopres_65490);
                                bool empty_slice_65503 = j_m_i_65502 == (int64_t) 0;
                                int64_t m_65504 = sub64(j_m_i_65502, (int64_t) 1);
                                int64_t i_p_m_t_s_65505 = add64(loopres_65490, m_65504);
                                bool zzero_leq_i_p_m_t_s_65506 = sle64((int64_t) 0, i_p_m_t_s_65505);
                                bool i_p_m_t_s_leq_w_65507 = slt64(i_p_m_t_s_65505, nR_42219);
                                bool zzero_lte_i_65508 = sle64((int64_t) 0, loopres_65490);
                                bool i_lte_j_65509 = sle64(loopres_65490, s_end_65501);
                                bool y_65510 = i_p_m_t_s_leq_w_65507 && zzero_lte_i_65508;
                                bool y_65511 = zzero_leq_i_p_m_t_s_65506 && y_65510;
                                bool forwards_ok_65512 = i_lte_j_65509 && y_65511;
                                bool ok_or_empty_65513 = empty_slice_65503 || forwards_ok_65512;
                                bool index_certs_65514;
                                
                                if (!ok_or_empty_65513) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65490, ":", (long long) s_end_65501, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  ftSMJ.fut:198:18-35\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_65517 = slt64((int64_t) 0, j_m_i_65502);
                                bool loop_not_taken_65518 = !cond_65517;
                                bool x_65519 = sle64((int64_t) 0, m_65504);
                                bool y_65520 = slt64(m_65504, j_m_i_65502);
                                bool bounds_check_65524 = x_65519 && y_65520;
                                bool protect_assert_disj_65525 = loop_not_taken_65518 || bounds_check_65524;
                                bool protect_assert_disj_65526 = loop_not_taken_65477 || protect_assert_disj_65525;
                                bool index_certs_65527;
                                
                                if (!protect_assert_disj_65526) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65504, "] out of bounds for array of shape [", (long long) j_m_i_65502, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_65911 = tS_start_64840 + loopres_65490;
                                int64_t find_joinTuples_arg3_65516 = add64(join_chunks_arg3_64981, loopres_65490);
                                bool protect_cond_conj_65521 = loop_cond_65476 && cond_65517;
                                
                                if (protect_cond_conj_65521) {
                                    if (memblock_alloc_device(ctx, &mem_75542, (int64_t) 4, "mem_75542")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_76765(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65911, tS_mem_75468.mem, mem_75542.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75542, "mem_75542") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75541, (int64_t) 4, "mem_75541")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i32(ctx, mem_75541, (int64_t) 1, 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75541, "mem_75541") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_65521) {
                                    int64_t slice_66709 = tS_start_64840 + i_p_m_t_s_65505;
                                    
                                    if (memblock_alloc_device(ctx, &mem_75545, (int64_t) 4, "mem_75545")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_76771(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_66709, tS_mem_75468.mem, mem_75545.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75545, "mem_75545") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75544, (int64_t) 4, "mem_75544")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i32(ctx, mem_75544, (int64_t) 1, 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75544, "mem_75544") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_75559 = (int64_t) 4 * j_m_i_65502;
                                int64_t ext_75706;
                                int64_t ext_75705;
                                int64_t ext_75704;
                                int64_t ext_75703;
                                bool defunc_0_find_joinTuples_res_65530;
                                int64_t defunc_0_find_joinTuples_res_65531;
                                bool loop_while_65534;
                                int64_t p_65535;
                                int64_t ctx_param_ext_75547;
                                int64_t ctx_param_ext_75548;
                                int64_t ctx_param_ext_75550;
                                int64_t ctx_param_ext_75551;
                                
                                if (memblock_set_device(ctx, &mem_param_75549, &mem_75534, "mem_75534") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75552, &mem_75532, "mem_75532") != 0)
                                    return 1;
                                ctx_param_ext_75547 = (int64_t) 0;
                                ctx_param_ext_75548 = (int64_t) 1;
                                ctx_param_ext_75550 = (int64_t) 0;
                                ctx_param_ext_75551 = (int64_t) 1;
                                loop_while_65534 = loop_cond_65476;
                                p_65535 = (int64_t) 0;
                                while (loop_while_65534) {
                                    int64_t start_65538 = mul64(extParallelism_42227, p_65535);
                                    int64_t min_arg1_65539 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, start_65538);
                                    int64_t min_res_65540 = smin64(extParallelism_42227, min_arg1_65539);
                                    int64_t iter_R_65541 = add64(start_65538, min_res_65540);
                                    bool empty_slice_65542 = min_res_65540 == (int64_t) 0;
                                    int64_t m_65543 = sub64(min_res_65540, (int64_t) 1);
                                    int64_t i_p_m_t_s_65544 = add64(start_65538, m_65543);
                                    bool zzero_leq_i_p_m_t_s_65545 = sle64((int64_t) 0, i_p_m_t_s_65544);
                                    bool i_p_m_t_s_leq_w_65546 = slt64(i_p_m_t_s_65544, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                                    bool zzero_lte_i_65547 = sle64((int64_t) 0, start_65538);
                                    bool i_lte_j_65548 = sle64(start_65538, iter_R_65541);
                                    bool y_65549 = i_p_m_t_s_leq_w_65546 && zzero_lte_i_65547;
                                    bool y_65550 = zzero_leq_i_p_m_t_s_65545 && y_65549;
                                    bool forwards_ok_65551 = i_lte_j_65548 && y_65550;
                                    bool ok_or_empty_65552 = empty_slice_65542 || forwards_ok_65551;
                                    bool index_certs_65553;
                                    
                                    if (!ok_or_empty_65552) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65538, ":", (long long) iter_R_65541, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65560 = slt64(m_65543, min_res_65540);
                                    bool x_65559 = sle64((int64_t) 0, m_65543);
                                    bool bounds_check_65561 = x_65559 && y_65560;
                                    bool index_certs_65562;
                                    
                                    if (!bounds_check_65561) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65543, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65556 = slt64((int64_t) 0, min_res_65540);
                                    bool index_certs_65557;
                                    
                                    if (!y_65556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:363:133-136\n   #2  ftSMJ.fut:352:1-363:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_65554 = loopres_f_res_f_res_65435 + start_65538;
                                    int64_t slice_65563 = loopres_f_res_f_res_65435 + i_p_m_t_s_65544;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_76787(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65554, slice_65563, tR_mem_75467.mem, mem_75553.mem, mem_75554.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75555, &ext_mem_75546, "ext_mem_75546") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75555, &mem_75553, "mem_75553") != 0)
                                        return 1;
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75556, &ext_mem_75543, "ext_mem_75543") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75556, &mem_75554, "mem_75554") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_intzigpuseq_76793(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75554.mem, ext_mem_75555.mem, mem_75557.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
                                        return 1;
                                    
                                    bool read_res_77416;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77416, mem_75557.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_65567 = read_res_77416;
                                    int64_t ext_75701;
                                    int64_t ext_75700;
                                    int64_t ext_75698;
                                    int64_t ext_75697;
                                    int64_t loopres_65568;
                                    
                                    if (defunc_0_gt_res_65567) {
                                        if (memblock_set_device(ctx, &ext_mem_75702, &mem_param_75549, "mem_param_75549") != 0)
                                            return 1;
                                        ext_75701 = ctx_param_ext_75547;
                                        ext_75700 = ctx_param_ext_75548;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &mem_param_75552, "mem_param_75552") != 0)
                                            return 1;
                                        ext_75698 = ctx_param_ext_75550;
                                        ext_75697 = ctx_param_ext_75551;
                                        loopres_65568 = numIter_65475;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_75558, (int64_t) 1, "mem_75558")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_intzigpuseq_76799(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75553.mem, ext_mem_75556.mem, mem_75558.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_77417;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_77417, mem_75558.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_65571 = read_res_77417;
                                        
                                        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
                                            return 1;
                                        
                                        int64_t ext_75695;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75695 = ctx_param_ext_75547;
                                        } else {
                                            ext_75695 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75694;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75694 = ctx_param_ext_75548;
                                        } else {
                                            ext_75694 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_75692;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75692 = ctx_param_ext_75550;
                                        } else {
                                            ext_75692 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75691;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75691 = ctx_param_ext_75551;
                                        } else {
                                            ext_75691 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_65572;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            int64_t tmp_66713 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_param_75549, "mem_param_75549") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_param_75552, "mem_param_75552") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_66713;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_75560, bytes_75559, "mem_75560")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75560.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, slice_65911, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65502})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_7587(ctx, &ext_mem_75562, mem_75560, j_m_i_65502, find_joinTuples_arg3_65516) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_69569;
                                            
                                            suff_outer_par_69569 = *ctx->tuning_params.inner_SMJ_intzisuff_outer_par_1 <= min_res_65540;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_int.suff_outer_par_1", (long) min_res_65540, suff_outer_par_69569 ? "true" : "false");
                                            
                                            int64_t tile_sizze_74966;
                                            
                                            tile_sizze_74966 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965;
                                            
                                            int64_t tile_sizze_74611;
                                            
                                            tile_sizze_74611 = *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610;
                                            
                                            int64_t num_whole_tiles_74982 = squot_safe64(j_m_i_65502, tile_sizze_74966);
                                            int64_t residual_input_75206 = srem_safe64(j_m_i_65502, tile_sizze_74966);
                                            bool cond_75207 = residual_input_75206 == (int64_t) 0;
                                            int64_t binop_x_75223 = tile_sizze_74966 * num_whole_tiles_74982;
                                            int64_t bytes_75620 = (int64_t) 8 * min_res_65540;
                                            int64_t bytes_75583 = (int64_t) 8 * tile_sizze_74966;
                                            int64_t bytes_75585 = (int64_t) 4 * tile_sizze_74966;
                                            int64_t num_whole_tiles_74627 = squot_safe64(j_m_i_65502, tile_sizze_74611);
                                            int64_t residual_input_74851 = srem_safe64(j_m_i_65502, tile_sizze_74611);
                                            bool cond_74852 = residual_input_74851 == (int64_t) 0;
                                            int64_t binop_x_74868 = tile_sizze_74611 * num_whole_tiles_74627;
                                            int64_t bytes_75644 = (int64_t) 8 * tile_sizze_74611;
                                            int64_t bytes_75646 = (int64_t) 4 * tile_sizze_74611;
                                            int64_t shared_memory_capacity_76857;
                                            
                                            shared_memory_capacity_76857 = ctx->max_shared_memory;
                                            if (suff_outer_par_69569 && sle64(sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75646, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76857)) {
                                                int64_t ldim_74612 = sdiv_up64(min_res_65540, tile_sizze_74611);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75682, bytes_75620, "mem_75682")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75684, bytes_75620, "mem_75684")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76805 = sext_i64_i32(sdiv_up64(tile_sizze_74611, tile_sizze_74611));
                                                int32_t virt_num_tblocks_76806 = sext_i64_i32(ldim_74612);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_74609(ctx, ldim_74612, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_74610, 1, 1, bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8) + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8)) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74612, num_whole_tiles_74627, residual_input_74851, cond_74852, binop_x_74868, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75682.mem, mem_75684.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75682, "mem_75682") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75684, "mem_75684") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_74967 = sdiv_up64(min_res_65540, tile_sizze_74966);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75621, bytes_75620, "mem_75621")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75623, bytes_75620, "mem_75623")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76831 = sext_i64_i32(sdiv_up64(tile_sizze_74966, tile_sizze_74966));
                                                int32_t virt_num_tblocks_76832 = sext_i64_i32(ldim_74967);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_intzisegmap_intrablock_74964(ctx, ldim_74967, 1, 1, *ctx->tuning_params.inner_SMJ_intzitile_sizze_74965, 1, 1, bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8) + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8)) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74967, num_whole_tiles_74982, residual_input_75206, cond_75207, binop_x_75223, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75621.mem, mem_75623.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75621, "mem_75621") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75623, "mem_75623") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75688, bytes_75531, "mem_75688")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75552.mem, ctx_param_ext_75550, (int64_t []) {ctx_param_ext_75551}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75686.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75690, bytes_75531, "mem_75690")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75549.mem, ctx_param_ext_75547, (int64_t []) {ctx_param_ext_75548}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
                                                return 1;
                                            
                                            int64_t tmp_65619 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_75690, "mem_75690") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_75688, "mem_75688") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_65619;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_75702, &ext_mem_75696, "ext_mem_75696") != 0)
                                            return 1;
                                        ext_75701 = ext_75695;
                                        ext_75700 = ext_75694;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &ext_mem_75693, "ext_mem_75693") != 0)
                                            return 1;
                                        ext_75698 = ext_75692;
                                        ext_75697 = ext_75691;
                                        loopres_65568 = loopres_f_res_65572;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
                                        return 1;
                                    
                                    bool loop_cond_65620 = slt64(loopres_65568, numIter_65475);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_76777, &ext_mem_75702, "ext_mem_75702") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_76778, &ext_mem_75699, "ext_mem_75699") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_76779 = ext_75701;
                                    int64_t ctx_param_ext_tmp_76780 = ext_75700;
                                    int64_t ctx_param_ext_tmp_76781 = ext_75698;
                                    int64_t ctx_param_ext_tmp_76782 = ext_75697;
                                    bool loop_while_tmp_76783 = loop_cond_65620;
                                    int64_t p_tmp_76784 = loopres_65568;
                                    
                                    if (memblock_set_device(ctx, &mem_param_75549, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_75552, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
                                        return 1;
                                    ctx_param_ext_75547 = ctx_param_ext_tmp_76779;
                                    ctx_param_ext_75548 = ctx_param_ext_tmp_76780;
                                    ctx_param_ext_75550 = ctx_param_ext_tmp_76781;
                                    ctx_param_ext_75551 = ctx_param_ext_tmp_76782;
                                    loop_while_65534 = loop_while_tmp_76783;
                                    p_65535 = p_tmp_76784;
                                }
                                if (memblock_set_device(ctx, &ext_mem_75708, &mem_param_75549, "mem_param_75549") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75707, &mem_param_75552, "mem_param_75552") != 0)
                                    return 1;
                                ext_75706 = ctx_param_ext_75547;
                                ext_75705 = ctx_param_ext_75548;
                                ext_75704 = ctx_param_ext_75550;
                                ext_75703 = ctx_param_ext_75551;
                                defunc_0_find_joinTuples_res_65530 = loop_while_65534;
                                defunc_0_find_joinTuples_res_65531 = p_65535;
                                if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75711, bytes_75531, "mem_75711")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76858 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69757));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_69761(ctx, segmap_usable_groups_69758, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69747, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75703, ext_75704, mem_param_75540.mem, ext_mem_75707.mem, mem_75711.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75714, bytes_75531, "mem_75714")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76867 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69778));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_intzisegmap_69782(ctx, segmap_usable_groups_69779, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69769, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75705, ext_75706, mem_param_75537.mem, ext_mem_75708.mem, mem_75714.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
                                    return 1;
                                
                                bool loop_cond_65630 = sle64(zeze_lhs_65491, min_res_65426);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_76759, &mem_75714, "mem_75714") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_76760, &mem_75711, "mem_75711") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_76761 = loop_cond_65630;
                                int64_t dp_tmp_76762 = zeze_lhs_65491;
                                
                                if (memblock_set_device(ctx, &mem_param_75537, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75540, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
                                    return 1;
                                loop_while_65482 = loop_while_tmp_76761;
                                dp_65483 = dp_tmp_76762;
                            }
                            if (memblock_set_device(ctx, &ext_mem_75720, &mem_param_75537, "mem_param_75537") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75719, &mem_param_75540, "mem_param_75540") != 0)
                                return 1;
                            loopres_f_res_f_res_65478 = loop_while_65482;
                            loopres_f_res_f_res_65479 = dp_65483;
                            if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_69799;
                            
                            segmap_tblock_sizze_69799 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69789;
                            
                            int64_t segmap_usable_groups_69800 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69799);
                            
                            if (memblock_alloc_device(ctx, &mem_75723, bytes_75531, "mem_75723")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76876 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69799));
                            
                            {
                                err = gpu_kernel_inner_SMJ_intzisegmap_69803(ctx, segmap_usable_groups_69800, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69789, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75528, ctx_param_ext_75529, mem_param_75530.mem, ext_mem_75719.mem, mem_75723.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_69820;
                            
                            segmap_tblock_sizze_69820 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69811;
                            
                            int64_t segmap_usable_groups_69821 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69820);
                            
                            if (memblock_alloc_device(ctx, &mem_75726, bytes_75531, "mem_75726")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76885 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_69820));
                            
                            {
                                err = gpu_kernel_inner_SMJ_intzisegmap_69824(ctx, segmap_usable_groups_69821, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69811, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75525, ctx_param_ext_75526, mem_param_75527.mem, ext_mem_75720.mem, mem_75726.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75728, bytes_75470, "mem_75728")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75530.mem, ctx_param_ext_75528, (int64_t []) {ctx_param_ext_75529}, (int64_t []) {nR_42219})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75723.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75730, bytes_75470, "mem_75730")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75527.mem, ctx_param_ext_75525, (int64_t []) {ctx_param_ext_75526}, (int64_t []) {nR_42219})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_75730, "mem_75730") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_75728, "mem_75728") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75742, &ext_mem_75736, "ext_mem_75736") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &ext_mem_75733, "ext_mem_75733") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_65646 = slt64(loopres_65428, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76749, &ext_mem_75742, "ext_mem_75742") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76750, &ext_mem_75739, "ext_mem_75739") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76751 = ext_75741;
                    int64_t ctx_param_ext_tmp_76752 = ext_75740;
                    int64_t ctx_param_ext_tmp_76753 = ext_75738;
                    int64_t ctx_param_ext_tmp_76754 = ext_75737;
                    bool loop_while_tmp_76755 = loop_cond_65646;
                    int64_t p_tmp_76756 = loopres_65428;
                    
                    if (memblock_set_device(ctx, &mem_param_75527, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75530, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
                        return 1;
                    ctx_param_ext_75525 = ctx_param_ext_tmp_76751;
                    ctx_param_ext_75526 = ctx_param_ext_tmp_76752;
                    ctx_param_ext_75528 = ctx_param_ext_tmp_76753;
                    ctx_param_ext_75529 = ctx_param_ext_tmp_76754;
                    loop_while_65416 = loop_while_tmp_76755;
                    p_65417 = p_tmp_76756;
                }
                if (memblock_set_device(ctx, &ext_mem_75748, &mem_param_75527, "mem_param_75527") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75747, &mem_param_75530, "mem_param_75530") != 0)
                    return 1;
                ext_75746 = ctx_param_ext_75525;
                ext_75745 = ctx_param_ext_75526;
                ext_75744 = ctx_param_ext_75528;
                ext_75743 = ctx_param_ext_75529;
                defunc_0_join_chunks_res_65412 = loop_while_65416;
                defunc_0_join_chunks_res_65413 = p_65417;
                if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75748, "ext_mem_75748") != 0)
                    return 1;
                ext_75918 = ext_75746;
                ext_75917 = ext_75745;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75747, "ext_mem_75747") != 0)
                    return 1;
                ext_75915 = ext_75744;
                ext_75914 = ext_75743;
            }
            
            int64_t segmap_tblock_sizze_69841;
            
            segmap_tblock_sizze_69841 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69831;
            
            int64_t segmap_usable_groups_69842 = sdiv_up64(nR_42219, segmap_tblock_sizze_69841);
            
            if (memblock_alloc_device(ctx, &mem_75922, bytes_75470, "mem_75922")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76894 = sext_i64_i32(sdiv_up64(nR_42219, segmap_tblock_sizze_69841));
            
            {
                err = gpu_kernel_inner_SMJ_intzisegmap_69845(ctx, segmap_usable_groups_69842, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69831, 1, 1, (int64_t) 0, nR_42219, ext_75914, ext_75915, mem_param_75482.mem, ext_mem_75916.mem, mem_75922.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_69862;
            
            segmap_tblock_sizze_69862 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69853;
            
            int64_t segmap_usable_groups_69863 = sdiv_up64(nR_42219, segmap_tblock_sizze_69862);
            
            if (memblock_alloc_device(ctx, &mem_75925, bytes_75470, "mem_75925")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76903 = sext_i64_i32(sdiv_up64(nR_42219, segmap_tblock_sizze_69862));
            
            {
                err = gpu_kernel_inner_SMJ_intzisegmap_69866(ctx, segmap_usable_groups_69863, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69853, 1, 1, (int64_t) 0, nR_42219, ext_75917, ext_75918, mem_param_75479.mem, ext_mem_75919.mem, mem_75925.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_75926, (int64_t) 1, "mem_75926")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_intzigpuseq_76912(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, i_p_m_t_s_64846, tR_mem_75467.mem, tS_mem_75468.mem, mem_75926.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_77418;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_77418, mem_75926.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_65663 = read_res_77418;
            
            if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
                return 1;
            
            int64_t nextIter_65664;
            
            if (defunc_0_leq_res_65663) {
                int64_t nextIter_t_res_66728 = add64((int64_t) 1, p_64837);
                
                nextIter_65664 = nextIter_t_res_66728;
            } else {
                nextIter_65664 = numIter_64817;
            }
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_75925, "mem_75925") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_75922, "mem_75922") != 0)
                return 1;
            loopres_64861 = nextIter_65664;
        }
        
        bool loop_cond_65666 = slt64(loopres_64861, numIter_64817);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76592, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76593, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        
        bool loop_while_tmp_76594 = loop_cond_65666;
        int64_t p_tmp_76595 = loopres_64861;
        
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75482, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        loop_while_64836 = loop_while_tmp_76594;
        p_64837 = p_tmp_76595;
    }
    if (memblock_set_device(ctx, &ext_mem_75938, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75937, &mem_param_75482, "mem_param_75482") != 0)
        return 1;
    defunc_0_mergeJoin_res_64832 = loop_while_64836;
    defunc_0_mergeJoin_res_64833 = p_64837;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_69872;
    
    segscan_tblock_sizze_69872 = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69871;
    
    int64_t num_tblocks_69874;
    int64_t max_num_tblocks_76918;
    
    max_num_tblocks_76918 = *ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_69873;
    num_tblocks_69874 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_42219, segscan_tblock_sizze_69872), max_num_tblocks_76918)));
    if (memblock_alloc_device(ctx, &mem_75941, bytes_75470, "mem_75941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75943, bytes_75470, "mem_75943")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_42219)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_76919;
        
        shared_memory_76919 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_76920;
        
        thread_block_sizze_76920 = ctx->max_thread_block_size;
        
        int64_t registers_76921;
        
        registers_76921 = ctx->max_registers;
        
        int64_t thread_block_sizze_76922;
        
        thread_block_sizze_76922 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_76923 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_76919, thread_block_sizze_76920), (int64_t) 8), squot64(squot64(registers_76921, thread_block_sizze_76922) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_76924 = sdiv_up64(nR_42219, segscan_tblock_sizze_69872 * chunk_sizze_76923);
        int64_t num_virt_threads_76925 = num_virt_blocks_76924 * segscan_tblock_sizze_69872;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_76923, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_76926, num_virt_blocks_76924, "status_flags_mem_76926")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_76926, num_virt_blocks_76924, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_76948, (int64_t) 8 * num_virt_blocks_76924, "aggregates_mem_76948")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_76950, (int64_t) 8 * num_virt_blocks_76924, "incprefixes_mem_76950")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzisegscan_69877(ctx, num_tblocks_69874, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69871, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69872), chunk_sizze_76923 * segscan_tblock_sizze_69872 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69872), chunk_sizze_76923 * segscan_tblock_sizze_69872 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_42219, num_tblocks_69874, num_virt_blocks_76924, num_virt_threads_76925, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, status_flags_mem_76926.mem, aggregates_mem_76948.mem, incprefixes_mem_76950.mem, global_dynid_mem_76952.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_65682 = zzero_64814 || bounds_check_64826;
    bool index_certs_65683;
    
    if (!protect_assert_disj_65682) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65684;
    
    if (nonzzero_64815) {
        int64_t read_res_77419;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77419, mem_75941.mem, gt_rhs_64823 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66731 = read_res_77419;
        
        m_f_res_65684 = x_66731;
    } else {
        m_f_res_65684 = (int64_t) 0;
    }
    
    int64_t m_65686;
    
    if (zzero_64814) {
        m_65686 = (int64_t) 0;
    } else {
        m_65686 = m_f_res_65684;
    }
    
    int64_t m_65696 = sub64(m_65686, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65698 = slt64(m_65696, nR_42219);
    bool zzero_leq_i_p_m_t_s_65697 = sle64((int64_t) 0, m_65696);
    bool y_65700 = zzero_leq_i_p_m_t_s_65697 && i_p_m_t_s_leq_w_65698;
    bool i_lte_j_65699 = sle64((int64_t) 0, m_65686);
    bool forwards_ok_65701 = i_lte_j_65699 && y_65700;
    bool eq_x_zz_65693 = (int64_t) 0 == m_f_res_65684;
    bool p_and_eq_x_y_65694 = nonzzero_64815 && eq_x_zz_65693;
    bool empty_slice_65695 = zzero_64814 || p_and_eq_x_y_65694;
    bool ok_or_empty_65702 = empty_slice_65695 || forwards_ok_65701;
    bool index_certs_65703;
    
    if (!ok_or_empty_65702) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65686, "] out of bounds for array of shape [", (long long) nR_42219, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75944 = (int64_t) 8 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75945, bytes_75944, "mem_75945")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75947, bytes_75944, "mem_75947")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75949, bytes_75944, "mem_75949")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75469.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t bytes_75950 = (int64_t) 4 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75951, bytes_75950, "mem_75951")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_75467.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_69882;
    
    segmap_tblock_sizze_69882 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69881;
    
    int64_t num_tblocks_69884;
    int64_t max_num_tblocks_77041;
    
    max_num_tblocks_77041 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69883;
    num_tblocks_69884 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_42219, segmap_tblock_sizze_69882), max_num_tblocks_77041)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77042 = sext_i64_i32(sdiv_up64(nR_42219, segmap_tblock_sizze_69882));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_69879(ctx, num_tblocks_69884, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69881, 1, 1, (int64_t) 0, nR_42219, m_65686, num_tblocks_69884, virt_num_tblocks_77042, tR_mem_75467.mem, ext_mem_75469.mem, ext_mem_75937.mem, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, mem_75945.mem, mem_75947.mem, mem_75949.mem, mem_75951.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_69888;
    
    segscan_tblock_sizze_69888 = *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69887;
    
    int64_t num_tblocks_69890;
    int64_t max_num_tblocks_77055;
    
    max_num_tblocks_77055 = *ctx->tuning_params.inner_SMJ_intzisegscan_num_tblocks_69889;
    num_tblocks_69890 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segscan_tblock_sizze_69888), max_num_tblocks_77055)));
    if (memblock_alloc_device(ctx, &mem_75955, bytes_75944, "mem_75955")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75957, bytes_75944, "mem_75957")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75959, bytes_75944, "mem_75959")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_65686)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_77056;
        
        shared_memory_77056 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_77057;
        
        thread_block_sizze_77057 = ctx->max_thread_block_size;
        
        int64_t registers_77058;
        
        registers_77058 = ctx->max_registers;
        
        int64_t thread_block_sizze_77059;
        
        thread_block_sizze_77059 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_77060 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_77056, thread_block_sizze_77057), (int64_t) 8), squot64(squot64(registers_77058, thread_block_sizze_77059) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_77061 = sdiv_up64(m_65686, segscan_tblock_sizze_69888 * chunk_sizze_77060);
        int64_t num_virt_threads_77062 = num_virt_blocks_77061 * segscan_tblock_sizze_69888;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_77060, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_77063, num_virt_blocks_77061, "status_flags_mem_77063")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_77063, num_virt_blocks_77061, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77065, (int64_t) 8 * num_virt_blocks_77061, "aggregates_mem_77065")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77067, (int64_t) 8 * num_virt_blocks_77061, "incprefixes_mem_77067")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77069, (int64_t) 8 * num_virt_blocks_77061, "aggregates_mem_77069")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77071, (int64_t) 8 * num_virt_blocks_77061, "incprefixes_mem_77071")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzisegscan_69893(ctx, num_tblocks_69890, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegscan_tblock_sizze_69887, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_69888, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_69888), smax64(chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_69888, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_69888), smax64(chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_69888 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_65686, num_tblocks_69890, num_virt_blocks_77061, num_virt_threads_77062, mem_75945.mem, mem_75955.mem, mem_75957.mem, mem_75959.mem, status_flags_mem_77063.mem, aggregates_mem_77065.mem, incprefixes_mem_77067.mem, aggregates_mem_77069.mem, incprefixes_mem_77071.mem, global_dynid_mem_77073.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_69909;
    
    segmap_tblock_sizze_69909 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69897;
    
    int64_t segmap_usable_groups_69910 = sdiv_up64(m_65686, segmap_tblock_sizze_69909);
    
    if (memblock_alloc_device(ctx, &mem_75962, bytes_75944, "mem_75962")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77208 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_69909));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_69913(ctx, segmap_usable_groups_69910, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69897, 1, 1, (int64_t) 0, m_65686, mem_75955.mem, mem_75962.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
        return 1;
    
    bool cond_65737 = slt64((int64_t) 0, m_65686);
    bool y_65738 = slt64(m_65696, m_65686);
    bool bounds_check_65739 = zzero_leq_i_p_m_t_s_65697 && y_65738;
    bool loop_not_taken_65740 = !cond_65737;
    bool protect_assert_disj_65741 = bounds_check_65739 || loop_not_taken_65740;
    bool index_certs_65742;
    
    if (!protect_assert_disj_65741) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  ftSMJ.fut:284:10-41\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75964, (int64_t) 8, "mem_75964")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_77217(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75962.mem, mem_75964.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75964, "mem_75964") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75963, (int64_t) 8, "mem_75963")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75963, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75963, "mem_75963") != 0)
            return 1;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75967, (int64_t) 8, "mem_75967")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_77223(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75945.mem, mem_75967.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75967, "mem_75967") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75966, (int64_t) 8, "mem_75966")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75966, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75966, "mem_75966") != 0)
            return 1;
    }
    
    bool zzero_65754 = scatter_psizze_42228 == (int64_t) 0;
    bool nonzzero_65755 = !zzero_65754;
    bool nonzzero_cert_65756;
    
    if (!nonzzero_65755) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_65821 = !empty_slice_65695;
    bool protect_assert_disj_65822 = empty_slice_65695 || bounds_check_65739;
    bool index_certs_65823;
    
    if (!protect_assert_disj_65822) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65824;
    
    if (x_65821) {
        int64_t read_res_77420;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77420, mem_75957.mem, m_65696 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66739 = read_res_77420;
        
        m_f_res_65824 = x_66739;
    } else {
        m_f_res_65824 = (int64_t) 0;
    }
    
    int64_t m_65826;
    
    if (empty_slice_65695) {
        m_65826 = (int64_t) 0;
    } else {
        m_65826 = m_f_res_65824;
    }
    
    int64_t m_65836 = sub64(m_65826, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65838 = slt64(m_65836, m_65686);
    bool zzero_leq_i_p_m_t_s_65837 = sle64((int64_t) 0, m_65836);
    bool y_65840 = zzero_leq_i_p_m_t_s_65837 && i_p_m_t_s_leq_w_65838;
    bool i_lte_j_65839 = sle64((int64_t) 0, m_65826);
    bool forwards_ok_65841 = i_lte_j_65839 && y_65840;
    bool eq_x_zz_65833 = (int64_t) 0 == m_f_res_65824;
    bool p_and_eq_x_y_65834 = x_65821 && eq_x_zz_65833;
    bool empty_slice_65835 = empty_slice_65695 || p_and_eq_x_y_65834;
    bool ok_or_empty_65842 = empty_slice_65835 || forwards_ok_65841;
    bool index_certs_65843;
    
    if (!ok_or_empty_65842) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65826, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:363:133-136\n   #4  ftSMJ.fut:352:1-363:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75969 = (int64_t) 8 * m_65826;
    
    if (memblock_alloc_device(ctx, &mem_75974, (int64_t) 8, "mem_75974")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_intzigpuseq_77229(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_75965.mem, ext_mem_75968.mem, mem_75974.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
        return 1;
    
    int64_t n_pairs_t_res_65747;
    
    if (cond_65737) {
        int64_t read_res_77421;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77421, mem_75974.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_75465 = read_res_77421;
        
        n_pairs_t_res_65747 = x_75465;
    } else {
        n_pairs_t_res_65747 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
        return 1;
    
    int64_t n_pairs_65748;
    
    if (cond_65737) {
        n_pairs_65748 = n_pairs_t_res_65747;
    } else {
        n_pairs_65748 = (int64_t) 0;
    }
    
    int64_t bytes_75975 = (int64_t) 4 * n_pairs_65748;
    int64_t bytes_75977 = (int64_t) 8 * n_pairs_65748;
    int64_t segmap_tblock_sizze_69924;
    
    segmap_tblock_sizze_69924 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69923;
    
    int64_t num_tblocks_69926;
    int64_t max_num_tblocks_77235;
    
    max_num_tblocks_77235 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69925;
    num_tblocks_69926 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_69924), max_num_tblocks_77235)));
    if (memblock_alloc_device(ctx, &mem_75970, bytes_75969, "mem_75970")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75970.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75972, bytes_75969, "mem_75972")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75972.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_69932;
    
    segmap_tblock_sizze_69932 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69931;
    
    int64_t num_tblocks_69934;
    int64_t max_num_tblocks_77236;
    
    max_num_tblocks_77236 = *ctx->tuning_params.inner_SMJ_intzisegmap_num_tblocks_69933;
    num_tblocks_69934 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_69932), max_num_tblocks_77236)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77237 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_69932));
    
    {
        err = gpu_kernel_inner_SMJ_intzisegmap_69929(ctx, num_tblocks_69934, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69931, 1, 1, (int64_t) 0, m_65686, m_65826, num_tblocks_69934, virt_num_tblocks_77237, mem_75945.mem, mem_75957.mem, mem_75959.mem, mem_75962.mem, mem_75970.mem, mem_75972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
        return 1;
    
    bool cond_65853 = slt64((int64_t) 0, m_65826);
    int64_t segmap_tblock_sizze_69947;
    
    segmap_tblock_sizze_69947 = *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69939;
    if (memblock_alloc_device(ctx, &mem_75976, bytes_75975, "mem_75976")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, mem_75976, n_pairs_65748, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75978, bytes_75977, "mem_75978")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75978, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75980, bytes_75977, "mem_75980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75980, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_65752 = add64(scatter_psizze_42228, n_pairs_65748);
    int64_t zs_lhs_65753 = sub64(zm_lhs_65752, (int64_t) 1);
    int64_t m_65757 = sdiv64(zs_lhs_65753, scatter_psizze_42228);
    bool loop_cond_65758 = slt64((int64_t) 0, m_65757);
    bool partitioned_scatter_res_65759;
    int64_t partitioned_scatter_res_65763;
    bool loop_while_65764;
    int64_t p_65768;
    
    loop_while_65764 = loop_cond_65758;
    p_65768 = (int64_t) 0;
    while (loop_while_65764) {
        int64_t lower_bound_65769 = mul64(scatter_psizze_42228, p_65768);
        int64_t min_arg1_65770 = add64(scatter_psizze_42228, lower_bound_65769);
        int64_t min_res_65771 = smin64(n_pairs_65748, min_arg1_65770);
        int64_t j_m_i_65772 = sub64(min_res_65771, lower_bound_65769);
        bool empty_slice_65773 = j_m_i_65772 == (int64_t) 0;
        int64_t m_65774 = sub64(j_m_i_65772, (int64_t) 1);
        int64_t i_p_m_t_s_65775 = add64(lower_bound_65769, m_65774);
        bool zzero_leq_i_p_m_t_s_65776 = sle64((int64_t) 0, i_p_m_t_s_65775);
        bool i_p_m_t_s_leq_w_65777 = slt64(i_p_m_t_s_65775, n_pairs_65748);
        bool zzero_lte_i_65778 = sle64((int64_t) 0, lower_bound_65769);
        bool i_lte_j_65779 = sle64(lower_bound_65769, min_res_65771);
        bool y_65780 = i_p_m_t_s_leq_w_65777 && zzero_lte_i_65778;
        bool y_65781 = zzero_leq_i_p_m_t_s_65776 && y_65780;
        bool forwards_ok_65782 = i_lte_j_65779 && y_65781;
        bool ok_or_empty_65783 = empty_slice_65773 || forwards_ok_65782;
        bool index_certs_65784;
        
        if (!ok_or_empty_65783) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_65769, ":", (long long) min_res_65771, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_75990 = (int64_t) 4 * j_m_i_65772;
        int64_t bytes_75992 = (int64_t) 8 * j_m_i_65772;
        
        if (memblock_alloc_device(ctx, &mem_75991, bytes_75990, "mem_75991")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75976.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75993, bytes_75992, "mem_75993")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75978.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75995, bytes_75992, "mem_75995")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75980.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77255 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_69924));
        
        {
            err = gpu_kernel_inner_SMJ_intzisegmap_69921(ctx, num_tblocks_69926, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69923, 1, 1, (int64_t) 0, m_65686, lower_bound_65769, min_res_65771, j_m_i_65772, num_tblocks_69926, virt_num_tblocks_77255, mem_75947.mem, mem_75949.mem, mem_75951.mem, mem_75962.mem, mem_75991.mem, mem_75993.mem, mem_75995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_65798 = add64((int64_t) 1, p_65768);
        
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_75976.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75978.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75980.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        
        bool loop_cond_65809 = slt64(tmp_65798, m_65757);
        bool loop_while_tmp_77250 = loop_cond_65809;
        int64_t p_tmp_77254 = tmp_65798;
        
        loop_while_65764 = loop_while_tmp_77250;
        p_65768 = p_tmp_77254;
    }
    partitioned_scatter_res_65759 = loop_while_65764;
    partitioned_scatter_res_65763 = p_65768;
    if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
        return 1;
    
    bool loop_cond_t_res_65854 = slt64(m_65686, n_pairs_65748);
    bool x_65855 = cond_65853 && loop_cond_t_res_65854;
    
    if (memblock_alloc_device(ctx, &mem_76021, (int64_t) 4, "mem_76021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76022, (int64_t) 8, "mem_76022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76023, (int64_t) 8, "mem_76023")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_65856;
    int64_t joinTups_to_joinPairs_InnerJoin_res_65860;
    bool loop_while_65861;
    int64_t p_65865;
    
    if (memblock_set_device(ctx, &mem_param_76008, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76011, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76014, &mem_75980, "mem_75980") != 0)
        return 1;
    loop_while_65861 = x_65855;
    p_65865 = (int64_t) 0;
    while (loop_while_65861) {
        bool x_65866 = sle64((int64_t) 0, p_65865);
        bool y_65867 = slt64(p_65865, m_65826);
        bool bounds_check_65868 = x_65866 && y_65867;
        bool index_certs_65869;
        
        if (!bounds_check_65868) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65865, "] out of bounds for array of shape [", (long long) m_65826, "].", "-> #0  ftSMJ.fut:299:13-42\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_77422;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77422, mem_75972.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65870 = read_res_77422;
        int64_t read_res_77423;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77423, mem_75970.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65871 = read_res_77423;
        bool x_65872 = sle64((int64_t) 0, loopres_65870);
        bool y_65873 = slt64(loopres_65870, n_pairs_65748);
        bool bounds_check_65874 = x_65872 && y_65873;
        bool index_certs_65875;
        
        if (!bounds_check_65874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:301:52-61\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_65886 = add64(loopres_65870, loopres_65871);
        bool empty_slice_65890 = loopres_65871 == (int64_t) 0;
        int64_t m_65891 = sub64(loopres_65871, (int64_t) 1);
        int64_t i_p_m_t_s_65892 = add64(loopres_65870, m_65891);
        bool zzero_leq_i_p_m_t_s_65893 = sle64((int64_t) 0, i_p_m_t_s_65892);
        bool i_p_m_t_s_leq_w_65894 = slt64(i_p_m_t_s_65892, n_pairs_65748);
        bool i_lte_j_65895 = sle64(loopres_65870, tmp_65886);
        bool y_65896 = x_65872 && i_p_m_t_s_leq_w_65894;
        bool y_65897 = zzero_leq_i_p_m_t_s_65893 && y_65896;
        bool forwards_ok_65898 = i_lte_j_65895 && y_65897;
        bool ok_or_empty_65899 = empty_slice_65890 || forwards_ok_65898;
        bool index_certs_65900;
        
        if (!ok_or_empty_65899) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, ":", (long long) tmp_65886, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:305:14-55\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:363:133-136\n   #3  ftSMJ.fut:352:1-363:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_76024 = (int64_t) 4 * loopres_65871;
        int64_t bytes_76026 = (int64_t) 8 * loopres_65871;
        int64_t segmap_usable_groups_69948 = sdiv_up64(loopres_65871, segmap_tblock_sizze_69947);
        int64_t tmp_65885 = add64((int64_t) 1, p_65865);
        
        if (memblock_alloc_device(ctx, &mem_76016, bytes_75975, "mem_76016")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76016.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76008.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76018, bytes_75977, "mem_76018")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76011.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76020, bytes_75977, "mem_76020")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76020.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76014.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        
        bool cond_65904 = slt64(tmp_65885, m_65826);
        bool x_65905 = loop_cond_t_res_65854 && cond_65904;
        
        {
            err = gpu_kernel_inner_SMJ_intzigpuseq_77276(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_65870, mem_param_76008.mem, mem_param_76011.mem, mem_param_76014.mem, mem_76021.mem, mem_76022.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76025, bytes_76024, "mem_76025")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77282 = loopres_65871;
        int64_t tblock_sizze_77287;
        
        tblock_sizze_77287 = *ctx->tuning_params.inner_SMJ_intzitblock_sizze_77287;
        
        int64_t virt_num_tblocks_77288 = sdiv_up64(replicate_n_77282, tblock_sizze_77287);
        int64_t num_tblocks_77289 = smin64(virt_num_tblocks_77288, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_intzireplicate_77283(ctx, num_tblocks_77289, 1, 1, tblock_sizze_77287, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77282, virt_num_tblocks_77288, num_tblocks_77289, mem_76021.mem, mem_76025.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76027, bytes_76026, "mem_76027")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77302 = loopres_65871;
        int64_t tblock_sizze_77307;
        
        tblock_sizze_77307 = *ctx->tuning_params.inner_SMJ_intzitblock_sizze_77307;
        
        int64_t virt_num_tblocks_77308 = sdiv_up64(replicate_n_77302, tblock_sizze_77307);
        int64_t num_tblocks_77309 = smin64(virt_num_tblocks_77308, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_intzireplicate_77303(ctx, num_tblocks_77309, 1, 1, tblock_sizze_77307, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77302, virt_num_tblocks_77308, num_tblocks_77309, mem_76022.mem, mem_76027.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77322 = sext_i64_i32(sdiv_up64(loopres_65871, segmap_tblock_sizze_69947));
        
        {
            err = gpu_kernel_inner_SMJ_intzisegmap_69951(ctx, segmap_usable_groups_69948, 1, 1, *ctx->tuning_params.inner_SMJ_intzisegmap_tblock_sizze_69939, 1, 1, (int64_t) 0, loopres_65870, loopres_65871, mem_76020.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76016.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77268, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77269, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77270, &mem_76020, "mem_76020") != 0)
            return 1;
        
        bool loop_while_tmp_77271 = x_65905;
        int64_t p_tmp_77275 = tmp_65885;
        
        if (memblock_set_device(ctx, &mem_param_76008, &mem_param_tmp_77268, "mem_param_tmp_77268") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76011, &mem_param_tmp_77269, "mem_param_tmp_77269") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76014, &mem_param_tmp_77270, "mem_param_tmp_77270") != 0)
            return 1;
        loop_while_65861 = loop_while_tmp_77271;
        p_65865 = p_tmp_77275;
    }
    if (memblock_set_device(ctx, &ext_mem_76039, &mem_param_76008, "mem_param_76008") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76038, &mem_param_76011, "mem_param_76011") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76037, &mem_param_76014, "mem_param_76014") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_65856 = loop_while_65861;
    joinTups_to_joinPairs_InnerJoin_res_65860 = p_65865;
    if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76041, bytes_75975, "mem_76041")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_76041.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76039.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76043, bytes_75977, "mem_76043")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76038.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76045, bytes_75977, "mem_76045")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76037.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_76043, "mem_76043") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76543, &mem_76045, "mem_76045") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76544, &mem_76041, "mem_76041") != 0)
        return 1;
    prim_out_76545 = n_pairs_65748;
    if (memblock_set_device(ctx, &*mem_out_p_77403, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77404, &mem_out_76543, "mem_out_76543") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77405, &mem_out_76544, "mem_out_76544") != 0)
        return 1;
    *out_prim_out_77406 = prim_out_76545;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_76045, "mem_76045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76043, "mem_76043") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76041, "mem_76041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77270, "mem_param_tmp_77270") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77269, "mem_param_tmp_77269") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77268, "mem_param_tmp_77268") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76020, "mem_76020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76014, "mem_param_76014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76011, "mem_param_76011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76008, "mem_param_76008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75966, "mem_75966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75967, "mem_75967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75963, "mem_75963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75964, "mem_75964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77071, "incprefixes_mem_77071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77069, "aggregates_mem_77069") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77067, "incprefixes_mem_77067") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77065, "aggregates_mem_77065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_77063, "status_flags_mem_77063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_76950, "incprefixes_mem_76950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_76948, "aggregates_mem_76948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_76926, "status_flags_mem_76926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75925, "mem_75925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75922, "mem_75922") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75730, "mem_75730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75728, "mem_75728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75714, "mem_75714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75711, "mem_75711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75690, "mem_75690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75688, "mem_75688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75623, "mem_75623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75621, "mem_75621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75684, "mem_75684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75682, "mem_75682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75693, "ext_mem_75693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75696, "ext_mem_75696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75699, "ext_mem_75699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75702, "ext_mem_75702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75552, "mem_param_75552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75549, "mem_param_75549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75544, "mem_75544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75545, "mem_75545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75541, "mem_75541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75542, "mem_75542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75540, "mem_param_75540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75537, "mem_param_75537") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75733, "ext_mem_75733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75736, "ext_mem_75736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75739, "ext_mem_75739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75742, "ext_mem_75742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75530, "mem_param_75530") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75527, "mem_param_75527") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75747, "ext_mem_75747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75748, "ext_mem_75748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75509, "mem_75509") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75511, "mem_75511") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75493, "mem_75493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75494, "mem_75494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75489, "mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75490, "mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75895, "mem_75895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75893, "mem_75893") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75828, "mem_75828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75826, "mem_75826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75889, "mem_75889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75887, "mem_75887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75898, "ext_mem_75898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75901, "ext_mem_75901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75904, "ext_mem_75904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75907, "ext_mem_75907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75757, "mem_param_75757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75754, "mem_param_75754") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75912, "ext_mem_75912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75913, "ext_mem_75913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75749, "mem_75749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75750, "mem_75750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75482, "mem_param_75482") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75474, "mem_75474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75475, "mem_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76544, "mem_out_76544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76543, "mem_out_76543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_77424, struct memblock_device *mem_out_p_77425, struct memblock_device *mem_out_p_77426, int64_t *out_prim_out_77427, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_47166, int64_t nS_47167, int64_t offset_R_47170, int64_t offset_S_47171, int64_t partitionsPerWindow_47172, int64_t numberOfWindows_47173, int64_t extParallelism_47174, int64_t scatter_psizze_47175)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_76045;
    
    mem_76045.references = NULL;
    
    struct memblock_device mem_76043;
    
    mem_76043.references = NULL;
    
    struct memblock_device mem_76041;
    
    mem_76041.references = NULL;
    
    struct memblock_device mem_param_tmp_77270;
    
    mem_param_tmp_77270.references = NULL;
    
    struct memblock_device mem_param_tmp_77269;
    
    mem_param_tmp_77269.references = NULL;
    
    struct memblock_device mem_param_tmp_77268;
    
    mem_param_tmp_77268.references = NULL;
    
    struct memblock_device mem_76027;
    
    mem_76027.references = NULL;
    
    struct memblock_device mem_76025;
    
    mem_76025.references = NULL;
    
    struct memblock_device mem_76020;
    
    mem_76020.references = NULL;
    
    struct memblock_device mem_76018;
    
    mem_76018.references = NULL;
    
    struct memblock_device mem_76016;
    
    mem_76016.references = NULL;
    
    struct memblock_device mem_param_76014;
    
    mem_param_76014.references = NULL;
    
    struct memblock_device mem_param_76011;
    
    mem_param_76011.references = NULL;
    
    struct memblock_device mem_param_76008;
    
    mem_param_76008.references = NULL;
    
    struct memblock_device ext_mem_76037;
    
    ext_mem_76037.references = NULL;
    
    struct memblock_device ext_mem_76038;
    
    ext_mem_76038.references = NULL;
    
    struct memblock_device ext_mem_76039;
    
    ext_mem_76039.references = NULL;
    
    struct memblock_device mem_76023;
    
    mem_76023.references = NULL;
    
    struct memblock_device mem_76022;
    
    mem_76022.references = NULL;
    
    struct memblock_device mem_76021;
    
    mem_76021.references = NULL;
    
    struct memblock_device mem_75995;
    
    mem_75995.references = NULL;
    
    struct memblock_device mem_75993;
    
    mem_75993.references = NULL;
    
    struct memblock_device mem_75991;
    
    mem_75991.references = NULL;
    
    struct memblock_device mem_75980;
    
    mem_75980.references = NULL;
    
    struct memblock_device mem_75978;
    
    mem_75978.references = NULL;
    
    struct memblock_device mem_75976;
    
    mem_75976.references = NULL;
    
    struct memblock_device mem_75972;
    
    mem_75972.references = NULL;
    
    struct memblock_device mem_75970;
    
    mem_75970.references = NULL;
    
    struct memblock_device mem_75974;
    
    mem_75974.references = NULL;
    
    struct memblock_device mem_75966;
    
    mem_75966.references = NULL;
    
    struct memblock_device mem_75967;
    
    mem_75967.references = NULL;
    
    struct memblock_device ext_mem_75968;
    
    ext_mem_75968.references = NULL;
    
    struct memblock_device mem_75963;
    
    mem_75963.references = NULL;
    
    struct memblock_device mem_75964;
    
    mem_75964.references = NULL;
    
    struct memblock_device ext_mem_75965;
    
    ext_mem_75965.references = NULL;
    
    struct memblock_device mem_75962;
    
    mem_75962.references = NULL;
    
    struct memblock_device incprefixes_mem_77071;
    
    incprefixes_mem_77071.references = NULL;
    
    struct memblock_device aggregates_mem_77069;
    
    aggregates_mem_77069.references = NULL;
    
    struct memblock_device incprefixes_mem_77067;
    
    incprefixes_mem_77067.references = NULL;
    
    struct memblock_device aggregates_mem_77065;
    
    aggregates_mem_77065.references = NULL;
    
    struct memblock_device status_flags_mem_77063;
    
    status_flags_mem_77063.references = NULL;
    
    struct memblock_device mem_75959;
    
    mem_75959.references = NULL;
    
    struct memblock_device mem_75957;
    
    mem_75957.references = NULL;
    
    struct memblock_device mem_75955;
    
    mem_75955.references = NULL;
    
    struct memblock_device mem_75951;
    
    mem_75951.references = NULL;
    
    struct memblock_device mem_75949;
    
    mem_75949.references = NULL;
    
    struct memblock_device mem_75947;
    
    mem_75947.references = NULL;
    
    struct memblock_device mem_75945;
    
    mem_75945.references = NULL;
    
    struct memblock_device incprefixes_mem_76930;
    
    incprefixes_mem_76930.references = NULL;
    
    struct memblock_device aggregates_mem_76928;
    
    aggregates_mem_76928.references = NULL;
    
    struct memblock_device status_flags_mem_76906;
    
    status_flags_mem_76906.references = NULL;
    
    struct memblock_device mem_75943;
    
    mem_75943.references = NULL;
    
    struct memblock_device mem_75941;
    
    mem_75941.references = NULL;
    
    struct memblock_device mem_param_tmp_76573;
    
    mem_param_tmp_76573.references = NULL;
    
    struct memblock_device mem_param_tmp_76572;
    
    mem_param_tmp_76572.references = NULL;
    
    struct memblock_device mem_75926;
    
    mem_75926.references = NULL;
    
    struct memblock_device mem_75925;
    
    mem_75925.references = NULL;
    
    struct memblock_device mem_75922;
    
    mem_75922.references = NULL;
    
    struct memblock_device mem_param_tmp_76730;
    
    mem_param_tmp_76730.references = NULL;
    
    struct memblock_device mem_param_tmp_76729;
    
    mem_param_tmp_76729.references = NULL;
    
    struct memblock_device mem_75730;
    
    mem_75730.references = NULL;
    
    struct memblock_device mem_75728;
    
    mem_75728.references = NULL;
    
    struct memblock_device mem_75726;
    
    mem_75726.references = NULL;
    
    struct memblock_device mem_75723;
    
    mem_75723.references = NULL;
    
    struct memblock_device mem_param_tmp_76740;
    
    mem_param_tmp_76740.references = NULL;
    
    struct memblock_device mem_param_tmp_76739;
    
    mem_param_tmp_76739.references = NULL;
    
    struct memblock_device mem_75714;
    
    mem_75714.references = NULL;
    
    struct memblock_device mem_75711;
    
    mem_75711.references = NULL;
    
    struct memblock_device mem_param_tmp_76758;
    
    mem_param_tmp_76758.references = NULL;
    
    struct memblock_device mem_param_tmp_76757;
    
    mem_param_tmp_76757.references = NULL;
    
    struct memblock_device mem_75690;
    
    mem_75690.references = NULL;
    
    struct memblock_device mem_75688;
    
    mem_75688.references = NULL;
    
    struct memblock_device mem_75623;
    
    mem_75623.references = NULL;
    
    struct memblock_device mem_75621;
    
    mem_75621.references = NULL;
    
    struct memblock_device mem_75684;
    
    mem_75684.references = NULL;
    
    struct memblock_device mem_75682;
    
    mem_75682.references = NULL;
    
    struct memblock_device ext_mem_75685;
    
    ext_mem_75685.references = NULL;
    
    struct memblock_device ext_mem_75686;
    
    ext_mem_75686.references = NULL;
    
    struct memblock_device ext_mem_75562;
    
    ext_mem_75562.references = NULL;
    
    struct memblock_device mem_75560;
    
    mem_75560.references = NULL;
    
    struct memblock_device ext_mem_75693;
    
    ext_mem_75693.references = NULL;
    
    struct memblock_device ext_mem_75696;
    
    ext_mem_75696.references = NULL;
    
    struct memblock_device mem_75558;
    
    mem_75558.references = NULL;
    
    struct memblock_device ext_mem_75699;
    
    ext_mem_75699.references = NULL;
    
    struct memblock_device ext_mem_75702;
    
    ext_mem_75702.references = NULL;
    
    struct memblock_device ext_mem_75556;
    
    ext_mem_75556.references = NULL;
    
    struct memblock_device ext_mem_75555;
    
    ext_mem_75555.references = NULL;
    
    struct memblock_device mem_param_75552;
    
    mem_param_75552.references = NULL;
    
    struct memblock_device mem_param_75549;
    
    mem_param_75549.references = NULL;
    
    struct memblock_device ext_mem_75707;
    
    ext_mem_75707.references = NULL;
    
    struct memblock_device ext_mem_75708;
    
    ext_mem_75708.references = NULL;
    
    struct memblock_device mem_75544;
    
    mem_75544.references = NULL;
    
    struct memblock_device mem_75545;
    
    mem_75545.references = NULL;
    
    struct memblock_device ext_mem_75546;
    
    ext_mem_75546.references = NULL;
    
    struct memblock_device mem_75541;
    
    mem_75541.references = NULL;
    
    struct memblock_device mem_75542;
    
    mem_75542.references = NULL;
    
    struct memblock_device ext_mem_75543;
    
    ext_mem_75543.references = NULL;
    
    struct memblock_device mem_param_75540;
    
    mem_param_75540.references = NULL;
    
    struct memblock_device mem_param_75537;
    
    mem_param_75537.references = NULL;
    
    struct memblock_device ext_mem_75719;
    
    ext_mem_75719.references = NULL;
    
    struct memblock_device ext_mem_75720;
    
    ext_mem_75720.references = NULL;
    
    struct memblock_device mem_75557;
    
    mem_75557.references = NULL;
    
    struct memblock_device mem_75554;
    
    mem_75554.references = NULL;
    
    struct memblock_device mem_75553;
    
    mem_75553.references = NULL;
    
    struct memblock_device mem_75534;
    
    mem_75534.references = NULL;
    
    struct memblock_device mem_75532;
    
    mem_75532.references = NULL;
    
    struct memblock_device ext_mem_75733;
    
    ext_mem_75733.references = NULL;
    
    struct memblock_device ext_mem_75736;
    
    ext_mem_75736.references = NULL;
    
    struct memblock_device ext_mem_75739;
    
    ext_mem_75739.references = NULL;
    
    struct memblock_device ext_mem_75742;
    
    ext_mem_75742.references = NULL;
    
    struct memblock_device mem_param_75530;
    
    mem_param_75530.references = NULL;
    
    struct memblock_device mem_param_75527;
    
    mem_param_75527.references = NULL;
    
    struct memblock_device ext_mem_75747;
    
    ext_mem_75747.references = NULL;
    
    struct memblock_device ext_mem_75748;
    
    ext_mem_75748.references = NULL;
    
    struct memblock_device mem_75524;
    
    mem_75524.references = NULL;
    
    struct memblock_device mem_75522;
    
    mem_75522.references = NULL;
    
    struct memblock_device mem_75509;
    
    mem_75509.references = NULL;
    
    struct memblock_device mem_75511;
    
    mem_75511.references = NULL;
    
    struct memblock_device ext_mem_75512;
    
    ext_mem_75512.references = NULL;
    
    struct memblock_device ext_mem_75513;
    
    ext_mem_75513.references = NULL;
    
    struct memblock_device mem_75506;
    
    mem_75506.references = NULL;
    
    struct memblock_device mem_75504;
    
    mem_75504.references = NULL;
    
    struct memblock_device mem_75493;
    
    mem_75493.references = NULL;
    
    struct memblock_device mem_75494;
    
    mem_75494.references = NULL;
    
    struct memblock_device ext_mem_75495;
    
    ext_mem_75495.references = NULL;
    
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_75489;
    
    mem_75489.references = NULL;
    
    struct memblock_device mem_75490;
    
    mem_75490.references = NULL;
    
    struct memblock_device ext_mem_75491;
    
    ext_mem_75491.references = NULL;
    
    struct memblock_device mem_75488;
    
    mem_75488.references = NULL;
    
    struct memblock_device mem_75486;
    
    mem_75486.references = NULL;
    
    struct memblock_device mem_param_tmp_76591;
    
    mem_param_tmp_76591.references = NULL;
    
    struct memblock_device mem_param_tmp_76590;
    
    mem_param_tmp_76590.references = NULL;
    
    struct memblock_device mem_75895;
    
    mem_75895.references = NULL;
    
    struct memblock_device mem_75893;
    
    mem_75893.references = NULL;
    
    struct memblock_device mem_75828;
    
    mem_75828.references = NULL;
    
    struct memblock_device mem_75826;
    
    mem_75826.references = NULL;
    
    struct memblock_device mem_75889;
    
    mem_75889.references = NULL;
    
    struct memblock_device mem_75887;
    
    mem_75887.references = NULL;
    
    struct memblock_device ext_mem_75890;
    
    ext_mem_75890.references = NULL;
    
    struct memblock_device ext_mem_75891;
    
    ext_mem_75891.references = NULL;
    
    struct memblock_device ext_mem_75767;
    
    ext_mem_75767.references = NULL;
    
    struct memblock_device mem_75765;
    
    mem_75765.references = NULL;
    
    struct memblock_device ext_mem_75898;
    
    ext_mem_75898.references = NULL;
    
    struct memblock_device ext_mem_75901;
    
    ext_mem_75901.references = NULL;
    
    struct memblock_device mem_75763;
    
    mem_75763.references = NULL;
    
    struct memblock_device ext_mem_75904;
    
    ext_mem_75904.references = NULL;
    
    struct memblock_device ext_mem_75907;
    
    ext_mem_75907.references = NULL;
    
    struct memblock_device ext_mem_75761;
    
    ext_mem_75761.references = NULL;
    
    struct memblock_device ext_mem_75760;
    
    ext_mem_75760.references = NULL;
    
    struct memblock_device mem_param_75757;
    
    mem_param_75757.references = NULL;
    
    struct memblock_device mem_param_75754;
    
    mem_param_75754.references = NULL;
    
    struct memblock_device ext_mem_75912;
    
    ext_mem_75912.references = NULL;
    
    struct memblock_device ext_mem_75913;
    
    ext_mem_75913.references = NULL;
    
    struct memblock_device mem_75762;
    
    mem_75762.references = NULL;
    
    struct memblock_device mem_75759;
    
    mem_75759.references = NULL;
    
    struct memblock_device mem_75758;
    
    mem_75758.references = NULL;
    
    struct memblock_device mem_75749;
    
    mem_75749.references = NULL;
    
    struct memblock_device mem_75750;
    
    mem_75750.references = NULL;
    
    struct memblock_device ext_mem_75751;
    
    ext_mem_75751.references = NULL;
    
    struct memblock_device ext_mem_75916;
    
    ext_mem_75916.references = NULL;
    
    struct memblock_device ext_mem_75919;
    
    ext_mem_75919.references = NULL;
    
    struct memblock_device ext_mem_75929;
    
    ext_mem_75929.references = NULL;
    
    struct memblock_device ext_mem_75932;
    
    ext_mem_75932.references = NULL;
    
    struct memblock_device mem_param_75482;
    
    mem_param_75482.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device ext_mem_75937;
    
    ext_mem_75937.references = NULL;
    
    struct memblock_device ext_mem_75938;
    
    ext_mem_75938.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75474;
    
    mem_75474.references = NULL;
    
    struct memblock_device mem_75475;
    
    mem_75475.references = NULL;
    
    struct memblock_device ext_mem_75476;
    
    ext_mem_75476.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device ext_mem_75469;
    
    ext_mem_75469.references = NULL;
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76545;
    int64_t zm_lhs_64812 = add64(nR_47166, nS_47167);
    int64_t zs_lhs_64813 = sub64(zm_lhs_64812, (int64_t) 1);
    bool zzero_64814 = nR_47166 == (int64_t) 0;
    bool nonzzero_64815 = !zzero_64814;
    bool nonzzero_cert_64816;
    
    if (!nonzzero_64815) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:231:26-29\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_64817 = sdiv64(zs_lhs_64813, nR_47166);
    
    if (futrts_indicesWithIncrement_7692(ctx, &ext_mem_75469, tR_mem_75467, nR_47166, offset_R_47170) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_75470 = (int64_t) 8 * nR_47166;
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75471, nR_47166, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, nR_47166, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_64822 = slt64((int64_t) 0, numIter_64817);
    int64_t gt_rhs_64823 = sub64(nR_47166, (int64_t) 1);
    bool x_64824 = sle64((int64_t) 0, gt_rhs_64823);
    bool y_64825 = slt64(gt_rhs_64823, nR_47166);
    bool bounds_check_64826 = x_64824 && y_64825;
    bool loop_not_taken_64827 = !loop_cond_64822;
    bool protect_assert_disj_64828 = bounds_check_64826 || loop_not_taken_64827;
    bool index_certs_64829;
    
    if (!protect_assert_disj_64828) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftSMJ.fut:238:25-33\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_64822) {
        if (memblock_alloc_device(ctx, &mem_75475, (int64_t) 8, "mem_75475")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_76566(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, tR_mem_75467.mem, mem_75475.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75475, "mem_75475") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75474, (int64_t) 8, "mem_75474")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75474, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75474, "mem_75474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_75483, (int64_t) 8, "mem_75483")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75484, (int64_t) 1, "mem_75484")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_64832;
    int64_t defunc_0_mergeJoin_res_64833;
    bool loop_while_64836;
    int64_t p_64837;
    
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75482, &mem_75471, "mem_75471") != 0)
        return 1;
    loop_while_64836 = loop_cond_64822;
    p_64837 = (int64_t) 0;
    while (loop_while_64836) {
        int64_t tS_start_64840 = mul64(nR_47166, p_64837);
        int64_t min_arg1_64841 = add64(nR_47166, tS_start_64840);
        int64_t min_res_64842 = smin64(nS_47167, min_arg1_64841);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 = sub64(min_res_64842, tS_start_64840);
        bool empty_slice_64844 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 == (int64_t) 0;
        int64_t m_64845 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, (int64_t) 1);
        int64_t i_p_m_t_s_64846 = add64(tS_start_64840, m_64845);
        bool zzero_leq_i_p_m_t_s_64847 = sle64((int64_t) 0, i_p_m_t_s_64846);
        bool i_p_m_t_s_leq_w_64848 = slt64(i_p_m_t_s_64846, nS_47167);
        bool zzero_lte_i_64849 = sle64((int64_t) 0, tS_start_64840);
        bool i_lte_j_64850 = sle64(tS_start_64840, min_res_64842);
        bool y_64851 = i_p_m_t_s_leq_w_64848 && zzero_lte_i_64849;
        bool y_64852 = zzero_leq_i_p_m_t_s_64847 && y_64851;
        bool forwards_ok_64853 = i_lte_j_64850 && y_64852;
        bool ok_or_empty_64854 = empty_slice_64844 || forwards_ok_64853;
        bool index_certs_64855;
        
        if (!ok_or_empty_64854) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_64840, ":", (long long) min_res_64842, "] out of bounds for array of shape [", (long long) nS_47167, "].", "-> #0  ftSMJ.fut:237:16-35\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_64857 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
        bool index_certs_64858;
        
        if (!y_64857) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:238:12-19\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_76578(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_64840, tS_mem_75468.mem, ext_mem_75476.mem, mem_75483.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_77428;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77428, mem_75484.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_64860 = read_res_77428;
        int64_t loopres_64861;
        
        if (defunc_0_gt_res_64860) {
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_param_75479, "mem_param_75479") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_param_75482, "mem_param_75482") != 0)
                return 1;
            loopres_64861 = numIter_64817;
        } else {
            bool cond_64864 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, nR_47166);
            bool dim_match_64978 = nR_47166 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            bool protect_assert_disj_76147 = cond_64864 || dim_match_64978;
            bool empty_or_match_cert_64979;
            
            if (!protect_assert_disj_76147) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "] cannot match shape of type `[", (long long) nR_47166, "]i64`.", "-> #0  ftSMJ.fut:246:18-31\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_64985 = slt64((int64_t) 0, numberOfWindows_47173);
            bool y_64988 = slt64((int64_t) 0, nR_47166);
            bool loop_not_taken_64989 = !loop_cond_64985;
            bool protect_assert_disj_64990 = y_64988 || loop_not_taken_64989;
            bool protect_assert_disj_76149 = cond_64864 || protect_assert_disj_64990;
            bool index_certs_64991;
            
            if (!protect_assert_disj_76149) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftbasics.fut:150:20-25\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_66374 = add64(nR_47166, extParallelism_47174);
            int64_t zs_lhs_66375 = sub64(zm_lhs_66374, (int64_t) 1);
            bool zzero_66376 = extParallelism_47174 == (int64_t) 0;
            bool nonzzero_66377 = !zzero_66376;
            bool loop_not_taken_76090 = !cond_64864;
            bool protect_assert_disj_76091 = nonzzero_66377 || loop_not_taken_76090;
            bool nonzzero_cert_66378;
            
            if (!protect_assert_disj_76091) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_66379 = sdiv_safe64(zs_lhs_66375, extParallelism_47174);
            bool loop_cond_66380 = slt64((int64_t) 0, numIter_66379);
            bool loop_not_taken_66381 = !y_64857;
            bool loop_not_taken_66382 = !loop_cond_66380;
            bool x_66383 = sle64((int64_t) 0, m_64845);
            bool y_66384 = slt64(m_64845, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
            bool bounds_check_66386 = x_66383 && y_66384;
            bool protect_assert_disj_66387 = loop_not_taken_66381 || bounds_check_66386;
            bool protect_assert_disj_66388 = loop_not_taken_66382 || protect_assert_disj_66387;
            bool protect_assert_disj_76093 = protect_assert_disj_66388 || loop_not_taken_76090;
            bool index_certs_66389;
            
            if (!protect_assert_disj_76093) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65659;
            
            if (!bounds_check_66386) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:257:23-44\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65661;
            
            if (!bounds_check_64826) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftSMJ.fut:257:51-59\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 = mul64(partitionsPerWindow_47172, numberOfWindows_47173);
            int64_t join_chunks_arg3_64981 = add64(offset_S_47171, tS_start_64840);
            int64_t bytes_75485 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
            bool empty_slice_64986 = partitionsPerWindow_47172 == (int64_t) 0;
            int64_t m_64987 = sub64(partitionsPerWindow_47172, (int64_t) 1);
            int64_t segmap_tblock_sizze_70340;
            
            segmap_tblock_sizze_70340 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70133;
            
            int64_t zeze_rhs_65256 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, (int64_t) 1);
            int64_t segmap_tblock_sizze_70714;
            
            segmap_tblock_sizze_70714 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70550;
            
            int64_t segmap_usable_groups_70715 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_70714);
            bool loop_cond_65411 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
            bool protect_cond_conj_66385 = y_64857 && loop_cond_66380;
            int64_t bytes_75764 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            int64_t ext_75918;
            int64_t ext_75917;
            int64_t ext_75915;
            int64_t ext_75914;
            
            if (cond_64864) {
                if (protect_cond_conj_66385) {
                    if (memblock_alloc_device(ctx, &mem_75750, (int64_t) 8, "mem_75750")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_76584(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_64846, tS_mem_75468.mem, mem_75750.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75750, "mem_75750") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75749, (int64_t) 8, "mem_75749")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_75749, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75749, "mem_75749") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75758, (int64_t) 8, "mem_75758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75759, (int64_t) 8, "mem_75759")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75762, (int64_t) 1, "mem_75762")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_75911;
                int64_t ext_75910;
                int64_t ext_75909;
                int64_t ext_75908;
                bool defunc_0_find_joinTuples_res_66392;
                int64_t defunc_0_find_joinTuples_res_66393;
                bool loop_while_66396;
                int64_t p_66397;
                int64_t ctx_param_ext_75752;
                int64_t ctx_param_ext_75753;
                int64_t ctx_param_ext_75755;
                int64_t ctx_param_ext_75756;
                
                if (memblock_set_device(ctx, &mem_param_75754, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75757, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75752 = (int64_t) 0;
                ctx_param_ext_75753 = (int64_t) 1;
                ctx_param_ext_75755 = (int64_t) 0;
                ctx_param_ext_75756 = (int64_t) 1;
                loop_while_66396 = loop_cond_66380;
                p_66397 = (int64_t) 0;
                while (loop_while_66396) {
                    int64_t start_66400 = mul64(extParallelism_47174, p_66397);
                    int64_t min_arg1_66401 = sub64(nR_47166, start_66400);
                    int64_t min_res_66402 = smin64(extParallelism_47174, min_arg1_66401);
                    int64_t iter_R_66403 = add64(start_66400, min_res_66402);
                    bool empty_slice_66404 = min_res_66402 == (int64_t) 0;
                    int64_t m_66405 = sub64(min_res_66402, (int64_t) 1);
                    int64_t i_p_m_t_s_66406 = add64(start_66400, m_66405);
                    bool zzero_leq_i_p_m_t_s_66407 = sle64((int64_t) 0, i_p_m_t_s_66406);
                    bool i_p_m_t_s_leq_w_66408 = slt64(i_p_m_t_s_66406, nR_47166);
                    bool zzero_lte_i_66409 = sle64((int64_t) 0, start_66400);
                    bool i_lte_j_66410 = sle64(start_66400, iter_R_66403);
                    bool y_66411 = i_p_m_t_s_leq_w_66408 && zzero_lte_i_66409;
                    bool y_66412 = zzero_leq_i_p_m_t_s_66407 && y_66411;
                    bool forwards_ok_66413 = i_lte_j_66410 && y_66412;
                    bool ok_or_empty_66414 = empty_slice_66404 || forwards_ok_66413;
                    bool index_certs_66415;
                    
                    if (!ok_or_empty_66414) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_66400, ":", (long long) iter_R_66403, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66416 = slt64(m_66405, min_res_66402);
                    bool x_66417 = sle64((int64_t) 0, m_66405);
                    bool bounds_check_66418 = y_66416 && x_66417;
                    bool index_certs_66419;
                    
                    if (!bounds_check_66418) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_66405, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66422 = slt64((int64_t) 0, min_res_66402);
                    bool index_certs_66423;
                    
                    if (!y_66422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_76600(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_66400, i_p_m_t_s_66406, tR_mem_75467.mem, mem_75758.mem, mem_75759.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75760, &ext_mem_75751, "ext_mem_75751") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75760, &mem_75758, "mem_75758") != 0)
                        return 1;
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75761, &mem_75483, "mem_75483") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75761, &mem_75759, "mem_75759") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_76606(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75759.mem, ext_mem_75760.mem, mem_75762.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
                        return 1;
                    
                    bool read_res_77429;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77429, mem_75762.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_66425 = read_res_77429;
                    int64_t ext_75906;
                    int64_t ext_75905;
                    int64_t ext_75903;
                    int64_t ext_75902;
                    int64_t loopres_66427;
                    
                    if (defunc_0_gt_res_66425) {
                        if (memblock_set_device(ctx, &ext_mem_75907, &mem_param_75754, "mem_param_75754") != 0)
                            return 1;
                        ext_75906 = ctx_param_ext_75752;
                        ext_75905 = ctx_param_ext_75753;
                        if (memblock_set_device(ctx, &ext_mem_75904, &mem_param_75757, "mem_param_75757") != 0)
                            return 1;
                        ext_75903 = ctx_param_ext_75755;
                        ext_75902 = ctx_param_ext_75756;
                        loopres_66427 = numIter_66379;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75763, (int64_t) 1, "mem_75763")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_longzigpuseq_76612(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75758.mem, ext_mem_75761.mem, mem_75763.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_77430;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77430, mem_75763.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_66431 = read_res_77430;
                        
                        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
                            return 1;
                        
                        int64_t ext_75900;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75900 = ctx_param_ext_75752;
                        } else {
                            ext_75900 = (int64_t) 0;
                        }
                        
                        int64_t ext_75899;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75899 = ctx_param_ext_75753;
                        } else {
                            ext_75899 = (int64_t) 1;
                        }
                        
                        int64_t ext_75897;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75897 = ctx_param_ext_75755;
                        } else {
                            ext_75897 = (int64_t) 0;
                        }
                        
                        int64_t ext_75896;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75896 = ctx_param_ext_75756;
                        } else {
                            ext_75896 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_66432;
                        
                        if (defunc_0_gt_res_66431) {
                            int64_t tmp_66436 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_param_75754, "mem_param_75754") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_param_75757, "mem_param_75757") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66436;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_75765, bytes_75764, "mem_75765")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75765.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, tS_start_64840, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_7692(ctx, &ext_mem_75767, mem_75765, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, join_chunks_arg3_64981) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
                                return 1;
                            
                            bool suff_outer_par_69955;
                            
                            suff_outer_par_69955 = *ctx->tuning_params.inner_SMJ_longzisuff_outer_par_0 <= min_res_66402;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_long.suff_outer_par_0", (long) min_res_66402, suff_outer_par_69955 ? "true" : "false");
                            
                            int64_t tile_sizze_74256;
                            
                            tile_sizze_74256 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74255;
                            
                            int64_t tile_sizze_73901;
                            
                            tile_sizze_73901 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_73900;
                            
                            int64_t num_whole_tiles_74272 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            int64_t residual_input_74496 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            bool cond_74497 = residual_input_74496 == (int64_t) 0;
                            int64_t binop_x_74513 = tile_sizze_74256 * num_whole_tiles_74272;
                            int64_t bytes_75825 = (int64_t) 8 * min_res_66402;
                            int64_t bytes_75788 = (int64_t) 8 * tile_sizze_74256;
                            int64_t num_whole_tiles_73917 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            int64_t residual_input_74141 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            bool cond_74142 = residual_input_74141 == (int64_t) 0;
                            int64_t binop_x_74158 = tile_sizze_73901 * num_whole_tiles_73917;
                            int64_t bytes_75849 = (int64_t) 8 * tile_sizze_73901;
                            int64_t shared_memory_capacity_76670;
                            
                            shared_memory_capacity_76670 = ctx->max_shared_memory;
                            if (suff_outer_par_69955 && sle64(sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76670)) {
                                int64_t ldim_73902 = sdiv_up64(min_res_66402, tile_sizze_73901);
                                
                                if (memblock_alloc_device(ctx, &mem_75887, bytes_75825, "mem_75887")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75889, bytes_75825, "mem_75889")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76618 = sext_i64_i32(sdiv_up64(tile_sizze_73901, tile_sizze_73901));
                                int32_t virt_num_tblocks_76619 = sext_i64_i32(ldim_73902);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_73899(ctx, ldim_73902, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_73900, 1, 1, bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_73902, num_whole_tiles_73917, residual_input_74141, cond_74142, binop_x_74158, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75887.mem, mem_75889.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75887, "mem_75887") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75889, "mem_75889") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_74257 = sdiv_up64(min_res_66402, tile_sizze_74256);
                                
                                if (memblock_alloc_device(ctx, &mem_75826, bytes_75825, "mem_75826")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75828, bytes_75825, "mem_75828")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76644 = sext_i64_i32(sdiv_up64(tile_sizze_74256, tile_sizze_74256));
                                int32_t virt_num_tblocks_76645 = sext_i64_i32(ldim_74257);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_74254(ctx, ldim_74257, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_74255, 1, 1, bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_74257, num_whole_tiles_74272, residual_input_74496, cond_74497, binop_x_74513, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75826.mem, mem_75828.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75826, "mem_75826") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75828, "mem_75828") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75893, bytes_75470, "mem_75893")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75757.mem, ctx_param_ext_75755, (int64_t []) {ctx_param_ext_75756}, (int64_t []) {nR_47166})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75891.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75895, bytes_75470, "mem_75895")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75754.mem, ctx_param_ext_75752, (int64_t []) {ctx_param_ext_75753}, (int64_t []) {nR_47166})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
                                return 1;
                            
                            int64_t tmp_66488 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_75895, "mem_75895") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_75893, "mem_75893") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66488;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75907, &ext_mem_75901, "ext_mem_75901") != 0)
                            return 1;
                        ext_75906 = ext_75900;
                        ext_75905 = ext_75899;
                        if (memblock_set_device(ctx, &ext_mem_75904, &ext_mem_75898, "ext_mem_75898") != 0)
                            return 1;
                        ext_75903 = ext_75897;
                        ext_75902 = ext_75896;
                        loopres_66427 = loopres_f_res_66432;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
                        return 1;
                    
                    bool loop_cond_66489 = slt64(loopres_66427, numIter_66379);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76590, &ext_mem_75907, "ext_mem_75907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76591, &ext_mem_75904, "ext_mem_75904") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76592 = ext_75906;
                    int64_t ctx_param_ext_tmp_76593 = ext_75905;
                    int64_t ctx_param_ext_tmp_76594 = ext_75903;
                    int64_t ctx_param_ext_tmp_76595 = ext_75902;
                    bool loop_while_tmp_76596 = loop_cond_66489;
                    int64_t p_tmp_76597 = loopres_66427;
                    
                    if (memblock_set_device(ctx, &mem_param_75754, &mem_param_tmp_76590, "mem_param_tmp_76590") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75757, &mem_param_tmp_76591, "mem_param_tmp_76591") != 0)
                        return 1;
                    ctx_param_ext_75752 = ctx_param_ext_tmp_76592;
                    ctx_param_ext_75753 = ctx_param_ext_tmp_76593;
                    ctx_param_ext_75755 = ctx_param_ext_tmp_76594;
                    ctx_param_ext_75756 = ctx_param_ext_tmp_76595;
                    loop_while_66396 = loop_while_tmp_76596;
                    p_66397 = p_tmp_76597;
                }
                if (memblock_set_device(ctx, &ext_mem_75913, &mem_param_75754, "mem_param_75754") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75912, &mem_param_75757, "mem_param_75757") != 0)
                    return 1;
                ext_75911 = ctx_param_ext_75752;
                ext_75910 = ctx_param_ext_75753;
                ext_75909 = ctx_param_ext_75755;
                ext_75908 = ctx_param_ext_75756;
                defunc_0_find_joinTuples_res_66392 = loop_while_66396;
                defunc_0_find_joinTuples_res_66393 = p_66397;
                if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75913, "ext_mem_75913") != 0)
                    return 1;
                ext_75918 = ext_75911;
                ext_75917 = ext_75910;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75912, "ext_mem_75912") != 0)
                    return 1;
                ext_75915 = ext_75909;
                ext_75914 = ext_75908;
            } else {
                if (memblock_alloc_device(ctx, &mem_75486, bytes_75485, "mem_75486")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75486, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_47166) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75488, bytes_75485, "mem_75488")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75488, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_47166) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75490, (int64_t) 8, "mem_75490")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_76671(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_75467.mem, mem_75490.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75490, "mem_75490") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75489, (int64_t) 8, "mem_75489")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_75489, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75489, "mem_75489") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75492, (int64_t) 1, "mem_75492")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_longzigpuseq_76677(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75483.mem, ext_mem_75491.mem, mem_75492.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
                    return 1;
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75494, (int64_t) 8, "mem_75494")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_longzigpuseq_76683(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_47166, y_64988, tR_mem_75467.mem, mem_75483.mem, mem_75492.mem, mem_75494.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75494, "mem_75494") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75493, (int64_t) 8, "mem_75493")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx, mem_75493, (int64_t) 1, (int64_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75493, "mem_75493") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_65003;
                int64_t defunc_0_windowed_partitionFunc_res_65004;
                bool loop_while_65007;
                int64_t p_65008;
                
                loop_while_65007 = loop_cond_64985;
                p_65008 = (int64_t) 0;
                while (loop_while_65007) {
                    int64_t start_65011 = mul64(partitionsPerWindow_47172, p_65008);
                    int64_t end_65012 = add64(partitionsPerWindow_47172, start_65011);
                    int64_t max_res_65013 = smax64((int64_t) 1, start_65011);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014 = sub64(end_65012, max_res_65013);
                    bool bounds_invalid_upwards_65015 = slt64(end_65012, max_res_65013);
                    bool valid_65016 = !bounds_invalid_upwards_65015;
                    bool range_valid_c_65017;
                    
                    if (!valid_65016) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_65013, "..<", (long long) end_65012, " is invalid.", "-> #0  ftbasics.fut:153:43-68\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_65020 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 == (int64_t) 0;
                    bool nonzzero_65021 = !zzero_65020;
                    bool nonzzero_cert_65022;
                    
                    if (!nonzzero_65021) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:156:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_75503 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool cond_65223 = slt64((int64_t) 0, start_65011);
                    int64_t conc_tmp_65224 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    int64_t ret_65225;
                    
                    if (cond_65223) {
                        ret_65225 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    } else {
                        ret_65225 = conc_tmp_65224;
                    }
                    
                    bool eq_x_y_65233 = partitionsPerWindow_47172 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool eq_x_zz_65234 = partitionsPerWindow_47172 == conc_tmp_65224;
                    bool p_and_eq_x_y_65235 = cond_65223 && eq_x_y_65233;
                    bool not_p_65236 = !cond_65223;
                    bool p_and_eq_x_y_65237 = eq_x_zz_65234 && not_p_65236;
                    bool dim_match_65238 = p_and_eq_x_y_65235 || p_and_eq_x_y_65237;
                    bool empty_or_match_cert_65239;
                    
                    if (!dim_match_65238) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_65225, "] cannot match shape of type `[", (long long) partitionsPerWindow_47172, "](i64, i64)`.", "-> #0  ftbasics.fut:217:5-222:49\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_65241 = add64(m_64987, start_65011);
                    bool zzero_leq_i_p_m_t_s_65242 = sle64((int64_t) 0, i_p_m_t_s_65241);
                    bool i_p_m_t_s_leq_w_65243 = slt64(i_p_m_t_s_65241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool zzero_lte_i_65244 = sle64((int64_t) 0, start_65011);
                    bool i_lte_j_65245 = sle64(start_65011, end_65012);
                    bool y_65246 = i_p_m_t_s_leq_w_65243 && zzero_lte_i_65244;
                    bool y_65247 = zzero_leq_i_p_m_t_s_65242 && y_65246;
                    bool forwards_ok_65248 = i_lte_j_65245 && y_65247;
                    bool ok_or_empty_65249 = empty_slice_64986 || forwards_ok_65248;
                    bool index_certs_65250;
                    
                    if (!ok_or_empty_65249) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65011, ":", (long long) end_65012, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:108:37-74\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_65019 = add64(nR_47166, nR_47166);
                    int64_t segmap_usable_groups_70341 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_70340);
                    
                    if (memblock_alloc_device(ctx, &mem_75504, bytes_75503, "mem_75504")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_75506, bytes_75503, "mem_75506")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_76693 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_70340));
                    
                    {
                        err = gpu_kernel_inner_SMJ_longzisegmap_70345(ctx, segmap_usable_groups_70341, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70133, 1, 1, (int64_t) 0, nR_47166, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, max_res_65013, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, zt_rhs_65019, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75495.mem, mem_75504.mem, mem_75506.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_75508 = (int64_t) 8 * ret_65225;
                    
                    if (cond_65223) {
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75504, "mem_75504") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75506, "mem_75506") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75511, bytes_75508, "mem_75511")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_75511, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_75509, bytes_75508, "mem_75509")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_76714 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76714, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_76714 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76714, (int64_t []) {(int64_t) 1}, mem_75504.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76714 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        
                        int64_t tmp_offs_76715 = (int64_t) 0;
                        
                        if (!(tmp_offs_76715 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76715, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_76715 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76715, (int64_t []) {(int64_t) 1}, mem_75506.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76715 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75509, "mem_75509") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75511, "mem_75511") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
                        return 1;
                    
                    int64_t tmp_65240 = add64((int64_t) 1, p_65008);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75486.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75488.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
                        return 1;
                    
                    bool loop_cond_65253 = slt64(tmp_65240, numberOfWindows_47173);
                    bool loop_while_tmp_76689 = loop_cond_65253;
                    int64_t p_tmp_76690 = tmp_65240;
                    
                    loop_while_65007 = loop_while_tmp_76689;
                    p_65008 = p_tmp_76690;
                }
                defunc_0_windowed_partitionFunc_res_65003 = loop_while_65007;
                defunc_0_windowed_partitionFunc_res_65004 = p_65008;
                if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_75522, bytes_75485, "mem_75522")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75524, bytes_75485, "mem_75524")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_76716 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_70714));
                
                {
                    err = gpu_kernel_inner_SMJ_longzisegmap_70719(ctx, segmap_usable_groups_70715, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_70550, 1, 1, (int64_t) 0, nR_47166, gt_rhs_64823, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zeze_rhs_65256, tR_mem_75467.mem, tS_mem_75468.mem, mem_75486.mem, mem_75488.mem, mem_75522.mem, mem_75524.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_75746;
                int64_t ext_75745;
                int64_t ext_75744;
                int64_t ext_75743;
                bool defunc_0_join_chunks_res_65412;
                int64_t defunc_0_join_chunks_res_65413;
                bool loop_while_65416;
                int64_t p_65417;
                int64_t ctx_param_ext_75525;
                int64_t ctx_param_ext_75526;
                int64_t ctx_param_ext_75528;
                int64_t ctx_param_ext_75529;
                
                if (memblock_set_device(ctx, &mem_param_75527, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75530, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75525 = (int64_t) 0;
                ctx_param_ext_75526 = (int64_t) 1;
                ctx_param_ext_75528 = (int64_t) 0;
                ctx_param_ext_75529 = (int64_t) 1;
                loop_while_65416 = loop_cond_65411;
                p_65417 = (int64_t) 0;
                while (loop_while_65416) {
                    bool x_65420 = sle64((int64_t) 0, p_65417);
                    bool y_65421 = slt64(p_65417, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65422 = x_65420 && y_65421;
                    bool index_certs_65423;
                    
                    if (!bounds_check_65422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:186:22-34\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_77431;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77431, mem_75522.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65424 = read_res_77431;
                    int64_t read_res_77432;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77432, mem_75524.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65425 = read_res_77432;
                    int64_t min_res_65426 = smin64(zeze_rhs_65256, loopres_65425);
                    bool cond_65427 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, loopres_65424);
                    bool cond_65431 = slt64(min_res_65426, (int64_t) 0);
                    bool protect_assert_disj_65433 = bounds_check_65422 || cond_65431;
                    bool protect_assert_disj_76139 = cond_65427 || protect_assert_disj_65433;
                    bool index_certs_65434;
                    
                    if (!protect_assert_disj_76139) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:190:19-32\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_65437 = add64((int64_t) 1, p_65417);
                    bool cond_65438 = zeze_lhs_65437 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    bool x_65440 = sle64((int64_t) 0, zeze_lhs_65437);
                    bool y_65441 = slt64(zeze_lhs_65437, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65442 = x_65440 && y_65441;
                    bool protect_assert_disj_65443 = cond_65438 || bounds_check_65442;
                    bool protect_assert_disj_65444 = cond_65431 || protect_assert_disj_65443;
                    bool protect_assert_disj_76142 = cond_65427 || protect_assert_disj_65444;
                    bool index_certs_65445;
                    
                    if (!protect_assert_disj_76142) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65437, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:191:49-64\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_76136 = !cond_65427;
                    bool x_65432 = !cond_65431;
                    bool protect_cond_conj_76140 = x_65432 && x_76136;
                    int64_t loopres_f_res_f_res_65435;
                    
                    if (protect_cond_conj_76140) {
                        int64_t read_res_77433;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77433, mem_75486.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66705 = read_res_77433;
                        
                        loopres_f_res_f_res_65435 = x_66705;
                    } else {
                        loopres_f_res_f_res_65435 = (int64_t) 0;
                    }
                    
                    bool x_65439 = !cond_65438;
                    bool protect_cond_conj_65446 = x_65432 && x_65439;
                    bool protect_cond_conj_76143 = protect_cond_conj_65446 && x_76136;
                    int64_t r_end_f_res_65447;
                    
                    if (protect_cond_conj_76143) {
                        int64_t read_res_77434;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77434, mem_75486.mem, zeze_lhs_65437 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66706 = read_res_77434;
                        
                        r_end_f_res_65447 = x_66706;
                    } else {
                        r_end_f_res_65447 = (int64_t) 0;
                    }
                    
                    int64_t r_end_65449;
                    
                    if (cond_65438) {
                        r_end_65449 = nR_47166;
                    } else {
                        r_end_65449 = r_end_f_res_65447;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 = sub64(r_end_65449, loopres_f_res_f_res_65435);
                    int64_t ext_75735;
                    
                    if (cond_65431) {
                        ext_75735 = ctx_param_ext_75525;
                    } else {
                        ext_75735 = (int64_t) 0;
                    }
                    
                    int64_t ext_75734;
                    
                    if (cond_65431) {
                        ext_75734 = ctx_param_ext_75526;
                    } else {
                        ext_75734 = (int64_t) 1;
                    }
                    
                    int64_t ext_75732;
                    
                    if (cond_65431) {
                        ext_75732 = ctx_param_ext_75528;
                    } else {
                        ext_75732 = (int64_t) 0;
                    }
                    
                    int64_t ext_75731;
                    
                    if (cond_65431) {
                        ext_75731 = ctx_param_ext_75529;
                    } else {
                        ext_75731 = (int64_t) 1;
                    }
                    
                    int64_t bytes_75531 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;
                    int64_t ext_75741;
                    
                    if (cond_65427) {
                        ext_75741 = ctx_param_ext_75525;
                    } else {
                        ext_75741 = ext_75735;
                    }
                    
                    int64_t ext_75740;
                    
                    if (cond_65427) {
                        ext_75740 = ctx_param_ext_75526;
                    } else {
                        ext_75740 = ext_75734;
                    }
                    
                    int64_t ext_75738;
                    
                    if (cond_65427) {
                        ext_75738 = ctx_param_ext_75528;
                    } else {
                        ext_75738 = ext_75732;
                    }
                    
                    int64_t ext_75737;
                    
                    if (cond_65427) {
                        ext_75737 = ctx_param_ext_75529;
                    } else {
                        ext_75737 = ext_75731;
                    }
                    
                    int64_t loopres_65428;
                    
                    if (cond_65427) {
                        loopres_65428 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    } else {
                        loopres_65428 = zeze_lhs_65437;
                    }
                    if (cond_65427) {
                        if (memblock_set_device(ctx, &ext_mem_75742, &mem_param_75527, "mem_param_75527") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &mem_param_75530, "mem_param_75530") != 0)
                            return 1;
                    } else {
                        if (cond_65431) {
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_param_75527, "mem_param_75527") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_param_75530, "mem_param_75530") != 0)
                                return 1;
                        } else {
                            bool empty_slice_65453 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 == (int64_t) 0;
                            int64_t m_65454 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 1);
                            int64_t i_p_m_t_s_65455 = add64(loopres_f_res_f_res_65435, m_65454);
                            bool zzero_leq_i_p_m_t_s_65456 = sle64((int64_t) 0, i_p_m_t_s_65455);
                            bool i_p_m_t_s_leq_w_65457 = slt64(i_p_m_t_s_65455, nR_47166);
                            bool zzero_lte_i_65458 = sle64((int64_t) 0, loopres_f_res_f_res_65435);
                            bool i_lte_j_65459 = sle64(loopres_f_res_f_res_65435, r_end_65449);
                            bool y_65460 = i_p_m_t_s_leq_w_65457 && zzero_lte_i_65458;
                            bool y_65461 = zzero_leq_i_p_m_t_s_65456 && y_65460;
                            bool forwards_ok_65462 = i_lte_j_65459 && y_65461;
                            bool ok_or_empty_65463 = empty_slice_65453 || forwards_ok_65462;
                            bool index_certs_65464;
                            
                            if (!ok_or_empty_65463) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_65435, ":", (long long) r_end_65449, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftSMJ.fut:192:16-33\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_65467 = sle64(loopres_65424, min_res_65426);
                            bool loop_not_taken_65472 = !loop_cond_65467;
                            bool protect_assert_disj_65473 = loop_not_taken_65472 || nonzzero_66377;
                            bool nonzzero_cert_65474;
                            
                            if (!protect_assert_disj_65473) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75532, bytes_75531, "mem_75532")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75532, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75534, bytes_75531, "mem_75534")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75534, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_65468 = add64(extParallelism_47174, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                            int64_t zs_lhs_65469 = sub64(zm_lhs_65468, (int64_t) 1);
                            int64_t numIter_65475 = sdiv_safe64(zs_lhs_65469, extParallelism_47174);
                            bool loop_cond_65476 = slt64((int64_t) 0, numIter_65475);
                            bool loop_not_taken_65477 = !loop_cond_65476;
                            int64_t segmap_tblock_sizze_71067;
                            
                            segmap_tblock_sizze_71067 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71057;
                            
                            int64_t segmap_usable_groups_71068 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71067);
                            int64_t segmap_tblock_sizze_71088;
                            
                            segmap_tblock_sizze_71088 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71079;
                            
                            int64_t segmap_usable_groups_71089 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71088);
                            
                            if (memblock_alloc_device(ctx, &mem_75553, (int64_t) 8, "mem_75553")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75554, (int64_t) 8, "mem_75554")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75557, (int64_t) 1, "mem_75557")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_65478;
                            int64_t loopres_f_res_f_res_65479;
                            bool loop_while_65482;
                            int64_t dp_65483;
                            
                            if (memblock_set_device(ctx, &mem_param_75537, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_75540, &mem_75532, "mem_75532") != 0)
                                return 1;
                            loop_while_65482 = loop_cond_65467;
                            dp_65483 = loopres_65424;
                            while (loop_while_65482) {
                                bool x_65486 = sle64((int64_t) 0, dp_65483);
                                bool y_65487 = slt64(dp_65483, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65488 = x_65486 && y_65487;
                                bool index_certs_65489;
                                
                                if (!bounds_check_65488) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_65483, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:196:21-38\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_77435;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_77435, mem_75488.mem, dp_65483 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_65490 = read_res_77435;
                                int64_t zeze_lhs_65491 = add64((int64_t) 1, dp_65483);
                                bool cond_65492 = zeze_lhs_65491 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                                bool x_65493 = !cond_65492;
                                bool x_65494 = sle64((int64_t) 0, zeze_lhs_65491);
                                bool y_65495 = slt64(zeze_lhs_65491, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65496 = x_65494 && y_65495;
                                bool protect_assert_disj_65497 = cond_65492 || bounds_check_65496;
                                bool index_certs_65498;
                                
                                if (!protect_assert_disj_65497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65491, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:197:55-74\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_65499;
                                
                                if (x_65493) {
                                    int64_t read_res_77436;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77436, mem_75488.mem, zeze_lhs_65491 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_66707 = read_res_77436;
                                    
                                    s_end_f_res_65499 = x_66707;
                                } else {
                                    s_end_f_res_65499 = (int64_t) 0;
                                }
                                
                                int64_t s_end_65501;
                                
                                if (cond_65492) {
                                    s_end_65501 = nR_47166;
                                } else {
                                    s_end_65501 = s_end_f_res_65499;
                                }
                                
                                int64_t j_m_i_65502 = sub64(s_end_65501, loopres_65490);
                                bool empty_slice_65503 = j_m_i_65502 == (int64_t) 0;
                                int64_t m_65504 = sub64(j_m_i_65502, (int64_t) 1);
                                int64_t i_p_m_t_s_65505 = add64(loopres_65490, m_65504);
                                bool zzero_leq_i_p_m_t_s_65506 = sle64((int64_t) 0, i_p_m_t_s_65505);
                                bool i_p_m_t_s_leq_w_65507 = slt64(i_p_m_t_s_65505, nR_47166);
                                bool zzero_lte_i_65508 = sle64((int64_t) 0, loopres_65490);
                                bool i_lte_j_65509 = sle64(loopres_65490, s_end_65501);
                                bool y_65510 = i_p_m_t_s_leq_w_65507 && zzero_lte_i_65508;
                                bool y_65511 = zzero_leq_i_p_m_t_s_65506 && y_65510;
                                bool forwards_ok_65512 = i_lte_j_65509 && y_65511;
                                bool ok_or_empty_65513 = empty_slice_65503 || forwards_ok_65512;
                                bool index_certs_65514;
                                
                                if (!ok_or_empty_65513) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65490, ":", (long long) s_end_65501, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  ftSMJ.fut:198:18-35\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_65517 = slt64((int64_t) 0, j_m_i_65502);
                                bool loop_not_taken_65518 = !cond_65517;
                                bool x_65519 = sle64((int64_t) 0, m_65504);
                                bool y_65520 = slt64(m_65504, j_m_i_65502);
                                bool bounds_check_65524 = x_65519 && y_65520;
                                bool protect_assert_disj_65525 = loop_not_taken_65518 || bounds_check_65524;
                                bool protect_assert_disj_65526 = loop_not_taken_65477 || protect_assert_disj_65525;
                                bool index_certs_65527;
                                
                                if (!protect_assert_disj_65526) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65504, "] out of bounds for array of shape [", (long long) j_m_i_65502, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_65911 = tS_start_64840 + loopres_65490;
                                int64_t find_joinTuples_arg3_65516 = add64(join_chunks_arg3_64981, loopres_65490);
                                bool protect_cond_conj_65521 = loop_cond_65476 && cond_65517;
                                
                                if (protect_cond_conj_65521) {
                                    if (memblock_alloc_device(ctx, &mem_75542, (int64_t) 8, "mem_75542")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_76745(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65911, tS_mem_75468.mem, mem_75542.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75542, "mem_75542") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75541, (int64_t) 8, "mem_75541")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i64(ctx, mem_75541, (int64_t) 1, (int64_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75541, "mem_75541") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_65521) {
                                    int64_t slice_66709 = tS_start_64840 + i_p_m_t_s_65505;
                                    
                                    if (memblock_alloc_device(ctx, &mem_75545, (int64_t) 8, "mem_75545")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_76751(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_66709, tS_mem_75468.mem, mem_75545.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75545, "mem_75545") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75544, (int64_t) 8, "mem_75544")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i64(ctx, mem_75544, (int64_t) 1, (int64_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75544, "mem_75544") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_75559 = (int64_t) 8 * j_m_i_65502;
                                int64_t ext_75706;
                                int64_t ext_75705;
                                int64_t ext_75704;
                                int64_t ext_75703;
                                bool defunc_0_find_joinTuples_res_65530;
                                int64_t defunc_0_find_joinTuples_res_65531;
                                bool loop_while_65534;
                                int64_t p_65535;
                                int64_t ctx_param_ext_75547;
                                int64_t ctx_param_ext_75548;
                                int64_t ctx_param_ext_75550;
                                int64_t ctx_param_ext_75551;
                                
                                if (memblock_set_device(ctx, &mem_param_75549, &mem_75534, "mem_75534") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75552, &mem_75532, "mem_75532") != 0)
                                    return 1;
                                ctx_param_ext_75547 = (int64_t) 0;
                                ctx_param_ext_75548 = (int64_t) 1;
                                ctx_param_ext_75550 = (int64_t) 0;
                                ctx_param_ext_75551 = (int64_t) 1;
                                loop_while_65534 = loop_cond_65476;
                                p_65535 = (int64_t) 0;
                                while (loop_while_65534) {
                                    int64_t start_65538 = mul64(extParallelism_47174, p_65535);
                                    int64_t min_arg1_65539 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, start_65538);
                                    int64_t min_res_65540 = smin64(extParallelism_47174, min_arg1_65539);
                                    int64_t iter_R_65541 = add64(start_65538, min_res_65540);
                                    bool empty_slice_65542 = min_res_65540 == (int64_t) 0;
                                    int64_t m_65543 = sub64(min_res_65540, (int64_t) 1);
                                    int64_t i_p_m_t_s_65544 = add64(start_65538, m_65543);
                                    bool zzero_leq_i_p_m_t_s_65545 = sle64((int64_t) 0, i_p_m_t_s_65544);
                                    bool i_p_m_t_s_leq_w_65546 = slt64(i_p_m_t_s_65544, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                                    bool zzero_lte_i_65547 = sle64((int64_t) 0, start_65538);
                                    bool i_lte_j_65548 = sle64(start_65538, iter_R_65541);
                                    bool y_65549 = i_p_m_t_s_leq_w_65546 && zzero_lte_i_65547;
                                    bool y_65550 = zzero_leq_i_p_m_t_s_65545 && y_65549;
                                    bool forwards_ok_65551 = i_lte_j_65548 && y_65550;
                                    bool ok_or_empty_65552 = empty_slice_65542 || forwards_ok_65551;
                                    bool index_certs_65553;
                                    
                                    if (!ok_or_empty_65552) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65538, ":", (long long) iter_R_65541, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65560 = slt64(m_65543, min_res_65540);
                                    bool x_65559 = sle64((int64_t) 0, m_65543);
                                    bool bounds_check_65561 = x_65559 && y_65560;
                                    bool index_certs_65562;
                                    
                                    if (!bounds_check_65561) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65543, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65556 = slt64((int64_t) 0, min_res_65540);
                                    bool index_certs_65557;
                                    
                                    if (!y_65556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:376:133-136\n   #2  ftSMJ.fut:365:1-376:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_65554 = loopres_f_res_f_res_65435 + start_65538;
                                    int64_t slice_65563 = loopres_f_res_f_res_65435 + i_p_m_t_s_65544;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_76767(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65554, slice_65563, tR_mem_75467.mem, mem_75553.mem, mem_75554.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75555, &ext_mem_75546, "ext_mem_75546") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75555, &mem_75553, "mem_75553") != 0)
                                        return 1;
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75556, &ext_mem_75543, "ext_mem_75543") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75556, &mem_75554, "mem_75554") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_longzigpuseq_76773(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75554.mem, ext_mem_75555.mem, mem_75557.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
                                        return 1;
                                    
                                    bool read_res_77437;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77437, mem_75557.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_65567 = read_res_77437;
                                    int64_t ext_75701;
                                    int64_t ext_75700;
                                    int64_t ext_75698;
                                    int64_t ext_75697;
                                    int64_t loopres_65568;
                                    
                                    if (defunc_0_gt_res_65567) {
                                        if (memblock_set_device(ctx, &ext_mem_75702, &mem_param_75549, "mem_param_75549") != 0)
                                            return 1;
                                        ext_75701 = ctx_param_ext_75547;
                                        ext_75700 = ctx_param_ext_75548;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &mem_param_75552, "mem_param_75552") != 0)
                                            return 1;
                                        ext_75698 = ctx_param_ext_75550;
                                        ext_75697 = ctx_param_ext_75551;
                                        loopres_65568 = numIter_65475;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_75558, (int64_t) 1, "mem_75558")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_longzigpuseq_76779(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75553.mem, ext_mem_75556.mem, mem_75558.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_77438;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_77438, mem_75558.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_65571 = read_res_77438;
                                        
                                        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
                                            return 1;
                                        
                                        int64_t ext_75695;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75695 = ctx_param_ext_75547;
                                        } else {
                                            ext_75695 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75694;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75694 = ctx_param_ext_75548;
                                        } else {
                                            ext_75694 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_75692;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75692 = ctx_param_ext_75550;
                                        } else {
                                            ext_75692 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75691;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75691 = ctx_param_ext_75551;
                                        } else {
                                            ext_75691 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_65572;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            int64_t tmp_66713 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_param_75549, "mem_param_75549") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_param_75552, "mem_param_75552") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_66713;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_75560, bytes_75559, "mem_75560")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75560.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, slice_65911, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65502})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_7692(ctx, &ext_mem_75562, mem_75560, j_m_i_65502, find_joinTuples_arg3_65516) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_70879;
                                            
                                            suff_outer_par_70879 = *ctx->tuning_params.inner_SMJ_longzisuff_outer_par_1 <= min_res_65540;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_long.suff_outer_par_1", (long) min_res_65540, suff_outer_par_70879 ? "true" : "false");
                                            
                                            int64_t tile_sizze_74966;
                                            
                                            tile_sizze_74966 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74965;
                                            
                                            int64_t tile_sizze_74611;
                                            
                                            tile_sizze_74611 = *ctx->tuning_params.inner_SMJ_longzitile_sizze_74610;
                                            
                                            int64_t num_whole_tiles_74982 = squot_safe64(j_m_i_65502, tile_sizze_74966);
                                            int64_t residual_input_75206 = srem_safe64(j_m_i_65502, tile_sizze_74966);
                                            bool cond_75207 = residual_input_75206 == (int64_t) 0;
                                            int64_t binop_x_75223 = tile_sizze_74966 * num_whole_tiles_74982;
                                            int64_t bytes_75620 = (int64_t) 8 * min_res_65540;
                                            int64_t bytes_75583 = (int64_t) 8 * tile_sizze_74966;
                                            int64_t num_whole_tiles_74627 = squot_safe64(j_m_i_65502, tile_sizze_74611);
                                            int64_t residual_input_74851 = srem_safe64(j_m_i_65502, tile_sizze_74611);
                                            bool cond_74852 = residual_input_74851 == (int64_t) 0;
                                            int64_t binop_x_74868 = tile_sizze_74611 * num_whole_tiles_74627;
                                            int64_t bytes_75644 = (int64_t) 8 * tile_sizze_74611;
                                            int64_t shared_memory_capacity_76837;
                                            
                                            shared_memory_capacity_76837 = ctx->max_shared_memory;
                                            if (suff_outer_par_70879 && sle64(sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76837)) {
                                                int64_t ldim_74612 = sdiv_up64(min_res_65540, tile_sizze_74611);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75682, bytes_75620, "mem_75682")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75684, bytes_75620, "mem_75684")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76785 = sext_i64_i32(sdiv_up64(tile_sizze_74611, tile_sizze_74611));
                                                int32_t virt_num_tblocks_76786 = sext_i64_i32(ldim_74612);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_74609(ctx, ldim_74612, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_74610, 1, 1, bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74612, num_whole_tiles_74627, residual_input_74851, cond_74852, binop_x_74868, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75682.mem, mem_75684.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75682, "mem_75682") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75684, "mem_75684") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_74967 = sdiv_up64(min_res_65540, tile_sizze_74966);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75621, bytes_75620, "mem_75621")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75623, bytes_75620, "mem_75623")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76811 = sext_i64_i32(sdiv_up64(tile_sizze_74966, tile_sizze_74966));
                                                int32_t virt_num_tblocks_76812 = sext_i64_i32(ldim_74967);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_longzisegmap_intrablock_74964(ctx, ldim_74967, 1, 1, *ctx->tuning_params.inner_SMJ_longzitile_sizze_74965, 1, 1, bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74967, num_whole_tiles_74982, residual_input_75206, cond_75207, binop_x_75223, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75621.mem, mem_75623.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75621, "mem_75621") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75623, "mem_75623") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75688, bytes_75531, "mem_75688")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75552.mem, ctx_param_ext_75550, (int64_t []) {ctx_param_ext_75551}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75686.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75690, bytes_75531, "mem_75690")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75549.mem, ctx_param_ext_75547, (int64_t []) {ctx_param_ext_75548}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
                                                return 1;
                                            
                                            int64_t tmp_65619 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_75690, "mem_75690") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_75688, "mem_75688") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_65619;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_75702, &ext_mem_75696, "ext_mem_75696") != 0)
                                            return 1;
                                        ext_75701 = ext_75695;
                                        ext_75700 = ext_75694;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &ext_mem_75693, "ext_mem_75693") != 0)
                                            return 1;
                                        ext_75698 = ext_75692;
                                        ext_75697 = ext_75691;
                                        loopres_65568 = loopres_f_res_65572;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
                                        return 1;
                                    
                                    bool loop_cond_65620 = slt64(loopres_65568, numIter_65475);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_76757, &ext_mem_75702, "ext_mem_75702") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_76758, &ext_mem_75699, "ext_mem_75699") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_76759 = ext_75701;
                                    int64_t ctx_param_ext_tmp_76760 = ext_75700;
                                    int64_t ctx_param_ext_tmp_76761 = ext_75698;
                                    int64_t ctx_param_ext_tmp_76762 = ext_75697;
                                    bool loop_while_tmp_76763 = loop_cond_65620;
                                    int64_t p_tmp_76764 = loopres_65568;
                                    
                                    if (memblock_set_device(ctx, &mem_param_75549, &mem_param_tmp_76757, "mem_param_tmp_76757") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_75552, &mem_param_tmp_76758, "mem_param_tmp_76758") != 0)
                                        return 1;
                                    ctx_param_ext_75547 = ctx_param_ext_tmp_76759;
                                    ctx_param_ext_75548 = ctx_param_ext_tmp_76760;
                                    ctx_param_ext_75550 = ctx_param_ext_tmp_76761;
                                    ctx_param_ext_75551 = ctx_param_ext_tmp_76762;
                                    loop_while_65534 = loop_while_tmp_76763;
                                    p_65535 = p_tmp_76764;
                                }
                                if (memblock_set_device(ctx, &ext_mem_75708, &mem_param_75549, "mem_param_75549") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75707, &mem_param_75552, "mem_param_75552") != 0)
                                    return 1;
                                ext_75706 = ctx_param_ext_75547;
                                ext_75705 = ctx_param_ext_75548;
                                ext_75704 = ctx_param_ext_75550;
                                ext_75703 = ctx_param_ext_75551;
                                defunc_0_find_joinTuples_res_65530 = loop_while_65534;
                                defunc_0_find_joinTuples_res_65531 = p_65535;
                                if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75711, bytes_75531, "mem_75711")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76838 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71067));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_71071(ctx, segmap_usable_groups_71068, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71057, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75703, ext_75704, mem_param_75540.mem, ext_mem_75707.mem, mem_75711.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75714, bytes_75531, "mem_75714")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76847 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71088));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_longzisegmap_71092(ctx, segmap_usable_groups_71089, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71079, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75705, ext_75706, mem_param_75537.mem, ext_mem_75708.mem, mem_75714.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
                                    return 1;
                                
                                bool loop_cond_65630 = sle64(zeze_lhs_65491, min_res_65426);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_76739, &mem_75714, "mem_75714") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_76740, &mem_75711, "mem_75711") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_76741 = loop_cond_65630;
                                int64_t dp_tmp_76742 = zeze_lhs_65491;
                                
                                if (memblock_set_device(ctx, &mem_param_75537, &mem_param_tmp_76739, "mem_param_tmp_76739") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75540, &mem_param_tmp_76740, "mem_param_tmp_76740") != 0)
                                    return 1;
                                loop_while_65482 = loop_while_tmp_76741;
                                dp_65483 = dp_tmp_76742;
                            }
                            if (memblock_set_device(ctx, &ext_mem_75720, &mem_param_75537, "mem_param_75537") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75719, &mem_param_75540, "mem_param_75540") != 0)
                                return 1;
                            loopres_f_res_f_res_65478 = loop_while_65482;
                            loopres_f_res_f_res_65479 = dp_65483;
                            if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_71109;
                            
                            segmap_tblock_sizze_71109 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71099;
                            
                            int64_t segmap_usable_groups_71110 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71109);
                            
                            if (memblock_alloc_device(ctx, &mem_75723, bytes_75531, "mem_75723")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76856 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71109));
                            
                            {
                                err = gpu_kernel_inner_SMJ_longzisegmap_71113(ctx, segmap_usable_groups_71110, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71099, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75528, ctx_param_ext_75529, mem_param_75530.mem, ext_mem_75719.mem, mem_75723.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_71130;
                            
                            segmap_tblock_sizze_71130 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71121;
                            
                            int64_t segmap_usable_groups_71131 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71130);
                            
                            if (memblock_alloc_device(ctx, &mem_75726, bytes_75531, "mem_75726")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76865 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_71130));
                            
                            {
                                err = gpu_kernel_inner_SMJ_longzisegmap_71134(ctx, segmap_usable_groups_71131, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71121, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75525, ctx_param_ext_75526, mem_param_75527.mem, ext_mem_75720.mem, mem_75726.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75728, bytes_75470, "mem_75728")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75530.mem, ctx_param_ext_75528, (int64_t []) {ctx_param_ext_75529}, (int64_t []) {nR_47166})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75723.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75730, bytes_75470, "mem_75730")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75527.mem, ctx_param_ext_75525, (int64_t []) {ctx_param_ext_75526}, (int64_t []) {nR_47166})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_75730, "mem_75730") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_75728, "mem_75728") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75742, &ext_mem_75736, "ext_mem_75736") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &ext_mem_75733, "ext_mem_75733") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_65646 = slt64(loopres_65428, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76729, &ext_mem_75742, "ext_mem_75742") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76730, &ext_mem_75739, "ext_mem_75739") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76731 = ext_75741;
                    int64_t ctx_param_ext_tmp_76732 = ext_75740;
                    int64_t ctx_param_ext_tmp_76733 = ext_75738;
                    int64_t ctx_param_ext_tmp_76734 = ext_75737;
                    bool loop_while_tmp_76735 = loop_cond_65646;
                    int64_t p_tmp_76736 = loopres_65428;
                    
                    if (memblock_set_device(ctx, &mem_param_75527, &mem_param_tmp_76729, "mem_param_tmp_76729") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75530, &mem_param_tmp_76730, "mem_param_tmp_76730") != 0)
                        return 1;
                    ctx_param_ext_75525 = ctx_param_ext_tmp_76731;
                    ctx_param_ext_75526 = ctx_param_ext_tmp_76732;
                    ctx_param_ext_75528 = ctx_param_ext_tmp_76733;
                    ctx_param_ext_75529 = ctx_param_ext_tmp_76734;
                    loop_while_65416 = loop_while_tmp_76735;
                    p_65417 = p_tmp_76736;
                }
                if (memblock_set_device(ctx, &ext_mem_75748, &mem_param_75527, "mem_param_75527") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75747, &mem_param_75530, "mem_param_75530") != 0)
                    return 1;
                ext_75746 = ctx_param_ext_75525;
                ext_75745 = ctx_param_ext_75526;
                ext_75744 = ctx_param_ext_75528;
                ext_75743 = ctx_param_ext_75529;
                defunc_0_join_chunks_res_65412 = loop_while_65416;
                defunc_0_join_chunks_res_65413 = p_65417;
                if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75748, "ext_mem_75748") != 0)
                    return 1;
                ext_75918 = ext_75746;
                ext_75917 = ext_75745;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75747, "ext_mem_75747") != 0)
                    return 1;
                ext_75915 = ext_75744;
                ext_75914 = ext_75743;
            }
            
            int64_t segmap_tblock_sizze_71151;
            
            segmap_tblock_sizze_71151 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71141;
            
            int64_t segmap_usable_groups_71152 = sdiv_up64(nR_47166, segmap_tblock_sizze_71151);
            
            if (memblock_alloc_device(ctx, &mem_75922, bytes_75470, "mem_75922")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76874 = sext_i64_i32(sdiv_up64(nR_47166, segmap_tblock_sizze_71151));
            
            {
                err = gpu_kernel_inner_SMJ_longzisegmap_71155(ctx, segmap_usable_groups_71152, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71141, 1, 1, (int64_t) 0, nR_47166, ext_75914, ext_75915, mem_param_75482.mem, ext_mem_75916.mem, mem_75922.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_71172;
            
            segmap_tblock_sizze_71172 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71163;
            
            int64_t segmap_usable_groups_71173 = sdiv_up64(nR_47166, segmap_tblock_sizze_71172);
            
            if (memblock_alloc_device(ctx, &mem_75925, bytes_75470, "mem_75925")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76883 = sext_i64_i32(sdiv_up64(nR_47166, segmap_tblock_sizze_71172));
            
            {
                err = gpu_kernel_inner_SMJ_longzisegmap_71176(ctx, segmap_usable_groups_71173, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71163, 1, 1, (int64_t) 0, nR_47166, ext_75917, ext_75918, mem_param_75479.mem, ext_mem_75919.mem, mem_75925.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_75926, (int64_t) 1, "mem_75926")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_longzigpuseq_76892(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, i_p_m_t_s_64846, tR_mem_75467.mem, tS_mem_75468.mem, mem_75926.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_77439;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_77439, mem_75926.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_65663 = read_res_77439;
            
            if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
                return 1;
            
            int64_t nextIter_65664;
            
            if (defunc_0_leq_res_65663) {
                int64_t nextIter_t_res_66728 = add64((int64_t) 1, p_64837);
                
                nextIter_65664 = nextIter_t_res_66728;
            } else {
                nextIter_65664 = numIter_64817;
            }
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_75925, "mem_75925") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_75922, "mem_75922") != 0)
                return 1;
            loopres_64861 = nextIter_65664;
        }
        
        bool loop_cond_65666 = slt64(loopres_64861, numIter_64817);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76572, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76573, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        
        bool loop_while_tmp_76574 = loop_cond_65666;
        int64_t p_tmp_76575 = loopres_64861;
        
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75482, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        loop_while_64836 = loop_while_tmp_76574;
        p_64837 = p_tmp_76575;
    }
    if (memblock_set_device(ctx, &ext_mem_75938, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75937, &mem_param_75482, "mem_param_75482") != 0)
        return 1;
    defunc_0_mergeJoin_res_64832 = loop_while_64836;
    defunc_0_mergeJoin_res_64833 = p_64837;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_71182;
    
    segscan_tblock_sizze_71182 = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71181;
    
    int64_t num_tblocks_71184;
    int64_t max_num_tblocks_76898;
    
    max_num_tblocks_76898 = *ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_71183;
    num_tblocks_71184 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_47166, segscan_tblock_sizze_71182), max_num_tblocks_76898)));
    if (memblock_alloc_device(ctx, &mem_75941, bytes_75470, "mem_75941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75943, bytes_75470, "mem_75943")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_47166)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_76899;
        
        shared_memory_76899 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_76900;
        
        thread_block_sizze_76900 = ctx->max_thread_block_size;
        
        int64_t registers_76901;
        
        registers_76901 = ctx->max_registers;
        
        int64_t thread_block_sizze_76902;
        
        thread_block_sizze_76902 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_76903 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_76899, thread_block_sizze_76900), (int64_t) 8), squot64(squot64(registers_76901, thread_block_sizze_76902) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_76904 = sdiv_up64(nR_47166, segscan_tblock_sizze_71182 * chunk_sizze_76903);
        int64_t num_virt_threads_76905 = num_virt_blocks_76904 * segscan_tblock_sizze_71182;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_76903, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_76906, num_virt_blocks_76904, "status_flags_mem_76906")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_76906, num_virt_blocks_76904, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_76928, (int64_t) 8 * num_virt_blocks_76904, "aggregates_mem_76928")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_76930, (int64_t) 8 * num_virt_blocks_76904, "incprefixes_mem_76930")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzisegscan_71187(ctx, num_tblocks_71184, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71181, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_71182), chunk_sizze_76903 * segscan_tblock_sizze_71182 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_71182), chunk_sizze_76903 * segscan_tblock_sizze_71182 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_47166, num_tblocks_71184, num_virt_blocks_76904, num_virt_threads_76905, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, status_flags_mem_76906.mem, aggregates_mem_76928.mem, incprefixes_mem_76930.mem, global_dynid_mem_76932.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_65682 = zzero_64814 || bounds_check_64826;
    bool index_certs_65683;
    
    if (!protect_assert_disj_65682) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65684;
    
    if (nonzzero_64815) {
        int64_t read_res_77440;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77440, mem_75941.mem, gt_rhs_64823 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66731 = read_res_77440;
        
        m_f_res_65684 = x_66731;
    } else {
        m_f_res_65684 = (int64_t) 0;
    }
    
    int64_t m_65686;
    
    if (zzero_64814) {
        m_65686 = (int64_t) 0;
    } else {
        m_65686 = m_f_res_65684;
    }
    
    int64_t m_65696 = sub64(m_65686, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65698 = slt64(m_65696, nR_47166);
    bool zzero_leq_i_p_m_t_s_65697 = sle64((int64_t) 0, m_65696);
    bool y_65700 = zzero_leq_i_p_m_t_s_65697 && i_p_m_t_s_leq_w_65698;
    bool i_lte_j_65699 = sle64((int64_t) 0, m_65686);
    bool forwards_ok_65701 = i_lte_j_65699 && y_65700;
    bool eq_x_zz_65693 = (int64_t) 0 == m_f_res_65684;
    bool p_and_eq_x_y_65694 = nonzzero_64815 && eq_x_zz_65693;
    bool empty_slice_65695 = zzero_64814 || p_and_eq_x_y_65694;
    bool ok_or_empty_65702 = empty_slice_65695 || forwards_ok_65701;
    bool index_certs_65703;
    
    if (!ok_or_empty_65702) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65686, "] out of bounds for array of shape [", (long long) nR_47166, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75944 = (int64_t) 8 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75945, bytes_75944, "mem_75945")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75947, bytes_75944, "mem_75947")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75949, bytes_75944, "mem_75949")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75469.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75951, bytes_75944, "mem_75951")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_75467.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_71192;
    
    segmap_tblock_sizze_71192 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71191;
    
    int64_t num_tblocks_71194;
    int64_t max_num_tblocks_77041;
    
    max_num_tblocks_77041 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71193;
    num_tblocks_71194 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_47166, segmap_tblock_sizze_71192), max_num_tblocks_77041)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77042 = sext_i64_i32(sdiv_up64(nR_47166, segmap_tblock_sizze_71192));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_71189(ctx, num_tblocks_71194, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71191, 1, 1, (int64_t) 0, nR_47166, m_65686, num_tblocks_71194, virt_num_tblocks_77042, tR_mem_75467.mem, ext_mem_75469.mem, ext_mem_75937.mem, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, mem_75945.mem, mem_75947.mem, mem_75949.mem, mem_75951.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_71198;
    
    segscan_tblock_sizze_71198 = *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71197;
    
    int64_t num_tblocks_71200;
    int64_t max_num_tblocks_77055;
    
    max_num_tblocks_77055 = *ctx->tuning_params.inner_SMJ_longzisegscan_num_tblocks_71199;
    num_tblocks_71200 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segscan_tblock_sizze_71198), max_num_tblocks_77055)));
    if (memblock_alloc_device(ctx, &mem_75955, bytes_75944, "mem_75955")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75957, bytes_75944, "mem_75957")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75959, bytes_75944, "mem_75959")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_65686)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_77056;
        
        shared_memory_77056 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_77057;
        
        thread_block_sizze_77057 = ctx->max_thread_block_size;
        
        int64_t registers_77058;
        
        registers_77058 = ctx->max_registers;
        
        int64_t thread_block_sizze_77059;
        
        thread_block_sizze_77059 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_77060 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_77056, thread_block_sizze_77057), (int64_t) 8), squot64(squot64(registers_77058, thread_block_sizze_77059) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_77061 = sdiv_up64(m_65686, segscan_tblock_sizze_71198 * chunk_sizze_77060);
        int64_t num_virt_threads_77062 = num_virt_blocks_77061 * segscan_tblock_sizze_71198;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_77060, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_77063, num_virt_blocks_77061, "status_flags_mem_77063")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_77063, num_virt_blocks_77061, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77065, (int64_t) 8 * num_virt_blocks_77061, "aggregates_mem_77065")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77067, (int64_t) 8 * num_virt_blocks_77061, "incprefixes_mem_77067")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77069, (int64_t) 8 * num_virt_blocks_77061, "aggregates_mem_77069")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77071, (int64_t) 8 * num_virt_blocks_77061, "incprefixes_mem_77071")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzisegscan_71203(ctx, num_tblocks_71200, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegscan_tblock_sizze_71197, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_71198, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_71198), smax64(chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_71198, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_71198), smax64(chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8, chunk_sizze_77060 * segscan_tblock_sizze_71198 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_65686, num_tblocks_71200, num_virt_blocks_77061, num_virt_threads_77062, mem_75945.mem, mem_75955.mem, mem_75957.mem, mem_75959.mem, status_flags_mem_77063.mem, aggregates_mem_77065.mem, incprefixes_mem_77067.mem, aggregates_mem_77069.mem, incprefixes_mem_77071.mem, global_dynid_mem_77073.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_71219;
    
    segmap_tblock_sizze_71219 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71207;
    
    int64_t segmap_usable_groups_71220 = sdiv_up64(m_65686, segmap_tblock_sizze_71219);
    
    if (memblock_alloc_device(ctx, &mem_75962, bytes_75944, "mem_75962")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77208 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_71219));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_71223(ctx, segmap_usable_groups_71220, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71207, 1, 1, (int64_t) 0, m_65686, mem_75955.mem, mem_75962.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
        return 1;
    
    bool cond_65737 = slt64((int64_t) 0, m_65686);
    bool y_65738 = slt64(m_65696, m_65686);
    bool bounds_check_65739 = zzero_leq_i_p_m_t_s_65697 && y_65738;
    bool loop_not_taken_65740 = !cond_65737;
    bool protect_assert_disj_65741 = bounds_check_65739 || loop_not_taken_65740;
    bool index_certs_65742;
    
    if (!protect_assert_disj_65741) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  ftSMJ.fut:284:10-41\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75964, (int64_t) 8, "mem_75964")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_77217(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75962.mem, mem_75964.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75964, "mem_75964") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75963, (int64_t) 8, "mem_75963")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75963, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75963, "mem_75963") != 0)
            return 1;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75967, (int64_t) 8, "mem_75967")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_77223(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75945.mem, mem_75967.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75967, "mem_75967") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75966, (int64_t) 8, "mem_75966")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75966, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75966, "mem_75966") != 0)
            return 1;
    }
    
    bool zzero_65754 = scatter_psizze_47175 == (int64_t) 0;
    bool nonzzero_65755 = !zzero_65754;
    bool nonzzero_cert_65756;
    
    if (!nonzzero_65755) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_65821 = !empty_slice_65695;
    bool protect_assert_disj_65822 = empty_slice_65695 || bounds_check_65739;
    bool index_certs_65823;
    
    if (!protect_assert_disj_65822) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65824;
    
    if (x_65821) {
        int64_t read_res_77441;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77441, mem_75957.mem, m_65696 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66739 = read_res_77441;
        
        m_f_res_65824 = x_66739;
    } else {
        m_f_res_65824 = (int64_t) 0;
    }
    
    int64_t m_65826;
    
    if (empty_slice_65695) {
        m_65826 = (int64_t) 0;
    } else {
        m_65826 = m_f_res_65824;
    }
    
    int64_t m_65836 = sub64(m_65826, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65838 = slt64(m_65836, m_65686);
    bool zzero_leq_i_p_m_t_s_65837 = sle64((int64_t) 0, m_65836);
    bool y_65840 = zzero_leq_i_p_m_t_s_65837 && i_p_m_t_s_leq_w_65838;
    bool i_lte_j_65839 = sle64((int64_t) 0, m_65826);
    bool forwards_ok_65841 = i_lte_j_65839 && y_65840;
    bool eq_x_zz_65833 = (int64_t) 0 == m_f_res_65824;
    bool p_and_eq_x_y_65834 = x_65821 && eq_x_zz_65833;
    bool empty_slice_65835 = empty_slice_65695 || p_and_eq_x_y_65834;
    bool ok_or_empty_65842 = empty_slice_65835 || forwards_ok_65841;
    bool index_certs_65843;
    
    if (!ok_or_empty_65842) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65826, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:376:133-136\n   #4  ftSMJ.fut:365:1-376:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75969 = (int64_t) 8 * m_65826;
    
    if (memblock_alloc_device(ctx, &mem_75974, (int64_t) 8, "mem_75974")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_longzigpuseq_77229(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_75965.mem, ext_mem_75968.mem, mem_75974.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
        return 1;
    
    int64_t n_pairs_t_res_65747;
    
    if (cond_65737) {
        int64_t read_res_77442;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77442, mem_75974.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_75465 = read_res_77442;
        
        n_pairs_t_res_65747 = x_75465;
    } else {
        n_pairs_t_res_65747 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
        return 1;
    
    int64_t n_pairs_65748;
    
    if (cond_65737) {
        n_pairs_65748 = n_pairs_t_res_65747;
    } else {
        n_pairs_65748 = (int64_t) 0;
    }
    
    int64_t bytes_75975 = (int64_t) 8 * n_pairs_65748;
    int64_t segmap_tblock_sizze_71234;
    
    segmap_tblock_sizze_71234 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71233;
    
    int64_t num_tblocks_71236;
    int64_t max_num_tblocks_77235;
    
    max_num_tblocks_77235 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71235;
    num_tblocks_71236 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_71234), max_num_tblocks_77235)));
    if (memblock_alloc_device(ctx, &mem_75970, bytes_75969, "mem_75970")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75970.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75972, bytes_75969, "mem_75972")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75972.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_71242;
    
    segmap_tblock_sizze_71242 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71241;
    
    int64_t num_tblocks_71244;
    int64_t max_num_tblocks_77236;
    
    max_num_tblocks_77236 = *ctx->tuning_params.inner_SMJ_longzisegmap_num_tblocks_71243;
    num_tblocks_71244 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_71242), max_num_tblocks_77236)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77237 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_71242));
    
    {
        err = gpu_kernel_inner_SMJ_longzisegmap_71239(ctx, num_tblocks_71244, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71241, 1, 1, (int64_t) 0, m_65686, m_65826, num_tblocks_71244, virt_num_tblocks_77237, mem_75945.mem, mem_75957.mem, mem_75959.mem, mem_75962.mem, mem_75970.mem, mem_75972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
        return 1;
    
    bool cond_65853 = slt64((int64_t) 0, m_65826);
    int64_t segmap_tblock_sizze_71257;
    
    segmap_tblock_sizze_71257 = *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71249;
    if (memblock_alloc_device(ctx, &mem_75976, bytes_75975, "mem_75976")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75976, n_pairs_65748, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75978, bytes_75975, "mem_75978")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75978, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75980, bytes_75975, "mem_75980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75980, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_65752 = add64(scatter_psizze_47175, n_pairs_65748);
    int64_t zs_lhs_65753 = sub64(zm_lhs_65752, (int64_t) 1);
    int64_t m_65757 = sdiv64(zs_lhs_65753, scatter_psizze_47175);
    bool loop_cond_65758 = slt64((int64_t) 0, m_65757);
    bool partitioned_scatter_res_65759;
    int64_t partitioned_scatter_res_65763;
    bool loop_while_65764;
    int64_t p_65768;
    
    loop_while_65764 = loop_cond_65758;
    p_65768 = (int64_t) 0;
    while (loop_while_65764) {
        int64_t lower_bound_65769 = mul64(scatter_psizze_47175, p_65768);
        int64_t min_arg1_65770 = add64(scatter_psizze_47175, lower_bound_65769);
        int64_t min_res_65771 = smin64(n_pairs_65748, min_arg1_65770);
        int64_t j_m_i_65772 = sub64(min_res_65771, lower_bound_65769);
        bool empty_slice_65773 = j_m_i_65772 == (int64_t) 0;
        int64_t m_65774 = sub64(j_m_i_65772, (int64_t) 1);
        int64_t i_p_m_t_s_65775 = add64(lower_bound_65769, m_65774);
        bool zzero_leq_i_p_m_t_s_65776 = sle64((int64_t) 0, i_p_m_t_s_65775);
        bool i_p_m_t_s_leq_w_65777 = slt64(i_p_m_t_s_65775, n_pairs_65748);
        bool zzero_lte_i_65778 = sle64((int64_t) 0, lower_bound_65769);
        bool i_lte_j_65779 = sle64(lower_bound_65769, min_res_65771);
        bool y_65780 = i_p_m_t_s_leq_w_65777 && zzero_lte_i_65778;
        bool y_65781 = zzero_leq_i_p_m_t_s_65776 && y_65780;
        bool forwards_ok_65782 = i_lte_j_65779 && y_65781;
        bool ok_or_empty_65783 = empty_slice_65773 || forwards_ok_65782;
        bool index_certs_65784;
        
        if (!ok_or_empty_65783) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_65769, ":", (long long) min_res_65771, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_75990 = (int64_t) 8 * j_m_i_65772;
        
        if (memblock_alloc_device(ctx, &mem_75991, bytes_75990, "mem_75991")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75976.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75993, bytes_75990, "mem_75993")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75978.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75995, bytes_75990, "mem_75995")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75980.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77255 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_71234));
        
        {
            err = gpu_kernel_inner_SMJ_longzisegmap_71231(ctx, num_tblocks_71236, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71233, 1, 1, (int64_t) 0, m_65686, lower_bound_65769, min_res_65771, j_m_i_65772, num_tblocks_71236, virt_num_tblocks_77255, mem_75947.mem, mem_75949.mem, mem_75951.mem, mem_75962.mem, mem_75991.mem, mem_75993.mem, mem_75995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_65798 = add64((int64_t) 1, p_65768);
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75976.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75978.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75980.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        
        bool loop_cond_65809 = slt64(tmp_65798, m_65757);
        bool loop_while_tmp_77250 = loop_cond_65809;
        int64_t p_tmp_77254 = tmp_65798;
        
        loop_while_65764 = loop_while_tmp_77250;
        p_65768 = p_tmp_77254;
    }
    partitioned_scatter_res_65759 = loop_while_65764;
    partitioned_scatter_res_65763 = p_65768;
    if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
        return 1;
    
    bool loop_cond_t_res_65854 = slt64(m_65686, n_pairs_65748);
    bool x_65855 = cond_65853 && loop_cond_t_res_65854;
    
    if (memblock_alloc_device(ctx, &mem_76021, (int64_t) 8, "mem_76021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76022, (int64_t) 8, "mem_76022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76023, (int64_t) 8, "mem_76023")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_65856;
    int64_t joinTups_to_joinPairs_InnerJoin_res_65860;
    bool loop_while_65861;
    int64_t p_65865;
    
    if (memblock_set_device(ctx, &mem_param_76008, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76011, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76014, &mem_75980, "mem_75980") != 0)
        return 1;
    loop_while_65861 = x_65855;
    p_65865 = (int64_t) 0;
    while (loop_while_65861) {
        bool x_65866 = sle64((int64_t) 0, p_65865);
        bool y_65867 = slt64(p_65865, m_65826);
        bool bounds_check_65868 = x_65866 && y_65867;
        bool index_certs_65869;
        
        if (!bounds_check_65868) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65865, "] out of bounds for array of shape [", (long long) m_65826, "].", "-> #0  ftSMJ.fut:299:13-42\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_77443;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77443, mem_75972.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65870 = read_res_77443;
        int64_t read_res_77444;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77444, mem_75970.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65871 = read_res_77444;
        bool x_65872 = sle64((int64_t) 0, loopres_65870);
        bool y_65873 = slt64(loopres_65870, n_pairs_65748);
        bool bounds_check_65874 = x_65872 && y_65873;
        bool index_certs_65875;
        
        if (!bounds_check_65874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:301:52-61\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_65886 = add64(loopres_65870, loopres_65871);
        bool empty_slice_65890 = loopres_65871 == (int64_t) 0;
        int64_t m_65891 = sub64(loopres_65871, (int64_t) 1);
        int64_t i_p_m_t_s_65892 = add64(loopres_65870, m_65891);
        bool zzero_leq_i_p_m_t_s_65893 = sle64((int64_t) 0, i_p_m_t_s_65892);
        bool i_p_m_t_s_leq_w_65894 = slt64(i_p_m_t_s_65892, n_pairs_65748);
        bool i_lte_j_65895 = sle64(loopres_65870, tmp_65886);
        bool y_65896 = x_65872 && i_p_m_t_s_leq_w_65894;
        bool y_65897 = zzero_leq_i_p_m_t_s_65893 && y_65896;
        bool forwards_ok_65898 = i_lte_j_65895 && y_65897;
        bool ok_or_empty_65899 = empty_slice_65890 || forwards_ok_65898;
        bool index_certs_65900;
        
        if (!ok_or_empty_65899) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, ":", (long long) tmp_65886, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:305:14-55\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:376:133-136\n   #3  ftSMJ.fut:365:1-376:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_76024 = (int64_t) 8 * loopres_65871;
        int64_t segmap_usable_groups_71258 = sdiv_up64(loopres_65871, segmap_tblock_sizze_71257);
        int64_t tmp_65885 = add64((int64_t) 1, p_65865);
        
        if (memblock_alloc_device(ctx, &mem_76016, bytes_75975, "mem_76016")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76016.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76008.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76018, bytes_75975, "mem_76018")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76011.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76020, bytes_75975, "mem_76020")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76020.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76014.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        
        bool cond_65904 = slt64(tmp_65885, m_65826);
        bool x_65905 = loop_cond_t_res_65854 && cond_65904;
        
        {
            err = gpu_kernel_inner_SMJ_longzigpuseq_77276(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_65870, mem_param_76008.mem, mem_param_76011.mem, mem_param_76014.mem, mem_76021.mem, mem_76022.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76025, bytes_76024, "mem_76025")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77282 = loopres_65871;
        int64_t tblock_sizze_77287;
        
        tblock_sizze_77287 = *ctx->tuning_params.inner_SMJ_longzitblock_sizze_77287;
        
        int64_t virt_num_tblocks_77288 = sdiv_up64(replicate_n_77282, tblock_sizze_77287);
        int64_t num_tblocks_77289 = smin64(virt_num_tblocks_77288, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_longzireplicate_77283(ctx, num_tblocks_77289, 1, 1, tblock_sizze_77287, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77282, virt_num_tblocks_77288, num_tblocks_77289, mem_76021.mem, mem_76025.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76027, bytes_76024, "mem_76027")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77302 = loopres_65871;
        int64_t tblock_sizze_77307;
        
        tblock_sizze_77307 = *ctx->tuning_params.inner_SMJ_longzitblock_sizze_77307;
        
        int64_t virt_num_tblocks_77308 = sdiv_up64(replicate_n_77302, tblock_sizze_77307);
        int64_t num_tblocks_77309 = smin64(virt_num_tblocks_77308, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_longzireplicate_77303(ctx, num_tblocks_77309, 1, 1, tblock_sizze_77307, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77302, virt_num_tblocks_77308, num_tblocks_77309, mem_76022.mem, mem_76027.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77322 = sext_i64_i32(sdiv_up64(loopres_65871, segmap_tblock_sizze_71257));
        
        {
            err = gpu_kernel_inner_SMJ_longzisegmap_71261(ctx, segmap_usable_groups_71258, 1, 1, *ctx->tuning_params.inner_SMJ_longzisegmap_tblock_sizze_71249, 1, 1, (int64_t) 0, loopres_65870, loopres_65871, mem_76020.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76016.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77268, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77269, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77270, &mem_76020, "mem_76020") != 0)
            return 1;
        
        bool loop_while_tmp_77271 = x_65905;
        int64_t p_tmp_77275 = tmp_65885;
        
        if (memblock_set_device(ctx, &mem_param_76008, &mem_param_tmp_77268, "mem_param_tmp_77268") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76011, &mem_param_tmp_77269, "mem_param_tmp_77269") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76014, &mem_param_tmp_77270, "mem_param_tmp_77270") != 0)
            return 1;
        loop_while_65861 = loop_while_tmp_77271;
        p_65865 = p_tmp_77275;
    }
    if (memblock_set_device(ctx, &ext_mem_76039, &mem_param_76008, "mem_param_76008") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76038, &mem_param_76011, "mem_param_76011") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76037, &mem_param_76014, "mem_param_76014") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_65856 = loop_while_65861;
    joinTups_to_joinPairs_InnerJoin_res_65860 = p_65865;
    if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76041, bytes_75975, "mem_76041")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76041.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76039.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76043, bytes_75975, "mem_76043")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76038.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76045, bytes_75975, "mem_76045")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76037.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_76043, "mem_76043") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76543, &mem_76045, "mem_76045") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76544, &mem_76041, "mem_76041") != 0)
        return 1;
    prim_out_76545 = n_pairs_65748;
    if (memblock_set_device(ctx, &*mem_out_p_77424, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77425, &mem_out_76543, "mem_out_76543") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77426, &mem_out_76544, "mem_out_76544") != 0)
        return 1;
    *out_prim_out_77427 = prim_out_76545;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_76045, "mem_76045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76043, "mem_76043") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76041, "mem_76041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77270, "mem_param_tmp_77270") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77269, "mem_param_tmp_77269") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77268, "mem_param_tmp_77268") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76020, "mem_76020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76014, "mem_param_76014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76011, "mem_param_76011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76008, "mem_param_76008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75966, "mem_75966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75967, "mem_75967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75963, "mem_75963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75964, "mem_75964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77071, "incprefixes_mem_77071") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77069, "aggregates_mem_77069") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77067, "incprefixes_mem_77067") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77065, "aggregates_mem_77065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_77063, "status_flags_mem_77063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_76930, "incprefixes_mem_76930") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_76928, "aggregates_mem_76928") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_76906, "status_flags_mem_76906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76573, "mem_param_tmp_76573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76572, "mem_param_tmp_76572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75925, "mem_75925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75922, "mem_75922") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76730, "mem_param_tmp_76730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76729, "mem_param_tmp_76729") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75730, "mem_75730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75728, "mem_75728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76740, "mem_param_tmp_76740") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76739, "mem_param_tmp_76739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75714, "mem_75714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75711, "mem_75711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76758, "mem_param_tmp_76758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76757, "mem_param_tmp_76757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75690, "mem_75690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75688, "mem_75688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75623, "mem_75623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75621, "mem_75621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75684, "mem_75684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75682, "mem_75682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75693, "ext_mem_75693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75696, "ext_mem_75696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75699, "ext_mem_75699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75702, "ext_mem_75702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75552, "mem_param_75552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75549, "mem_param_75549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75544, "mem_75544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75545, "mem_75545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75541, "mem_75541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75542, "mem_75542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75540, "mem_param_75540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75537, "mem_param_75537") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75733, "ext_mem_75733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75736, "ext_mem_75736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75739, "ext_mem_75739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75742, "ext_mem_75742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75530, "mem_param_75530") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75527, "mem_param_75527") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75747, "ext_mem_75747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75748, "ext_mem_75748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75509, "mem_75509") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75511, "mem_75511") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75493, "mem_75493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75494, "mem_75494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75489, "mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75490, "mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76591, "mem_param_tmp_76591") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76590, "mem_param_tmp_76590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75895, "mem_75895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75893, "mem_75893") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75828, "mem_75828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75826, "mem_75826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75889, "mem_75889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75887, "mem_75887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75898, "ext_mem_75898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75901, "ext_mem_75901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75904, "ext_mem_75904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75907, "ext_mem_75907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75757, "mem_param_75757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75754, "mem_param_75754") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75912, "ext_mem_75912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75913, "ext_mem_75913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75749, "mem_75749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75750, "mem_75750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75482, "mem_param_75482") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75474, "mem_75474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75475, "mem_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76544, "mem_out_76544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76543, "mem_out_76543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_77445, struct memblock_device *mem_out_p_77446, struct memblock_device *mem_out_p_77447, int64_t *out_prim_out_77448, struct memblock_device tR_mem_75467, struct memblock_device tS_mem_75468, int64_t nR_37190, int64_t nS_37191, int64_t offset_R_37194, int64_t offset_S_37195, int64_t partitionsPerWindow_37196, int64_t numberOfWindows_37197, int64_t extParallelism_37198, int64_t scatter_psizze_37199)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_76045;
    
    mem_76045.references = NULL;
    
    struct memblock_device mem_76043;
    
    mem_76043.references = NULL;
    
    struct memblock_device mem_76041;
    
    mem_76041.references = NULL;
    
    struct memblock_device mem_param_tmp_77290;
    
    mem_param_tmp_77290.references = NULL;
    
    struct memblock_device mem_param_tmp_77289;
    
    mem_param_tmp_77289.references = NULL;
    
    struct memblock_device mem_param_tmp_77288;
    
    mem_param_tmp_77288.references = NULL;
    
    struct memblock_device mem_76027;
    
    mem_76027.references = NULL;
    
    struct memblock_device mem_76025;
    
    mem_76025.references = NULL;
    
    struct memblock_device mem_76020;
    
    mem_76020.references = NULL;
    
    struct memblock_device mem_76018;
    
    mem_76018.references = NULL;
    
    struct memblock_device mem_76016;
    
    mem_76016.references = NULL;
    
    struct memblock_device mem_param_76014;
    
    mem_param_76014.references = NULL;
    
    struct memblock_device mem_param_76011;
    
    mem_param_76011.references = NULL;
    
    struct memblock_device mem_param_76008;
    
    mem_param_76008.references = NULL;
    
    struct memblock_device ext_mem_76037;
    
    ext_mem_76037.references = NULL;
    
    struct memblock_device ext_mem_76038;
    
    ext_mem_76038.references = NULL;
    
    struct memblock_device ext_mem_76039;
    
    ext_mem_76039.references = NULL;
    
    struct memblock_device mem_76023;
    
    mem_76023.references = NULL;
    
    struct memblock_device mem_76022;
    
    mem_76022.references = NULL;
    
    struct memblock_device mem_76021;
    
    mem_76021.references = NULL;
    
    struct memblock_device mem_75995;
    
    mem_75995.references = NULL;
    
    struct memblock_device mem_75993;
    
    mem_75993.references = NULL;
    
    struct memblock_device mem_75991;
    
    mem_75991.references = NULL;
    
    struct memblock_device mem_75980;
    
    mem_75980.references = NULL;
    
    struct memblock_device mem_75978;
    
    mem_75978.references = NULL;
    
    struct memblock_device mem_75976;
    
    mem_75976.references = NULL;
    
    struct memblock_device mem_75972;
    
    mem_75972.references = NULL;
    
    struct memblock_device mem_75970;
    
    mem_75970.references = NULL;
    
    struct memblock_device mem_75974;
    
    mem_75974.references = NULL;
    
    struct memblock_device mem_75966;
    
    mem_75966.references = NULL;
    
    struct memblock_device mem_75967;
    
    mem_75967.references = NULL;
    
    struct memblock_device ext_mem_75968;
    
    ext_mem_75968.references = NULL;
    
    struct memblock_device mem_75963;
    
    mem_75963.references = NULL;
    
    struct memblock_device mem_75964;
    
    mem_75964.references = NULL;
    
    struct memblock_device ext_mem_75965;
    
    ext_mem_75965.references = NULL;
    
    struct memblock_device mem_75962;
    
    mem_75962.references = NULL;
    
    struct memblock_device incprefixes_mem_77091;
    
    incprefixes_mem_77091.references = NULL;
    
    struct memblock_device aggregates_mem_77089;
    
    aggregates_mem_77089.references = NULL;
    
    struct memblock_device incprefixes_mem_77087;
    
    incprefixes_mem_77087.references = NULL;
    
    struct memblock_device aggregates_mem_77085;
    
    aggregates_mem_77085.references = NULL;
    
    struct memblock_device status_flags_mem_77083;
    
    status_flags_mem_77083.references = NULL;
    
    struct memblock_device mem_75959;
    
    mem_75959.references = NULL;
    
    struct memblock_device mem_75957;
    
    mem_75957.references = NULL;
    
    struct memblock_device mem_75955;
    
    mem_75955.references = NULL;
    
    struct memblock_device mem_75951;
    
    mem_75951.references = NULL;
    
    struct memblock_device mem_75949;
    
    mem_75949.references = NULL;
    
    struct memblock_device mem_75947;
    
    mem_75947.references = NULL;
    
    struct memblock_device mem_75945;
    
    mem_75945.references = NULL;
    
    struct memblock_device incprefixes_mem_76950;
    
    incprefixes_mem_76950.references = NULL;
    
    struct memblock_device aggregates_mem_76948;
    
    aggregates_mem_76948.references = NULL;
    
    struct memblock_device status_flags_mem_76926;
    
    status_flags_mem_76926.references = NULL;
    
    struct memblock_device mem_75943;
    
    mem_75943.references = NULL;
    
    struct memblock_device mem_75941;
    
    mem_75941.references = NULL;
    
    struct memblock_device mem_param_tmp_76593;
    
    mem_param_tmp_76593.references = NULL;
    
    struct memblock_device mem_param_tmp_76592;
    
    mem_param_tmp_76592.references = NULL;
    
    struct memblock_device mem_75926;
    
    mem_75926.references = NULL;
    
    struct memblock_device mem_75925;
    
    mem_75925.references = NULL;
    
    struct memblock_device mem_75922;
    
    mem_75922.references = NULL;
    
    struct memblock_device mem_param_tmp_76750;
    
    mem_param_tmp_76750.references = NULL;
    
    struct memblock_device mem_param_tmp_76749;
    
    mem_param_tmp_76749.references = NULL;
    
    struct memblock_device mem_75730;
    
    mem_75730.references = NULL;
    
    struct memblock_device mem_75728;
    
    mem_75728.references = NULL;
    
    struct memblock_device mem_75726;
    
    mem_75726.references = NULL;
    
    struct memblock_device mem_75723;
    
    mem_75723.references = NULL;
    
    struct memblock_device mem_param_tmp_76760;
    
    mem_param_tmp_76760.references = NULL;
    
    struct memblock_device mem_param_tmp_76759;
    
    mem_param_tmp_76759.references = NULL;
    
    struct memblock_device mem_75714;
    
    mem_75714.references = NULL;
    
    struct memblock_device mem_75711;
    
    mem_75711.references = NULL;
    
    struct memblock_device mem_param_tmp_76778;
    
    mem_param_tmp_76778.references = NULL;
    
    struct memblock_device mem_param_tmp_76777;
    
    mem_param_tmp_76777.references = NULL;
    
    struct memblock_device mem_75690;
    
    mem_75690.references = NULL;
    
    struct memblock_device mem_75688;
    
    mem_75688.references = NULL;
    
    struct memblock_device mem_75623;
    
    mem_75623.references = NULL;
    
    struct memblock_device mem_75621;
    
    mem_75621.references = NULL;
    
    struct memblock_device mem_75684;
    
    mem_75684.references = NULL;
    
    struct memblock_device mem_75682;
    
    mem_75682.references = NULL;
    
    struct memblock_device ext_mem_75685;
    
    ext_mem_75685.references = NULL;
    
    struct memblock_device ext_mem_75686;
    
    ext_mem_75686.references = NULL;
    
    struct memblock_device ext_mem_75562;
    
    ext_mem_75562.references = NULL;
    
    struct memblock_device mem_75560;
    
    mem_75560.references = NULL;
    
    struct memblock_device ext_mem_75693;
    
    ext_mem_75693.references = NULL;
    
    struct memblock_device ext_mem_75696;
    
    ext_mem_75696.references = NULL;
    
    struct memblock_device mem_75558;
    
    mem_75558.references = NULL;
    
    struct memblock_device ext_mem_75699;
    
    ext_mem_75699.references = NULL;
    
    struct memblock_device ext_mem_75702;
    
    ext_mem_75702.references = NULL;
    
    struct memblock_device ext_mem_75556;
    
    ext_mem_75556.references = NULL;
    
    struct memblock_device ext_mem_75555;
    
    ext_mem_75555.references = NULL;
    
    struct memblock_device mem_param_75552;
    
    mem_param_75552.references = NULL;
    
    struct memblock_device mem_param_75549;
    
    mem_param_75549.references = NULL;
    
    struct memblock_device ext_mem_75707;
    
    ext_mem_75707.references = NULL;
    
    struct memblock_device ext_mem_75708;
    
    ext_mem_75708.references = NULL;
    
    struct memblock_device mem_75544;
    
    mem_75544.references = NULL;
    
    struct memblock_device mem_75545;
    
    mem_75545.references = NULL;
    
    struct memblock_device ext_mem_75546;
    
    ext_mem_75546.references = NULL;
    
    struct memblock_device mem_75541;
    
    mem_75541.references = NULL;
    
    struct memblock_device mem_75542;
    
    mem_75542.references = NULL;
    
    struct memblock_device ext_mem_75543;
    
    ext_mem_75543.references = NULL;
    
    struct memblock_device mem_param_75540;
    
    mem_param_75540.references = NULL;
    
    struct memblock_device mem_param_75537;
    
    mem_param_75537.references = NULL;
    
    struct memblock_device ext_mem_75719;
    
    ext_mem_75719.references = NULL;
    
    struct memblock_device ext_mem_75720;
    
    ext_mem_75720.references = NULL;
    
    struct memblock_device mem_75557;
    
    mem_75557.references = NULL;
    
    struct memblock_device mem_75554;
    
    mem_75554.references = NULL;
    
    struct memblock_device mem_75553;
    
    mem_75553.references = NULL;
    
    struct memblock_device mem_75534;
    
    mem_75534.references = NULL;
    
    struct memblock_device mem_75532;
    
    mem_75532.references = NULL;
    
    struct memblock_device ext_mem_75733;
    
    ext_mem_75733.references = NULL;
    
    struct memblock_device ext_mem_75736;
    
    ext_mem_75736.references = NULL;
    
    struct memblock_device ext_mem_75739;
    
    ext_mem_75739.references = NULL;
    
    struct memblock_device ext_mem_75742;
    
    ext_mem_75742.references = NULL;
    
    struct memblock_device mem_param_75530;
    
    mem_param_75530.references = NULL;
    
    struct memblock_device mem_param_75527;
    
    mem_param_75527.references = NULL;
    
    struct memblock_device ext_mem_75747;
    
    ext_mem_75747.references = NULL;
    
    struct memblock_device ext_mem_75748;
    
    ext_mem_75748.references = NULL;
    
    struct memblock_device mem_75524;
    
    mem_75524.references = NULL;
    
    struct memblock_device mem_75522;
    
    mem_75522.references = NULL;
    
    struct memblock_device mem_75509;
    
    mem_75509.references = NULL;
    
    struct memblock_device mem_75511;
    
    mem_75511.references = NULL;
    
    struct memblock_device ext_mem_75512;
    
    ext_mem_75512.references = NULL;
    
    struct memblock_device ext_mem_75513;
    
    ext_mem_75513.references = NULL;
    
    struct memblock_device mem_75506;
    
    mem_75506.references = NULL;
    
    struct memblock_device mem_75504;
    
    mem_75504.references = NULL;
    
    struct memblock_device mem_75493;
    
    mem_75493.references = NULL;
    
    struct memblock_device mem_75494;
    
    mem_75494.references = NULL;
    
    struct memblock_device ext_mem_75495;
    
    ext_mem_75495.references = NULL;
    
    struct memblock_device mem_75492;
    
    mem_75492.references = NULL;
    
    struct memblock_device mem_75489;
    
    mem_75489.references = NULL;
    
    struct memblock_device mem_75490;
    
    mem_75490.references = NULL;
    
    struct memblock_device ext_mem_75491;
    
    ext_mem_75491.references = NULL;
    
    struct memblock_device mem_75488;
    
    mem_75488.references = NULL;
    
    struct memblock_device mem_75486;
    
    mem_75486.references = NULL;
    
    struct memblock_device mem_param_tmp_76611;
    
    mem_param_tmp_76611.references = NULL;
    
    struct memblock_device mem_param_tmp_76610;
    
    mem_param_tmp_76610.references = NULL;
    
    struct memblock_device mem_75895;
    
    mem_75895.references = NULL;
    
    struct memblock_device mem_75893;
    
    mem_75893.references = NULL;
    
    struct memblock_device mem_75828;
    
    mem_75828.references = NULL;
    
    struct memblock_device mem_75826;
    
    mem_75826.references = NULL;
    
    struct memblock_device mem_75889;
    
    mem_75889.references = NULL;
    
    struct memblock_device mem_75887;
    
    mem_75887.references = NULL;
    
    struct memblock_device ext_mem_75890;
    
    ext_mem_75890.references = NULL;
    
    struct memblock_device ext_mem_75891;
    
    ext_mem_75891.references = NULL;
    
    struct memblock_device ext_mem_75767;
    
    ext_mem_75767.references = NULL;
    
    struct memblock_device mem_75765;
    
    mem_75765.references = NULL;
    
    struct memblock_device ext_mem_75898;
    
    ext_mem_75898.references = NULL;
    
    struct memblock_device ext_mem_75901;
    
    ext_mem_75901.references = NULL;
    
    struct memblock_device mem_75763;
    
    mem_75763.references = NULL;
    
    struct memblock_device ext_mem_75904;
    
    ext_mem_75904.references = NULL;
    
    struct memblock_device ext_mem_75907;
    
    ext_mem_75907.references = NULL;
    
    struct memblock_device ext_mem_75761;
    
    ext_mem_75761.references = NULL;
    
    struct memblock_device ext_mem_75760;
    
    ext_mem_75760.references = NULL;
    
    struct memblock_device mem_param_75757;
    
    mem_param_75757.references = NULL;
    
    struct memblock_device mem_param_75754;
    
    mem_param_75754.references = NULL;
    
    struct memblock_device ext_mem_75912;
    
    ext_mem_75912.references = NULL;
    
    struct memblock_device ext_mem_75913;
    
    ext_mem_75913.references = NULL;
    
    struct memblock_device mem_75762;
    
    mem_75762.references = NULL;
    
    struct memblock_device mem_75759;
    
    mem_75759.references = NULL;
    
    struct memblock_device mem_75758;
    
    mem_75758.references = NULL;
    
    struct memblock_device mem_75749;
    
    mem_75749.references = NULL;
    
    struct memblock_device mem_75750;
    
    mem_75750.references = NULL;
    
    struct memblock_device ext_mem_75751;
    
    ext_mem_75751.references = NULL;
    
    struct memblock_device ext_mem_75916;
    
    ext_mem_75916.references = NULL;
    
    struct memblock_device ext_mem_75919;
    
    ext_mem_75919.references = NULL;
    
    struct memblock_device ext_mem_75929;
    
    ext_mem_75929.references = NULL;
    
    struct memblock_device ext_mem_75932;
    
    ext_mem_75932.references = NULL;
    
    struct memblock_device mem_param_75482;
    
    mem_param_75482.references = NULL;
    
    struct memblock_device mem_param_75479;
    
    mem_param_75479.references = NULL;
    
    struct memblock_device ext_mem_75937;
    
    ext_mem_75937.references = NULL;
    
    struct memblock_device ext_mem_75938;
    
    ext_mem_75938.references = NULL;
    
    struct memblock_device mem_75484;
    
    mem_75484.references = NULL;
    
    struct memblock_device mem_75483;
    
    mem_75483.references = NULL;
    
    struct memblock_device mem_75474;
    
    mem_75474.references = NULL;
    
    struct memblock_device mem_75475;
    
    mem_75475.references = NULL;
    
    struct memblock_device ext_mem_75476;
    
    ext_mem_75476.references = NULL;
    
    struct memblock_device mem_75473;
    
    mem_75473.references = NULL;
    
    struct memblock_device mem_75471;
    
    mem_75471.references = NULL;
    
    struct memblock_device ext_mem_75469;
    
    ext_mem_75469.references = NULL;
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76545;
    int64_t zm_lhs_64812 = add64(nR_37190, nS_37191);
    int64_t zs_lhs_64813 = sub64(zm_lhs_64812, (int64_t) 1);
    bool zzero_64814 = nR_37190 == (int64_t) 0;
    bool nonzzero_64815 = !zzero_64814;
    bool nonzzero_cert_64816;
    
    if (!nonzzero_64815) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:231:26-29\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_64817 = sdiv64(zs_lhs_64813, nR_37190);
    
    if (futrts_indicesWithIncrement_7443(ctx, &ext_mem_75469, tR_mem_75467, nR_37190, offset_R_37194) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_75470 = (int64_t) 8 * nR_37190;
    
    if (memblock_alloc_device(ctx, &mem_75471, bytes_75470, "mem_75471")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75471, nR_37190, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75473, bytes_75470, "mem_75473")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75473, nR_37190, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool loop_cond_64822 = slt64((int64_t) 0, numIter_64817);
    int64_t gt_rhs_64823 = sub64(nR_37190, (int64_t) 1);
    bool x_64824 = sle64((int64_t) 0, gt_rhs_64823);
    bool y_64825 = slt64(gt_rhs_64823, nR_37190);
    bool bounds_check_64826 = x_64824 && y_64825;
    bool loop_not_taken_64827 = !loop_cond_64822;
    bool protect_assert_disj_64828 = bounds_check_64826 || loop_not_taken_64827;
    bool index_certs_64829;
    
    if (!protect_assert_disj_64828) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftSMJ.fut:238:25-33\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (loop_cond_64822) {
        if (memblock_alloc_device(ctx, &mem_75475, (int64_t) 2, "mem_75475")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_76566(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, tR_mem_75467.mem, mem_75475.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75475, "mem_75475") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75474, (int64_t) 2, "mem_75474")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i16(ctx, mem_75474, (int64_t) 1, (int16_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75476, &mem_75474, "mem_75474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_75483, (int64_t) 2, "mem_75483")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75484, (int64_t) 1, "mem_75484")) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_mergeJoin_res_64832;
    int64_t defunc_0_mergeJoin_res_64833;
    bool loop_while_64836;
    int64_t p_64837;
    
    if (memblock_set_device(ctx, &mem_param_75479, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_75482, &mem_75471, "mem_75471") != 0)
        return 1;
    loop_while_64836 = loop_cond_64822;
    p_64837 = (int64_t) 0;
    while (loop_while_64836) {
        int64_t tS_start_64840 = mul64(nR_37190, p_64837);
        int64_t min_arg1_64841 = add64(nR_37190, tS_start_64840);
        int64_t min_res_64842 = smin64(nS_37191, min_arg1_64841);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 = sub64(min_res_64842, tS_start_64840);
        bool empty_slice_64844 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843 == (int64_t) 0;
        int64_t m_64845 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, (int64_t) 1);
        int64_t i_p_m_t_s_64846 = add64(tS_start_64840, m_64845);
        bool zzero_leq_i_p_m_t_s_64847 = sle64((int64_t) 0, i_p_m_t_s_64846);
        bool i_p_m_t_s_leq_w_64848 = slt64(i_p_m_t_s_64846, nS_37191);
        bool zzero_lte_i_64849 = sle64((int64_t) 0, tS_start_64840);
        bool i_lte_j_64850 = sle64(tS_start_64840, min_res_64842);
        bool y_64851 = i_p_m_t_s_leq_w_64848 && zzero_lte_i_64849;
        bool y_64852 = zzero_leq_i_p_m_t_s_64847 && y_64851;
        bool forwards_ok_64853 = i_lte_j_64850 && y_64852;
        bool ok_or_empty_64854 = empty_slice_64844 || forwards_ok_64853;
        bool index_certs_64855;
        
        if (!ok_or_empty_64854) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_64840, ":", (long long) min_res_64842, "] out of bounds for array of shape [", (long long) nS_37191, "].", "-> #0  ftSMJ.fut:237:16-35\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_64857 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
        bool index_certs_64858;
        
        if (!y_64857) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:238:12-19\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_76598(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tS_start_64840, tS_mem_75468.mem, ext_mem_75476.mem, mem_75483.mem, mem_75484.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        bool read_res_77449;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77449, mem_75484.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_gt_res_64860 = read_res_77449;
        int64_t loopres_64861;
        
        if (defunc_0_gt_res_64860) {
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_param_75479, "mem_param_75479") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_param_75482, "mem_param_75482") != 0)
                return 1;
            loopres_64861 = numIter_64817;
        } else {
            bool cond_64864 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, nR_37190);
            bool dim_match_64978 = nR_37190 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            bool protect_assert_disj_76147 = cond_64864 || dim_match_64978;
            bool empty_or_match_cert_64979;
            
            if (!protect_assert_disj_76147) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "] cannot match shape of type `[", (long long) nR_37190, "]i16`.", "-> #0  ftSMJ.fut:246:18-31\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_64985 = slt64((int64_t) 0, numberOfWindows_37197);
            bool y_64988 = slt64((int64_t) 0, nR_37190);
            bool loop_not_taken_64989 = !loop_cond_64985;
            bool protect_assert_disj_64990 = y_64988 || loop_not_taken_64989;
            bool protect_assert_disj_76149 = cond_64864 || protect_assert_disj_64990;
            bool index_certs_64991;
            
            if (!protect_assert_disj_76149) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftbasics.fut:150:20-25\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_66374 = add64(nR_37190, extParallelism_37198);
            int64_t zs_lhs_66375 = sub64(zm_lhs_66374, (int64_t) 1);
            bool zzero_66376 = extParallelism_37198 == (int64_t) 0;
            bool nonzzero_66377 = !zzero_66376;
            bool loop_not_taken_76090 = !cond_64864;
            bool protect_assert_disj_76091 = nonzzero_66377 || loop_not_taken_76090;
            bool nonzzero_cert_66378;
            
            if (!protect_assert_disj_76091) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_66379 = sdiv_safe64(zs_lhs_66375, extParallelism_37198);
            bool loop_cond_66380 = slt64((int64_t) 0, numIter_66379);
            bool loop_not_taken_66381 = !y_64857;
            bool loop_not_taken_66382 = !loop_cond_66380;
            bool x_66383 = sle64((int64_t) 0, m_64845);
            bool y_66384 = slt64(m_64845, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843);
            bool bounds_check_66386 = x_66383 && y_66384;
            bool protect_assert_disj_66387 = loop_not_taken_66381 || bounds_check_66386;
            bool protect_assert_disj_66388 = loop_not_taken_66382 || protect_assert_disj_66387;
            bool protect_assert_disj_76093 = protect_assert_disj_66388 || loop_not_taken_76090;
            bool index_certs_66389;
            
            if (!protect_assert_disj_76093) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65659;
            
            if (!bounds_check_66386) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_64845, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, "].", "-> #0  ftSMJ.fut:257:23-44\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_65661;
            
            if (!bounds_check_64826) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftSMJ.fut:257:51-59\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 = mul64(partitionsPerWindow_37196, numberOfWindows_37197);
            int64_t join_chunks_arg3_64981 = add64(offset_S_37195, tS_start_64840);
            int64_t bytes_75485 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
            bool empty_slice_64986 = partitionsPerWindow_37196 == (int64_t) 0;
            int64_t m_64987 = sub64(partitionsPerWindow_37196, (int64_t) 1);
            int64_t segmap_tblock_sizze_67720;
            
            segmap_tblock_sizze_67720 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67513;
            
            int64_t zeze_rhs_65256 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, (int64_t) 1);
            int64_t segmap_tblock_sizze_68094;
            
            segmap_tblock_sizze_68094 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67930;
            
            int64_t segmap_usable_groups_68095 = sdiv_up_safe64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_68094);
            bool loop_cond_65411 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
            bool protect_cond_conj_66385 = y_64857 && loop_cond_66380;
            int64_t bytes_75764 = (int64_t) 2 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843;
            int64_t ext_75918;
            int64_t ext_75917;
            int64_t ext_75915;
            int64_t ext_75914;
            
            if (cond_64864) {
                if (protect_cond_conj_66385) {
                    if (memblock_alloc_device(ctx, &mem_75750, (int64_t) 2, "mem_75750")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76604(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, i_p_m_t_s_64846, tS_mem_75468.mem, mem_75750.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75750, "mem_75750") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75749, (int64_t) 2, "mem_75749")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_75749, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75751, &mem_75749, "mem_75749") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75758, (int64_t) 2, "mem_75758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75759, (int64_t) 2, "mem_75759")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75762, (int64_t) 1, "mem_75762")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t ext_75911;
                int64_t ext_75910;
                int64_t ext_75909;
                int64_t ext_75908;
                bool defunc_0_find_joinTuples_res_66392;
                int64_t defunc_0_find_joinTuples_res_66393;
                bool loop_while_66396;
                int64_t p_66397;
                int64_t ctx_param_ext_75752;
                int64_t ctx_param_ext_75753;
                int64_t ctx_param_ext_75755;
                int64_t ctx_param_ext_75756;
                
                if (memblock_set_device(ctx, &mem_param_75754, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75757, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75752 = (int64_t) 0;
                ctx_param_ext_75753 = (int64_t) 1;
                ctx_param_ext_75755 = (int64_t) 0;
                ctx_param_ext_75756 = (int64_t) 1;
                loop_while_66396 = loop_cond_66380;
                p_66397 = (int64_t) 0;
                while (loop_while_66396) {
                    int64_t start_66400 = mul64(extParallelism_37198, p_66397);
                    int64_t min_arg1_66401 = sub64(nR_37190, start_66400);
                    int64_t min_res_66402 = smin64(extParallelism_37198, min_arg1_66401);
                    int64_t iter_R_66403 = add64(start_66400, min_res_66402);
                    bool empty_slice_66404 = min_res_66402 == (int64_t) 0;
                    int64_t m_66405 = sub64(min_res_66402, (int64_t) 1);
                    int64_t i_p_m_t_s_66406 = add64(start_66400, m_66405);
                    bool zzero_leq_i_p_m_t_s_66407 = sle64((int64_t) 0, i_p_m_t_s_66406);
                    bool i_p_m_t_s_leq_w_66408 = slt64(i_p_m_t_s_66406, nR_37190);
                    bool zzero_lte_i_66409 = sle64((int64_t) 0, start_66400);
                    bool i_lte_j_66410 = sle64(start_66400, iter_R_66403);
                    bool y_66411 = i_p_m_t_s_leq_w_66408 && zzero_lte_i_66409;
                    bool y_66412 = zzero_leq_i_p_m_t_s_66407 && y_66411;
                    bool forwards_ok_66413 = i_lte_j_66410 && y_66412;
                    bool ok_or_empty_66414 = empty_slice_66404 || forwards_ok_66413;
                    bool index_certs_66415;
                    
                    if (!ok_or_empty_66414) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_66400, ":", (long long) iter_R_66403, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66416 = slt64(m_66405, min_res_66402);
                    bool x_66417 = sle64((int64_t) 0, m_66405);
                    bool bounds_check_66418 = y_66416 && x_66417;
                    bool index_certs_66419;
                    
                    if (!bounds_check_66418) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_66405, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_66422 = slt64((int64_t) 0, min_res_66402);
                    bool index_certs_66423;
                    
                    if (!y_66422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_66402, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76620(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, start_66400, i_p_m_t_s_66406, tR_mem_75467.mem, mem_75758.mem, mem_75759.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75760, &ext_mem_75751, "ext_mem_75751") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75760, &mem_75758, "mem_75758") != 0)
                        return 1;
                    if (y_64857) {
                        if (memblock_set_device(ctx, &ext_mem_75761, &mem_75483, "mem_75483") != 0)
                            return 1;
                    } else if (memblock_set_device(ctx, &ext_mem_75761, &mem_75759, "mem_75759") != 0)
                        return 1;
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76626(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75759.mem, ext_mem_75760.mem, mem_75762.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
                        return 1;
                    
                    bool read_res_77450;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77450, mem_75762.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    bool defunc_0_gt_res_66425 = read_res_77450;
                    int64_t ext_75906;
                    int64_t ext_75905;
                    int64_t ext_75903;
                    int64_t ext_75902;
                    int64_t loopres_66427;
                    
                    if (defunc_0_gt_res_66425) {
                        if (memblock_set_device(ctx, &ext_mem_75907, &mem_param_75754, "mem_param_75754") != 0)
                            return 1;
                        ext_75906 = ctx_param_ext_75752;
                        ext_75905 = ctx_param_ext_75753;
                        if (memblock_set_device(ctx, &ext_mem_75904, &mem_param_75757, "mem_param_75757") != 0)
                            return 1;
                        ext_75903 = ctx_param_ext_75755;
                        ext_75902 = ctx_param_ext_75756;
                        loopres_66427 = numIter_66379;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75763, (int64_t) 1, "mem_75763")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_inner_SMJ_shortzigpuseq_76632(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75758.mem, ext_mem_75761.mem, mem_75763.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool read_res_77451;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77451, mem_75763.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool defunc_0_gt_res_66431 = read_res_77451;
                        
                        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
                            return 1;
                        
                        int64_t ext_75900;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75900 = ctx_param_ext_75752;
                        } else {
                            ext_75900 = (int64_t) 0;
                        }
                        
                        int64_t ext_75899;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75899 = ctx_param_ext_75753;
                        } else {
                            ext_75899 = (int64_t) 1;
                        }
                        
                        int64_t ext_75897;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75897 = ctx_param_ext_75755;
                        } else {
                            ext_75897 = (int64_t) 0;
                        }
                        
                        int64_t ext_75896;
                        
                        if (defunc_0_gt_res_66431) {
                            ext_75896 = ctx_param_ext_75756;
                        } else {
                            ext_75896 = (int64_t) 1;
                        }
                        
                        int64_t loopres_f_res_66432;
                        
                        if (defunc_0_gt_res_66431) {
                            int64_t tmp_66436 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_param_75754, "mem_param_75754") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_param_75757, "mem_param_75757") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66436;
                        } else {
                            if (memblock_alloc_device(ctx, &mem_75765, bytes_75764, "mem_75765")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75765.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, tS_start_64840, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843})) != 0)
                                goto cleanup;
                            if (futrts_indicesWithIncrement_7443(ctx, &ext_mem_75767, mem_75765, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, join_chunks_arg3_64981) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
                                return 1;
                            
                            bool suff_outer_par_67335;
                            
                            suff_outer_par_67335 = *ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_0 <= min_res_66402;
                            if (ctx->logging)
                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_short.suff_outer_par_0", (long) min_res_66402, suff_outer_par_67335 ? "true" : "false");
                            
                            int64_t tile_sizze_74256;
                            
                            tile_sizze_74256 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255;
                            
                            int64_t tile_sizze_73901;
                            
                            tile_sizze_73901 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900;
                            
                            int64_t num_whole_tiles_74272 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            int64_t residual_input_74496 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_74256);
                            bool cond_74497 = residual_input_74496 == (int64_t) 0;
                            int64_t binop_x_74513 = tile_sizze_74256 * num_whole_tiles_74272;
                            int64_t bytes_75825 = (int64_t) 8 * min_res_66402;
                            int64_t bytes_75788 = (int64_t) 8 * tile_sizze_74256;
                            int64_t bytes_75790 = (int64_t) 2 * tile_sizze_74256;
                            int64_t num_whole_tiles_73917 = squot_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            int64_t residual_input_74141 = srem_safe64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, tile_sizze_73901);
                            bool cond_74142 = residual_input_74141 == (int64_t) 0;
                            int64_t binop_x_74158 = tile_sizze_73901 * num_whole_tiles_73917;
                            int64_t bytes_75849 = (int64_t) 8 * tile_sizze_73901;
                            int64_t bytes_75851 = (int64_t) 2 * tile_sizze_73901;
                            int64_t shared_memory_capacity_76690;
                            
                            shared_memory_capacity_76690 = ctx->max_shared_memory;
                            if (suff_outer_par_67335 && sle64(sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75851, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75849, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76690)) {
                                int64_t ldim_73902 = sdiv_up64(min_res_66402, tile_sizze_73901);
                                
                                if (memblock_alloc_device(ctx, &mem_75887, bytes_75825, "mem_75887")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75889, bytes_75825, "mem_75889")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76638 = sext_i64_i32(sdiv_up64(tile_sizze_73901, tile_sizze_73901));
                                int32_t virt_num_tblocks_76639 = sext_i64_i32(ldim_73902);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_73899(ctx, ldim_73902, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_73900, 1, 1, bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8) + (bytes_75851 + srem64((int64_t) 8 - srem64(bytes_75851, (int64_t) 8), (int64_t) 8)) + (bytes_75849 + srem64((int64_t) 8 - srem64(bytes_75849, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_73902, num_whole_tiles_73917, residual_input_74141, cond_74142, binop_x_74158, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75887.mem, mem_75889.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75887, "mem_75887") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75889, "mem_75889") != 0)
                                    return 1;
                            } else {
                                int64_t ldim_74257 = sdiv_up64(min_res_66402, tile_sizze_74256);
                                
                                if (memblock_alloc_device(ctx, &mem_75826, bytes_75825, "mem_75826")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (memblock_alloc_device(ctx, &mem_75828, bytes_75825, "mem_75828")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t num_chunks_76664 = sext_i64_i32(sdiv_up64(tile_sizze_74256, tile_sizze_74256));
                                int32_t virt_num_tblocks_76665 = sext_i64_i32(ldim_74257);
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74254(ctx, ldim_74257, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74255, 1, 1, bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8) + (bytes_75790 + srem64((int64_t) 8 - srem64(bytes_75790, (int64_t) 8), (int64_t) 8)) + (bytes_75788 + srem64((int64_t) 8 - srem64(bytes_75788, (int64_t) 8), (int64_t) 8)), tS_start_64840, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_64843, start_66400, min_res_66402, ldim_74257, num_whole_tiles_74272, residual_input_74496, cond_74497, binop_x_74513, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75767.mem, mem_75826.mem, mem_75828.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_set_device(ctx, &ext_mem_75891, &mem_75826, "mem_75826") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75890, &mem_75828, "mem_75828") != 0)
                                    return 1;
                            }
                            if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75893, bytes_75470, "mem_75893")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75757.mem, ctx_param_ext_75755, (int64_t []) {ctx_param_ext_75756}, (int64_t []) {nR_37190})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75893.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75891.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75895, bytes_75470, "mem_75895")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75754.mem, ctx_param_ext_75752, (int64_t []) {ctx_param_ext_75753}, (int64_t []) {nR_37190})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75895.mem, start_66400, (int64_t []) {(int64_t) 1}, ext_mem_75890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_66402})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
                                return 1;
                            
                            int64_t tmp_66488 = add64((int64_t) 1, p_66397);
                            
                            if (memblock_set_device(ctx, &ext_mem_75901, &mem_75895, "mem_75895") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75898, &mem_75893, "mem_75893") != 0)
                                return 1;
                            loopres_f_res_66432 = tmp_66488;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75907, &ext_mem_75901, "ext_mem_75901") != 0)
                            return 1;
                        ext_75906 = ext_75900;
                        ext_75905 = ext_75899;
                        if (memblock_set_device(ctx, &ext_mem_75904, &ext_mem_75898, "ext_mem_75898") != 0)
                            return 1;
                        ext_75903 = ext_75897;
                        ext_75902 = ext_75896;
                        loopres_66427 = loopres_f_res_66432;
                    }
                    if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
                        return 1;
                    
                    bool loop_cond_66489 = slt64(loopres_66427, numIter_66379);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76610, &ext_mem_75907, "ext_mem_75907") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76611, &ext_mem_75904, "ext_mem_75904") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76612 = ext_75906;
                    int64_t ctx_param_ext_tmp_76613 = ext_75905;
                    int64_t ctx_param_ext_tmp_76614 = ext_75903;
                    int64_t ctx_param_ext_tmp_76615 = ext_75902;
                    bool loop_while_tmp_76616 = loop_cond_66489;
                    int64_t p_tmp_76617 = loopres_66427;
                    
                    if (memblock_set_device(ctx, &mem_param_75754, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75757, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
                        return 1;
                    ctx_param_ext_75752 = ctx_param_ext_tmp_76612;
                    ctx_param_ext_75753 = ctx_param_ext_tmp_76613;
                    ctx_param_ext_75755 = ctx_param_ext_tmp_76614;
                    ctx_param_ext_75756 = ctx_param_ext_tmp_76615;
                    loop_while_66396 = loop_while_tmp_76616;
                    p_66397 = p_tmp_76617;
                }
                if (memblock_set_device(ctx, &ext_mem_75913, &mem_param_75754, "mem_param_75754") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75912, &mem_param_75757, "mem_param_75757") != 0)
                    return 1;
                ext_75911 = ctx_param_ext_75752;
                ext_75910 = ctx_param_ext_75753;
                ext_75909 = ctx_param_ext_75755;
                ext_75908 = ctx_param_ext_75756;
                defunc_0_find_joinTuples_res_66392 = loop_while_66396;
                defunc_0_find_joinTuples_res_66393 = p_66397;
                if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75913, "ext_mem_75913") != 0)
                    return 1;
                ext_75918 = ext_75911;
                ext_75917 = ext_75910;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75912, "ext_mem_75912") != 0)
                    return 1;
                ext_75915 = ext_75909;
                ext_75914 = ext_75908;
            } else {
                if (memblock_alloc_device(ctx, &mem_75486, bytes_75485, "mem_75486")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75486, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_37190) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75488, bytes_75485, "mem_75488")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_75488, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, nR_37190) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75490, (int64_t) 2, "mem_75490")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76691(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, tR_mem_75467.mem, mem_75490.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75490, "mem_75490") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75489, (int64_t) 2, "mem_75489")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_75489, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75491, &mem_75489, "mem_75489") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_75492, (int64_t) 1, "mem_75492")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_inner_SMJ_shortzigpuseq_76697(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75483.mem, ext_mem_75491.mem, mem_75492.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
                    return 1;
                if (loop_cond_64985) {
                    if (memblock_alloc_device(ctx, &mem_75494, (int64_t) 2, "mem_75494")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76703(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, nR_37190, y_64988, tR_mem_75467.mem, mem_75483.mem, mem_75492.mem, mem_75494.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75494, "mem_75494") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &mem_75493, (int64_t) 2, "mem_75493")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i16(ctx, mem_75493, (int64_t) 1, (int16_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_set_device(ctx, &ext_mem_75495, &mem_75493, "mem_75493") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
                    return 1;
                
                bool defunc_0_windowed_partitionFunc_res_65003;
                int64_t defunc_0_windowed_partitionFunc_res_65004;
                bool loop_while_65007;
                int64_t p_65008;
                
                loop_while_65007 = loop_cond_64985;
                p_65008 = (int64_t) 0;
                while (loop_while_65007) {
                    int64_t start_65011 = mul64(partitionsPerWindow_37196, p_65008);
                    int64_t end_65012 = add64(partitionsPerWindow_37196, start_65011);
                    int64_t max_res_65013 = smax64((int64_t) 1, start_65011);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014 = sub64(end_65012, max_res_65013);
                    bool bounds_invalid_upwards_65015 = slt64(end_65012, max_res_65013);
                    bool valid_65016 = !bounds_invalid_upwards_65015;
                    bool range_valid_c_65017;
                    
                    if (!valid_65016) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_65013, "..<", (long long) end_65012, " is invalid.", "-> #0  ftbasics.fut:153:43-68\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_65020 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982 == (int64_t) 0;
                    bool nonzzero_65021 = !zzero_65020;
                    bool nonzzero_cert_65022;
                    
                    if (!nonzzero_65021) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:156:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:155:8-215:8\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_75503 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool cond_65223 = slt64((int64_t) 0, start_65011);
                    int64_t conc_tmp_65224 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    int64_t ret_65225;
                    
                    if (cond_65223) {
                        ret_65225 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    } else {
                        ret_65225 = conc_tmp_65224;
                    }
                    
                    bool eq_x_y_65233 = partitionsPerWindow_37196 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                    bool eq_x_zz_65234 = partitionsPerWindow_37196 == conc_tmp_65224;
                    bool p_and_eq_x_y_65235 = cond_65223 && eq_x_y_65233;
                    bool not_p_65236 = !cond_65223;
                    bool p_and_eq_x_y_65237 = eq_x_zz_65234 && not_p_65236;
                    bool dim_match_65238 = p_and_eq_x_y_65235 || p_and_eq_x_y_65237;
                    bool empty_or_match_cert_65239;
                    
                    if (!dim_match_65238) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_65225, "] cannot match shape of type `[", (long long) partitionsPerWindow_37196, "](i64, i64)`.", "-> #0  ftbasics.fut:217:5-222:49\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_65241 = add64(m_64987, start_65011);
                    bool zzero_leq_i_p_m_t_s_65242 = sle64((int64_t) 0, i_p_m_t_s_65241);
                    bool i_p_m_t_s_leq_w_65243 = slt64(i_p_m_t_s_65241, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool zzero_lte_i_65244 = sle64((int64_t) 0, start_65011);
                    bool i_lte_j_65245 = sle64(start_65011, end_65012);
                    bool y_65246 = i_p_m_t_s_leq_w_65243 && zzero_lte_i_65244;
                    bool y_65247 = zzero_leq_i_p_m_t_s_65242 && y_65246;
                    bool forwards_ok_65248 = i_lte_j_65245 && y_65247;
                    bool ok_or_empty_65249 = empty_slice_64986 || forwards_ok_65248;
                    bool index_certs_65250;
                    
                    if (!ok_or_empty_65249) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65011, ":", (long long) end_65012, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:108:37-74\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_65019 = add64(nR_37190, nR_37190);
                    int64_t segmap_usable_groups_67721 = sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_67720);
                    
                    if (memblock_alloc_device(ctx, &mem_75504, bytes_75503, "mem_75504")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_75506, bytes_75503, "mem_75506")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_76713 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, segmap_tblock_sizze_67720));
                    
                    {
                        err = gpu_kernel_inner_SMJ_shortzisegmap_67725(ctx, segmap_usable_groups_67721, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67513, 1, 1, (int64_t) 0, nR_37190, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, max_res_65013, dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014, zt_rhs_65019, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75495.mem, mem_75504.mem, mem_75506.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    
                    int64_t bytes_75508 = (int64_t) 8 * ret_65225;
                    
                    if (cond_65223) {
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75504, "mem_75504") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75506, "mem_75506") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &mem_75511, bytes_75508, "mem_75511")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, mem_75511, (int64_t) 1, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_75509, bytes_75508, "mem_75509")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_76734 = (int64_t) 0;
                        
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75509.mem, tmp_offs_76734, (int64_t []) {(int64_t) 1}, mem_75504.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76734 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        
                        int64_t tmp_offs_76735 = (int64_t) 0;
                        
                        if (!(tmp_offs_76735 == (int64_t) 0)) {
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75511.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
                                goto cleanup;
                        }
                        tmp_offs_76735 += (int64_t) 1;
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75511.mem, tmp_offs_76735, (int64_t []) {(int64_t) 1}, mem_75506.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014})) != 0)
                            goto cleanup;
                        tmp_offs_76735 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_65014;
                        if (memblock_set_device(ctx, &ext_mem_75513, &mem_75509, "mem_75509") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75512, &mem_75511, "mem_75511") != 0)
                            return 1;
                    }
                    if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
                        return 1;
                    
                    int64_t tmp_65240 = add64((int64_t) 1, p_65008);
                    
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75486.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
                        return 1;
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75488.mem, start_65011, (int64_t []) {(int64_t) 1}, ext_mem_75512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_65225})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
                        return 1;
                    
                    bool loop_cond_65253 = slt64(tmp_65240, numberOfWindows_37197);
                    bool loop_while_tmp_76709 = loop_cond_65253;
                    int64_t p_tmp_76710 = tmp_65240;
                    
                    loop_while_65007 = loop_while_tmp_76709;
                    p_65008 = p_tmp_76710;
                }
                defunc_0_windowed_partitionFunc_res_65003 = loop_while_65007;
                defunc_0_windowed_partitionFunc_res_65004 = p_65008;
                if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_75522, bytes_75485, "mem_75522")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_75524, bytes_75485, "mem_75524")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_76736 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, segmap_tblock_sizze_68094));
                
                {
                    err = gpu_kernel_inner_SMJ_shortzisegmap_68099(ctx, segmap_usable_groups_68095, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_67930, 1, 1, (int64_t) 0, nR_37190, gt_rhs_64823, tS_start_64840, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, zeze_rhs_65256, tR_mem_75467.mem, tS_mem_75468.mem, mem_75486.mem, mem_75488.mem, mem_75522.mem, mem_75524.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t ext_75746;
                int64_t ext_75745;
                int64_t ext_75744;
                int64_t ext_75743;
                bool defunc_0_join_chunks_res_65412;
                int64_t defunc_0_join_chunks_res_65413;
                bool loop_while_65416;
                int64_t p_65417;
                int64_t ctx_param_ext_75525;
                int64_t ctx_param_ext_75526;
                int64_t ctx_param_ext_75528;
                int64_t ctx_param_ext_75529;
                
                if (memblock_set_device(ctx, &mem_param_75527, &mem_75473, "mem_75473") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_75530, &mem_75471, "mem_75471") != 0)
                    return 1;
                ctx_param_ext_75525 = (int64_t) 0;
                ctx_param_ext_75526 = (int64_t) 1;
                ctx_param_ext_75528 = (int64_t) 0;
                ctx_param_ext_75529 = (int64_t) 1;
                loop_while_65416 = loop_cond_65411;
                p_65417 = (int64_t) 0;
                while (loop_while_65416) {
                    bool x_65420 = sle64((int64_t) 0, p_65417);
                    bool y_65421 = slt64(p_65417, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65422 = x_65420 && y_65421;
                    bool index_certs_65423;
                    
                    if (!bounds_check_65422) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:186:22-34\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t read_res_77452;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77452, mem_75522.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65424 = read_res_77452;
                    int64_t read_res_77453;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_77453, mem_75524.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t loopres_65425 = read_res_77453;
                    int64_t min_res_65426 = smin64(zeze_rhs_65256, loopres_65425);
                    bool cond_65427 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, loopres_65424);
                    bool cond_65431 = slt64(min_res_65426, (int64_t) 0);
                    bool protect_assert_disj_65433 = bounds_check_65422 || cond_65431;
                    bool protect_assert_disj_76139 = cond_65427 || protect_assert_disj_65433;
                    bool index_certs_65434;
                    
                    if (!protect_assert_disj_76139) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65417, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:190:19-32\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_65437 = add64((int64_t) 1, p_65417);
                    bool cond_65438 = zeze_lhs_65437 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    bool x_65440 = sle64((int64_t) 0, zeze_lhs_65437);
                    bool y_65441 = slt64(zeze_lhs_65437, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    bool bounds_check_65442 = x_65440 && y_65441;
                    bool protect_assert_disj_65443 = cond_65438 || bounds_check_65442;
                    bool protect_assert_disj_65444 = cond_65431 || protect_assert_disj_65443;
                    bool protect_assert_disj_76142 = cond_65427 || protect_assert_disj_65444;
                    bool index_certs_65445;
                    
                    if (!protect_assert_disj_76142) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65437, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:191:49-64\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_76136 = !cond_65427;
                    bool x_65432 = !cond_65431;
                    bool protect_cond_conj_76140 = x_65432 && x_76136;
                    int64_t loopres_f_res_f_res_65435;
                    
                    if (protect_cond_conj_76140) {
                        int64_t read_res_77454;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77454, mem_75486.mem, p_65417 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66705 = read_res_77454;
                        
                        loopres_f_res_f_res_65435 = x_66705;
                    } else {
                        loopres_f_res_f_res_65435 = (int64_t) 0;
                    }
                    
                    bool x_65439 = !cond_65438;
                    bool protect_cond_conj_65446 = x_65432 && x_65439;
                    bool protect_cond_conj_76143 = protect_cond_conj_65446 && x_76136;
                    int64_t r_end_f_res_65447;
                    
                    if (protect_cond_conj_76143) {
                        int64_t read_res_77455;
                        
                        if ((err = gpu_scalar_from_device(ctx, &read_res_77455, mem_75486.mem, zeze_lhs_65437 * sizeof(int64_t), sizeof(int64_t))) != 0)
                            goto cleanup;
                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t x_66706 = read_res_77455;
                        
                        r_end_f_res_65447 = x_66706;
                    } else {
                        r_end_f_res_65447 = (int64_t) 0;
                    }
                    
                    int64_t r_end_65449;
                    
                    if (cond_65438) {
                        r_end_65449 = nR_37190;
                    } else {
                        r_end_65449 = r_end_f_res_65447;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 = sub64(r_end_65449, loopres_f_res_f_res_65435);
                    int64_t ext_75735;
                    
                    if (cond_65431) {
                        ext_75735 = ctx_param_ext_75525;
                    } else {
                        ext_75735 = (int64_t) 0;
                    }
                    
                    int64_t ext_75734;
                    
                    if (cond_65431) {
                        ext_75734 = ctx_param_ext_75526;
                    } else {
                        ext_75734 = (int64_t) 1;
                    }
                    
                    int64_t ext_75732;
                    
                    if (cond_65431) {
                        ext_75732 = ctx_param_ext_75528;
                    } else {
                        ext_75732 = (int64_t) 0;
                    }
                    
                    int64_t ext_75731;
                    
                    if (cond_65431) {
                        ext_75731 = ctx_param_ext_75529;
                    } else {
                        ext_75731 = (int64_t) 1;
                    }
                    
                    int64_t bytes_75531 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450;
                    int64_t ext_75741;
                    
                    if (cond_65427) {
                        ext_75741 = ctx_param_ext_75525;
                    } else {
                        ext_75741 = ext_75735;
                    }
                    
                    int64_t ext_75740;
                    
                    if (cond_65427) {
                        ext_75740 = ctx_param_ext_75526;
                    } else {
                        ext_75740 = ext_75734;
                    }
                    
                    int64_t ext_75738;
                    
                    if (cond_65427) {
                        ext_75738 = ctx_param_ext_75528;
                    } else {
                        ext_75738 = ext_75732;
                    }
                    
                    int64_t ext_75737;
                    
                    if (cond_65427) {
                        ext_75737 = ctx_param_ext_75529;
                    } else {
                        ext_75737 = ext_75731;
                    }
                    
                    int64_t loopres_65428;
                    
                    if (cond_65427) {
                        loopres_65428 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                    } else {
                        loopres_65428 = zeze_lhs_65437;
                    }
                    if (cond_65427) {
                        if (memblock_set_device(ctx, &ext_mem_75742, &mem_param_75527, "mem_param_75527") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &mem_param_75530, "mem_param_75530") != 0)
                            return 1;
                    } else {
                        if (cond_65431) {
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_param_75527, "mem_param_75527") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_param_75530, "mem_param_75530") != 0)
                                return 1;
                        } else {
                            bool empty_slice_65453 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450 == (int64_t) 0;
                            int64_t m_65454 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 1);
                            int64_t i_p_m_t_s_65455 = add64(loopres_f_res_f_res_65435, m_65454);
                            bool zzero_leq_i_p_m_t_s_65456 = sle64((int64_t) 0, i_p_m_t_s_65455);
                            bool i_p_m_t_s_leq_w_65457 = slt64(i_p_m_t_s_65455, nR_37190);
                            bool zzero_lte_i_65458 = sle64((int64_t) 0, loopres_f_res_f_res_65435);
                            bool i_lte_j_65459 = sle64(loopres_f_res_f_res_65435, r_end_65449);
                            bool y_65460 = i_p_m_t_s_leq_w_65457 && zzero_lte_i_65458;
                            bool y_65461 = zzero_leq_i_p_m_t_s_65456 && y_65460;
                            bool forwards_ok_65462 = i_lte_j_65459 && y_65461;
                            bool ok_or_empty_65463 = empty_slice_65453 || forwards_ok_65462;
                            bool index_certs_65464;
                            
                            if (!ok_or_empty_65463) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_65435, ":", (long long) r_end_65449, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftSMJ.fut:192:16-33\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_65467 = sle64(loopres_65424, min_res_65426);
                            bool loop_not_taken_65472 = !loop_cond_65467;
                            bool protect_assert_disj_65473 = loop_not_taken_65472 || nonzzero_66377;
                            bool nonzzero_cert_65474;
                            
                            if (!protect_assert_disj_65473) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:47:39-55\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75532, bytes_75531, "mem_75532")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75532, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) -1) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75534, bytes_75531, "mem_75534")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (futrts_builtinzhreplicate_i64(ctx, mem_75534, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, (int64_t) 0) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            int64_t zm_lhs_65468 = add64(extParallelism_37198, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                            int64_t zs_lhs_65469 = sub64(zm_lhs_65468, (int64_t) 1);
                            int64_t numIter_65475 = sdiv_safe64(zs_lhs_65469, extParallelism_37198);
                            bool loop_cond_65476 = slt64((int64_t) 0, numIter_65475);
                            bool loop_not_taken_65477 = !loop_cond_65476;
                            int64_t segmap_tblock_sizze_68447;
                            
                            segmap_tblock_sizze_68447 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68437;
                            
                            int64_t segmap_usable_groups_68448 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68447);
                            int64_t segmap_tblock_sizze_68468;
                            
                            segmap_tblock_sizze_68468 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68459;
                            
                            int64_t segmap_usable_groups_68469 = sdiv_up_safe64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68468);
                            
                            if (memblock_alloc_device(ctx, &mem_75553, (int64_t) 2, "mem_75553")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75554, (int64_t) 2, "mem_75554")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_alloc_device(ctx, &mem_75557, (int64_t) 1, "mem_75557")) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loopres_f_res_f_res_65478;
                            int64_t loopres_f_res_f_res_65479;
                            bool loop_while_65482;
                            int64_t dp_65483;
                            
                            if (memblock_set_device(ctx, &mem_param_75537, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &mem_param_75540, &mem_75532, "mem_75532") != 0)
                                return 1;
                            loop_while_65482 = loop_cond_65467;
                            dp_65483 = loopres_65424;
                            while (loop_while_65482) {
                                bool x_65486 = sle64((int64_t) 0, dp_65483);
                                bool y_65487 = slt64(dp_65483, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65488 = x_65486 && y_65487;
                                bool index_certs_65489;
                                
                                if (!bounds_check_65488) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_65483, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:196:21-38\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t read_res_77456;
                                
                                if ((err = gpu_scalar_from_device(ctx, &read_res_77456, mem_75488.mem, dp_65483 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                    goto cleanup;
                                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_65490 = read_res_77456;
                                int64_t zeze_lhs_65491 = add64((int64_t) 1, dp_65483);
                                bool cond_65492 = zeze_lhs_65491 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982;
                                bool x_65493 = !cond_65492;
                                bool x_65494 = sle64((int64_t) 0, zeze_lhs_65491);
                                bool y_65495 = slt64(zeze_lhs_65491, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                                bool bounds_check_65496 = x_65494 && y_65495;
                                bool protect_assert_disj_65497 = cond_65492 || bounds_check_65496;
                                bool index_certs_65498;
                                
                                if (!protect_assert_disj_65497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_65491, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982, "].", "-> #0  ftSMJ.fut:197:55-74\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_65499;
                                
                                if (x_65493) {
                                    int64_t read_res_77457;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77457, mem_75488.mem, zeze_lhs_65491 * sizeof(int64_t), sizeof(int64_t))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    int64_t x_66707 = read_res_77457;
                                    
                                    s_end_f_res_65499 = x_66707;
                                } else {
                                    s_end_f_res_65499 = (int64_t) 0;
                                }
                                
                                int64_t s_end_65501;
                                
                                if (cond_65492) {
                                    s_end_65501 = nR_37190;
                                } else {
                                    s_end_65501 = s_end_f_res_65499;
                                }
                                
                                int64_t j_m_i_65502 = sub64(s_end_65501, loopres_65490);
                                bool empty_slice_65503 = j_m_i_65502 == (int64_t) 0;
                                int64_t m_65504 = sub64(j_m_i_65502, (int64_t) 1);
                                int64_t i_p_m_t_s_65505 = add64(loopres_65490, m_65504);
                                bool zzero_leq_i_p_m_t_s_65506 = sle64((int64_t) 0, i_p_m_t_s_65505);
                                bool i_p_m_t_s_leq_w_65507 = slt64(i_p_m_t_s_65505, nR_37190);
                                bool zzero_lte_i_65508 = sle64((int64_t) 0, loopres_65490);
                                bool i_lte_j_65509 = sle64(loopres_65490, s_end_65501);
                                bool y_65510 = i_p_m_t_s_leq_w_65507 && zzero_lte_i_65508;
                                bool y_65511 = zzero_leq_i_p_m_t_s_65506 && y_65510;
                                bool forwards_ok_65512 = i_lte_j_65509 && y_65511;
                                bool ok_or_empty_65513 = empty_slice_65503 || forwards_ok_65512;
                                bool index_certs_65514;
                                
                                if (!ok_or_empty_65513) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65490, ":", (long long) s_end_65501, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  ftSMJ.fut:198:18-35\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_65517 = slt64((int64_t) 0, j_m_i_65502);
                                bool loop_not_taken_65518 = !cond_65517;
                                bool x_65519 = sle64((int64_t) 0, m_65504);
                                bool y_65520 = slt64(m_65504, j_m_i_65502);
                                bool bounds_check_65524 = x_65519 && y_65520;
                                bool protect_assert_disj_65525 = loop_not_taken_65518 || bounds_check_65524;
                                bool protect_assert_disj_65526 = loop_not_taken_65477 || protect_assert_disj_65525;
                                bool index_certs_65527;
                                
                                if (!protect_assert_disj_65526) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65504, "] out of bounds for array of shape [", (long long) j_m_i_65502, "].", "-> #0  ftSMJ.fut:59:34-42\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_65911 = tS_start_64840 + loopres_65490;
                                int64_t find_joinTuples_arg3_65516 = add64(join_chunks_arg3_64981, loopres_65490);
                                bool protect_cond_conj_65521 = loop_cond_65476 && cond_65517;
                                
                                if (protect_cond_conj_65521) {
                                    if (memblock_alloc_device(ctx, &mem_75542, (int64_t) 2, "mem_75542")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76765(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65911, tS_mem_75468.mem, mem_75542.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75542, "mem_75542") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75541, (int64_t) 2, "mem_75541")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i16(ctx, mem_75541, (int64_t) 1, (int16_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75543, &mem_75541, "mem_75541") != 0)
                                        return 1;
                                }
                                if (protect_cond_conj_65521) {
                                    int64_t slice_66709 = tS_start_64840 + i_p_m_t_s_65505;
                                    
                                    if (memblock_alloc_device(ctx, &mem_75545, (int64_t) 2, "mem_75545")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76771(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_66709, tS_mem_75468.mem, mem_75545.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75545, "mem_75545") != 0)
                                        return 1;
                                } else {
                                    if (memblock_alloc_device(ctx, &mem_75544, (int64_t) 2, "mem_75544")) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (futrts_builtinzhreplicate_i16(ctx, mem_75544, (int64_t) 1, (int16_t) 0) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    if (memblock_set_device(ctx, &ext_mem_75546, &mem_75544, "mem_75544") != 0)
                                        return 1;
                                }
                                
                                int64_t bytes_75559 = (int64_t) 2 * j_m_i_65502;
                                int64_t ext_75706;
                                int64_t ext_75705;
                                int64_t ext_75704;
                                int64_t ext_75703;
                                bool defunc_0_find_joinTuples_res_65530;
                                int64_t defunc_0_find_joinTuples_res_65531;
                                bool loop_while_65534;
                                int64_t p_65535;
                                int64_t ctx_param_ext_75547;
                                int64_t ctx_param_ext_75548;
                                int64_t ctx_param_ext_75550;
                                int64_t ctx_param_ext_75551;
                                
                                if (memblock_set_device(ctx, &mem_param_75549, &mem_75534, "mem_75534") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75552, &mem_75532, "mem_75532") != 0)
                                    return 1;
                                ctx_param_ext_75547 = (int64_t) 0;
                                ctx_param_ext_75548 = (int64_t) 1;
                                ctx_param_ext_75550 = (int64_t) 0;
                                ctx_param_ext_75551 = (int64_t) 1;
                                loop_while_65534 = loop_cond_65476;
                                p_65535 = (int64_t) 0;
                                while (loop_while_65534) {
                                    int64_t start_65538 = mul64(extParallelism_37198, p_65535);
                                    int64_t min_arg1_65539 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, start_65538);
                                    int64_t min_res_65540 = smin64(extParallelism_37198, min_arg1_65539);
                                    int64_t iter_R_65541 = add64(start_65538, min_res_65540);
                                    bool empty_slice_65542 = min_res_65540 == (int64_t) 0;
                                    int64_t m_65543 = sub64(min_res_65540, (int64_t) 1);
                                    int64_t i_p_m_t_s_65544 = add64(start_65538, m_65543);
                                    bool zzero_leq_i_p_m_t_s_65545 = sle64((int64_t) 0, i_p_m_t_s_65544);
                                    bool i_p_m_t_s_leq_w_65546 = slt64(i_p_m_t_s_65544, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450);
                                    bool zzero_lte_i_65547 = sle64((int64_t) 0, start_65538);
                                    bool i_lte_j_65548 = sle64(start_65538, iter_R_65541);
                                    bool y_65549 = i_p_m_t_s_leq_w_65546 && zzero_lte_i_65547;
                                    bool y_65550 = zzero_leq_i_p_m_t_s_65545 && y_65549;
                                    bool forwards_ok_65551 = i_lte_j_65548 && y_65550;
                                    bool ok_or_empty_65552 = empty_slice_65542 || forwards_ok_65551;
                                    bool index_certs_65553;
                                    
                                    if (!ok_or_empty_65552) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_65538, ":", (long long) iter_R_65541, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, "].", "-> #0  ftSMJ.fut:54:20-49\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65560 = slt64(m_65543, min_res_65540);
                                    bool x_65559 = sle64((int64_t) 0, m_65543);
                                    bool bounds_check_65561 = x_65559 && y_65560;
                                    bool index_certs_65562;
                                    
                                    if (!bounds_check_65561) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65543, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:57:21-40\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_65556 = slt64((int64_t) 0, min_res_65540);
                                    bool index_certs_65557;
                                    
                                    if (!y_65556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_65540, "].", "-> #0  ftSMJ.fut:56:21-30\n   #1  ftSMJ.fut:350:133-136\n   #2  ftSMJ.fut:339:1-350:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_65554 = loopres_f_res_f_res_65435 + start_65538;
                                    int64_t slice_65563 = loopres_f_res_f_res_65435 + i_p_m_t_s_65544;
                                    
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76787(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, slice_65554, slice_65563, tR_mem_75467.mem, mem_75553.mem, mem_75554.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75555, &ext_mem_75546, "ext_mem_75546") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75555, &mem_75553, "mem_75553") != 0)
                                        return 1;
                                    if (cond_65517) {
                                        if (memblock_set_device(ctx, &ext_mem_75556, &ext_mem_75543, "ext_mem_75543") != 0)
                                            return 1;
                                    } else if (memblock_set_device(ctx, &ext_mem_75556, &mem_75554, "mem_75554") != 0)
                                        return 1;
                                    {
                                        err = gpu_kernel_inner_SMJ_shortzigpuseq_76793(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75554.mem, ext_mem_75555.mem, mem_75557.mem);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
                                        return 1;
                                    
                                    bool read_res_77458;
                                    
                                    if ((err = gpu_scalar_from_device(ctx, &read_res_77458, mem_75557.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                        goto cleanup;
                                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                        err = 1;
                                        goto cleanup;
                                    }
                                    
                                    bool defunc_0_gt_res_65567 = read_res_77458;
                                    int64_t ext_75701;
                                    int64_t ext_75700;
                                    int64_t ext_75698;
                                    int64_t ext_75697;
                                    int64_t loopres_65568;
                                    
                                    if (defunc_0_gt_res_65567) {
                                        if (memblock_set_device(ctx, &ext_mem_75702, &mem_param_75549, "mem_param_75549") != 0)
                                            return 1;
                                        ext_75701 = ctx_param_ext_75547;
                                        ext_75700 = ctx_param_ext_75548;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &mem_param_75552, "mem_param_75552") != 0)
                                            return 1;
                                        ext_75698 = ctx_param_ext_75550;
                                        ext_75697 = ctx_param_ext_75551;
                                        loopres_65568 = numIter_65475;
                                    } else {
                                        if (memblock_alloc_device(ctx, &mem_75558, (int64_t) 1, "mem_75558")) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        {
                                            err = gpu_kernel_inner_SMJ_shortzigpuseq_76799(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_75553.mem, ext_mem_75556.mem, mem_75558.mem);
                                            if (err != FUTHARK_SUCCESS)
                                                goto cleanup;
                                        }
                                        
                                        bool read_res_77459;
                                        
                                        if ((err = gpu_scalar_from_device(ctx, &read_res_77459, mem_75558.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                                            goto cleanup;
                                        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                                            err = 1;
                                            goto cleanup;
                                        }
                                        
                                        bool defunc_0_gt_res_65571 = read_res_77459;
                                        
                                        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
                                            return 1;
                                        
                                        int64_t ext_75695;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75695 = ctx_param_ext_75547;
                                        } else {
                                            ext_75695 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75694;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75694 = ctx_param_ext_75548;
                                        } else {
                                            ext_75694 = (int64_t) 1;
                                        }
                                        
                                        int64_t ext_75692;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75692 = ctx_param_ext_75550;
                                        } else {
                                            ext_75692 = (int64_t) 0;
                                        }
                                        
                                        int64_t ext_75691;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            ext_75691 = ctx_param_ext_75551;
                                        } else {
                                            ext_75691 = (int64_t) 1;
                                        }
                                        
                                        int64_t loopres_f_res_65572;
                                        
                                        if (defunc_0_gt_res_65571) {
                                            int64_t tmp_66713 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_param_75549, "mem_param_75549") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_param_75552, "mem_param_75552") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_66713;
                                        } else {
                                            if (memblock_alloc_device(ctx, &mem_75560, bytes_75559, "mem_75560")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75560.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tS_mem_75468.mem, slice_65911, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65502})) != 0)
                                                goto cleanup;
                                            if (futrts_indicesWithIncrement_7443(ctx, &ext_mem_75562, mem_75560, j_m_i_65502, find_joinTuples_arg3_65516) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
                                                return 1;
                                            
                                            bool suff_outer_par_68259;
                                            
                                            suff_outer_par_68259 = *ctx->tuning_params.inner_SMJ_shortzisuff_outer_par_1 <= min_res_65540;
                                            if (ctx->logging)
                                                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "inner_SMJ_short.suff_outer_par_1", (long) min_res_65540, suff_outer_par_68259 ? "true" : "false");
                                            
                                            int64_t tile_sizze_74966;
                                            
                                            tile_sizze_74966 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965;
                                            
                                            int64_t tile_sizze_74611;
                                            
                                            tile_sizze_74611 = *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610;
                                            
                                            int64_t num_whole_tiles_74982 = squot_safe64(j_m_i_65502, tile_sizze_74966);
                                            int64_t residual_input_75206 = srem_safe64(j_m_i_65502, tile_sizze_74966);
                                            bool cond_75207 = residual_input_75206 == (int64_t) 0;
                                            int64_t binop_x_75223 = tile_sizze_74966 * num_whole_tiles_74982;
                                            int64_t bytes_75620 = (int64_t) 8 * min_res_65540;
                                            int64_t bytes_75583 = (int64_t) 8 * tile_sizze_74966;
                                            int64_t bytes_75585 = (int64_t) 2 * tile_sizze_74966;
                                            int64_t num_whole_tiles_74627 = squot_safe64(j_m_i_65502, tile_sizze_74611);
                                            int64_t residual_input_74851 = srem_safe64(j_m_i_65502, tile_sizze_74611);
                                            bool cond_74852 = residual_input_74851 == (int64_t) 0;
                                            int64_t binop_x_74868 = tile_sizze_74611 * num_whole_tiles_74627;
                                            int64_t bytes_75644 = (int64_t) 8 * tile_sizze_74611;
                                            int64_t bytes_75646 = (int64_t) 2 * tile_sizze_74611;
                                            int64_t shared_memory_capacity_76857;
                                            
                                            shared_memory_capacity_76857 = ctx->max_shared_memory;
                                            if (suff_outer_par_68259 && sle64(sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75646, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_75644, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_76857)) {
                                                int64_t ldim_74612 = sdiv_up64(min_res_65540, tile_sizze_74611);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75682, bytes_75620, "mem_75682")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75684, bytes_75620, "mem_75684")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76805 = sext_i64_i32(sdiv_up64(tile_sizze_74611, tile_sizze_74611));
                                                int32_t virt_num_tblocks_76806 = sext_i64_i32(ldim_74612);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74609(ctx, ldim_74612, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74610, 1, 1, bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8) + (bytes_75646 + srem64((int64_t) 8 - srem64(bytes_75646, (int64_t) 8), (int64_t) 8)) + (bytes_75644 + srem64((int64_t) 8 - srem64(bytes_75644, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74612, num_whole_tiles_74627, residual_input_74851, cond_74852, binop_x_74868, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75682.mem, mem_75684.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75682, "mem_75682") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75684, "mem_75684") != 0)
                                                    return 1;
                                            } else {
                                                int64_t ldim_74967 = sdiv_up64(min_res_65540, tile_sizze_74966);
                                                
                                                if (memblock_alloc_device(ctx, &mem_75621, bytes_75620, "mem_75621")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (memblock_alloc_device(ctx, &mem_75623, bytes_75620, "mem_75623")) {
                                                    err = 1;
                                                    goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                                
                                                int32_t num_chunks_76831 = sext_i64_i32(sdiv_up64(tile_sizze_74966, tile_sizze_74966));
                                                int32_t virt_num_tblocks_76832 = sext_i64_i32(ldim_74967);
                                                
                                                {
                                                    err = gpu_kernel_inner_SMJ_shortzisegmap_intrablock_74964(ctx, ldim_74967, 1, 1, *ctx->tuning_params.inner_SMJ_shortzitile_sizze_74965, 1, 1, bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8) + (bytes_75585 + srem64((int64_t) 8 - srem64(bytes_75585, (int64_t) 8), (int64_t) 8)) + (bytes_75583 + srem64((int64_t) 8 - srem64(bytes_75583, (int64_t) 8), (int64_t) 8)), j_m_i_65502, min_res_65540, slice_65554, slice_65911, ldim_74967, num_whole_tiles_74982, residual_input_75206, cond_75207, binop_x_75223, tR_mem_75467.mem, tS_mem_75468.mem, ext_mem_75562.mem, mem_75621.mem, mem_75623.mem);
                                                    if (err != FUTHARK_SUCCESS)
                                                        goto cleanup;
                                                }
                                                if (ctx->debugging)
                                                    fprintf(ctx->log, "%s\n", "");
                                                if (memblock_set_device(ctx, &ext_mem_75686, &mem_75621, "mem_75621") != 0)
                                                    return 1;
                                                if (memblock_set_device(ctx, &ext_mem_75685, &mem_75623, "mem_75623") != 0)
                                                    return 1;
                                            }
                                            if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75688, bytes_75531, "mem_75688")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75552.mem, ctx_param_ext_75550, (int64_t []) {ctx_param_ext_75551}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75688.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75686.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
                                                return 1;
                                            if (memblock_alloc_device(ctx, &mem_75690, bytes_75531, "mem_75690")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75549.mem, ctx_param_ext_75547, (int64_t []) {ctx_param_ext_75548}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                                goto cleanup;
                                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75690.mem, start_65538, (int64_t []) {(int64_t) 1}, ext_mem_75685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_65540})) != 0)
                                                goto cleanup;
                                            if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
                                                return 1;
                                            
                                            int64_t tmp_65619 = add64((int64_t) 1, p_65535);
                                            
                                            if (memblock_set_device(ctx, &ext_mem_75696, &mem_75690, "mem_75690") != 0)
                                                return 1;
                                            if (memblock_set_device(ctx, &ext_mem_75693, &mem_75688, "mem_75688") != 0)
                                                return 1;
                                            loopres_f_res_65572 = tmp_65619;
                                        }
                                        if (memblock_set_device(ctx, &ext_mem_75702, &ext_mem_75696, "ext_mem_75696") != 0)
                                            return 1;
                                        ext_75701 = ext_75695;
                                        ext_75700 = ext_75694;
                                        if (memblock_set_device(ctx, &ext_mem_75699, &ext_mem_75693, "ext_mem_75693") != 0)
                                            return 1;
                                        ext_75698 = ext_75692;
                                        ext_75697 = ext_75691;
                                        loopres_65568 = loopres_f_res_65572;
                                    }
                                    if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
                                        return 1;
                                    
                                    bool loop_cond_65620 = slt64(loopres_65568, numIter_65475);
                                    
                                    if (memblock_set_device(ctx, &mem_param_tmp_76777, &ext_mem_75702, "ext_mem_75702") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_tmp_76778, &ext_mem_75699, "ext_mem_75699") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_76779 = ext_75701;
                                    int64_t ctx_param_ext_tmp_76780 = ext_75700;
                                    int64_t ctx_param_ext_tmp_76781 = ext_75698;
                                    int64_t ctx_param_ext_tmp_76782 = ext_75697;
                                    bool loop_while_tmp_76783 = loop_cond_65620;
                                    int64_t p_tmp_76784 = loopres_65568;
                                    
                                    if (memblock_set_device(ctx, &mem_param_75549, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
                                        return 1;
                                    if (memblock_set_device(ctx, &mem_param_75552, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
                                        return 1;
                                    ctx_param_ext_75547 = ctx_param_ext_tmp_76779;
                                    ctx_param_ext_75548 = ctx_param_ext_tmp_76780;
                                    ctx_param_ext_75550 = ctx_param_ext_tmp_76781;
                                    ctx_param_ext_75551 = ctx_param_ext_tmp_76782;
                                    loop_while_65534 = loop_while_tmp_76783;
                                    p_65535 = p_tmp_76784;
                                }
                                if (memblock_set_device(ctx, &ext_mem_75708, &mem_param_75549, "mem_param_75549") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &ext_mem_75707, &mem_param_75552, "mem_param_75552") != 0)
                                    return 1;
                                ext_75706 = ctx_param_ext_75547;
                                ext_75705 = ctx_param_ext_75548;
                                ext_75704 = ctx_param_ext_75550;
                                ext_75703 = ctx_param_ext_75551;
                                defunc_0_find_joinTuples_res_65530 = loop_while_65534;
                                defunc_0_find_joinTuples_res_65531 = p_65535;
                                if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
                                    return 1;
                                if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75711, bytes_75531, "mem_75711")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76858 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68447));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_68451(ctx, segmap_usable_groups_68448, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68437, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75703, ext_75704, mem_param_75540.mem, ext_mem_75707.mem, mem_75711.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
                                    return 1;
                                if (memblock_alloc_device(ctx, &mem_75714, bytes_75531, "mem_75714")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                                
                                int32_t virt_num_tblocks_76867 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68468));
                                
                                {
                                    err = gpu_kernel_inner_SMJ_shortzisegmap_68472(ctx, segmap_usable_groups_68469, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68459, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ext_75705, ext_75706, mem_param_75537.mem, ext_mem_75708.mem, mem_75714.mem);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (ctx->debugging)
                                    fprintf(ctx->log, "%s\n", "");
                                if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
                                    return 1;
                                
                                bool loop_cond_65630 = sle64(zeze_lhs_65491, min_res_65426);
                                
                                if (memblock_set_device(ctx, &mem_param_tmp_76759, &mem_75714, "mem_75714") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_tmp_76760, &mem_75711, "mem_75711") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_76761 = loop_cond_65630;
                                int64_t dp_tmp_76762 = zeze_lhs_65491;
                                
                                if (memblock_set_device(ctx, &mem_param_75537, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
                                    return 1;
                                if (memblock_set_device(ctx, &mem_param_75540, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
                                    return 1;
                                loop_while_65482 = loop_while_tmp_76761;
                                dp_65483 = dp_tmp_76762;
                            }
                            if (memblock_set_device(ctx, &ext_mem_75720, &mem_param_75537, "mem_param_75537") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75719, &mem_param_75540, "mem_param_75540") != 0)
                                return 1;
                            loopres_f_res_f_res_65478 = loop_while_65482;
                            loopres_f_res_f_res_65479 = dp_65483;
                            if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
                                return 1;
                            if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_68489;
                            
                            segmap_tblock_sizze_68489 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68479;
                            
                            int64_t segmap_usable_groups_68490 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68489);
                            
                            if (memblock_alloc_device(ctx, &mem_75723, bytes_75531, "mem_75723")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76876 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68489));
                            
                            {
                                err = gpu_kernel_inner_SMJ_shortzisegmap_68493(ctx, segmap_usable_groups_68490, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68479, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75528, ctx_param_ext_75529, mem_param_75530.mem, ext_mem_75719.mem, mem_75723.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
                                return 1;
                            
                            int64_t segmap_tblock_sizze_68510;
                            
                            segmap_tblock_sizze_68510 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68501;
                            
                            int64_t segmap_usable_groups_68511 = sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68510);
                            
                            if (memblock_alloc_device(ctx, &mem_75726, bytes_75531, "mem_75726")) {
                                err = 1;
                                goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "\n# SegMap");
                            
                            int32_t virt_num_tblocks_76885 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, segmap_tblock_sizze_68510));
                            
                            {
                                err = gpu_kernel_inner_SMJ_shortzisegmap_68514(ctx, segmap_usable_groups_68511, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68501, 1, 1, (int64_t) 0, loopres_f_res_f_res_65435, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450, ctx_param_ext_75525, ctx_param_ext_75526, mem_param_75527.mem, ext_mem_75720.mem, mem_75726.mem);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (ctx->debugging)
                                fprintf(ctx->log, "%s\n", "");
                            if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75728, bytes_75470, "mem_75728")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75530.mem, ctx_param_ext_75528, (int64_t []) {ctx_param_ext_75529}, (int64_t []) {nR_37190})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75728.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75723.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
                                return 1;
                            if (memblock_alloc_device(ctx, &mem_75730, bytes_75470, "mem_75730")) {
                                err = 1;
                                goto cleanup;
                            }
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_75527.mem, ctx_param_ext_75525, (int64_t []) {ctx_param_ext_75526}, (int64_t []) {nR_37190})) != 0)
                                goto cleanup;
                            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75730.mem, loopres_f_res_f_res_65435, (int64_t []) {(int64_t) 1}, mem_75726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_65450})) != 0)
                                goto cleanup;
                            if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75736, &mem_75730, "mem_75730") != 0)
                                return 1;
                            if (memblock_set_device(ctx, &ext_mem_75733, &mem_75728, "mem_75728") != 0)
                                return 1;
                        }
                        if (memblock_set_device(ctx, &ext_mem_75742, &ext_mem_75736, "ext_mem_75736") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_75739, &ext_mem_75733, "ext_mem_75733") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_65646 = slt64(loopres_65428, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_64982);
                    
                    if (memblock_set_device(ctx, &mem_param_tmp_76749, &ext_mem_75742, "ext_mem_75742") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_tmp_76750, &ext_mem_75739, "ext_mem_75739") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_76751 = ext_75741;
                    int64_t ctx_param_ext_tmp_76752 = ext_75740;
                    int64_t ctx_param_ext_tmp_76753 = ext_75738;
                    int64_t ctx_param_ext_tmp_76754 = ext_75737;
                    bool loop_while_tmp_76755 = loop_cond_65646;
                    int64_t p_tmp_76756 = loopres_65428;
                    
                    if (memblock_set_device(ctx, &mem_param_75527, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_75530, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
                        return 1;
                    ctx_param_ext_75525 = ctx_param_ext_tmp_76751;
                    ctx_param_ext_75526 = ctx_param_ext_tmp_76752;
                    ctx_param_ext_75528 = ctx_param_ext_tmp_76753;
                    ctx_param_ext_75529 = ctx_param_ext_tmp_76754;
                    loop_while_65416 = loop_while_tmp_76755;
                    p_65417 = p_tmp_76756;
                }
                if (memblock_set_device(ctx, &ext_mem_75748, &mem_param_75527, "mem_param_75527") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75747, &mem_param_75530, "mem_param_75530") != 0)
                    return 1;
                ext_75746 = ctx_param_ext_75525;
                ext_75745 = ctx_param_ext_75526;
                ext_75744 = ctx_param_ext_75528;
                ext_75743 = ctx_param_ext_75529;
                defunc_0_join_chunks_res_65412 = loop_while_65416;
                defunc_0_join_chunks_res_65413 = p_65417;
                if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_75919, &ext_mem_75748, "ext_mem_75748") != 0)
                    return 1;
                ext_75918 = ext_75746;
                ext_75917 = ext_75745;
                if (memblock_set_device(ctx, &ext_mem_75916, &ext_mem_75747, "ext_mem_75747") != 0)
                    return 1;
                ext_75915 = ext_75744;
                ext_75914 = ext_75743;
            }
            
            int64_t segmap_tblock_sizze_68531;
            
            segmap_tblock_sizze_68531 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68521;
            
            int64_t segmap_usable_groups_68532 = sdiv_up64(nR_37190, segmap_tblock_sizze_68531);
            
            if (memblock_alloc_device(ctx, &mem_75922, bytes_75470, "mem_75922")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76894 = sext_i64_i32(sdiv_up64(nR_37190, segmap_tblock_sizze_68531));
            
            {
                err = gpu_kernel_inner_SMJ_shortzisegmap_68535(ctx, segmap_usable_groups_68532, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68521, 1, 1, (int64_t) 0, nR_37190, ext_75914, ext_75915, mem_param_75482.mem, ext_mem_75916.mem, mem_75922.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
                return 1;
            
            int64_t segmap_tblock_sizze_68552;
            
            segmap_tblock_sizze_68552 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68543;
            
            int64_t segmap_usable_groups_68553 = sdiv_up64(nR_37190, segmap_tblock_sizze_68552);
            
            if (memblock_alloc_device(ctx, &mem_75925, bytes_75470, "mem_75925")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_76903 = sext_i64_i32(sdiv_up64(nR_37190, segmap_tblock_sizze_68552));
            
            {
                err = gpu_kernel_inner_SMJ_shortzisegmap_68556(ctx, segmap_usable_groups_68553, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68543, 1, 1, (int64_t) 0, nR_37190, ext_75917, ext_75918, mem_param_75479.mem, ext_mem_75919.mem, mem_75925.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_75926, (int64_t) 1, "mem_75926")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_inner_SMJ_shortzigpuseq_76912(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, gt_rhs_64823, i_p_m_t_s_64846, tR_mem_75467.mem, tS_mem_75468.mem, mem_75926.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            bool read_res_77460;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_77460, mem_75926.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_leq_res_65663 = read_res_77460;
            
            if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
                return 1;
            
            int64_t nextIter_65664;
            
            if (defunc_0_leq_res_65663) {
                int64_t nextIter_t_res_66728 = add64((int64_t) 1, p_64837);
                
                nextIter_65664 = nextIter_t_res_66728;
            } else {
                nextIter_65664 = numIter_64817;
            }
            if (memblock_set_device(ctx, &ext_mem_75932, &mem_75925, "mem_75925") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_75929, &mem_75922, "mem_75922") != 0)
                return 1;
            loopres_64861 = nextIter_65664;
        }
        
        bool loop_cond_65666 = slt64(loopres_64861, numIter_64817);
        
        if (memblock_set_device(ctx, &mem_param_tmp_76592, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_76593, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        
        bool loop_while_tmp_76594 = loop_cond_65666;
        int64_t p_tmp_76595 = loopres_64861;
        
        if (memblock_set_device(ctx, &mem_param_75479, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_75482, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        loop_while_64836 = loop_while_tmp_76594;
        p_64837 = p_tmp_76595;
    }
    if (memblock_set_device(ctx, &ext_mem_75938, &mem_param_75479, "mem_param_75479") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_75937, &mem_param_75482, "mem_param_75482") != 0)
        return 1;
    defunc_0_mergeJoin_res_64832 = loop_while_64836;
    defunc_0_mergeJoin_res_64833 = p_64837;
    if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_68562;
    
    segscan_tblock_sizze_68562 = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68561;
    
    int64_t num_tblocks_68564;
    int64_t max_num_tblocks_76918;
    
    max_num_tblocks_76918 = *ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_68563;
    num_tblocks_68564 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_37190, segscan_tblock_sizze_68562), max_num_tblocks_76918)));
    if (memblock_alloc_device(ctx, &mem_75941, bytes_75470, "mem_75941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75943, bytes_75470, "mem_75943")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, nR_37190)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_76919;
        
        shared_memory_76919 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_76920;
        
        thread_block_sizze_76920 = ctx->max_thread_block_size;
        
        int64_t registers_76921;
        
        registers_76921 = ctx->max_registers;
        
        int64_t thread_block_sizze_76922;
        
        thread_block_sizze_76922 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_76923 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_76919, thread_block_sizze_76920), (int64_t) 8), squot64(squot64(registers_76921, thread_block_sizze_76922) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_76924 = sdiv_up64(nR_37190, segscan_tblock_sizze_68562 * chunk_sizze_76923);
        int64_t num_virt_threads_76925 = num_virt_blocks_76924 * segscan_tblock_sizze_68562;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_76923, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_76926, num_virt_blocks_76924, "status_flags_mem_76926")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_76926, num_virt_blocks_76924, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_76948, (int64_t) 8 * num_virt_blocks_76924, "aggregates_mem_76948")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_76950, (int64_t) 8 * num_virt_blocks_76924, "incprefixes_mem_76950")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzisegscan_68567(ctx, num_tblocks_68564, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68561, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_68562), chunk_sizze_76923 * segscan_tblock_sizze_68562 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_68562), chunk_sizze_76923 * segscan_tblock_sizze_68562 * (int64_t) 8), (int64_t) 8), (int64_t) 8), nR_37190, num_tblocks_68564, num_virt_blocks_76924, num_virt_threads_76925, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, status_flags_mem_76926.mem, aggregates_mem_76948.mem, incprefixes_mem_76950.mem, global_dynid_mem_76952.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool protect_assert_disj_65682 = zzero_64814 || bounds_check_64826;
    bool index_certs_65683;
    
    if (!protect_assert_disj_65682) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_64823, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65684;
    
    if (nonzzero_64815) {
        int64_t read_res_77461;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77461, mem_75941.mem, gt_rhs_64823 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66731 = read_res_77461;
        
        m_f_res_65684 = x_66731;
    } else {
        m_f_res_65684 = (int64_t) 0;
    }
    
    int64_t m_65686;
    
    if (zzero_64814) {
        m_65686 = (int64_t) 0;
    } else {
        m_65686 = m_f_res_65684;
    }
    
    int64_t m_65696 = sub64(m_65686, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65698 = slt64(m_65696, nR_37190);
    bool zzero_leq_i_p_m_t_s_65697 = sle64((int64_t) 0, m_65696);
    bool y_65700 = zzero_leq_i_p_m_t_s_65697 && i_p_m_t_s_leq_w_65698;
    bool i_lte_j_65699 = sle64((int64_t) 0, m_65686);
    bool forwards_ok_65701 = i_lte_j_65699 && y_65700;
    bool eq_x_zz_65693 = (int64_t) 0 == m_f_res_65684;
    bool p_and_eq_x_y_65694 = nonzzero_64815 && eq_x_zz_65693;
    bool empty_slice_65695 = zzero_64814 || p_and_eq_x_y_65694;
    bool ok_or_empty_65702 = empty_slice_65695 || forwards_ok_65701;
    bool index_certs_65703;
    
    if (!ok_or_empty_65702) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65686, "] out of bounds for array of shape [", (long long) nR_37190, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75944 = (int64_t) 8 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75945, bytes_75944, "mem_75945")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75947, bytes_75944, "mem_75947")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75949, bytes_75944, "mem_75949")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_75469.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t bytes_75950 = (int64_t) 2 * m_65686;
    
    if (memblock_alloc_device(ctx, &mem_75951, bytes_75950, "mem_75951")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, tR_mem_75467.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65686})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_68572;
    
    segmap_tblock_sizze_68572 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68571;
    
    int64_t num_tblocks_68574;
    int64_t max_num_tblocks_77061;
    
    max_num_tblocks_77061 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68573;
    num_tblocks_68574 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nR_37190, segmap_tblock_sizze_68572), max_num_tblocks_77061)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77062 = sext_i64_i32(sdiv_up64(nR_37190, segmap_tblock_sizze_68572));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_68569(ctx, num_tblocks_68574, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68571, 1, 1, (int64_t) 0, nR_37190, m_65686, num_tblocks_68574, virt_num_tblocks_77062, tR_mem_75467.mem, ext_mem_75469.mem, ext_mem_75937.mem, ext_mem_75938.mem, mem_75941.mem, mem_75943.mem, mem_75945.mem, mem_75947.mem, mem_75949.mem, mem_75951.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_68578;
    
    segscan_tblock_sizze_68578 = *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68577;
    
    int64_t num_tblocks_68580;
    int64_t max_num_tblocks_77075;
    
    max_num_tblocks_77075 = *ctx->tuning_params.inner_SMJ_shortzisegscan_num_tblocks_68579;
    num_tblocks_68580 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segscan_tblock_sizze_68578), max_num_tblocks_77075)));
    if (memblock_alloc_device(ctx, &mem_75955, bytes_75944, "mem_75955")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75957, bytes_75944, "mem_75957")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75959, bytes_75944, "mem_75959")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_65686)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_77076;
        
        shared_memory_77076 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_77077;
        
        thread_block_sizze_77077 = ctx->max_thread_block_size;
        
        int64_t registers_77078;
        
        registers_77078 = ctx->max_registers;
        
        int64_t thread_block_sizze_77079;
        
        thread_block_sizze_77079 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_77080 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_77076, thread_block_sizze_77077), (int64_t) 8), squot64(squot64(registers_77078, thread_block_sizze_77079) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_77081 = sdiv_up64(m_65686, segscan_tblock_sizze_68578 * chunk_sizze_77080);
        int64_t num_virt_threads_77082 = num_virt_blocks_77081 * segscan_tblock_sizze_68578;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_77080, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_77083, num_virt_blocks_77081, "status_flags_mem_77083")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_77083, num_virt_blocks_77081, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77085, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77085")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77087, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77087")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_77089, (int64_t) 8 * num_virt_blocks_77081, "aggregates_mem_77089")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_77091, (int64_t) 8 * num_virt_blocks_77081, "incprefixes_mem_77091")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzisegscan_68583(ctx, num_tblocks_68580, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegscan_tblock_sizze_68577, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_68578, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_68578), smax64(chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_68578, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_68578), smax64(chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8, chunk_sizze_77080 * segscan_tblock_sizze_68578 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), m_65686, num_tblocks_68580, num_virt_blocks_77081, num_virt_threads_77082, mem_75945.mem, mem_75955.mem, mem_75957.mem, mem_75959.mem, status_flags_mem_77083.mem, aggregates_mem_77085.mem, incprefixes_mem_77087.mem, aggregates_mem_77089.mem, incprefixes_mem_77091.mem, global_dynid_mem_77093.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_tblock_sizze_68599;
    
    segmap_tblock_sizze_68599 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68587;
    
    int64_t segmap_usable_groups_68600 = sdiv_up64(m_65686, segmap_tblock_sizze_68599);
    
    if (memblock_alloc_device(ctx, &mem_75962, bytes_75944, "mem_75962")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77228 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_68599));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_68603(ctx, segmap_usable_groups_68600, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68587, 1, 1, (int64_t) 0, m_65686, mem_75955.mem, mem_75962.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
        return 1;
    
    bool cond_65737 = slt64((int64_t) 0, m_65686);
    bool y_65738 = slt64(m_65696, m_65686);
    bool bounds_check_65739 = zzero_leq_i_p_m_t_s_65697 && y_65738;
    bool loop_not_taken_65740 = !cond_65737;
    bool protect_assert_disj_65741 = bounds_check_65739 || loop_not_taken_65740;
    bool index_certs_65742;
    
    if (!protect_assert_disj_65741) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  ftSMJ.fut:284:10-41\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75964, (int64_t) 8, "mem_75964")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_77237(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75962.mem, mem_75964.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75964, "mem_75964") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75963, (int64_t) 8, "mem_75963")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75963, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75965, &mem_75963, "mem_75963") != 0)
            return 1;
    }
    if (cond_65737) {
        if (memblock_alloc_device(ctx, &mem_75967, (int64_t) 8, "mem_75967")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_77243(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_65696, mem_75945.mem, mem_75967.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75967, "mem_75967") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_75966, (int64_t) 8, "mem_75966")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_75966, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_75968, &mem_75966, "mem_75966") != 0)
            return 1;
    }
    
    bool zzero_65754 = scatter_psizze_37199 == (int64_t) 0;
    bool nonzzero_65755 = !zzero_65754;
    bool nonzzero_cert_65756;
    
    if (!nonzzero_65755) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_65821 = !empty_slice_65695;
    bool protect_assert_disj_65822 = empty_slice_65695 || bounds_check_65739;
    bool index_certs_65823;
    
    if (!protect_assert_disj_65822) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_65696, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_65824;
    
    if (x_65821) {
        int64_t read_res_77462;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77462, mem_75957.mem, m_65696 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66739 = read_res_77462;
        
        m_f_res_65824 = x_66739;
    } else {
        m_f_res_65824 = (int64_t) 0;
    }
    
    int64_t m_65826;
    
    if (empty_slice_65695) {
        m_65826 = (int64_t) 0;
    } else {
        m_65826 = m_f_res_65824;
    }
    
    int64_t m_65836 = sub64(m_65826, (int64_t) 1);
    bool i_p_m_t_s_leq_w_65838 = slt64(m_65836, m_65686);
    bool zzero_leq_i_p_m_t_s_65837 = sle64((int64_t) 0, m_65836);
    bool y_65840 = zzero_leq_i_p_m_t_s_65837 && i_p_m_t_s_leq_w_65838;
    bool i_lte_j_65839 = sle64((int64_t) 0, m_65826);
    bool forwards_ok_65841 = i_lte_j_65839 && y_65840;
    bool eq_x_zz_65833 = (int64_t) 0 == m_f_res_65824;
    bool p_and_eq_x_y_65834 = x_65821 && eq_x_zz_65833;
    bool empty_slice_65835 = empty_slice_65695 || p_and_eq_x_y_65834;
    bool ok_or_empty_65842 = empty_slice_65835 || forwards_ok_65841;
    bool index_certs_65843;
    
    if (!ok_or_empty_65842) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_65826, "] out of bounds for array of shape [", (long long) m_65686, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:325:7-326:73\n   #3  ftSMJ.fut:350:133-136\n   #4  ftSMJ.fut:339:1-350:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75969 = (int64_t) 8 * m_65826;
    
    if (memblock_alloc_device(ctx, &mem_75974, (int64_t) 8, "mem_75974")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_inner_SMJ_shortzigpuseq_77249(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_75965.mem, ext_mem_75968.mem, mem_75974.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
        return 1;
    
    int64_t n_pairs_t_res_65747;
    
    if (cond_65737) {
        int64_t read_res_77463;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77463, mem_75974.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_75465 = read_res_77463;
        
        n_pairs_t_res_65747 = x_75465;
    } else {
        n_pairs_t_res_65747 = (int64_t) 0;
    }
    if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
        return 1;
    
    int64_t n_pairs_65748;
    
    if (cond_65737) {
        n_pairs_65748 = n_pairs_t_res_65747;
    } else {
        n_pairs_65748 = (int64_t) 0;
    }
    
    int64_t bytes_75975 = (int64_t) 2 * n_pairs_65748;
    int64_t bytes_75977 = (int64_t) 8 * n_pairs_65748;
    int64_t segmap_tblock_sizze_68614;
    
    segmap_tblock_sizze_68614 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68613;
    
    int64_t num_tblocks_68616;
    int64_t max_num_tblocks_77255;
    
    max_num_tblocks_77255 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68615;
    num_tblocks_68616 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_68614), max_num_tblocks_77255)));
    if (memblock_alloc_device(ctx, &mem_75970, bytes_75969, "mem_75970")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75970.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75945.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_75972, bytes_75969, "mem_75972")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75972.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_65826})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_68622;
    
    segmap_tblock_sizze_68622 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68621;
    
    int64_t num_tblocks_68624;
    int64_t max_num_tblocks_77256;
    
    max_num_tblocks_77256 = *ctx->tuning_params.inner_SMJ_shortzisegmap_num_tblocks_68623;
    num_tblocks_68624 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_65686, segmap_tblock_sizze_68622), max_num_tblocks_77256)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_77257 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_68622));
    
    {
        err = gpu_kernel_inner_SMJ_shortzisegmap_68619(ctx, num_tblocks_68624, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68621, 1, 1, (int64_t) 0, m_65686, m_65826, num_tblocks_68624, virt_num_tblocks_77257, mem_75945.mem, mem_75957.mem, mem_75959.mem, mem_75962.mem, mem_75970.mem, mem_75972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
        return 1;
    
    bool cond_65853 = slt64((int64_t) 0, m_65826);
    int64_t segmap_tblock_sizze_68637;
    
    segmap_tblock_sizze_68637 = *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68629;
    if (memblock_alloc_device(ctx, &mem_75976, bytes_75975, "mem_75976")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i16(ctx, mem_75976, n_pairs_65748, (int16_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75978, bytes_75977, "mem_75978")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75978, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_75980, bytes_75977, "mem_75980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_75980, n_pairs_65748, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zm_lhs_65752 = add64(scatter_psizze_37199, n_pairs_65748);
    int64_t zs_lhs_65753 = sub64(zm_lhs_65752, (int64_t) 1);
    int64_t m_65757 = sdiv64(zs_lhs_65753, scatter_psizze_37199);
    bool loop_cond_65758 = slt64((int64_t) 0, m_65757);
    bool partitioned_scatter_res_65759;
    int64_t partitioned_scatter_res_65763;
    bool loop_while_65764;
    int64_t p_65768;
    
    loop_while_65764 = loop_cond_65758;
    p_65768 = (int64_t) 0;
    while (loop_while_65764) {
        int64_t lower_bound_65769 = mul64(scatter_psizze_37199, p_65768);
        int64_t min_arg1_65770 = add64(scatter_psizze_37199, lower_bound_65769);
        int64_t min_res_65771 = smin64(n_pairs_65748, min_arg1_65770);
        int64_t j_m_i_65772 = sub64(min_res_65771, lower_bound_65769);
        bool empty_slice_65773 = j_m_i_65772 == (int64_t) 0;
        int64_t m_65774 = sub64(j_m_i_65772, (int64_t) 1);
        int64_t i_p_m_t_s_65775 = add64(lower_bound_65769, m_65774);
        bool zzero_leq_i_p_m_t_s_65776 = sle64((int64_t) 0, i_p_m_t_s_65775);
        bool i_p_m_t_s_leq_w_65777 = slt64(i_p_m_t_s_65775, n_pairs_65748);
        bool zzero_lte_i_65778 = sle64((int64_t) 0, lower_bound_65769);
        bool i_lte_j_65779 = sle64(lower_bound_65769, min_res_65771);
        bool y_65780 = i_p_m_t_s_leq_w_65777 && zzero_lte_i_65778;
        bool y_65781 = zzero_leq_i_p_m_t_s_65776 && y_65780;
        bool forwards_ok_65782 = i_lte_j_65779 && y_65781;
        bool ok_or_empty_65783 = empty_slice_65773 || forwards_ok_65782;
        bool index_certs_65784;
        
        if (!ok_or_empty_65783) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_65769, ":", (long long) min_res_65771, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_75990 = (int64_t) 2 * j_m_i_65772;
        int64_t bytes_75992 = (int64_t) 8 * j_m_i_65772;
        
        if (memblock_alloc_device(ctx, &mem_75991, bytes_75990, "mem_75991")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75976.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75993, bytes_75992, "mem_75993")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75978.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_75995, bytes_75992, "mem_75995")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_75980.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_65769, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77275 = sext_i64_i32(sdiv_up64(m_65686, segmap_tblock_sizze_68614));
        
        {
            err = gpu_kernel_inner_SMJ_shortzisegmap_68611(ctx, num_tblocks_68616, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68613, 1, 1, (int64_t) 0, m_65686, lower_bound_65769, min_res_65771, j_m_i_65772, num_tblocks_68616, virt_num_tblocks_77275, mem_75947.mem, mem_75949.mem, mem_75951.mem, mem_75962.mem, mem_75991.mem, mem_75993.mem, mem_75995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t tmp_65798 = add64((int64_t) 1, p_65768);
        
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_75976.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75991.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75978.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75993.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_75980.mem, lower_bound_65769, (int64_t []) {(int64_t) 1}, mem_75995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_65772})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        
        bool loop_cond_65809 = slt64(tmp_65798, m_65757);
        bool loop_while_tmp_77270 = loop_cond_65809;
        int64_t p_tmp_77274 = tmp_65798;
        
        loop_while_65764 = loop_while_tmp_77270;
        p_65768 = p_tmp_77274;
    }
    partitioned_scatter_res_65759 = loop_while_65764;
    partitioned_scatter_res_65763 = p_65768;
    if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
        return 1;
    
    bool loop_cond_t_res_65854 = slt64(m_65686, n_pairs_65748);
    bool x_65855 = cond_65853 && loop_cond_t_res_65854;
    
    if (memblock_alloc_device(ctx, &mem_76021, (int64_t) 2, "mem_76021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76022, (int64_t) 8, "mem_76022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_76023, (int64_t) 8, "mem_76023")) {
        err = 1;
        goto cleanup;
    }
    
    bool joinTups_to_joinPairs_InnerJoin_res_65856;
    int64_t joinTups_to_joinPairs_InnerJoin_res_65860;
    bool loop_while_65861;
    int64_t p_65865;
    
    if (memblock_set_device(ctx, &mem_param_76008, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76011, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_76014, &mem_75980, "mem_75980") != 0)
        return 1;
    loop_while_65861 = x_65855;
    p_65865 = (int64_t) 0;
    while (loop_while_65861) {
        bool x_65866 = sle64((int64_t) 0, p_65865);
        bool y_65867 = slt64(p_65865, m_65826);
        bool bounds_check_65868 = x_65866 && y_65867;
        bool index_certs_65869;
        
        if (!bounds_check_65868) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_65865, "] out of bounds for array of shape [", (long long) m_65826, "].", "-> #0  ftSMJ.fut:299:13-42\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t read_res_77464;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77464, mem_75972.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65870 = read_res_77464;
        int64_t read_res_77465;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_77465, mem_75970.mem, p_65865 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t loopres_65871 = read_res_77465;
        bool x_65872 = sle64((int64_t) 0, loopres_65870);
        bool y_65873 = slt64(loopres_65870, n_pairs_65748);
        bool bounds_check_65874 = x_65872 && y_65873;
        bool index_certs_65875;
        
        if (!bounds_check_65874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:301:52-61\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t tmp_65886 = add64(loopres_65870, loopres_65871);
        bool empty_slice_65890 = loopres_65871 == (int64_t) 0;
        int64_t m_65891 = sub64(loopres_65871, (int64_t) 1);
        int64_t i_p_m_t_s_65892 = add64(loopres_65870, m_65891);
        bool zzero_leq_i_p_m_t_s_65893 = sle64((int64_t) 0, i_p_m_t_s_65892);
        bool i_p_m_t_s_leq_w_65894 = slt64(i_p_m_t_s_65892, n_pairs_65748);
        bool i_lte_j_65895 = sle64(loopres_65870, tmp_65886);
        bool y_65896 = x_65872 && i_p_m_t_s_leq_w_65894;
        bool y_65897 = zzero_leq_i_p_m_t_s_65893 && y_65896;
        bool forwards_ok_65898 = i_lte_j_65895 && y_65897;
        bool ok_or_empty_65899 = empty_slice_65890 || forwards_ok_65898;
        bool index_certs_65900;
        
        if (!ok_or_empty_65899) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_65870, ":", (long long) tmp_65886, "] out of bounds for array of shape [", (long long) n_pairs_65748, "].", "-> #0  ftSMJ.fut:305:14-55\n   #1  ftSMJ.fut:325:7-326:73\n   #2  ftSMJ.fut:350:133-136\n   #3  ftSMJ.fut:339:1-350:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_76024 = (int64_t) 2 * loopres_65871;
        int64_t bytes_76026 = (int64_t) 8 * loopres_65871;
        int64_t segmap_usable_groups_68638 = sdiv_up64(loopres_65871, segmap_tblock_sizze_68637);
        int64_t tmp_65885 = add64((int64_t) 1, p_65865);
        
        if (memblock_alloc_device(ctx, &mem_76016, bytes_75975, "mem_76016")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_76016.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76008.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76018, bytes_75977, "mem_76018")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76011.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_76020, bytes_75977, "mem_76020")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76020.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_76014.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
            goto cleanup;
        
        bool cond_65904 = slt64(tmp_65885, m_65826);
        bool x_65905 = loop_cond_t_res_65854 && cond_65904;
        
        {
            err = gpu_kernel_inner_SMJ_shortzigpuseq_77296(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, loopres_65870, mem_param_76008.mem, mem_param_76011.mem, mem_param_76014.mem, mem_76021.mem, mem_76022.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76025, bytes_76024, "mem_76025")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77302 = loopres_65871;
        int64_t tblock_sizze_77307;
        
        tblock_sizze_77307 = *ctx->tuning_params.inner_SMJ_shortzitblock_sizze_77307;
        
        int64_t virt_num_tblocks_77308 = sdiv_up64(replicate_n_77302, tblock_sizze_77307);
        int64_t num_tblocks_77309 = smin64(virt_num_tblocks_77308, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_shortzireplicate_77303(ctx, num_tblocks_77309, 1, 1, tblock_sizze_77307, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77302, virt_num_tblocks_77308, num_tblocks_77309, mem_76021.mem, mem_76025.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_76027, bytes_76026, "mem_76027")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t replicate_n_77322 = loopres_65871;
        int64_t tblock_sizze_77327;
        
        tblock_sizze_77327 = *ctx->tuning_params.inner_SMJ_shortzitblock_sizze_77327;
        
        int64_t virt_num_tblocks_77328 = sdiv_up64(replicate_n_77322, tblock_sizze_77327);
        int64_t num_tblocks_77329 = smin64(virt_num_tblocks_77328, (int64_t) 1048576);
        
        {
            err = gpu_kernel_inner_SMJ_shortzireplicate_77323(ctx, num_tblocks_77329, 1, 1, tblock_sizze_77327, 1, 1, (int64_t) 0, loopres_65871, replicate_n_77322, virt_num_tblocks_77328, num_tblocks_77329, mem_76022.mem, mem_76027.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_77342 = sext_i64_i32(sdiv_up64(loopres_65871, segmap_tblock_sizze_68637));
        
        {
            err = gpu_kernel_inner_SMJ_shortzisegmap_68641(ctx, segmap_usable_groups_68638, 1, 1, *ctx->tuning_params.inner_SMJ_shortzisegmap_tblock_sizze_68629, 1, 1, (int64_t) 0, loopres_65870, loopres_65871, mem_76020.mem, mem_76023.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_76016.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76018.mem, loopres_65870, (int64_t []) {(int64_t) 1}, mem_76027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_65871})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77288, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77289, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_77290, &mem_76020, "mem_76020") != 0)
            return 1;
        
        bool loop_while_tmp_77291 = x_65905;
        int64_t p_tmp_77295 = tmp_65885;
        
        if (memblock_set_device(ctx, &mem_param_76008, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76011, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_76014, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        loop_while_65861 = loop_while_tmp_77291;
        p_65865 = p_tmp_77295;
    }
    if (memblock_set_device(ctx, &ext_mem_76039, &mem_param_76008, "mem_param_76008") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76038, &mem_param_76011, "mem_param_76011") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_76037, &mem_param_76014, "mem_param_76014") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_65856 = loop_while_65861;
    joinTups_to_joinPairs_InnerJoin_res_65860 = p_65865;
    if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76041, bytes_75975, "mem_76041")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_76041.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76039.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76043, bytes_75977, "mem_76043")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76038.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_76045, bytes_75977, "mem_76045")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_76045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_76037.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_65748})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76542, &mem_76043, "mem_76043") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76543, &mem_76045, "mem_76045") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_76544, &mem_76041, "mem_76041") != 0)
        return 1;
    prim_out_76545 = n_pairs_65748;
    if (memblock_set_device(ctx, &*mem_out_p_77445, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77446, &mem_out_76543, "mem_out_76543") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77447, &mem_out_76544, "mem_out_76544") != 0)
        return 1;
    *out_prim_out_77448 = prim_out_76545;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_76045, "mem_76045") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76043, "mem_76043") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76041, "mem_76041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77290, "mem_param_tmp_77290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77289, "mem_param_tmp_77289") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_77288, "mem_param_tmp_77288") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76027, "mem_76027") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76025, "mem_76025") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76020, "mem_76020") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76018, "mem_76018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76016, "mem_76016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76014, "mem_param_76014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76011, "mem_param_76011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_76008, "mem_param_76008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76037, "ext_mem_76037") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76038, "ext_mem_76038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_76039, "ext_mem_76039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76023, "mem_76023") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76022, "mem_76022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_76021, "mem_76021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75995, "mem_75995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75993, "mem_75993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75991, "mem_75991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75980, "mem_75980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75978, "mem_75978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75976, "mem_75976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75972, "mem_75972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75970, "mem_75970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75974, "mem_75974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75966, "mem_75966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75967, "mem_75967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75968, "ext_mem_75968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75963, "mem_75963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75964, "mem_75964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75965, "ext_mem_75965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75962, "mem_75962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77091, "incprefixes_mem_77091") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77089, "aggregates_mem_77089") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_77087, "incprefixes_mem_77087") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_77085, "aggregates_mem_77085") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_77083, "status_flags_mem_77083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75959, "mem_75959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75957, "mem_75957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75955, "mem_75955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75951, "mem_75951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75949, "mem_75949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75947, "mem_75947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75945, "mem_75945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_76950, "incprefixes_mem_76950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_76948, "aggregates_mem_76948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_76926, "status_flags_mem_76926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75943, "mem_75943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75941, "mem_75941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76593, "mem_param_tmp_76593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76592, "mem_param_tmp_76592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75926, "mem_75926") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75925, "mem_75925") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75922, "mem_75922") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76750, "mem_param_tmp_76750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76749, "mem_param_tmp_76749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75730, "mem_75730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75728, "mem_75728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75726, "mem_75726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75723, "mem_75723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76760, "mem_param_tmp_76760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76759, "mem_param_tmp_76759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75714, "mem_75714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75711, "mem_75711") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76778, "mem_param_tmp_76778") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76777, "mem_param_tmp_76777") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75690, "mem_75690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75688, "mem_75688") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75623, "mem_75623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75621, "mem_75621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75684, "mem_75684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75682, "mem_75682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75685, "ext_mem_75685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75686, "ext_mem_75686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75562, "ext_mem_75562") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75560, "mem_75560") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75693, "ext_mem_75693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75696, "ext_mem_75696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75558, "mem_75558") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75699, "ext_mem_75699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75702, "ext_mem_75702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75556, "ext_mem_75556") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75555, "ext_mem_75555") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75552, "mem_param_75552") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75549, "mem_param_75549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75707, "ext_mem_75707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75708, "ext_mem_75708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75544, "mem_75544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75545, "mem_75545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75546, "ext_mem_75546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75541, "mem_75541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75542, "mem_75542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75543, "ext_mem_75543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75540, "mem_param_75540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75537, "mem_param_75537") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75719, "ext_mem_75719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75720, "ext_mem_75720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75557, "mem_75557") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75554, "mem_75554") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75553, "mem_75553") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75534, "mem_75534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75532, "mem_75532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75733, "ext_mem_75733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75736, "ext_mem_75736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75739, "ext_mem_75739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75742, "ext_mem_75742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75530, "mem_param_75530") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75527, "mem_param_75527") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75747, "ext_mem_75747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75748, "ext_mem_75748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75524, "mem_75524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75522, "mem_75522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75509, "mem_75509") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75511, "mem_75511") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75512, "ext_mem_75512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75513, "ext_mem_75513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75506, "mem_75506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75504, "mem_75504") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75493, "mem_75493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75494, "mem_75494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75495, "ext_mem_75495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75492, "mem_75492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75489, "mem_75489") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75490, "mem_75490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75491, "ext_mem_75491") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75488, "mem_75488") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75486, "mem_75486") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76611, "mem_param_tmp_76611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_76610, "mem_param_tmp_76610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75895, "mem_75895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75893, "mem_75893") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75828, "mem_75828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75826, "mem_75826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75889, "mem_75889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75887, "mem_75887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75890, "ext_mem_75890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75891, "ext_mem_75891") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75767, "ext_mem_75767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75765, "mem_75765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75898, "ext_mem_75898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75901, "ext_mem_75901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75763, "mem_75763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75904, "ext_mem_75904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75907, "ext_mem_75907") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75761, "ext_mem_75761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75760, "ext_mem_75760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75757, "mem_param_75757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75754, "mem_param_75754") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75912, "ext_mem_75912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75913, "ext_mem_75913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75762, "mem_75762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75759, "mem_75759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75758, "mem_75758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75749, "mem_75749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75750, "mem_75750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75751, "ext_mem_75751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75916, "ext_mem_75916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75919, "ext_mem_75919") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75929, "ext_mem_75929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75932, "ext_mem_75932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75482, "mem_param_75482") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_75479, "mem_param_75479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75937, "ext_mem_75937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75938, "ext_mem_75938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75484, "mem_75484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75483, "mem_75483") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75474, "mem_75474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75475, "mem_75475") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75476, "ext_mem_75476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75473, "mem_75473") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75471, "mem_75471") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_75469, "ext_mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76544, "mem_out_76544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76543, "mem_out_76543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_77466, struct memblock_device eta_p_mem_75467, int64_t nz2080U_60458)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_76567;
    
    segred_tmp_mem_76567.references = NULL;
    
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76542;
    int64_t segred_tblock_sizze_66766;
    
    segred_tblock_sizze_66766 = *ctx->tuning_params.max_idxzisegred_tblock_sizze_66765;
    
    int64_t num_tblocks_66768;
    int64_t max_num_tblocks_76543;
    
    max_num_tblocks_76543 = *ctx->tuning_params.max_idxzisegred_num_tblocks_66767;
    num_tblocks_66768 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nz2080U_60458, segred_tblock_sizze_66766), max_num_tblocks_76543)));
    if (memblock_alloc_device(ctx, &mem_75469, (int64_t) 8, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_76544 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_76567, (int64_t) 8 * num_tblocks_66768, "segred_tmp_mem_76567")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_76569 = num_tblocks_66768 * segred_tblock_sizze_66766;
    
    {
        err = gpu_kernel_max_idxzisegred_nonseg_66773(ctx, num_tblocks_66768, 1, 1, *ctx->tuning_params.max_idxzisegred_tblock_sizze_66765, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_66766 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66766, (int64_t) 8), (int64_t) 8)), nz2080U_60458, num_tblocks_66768, num_threads_76569, eta_p_mem_75467.mem, mem_75469.mem, counters_mem_76545.mem, segred_tmp_mem_76567.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t read_res_77467;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_77467, mem_75469.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_res_65927 = read_res_77467;
    
    if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
        return 1;
    prim_out_76542 = defunc_0_reduce_res_65927;
    *out_prim_out_77466 = prim_out_76542;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_76567, "segred_tmp_mem_76567") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_77468, struct memblock_device eta_p_mem_75467, int64_t nz2080U_60421)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_76567;
    
    segred_tmp_mem_76567.references = NULL;
    
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t prim_out_76542;
    int64_t segred_tblock_sizze_66756;
    
    segred_tblock_sizze_66756 = *ctx->tuning_params.min_idxzisegred_tblock_sizze_66755;
    
    int64_t num_tblocks_66758;
    int64_t max_num_tblocks_76543;
    
    max_num_tblocks_76543 = *ctx->tuning_params.min_idxzisegred_num_tblocks_66757;
    num_tblocks_66758 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nz2080U_60421, segred_tblock_sizze_66756), max_num_tblocks_76543)));
    if (memblock_alloc_device(ctx, &mem_75469, (int64_t) 8, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_76544 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_76567, (int64_t) 8 * num_tblocks_66758, "segred_tmp_mem_76567")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_76569 = num_tblocks_66758 * segred_tblock_sizze_66756;
    
    {
        err = gpu_kernel_min_idxzisegred_nonseg_66763(ctx, num_tblocks_66758, 1, 1, *ctx->tuning_params.min_idxzisegred_tblock_sizze_66755, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_66756 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66756, (int64_t) 8), (int64_t) 8)), nz2080U_60421, num_tblocks_66758, num_threads_76569, eta_p_mem_75467.mem, mem_75469.mem, counters_mem_76545.mem, segred_tmp_mem_76567.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t read_res_77469;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_77469, mem_75469.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_res_65927 = read_res_77469;
    
    if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
        return 1;
    prim_out_76542 = defunc_0_reduce_res_65927;
    *out_prim_out_77468 = prim_out_76542;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_76567, "segred_tmp_mem_76567") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7443(struct futhark_context *ctx, struct memblock_device *mem_out_p_77470, struct memblock_device xs_mem_75467, int64_t n_31863, int64_t incr_31864)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t rng_31869 = add64(n_31863, incr_31864);
    bool bounds_invalid_upwards_31873 = slt64(rng_31869, incr_31864);
    bool valid_31878 = !bounds_invalid_upwards_31873;
    bool range_valid_c_31879;
    
    if (!valid_31878) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_31864, "..<", (long long) rng_31869, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75468 = (int64_t) 8 * n_31863;
    
    if (memblock_alloc_device(ctx, &mem_75469, bytes_75468, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_75469, n_31863, incr_31864, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75469, "mem_75469") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77470, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7587(struct futhark_context *ctx, struct memblock_device *mem_out_p_77471, struct memblock_device xs_mem_75467, int64_t n_37232, int64_t incr_37233)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t rng_37238 = add64(n_37232, incr_37233);
    bool bounds_invalid_upwards_37242 = slt64(rng_37238, incr_37233);
    bool valid_37247 = !bounds_invalid_upwards_37242;
    bool range_valid_c_37248;
    
    if (!valid_37247) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_37233, "..<", (long long) rng_37238, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75468 = (int64_t) 8 * n_37232;
    
    if (memblock_alloc_device(ctx, &mem_75469, bytes_75468, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_75469, n_37232, incr_37233, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75469, "mem_75469") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77471, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7692(struct futhark_context *ctx, struct memblock_device *mem_out_p_77472, struct memblock_device xs_mem_75467, int64_t n_42252, int64_t incr_42253)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t rng_42258 = add64(n_42252, incr_42253);
    bool bounds_invalid_upwards_42262 = slt64(rng_42258, incr_42253);
    bool valid_42267 = !bounds_invalid_upwards_42262;
    bool range_valid_c_42268;
    
    if (!valid_42267) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_42253, "..<", (long long) rng_42258, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75468 = (int64_t) 8 * n_42252;
    
    if (memblock_alloc_device(ctx, &mem_75469, bytes_75468, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_75469, n_42252, incr_42253, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75469, "mem_75469") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77472, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7791(struct futhark_context *ctx, struct memblock_device *mem_out_p_77473, struct memblock_device xs_mem_75467, int64_t n_47208, int64_t incr_47209)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t rng_47214 = add64(n_47208, incr_47209);
    bool bounds_invalid_upwards_47218 = slt64(rng_47214, incr_47209);
    bool valid_47223 = !bounds_invalid_upwards_47218;
    bool range_valid_c_47224;
    
    if (!valid_47223) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_47209, "..<", (long long) rng_47214, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75468 = (int64_t) 8 * n_47208;
    
    if (memblock_alloc_device(ctx, &mem_75469, bytes_75468, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_75469, n_47208, incr_47209, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75469, "mem_75469") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77473, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_7898(struct futhark_context *ctx, struct memblock_device *mem_out_p_77474, struct memblock_device xs_mem_75467, int64_t n_52237, int64_t incr_52238)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_75469;
    
    mem_75469.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
    struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
    struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
    struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
    struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
    int64_t rng_52243 = add64(n_52237, incr_52238);
    bool bounds_invalid_upwards_52247 = slt64(rng_52243, incr_52238);
    bool valid_52252 = !bounds_invalid_upwards_52247;
    bool range_valid_c_52253;
    
    if (!valid_52252) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_52238, "..<", (long long) rng_52243, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_75468 = (int64_t) 8 * n_52237;
    
    if (memblock_alloc_device(ctx, &mem_75469, bytes_75468, "mem_75469")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_75469, n_52237, incr_52238, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_76542, &mem_75469, "mem_75469") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_77474, &mem_out_76542, "mem_out_76542") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_75469, "mem_75469") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_76542, "mem_out_76542") != 0)
            return 1;
    }
    return err;
}

int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_58875 = (int64_t) 0;
    int64_t dz2083U_58876 = (int64_t) 0;
    int64_t incr_58877 = (int64_t) 0;
    int64_t psizze_58878 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75468;
    
    ys_mem_75468.references = NULL;
    
    struct memblock_device is_mem_75467;
    
    is_mem_75467.references = NULL;
    incr_58877 = in0;
    psizze_58878 = in1;
    is_mem_75467 = in2->mem;
    niz2084U_58875 = in2->shape[0];
    ys_mem_75468 = in3->mem;
    dz2083U_58876 = in3->shape[0];
    if (!(niz2084U_58875 == in2->shape[0] && dz2083U_58876 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_76542, is_mem_75467, ys_mem_75468, niz2084U_58875, dz2083U_58876, incr_58877, psizze_58878);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = niz2084U_58875;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_60382 = (int64_t) 0;
    int64_t n_60383 = (int64_t) 0;
    int64_t incr_60384 = (int64_t) 0;
    int64_t psizze_60385 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75469;
    
    ys_mem_75469.references = NULL;
    
    struct memblock_device is_mem_75468;
    
    is_mem_75468.references = NULL;
    
    struct memblock_device preVals_mem_75467;
    
    preVals_mem_75467.references = NULL;
    incr_60384 = in0;
    psizze_60385 = in1;
    preVals_mem_75467 = in2->mem;
    ni_60382 = in2->shape[0];
    is_mem_75468 = in3->mem;
    ni_60382 = in3->shape[0];
    ys_mem_75469 = in4->mem;
    n_60383 = in4->shape[0];
    if (!(ni_60382 == in2->shape[0] && (ni_60382 == in3->shape[0] && n_60383 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_76542, preVals_mem_75467, is_mem_75468, ys_mem_75469, ni_60382, n_60383, incr_60384, psizze_60385);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = ni_60382;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_58535 = (int64_t) 0;
    int64_t dz2083U_58536 = (int64_t) 0;
    int64_t incr_58537 = (int64_t) 0;
    int64_t psizze_58538 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75468;
    
    ys_mem_75468.references = NULL;
    
    struct memblock_device is_mem_75467;
    
    is_mem_75467.references = NULL;
    incr_58537 = in0;
    psizze_58538 = in1;
    is_mem_75467 = in2->mem;
    niz2084U_58535 = in2->shape[0];
    ys_mem_75468 = in3->mem;
    dz2083U_58536 = in3->shape[0];
    if (!(niz2084U_58535 == in2->shape[0] && dz2083U_58536 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_76542, is_mem_75467, ys_mem_75468, niz2084U_58535, dz2083U_58536, incr_58537, psizze_58538);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = niz2084U_58535;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_60081 = (int64_t) 0;
    int64_t n_60082 = (int64_t) 0;
    int64_t incr_60083 = (int64_t) 0;
    int64_t psizze_60084 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75469;
    
    ys_mem_75469.references = NULL;
    
    struct memblock_device is_mem_75468;
    
    is_mem_75468.references = NULL;
    
    struct memblock_device preVals_mem_75467;
    
    preVals_mem_75467.references = NULL;
    incr_60083 = in0;
    psizze_60084 = in1;
    preVals_mem_75467 = in2->mem;
    ni_60081 = in2->shape[0];
    is_mem_75468 = in3->mem;
    ni_60081 = in3->shape[0];
    ys_mem_75469 = in4->mem;
    n_60082 = in4->shape[0];
    if (!(ni_60081 == in2->shape[0] && (ni_60081 == in3->shape[0] && n_60082 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_76542, preVals_mem_75467, is_mem_75468, ys_mem_75469, ni_60081, n_60082, incr_60083, psizze_60084);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = ni_60081;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_57886 = (int64_t) 0;
    int64_t dz2083U_57887 = (int64_t) 0;
    int64_t incr_57888 = (int64_t) 0;
    int64_t psizze_57889 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75468;
    
    ys_mem_75468.references = NULL;
    
    struct memblock_device is_mem_75467;
    
    is_mem_75467.references = NULL;
    incr_57888 = in0;
    psizze_57889 = in1;
    is_mem_75467 = in2->mem;
    niz2084U_57886 = in2->shape[0];
    ys_mem_75468 = in3->mem;
    dz2083U_57887 = in3->shape[0];
    if (!(niz2084U_57886 == in2->shape[0] && dz2083U_57887 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_76542, is_mem_75467, ys_mem_75468, niz2084U_57886, dz2083U_57887, incr_57888, psizze_57889);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = niz2084U_57886;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_59479 = (int64_t) 0;
    int64_t n_59480 = (int64_t) 0;
    int64_t incr_59481 = (int64_t) 0;
    int64_t psizze_59482 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75469;
    
    ys_mem_75469.references = NULL;
    
    struct memblock_device is_mem_75468;
    
    is_mem_75468.references = NULL;
    
    struct memblock_device preVals_mem_75467;
    
    preVals_mem_75467.references = NULL;
    incr_59481 = in0;
    psizze_59482 = in1;
    preVals_mem_75467 = in2->mem;
    ni_59479 = in2->shape[0];
    is_mem_75468 = in3->mem;
    ni_59479 = in3->shape[0];
    ys_mem_75469 = in4->mem;
    n_59480 = in4->shape[0];
    if (!(ni_59479 == in2->shape[0] && (ni_59479 == in3->shape[0] && n_59480 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_76542, preVals_mem_75467, is_mem_75468, ys_mem_75469, ni_59479, n_59480, incr_59481, psizze_59482);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = ni_59479;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_58195 = (int64_t) 0;
    int64_t dz2083U_58196 = (int64_t) 0;
    int64_t incr_58197 = (int64_t) 0;
    int64_t psizze_58198 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75468;
    
    ys_mem_75468.references = NULL;
    
    struct memblock_device is_mem_75467;
    
    is_mem_75467.references = NULL;
    incr_58197 = in0;
    psizze_58198 = in1;
    is_mem_75467 = in2->mem;
    niz2084U_58195 = in2->shape[0];
    ys_mem_75468 = in3->mem;
    dz2083U_58196 = in3->shape[0];
    if (!(niz2084U_58195 == in2->shape[0] && dz2083U_58196 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_76542, is_mem_75467, ys_mem_75468, niz2084U_58195, dz2083U_58196, incr_58197, psizze_58198);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = niz2084U_58195;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_59780 = (int64_t) 0;
    int64_t n_59781 = (int64_t) 0;
    int64_t incr_59782 = (int64_t) 0;
    int64_t psizze_59783 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75469;
    
    ys_mem_75469.references = NULL;
    
    struct memblock_device is_mem_75468;
    
    is_mem_75468.references = NULL;
    
    struct memblock_device preVals_mem_75467;
    
    preVals_mem_75467.references = NULL;
    incr_59782 = in0;
    psizze_59783 = in1;
    preVals_mem_75467 = in2->mem;
    ni_59780 = in2->shape[0];
    is_mem_75468 = in3->mem;
    ni_59780 = in3->shape[0];
    ys_mem_75469 = in4->mem;
    n_59781 = in4->shape[0];
    if (!(ni_59780 == in2->shape[0] && (ni_59780 == in3->shape[0] && n_59781 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_76542, preVals_mem_75467, is_mem_75468, ys_mem_75469, ni_59780, n_59781, incr_59782, psizze_59783);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = ni_59780;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_57574 = (int64_t) 0;
    int64_t dz2083U_57575 = (int64_t) 0;
    int64_t incr_57576 = (int64_t) 0;
    int64_t psizze_57577 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75468;
    
    ys_mem_75468.references = NULL;
    
    struct memblock_device is_mem_75467;
    
    is_mem_75467.references = NULL;
    incr_57576 = in0;
    psizze_57577 = in1;
    is_mem_75467 = in2->mem;
    niz2084U_57574 = in2->shape[0];
    ys_mem_75468 = in3->mem;
    dz2083U_57575 = in3->shape[0];
    if (!(niz2084U_57574 == in2->shape[0] && dz2083U_57575 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_76542, is_mem_75467, ys_mem_75468, niz2084U_57574, dz2083U_57575, incr_57576, psizze_57577);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = niz2084U_57574;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_59178 = (int64_t) 0;
    int64_t n_59179 = (int64_t) 0;
    int64_t incr_59180 = (int64_t) 0;
    int64_t psizze_59181 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device ys_mem_75469;
    
    ys_mem_75469.references = NULL;
    
    struct memblock_device is_mem_75468;
    
    is_mem_75468.references = NULL;
    
    struct memblock_device preVals_mem_75467;
    
    preVals_mem_75467.references = NULL;
    incr_59180 = in0;
    psizze_59181 = in1;
    preVals_mem_75467 = in2->mem;
    ni_59178 = in2->shape[0];
    is_mem_75468 = in3->mem;
    ni_59178 = in3->shape[0];
    ys_mem_75469 = in4->mem;
    n_59179 = in4->shape[0];
    if (!(ni_59178 == in2->shape[0] && (ni_59178 == in3->shape[0] && n_59179 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_76542, preVals_mem_75467, is_mem_75468, ys_mem_75469, ni_59178, n_59179, incr_59180, psizze_59181);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_76542;
            (*out0)->shape[0] = ni_59178;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_57224 = (int64_t) 0;
    int64_t nS_57225 = (int64_t) 0;
    int64_t offset_R_57228 = (int64_t) 0;
    int64_t offset_S_57229 = (int64_t) 0;
    int64_t partitionsPerWindow_57230 = (int64_t) 0;
    int64_t numberOfWindows_57231 = (int64_t) 0;
    int64_t extParallelism_57232 = (int64_t) 0;
    int64_t scatter_psizze_57233 = (int64_t) 0;
    int64_t prim_out_76545 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device tS_mem_75468;
    
    tS_mem_75468.references = NULL;
    
    struct memblock_device tR_mem_75467;
    
    tR_mem_75467.references = NULL;
    tR_mem_75467 = in0->mem;
    nR_57224 = in0->shape[0];
    tS_mem_75468 = in1->mem;
    nS_57225 = in1->shape[0];
    offset_R_57228 = in2;
    offset_S_57229 = in3;
    partitionsPerWindow_57230 = in4;
    numberOfWindows_57231 = in5;
    extParallelism_57232 = in6;
    scatter_psizze_57233 = in7;
    if (!(nR_57224 == in0->shape[0] && nS_57225 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_76542, &mem_out_76543, &mem_out_76544, &prim_out_76545, tR_mem_75467, tS_mem_75468, nR_57224, nS_57225, offset_R_57228, offset_S_57229, partitionsPerWindow_57230, numberOfWindows_57231, extParallelism_57232, scatter_psizze_57233);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_76542;
            (*out0)->v0->shape[0] = prim_out_76545;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_76543;
            (*out0)->v1->shape[0] = prim_out_76545;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_76544;
            (*out0)->v2->shape[0] = prim_out_76545;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_52195 = (int64_t) 0;
    int64_t nS_52196 = (int64_t) 0;
    int64_t offset_R_52199 = (int64_t) 0;
    int64_t offset_S_52200 = (int64_t) 0;
    int64_t partitionsPerWindow_52201 = (int64_t) 0;
    int64_t numberOfWindows_52202 = (int64_t) 0;
    int64_t extParallelism_52203 = (int64_t) 0;
    int64_t scatter_psizze_52204 = (int64_t) 0;
    int64_t prim_out_76545 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device tS_mem_75468;
    
    tS_mem_75468.references = NULL;
    
    struct memblock_device tR_mem_75467;
    
    tR_mem_75467.references = NULL;
    tR_mem_75467 = in0->mem;
    nR_52195 = in0->shape[0];
    tS_mem_75468 = in1->mem;
    nS_52196 = in1->shape[0];
    offset_R_52199 = in2;
    offset_S_52200 = in3;
    partitionsPerWindow_52201 = in4;
    numberOfWindows_52202 = in5;
    extParallelism_52203 = in6;
    scatter_psizze_52204 = in7;
    if (!(nR_52195 == in0->shape[0] && nS_52196 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_76542, &mem_out_76543, &mem_out_76544, &prim_out_76545, tR_mem_75467, tS_mem_75468, nR_52195, nS_52196, offset_R_52199, offset_S_52200, partitionsPerWindow_52201, numberOfWindows_52202, extParallelism_52203, scatter_psizze_52204);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_76542;
            (*out0)->v0->shape[0] = prim_out_76545;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_76543;
            (*out0)->v1->shape[0] = prim_out_76545;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_76544;
            (*out0)->v2->shape[0] = prim_out_76545;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_42219 = (int64_t) 0;
    int64_t nS_42220 = (int64_t) 0;
    int64_t offset_R_42223 = (int64_t) 0;
    int64_t offset_S_42224 = (int64_t) 0;
    int64_t partitionsPerWindow_42225 = (int64_t) 0;
    int64_t numberOfWindows_42226 = (int64_t) 0;
    int64_t extParallelism_42227 = (int64_t) 0;
    int64_t scatter_psizze_42228 = (int64_t) 0;
    int64_t prim_out_76545 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device tS_mem_75468;
    
    tS_mem_75468.references = NULL;
    
    struct memblock_device tR_mem_75467;
    
    tR_mem_75467.references = NULL;
    tR_mem_75467 = in0->mem;
    nR_42219 = in0->shape[0];
    tS_mem_75468 = in1->mem;
    nS_42220 = in1->shape[0];
    offset_R_42223 = in2;
    offset_S_42224 = in3;
    partitionsPerWindow_42225 = in4;
    numberOfWindows_42226 = in5;
    extParallelism_42227 = in6;
    scatter_psizze_42228 = in7;
    if (!(nR_42219 == in0->shape[0] && nS_42220 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_76542, &mem_out_76543, &mem_out_76544, &prim_out_76545, tR_mem_75467, tS_mem_75468, nR_42219, nS_42220, offset_R_42223, offset_S_42224, partitionsPerWindow_42225, numberOfWindows_42226, extParallelism_42227, scatter_psizze_42228);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_76542;
            (*out0)->v0->shape[0] = prim_out_76545;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_76543;
            (*out0)->v1->shape[0] = prim_out_76545;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_76544;
            (*out0)->v2->shape[0] = prim_out_76545;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_47166 = (int64_t) 0;
    int64_t nS_47167 = (int64_t) 0;
    int64_t offset_R_47170 = (int64_t) 0;
    int64_t offset_S_47171 = (int64_t) 0;
    int64_t partitionsPerWindow_47172 = (int64_t) 0;
    int64_t numberOfWindows_47173 = (int64_t) 0;
    int64_t extParallelism_47174 = (int64_t) 0;
    int64_t scatter_psizze_47175 = (int64_t) 0;
    int64_t prim_out_76545 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device tS_mem_75468;
    
    tS_mem_75468.references = NULL;
    
    struct memblock_device tR_mem_75467;
    
    tR_mem_75467.references = NULL;
    tR_mem_75467 = in0->mem;
    nR_47166 = in0->shape[0];
    tS_mem_75468 = in1->mem;
    nS_47167 = in1->shape[0];
    offset_R_47170 = in2;
    offset_S_47171 = in3;
    partitionsPerWindow_47172 = in4;
    numberOfWindows_47173 = in5;
    extParallelism_47174 = in6;
    scatter_psizze_47175 = in7;
    if (!(nR_47166 == in0->shape[0] && nS_47167 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_76542, &mem_out_76543, &mem_out_76544, &prim_out_76545, tR_mem_75467, tS_mem_75468, nR_47166, nS_47167, offset_R_47170, offset_S_47171, partitionsPerWindow_47172, numberOfWindows_47173, extParallelism_47174, scatter_psizze_47175);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_76542;
            (*out0)->v0->shape[0] = prim_out_76545;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_76543;
            (*out0)->v1->shape[0] = prim_out_76545;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_76544;
            (*out0)->v2->shape[0] = prim_out_76545;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_37190 = (int64_t) 0;
    int64_t nS_37191 = (int64_t) 0;
    int64_t offset_R_37194 = (int64_t) 0;
    int64_t offset_S_37195 = (int64_t) 0;
    int64_t partitionsPerWindow_37196 = (int64_t) 0;
    int64_t numberOfWindows_37197 = (int64_t) 0;
    int64_t extParallelism_37198 = (int64_t) 0;
    int64_t scatter_psizze_37199 = (int64_t) 0;
    int64_t prim_out_76545 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_76544;
    
    mem_out_76544.references = NULL;
    
    struct memblock_device mem_out_76543;
    
    mem_out_76543.references = NULL;
    
    struct memblock_device mem_out_76542;
    
    mem_out_76542.references = NULL;
    
    struct memblock_device tS_mem_75468;
    
    tS_mem_75468.references = NULL;
    
    struct memblock_device tR_mem_75467;
    
    tR_mem_75467.references = NULL;
    tR_mem_75467 = in0->mem;
    nR_37190 = in0->shape[0];
    tS_mem_75468 = in1->mem;
    nS_37191 = in1->shape[0];
    offset_R_37194 = in2;
    offset_S_37195 = in3;
    partitionsPerWindow_37196 = in4;
    numberOfWindows_37197 = in5;
    extParallelism_37198 = in6;
    scatter_psizze_37199 = in7;
    if (!(nR_37190 == in0->shape[0] && nS_37191 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_76542, &mem_out_76543, &mem_out_76544, &prim_out_76545, tR_mem_75467, tS_mem_75468, nR_37190, nS_37191, offset_R_37194, offset_S_37195, partitionsPerWindow_37196, numberOfWindows_37197, extParallelism_37198, scatter_psizze_37199);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_76542;
            (*out0)->v0->shape[0] = prim_out_76545;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_76543;
            (*out0)->v1->shape[0] = prim_out_76545;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_76544;
            (*out0)->v2->shape[0] = prim_out_76545;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_60458 = (int64_t) 0;
    int64_t prim_out_76542 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device eta_p_mem_75467;
    
    eta_p_mem_75467.references = NULL;
    eta_p_mem_75467 = in0->mem;
    nz2080U_60458 = in0->shape[0];
    if (!(nz2080U_60458 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_76542, eta_p_mem_75467, nz2080U_60458);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            *out0 = prim_out_76542;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_60421 = (int64_t) 0;
    int64_t prim_out_76542 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device eta_p_mem_75467;
    
    eta_p_mem_75467.references = NULL;
    eta_p_mem_75467 = in0->mem;
    nz2080U_60421 = in0->shape[0];
    if (!(nz2080U_60421 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_76542, eta_p_mem_75467, nz2080U_60421);
        if (ret == 0) {
            struct memblock_device counters_mem_76545 = ctx->constants->counters_mem_76545;
            struct memblock_device global_dynid_mem_76932 = ctx->constants->global_dynid_mem_76932;
            struct memblock_device global_dynid_mem_76952 = ctx->constants->global_dynid_mem_76952;
            struct memblock_device global_dynid_mem_77073 = ctx->constants->global_dynid_mem_77073;
            struct memblock_device global_dynid_mem_77093 = ctx->constants->global_dynid_mem_77093;
            
            *out0 = prim_out_76542;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
  
